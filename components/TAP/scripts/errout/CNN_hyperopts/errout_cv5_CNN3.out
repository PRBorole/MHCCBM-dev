config:  {'project': 'MHCCBM', 'name': 'CNN_3', 'config': {'hidden_channels': [1024], 'epochs': 500, 'kernel_size': 3, 'pool_kernel_size': 3, 'classes': 2, 'seed': 42, 'batch_size': 32, 'lr': 1e-05, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
[Epoch 1, Batch 10] loss: 0.526
epoch:  1 val_f1:  0.23980974371696281 val_auroc:  0.7739322533136966 val_auprc:  0.8883324603644162
epoch:  1
[Epoch 2, Batch 10] loss: 0.410
epoch:  2 val_f1:  0.7552115339652351 val_auroc:  0.7992145311732941 val_auprc:  0.912055592657256
EarlyStopping counter: 1 out of 50
epoch:  2
[Epoch 3, Batch 10] loss: 0.358
epoch:  3 val_f1:  0.7166299330477814 val_auroc:  0.7842415316642121 val_auprc:  0.8985524343145492
Validation loss improved to 0.434703
epoch:  3
[Epoch 4, Batch 10] loss: 0.349
epoch:  4 val_f1:  0.7156947373800909 val_auroc:  0.7729504172803142 val_auprc:  0.8840060900672613
EarlyStopping counter: 1 out of 50
epoch:  4
[Epoch 5, Batch 10] loss: 0.325
epoch:  5 val_f1:  0.7162290583621869 val_auroc:  0.7832596956308296 val_auprc:  0.8893680821330814
EarlyStopping counter: 2 out of 50
epoch:  5
[Epoch 6, Batch 10] loss: 0.322
epoch:  6 val_f1:  0.6524974219867484 val_auroc:  0.7903780068728522 val_auprc:  0.8951137687641448
EarlyStopping counter: 3 out of 50
epoch:  6
[Epoch 7, Batch 10] loss: 0.329
epoch:  7 val_f1:  0.751751326211758 val_auroc:  0.7945508100147276 val_auprc:  0.8982276726205043
EarlyStopping counter: 4 out of 50
epoch:  7
[Epoch 8, Batch 10] loss: 0.303
epoch:  8 val_f1:  0.7777125328082551 val_auroc:  0.8053510063819342 val_auprc:  0.9057607006716007
EarlyStopping counter: 5 out of 50
epoch:  8
[Epoch 9, Batch 10] loss: 0.307
epoch:  9 val_f1:  0.7510724063582411 val_auroc:  0.7965144820814924 val_auprc:  0.9011317110689261
EarlyStopping counter: 6 out of 50
epoch:  9
[Epoch 10, Batch 10] loss: 0.284
epoch:  10 val_f1:  0.6743799189283424 val_auroc:  0.81173294059892 val_auprc:  0.9130989354952773
EarlyStopping counter: 7 out of 50
epoch:  10
[Epoch 11, Batch 10] loss: 0.285
epoch:  11 val_f1:  0.6958509820496094 val_auroc:  0.8134511536573392 val_auprc:  0.9131712170761295
EarlyStopping counter: 8 out of 50
epoch:  11
[Epoch 12, Batch 10] loss: 0.274
epoch:  12 val_f1:  0.5942613741174892 val_auroc:  0.8198330878743251 val_auprc:  0.918414429506432
EarlyStopping counter: 9 out of 50
epoch:  12
[Epoch 13, Batch 10] loss: 0.285
epoch:  13 val_f1:  0.6261499602312229 val_auroc:  0.8190967108492881 val_auprc:  0.918896340172116
EarlyStopping counter: 10 out of 50
epoch:  13
[Epoch 14, Batch 10] loss: 0.290
epoch:  14 val_f1:  0.6663975251072785 val_auroc:  0.814187530682376 val_auprc:  0.9135225422319235
EarlyStopping counter: 11 out of 50
epoch:  14
[Epoch 15, Batch 10] loss: 0.268
epoch:  15 val_f1:  0.7802930475309426 val_auroc:  0.8095238095238095 val_auprc:  0.9110977575048913
EarlyStopping counter: 12 out of 50
epoch:  15
[Epoch 16, Batch 10] loss: 0.246
epoch:  16 val_f1:  0.7790721385700611 val_auroc:  0.8078055964653902 val_auprc:  0.9109563309877484
EarlyStopping counter: 13 out of 50
epoch:  16
[Epoch 17, Batch 10] loss: 0.261
epoch:  17 val_f1:  0.7802930475309426 val_auroc:  0.8166421207658321 val_auprc:  0.9176620089497718
EarlyStopping counter: 14 out of 50
epoch:  17
[Epoch 18, Batch 10] loss: 0.269
epoch:  18 val_f1:  0.7626195746699344 val_auroc:  0.8264604810996564 val_auprc:  0.9255291451281693
EarlyStopping counter: 15 out of 50
epoch:  18
[Epoch 19, Batch 10] loss: 0.234
epoch:  19 val_f1:  0.681579990245092 val_auroc:  0.8198330878743251 val_auprc:  0.9198471529122452
EarlyStopping counter: 16 out of 50
epoch:  19
[Epoch 20, Batch 10] loss: 0.266
epoch:  20 val_f1:  0.7513203127712835 val_auroc:  0.8215513009327442 val_auprc:  0.922029513475561
EarlyStopping counter: 17 out of 50
epoch:  20
[Epoch 21, Batch 10] loss: 0.244
epoch:  21 val_f1:  0.7762067639678805 val_auroc:  0.8139420716740305 val_auprc:  0.9166093593935872
EarlyStopping counter: 18 out of 50
epoch:  21
[Epoch 22, Batch 10] loss: 0.222
epoch:  22 val_f1:  0.7777125328082551 val_auroc:  0.8257241040746196 val_auprc:  0.9259823650257878
EarlyStopping counter: 19 out of 50
epoch:  22
[Epoch 23, Batch 10] loss: 0.226
epoch:  23 val_f1:  0.7494347379239465 val_auroc:  0.8240058910162003 val_auprc:  0.9233996052791443
EarlyStopping counter: 20 out of 50
epoch:  23
[Epoch 24, Batch 10] loss: 0.223
epoch:  24 val_f1:  0.7617596949267598 val_auroc:  0.8200785468826706 val_auprc:  0.9202049213161922
EarlyStopping counter: 21 out of 50
epoch:  24
[Epoch 25, Batch 10] loss: 0.217
epoch:  25 val_f1:  0.7375047745919104 val_auroc:  0.8205694648993619 val_auprc:  0.9204905510434533
EarlyStopping counter: 22 out of 50
epoch:  25
[Epoch 26, Batch 10] loss: 0.231
epoch:  26 val_f1:  0.7500864926036699 val_auroc:  0.8271968581246931 val_auprc:  0.9252376710459803
EarlyStopping counter: 23 out of 50
epoch:  26
[Epoch 27, Batch 10] loss: 0.224
epoch:  27 val_f1:  0.7626195746699344 val_auroc:  0.8308787432498773 val_auprc:  0.9261941664063438
EarlyStopping counter: 24 out of 50
epoch:  27
[Epoch 28, Batch 10] loss: 0.215
epoch:  28 val_f1:  0.7552115339652351 val_auroc:  0.8225331369661266 val_auprc:  0.9207680399857108
EarlyStopping counter: 25 out of 50
epoch:  28
[Epoch 29, Batch 10] loss: 0.212
epoch:  29 val_f1:  0.7376969013024874 val_auroc:  0.8301423662248405 val_auprc:  0.9265454946452745
EarlyStopping counter: 26 out of 50
epoch:  29
[Epoch 30, Batch 10] loss: 0.224
epoch:  30 val_f1:  0.7494347379239465 val_auroc:  0.8257241040746196 val_auprc:  0.9223597260528854
EarlyStopping counter: 27 out of 50
epoch:  30
[Epoch 31, Batch 10] loss: 0.207
epoch:  31 val_f1:  0.7552115339652351 val_auroc:  0.825478645066274 val_auprc:  0.9224205129433267
EarlyStopping counter: 28 out of 50
epoch:  31
[Epoch 32, Batch 10] loss: 0.209
epoch:  32 val_f1:  0.7506155503404762 val_auroc:  0.8269513991163475 val_auprc:  0.9231511485548078
EarlyStopping counter: 29 out of 50
epoch:  32
[Epoch 33, Batch 10] loss: 0.201
epoch:  33 val_f1:  0.7308672563486676 val_auroc:  0.8333333333333333 val_auprc:  0.927732674318383
EarlyStopping counter: 30 out of 50
epoch:  33
[Epoch 34, Batch 10] loss: 0.207
epoch:  34 val_f1:  0.7099629667254643 val_auroc:  0.8345606283750614 val_auprc:  0.9282297625889777
EarlyStopping counter: 31 out of 50
epoch:  34
[Epoch 35, Batch 10] loss: 0.205
epoch:  35 val_f1:  0.7855581813618873 val_auroc:  0.8325969563082966 val_auprc:  0.92705735138442
EarlyStopping counter: 32 out of 50
epoch:  35
[Epoch 36, Batch 10] loss: 0.214
epoch:  36 val_f1:  0.7920536597238516 val_auroc:  0.8237604320078548 val_auprc:  0.9220693208841285
EarlyStopping counter: 33 out of 50
epoch:  36
[Epoch 37, Batch 10] loss: 0.194
epoch:  37 val_f1:  0.7725930260576229 val_auroc:  0.8247422680412372 val_auprc:  0.9226407534399319
EarlyStopping counter: 34 out of 50
epoch:  37
[Epoch 38, Batch 10] loss: 0.186
epoch:  38 val_f1:  0.7661184054361647 val_auroc:  0.8208149239077074 val_auprc:  0.9186607874647743
EarlyStopping counter: 35 out of 50
epoch:  38
[Epoch 39, Batch 10] loss: 0.188
epoch:  39 val_f1:  0.7855581813618873 val_auroc:  0.819833087874325 val_auprc:  0.9192964702558238
EarlyStopping counter: 36 out of 50
epoch:  39
[Epoch 40, Batch 10] loss: 0.165
epoch:  40 val_f1:  0.748656020238754 val_auroc:  0.8259695630829652 val_auprc:  0.9234841727798642
EarlyStopping counter: 37 out of 50
epoch:  40
[Epoch 41, Batch 10] loss: 0.168
epoch:  41 val_f1:  0.7855581813618873 val_auroc:  0.8220422189494355 val_auprc:  0.9214693322680545
EarlyStopping counter: 38 out of 50
epoch:  41
[Epoch 42, Batch 10] loss: 0.193
epoch:  42 val_f1:  0.7573003855683703 val_auroc:  0.8232695139911635 val_auprc:  0.9206590143867676
EarlyStopping counter: 39 out of 50
epoch:  42
[Epoch 43, Batch 10] loss: 0.164
epoch:  43 val_f1:  0.7412236216203913 val_auroc:  0.8284241531664212 val_auprc:  0.9253145527870392
EarlyStopping counter: 40 out of 50
epoch:  43
[Epoch 44, Batch 10] loss: 0.158
epoch:  44 val_f1:  0.7938350857775318 val_auroc:  0.8240058910162004 val_auprc:  0.9219875407061844
EarlyStopping counter: 41 out of 50
epoch:  44
[Epoch 45, Batch 10] loss: 0.201
epoch:  45 val_f1:  0.7790721385700611 val_auroc:  0.8232695139911634 val_auprc:  0.9216193248642071
EarlyStopping counter: 42 out of 50
epoch:  45
[Epoch 46, Batch 10] loss: 0.166
epoch:  46 val_f1:  0.7445203699313053 val_auroc:  0.8311242022582229 val_auprc:  0.9259221806081821
EarlyStopping counter: 43 out of 50
epoch:  46
[Epoch 47, Batch 10] loss: 0.167
epoch:  47 val_f1:  0.6958509820496094 val_auroc:  0.824251350024546 val_auprc:  0.9215336520438691
EarlyStopping counter: 44 out of 50
epoch:  47
[Epoch 48, Batch 10] loss: 0.169
epoch:  48 val_f1:  0.7560320485424044 val_auroc:  0.82793323514973 val_auprc:  0.9239906289842679
EarlyStopping counter: 45 out of 50
epoch:  48
[Epoch 49, Batch 10] loss: 0.145
epoch:  49 val_f1:  0.751502327549725 val_auroc:  0.8276877761413844 val_auprc:  0.9249234421764565
EarlyStopping counter: 46 out of 50
epoch:  49
[Epoch 50, Batch 10] loss: 0.156
epoch:  50 val_f1:  0.7377728985642654 val_auroc:  0.8262150220913107 val_auprc:  0.9233403460101113
EarlyStopping counter: 47 out of 50
epoch:  50
[Epoch 51, Batch 10] loss: 0.151
epoch:  51 val_f1:  0.7510257046352308 val_auroc:  0.8281786941580755 val_auprc:  0.9237325642172158
EarlyStopping counter: 48 out of 50
epoch:  51
[Epoch 52, Batch 10] loss: 0.156
epoch:  52 val_f1:  0.7672775806504117 val_auroc:  0.8271968581246931 val_auprc:  0.9246142680489928
EarlyStopping counter: 49 out of 50
epoch:  52
[Epoch 53, Batch 10] loss: 0.157
epoch:  53 val_f1:  0.7607703458551531 val_auroc:  0.8284241531664213 val_auprc:  0.9233747816519382
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1470.203337430954
{'time_elapsed': [1470.203337430954], 'epoch': [52], 'fold': [0], 'f1_train': [0.9155608060978904], 'auroc_train': [0.9805929423306864], 'auprc_train': [0.990812228153879], 'f1_test': [0.7607703458551531], 'auroc_test': [0.8284241531664213], 'auprc_test': [0.9233747816519382]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [32, 1]                   --
├─Sequential: 1-1                        [32, 1]                   --
│    └─Conv1d: 2-1                       [32, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [32, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [32, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [32, 1024, 1278]          --
│    └─Dropout: 2-5                      [32, 1024, 1278]          --
│    └─Flatten: 2-6                      [32, 1308672]             --
│    └─Linear: 2-7                       [32, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.16
Forward/backward pass size (MB): 671.09
Params size (MB): 5.26
Estimated Total Size (MB): 676.51
==========================================================================================
tensor(0.4369)
epoch:  0
[Epoch 1, Batch 10] loss: 0.648
epoch:  1 val_f1:  0.5670941507663435 val_auroc:  0.8075601374570447 val_auprc:  0.9050045979897452
epoch:  1
[Epoch 2, Batch 10] loss: 0.378
epoch:  2 val_f1:  0.7683026725960121 val_auroc:  0.7972508591065293 val_auprc:  0.9106415818164291
Validation loss improved to 0.329000
epoch:  2
[Epoch 3, Batch 10] loss: 0.356
epoch:  3 val_f1:  0.7626195746699344 val_auroc:  0.7920962199312716 val_auprc:  0.9102582433918825
Validation loss improved to 0.323246
epoch:  3
[Epoch 4, Batch 10] loss: 0.339
epoch:  4 val_f1:  0.7757738305193033 val_auroc:  0.7893961708394699 val_auprc:  0.909028082865287
Validation loss improved to 0.311286
epoch:  4
[Epoch 5, Batch 10] loss: 0.330
epoch:  5 val_f1:  0.7583300796647482 val_auroc:  0.8102601865488462 val_auprc:  0.920819374309065
EarlyStopping counter: 1 out of 50
epoch:  5
[Epoch 6, Batch 10] loss: 0.319
epoch:  6 val_f1:  0.702570289683208 val_auroc:  0.8078055964653903 val_auprc:  0.9198624402369291
EarlyStopping counter: 2 out of 50
epoch:  6
[Epoch 7, Batch 10] loss: 0.314
epoch:  7 val_f1:  0.7096759374109908 val_auroc:  0.8124693176239568 val_auprc:  0.921770419555326
EarlyStopping counter: 3 out of 50
epoch:  7
[Epoch 8, Batch 10] loss: 0.305
epoch:  8 val_f1:  0.723931698015082 val_auroc:  0.8078055964653903 val_auprc:  0.9193835268805166
EarlyStopping counter: 4 out of 50
epoch:  8
[Epoch 9, Batch 10] loss: 0.298
epoch:  9 val_f1:  0.7202047592695074 val_auroc:  0.8105056455571921 val_auprc:  0.9196599154604592
Validation loss improved to 0.281835
epoch:  9
[Epoch 10, Batch 10] loss: 0.281
epoch:  10 val_f1:  0.726967940210938 val_auroc:  0.815414825724104 val_auprc:  0.9210403805459371
Validation loss improved to 0.276684
epoch:  10
[Epoch 11, Batch 10] loss: 0.283
epoch:  11 val_f1:  0.7905466835322951 val_auroc:  0.8139420716740304 val_auprc:  0.9206929254144023
EarlyStopping counter: 1 out of 50
epoch:  11
[Epoch 12, Batch 10] loss: 0.271
epoch:  12 val_f1:  0.7648576099332736 val_auroc:  0.8176239567992145 val_auprc:  0.9223712908783387
EarlyStopping counter: 2 out of 50
epoch:  12
[Epoch 13, Batch 10] loss: 0.278
epoch:  13 val_f1:  0.770628190185282 val_auroc:  0.8203240058910162 val_auprc:  0.9230387066727448
EarlyStopping counter: 3 out of 50
epoch:  13
[Epoch 14, Batch 10] loss: 0.267
epoch:  14 val_f1:  0.7954863587533922 val_auroc:  0.8230240549828178 val_auprc:  0.9237390401614861
EarlyStopping counter: 4 out of 50
epoch:  14
[Epoch 15, Batch 10] loss: 0.265
epoch:  15 val_f1:  0.7889150110486646 val_auroc:  0.8208149239077074 val_auprc:  0.9222169625249211
Validation loss improved to 0.276359
epoch:  15
[Epoch 16, Batch 10] loss: 0.249
epoch:  16 val_f1:  0.7513203127712835 val_auroc:  0.8176239567992145 val_auprc:  0.9217763300654942
EarlyStopping counter: 1 out of 50
epoch:  16
[Epoch 17, Batch 10] loss: 0.255
epoch:  17 val_f1:  0.778324933635979 val_auroc:  0.8249877270495828 val_auprc:  0.9244798716663007
EarlyStopping counter: 2 out of 50
epoch:  17
[Epoch 18, Batch 10] loss: 0.266
epoch:  18 val_f1:  0.770628190185282 val_auroc:  0.8271968581246932 val_auprc:  0.925123861738475
EarlyStopping counter: 3 out of 50
epoch:  18
[Epoch 19, Batch 10] loss: 0.245
epoch:  19 val_f1:  0.7841726618705036 val_auroc:  0.8249877270495827 val_auprc:  0.9232003186021962
Validation loss improved to 0.259523
epoch:  19
[Epoch 20, Batch 10] loss: 0.253
epoch:  20 val_f1:  0.7559325673789327 val_auroc:  0.8276877761413843 val_auprc:  0.9240072875643611
EarlyStopping counter: 1 out of 50
epoch:  20
[Epoch 21, Batch 10] loss: 0.261
epoch:  21 val_f1:  0.7868059619290214 val_auroc:  0.8240058910162004 val_auprc:  0.9227564385781615
EarlyStopping counter: 2 out of 50
epoch:  21
[Epoch 22, Batch 10] loss: 0.228
epoch:  22 val_f1:  0.7757738305193033 val_auroc:  0.8267059401080019 val_auprc:  0.9241119925199495
EarlyStopping counter: 3 out of 50
epoch:  22
[Epoch 23, Batch 10] loss: 0.215
epoch:  23 val_f1:  0.7639705763479104 val_auroc:  0.8247422680412372 val_auprc:  0.9227856186723451
EarlyStopping counter: 4 out of 50
epoch:  23
[Epoch 24, Batch 10] loss: 0.222
epoch:  24 val_f1:  0.8010188978004199 val_auroc:  0.8252331860579284 val_auprc:  0.9223615555639961
EarlyStopping counter: 5 out of 50
epoch:  24
[Epoch 25, Batch 10] loss: 0.229
epoch:  25 val_f1:  0.7831873586549224 val_auroc:  0.8244968090328915 val_auprc:  0.9219097343986677
EarlyStopping counter: 6 out of 50
epoch:  25
[Epoch 26, Batch 10] loss: 0.235
epoch:  26 val_f1:  0.7933255489848959 val_auroc:  0.8257241040746195 val_auprc:  0.922494302477745
Validation loss improved to 0.255804
epoch:  26
[Epoch 27, Batch 10] loss: 0.229
epoch:  27 val_f1:  0.7933255489848959 val_auroc:  0.8240058910162003 val_auprc:  0.9212495476448502
Validation loss improved to 0.250640
epoch:  27
[Epoch 28, Batch 10] loss: 0.231
epoch:  28 val_f1:  0.7963871971298289 val_auroc:  0.8213058419243986 val_auprc:  0.9200249523867791
EarlyStopping counter: 1 out of 50
epoch:  28
[Epoch 29, Batch 10] loss: 0.211
epoch:  29 val_f1:  0.7633550302615051 val_auroc:  0.8271968581246931 val_auprc:  0.9235090315293927
EarlyStopping counter: 2 out of 50
epoch:  29
[Epoch 30, Batch 10] loss: 0.204
epoch:  30 val_f1:  0.7897879661118469 val_auroc:  0.8232695139911634 val_auprc:  0.9207950079958892
EarlyStopping counter: 3 out of 50
epoch:  30
[Epoch 31, Batch 10] loss: 0.214
epoch:  31 val_f1:  0.799854302604428 val_auroc:  0.8264604810996564 val_auprc:  0.9219547886353108
Validation loss improved to 0.246437
epoch:  31
[Epoch 32, Batch 10] loss: 0.246
epoch:  32 val_f1:  0.7384802450563926 val_auroc:  0.823514972999509 val_auprc:  0.9188626157127603
Validation loss improved to 0.230880
epoch:  32
[Epoch 33, Batch 10] loss: 0.210
epoch:  33 val_f1:  0.7445203699313053 val_auroc:  0.8279332351497299 val_auprc:  0.9225633908656655
EarlyStopping counter: 1 out of 50
epoch:  33
[Epoch 34, Batch 10] loss: 0.223
epoch:  34 val_f1:  0.7375047745919104 val_auroc:  0.8281786941580755 val_auprc:  0.9238003525223146
EarlyStopping counter: 2 out of 50
epoch:  34
[Epoch 35, Batch 10] loss: 0.216
epoch:  35 val_f1:  0.7745465218349855 val_auroc:  0.8230240549828178 val_auprc:  0.9196814639030371
EarlyStopping counter: 3 out of 50
epoch:  35
[Epoch 36, Batch 10] loss: 0.204
epoch:  36 val_f1:  0.7906450372602754 val_auroc:  0.8240058910162003 val_auprc:  0.9201192606475053
EarlyStopping counter: 4 out of 50
epoch:  36
[Epoch 37, Batch 10] loss: 0.189
epoch:  37 val_f1:  0.7985611510791367 val_auroc:  0.8294059891998036 val_auprc:  0.9223785550619471
EarlyStopping counter: 5 out of 50
epoch:  37
[Epoch 38, Batch 10] loss: 0.214
epoch:  38 val_f1:  0.7944676896257205 val_auroc:  0.8284241531664212 val_auprc:  0.9216249005628125
EarlyStopping counter: 6 out of 50
epoch:  38
[Epoch 39, Batch 10] loss: 0.208
epoch:  39 val_f1:  0.8095907478048824 val_auroc:  0.8276877761413843 val_auprc:  0.9219835788805664
EarlyStopping counter: 7 out of 50
epoch:  39
[Epoch 40, Batch 10] loss: 0.201
epoch:  40 val_f1:  0.8020613296596766 val_auroc:  0.8286696121747669 val_auprc:  0.9221727090983454
EarlyStopping counter: 8 out of 50
epoch:  40
[Epoch 41, Batch 10] loss: 0.182
epoch:  41 val_f1:  0.7933255489848959 val_auroc:  0.8264604810996564 val_auprc:  0.9210776184778819
EarlyStopping counter: 9 out of 50
epoch:  41
[Epoch 42, Batch 10] loss: 0.197
epoch:  42 val_f1:  0.8020613296596766 val_auroc:  0.8294059891998037 val_auprc:  0.9227742757219854
EarlyStopping counter: 10 out of 50
epoch:  42
[Epoch 43, Batch 10] loss: 0.190
epoch:  43 val_f1:  0.7765831291011147 val_auroc:  0.8269513991163475 val_auprc:  0.9215027689976567
EarlyStopping counter: 11 out of 50
epoch:  43
[Epoch 44, Batch 10] loss: 0.183
epoch:  44 val_f1:  0.806394786639448 val_auroc:  0.8267059401080019 val_auprc:  0.9212235570661832
EarlyStopping counter: 12 out of 50
epoch:  44
[Epoch 45, Batch 10] loss: 0.160
epoch:  45 val_f1:  0.7963871971298289 val_auroc:  0.8313696612665685 val_auprc:  0.9235303068463154
EarlyStopping counter: 13 out of 50
epoch:  45
[Epoch 46, Batch 10] loss: 0.176
epoch:  46 val_f1:  0.7906450372602754 val_auroc:  0.8303878252331861 val_auprc:  0.9222837145437275
Validation loss improved to 0.229406
epoch:  46
[Epoch 47, Batch 10] loss: 0.172
epoch:  47 val_f1:  0.7985611510791367 val_auroc:  0.8274423171330388 val_auprc:  0.9206082263352839
EarlyStopping counter: 1 out of 50
epoch:  47
[Epoch 48, Batch 10] loss: 0.180
epoch:  48 val_f1:  0.7644702419882276 val_auroc:  0.8323514972999508 val_auprc:  0.924408703059115
EarlyStopping counter: 2 out of 50
epoch:  48
[Epoch 49, Batch 10] loss: 0.176
epoch:  49 val_f1:  0.8029873436454202 val_auroc:  0.8313696612665685 val_auprc:  0.9223423242987256
EarlyStopping counter: 3 out of 50
epoch:  49
[Epoch 50, Batch 10] loss: 0.177
epoch:  50 val_f1:  0.8152318336718186 val_auroc:  0.8294059891998036 val_auprc:  0.9212409283401424
EarlyStopping counter: 4 out of 50
epoch:  50
[Epoch 51, Batch 10] loss: 0.163
epoch:  51 val_f1:  0.8086423317204984 val_auroc:  0.8289150711831124 val_auprc:  0.9218819106573644
EarlyStopping counter: 5 out of 50
epoch:  51
[Epoch 52, Batch 10] loss: 0.148
epoch:  52 val_f1:  0.814150423846969 val_auroc:  0.8365243004418262 val_auprc:  0.925096164460528
EarlyStopping counter: 6 out of 50
epoch:  52
[Epoch 53, Batch 10] loss: 0.181
epoch:  53 val_f1:  0.766354189375772 val_auroc:  0.8318605792832597 val_auprc:  0.9226831041400966
Validation loss improved to 0.222656
epoch:  53
[Epoch 54, Batch 10] loss: 0.174
epoch:  54 val_f1:  0.8075789593997306 val_auroc:  0.8269513991163476 val_auprc:  0.9200563627816621
EarlyStopping counter: 1 out of 50
epoch:  54
[Epoch 55, Batch 10] loss: 0.169
epoch:  55 val_f1:  0.7985611510791367 val_auroc:  0.8281786941580757 val_auprc:  0.9209054328489417
EarlyStopping counter: 2 out of 50
epoch:  55
[Epoch 56, Batch 10] loss: 0.145
epoch:  56 val_f1:  0.7890919075230509 val_auroc:  0.833578792341679 val_auprc:  0.9235778536186692
EarlyStopping counter: 3 out of 50
epoch:  56
[Epoch 57, Batch 10] loss: 0.145
epoch:  57 val_f1:  0.8095907478048824 val_auroc:  0.8306332842415316 val_auprc:  0.9215625631492819
EarlyStopping counter: 4 out of 50
epoch:  57
[Epoch 58, Batch 10] loss: 0.137
epoch:  58 val_f1:  0.777854660092151 val_auroc:  0.8340697103583702 val_auprc:  0.9239375760774077
EarlyStopping counter: 5 out of 50
epoch:  58
[Epoch 59, Batch 10] loss: 0.183
epoch:  59 val_f1:  0.7707245329923307 val_auroc:  0.8303878252331861 val_auprc:  0.9208094687117423
Validation loss improved to 0.216317
epoch:  59
[Epoch 60, Batch 10] loss: 0.154
epoch:  60 val_f1:  0.7559325673789327 val_auroc:  0.8308787432498772 val_auprc:  0.9212493604452976
EarlyStopping counter: 1 out of 50
epoch:  60
[Epoch 61, Batch 10] loss: 0.141
epoch:  61 val_f1:  0.8075789593997306 val_auroc:  0.8291605301914581 val_auprc:  0.9204588683035236
EarlyStopping counter: 2 out of 50
epoch:  61
[Epoch 62, Batch 10] loss: 0.144
epoch:  62 val_f1:  0.8086423317204984 val_auroc:  0.830387825233186 val_auprc:  0.921868893364325
EarlyStopping counter: 3 out of 50
epoch:  62
[Epoch 63, Batch 10] loss: 0.142
epoch:  63 val_f1:  0.7715989981939552 val_auroc:  0.8321060382916053 val_auprc:  0.9230468724779193
EarlyStopping counter: 4 out of 50
epoch:  63
[Epoch 64, Batch 10] loss: 0.132
epoch:  64 val_f1:  0.7727225509205256 val_auroc:  0.8360333824251351 val_auprc:  0.9238047926302935
EarlyStopping counter: 5 out of 50
epoch:  64
[Epoch 65, Batch 10] loss: 0.149
epoch:  65 val_f1:  0.7685409504908388 val_auroc:  0.8313696612665685 val_auprc:  0.9203165230946398
Validation loss improved to 0.207740
epoch:  65
[Epoch 66, Batch 10] loss: 0.137
epoch:  66 val_f1:  0.7809570525397864 val_auroc:  0.8330878743249878 val_auprc:  0.922294932072525
EarlyStopping counter: 1 out of 50
epoch:  66
[Epoch 67, Batch 10] loss: 0.147
epoch:  67 val_f1:  0.8152318336718186 val_auroc:  0.8289150711831124 val_auprc:  0.9205263611084591
EarlyStopping counter: 2 out of 50
epoch:  67
[Epoch 68, Batch 10] loss: 0.138
epoch:  68 val_f1:  0.8095907478048824 val_auroc:  0.8367697594501718 val_auprc:  0.9241197930041843
EarlyStopping counter: 3 out of 50
epoch:  68
[Epoch 69, Batch 10] loss: 0.130
epoch:  69 val_f1:  0.806394786639448 val_auroc:  0.8328424153166422 val_auprc:  0.9217154926978005
EarlyStopping counter: 4 out of 50
epoch:  69
[Epoch 70, Batch 10] loss: 0.131
epoch:  70 val_f1:  0.7707245329923307 val_auroc:  0.8360333824251349 val_auprc:  0.922742963771827
EarlyStopping counter: 5 out of 50
epoch:  70
[Epoch 71, Batch 10] loss: 0.132
epoch:  71 val_f1:  0.7826417810500232 val_auroc:  0.8350515463917526 val_auprc:  0.9228921563863302
EarlyStopping counter: 6 out of 50
epoch:  71
[Epoch 72, Batch 10] loss: 0.138
epoch:  72 val_f1:  0.7685409504908388 val_auroc:  0.8311242022582229 val_auprc:  0.9202216145460835
Validation loss improved to 0.202734
epoch:  72
[Epoch 73, Batch 10] loss: 0.132
epoch:  73 val_f1:  0.7920536597238516 val_auroc:  0.838487972508591 val_auprc:  0.9250600199147421
EarlyStopping counter: 1 out of 50
epoch:  73
[Epoch 74, Batch 10] loss: 0.123
epoch:  74 val_f1:  0.7826417810500232 val_auroc:  0.8338242513500245 val_auprc:  0.9221679816710349
EarlyStopping counter: 2 out of 50
epoch:  74
[Epoch 75, Batch 10] loss: 0.116
epoch:  75 val_f1:  0.7920536597238516 val_auroc:  0.833578792341679 val_auprc:  0.9221102151537292
EarlyStopping counter: 3 out of 50
epoch:  75
[Epoch 76, Batch 10] loss: 0.128
epoch:  76 val_f1:  0.7890919075230509 val_auroc:  0.8330878743249878 val_auprc:  0.921392973725697
EarlyStopping counter: 4 out of 50
epoch:  76
[Epoch 77, Batch 10] loss: 0.123
epoch:  77 val_f1:  0.7826417810500232 val_auroc:  0.8325969563082966 val_auprc:  0.9206138080529482
EarlyStopping counter: 5 out of 50
epoch:  77
[Epoch 78, Batch 10] loss: 0.117
epoch:  78 val_f1:  0.7826417810500232 val_auroc:  0.8321060382916053 val_auprc:  0.9206416584747368
EarlyStopping counter: 6 out of 50
epoch:  78
[Epoch 79, Batch 10] loss: 0.115
epoch:  79 val_f1:  0.7791090204759269 val_auroc:  0.836033382425135 val_auprc:  0.9226595893028313
Validation loss improved to 0.200611
epoch:  79
[Epoch 80, Batch 10] loss: 0.119
epoch:  80 val_f1:  0.7622262794246104 val_auroc:  0.8325969563082966 val_auprc:  0.9208425401914642
Validation loss improved to 0.197060
epoch:  80
[Epoch 81, Batch 10] loss: 0.119
epoch:  81 val_f1:  0.797175270999766 val_auroc:  0.8321060382916053 val_auprc:  0.9212927072534886
EarlyStopping counter: 1 out of 50
epoch:  81
[Epoch 82, Batch 10] loss: 0.122
epoch:  82 val_f1:  0.7985611510791367 val_auroc:  0.8316151202749141 val_auprc:  0.9202368112395102
EarlyStopping counter: 2 out of 50
epoch:  82
[Epoch 83, Batch 10] loss: 0.109
epoch:  83 val_f1:  0.8045102379634754 val_auroc:  0.8330878743249878 val_auprc:  0.921177319552906
EarlyStopping counter: 3 out of 50
epoch:  83
[Epoch 84, Batch 10] loss: 0.124
epoch:  84 val_f1:  0.80508331055267 val_auroc:  0.8328424153166422 val_auprc:  0.9204917247198281
EarlyStopping counter: 4 out of 50
epoch:  84
[Epoch 85, Batch 10] loss: 0.121
epoch:  85 val_f1:  0.7598715939807772 val_auroc:  0.8294059891998037 val_auprc:  0.916692320586005
Validation loss improved to 0.191584
epoch:  85
[Epoch 86, Batch 10] loss: 0.123
epoch:  86 val_f1:  0.7873856121514594 val_auroc:  0.8313696612665686 val_auprc:  0.9174298274272761
EarlyStopping counter: 1 out of 50
epoch:  86
[Epoch 87, Batch 10] loss: 0.113
epoch:  87 val_f1:  0.7598715939807772 val_auroc:  0.8323514972999508 val_auprc:  0.9178446814879875
EarlyStopping counter: 2 out of 50
epoch:  87
[Epoch 88, Batch 10] loss: 0.109
epoch:  88 val_f1:  0.80508331055267 val_auroc:  0.8311242022582229 val_auprc:  0.918271130817621
EarlyStopping counter: 3 out of 50
epoch:  88
[Epoch 89, Batch 10] loss: 0.110
epoch:  89 val_f1:  0.7598715939807772 val_auroc:  0.8333333333333334 val_auprc:  0.9184786823130726
EarlyStopping counter: 4 out of 50
epoch:  89
[Epoch 90, Batch 10] loss: 0.104
epoch:  90 val_f1:  0.7724732835091151 val_auroc:  0.8338242513500246 val_auprc:  0.9179617656640457
Validation loss improved to 0.184154
epoch:  90
[Epoch 91, Batch 10] loss: 0.097
epoch:  91 val_f1:  0.7598715939807772 val_auroc:  0.8333333333333334 val_auprc:  0.9183835173159884
EarlyStopping counter: 1 out of 50
epoch:  91
[Epoch 92, Batch 10] loss: 0.110
epoch:  92 val_f1:  0.7971323289800215 val_auroc:  0.8338242513500246 val_auprc:  0.9190202439284818
EarlyStopping counter: 2 out of 50
epoch:  92
[Epoch 93, Batch 10] loss: 0.104
epoch:  93 val_f1:  0.7906450372602754 val_auroc:  0.8352970054000981 val_auprc:  0.9199077431716054
EarlyStopping counter: 3 out of 50
epoch:  93
[Epoch 94, Batch 10] loss: 0.094
epoch:  94 val_f1:  0.7809570525397864 val_auroc:  0.8343151693667158 val_auprc:  0.9197673642421805
EarlyStopping counter: 4 out of 50
epoch:  94
[Epoch 95, Batch 10] loss: 0.103
epoch:  95 val_f1:  0.7707245329923307 val_auroc:  0.8362788414334806 val_auprc:  0.919523880127464
EarlyStopping counter: 5 out of 50
epoch:  95
[Epoch 96, Batch 10] loss: 0.095
epoch:  96 val_f1:  0.7598715939807772 val_auroc:  0.8345606283750614 val_auprc:  0.91854327099564
Validation loss improved to 0.182479
epoch:  96
[Epoch 97, Batch 10] loss: 0.096
epoch:  97 val_f1:  0.7890919075230509 val_auroc:  0.8303878252331861 val_auprc:  0.9172851507685833
EarlyStopping counter: 1 out of 50
epoch:  97
[Epoch 98, Batch 10] loss: 0.097
epoch:  98 val_f1:  0.7890919075230509 val_auroc:  0.8328424153166422 val_auprc:  0.9180878360008091
EarlyStopping counter: 2 out of 50
epoch:  98
[Epoch 99, Batch 10] loss: 0.084
epoch:  99 val_f1:  0.7971323289800215 val_auroc:  0.834806087383407 val_auprc:  0.9187649004704149
EarlyStopping counter: 3 out of 50
epoch:  99
[Epoch 100, Batch 10] loss: 0.097
epoch:  100 val_f1:  0.7622262794246104 val_auroc:  0.8318605792832597 val_auprc:  0.917328725912199
EarlyStopping counter: 4 out of 50
epoch:  100
[Epoch 101, Batch 10] loss: 0.100
epoch:  101 val_f1:  0.7598715939807772 val_auroc:  0.8362788414334806 val_auprc:  0.9185949011158391
Validation loss improved to 0.171989
epoch:  101
[Epoch 102, Batch 10] loss: 0.091
epoch:  102 val_f1:  0.7598715939807772 val_auroc:  0.8355424644084438 val_auprc:  0.9183070630284992
EarlyStopping counter: 1 out of 50
epoch:  102
[Epoch 103, Batch 10] loss: 0.098
epoch:  103 val_f1:  0.7791090204759269 val_auroc:  0.8340697103583702 val_auprc:  0.9180286659894256
EarlyStopping counter: 2 out of 50
epoch:  103
[Epoch 104, Batch 10] loss: 0.095
epoch:  104 val_f1:  0.7955599157038007 val_auroc:  0.834806087383407 val_auprc:  0.9183630553780071
EarlyStopping counter: 3 out of 50
epoch:  104
[Epoch 105, Batch 10] loss: 0.087
epoch:  105 val_f1:  0.7622262794246104 val_auroc:  0.8328424153166422 val_auprc:  0.9174818971025924
EarlyStopping counter: 4 out of 50
epoch:  105
[Epoch 106, Batch 10] loss: 0.091
epoch:  106 val_f1:  0.7777125328082551 val_auroc:  0.8333333333333334 val_auprc:  0.9182718852903244
EarlyStopping counter: 5 out of 50
epoch:  106
[Epoch 107, Batch 10] loss: 0.093
epoch:  107 val_f1:  0.7598715939807772 val_auroc:  0.8343151693667158 val_auprc:  0.9166867176757265
Validation loss improved to 0.170276
epoch:  107
[Epoch 108, Batch 10] loss: 0.094
epoch:  108 val_f1:  0.7791090204759269 val_auroc:  0.834806087383407 val_auprc:  0.9178284798757224
EarlyStopping counter: 1 out of 50
epoch:  108
[Epoch 109, Batch 10] loss: 0.084
epoch:  109 val_f1:  0.7971323289800215 val_auroc:  0.8357879234167893 val_auprc:  0.9181933323684608
EarlyStopping counter: 2 out of 50
epoch:  109
[Epoch 110, Batch 10] loss: 0.084
epoch:  110 val_f1:  0.7971323289800215 val_auroc:  0.832351497299951 val_auprc:  0.9157526018924755
EarlyStopping counter: 3 out of 50
epoch:  110
[Epoch 111, Batch 10] loss: 0.082
epoch:  111 val_f1:  0.7536081085870222 val_auroc:  0.8338242513500246 val_auprc:  0.9162287504781607
EarlyStopping counter: 4 out of 50
epoch:  111
[Epoch 112, Batch 10] loss: 0.079
epoch:  112 val_f1:  0.7707245329923307 val_auroc:  0.8328424153166422 val_auprc:  0.9151683266228055
EarlyStopping counter: 5 out of 50
epoch:  112
[Epoch 113, Batch 10] loss: 0.085
epoch:  113 val_f1:  0.8010188978004199 val_auroc:  0.8316151202749141 val_auprc:  0.9167410507172347
EarlyStopping counter: 6 out of 50
epoch:  113
[Epoch 114, Batch 10] loss: 0.081
epoch:  114 val_f1:  0.7890919075230509 val_auroc:  0.8345606283750614 val_auprc:  0.9177079499099405
EarlyStopping counter: 7 out of 50
epoch:  114
[Epoch 115, Batch 10] loss: 0.075
epoch:  115 val_f1:  0.7685409504908388 val_auroc:  0.8316151202749141 val_auprc:  0.9128490658736601
Validation loss improved to 0.168920
epoch:  115
[Epoch 116, Batch 10] loss: 0.080
epoch:  116 val_f1:  0.7598715939807772 val_auroc:  0.8328424153166422 val_auprc:  0.9148833847074247
Validation loss improved to 0.159108
epoch:  116
[Epoch 117, Batch 10] loss: 0.077
epoch:  117 val_f1:  0.7971323289800215 val_auroc:  0.8311242022582229 val_auprc:  0.9145371384683197
EarlyStopping counter: 1 out of 50
epoch:  117
[Epoch 118, Batch 10] loss: 0.078
epoch:  118 val_f1:  0.7791090204759269 val_auroc:  0.8343151693667158 val_auprc:  0.9177810214252475
EarlyStopping counter: 2 out of 50
epoch:  118
[Epoch 119, Batch 10] loss: 0.072
epoch:  119 val_f1:  0.7707245329923307 val_auroc:  0.8313696612665685 val_auprc:  0.9117207488963138
EarlyStopping counter: 3 out of 50
epoch:  119
[Epoch 120, Batch 10] loss: 0.073
epoch:  120 val_f1:  0.7598715939807772 val_auroc:  0.8352970054000981 val_auprc:  0.915739497602442
EarlyStopping counter: 4 out of 50
epoch:  120
[Epoch 121, Batch 10] loss: 0.075
epoch:  121 val_f1:  0.7598715939807772 val_auroc:  0.8316151202749141 val_auprc:  0.9120209991446453
EarlyStopping counter: 5 out of 50
epoch:  121
[Epoch 122, Batch 10] loss: 0.074
epoch:  122 val_f1:  0.7873856121514594 val_auroc:  0.8355424644084438 val_auprc:  0.9156643823755931
EarlyStopping counter: 6 out of 50
epoch:  122
[Epoch 123, Batch 10] loss: 0.067
epoch:  123 val_f1:  0.7873856121514594 val_auroc:  0.8355424644084438 val_auprc:  0.916014844496523
EarlyStopping counter: 7 out of 50
epoch:  123
[Epoch 124, Batch 10] loss: 0.064
epoch:  124 val_f1:  0.7809570525397864 val_auroc:  0.833578792341679 val_auprc:  0.9139347257854927
EarlyStopping counter: 8 out of 50
epoch:  124
[Epoch 125, Batch 10] loss: 0.066
epoch:  125 val_f1:  0.7598715939807772 val_auroc:  0.832842415316642 val_auprc:  0.909066787717661
Validation loss improved to 0.158618
epoch:  125
[Epoch 126, Batch 10] loss: 0.060
epoch:  126 val_f1:  0.7873856121514594 val_auroc:  0.8321060382916052 val_auprc:  0.9087678220615565
EarlyStopping counter: 1 out of 50
epoch:  126
[Epoch 127, Batch 10] loss: 0.069
epoch:  127 val_f1:  0.7809570525397864 val_auroc:  0.8311242022582229 val_auprc:  0.9083760757026726
EarlyStopping counter: 2 out of 50
epoch:  127
[Epoch 128, Batch 10] loss: 0.068
epoch:  128 val_f1:  0.7707245329923307 val_auroc:  0.833578792341679 val_auprc:  0.9078738975980081
EarlyStopping counter: 3 out of 50
epoch:  128
[Epoch 129, Batch 10] loss: 0.067
epoch:  129 val_f1:  0.7933255489848959 val_auroc:  0.832351497299951 val_auprc:  0.9096467659599711
EarlyStopping counter: 4 out of 50
epoch:  129
[Epoch 130, Batch 10] loss: 0.080
epoch:  130 val_f1:  0.7643829551743221 val_auroc:  0.8279332351497299 val_auprc:  0.9046292025469385
EarlyStopping counter: 5 out of 50
epoch:  130
[Epoch 131, Batch 10] loss: 0.066
epoch:  131 val_f1:  0.7873856121514594 val_auroc:  0.8338242513500246 val_auprc:  0.9078409720373837
EarlyStopping counter: 6 out of 50
epoch:  131
[Epoch 132, Batch 10] loss: 0.067
epoch:  132 val_f1:  0.7622262794246104 val_auroc:  0.832351497299951 val_auprc:  0.9071368734433609
EarlyStopping counter: 7 out of 50
epoch:  132
[Epoch 133, Batch 10] loss: 0.066
epoch:  133 val_f1:  0.7707245329923307 val_auroc:  0.832351497299951 val_auprc:  0.9074511614062988
EarlyStopping counter: 8 out of 50
epoch:  133
[Epoch 134, Batch 10] loss: 0.057
epoch:  134 val_f1:  0.7809570525397864 val_auroc:  0.8350515463917526 val_auprc:  0.9112950874155992
EarlyStopping counter: 9 out of 50
epoch:  134
[Epoch 135, Batch 10] loss: 0.060
epoch:  135 val_f1:  0.7890919075230509 val_auroc:  0.8352970054000982 val_auprc:  0.9090229426596961
EarlyStopping counter: 10 out of 50
epoch:  135
[Epoch 136, Batch 10] loss: 0.062
epoch:  136 val_f1:  0.7770871369605723 val_auroc:  0.8365243004418261 val_auprc:  0.9118984866684763
EarlyStopping counter: 11 out of 50
epoch:  136
[Epoch 137, Batch 10] loss: 0.069
epoch:  137 val_f1:  0.7598715939807772 val_auroc:  0.832351497299951 val_auprc:  0.9076192977400364
EarlyStopping counter: 12 out of 50
epoch:  137
[Epoch 138, Batch 10] loss: 0.056
epoch:  138 val_f1:  0.7707245329923307 val_auroc:  0.8345606283750614 val_auprc:  0.9100838304164408
EarlyStopping counter: 13 out of 50
epoch:  138
[Epoch 139, Batch 10] loss: 0.053
epoch:  139 val_f1:  0.7855164986057286 val_auroc:  0.8360333824251351 val_auprc:  0.909224455533415
EarlyStopping counter: 14 out of 50
epoch:  139
[Epoch 140, Batch 10] loss: 0.056
epoch:  140 val_f1:  0.7685409504908388 val_auroc:  0.8335787923416789 val_auprc:  0.9077680363813322
Validation loss improved to 0.157457
epoch:  140
[Epoch 141, Batch 10] loss: 0.056
epoch:  141 val_f1:  0.7707245329923307 val_auroc:  0.8340697103583701 val_auprc:  0.9083909573317075
EarlyStopping counter: 1 out of 50
epoch:  141
[Epoch 142, Batch 10] loss: 0.048
epoch:  142 val_f1:  0.7809570525397864 val_auroc:  0.8340697103583702 val_auprc:  0.9082972807851616
EarlyStopping counter: 2 out of 50
epoch:  142
[Epoch 143, Batch 10] loss: 0.057
epoch:  143 val_f1:  0.7906450372602754 val_auroc:  0.832351497299951 val_auprc:  0.9061062967951354
EarlyStopping counter: 3 out of 50
epoch:  143
[Epoch 144, Batch 10] loss: 0.057
epoch:  144 val_f1:  0.7791090204759269 val_auroc:  0.833578792341679 val_auprc:  0.9066873854293139
EarlyStopping counter: 4 out of 50
epoch:  144
[Epoch 145, Batch 10] loss: 0.056
epoch:  145 val_f1:  0.7762067639678805 val_auroc:  0.8323514972999508 val_auprc:  0.9062518637714774
EarlyStopping counter: 5 out of 50
epoch:  145
[Epoch 146, Batch 10] loss: 0.055
epoch:  146 val_f1:  0.7826417810500232 val_auroc:  0.8328424153166422 val_auprc:  0.9063268693442583
EarlyStopping counter: 6 out of 50
epoch:  146
[Epoch 147, Batch 10] loss: 0.050
epoch:  147 val_f1:  0.7873856121514594 val_auroc:  0.8348060873834069 val_auprc:  0.9050624476906003
EarlyStopping counter: 7 out of 50
epoch:  147
[Epoch 148, Batch 10] loss: 0.052
epoch:  148 val_f1:  0.7890919075230509 val_auroc:  0.8330878743249877 val_auprc:  0.9041623198323037
EarlyStopping counter: 8 out of 50
epoch:  148
[Epoch 149, Batch 10] loss: 0.052
epoch:  149 val_f1:  0.7685409504908388 val_auroc:  0.8343151693667158 val_auprc:  0.9065272983123148
Validation loss improved to 0.149998
epoch:  149
[Epoch 150, Batch 10] loss: 0.060
epoch:  150 val_f1:  0.7791090204759269 val_auroc:  0.8343151693667158 val_auprc:  0.9051939421043594
EarlyStopping counter: 1 out of 50
epoch:  150
[Epoch 151, Batch 10] loss: 0.053
epoch:  151 val_f1:  0.7791090204759269 val_auroc:  0.8330878743249878 val_auprc:  0.9045324526703036
EarlyStopping counter: 2 out of 50
epoch:  151
[Epoch 152, Batch 10] loss: 0.043
epoch:  152 val_f1:  0.7685409504908388 val_auroc:  0.8340697103583702 val_auprc:  0.9067588149306991
EarlyStopping counter: 3 out of 50
epoch:  152
[Epoch 153, Batch 10] loss: 0.049
epoch:  153 val_f1:  0.7873856121514594 val_auroc:  0.8335787923416791 val_auprc:  0.9048666218800432
EarlyStopping counter: 4 out of 50
epoch:  153
[Epoch 154, Batch 10] loss: 0.047
epoch:  154 val_f1:  0.7809570525397864 val_auroc:  0.8303878252331861 val_auprc:  0.9032183465723962
EarlyStopping counter: 5 out of 50
epoch:  154
[Epoch 155, Batch 10] loss: 0.044
epoch:  155 val_f1:  0.7791090204759269 val_auroc:  0.8328424153166422 val_auprc:  0.9042331649079598
EarlyStopping counter: 6 out of 50
epoch:  155
[Epoch 156, Batch 10] loss: 0.046
epoch:  156 val_f1:  0.7791090204759269 val_auroc:  0.8316151202749141 val_auprc:  0.9038719304925303
EarlyStopping counter: 7 out of 50
epoch:  156
[Epoch 157, Batch 10] loss: 0.044
epoch:  157 val_f1:  0.7873856121514594 val_auroc:  0.832351497299951 val_auprc:  0.9042137650492312
EarlyStopping counter: 8 out of 50
epoch:  157
[Epoch 158, Batch 10] loss: 0.045
epoch:  158 val_f1:  0.7598715939807772 val_auroc:  0.8303878252331861 val_auprc:  0.9028731433065047
Validation loss improved to 0.145169
epoch:  158
[Epoch 159, Batch 10] loss: 0.050
epoch:  159 val_f1:  0.7770871369605723 val_auroc:  0.8311242022582229 val_auprc:  0.9037216052642338
EarlyStopping counter: 1 out of 50
epoch:  159
[Epoch 160, Batch 10] loss: 0.043
epoch:  160 val_f1:  0.7873856121514594 val_auroc:  0.8328424153166422 val_auprc:  0.9047683475356247
EarlyStopping counter: 2 out of 50
epoch:  160
[Epoch 161, Batch 10] loss: 0.043
epoch:  161 val_f1:  0.7598715939807772 val_auroc:  0.8264604810996563 val_auprc:  0.8977656234408888
Validation loss improved to 0.142150
epoch:  161
[Epoch 162, Batch 10] loss: 0.040
epoch:  162 val_f1:  0.7873856121514594 val_auroc:  0.8333333333333333 val_auprc:  0.9048269500926661
EarlyStopping counter: 1 out of 50
epoch:  162
[Epoch 163, Batch 10] loss: 0.043
epoch:  163 val_f1:  0.7598715939807772 val_auroc:  0.8313696612665684 val_auprc:  0.9008938222691188
EarlyStopping counter: 2 out of 50
epoch:  163
[Epoch 164, Batch 10] loss: 0.043
epoch:  164 val_f1:  0.7598715939807772 val_auroc:  0.8301423662248404 val_auprc:  0.9003421618047365
Validation loss improved to 0.140559
epoch:  164
[Epoch 165, Batch 10] loss: 0.040
epoch:  165 val_f1:  0.7873856121514594 val_auroc:  0.8311242022582229 val_auprc:  0.900668586081131
EarlyStopping counter: 1 out of 50
epoch:  165
[Epoch 166, Batch 10] loss: 0.041
epoch:  166 val_f1:  0.7598715939807772 val_auroc:  0.8281786941580757 val_auprc:  0.8993865723553062
EarlyStopping counter: 2 out of 50
epoch:  166
[Epoch 167, Batch 10] loss: 0.042
epoch:  167 val_f1:  0.7598715939807772 val_auroc:  0.8284241531664212 val_auprc:  0.8994750981614719
EarlyStopping counter: 3 out of 50
epoch:  167
[Epoch 168, Batch 10] loss: 0.038
epoch:  168 val_f1:  0.7770871369605723 val_auroc:  0.8308787432498772 val_auprc:  0.900621727704636
Validation loss improved to 0.140024
epoch:  168
[Epoch 169, Batch 10] loss: 0.041
epoch:  169 val_f1:  0.757304835743056 val_auroc:  0.8291605301914581 val_auprc:  0.8996130485769722
Validation loss improved to 0.125707
epoch:  169
[Epoch 170, Batch 10] loss: 0.041
epoch:  170 val_f1:  0.7510724063582411 val_auroc:  0.8308787432498773 val_auprc:  0.9007445915771624
EarlyStopping counter: 1 out of 50
epoch:  170
[Epoch 171, Batch 10] loss: 0.036
epoch:  171 val_f1:  0.7598715939807772 val_auroc:  0.8286696121747668 val_auprc:  0.8986453148674861
EarlyStopping counter: 2 out of 50
epoch:  171
[Epoch 172, Batch 10] loss: 0.038
epoch:  172 val_f1:  0.7791090204759269 val_auroc:  0.8306332842415316 val_auprc:  0.9003141193154709
EarlyStopping counter: 3 out of 50
epoch:  172
[Epoch 173, Batch 10] loss: 0.041
epoch:  173 val_f1:  0.7598715939807772 val_auroc:  0.8296514482081492 val_auprc:  0.9002300453421208
EarlyStopping counter: 4 out of 50
epoch:  173
[Epoch 174, Batch 10] loss: 0.036
epoch:  174 val_f1:  0.7791090204759269 val_auroc:  0.8306332842415317 val_auprc:  0.901004862695734
EarlyStopping counter: 5 out of 50
epoch:  174
[Epoch 175, Batch 10] loss: 0.041
epoch:  175 val_f1:  0.7873856121514594 val_auroc:  0.8316151202749141 val_auprc:  0.9012782149514842
EarlyStopping counter: 6 out of 50
epoch:  175
[Epoch 176, Batch 10] loss: 0.037
epoch:  176 val_f1:  0.7809570525397864 val_auroc:  0.8318605792832597 val_auprc:  0.9016250318212125
EarlyStopping counter: 7 out of 50
epoch:  176
[Epoch 177, Batch 10] loss: 0.035
epoch:  177 val_f1:  0.7707245329923307 val_auroc:  0.8308787432498772 val_auprc:  0.9003888332380557
EarlyStopping counter: 8 out of 50
epoch:  177
[Epoch 178, Batch 10] loss: 0.034
epoch:  178 val_f1:  0.7826417810500232 val_auroc:  0.830387825233186 val_auprc:  0.9007656721426798
EarlyStopping counter: 9 out of 50
epoch:  178
[Epoch 179, Batch 10] loss: 0.031
epoch:  179 val_f1:  0.7855164986057286 val_auroc:  0.830387825233186 val_auprc:  0.9003076810461612
EarlyStopping counter: 10 out of 50
epoch:  179
[Epoch 180, Batch 10] loss: 0.032
epoch:  180 val_f1:  0.7855164986057286 val_auroc:  0.8301423662248405 val_auprc:  0.900572848621052
EarlyStopping counter: 11 out of 50
epoch:  180
[Epoch 181, Batch 10] loss: 0.033
epoch:  181 val_f1:  0.7685409504908388 val_auroc:  0.8298969072164948 val_auprc:  0.9001957175131935
EarlyStopping counter: 12 out of 50
epoch:  181
[Epoch 182, Batch 10] loss: 0.031
epoch:  182 val_f1:  0.7873856121514594 val_auroc:  0.8321060382916053 val_auprc:  0.9015025863300717
EarlyStopping counter: 13 out of 50
epoch:  182
[Epoch 183, Batch 10] loss: 0.031
epoch:  183 val_f1:  0.7873856121514594 val_auroc:  0.8298969072164949 val_auprc:  0.9002491451620322
EarlyStopping counter: 14 out of 50
epoch:  183
[Epoch 184, Batch 10] loss: 0.031
epoch:  184 val_f1:  0.7770871369605723 val_auroc:  0.832351497299951 val_auprc:  0.9014154924333675
EarlyStopping counter: 15 out of 50
epoch:  184
[Epoch 185, Batch 10] loss: 0.031
epoch:  185 val_f1:  0.7938350857775318 val_auroc:  0.8313696612665684 val_auprc:  0.9009516359621883
EarlyStopping counter: 16 out of 50
epoch:  185
[Epoch 186, Batch 10] loss: 0.035
epoch:  186 val_f1:  0.7685409504908388 val_auroc:  0.8284241531664212 val_auprc:  0.8994410102729513
EarlyStopping counter: 17 out of 50
epoch:  186
[Epoch 187, Batch 10] loss: 0.033
epoch:  187 val_f1:  0.7598715939807772 val_auroc:  0.8306332842415316 val_auprc:  0.9005476210012355
EarlyStopping counter: 18 out of 50
epoch:  187
[Epoch 188, Batch 10] loss: 0.031
epoch:  188 val_f1:  0.7855164986057286 val_auroc:  0.8298969072164949 val_auprc:  0.9000284811069407
EarlyStopping counter: 19 out of 50
epoch:  188
[Epoch 189, Batch 10] loss: 0.028
epoch:  189 val_f1:  0.7791090204759269 val_auroc:  0.8289150711831125 val_auprc:  0.8995759010547941
EarlyStopping counter: 20 out of 50
epoch:  189
[Epoch 190, Batch 10] loss: 0.029
epoch:  190 val_f1:  0.7938350857775318 val_auroc:  0.8321060382916053 val_auprc:  0.9011092170046813
EarlyStopping counter: 21 out of 50
epoch:  190
[Epoch 191, Batch 10] loss: 0.029
epoch:  191 val_f1:  0.7622262794246104 val_auroc:  0.8276877761413843 val_auprc:  0.8987227808255676
EarlyStopping counter: 22 out of 50
epoch:  191
[Epoch 192, Batch 10] loss: 0.029
epoch:  192 val_f1:  0.7707245329923307 val_auroc:  0.8289150711831125 val_auprc:  0.8990380726173394
EarlyStopping counter: 23 out of 50
epoch:  192
[Epoch 193, Batch 10] loss: 0.030
epoch:  193 val_f1:  0.7598715939807772 val_auroc:  0.8286696121747668 val_auprc:  0.8993228645811907
EarlyStopping counter: 24 out of 50
epoch:  193
[Epoch 194, Batch 10] loss: 0.027
epoch:  194 val_f1:  0.7685409504908388 val_auroc:  0.8298969072164949 val_auprc:  0.8999911934239959
EarlyStopping counter: 25 out of 50
epoch:  194
[Epoch 195, Batch 10] loss: 0.026
epoch:  195 val_f1:  0.7873856121514594 val_auroc:  0.829160530191458 val_auprc:  0.8994811070626886
EarlyStopping counter: 26 out of 50
epoch:  195
[Epoch 196, Batch 10] loss: 0.025
epoch:  196 val_f1:  0.7873856121514594 val_auroc:  0.831615120274914 val_auprc:  0.9011769239851634
EarlyStopping counter: 27 out of 50
epoch:  196
[Epoch 197, Batch 10] loss: 0.025
epoch:  197 val_f1:  0.7598715939807772 val_auroc:  0.8296514482081492 val_auprc:  0.8998959343975426
EarlyStopping counter: 28 out of 50
epoch:  197
[Epoch 198, Batch 10] loss: 0.026
epoch:  198 val_f1:  0.7855164986057286 val_auroc:  0.8298969072164949 val_auprc:  0.9000686775548832
EarlyStopping counter: 29 out of 50
epoch:  198
[Epoch 199, Batch 10] loss: 0.027
epoch:  199 val_f1:  0.7685409504908388 val_auroc:  0.8276877761413843 val_auprc:  0.8990333725934558
EarlyStopping counter: 30 out of 50
epoch:  199
[Epoch 200, Batch 10] loss: 0.028
epoch:  200 val_f1:  0.7598715939807772 val_auroc:  0.8308787432498773 val_auprc:  0.9004138538137877
Validation loss improved to 0.120646
epoch:  200
[Epoch 201, Batch 10] loss: 0.027
epoch:  201 val_f1:  0.7510724063582411 val_auroc:  0.8284241531664213 val_auprc:  0.8992566005189772
EarlyStopping counter: 1 out of 50
epoch:  201
[Epoch 202, Batch 10] loss: 0.028
epoch:  202 val_f1:  0.7873856121514594 val_auroc:  0.8296514482081492 val_auprc:  0.9001640302031406
EarlyStopping counter: 2 out of 50
epoch:  202
[Epoch 203, Batch 10] loss: 0.024
epoch:  203 val_f1:  0.7791090204759269 val_auroc:  0.8286696121747669 val_auprc:  0.899513880909103
EarlyStopping counter: 3 out of 50
epoch:  203
[Epoch 204, Batch 10] loss: 0.026
epoch:  204 val_f1:  0.7598715939807772 val_auroc:  0.8281786941580757 val_auprc:  0.8990379818367822
EarlyStopping counter: 4 out of 50
epoch:  204
[Epoch 205, Batch 10] loss: 0.024
epoch:  205 val_f1:  0.7598715939807772 val_auroc:  0.8294059891998037 val_auprc:  0.8997760933231136
EarlyStopping counter: 5 out of 50
epoch:  205
[Epoch 206, Batch 10] loss: 0.024
epoch:  206 val_f1:  0.7598715939807772 val_auroc:  0.8276877761413843 val_auprc:  0.8983555994612065
Validation loss improved to 0.120290
epoch:  206
[Epoch 207, Batch 10] loss: 0.024
epoch:  207 val_f1:  0.7938350857775318 val_auroc:  0.8311242022582229 val_auprc:  0.9009866109379785
EarlyStopping counter: 1 out of 50
epoch:  207
[Epoch 208, Batch 10] loss: 0.024
epoch:  208 val_f1:  0.7873856121514594 val_auroc:  0.829160530191458 val_auprc:  0.899754775578606
EarlyStopping counter: 2 out of 50
epoch:  208
[Epoch 209, Batch 10] loss: 0.022
epoch:  209 val_f1:  0.7791090204759269 val_auroc:  0.8281786941580755 val_auprc:  0.8993251018997979
EarlyStopping counter: 3 out of 50
epoch:  209
[Epoch 210, Batch 10] loss: 0.021
epoch:  210 val_f1:  0.7770871369605723 val_auroc:  0.8316151202749141 val_auprc:  0.9012786204552802
EarlyStopping counter: 4 out of 50
epoch:  210
[Epoch 211, Batch 10] loss: 0.021
epoch:  211 val_f1:  0.7685409504908388 val_auroc:  0.8281786941580757 val_auprc:  0.8978019903647978
EarlyStopping counter: 5 out of 50
epoch:  211
[Epoch 212, Batch 10] loss: 0.024
epoch:  212 val_f1:  0.7770871369605723 val_auroc:  0.8298969072164949 val_auprc:  0.8993452516274234
EarlyStopping counter: 6 out of 50
epoch:  212
[Epoch 213, Batch 10] loss: 0.023
epoch:  213 val_f1:  0.7598715939807772 val_auroc:  0.829160530191458 val_auprc:  0.8990504651728506
Validation loss improved to 0.116957
epoch:  213
[Epoch 214, Batch 10] loss: 0.021
epoch:  214 val_f1:  0.7685409504908388 val_auroc:  0.826705940108002 val_auprc:  0.8982363211305698
EarlyStopping counter: 1 out of 50
epoch:  214
[Epoch 215, Batch 10] loss: 0.023
epoch:  215 val_f1:  0.7598715939807772 val_auroc:  0.8274423171330387 val_auprc:  0.8977852457919955
EarlyStopping counter: 2 out of 50
epoch:  215
[Epoch 216, Batch 10] loss: 0.020
epoch:  216 val_f1:  0.757304835743056 val_auroc:  0.82793323514973 val_auprc:  0.8978739855436646
Validation loss improved to 0.107331
epoch:  216
[Epoch 217, Batch 10] loss: 0.019
epoch:  217 val_f1:  0.7685409504908388 val_auroc:  0.8301423662248404 val_auprc:  0.9003801924567887
EarlyStopping counter: 1 out of 50
epoch:  217
[Epoch 218, Batch 10] loss: 0.020
epoch:  218 val_f1:  0.7707245329923307 val_auroc:  0.8284241531664213 val_auprc:  0.8997671912313538
EarlyStopping counter: 2 out of 50
epoch:  218
[Epoch 219, Batch 10] loss: 0.019
epoch:  219 val_f1:  0.7685409504908388 val_auroc:  0.8281786941580757 val_auprc:  0.8989313344568491
EarlyStopping counter: 3 out of 50
epoch:  219
[Epoch 220, Batch 10] loss: 0.018
epoch:  220 val_f1:  0.7938350857775318 val_auroc:  0.8306332842415317 val_auprc:  0.9004671834328462
EarlyStopping counter: 4 out of 50
epoch:  220
[Epoch 221, Batch 10] loss: 0.021
epoch:  221 val_f1:  0.7938350857775318 val_auroc:  0.8286696121747669 val_auprc:  0.8991857472367661
EarlyStopping counter: 5 out of 50
epoch:  221
[Epoch 222, Batch 10] loss: 0.018
epoch:  222 val_f1:  0.7685409504908388 val_auroc:  0.8281786941580757 val_auprc:  0.8988063187978803
EarlyStopping counter: 6 out of 50
epoch:  222
[Epoch 223, Batch 10] loss: 0.020
epoch:  223 val_f1:  0.7510724063582411 val_auroc:  0.8313696612665685 val_auprc:  0.9006732188283287
EarlyStopping counter: 7 out of 50
epoch:  223
[Epoch 224, Batch 10] loss: 0.021
epoch:  224 val_f1:  0.7873856121514594 val_auroc:  0.8291605301914581 val_auprc:  0.8997567806390729
EarlyStopping counter: 8 out of 50
epoch:  224
[Epoch 225, Batch 10] loss: 0.017
epoch:  225 val_f1:  0.7873856121514594 val_auroc:  0.8313696612665685 val_auprc:  0.901057473086033
EarlyStopping counter: 9 out of 50
epoch:  225
[Epoch 226, Batch 10] loss: 0.020
epoch:  226 val_f1:  0.7685409504908388 val_auroc:  0.8281786941580757 val_auprc:  0.8981023658864171
EarlyStopping counter: 10 out of 50
epoch:  226
[Epoch 227, Batch 10] loss: 0.019
epoch:  227 val_f1:  0.7510724063582411 val_auroc:  0.82793323514973 val_auprc:  0.8977139695319298
Validation loss improved to 0.106978
epoch:  227
[Epoch 228, Batch 10] loss: 0.019
epoch:  228 val_f1:  0.7510724063582411 val_auroc:  0.8301423662248405 val_auprc:  0.899327157379245
EarlyStopping counter: 1 out of 50
epoch:  228
[Epoch 229, Batch 10] loss: 0.018
epoch:  229 val_f1:  0.7791090204759269 val_auroc:  0.8279332351497299 val_auprc:  0.899307252788633
EarlyStopping counter: 2 out of 50
epoch:  229
[Epoch 230, Batch 10] loss: 0.016
epoch:  230 val_f1:  0.7707245329923307 val_auroc:  0.8267059401080019 val_auprc:  0.8984332012619795
EarlyStopping counter: 3 out of 50
epoch:  230
[Epoch 231, Batch 10] loss: 0.016
epoch:  231 val_f1:  0.7770871369605723 val_auroc:  0.8274423171330388 val_auprc:  0.8983797273462284
EarlyStopping counter: 4 out of 50
epoch:  231
[Epoch 232, Batch 10] loss: 0.017
epoch:  232 val_f1:  0.7685409504908388 val_auroc:  0.8252331860579284 val_auprc:  0.8976701405205898
EarlyStopping counter: 5 out of 50
epoch:  232
[Epoch 233, Batch 10] loss: 0.017
epoch:  233 val_f1:  0.7938350857775318 val_auroc:  0.830387825233186 val_auprc:  0.8997234234569192
EarlyStopping counter: 6 out of 50
epoch:  233
[Epoch 234, Batch 10] loss: 0.019
epoch:  234 val_f1:  0.7635640416019908 val_auroc:  0.8256013745704468 val_auprc:  0.894956602865514
Validation loss improved to 0.106222
epoch:  234
[Epoch 235, Batch 10] loss: 0.016
epoch:  235 val_f1:  0.7685409504908388 val_auroc:  0.8302650957290132 val_auprc:  0.8980055106076409
EarlyStopping counter: 1 out of 50
epoch:  235
[Epoch 236, Batch 10] loss: 0.016
epoch:  236 val_f1:  0.7510724063582411 val_auroc:  0.8281786941580757 val_auprc:  0.8985049061148744
EarlyStopping counter: 2 out of 50
epoch:  236
[Epoch 237, Batch 10] loss: 0.016
epoch:  237 val_f1:  0.7770871369605723 val_auroc:  0.8276877761413844 val_auprc:  0.8987304663294235
EarlyStopping counter: 3 out of 50
epoch:  237
[Epoch 238, Batch 10] loss: 0.014
epoch:  238 val_f1:  0.7873856121514594 val_auroc:  0.8294059891998037 val_auprc:  0.9000603802439815
EarlyStopping counter: 4 out of 50
epoch:  238
[Epoch 239, Batch 10] loss: 0.018
epoch:  239 val_f1:  0.7873856121514594 val_auroc:  0.8298969072164949 val_auprc:  0.8999809781796236
EarlyStopping counter: 5 out of 50
epoch:  239
[Epoch 240, Batch 10] loss: 0.017
epoch:  240 val_f1:  0.7855164986057286 val_auroc:  0.8301423662248405 val_auprc:  0.9000510672819259
EarlyStopping counter: 6 out of 50
epoch:  240
[Epoch 241, Batch 10] loss: 0.014
epoch:  241 val_f1:  0.7770871369605723 val_auroc:  0.8281786941580757 val_auprc:  0.8981378701885913
EarlyStopping counter: 7 out of 50
epoch:  241
[Epoch 242, Batch 10] loss: 0.015
epoch:  242 val_f1:  0.7938350857775318 val_auroc:  0.8296514482081493 val_auprc:  0.8999545810348586
EarlyStopping counter: 8 out of 50
epoch:  242
[Epoch 243, Batch 10] loss: 0.014
epoch:  243 val_f1:  0.7855164986057286 val_auroc:  0.8294059891998036 val_auprc:  0.8990706388149063
EarlyStopping counter: 9 out of 50
epoch:  243
[Epoch 244, Batch 10] loss: 0.014
epoch:  244 val_f1:  0.7770871369605723 val_auroc:  0.8284241531664213 val_auprc:  0.8984159640086189
EarlyStopping counter: 10 out of 50
epoch:  244
[Epoch 245, Batch 10] loss: 0.013
epoch:  245 val_f1:  0.7685409504908388 val_auroc:  0.8276877761413844 val_auprc:  0.8982547418411895
EarlyStopping counter: 11 out of 50
epoch:  245
[Epoch 246, Batch 10] loss: 0.014
epoch:  246 val_f1:  0.7598715939807772 val_auroc:  0.8289150711831125 val_auprc:  0.898334799305936
EarlyStopping counter: 12 out of 50
epoch:  246
[Epoch 247, Batch 10] loss: 0.015
epoch:  247 val_f1:  0.7873856121514594 val_auroc:  0.8298969072164948 val_auprc:  0.8996401461481573
EarlyStopping counter: 13 out of 50
epoch:  247
[Epoch 248, Batch 10] loss: 0.015
epoch:  248 val_f1:  0.7873856121514594 val_auroc:  0.8267059401080019 val_auprc:  0.8944427456224989
EarlyStopping counter: 14 out of 50
epoch:  248
[Epoch 249, Batch 10] loss: 0.013
epoch:  249 val_f1:  0.7873856121514594 val_auroc:  0.8280559646539027 val_auprc:  0.8970518061512899
EarlyStopping counter: 15 out of 50
epoch:  249
[Epoch 250, Batch 10] loss: 0.013
epoch:  250 val_f1:  0.7770871369605723 val_auroc:  0.8289150711831125 val_auprc:  0.8981065866712075
EarlyStopping counter: 16 out of 50
epoch:  250
[Epoch 251, Batch 10] loss: 0.014
epoch:  251 val_f1:  0.757304835743056 val_auroc:  0.8294059891998037 val_auprc:  0.8984251275979985
Validation loss improved to 0.101953
epoch:  251
[Epoch 252, Batch 10] loss: 0.013
epoch:  252 val_f1:  0.7510724063582411 val_auroc:  0.8298969072164948 val_auprc:  0.8989791693181127
EarlyStopping counter: 1 out of 50
epoch:  252
[Epoch 253, Batch 10] loss: 0.014
epoch:  253 val_f1:  0.7598715939807772 val_auroc:  0.8284241531664213 val_auprc:  0.8982468739471496
EarlyStopping counter: 2 out of 50
epoch:  253
[Epoch 254, Batch 10] loss: 0.014
epoch:  254 val_f1:  0.7685409504908388 val_auroc:  0.8301423662248405 val_auprc:  0.8999929790395045
EarlyStopping counter: 3 out of 50
epoch:  254
[Epoch 255, Batch 10] loss: 0.013
epoch:  255 val_f1:  0.7770871369605723 val_auroc:  0.8306332842415317 val_auprc:  0.9001071049644378
EarlyStopping counter: 4 out of 50
epoch:  255
[Epoch 256, Batch 10] loss: 0.012
epoch:  256 val_f1:  0.7873856121514594 val_auroc:  0.8269513991163476 val_auprc:  0.8944180182554579
EarlyStopping counter: 5 out of 50
epoch:  256
[Epoch 257, Batch 10] loss: 0.013
epoch:  257 val_f1:  0.7873856121514594 val_auroc:  0.8274423171330388 val_auprc:  0.8951436786524216
EarlyStopping counter: 6 out of 50
epoch:  257
[Epoch 258, Batch 10] loss: 0.013
epoch:  258 val_f1:  0.7770871369605723 val_auroc:  0.8283014236622485 val_auprc:  0.897150716533229
EarlyStopping counter: 7 out of 50
epoch:  258
[Epoch 259, Batch 10] loss: 0.012
epoch:  259 val_f1:  0.7873856121514594 val_auroc:  0.8278105056455571 val_auprc:  0.8969945694303876
EarlyStopping counter: 8 out of 50
epoch:  259
[Epoch 260, Batch 10] loss: 0.012
epoch:  260 val_f1:  0.7855164986057286 val_auroc:  0.8271968581246932 val_auprc:  0.8949623015988117
EarlyStopping counter: 9 out of 50
epoch:  260
[Epoch 261, Batch 10] loss: 0.011
epoch:  261 val_f1:  0.7770871369605723 val_auroc:  0.827319587628866 val_auprc:  0.8966769727171088
EarlyStopping counter: 10 out of 50
epoch:  261
[Epoch 262, Batch 10] loss: 0.011
epoch:  262 val_f1:  0.7873856121514594 val_auroc:  0.8287923416789397 val_auprc:  0.8979404893249411
EarlyStopping counter: 11 out of 50
epoch:  262
[Epoch 263, Batch 10] loss: 0.013
epoch:  263 val_f1:  0.7873856121514594 val_auroc:  0.8275650466372116 val_auprc:  0.8968692318479259
EarlyStopping counter: 12 out of 50
epoch:  263
[Epoch 264, Batch 10] loss: 0.013
epoch:  264 val_f1:  0.7873856121514594 val_auroc:  0.8274423171330387 val_auprc:  0.8950217223028708
EarlyStopping counter: 13 out of 50
epoch:  264
[Epoch 265, Batch 10] loss: 0.011
epoch:  265 val_f1:  0.7707245329923307 val_auroc:  0.8271968581246931 val_auprc:  0.8949421453153578
EarlyStopping counter: 14 out of 50
epoch:  265
[Epoch 266, Batch 10] loss: 0.010
epoch:  266 val_f1:  0.7685409504908388 val_auroc:  0.8270741286205204 val_auprc:  0.8964636353904061
EarlyStopping counter: 15 out of 50
epoch:  266
[Epoch 267, Batch 10] loss: 0.012
epoch:  267 val_f1:  0.7770871369605723 val_auroc:  0.8271968581246932 val_auprc:  0.894788008767178
EarlyStopping counter: 16 out of 50
epoch:  267
[Epoch 268, Batch 10] loss: 0.011
epoch:  268 val_f1:  0.7510724063582411 val_auroc:  0.8273195876288659 val_auprc:  0.8963639728494102
EarlyStopping counter: 17 out of 50
epoch:  268
[Epoch 269, Batch 10] loss: 0.011
epoch:  269 val_f1:  0.7598715939807772 val_auroc:  0.826092292587138 val_auprc:  0.8959735288494494
EarlyStopping counter: 18 out of 50
epoch:  269
[Epoch 270, Batch 10] loss: 0.011
epoch:  270 val_f1:  0.7770871369605723 val_auroc:  0.8280559646539029 val_auprc:  0.8966955973593373
EarlyStopping counter: 19 out of 50
epoch:  270
[Epoch 271, Batch 10] loss: 0.009
epoch:  271 val_f1:  0.7873856121514594 val_auroc:  0.8289150711831125 val_auprc:  0.8959417805607937
EarlyStopping counter: 20 out of 50
epoch:  271
[Epoch 272, Batch 10] loss: 0.011
epoch:  272 val_f1:  0.7791090204759269 val_auroc:  0.8249877270495828 val_auprc:  0.8929236857209605
EarlyStopping counter: 21 out of 50
epoch:  272
[Epoch 273, Batch 10] loss: 0.010
epoch:  273 val_f1:  0.7873856121514594 val_auroc:  0.8286696121747669 val_auprc:  0.8954296577668686
EarlyStopping counter: 22 out of 50
epoch:  273
[Epoch 274, Batch 10] loss: 0.010
epoch:  274 val_f1:  0.7770871369605723 val_auroc:  0.8292832596956309 val_auprc:  0.8973235266655235
EarlyStopping counter: 23 out of 50
epoch:  274
[Epoch 275, Batch 10] loss: 0.011
epoch:  275 val_f1:  0.7873856121514594 val_auroc:  0.826705940108002 val_auprc:  0.8939591504043546
EarlyStopping counter: 24 out of 50
epoch:  275
[Epoch 276, Batch 10] loss: 0.010
epoch:  276 val_f1:  0.7873856121514594 val_auroc:  0.8279332351497299 val_auprc:  0.8951477706858032
EarlyStopping counter: 25 out of 50
epoch:  276
[Epoch 277, Batch 10] loss: 0.011
epoch:  277 val_f1:  0.7873856121514594 val_auroc:  0.8264604810996564 val_auprc:  0.8947058743777936
EarlyStopping counter: 26 out of 50
epoch:  277
[Epoch 278, Batch 10] loss: 0.011
epoch:  278 val_f1:  0.7873856121514594 val_auroc:  0.8276877761413843 val_auprc:  0.8955133811327685
EarlyStopping counter: 27 out of 50
epoch:  278
[Epoch 279, Batch 10] loss: 0.011
epoch:  279 val_f1:  0.7770871369605723 val_auroc:  0.826705940108002 val_auprc:  0.8945978316778338
EarlyStopping counter: 28 out of 50
epoch:  279
[Epoch 280, Batch 10] loss: 0.009
epoch:  280 val_f1:  0.7791090204759269 val_auroc:  0.8271968581246932 val_auprc:  0.8950071357275782
EarlyStopping counter: 29 out of 50
epoch:  280
[Epoch 281, Batch 10] loss: 0.009
epoch:  281 val_f1:  0.7598715939807772 val_auroc:  0.8263377515954836 val_auprc:  0.8927142376964079
EarlyStopping counter: 30 out of 50
epoch:  281
[Epoch 282, Batch 10] loss: 0.009
epoch:  282 val_f1:  0.7791090204759269 val_auroc:  0.8269513991163475 val_auprc:  0.8947846685271014
EarlyStopping counter: 31 out of 50
epoch:  282
[Epoch 283, Batch 10] loss: 0.010
epoch:  283 val_f1:  0.7873856121514594 val_auroc:  0.8284241531664212 val_auprc:  0.8952546264012324
EarlyStopping counter: 32 out of 50
epoch:  283
[Epoch 284, Batch 10] loss: 0.008
epoch:  284 val_f1:  0.7598715939807772 val_auroc:  0.8262150220913107 val_auprc:  0.8935740259543189
EarlyStopping counter: 33 out of 50
epoch:  284
[Epoch 285, Batch 10] loss: 0.009
epoch:  285 val_f1:  0.7510724063582411 val_auroc:  0.8268286696121748 val_auprc:  0.8960868932487648
EarlyStopping counter: 34 out of 50
epoch:  285
[Epoch 286, Batch 10] loss: 0.009
epoch:  286 val_f1:  0.7510724063582411 val_auroc:  0.8265832106038291 val_auprc:  0.8959454114741388
EarlyStopping counter: 35 out of 50
epoch:  286
[Epoch 287, Batch 10] loss: 0.009
epoch:  287 val_f1:  0.7770871369605723 val_auroc:  0.8269513991163475 val_auprc:  0.8945371168308607
EarlyStopping counter: 36 out of 50
epoch:  287
[Epoch 288, Batch 10] loss: 0.008
epoch:  288 val_f1:  0.7510724063582411 val_auroc:  0.8260922925871379 val_auprc:  0.8956319889521052
Validation loss improved to 0.098627
epoch:  288
[Epoch 289, Batch 10] loss: 0.009
epoch:  289 val_f1:  0.7770871369605723 val_auroc:  0.8279332351497299 val_auprc:  0.894784018453928
EarlyStopping counter: 1 out of 50
epoch:  289
[Epoch 290, Batch 10] loss: 0.008
epoch:  290 val_f1:  0.7770871369605723 val_auroc:  0.8259695630829652 val_auprc:  0.8937163913959514
EarlyStopping counter: 2 out of 50
epoch:  290
[Epoch 291, Batch 10] loss: 0.009
epoch:  291 val_f1:  0.7770871369605723 val_auroc:  0.8276877761413843 val_auprc:  0.895016358699396
EarlyStopping counter: 3 out of 50
epoch:  291
[Epoch 292, Batch 10] loss: 0.008
epoch:  292 val_f1:  0.7685409504908388 val_auroc:  0.8259695630829652 val_auprc:  0.893742446879958
EarlyStopping counter: 4 out of 50
epoch:  292
[Epoch 293, Batch 10] loss: 0.007
epoch:  293 val_f1:  0.7873856121514594 val_auroc:  0.8274423171330387 val_auprc:  0.8945801309989931
EarlyStopping counter: 5 out of 50
epoch:  293
[Epoch 294, Batch 10] loss: 0.008
epoch:  294 val_f1:  0.7770871369605723 val_auroc:  0.82793323514973 val_auprc:  0.8944215246180887
EarlyStopping counter: 6 out of 50
epoch:  294
[Epoch 295, Batch 10] loss: 0.007
epoch:  295 val_f1:  0.7770871369605723 val_auroc:  0.8265832106038291 val_auprc:  0.8954056298779968
EarlyStopping counter: 7 out of 50
epoch:  295
[Epoch 296, Batch 10] loss: 0.007
epoch:  296 val_f1:  0.7770871369605723 val_auroc:  0.8264604810996564 val_auprc:  0.893869914497814
EarlyStopping counter: 8 out of 50
epoch:  296
[Epoch 297, Batch 10] loss: 0.008
epoch:  297 val_f1:  0.7510724063582411 val_auroc:  0.8265832106038291 val_auprc:  0.8957353227395739
EarlyStopping counter: 9 out of 50
epoch:  297
[Epoch 298, Batch 10] loss: 0.008
epoch:  298 val_f1:  0.757304835743056 val_auroc:  0.8268286696121747 val_auprc:  0.8961946169507358
EarlyStopping counter: 10 out of 50
epoch:  298
[Epoch 299, Batch 10] loss: 0.008
epoch:  299 val_f1:  0.7598715939807772 val_auroc:  0.8263377515954835 val_auprc:  0.8957811061222587
EarlyStopping counter: 11 out of 50
epoch:  299
[Epoch 300, Batch 10] loss: 0.007
epoch:  300 val_f1:  0.7770871369605723 val_auroc:  0.8262150220913108 val_auprc:  0.8946481191104958
EarlyStopping counter: 12 out of 50
epoch:  300
[Epoch 301, Batch 10] loss: 0.007
epoch:  301 val_f1:  0.7770871369605723 val_auroc:  0.8274423171330388 val_auprc:  0.8949346299284698
EarlyStopping counter: 13 out of 50
epoch:  301
[Epoch 302, Batch 10] loss: 0.007
epoch:  302 val_f1:  0.7770871369605723 val_auroc:  0.8257241040746196 val_auprc:  0.893499962419997
EarlyStopping counter: 14 out of 50
epoch:  302
[Epoch 303, Batch 10] loss: 0.006
epoch:  303 val_f1:  0.7770871369605723 val_auroc:  0.8270741286205203 val_auprc:  0.896380406529382
EarlyStopping counter: 15 out of 50
epoch:  303
[Epoch 304, Batch 10] loss: 0.008
epoch:  304 val_f1:  0.7685409504908388 val_auroc:  0.8271968581246932 val_auprc:  0.8906810037933728
EarlyStopping counter: 16 out of 50
epoch:  304
[Epoch 305, Batch 10] loss: 0.007
epoch:  305 val_f1:  0.7770871369605723 val_auroc:  0.8270741286205204 val_auprc:  0.8956130237310149
EarlyStopping counter: 17 out of 50
epoch:  305
[Epoch 306, Batch 10] loss: 0.007
epoch:  306 val_f1:  0.7770871369605723 val_auroc:  0.8264604810996563 val_auprc:  0.8904561317171045
EarlyStopping counter: 18 out of 50
epoch:  306
[Epoch 307, Batch 10] loss: 0.007
epoch:  307 val_f1:  0.7598715939807772 val_auroc:  0.8269513991163476 val_auprc:  0.8905631594359222
EarlyStopping counter: 19 out of 50
epoch:  307
[Epoch 308, Batch 10] loss: 0.007
epoch:  308 val_f1:  0.7685409504908388 val_auroc:  0.8264604810996563 val_auprc:  0.8899223911051031
EarlyStopping counter: 20 out of 50
epoch:  308
[Epoch 309, Batch 10] loss: 0.007
epoch:  309 val_f1:  0.7770871369605723 val_auroc:  0.826092292587138 val_auprc:  0.8953289154822741
EarlyStopping counter: 21 out of 50
epoch:  309
[Epoch 310, Batch 10] loss: 0.006
epoch:  310 val_f1:  0.7661589271850144 val_auroc:  0.8259695630829652 val_auprc:  0.89011126671074
EarlyStopping counter: 22 out of 50
epoch:  310
[Epoch 311, Batch 10] loss: 0.007
epoch:  311 val_f1:  0.7748796193569787 val_auroc:  0.8264604810996564 val_auprc:  0.8903746581191198
EarlyStopping counter: 23 out of 50
epoch:  311
[Epoch 312, Batch 10] loss: 0.007
epoch:  312 val_f1:  0.7685409504908388 val_auroc:  0.8281786941580755 val_auprc:  0.8910319314907849
EarlyStopping counter: 24 out of 50
epoch:  312
[Epoch 313, Batch 10] loss: 0.006
epoch:  313 val_f1:  0.7770871369605723 val_auroc:  0.8271968581246932 val_auprc:  0.8908958083104217
EarlyStopping counter: 25 out of 50
epoch:  313
[Epoch 314, Batch 10] loss: 0.006
epoch:  314 val_f1:  0.7770871369605723 val_auroc:  0.8259695630829651 val_auprc:  0.8901929017876357
EarlyStopping counter: 26 out of 50
epoch:  314
[Epoch 315, Batch 10] loss: 0.006
epoch:  315 val_f1:  0.7938350857775318 val_auroc:  0.8276877761413843 val_auprc:  0.8908886307293628
EarlyStopping counter: 27 out of 50
epoch:  315
[Epoch 316, Batch 10] loss: 0.007
epoch:  316 val_f1:  0.7748796193569787 val_auroc:  0.8264604810996564 val_auprc:  0.8902238181149364
EarlyStopping counter: 28 out of 50
epoch:  316
[Epoch 317, Batch 10] loss: 0.006
epoch:  317 val_f1:  0.7770871369605723 val_auroc:  0.8252331860579284 val_auprc:  0.8896535756895281
EarlyStopping counter: 29 out of 50
epoch:  317
[Epoch 318, Batch 10] loss: 0.006
epoch:  318 val_f1:  0.7770871369605723 val_auroc:  0.8257241040746196 val_auprc:  0.8901661842147754
EarlyStopping counter: 30 out of 50
epoch:  318
[Epoch 319, Batch 10] loss: 0.006
epoch:  319 val_f1:  0.7685409504908388 val_auroc:  0.8259695630829651 val_auprc:  0.8901538375820952
EarlyStopping counter: 31 out of 50
epoch:  319
[Epoch 320, Batch 10] loss: 0.006
epoch:  320 val_f1:  0.7685409504908388 val_auroc:  0.826705940108002 val_auprc:  0.8906826846964422
EarlyStopping counter: 32 out of 50
epoch:  320
[Epoch 321, Batch 10] loss: 0.006
epoch:  321 val_f1:  0.7661589271850144 val_auroc:  0.8257241040746196 val_auprc:  0.8898889733415307
EarlyStopping counter: 33 out of 50
epoch:  321
[Epoch 322, Batch 10] loss: 0.006
epoch:  322 val_f1:  0.7685409504908388 val_auroc:  0.8259695630829652 val_auprc:  0.8900924148392784
EarlyStopping counter: 34 out of 50
epoch:  322
[Epoch 323, Batch 10] loss: 0.005
epoch:  323 val_f1:  0.7770871369605723 val_auroc:  0.8264604810996564 val_auprc:  0.8902338881378691
EarlyStopping counter: 35 out of 50
epoch:  323
[Epoch 324, Batch 10] loss: 0.006
epoch:  324 val_f1:  0.7938350857775318 val_auroc:  0.8269513991163476 val_auprc:  0.8906384941435322
EarlyStopping counter: 36 out of 50
epoch:  324
[Epoch 325, Batch 10] loss: 0.006
epoch:  325 val_f1:  0.7770871369605723 val_auroc:  0.8269513991163476 val_auprc:  0.8903441358925696
EarlyStopping counter: 37 out of 50
epoch:  325
[Epoch 326, Batch 10] loss: 0.005
epoch:  326 val_f1:  0.7855164986057286 val_auroc:  0.8274423171330388 val_auprc:  0.891089515384337
EarlyStopping counter: 38 out of 50
epoch:  326
[Epoch 327, Batch 10] loss: 0.005
epoch:  327 val_f1:  0.7598715939807772 val_auroc:  0.826092292587138 val_auprc:  0.8926198531598089
EarlyStopping counter: 39 out of 50
epoch:  327
[Epoch 328, Batch 10] loss: 0.005
epoch:  328 val_f1:  0.7770871369605723 val_auroc:  0.826705940108002 val_auprc:  0.890531926569371
EarlyStopping counter: 40 out of 50
epoch:  328
[Epoch 329, Batch 10] loss: 0.005
epoch:  329 val_f1:  0.7770871369605723 val_auroc:  0.826705940108002 val_auprc:  0.8903369568898392
EarlyStopping counter: 41 out of 50
epoch:  329
[Epoch 330, Batch 10] loss: 0.005
epoch:  330 val_f1:  0.7791090204759269 val_auroc:  0.8269513991163475 val_auprc:  0.8907203650158043
EarlyStopping counter: 42 out of 50
epoch:  330
[Epoch 331, Batch 10] loss: 0.006
epoch:  331 val_f1:  0.7770871369605723 val_auroc:  0.8259695630829652 val_auprc:  0.8899447089819046
EarlyStopping counter: 43 out of 50
epoch:  331
[Epoch 332, Batch 10] loss: 0.005
epoch:  332 val_f1:  0.7685409504908388 val_auroc:  0.8259695630829652 val_auprc:  0.889883690789137
EarlyStopping counter: 44 out of 50
epoch:  332
[Epoch 333, Batch 10] loss: 0.005
epoch:  333 val_f1:  0.7685409504908388 val_auroc:  0.826092292587138 val_auprc:  0.8926295689019287
EarlyStopping counter: 45 out of 50
epoch:  333
[Epoch 334, Batch 10] loss: 0.005
epoch:  334 val_f1:  0.7770871369605723 val_auroc:  0.8259695630829652 val_auprc:  0.890317976144511
EarlyStopping counter: 46 out of 50
epoch:  334
[Epoch 335, Batch 10] loss: 0.005
epoch:  335 val_f1:  0.7685409504908388 val_auroc:  0.8256013745704467 val_auprc:  0.8924028808975197
EarlyStopping counter: 47 out of 50
epoch:  335
[Epoch 336, Batch 10] loss: 0.005
epoch:  336 val_f1:  0.7770871369605723 val_auroc:  0.8259695630829652 val_auprc:  0.8902031020861271
EarlyStopping counter: 48 out of 50
epoch:  336
[Epoch 337, Batch 10] loss: 0.005
epoch:  337 val_f1:  0.7685409504908388 val_auroc:  0.8263377515954835 val_auprc:  0.8929845744845998
EarlyStopping counter: 49 out of 50
epoch:  337
[Epoch 338, Batch 10] loss: 0.005
epoch:  338 val_f1:  0.7770871369605723 val_auroc:  0.826705940108002 val_auprc:  0.890567810704378
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  9118.999772787094
{'time_elapsed': [9118.999772787094], 'epoch': [337], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7770871369605723], 'auroc_test': [0.826705940108002], 'auprc_test': [0.890567810704378]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [32, 1]                   --
├─Sequential: 1-1                        [32, 1]                   --
│    └─Conv1d: 2-1                       [32, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [32, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [32, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [32, 1024, 1278]          --
│    └─Dropout: 2-5                      [32, 1024, 1278]          --
│    └─Flatten: 2-6                      [32, 1308672]             --
│    └─Linear: 2-7                       [32, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.16
Forward/backward pass size (MB): 671.09
Params size (MB): 5.26
Estimated Total Size (MB): 676.51
==========================================================================================
tensor(0.4369)
epoch:  0
[Epoch 1, Batch 10] loss: 0.653
epoch:  1 val_f1:  0.34917885089921374 val_auroc:  0.7373588610702013 val_auprc:  0.8486142999635473
epoch:  1
[Epoch 2, Batch 10] loss: 0.367
epoch:  2 val_f1:  0.2794387891531733 val_auroc:  0.7385861561119293 val_auprc:  0.810906068341447
EarlyStopping counter: 1 out of 50
epoch:  2
[Epoch 3, Batch 10] loss: 0.390
epoch:  3 val_f1:  0.7226305629385982 val_auroc:  0.7773686794305352 val_auprc:  0.8632360457259262
Validation loss improved to 0.324089
epoch:  3
[Epoch 4, Batch 10] loss: 0.349
epoch:  4 val_f1:  0.7536606851900262 val_auroc:  0.76313205694649 val_auprc:  0.8746940252505472
Validation loss improved to 0.314449
epoch:  4
[Epoch 5, Batch 10] loss: 0.342
epoch:  5 val_f1:  0.4130352995337797 val_auroc:  0.7555228276877761 val_auprc:  0.8728350520883981
EarlyStopping counter: 1 out of 50
epoch:  5
[Epoch 6, Batch 10] loss: 0.340
epoch:  6 val_f1:  0.7215941532488295 val_auroc:  0.7574864997545411 val_auprc:  0.875079951100166
Validation loss improved to 0.310318
epoch:  6
[Epoch 7, Batch 10] loss: 0.310
epoch:  7 val_f1:  0.7362024088594293 val_auroc:  0.7611683848797252 val_auprc:  0.8785288963329262
Validation loss improved to 0.308482
epoch:  7
[Epoch 8, Batch 10] loss: 0.307
epoch:  8 val_f1:  0.7420910227448273 val_auroc:  0.7609229258713796 val_auprc:  0.8756502084656201
Validation loss improved to 0.306547
epoch:  8
[Epoch 9, Batch 10] loss: 0.301
epoch:  9 val_f1:  0.7494347379239465 val_auroc:  0.76313205694649 val_auprc:  0.8759381066343456
EarlyStopping counter: 1 out of 50
epoch:  9
[Epoch 10, Batch 10] loss: 0.282
epoch:  10 val_f1:  0.735514445586388 val_auroc:  0.7592047128129603 val_auprc:  0.8762720102825092
Validation loss improved to 0.305123
epoch:  10
[Epoch 11, Batch 10] loss: 0.280
epoch:  11 val_f1:  0.7362024088594293 val_auroc:  0.7653411880216003 val_auprc:  0.8771075313722887
Validation loss improved to 0.304506
epoch:  11
[Epoch 12, Batch 10] loss: 0.285
epoch:  12 val_f1:  0.7295632867761842 val_auroc:  0.7707412862052038 val_auprc:  0.8796804605271503
Validation loss improved to 0.304373
epoch:  12
[Epoch 13, Batch 10] loss: 0.295
epoch:  13 val_f1:  0.7583800901862243 val_auroc:  0.7746686303387335 val_auprc:  0.8807571677740714
Validation loss improved to 0.298158
epoch:  13
[Epoch 14, Batch 10] loss: 0.258
epoch:  14 val_f1:  0.7362024088594293 val_auroc:  0.7673048600883653 val_auprc:  0.8758920222105708
EarlyStopping counter: 1 out of 50
epoch:  14
[Epoch 15, Batch 10] loss: 0.285
epoch:  15 val_f1:  0.6524974219867484 val_auroc:  0.7663230240549829 val_auprc:  0.8759155098406988
EarlyStopping counter: 2 out of 50
epoch:  15
[Epoch 16, Batch 10] loss: 0.273
epoch:  16 val_f1:  0.682026026688228 val_auroc:  0.7685321551300933 val_auprc:  0.8780390362586568
EarlyStopping counter: 3 out of 50
epoch:  16
[Epoch 17, Batch 10] loss: 0.258
epoch:  17 val_f1:  0.682026026688228 val_auroc:  0.7731958762886598 val_auprc:  0.8805321203513587
EarlyStopping counter: 4 out of 50
epoch:  17
[Epoch 18, Batch 10] loss: 0.254
epoch:  18 val_f1:  0.7633714058926586 val_auroc:  0.7763868433971527 val_auprc:  0.8803857250807171
EarlyStopping counter: 5 out of 50
epoch:  18
[Epoch 19, Batch 10] loss: 0.235
epoch:  19 val_f1:  0.6752910608296504 val_auroc:  0.7749140893470791 val_auprc:  0.8814936120920215
EarlyStopping counter: 6 out of 50
epoch:  19
[Epoch 20, Batch 10] loss: 0.257
epoch:  20 val_f1:  0.735514445586388 val_auroc:  0.7729504172803142 val_auprc:  0.8777241918026442
EarlyStopping counter: 7 out of 50
epoch:  20
[Epoch 21, Batch 10] loss: 0.246
epoch:  21 val_f1:  0.7307106601978622 val_auroc:  0.7771232204221895 val_auprc:  0.8844928499096307
EarlyStopping counter: 8 out of 50
epoch:  21
[Epoch 22, Batch 10] loss: 0.247
epoch:  22 val_f1:  0.7426698176342648 val_auroc:  0.7756504663721159 val_auprc:  0.8787934281296069
EarlyStopping counter: 9 out of 50
epoch:  22
[Epoch 23, Batch 10] loss: 0.237
epoch:  23 val_f1:  0.7454557504588546 val_auroc:  0.7788414334806089 val_auprc:  0.8824189427225235
EarlyStopping counter: 10 out of 50
epoch:  23
[Epoch 24, Batch 10] loss: 0.226
epoch:  24 val_f1:  0.7466980132583976 val_auroc:  0.7763868433971527 val_auprc:  0.8808348915046069
EarlyStopping counter: 11 out of 50
epoch:  24
[Epoch 25, Batch 10] loss: 0.223
epoch:  25 val_f1:  0.7229061670449737 val_auroc:  0.7744231713303877 val_auprc:  0.8810413686162782
EarlyStopping counter: 12 out of 50
epoch:  25
[Epoch 26, Batch 10] loss: 0.214
epoch:  26 val_f1:  0.7223183251151889 val_auroc:  0.7763868433971527 val_auprc:  0.8817360342253353
EarlyStopping counter: 13 out of 50
epoch:  26
[Epoch 27, Batch 10] loss: 0.219
epoch:  27 val_f1:  0.7289242247644242 val_auroc:  0.7766323024054982 val_auprc:  0.8819321233026076
EarlyStopping counter: 14 out of 50
epoch:  27
[Epoch 28, Batch 10] loss: 0.211
epoch:  28 val_f1:  0.7229061670449737 val_auroc:  0.7739322533136965 val_auprc:  0.8805129316420364
EarlyStopping counter: 15 out of 50
epoch:  28
[Epoch 29, Batch 10] loss: 0.224
epoch:  29 val_f1:  0.7289242247644242 val_auroc:  0.7768777614138439 val_auprc:  0.8839574012833515
EarlyStopping counter: 16 out of 50
epoch:  29
[Epoch 30, Batch 10] loss: 0.210
epoch:  30 val_f1:  0.7098736982331642 val_auroc:  0.7761413843888071 val_auprc:  0.883928979042077
EarlyStopping counter: 17 out of 50
epoch:  30
[Epoch 31, Batch 10] loss: 0.205
epoch:  31 val_f1:  0.6963686193902022 val_auroc:  0.7739322533136965 val_auprc:  0.8816750425080008
EarlyStopping counter: 18 out of 50
epoch:  31
[Epoch 32, Batch 10] loss: 0.218
epoch:  32 val_f1:  0.7289242247644242 val_auroc:  0.7795778105056456 val_auprc:  0.8846787828064476
EarlyStopping counter: 19 out of 50
epoch:  32
[Epoch 33, Batch 10] loss: 0.197
epoch:  33 val_f1:  0.7505653177403916 val_auroc:  0.781786941580756 val_auprc:  0.8858132999937667
EarlyStopping counter: 20 out of 50
epoch:  33
[Epoch 34, Batch 10] loss: 0.223
epoch:  34 val_f1:  0.7289242247644242 val_auroc:  0.7778595974472263 val_auprc:  0.8839919431192107
EarlyStopping counter: 21 out of 50
epoch:  34
[Epoch 35, Batch 10] loss: 0.203
epoch:  35 val_f1:  0.7223183251151889 val_auroc:  0.7707412862052037 val_auprc:  0.8800204730263141
EarlyStopping counter: 22 out of 50
epoch:  35
[Epoch 36, Batch 10] loss: 0.205
epoch:  36 val_f1:  0.6960581600537912 val_auroc:  0.7763868433971527 val_auprc:  0.8842421845440012
EarlyStopping counter: 23 out of 50
epoch:  36
[Epoch 37, Batch 10] loss: 0.207
epoch:  37 val_f1:  0.7325045643526866 val_auroc:  0.7871870397643593 val_auprc:  0.8890516431721381
EarlyStopping counter: 24 out of 50
epoch:  37
[Epoch 38, Batch 10] loss: 0.212
epoch:  38 val_f1:  0.7202047592695074 val_auroc:  0.7864506627393225 val_auprc:  0.888748576569204
EarlyStopping counter: 25 out of 50
epoch:  38
[Epoch 39, Batch 10] loss: 0.180
epoch:  39 val_f1:  0.6894622188638474 val_auroc:  0.7763868433971527 val_auprc:  0.8843501736880883
EarlyStopping counter: 26 out of 50
epoch:  39
[Epoch 40, Batch 10] loss: 0.198
epoch:  40 val_f1:  0.7156947373800909 val_auroc:  0.7827687776141385 val_auprc:  0.8872067865146357
EarlyStopping counter: 27 out of 50
epoch:  40
[Epoch 41, Batch 10] loss: 0.183
epoch:  41 val_f1:  0.7402181480621955 val_auroc:  0.7837506136475209 val_auprc:  0.8869770939927422
EarlyStopping counter: 28 out of 50
epoch:  41
[Epoch 42, Batch 10] loss: 0.187
epoch:  42 val_f1:  0.7028070029525513 val_auroc:  0.7776141384388807 val_auprc:  0.8839224630608504
EarlyStopping counter: 29 out of 50
epoch:  42
[Epoch 43, Batch 10] loss: 0.168
epoch:  43 val_f1:  0.7289242247644242 val_auroc:  0.7785959744722631 val_auprc:  0.8836178043019798
EarlyStopping counter: 30 out of 50
epoch:  43
[Epoch 44, Batch 10] loss: 0.197
epoch:  44 val_f1:  0.7346891520614657 val_auroc:  0.7874324987727049 val_auprc:  0.8902631792771591
EarlyStopping counter: 31 out of 50
epoch:  44
[Epoch 45, Batch 10] loss: 0.179
epoch:  45 val_f1:  0.7028070029525513 val_auroc:  0.781786941580756 val_auprc:  0.8862187109744744
EarlyStopping counter: 32 out of 50
epoch:  45
[Epoch 46, Batch 10] loss: 0.185
epoch:  46 val_f1:  0.703263898025454 val_auroc:  0.7776141384388807 val_auprc:  0.8843624330017409
EarlyStopping counter: 33 out of 50
epoch:  46
[Epoch 47, Batch 10] loss: 0.164
epoch:  47 val_f1:  0.7156947373800909 val_auroc:  0.7788414334806087 val_auprc:  0.884408637885663
EarlyStopping counter: 34 out of 50
epoch:  47
[Epoch 48, Batch 10] loss: 0.169
epoch:  48 val_f1:  0.7223183251151889 val_auroc:  0.7783505154639175 val_auprc:  0.8841335816341435
EarlyStopping counter: 35 out of 50
epoch:  48
[Epoch 49, Batch 10] loss: 0.172
epoch:  49 val_f1:  0.7281499969472504 val_auroc:  0.7847324496809033 val_auprc:  0.8888683159893482
EarlyStopping counter: 36 out of 50
epoch:  49
[Epoch 50, Batch 10] loss: 0.162
epoch:  50 val_f1:  0.7095299887411026 val_auroc:  0.7812960235640647 val_auprc:  0.8874555853157242
EarlyStopping counter: 37 out of 50
epoch:  50
[Epoch 51, Batch 10] loss: 0.157
epoch:  51 val_f1:  0.7095299887411026 val_auroc:  0.7712322042218949 val_auprc:  0.8802046520286411
EarlyStopping counter: 38 out of 50
epoch:  51
[Epoch 52, Batch 10] loss: 0.163
epoch:  52 val_f1:  0.7028070029525513 val_auroc:  0.7800687285223368 val_auprc:  0.8858945684418968
EarlyStopping counter: 39 out of 50
epoch:  52
[Epoch 53, Batch 10] loss: 0.172
epoch:  53 val_f1:  0.7272357092755477 val_auroc:  0.7839960726558665 val_auprc:  0.8897535989835413
EarlyStopping counter: 40 out of 50
epoch:  53
[Epoch 54, Batch 10] loss: 0.143
epoch:  54 val_f1:  0.717230470942395 val_auroc:  0.7773686794305351 val_auprc:  0.8842686933024493
EarlyStopping counter: 41 out of 50
epoch:  54
[Epoch 55, Batch 10] loss: 0.168
epoch:  55 val_f1:  0.7377691212466089 val_auroc:  0.7832596956308296 val_auprc:  0.8888380279312793
EarlyStopping counter: 42 out of 50
epoch:  55
[Epoch 56, Batch 10] loss: 0.154
epoch:  56 val_f1:  0.7313689473952751 val_auroc:  0.7788414334806087 val_auprc:  0.8866891764622707
EarlyStopping counter: 43 out of 50
epoch:  56
[Epoch 57, Batch 10] loss: 0.160
epoch:  57 val_f1:  0.7249644134959412 val_auroc:  0.7832596956308298 val_auprc:  0.8882686726200018
EarlyStopping counter: 44 out of 50
epoch:  57
[Epoch 58, Batch 10] loss: 0.160
epoch:  58 val_f1:  0.6960581600537912 val_auroc:  0.7771232204221895 val_auprc:  0.8856163412015553
EarlyStopping counter: 45 out of 50
epoch:  58
[Epoch 59, Batch 10] loss: 0.169
epoch:  59 val_f1:  0.7156947373800909 val_auroc:  0.7754050073637703 val_auprc:  0.8854337198867981
EarlyStopping counter: 46 out of 50
epoch:  59
[Epoch 60, Batch 10] loss: 0.144
epoch:  60 val_f1:  0.6891084624964738 val_auroc:  0.7722140402552774 val_auprc:  0.8851148413698475
EarlyStopping counter: 47 out of 50
epoch:  60
[Epoch 61, Batch 10] loss: 0.136
epoch:  61 val_f1:  0.7229061670449737 val_auroc:  0.7812960235640648 val_auprc:  0.8886673332436127
EarlyStopping counter: 48 out of 50
epoch:  61
[Epoch 62, Batch 10] loss: 0.143
epoch:  62 val_f1:  0.7235944791518311 val_auroc:  0.7835051546391752 val_auprc:  0.8883218371227846
EarlyStopping counter: 49 out of 50
epoch:  62
[Epoch 63, Batch 10] loss: 0.146
epoch:  63 val_f1:  0.7309103647707891 val_auroc:  0.7835051546391752 val_auprc:  0.8889110832945653
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1649.8223156929016
{'time_elapsed': [1649.8223156929016], 'epoch': [62], 'fold': [2], 'f1_train': [0.930526519349254], 'auroc_train': [0.9820798969862341], 'auprc_train': [0.9923931143724047], 'f1_test': [0.7309103647707891], 'auroc_test': [0.7835051546391752], 'auprc_test': [0.8889110832945653]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [32, 1]                   --
├─Sequential: 1-1                        [32, 1]                   --
│    └─Conv1d: 2-1                       [32, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [32, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [32, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [32, 1024, 1278]          --
│    └─Dropout: 2-5                      [32, 1024, 1278]          --
│    └─Flatten: 2-6                      [32, 1308672]             --
│    └─Linear: 2-7                       [32, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.16
Forward/backward pass size (MB): 671.09
Params size (MB): 5.26
Estimated Total Size (MB): 676.51
==========================================================================================
tensor(0.4369)
epoch:  0
[Epoch 1, Batch 10] loss: 0.508
epoch:  1 val_f1:  0.4241328524799258 val_auroc:  0.7919089147286822 val_auprc:  0.8926174988415727
epoch:  1
[Epoch 2, Batch 10] loss: 0.386
epoch:  2 val_f1:  0.6493541056652177 val_auroc:  0.8081395348837209 val_auprc:  0.9135250959249457
Validation loss improved to 0.326079
epoch:  2
[Epoch 3, Batch 10] loss: 0.358
epoch:  3 val_f1:  0.724215975155522 val_auroc:  0.8112887596899224 val_auprc:  0.917502184298043
Validation loss improved to 0.314780
epoch:  3
[Epoch 4, Batch 10] loss: 0.339
epoch:  4 val_f1:  0.7783357627623393 val_auroc:  0.812015503875969 val_auprc:  0.9186573556502879
Validation loss improved to 0.294730
epoch:  4
[Epoch 5, Batch 10] loss: 0.341
epoch:  5 val_f1:  0.6399526585305988 val_auroc:  0.8129844961240309 val_auprc:  0.9206635836400938
EarlyStopping counter: 1 out of 50
epoch:  5
[Epoch 6, Batch 10] loss: 0.328
epoch:  6 val_f1:  0.7529139722223964 val_auroc:  0.8134689922480621 val_auprc:  0.9186136083272309
Validation loss improved to 0.275429
epoch:  6
[Epoch 7, Batch 10] loss: 0.320
epoch:  7 val_f1:  0.7647070144847204 val_auroc:  0.8168604651162791 val_auprc:  0.9196932979728397
Validation loss improved to 0.274271
epoch:  7
[Epoch 8, Batch 10] loss: 0.311
epoch:  8 val_f1:  0.7289753081911234 val_auroc:  0.820736434108527 val_auprc:  0.9213423434021
Validation loss improved to 0.269842
epoch:  8
[Epoch 9, Batch 10] loss: 0.306
epoch:  9 val_f1:  0.7714826564458221 val_auroc:  0.8190406976744186 val_auprc:  0.9206769276885947
Validation loss improved to 0.248881
epoch:  9
[Epoch 10, Batch 10] loss: 0.279
epoch:  10 val_f1:  0.7659382513381667 val_auroc:  0.8219476744186047 val_auprc:  0.9213959397056068
EarlyStopping counter: 1 out of 50
epoch:  10
[Epoch 11, Batch 10] loss: 0.278
epoch:  11 val_f1:  0.7571561248111338 val_auroc:  0.8234011627906976 val_auprc:  0.9223057165955756
Validation loss improved to 0.241305
epoch:  11
[Epoch 12, Batch 10] loss: 0.271
epoch:  12 val_f1:  0.7768458491633659 val_auroc:  0.8236434108527131 val_auprc:  0.9217421362156337
Validation loss improved to 0.234151
epoch:  12
[Epoch 13, Batch 10] loss: 0.253
epoch:  13 val_f1:  0.7506277331076315 val_auroc:  0.8241279069767441 val_auprc:  0.9238641105189633
EarlyStopping counter: 1 out of 50
epoch:  13
[Epoch 14, Batch 10] loss: 0.262
epoch:  14 val_f1:  0.757681867378181 val_auroc:  0.8253391472868217 val_auprc:  0.9240025643470935
EarlyStopping counter: 2 out of 50
epoch:  14
[Epoch 15, Batch 10] loss: 0.263
epoch:  15 val_f1:  0.7568878868197308 val_auroc:  0.8267926356589148 val_auprc:  0.9236077332344974
Validation loss improved to 0.220770
epoch:  15
[Epoch 16, Batch 10] loss: 0.256
epoch:  16 val_f1:  0.7568878868197308 val_auroc:  0.8289728682170543 val_auprc:  0.9241651283581529
EarlyStopping counter: 1 out of 50
epoch:  16
[Epoch 17, Batch 10] loss: 0.265
epoch:  17 val_f1:  0.6936836045182545 val_auroc:  0.8301841085271318 val_auprc:  0.9224506255056701
EarlyStopping counter: 2 out of 50
epoch:  17
[Epoch 18, Batch 10] loss: 0.257
epoch:  18 val_f1:  0.7701596400342386 val_auroc:  0.8272771317829457 val_auprc:  0.9244063962281988
Validation loss improved to 0.209277
epoch:  18
[Epoch 19, Batch 10] loss: 0.272
epoch:  19 val_f1:  0.736656651690142 val_auroc:  0.8299418604651163 val_auprc:  0.9248566776241689
EarlyStopping counter: 1 out of 50
epoch:  19
[Epoch 20, Batch 10] loss: 0.244
epoch:  20 val_f1:  0.7745758989478168 val_auroc:  0.8311531007751938 val_auprc:  0.9253246958356812
Validation loss improved to 0.200623
epoch:  20
[Epoch 21, Batch 10] loss: 0.261
epoch:  21 val_f1:  0.7835226993620948 val_auroc:  0.8323643410852712 val_auprc:  0.9258640778642245
Validation loss improved to 0.197598
epoch:  21
[Epoch 22, Batch 10] loss: 0.242
epoch:  22 val_f1:  0.7745758989478168 val_auroc:  0.8345445736434108 val_auprc:  0.9257229793656104
Validation loss improved to 0.194889
epoch:  22
[Epoch 23, Batch 10] loss: 0.236
epoch:  23 val_f1:  0.7437835844998612 val_auroc:  0.8330910852713178 val_auprc:  0.9271003157961788
EarlyStopping counter: 1 out of 50
epoch:  23
[Epoch 24, Batch 10] loss: 0.235
epoch:  24 val_f1:  0.7369410839658738 val_auroc:  0.8335755813953488 val_auprc:  0.927409309698459
EarlyStopping counter: 2 out of 50
epoch:  24
[Epoch 25, Batch 10] loss: 0.231
epoch:  25 val_f1:  0.7695564219015847 val_auroc:  0.8347868217054264 val_auprc:  0.9272847171641032
Validation loss improved to 0.190092
epoch:  25
[Epoch 26, Batch 10] loss: 0.231
epoch:  26 val_f1:  0.7701596400342386 val_auroc:  0.8359980620155039 val_auprc:  0.927741502632095
EarlyStopping counter: 1 out of 50
epoch:  26
[Epoch 27, Batch 10] loss: 0.219
epoch:  27 val_f1:  0.776244301724119 val_auroc:  0.8376937984496124 val_auprc:  0.9273720232195423
EarlyStopping counter: 2 out of 50
epoch:  27
[Epoch 28, Batch 10] loss: 0.229
epoch:  28 val_f1:  0.7688372056811462 val_auroc:  0.8369670542635659 val_auprc:  0.9274771570067506
EarlyStopping counter: 3 out of 50
epoch:  28
[Epoch 29, Batch 10] loss: 0.200
epoch:  29 val_f1:  0.7773759601944114 val_auroc:  0.8364825581395349 val_auprc:  0.9280122914454064
Validation loss improved to 0.182164
epoch:  29
[Epoch 30, Batch 10] loss: 0.224
epoch:  30 val_f1:  0.7906801532257888 val_auroc:  0.8408430232558138 val_auprc:  0.92903137209721
EarlyStopping counter: 1 out of 50
epoch:  30
[Epoch 31, Batch 10] loss: 0.225
epoch:  31 val_f1:  0.7827158008497472 val_auroc:  0.8391472868217054 val_auprc:  0.9285370746617801
EarlyStopping counter: 2 out of 50
epoch:  31
[Epoch 32, Batch 10] loss: 0.211
epoch:  32 val_f1:  0.7506277331076315 val_auroc:  0.8367248062015503 val_auprc:  0.9283220926100497
EarlyStopping counter: 3 out of 50
epoch:  32
[Epoch 33, Batch 10] loss: 0.216
epoch:  33 val_f1:  0.7952715769842713 val_auroc:  0.8391472868217054 val_auprc:  0.9290551792316093
Validation loss improved to 0.173789
epoch:  33
[Epoch 34, Batch 10] loss: 0.206
epoch:  34 val_f1:  0.7877294237541244 val_auroc:  0.840843023255814 val_auprc:  0.9293882237537547
Validation loss improved to 0.171357
epoch:  34
[Epoch 35, Batch 10] loss: 0.204
epoch:  35 val_f1:  0.792019787311512 val_auroc:  0.8425387596899224 val_auprc:  0.9303017938015528
EarlyStopping counter: 1 out of 50
epoch:  35
[Epoch 36, Batch 10] loss: 0.212
epoch:  36 val_f1:  0.792019787311512 val_auroc:  0.8444767441860465 val_auprc:  0.9315153778475362
EarlyStopping counter: 2 out of 50
epoch:  36
[Epoch 37, Batch 10] loss: 0.207
epoch:  37 val_f1:  0.7968569383258559 val_auroc:  0.845203488372093 val_auprc:  0.9320528237852896
EarlyStopping counter: 3 out of 50
epoch:  37
[Epoch 38, Batch 10] loss: 0.214
epoch:  38 val_f1:  0.7841726618705036 val_auroc:  0.8461724806201552 val_auprc:  0.9314281950803109
Validation loss improved to 0.170620
epoch:  38
[Epoch 39, Batch 10] loss: 0.196
epoch:  39 val_f1:  0.7854893118997625 val_auroc:  0.8449612403100775 val_auprc:  0.9319966831637061
Validation loss improved to 0.167697
epoch:  39
[Epoch 40, Batch 10] loss: 0.197
epoch:  40 val_f1:  0.7840893588200424 val_auroc:  0.8478682170542635 val_auprc:  0.9330407521946795
EarlyStopping counter: 1 out of 50
epoch:  40
[Epoch 41, Batch 10] loss: 0.194
epoch:  41 val_f1:  0.7952715769842713 val_auroc:  0.8468992248062016 val_auprc:  0.9318847017695939
EarlyStopping counter: 2 out of 50
epoch:  41
[Epoch 42, Batch 10] loss: 0.190
epoch:  42 val_f1:  0.757449328289459 val_auroc:  0.8454457364341085 val_auprc:  0.9321985535134063
EarlyStopping counter: 3 out of 50
epoch:  42
[Epoch 43, Batch 10] loss: 0.178
epoch:  43 val_f1:  0.7828470720035011 val_auroc:  0.8478682170542636 val_auprc:  0.9339509632513735
EarlyStopping counter: 4 out of 50
epoch:  43
[Epoch 44, Batch 10] loss: 0.173
epoch:  44 val_f1:  0.7801238118631262 val_auroc:  0.8471414728682171 val_auprc:  0.9336547533114028
Validation loss improved to 0.163785
epoch:  44
[Epoch 45, Batch 10] loss: 0.168
epoch:  45 val_f1:  0.7866727894280321 val_auroc:  0.8488372093023255 val_auprc:  0.9331153781808732
EarlyStopping counter: 1 out of 50
epoch:  45
[Epoch 46, Batch 10] loss: 0.175
epoch:  46 val_f1:  0.7980190776058461 val_auroc:  0.847141472868217 val_auprc:  0.9341232511353474
EarlyStopping counter: 2 out of 50
epoch:  46
[Epoch 47, Batch 10] loss: 0.166
epoch:  47 val_f1:  0.7877294237541244 val_auroc:  0.8502906976744186 val_auprc:  0.9350430450241638
EarlyStopping counter: 3 out of 50
epoch:  47
[Epoch 48, Batch 10] loss: 0.167
epoch:  48 val_f1:  0.7901923359271766 val_auroc:  0.8510174418604651 val_auprc:  0.9348181897109693
EarlyStopping counter: 4 out of 50
epoch:  48
[Epoch 49, Batch 10] loss: 0.166
epoch:  49 val_f1:  0.7886649052635782 val_auroc:  0.8498062015503877 val_auprc:  0.9350782873708611
Validation loss improved to 0.162730
epoch:  49
[Epoch 50, Batch 10] loss: 0.179
epoch:  50 val_f1:  0.7854893118997625 val_auroc:  0.8495639534883721 val_auprc:  0.9347206088999626
EarlyStopping counter: 1 out of 50
epoch:  50
[Epoch 51, Batch 10] loss: 0.167
epoch:  51 val_f1:  0.7854893118997625 val_auroc:  0.8524709302325582 val_auprc:  0.9352602332102335
EarlyStopping counter: 2 out of 50
epoch:  51
[Epoch 52, Batch 10] loss: 0.146
epoch:  52 val_f1:  0.7811109002295425 val_auroc:  0.8512596899224806 val_auprc:  0.9351689419306101
EarlyStopping counter: 3 out of 50
epoch:  52
[Epoch 53, Batch 10] loss: 0.172
epoch:  53 val_f1:  0.7906801532257888 val_auroc:  0.8534399224806202 val_auprc:  0.9352947787692203
EarlyStopping counter: 4 out of 50
epoch:  53
[Epoch 54, Batch 10] loss: 0.154
epoch:  54 val_f1:  0.7906801532257888 val_auroc:  0.8541666666666666 val_auprc:  0.9360547625194374
EarlyStopping counter: 5 out of 50
epoch:  54
[Epoch 55, Batch 10] loss: 0.167
epoch:  55 val_f1:  0.7854893118997625 val_auroc:  0.8539244186046512 val_auprc:  0.9361483126094088
EarlyStopping counter: 6 out of 50
epoch:  55
[Epoch 56, Batch 10] loss: 0.158
epoch:  56 val_f1:  0.7854893118997625 val_auroc:  0.8536821705426356 val_auprc:  0.9369497239265824
EarlyStopping counter: 7 out of 50
epoch:  56
[Epoch 57, Batch 10] loss: 0.155
epoch:  57 val_f1:  0.7854893118997625 val_auroc:  0.8536821705426357 val_auprc:  0.9365431965343051
EarlyStopping counter: 8 out of 50
epoch:  57
[Epoch 58, Batch 10] loss: 0.160
epoch:  58 val_f1:  0.7854893118997625 val_auroc:  0.8558624031007751 val_auprc:  0.9374537675990351
Validation loss improved to 0.158206
epoch:  58
[Epoch 59, Batch 10] loss: 0.153
epoch:  59 val_f1:  0.7854893118997625 val_auroc:  0.8553779069767441 val_auprc:  0.9371854596051146
EarlyStopping counter: 1 out of 50
epoch:  59
[Epoch 60, Batch 10] loss: 0.151
epoch:  60 val_f1:  0.7854893118997625 val_auroc:  0.8561046511627907 val_auprc:  0.9378853561452721
EarlyStopping counter: 2 out of 50
epoch:  60
[Epoch 61, Batch 10] loss: 0.140
epoch:  61 val_f1:  0.7854893118997625 val_auroc:  0.8548934108527132 val_auprc:  0.9386044791194729
Validation loss improved to 0.153055
epoch:  61
[Epoch 62, Batch 10] loss: 0.143
epoch:  62 val_f1:  0.7972014141264308 val_auroc:  0.8592538759689923 val_auprc:  0.9374207848586882
EarlyStopping counter: 1 out of 50
epoch:  62
[Epoch 63, Batch 10] loss: 0.148
epoch:  63 val_f1:  0.792019787311512 val_auroc:  0.8592538759689923 val_auprc:  0.9401016643061585
EarlyStopping counter: 2 out of 50
epoch:  63
[Epoch 64, Batch 10] loss: 0.161
epoch:  64 val_f1:  0.7801238118631262 val_auroc:  0.8592538759689923 val_auprc:  0.9404544274182436
EarlyStopping counter: 3 out of 50
epoch:  64
[Epoch 65, Batch 10] loss: 0.135
epoch:  65 val_f1:  0.776244301724119 val_auroc:  0.8594961240310077 val_auprc:  0.9399078439471475
EarlyStopping counter: 4 out of 50
epoch:  65
[Epoch 66, Batch 10] loss: 0.149
epoch:  66 val_f1:  0.792019787311512 val_auroc:  0.8594961240310077 val_auprc:  0.9396431158824076
EarlyStopping counter: 5 out of 50
epoch:  66
[Epoch 67, Batch 10] loss: 0.126
epoch:  67 val_f1:  0.7735780520043992 val_auroc:  0.8609496124031009 val_auprc:  0.9405383620909737
Validation loss improved to 0.150562
epoch:  67
[Epoch 68, Batch 10] loss: 0.139
epoch:  68 val_f1:  0.792019787311512 val_auroc:  0.8590116279069768 val_auprc:  0.9395759872981814
EarlyStopping counter: 1 out of 50
epoch:  68
[Epoch 69, Batch 10] loss: 0.129
epoch:  69 val_f1:  0.7854893118997625 val_auroc:  0.8594961240310078 val_auprc:  0.9396281727227146
EarlyStopping counter: 2 out of 50
epoch:  69
[Epoch 70, Batch 10] loss: 0.127
epoch:  70 val_f1:  0.7866727894280321 val_auroc:  0.8597383720930233 val_auprc:  0.9402245643900771
Validation loss improved to 0.150354
epoch:  70
[Epoch 71, Batch 10] loss: 0.136
epoch:  71 val_f1:  0.8047401180179452 val_auroc:  0.8604651162790699 val_auprc:  0.9414802821793384
EarlyStopping counter: 1 out of 50
epoch:  71
[Epoch 72, Batch 10] loss: 0.145
epoch:  72 val_f1:  0.7957035068809065 val_auroc:  0.8650678294573644 val_auprc:  0.9407020492234751
EarlyStopping counter: 2 out of 50
epoch:  72
[Epoch 73, Batch 10] loss: 0.142
epoch:  73 val_f1:  0.7906801532257888 val_auroc:  0.8594961240310078 val_auprc:  0.9384989899831278
EarlyStopping counter: 3 out of 50
epoch:  73
[Epoch 74, Batch 10] loss: 0.119
epoch:  74 val_f1:  0.7789671954250403 val_auroc:  0.8585271317829457 val_auprc:  0.9385157638886554
EarlyStopping counter: 4 out of 50
epoch:  74
[Epoch 75, Batch 10] loss: 0.122
epoch:  75 val_f1:  0.7801238118631262 val_auroc:  0.8602228682170542 val_auprc:  0.9401814740974476
EarlyStopping counter: 5 out of 50
epoch:  75
[Epoch 76, Batch 10] loss: 0.129
epoch:  76 val_f1:  0.7714826564458221 val_auroc:  0.8570736434108527 val_auprc:  0.9401519511914191
EarlyStopping counter: 6 out of 50
epoch:  76
[Epoch 77, Batch 10] loss: 0.154
epoch:  77 val_f1:  0.7724509753899008 val_auroc:  0.8599806201550387 val_auprc:  0.9405728915219287
Validation loss improved to 0.150232
epoch:  77
[Epoch 78, Batch 10] loss: 0.132
epoch:  78 val_f1:  0.7710202043822609 val_auroc:  0.8609496124031008 val_auprc:  0.9401538433149894
EarlyStopping counter: 1 out of 50
epoch:  78
[Epoch 79, Batch 10] loss: 0.124
epoch:  79 val_f1:  0.792019787311512 val_auroc:  0.8594961240310076 val_auprc:  0.9399823075606617
EarlyStopping counter: 2 out of 50
epoch:  79
[Epoch 80, Batch 10] loss: 0.116
epoch:  80 val_f1:  0.7961192047225032 val_auroc:  0.8597383720930232 val_auprc:  0.9404925601488756
EarlyStopping counter: 3 out of 50
epoch:  80
[Epoch 81, Batch 10] loss: 0.127
epoch:  81 val_f1:  0.8027539115793398 val_auroc:  0.8609496124031008 val_auprc:  0.9392964428969874
EarlyStopping counter: 4 out of 50
epoch:  81
[Epoch 82, Batch 10] loss: 0.122
epoch:  82 val_f1:  0.792019787311512 val_auroc:  0.8609496124031008 val_auprc:  0.9388780293415779
EarlyStopping counter: 5 out of 50
epoch:  82
[Epoch 83, Batch 10] loss: 0.113
epoch:  83 val_f1:  0.7827158008497472 val_auroc:  0.8636143410852714 val_auprc:  0.939637066818365
EarlyStopping counter: 6 out of 50
epoch:  83
[Epoch 84, Batch 10] loss: 0.123
epoch:  84 val_f1:  0.7906801532257888 val_auroc:  0.8631298449612402 val_auprc:  0.9405989429306985
EarlyStopping counter: 7 out of 50
epoch:  84
[Epoch 85, Batch 10] loss: 0.111
epoch:  85 val_f1:  0.792019787311512 val_auroc:  0.8633720930232558 val_auprc:  0.9407597625705173
EarlyStopping counter: 8 out of 50
epoch:  85
[Epoch 86, Batch 10] loss: 0.102
epoch:  86 val_f1:  0.7877294237541244 val_auroc:  0.8640988372093024 val_auprc:  0.9416350377267197
EarlyStopping counter: 9 out of 50
epoch:  86
[Epoch 87, Batch 10] loss: 0.106
epoch:  87 val_f1:  0.7841726618705036 val_auroc:  0.8643410852713179 val_auprc:  0.9402338457420383
EarlyStopping counter: 10 out of 50
epoch:  87
[Epoch 88, Batch 10] loss: 0.106
epoch:  88 val_f1:  0.7906801532257888 val_auroc:  0.8655523255813953 val_auprc:  0.9412867329897583
EarlyStopping counter: 11 out of 50
epoch:  88
[Epoch 89, Batch 10] loss: 0.111
epoch:  89 val_f1:  0.792019787311512 val_auroc:  0.8660368217054263 val_auprc:  0.9424359138009889
EarlyStopping counter: 12 out of 50
epoch:  89
[Epoch 90, Batch 10] loss: 0.099
epoch:  90 val_f1:  0.792019787311512 val_auroc:  0.8614341085271318 val_auprc:  0.939775005870058
EarlyStopping counter: 13 out of 50
epoch:  90
[Epoch 91, Batch 10] loss: 0.106
epoch:  91 val_f1:  0.7932273763653603 val_auroc:  0.8648255813953488 val_auprc:  0.9421196487973618
Validation loss improved to 0.148859
epoch:  91
[Epoch 92, Batch 10] loss: 0.101
epoch:  92 val_f1:  0.8101799492243995 val_auroc:  0.8687015503875969 val_auprc:  0.9435226597632318
EarlyStopping counter: 1 out of 50
epoch:  92
[Epoch 93, Batch 10] loss: 0.111
epoch:  93 val_f1:  0.7578890782445586 val_auroc:  0.8672480620155039 val_auprc:  0.9418113086634559
EarlyStopping counter: 2 out of 50
epoch:  93
[Epoch 94, Batch 10] loss: 0.121
epoch:  94 val_f1:  0.776244301724119 val_auroc:  0.8662790697674418 val_auprc:  0.9423890972489498
EarlyStopping counter: 3 out of 50
epoch:  94
[Epoch 95, Batch 10] loss: 0.101
epoch:  95 val_f1:  0.792019787311512 val_auroc:  0.8645833333333335 val_auprc:  0.9418117752555802
EarlyStopping counter: 4 out of 50
epoch:  95
[Epoch 96, Batch 10] loss: 0.103
epoch:  96 val_f1:  0.792019787311512 val_auroc:  0.8665213178294575 val_auprc:  0.9423469572881319
EarlyStopping counter: 5 out of 50
epoch:  96
[Epoch 97, Batch 10] loss: 0.099
epoch:  97 val_f1:  0.792019787311512 val_auroc:  0.8670058139534883 val_auprc:  0.9426616218121446
EarlyStopping counter: 6 out of 50
epoch:  97
[Epoch 98, Batch 10] loss: 0.091
epoch:  98 val_f1:  0.7932273763653603 val_auroc:  0.8689437984496123 val_auprc:  0.9433981187502523
EarlyStopping counter: 7 out of 50
epoch:  98
[Epoch 99, Batch 10] loss: 0.089
epoch:  99 val_f1:  0.794309372388086 val_auroc:  0.8648255813953487 val_auprc:  0.9424897743262841
Validation loss improved to 0.144115
epoch:  99
[Epoch 100, Batch 10] loss: 0.095
epoch:  100 val_f1:  0.7932273763653603 val_auroc:  0.8674903100775194 val_auprc:  0.9433749965372613
EarlyStopping counter: 1 out of 50
epoch:  100
[Epoch 101, Batch 10] loss: 0.089
epoch:  101 val_f1:  0.7932273763653603 val_auroc:  0.8679748062015502 val_auprc:  0.943233395015034
EarlyStopping counter: 2 out of 50
epoch:  101
[Epoch 102, Batch 10] loss: 0.094
epoch:  102 val_f1:  0.794309372388086 val_auroc:  0.866763565891473 val_auprc:  0.9430272318421714
Validation loss improved to 0.143145
epoch:  102
[Epoch 103, Batch 10] loss: 0.097
epoch:  103 val_f1:  0.7854893118997625 val_auroc:  0.868701550387597 val_auprc:  0.943639514502191
EarlyStopping counter: 1 out of 50
epoch:  103
[Epoch 104, Batch 10] loss: 0.090
epoch:  104 val_f1:  0.792019787311512 val_auroc:  0.8679748062015503 val_auprc:  0.9428893571123999
EarlyStopping counter: 2 out of 50
epoch:  104
[Epoch 105, Batch 10] loss: 0.089
epoch:  105 val_f1:  0.792019787311512 val_auroc:  0.8650678294573644 val_auprc:  0.9425500264907863
EarlyStopping counter: 3 out of 50
epoch:  105
[Epoch 106, Batch 10] loss: 0.085
epoch:  106 val_f1:  0.8035187234827523 val_auroc:  0.8684593023255814 val_auprc:  0.943985037803756
EarlyStopping counter: 4 out of 50
epoch:  106
[Epoch 107, Batch 10] loss: 0.095
epoch:  107 val_f1:  0.8168429178951009 val_auroc:  0.8689437984496123 val_auprc:  0.9438228310376768
EarlyStopping counter: 5 out of 50
epoch:  107
[Epoch 108, Batch 10] loss: 0.090
epoch:  108 val_f1:  0.792019787311512 val_auroc:  0.868701550387597 val_auprc:  0.9434982149950651
EarlyStopping counter: 6 out of 50
epoch:  108
[Epoch 109, Batch 10] loss: 0.082
epoch:  109 val_f1:  0.8008946034661633 val_auroc:  0.8679748062015504 val_auprc:  0.9434376969450187
EarlyStopping counter: 7 out of 50
epoch:  109
[Epoch 110, Batch 10] loss: 0.084
epoch:  110 val_f1:  0.792019787311512 val_auroc:  0.8699127906976745 val_auprc:  0.9442269475374333
EarlyStopping counter: 8 out of 50
epoch:  110
[Epoch 111, Batch 10] loss: 0.084
epoch:  111 val_f1:  0.8008946034661633 val_auroc:  0.8706395348837209 val_auprc:  0.9440035900468249
EarlyStopping counter: 9 out of 50
epoch:  111
[Epoch 112, Batch 10] loss: 0.090
epoch:  112 val_f1:  0.8008946034661633 val_auroc:  0.868217054263566 val_auprc:  0.9433410836651631
EarlyStopping counter: 10 out of 50
epoch:  112
[Epoch 113, Batch 10] loss: 0.080
epoch:  113 val_f1:  0.7854893118997625 val_auroc:  0.8679748062015504 val_auprc:  0.9435570322535354
EarlyStopping counter: 11 out of 50
epoch:  113
[Epoch 114, Batch 10] loss: 0.070
epoch:  114 val_f1:  0.7827158008497472 val_auroc:  0.8687015503875969 val_auprc:  0.9435528649057102
EarlyStopping counter: 12 out of 50
epoch:  114
[Epoch 115, Batch 10] loss: 0.077
epoch:  115 val_f1:  0.7854893118997625 val_auroc:  0.8670058139534884 val_auprc:  0.9429742261903135
EarlyStopping counter: 13 out of 50
epoch:  115
[Epoch 116, Batch 10] loss: 0.075
epoch:  116 val_f1:  0.7854893118997625 val_auroc:  0.8691860465116279 val_auprc:  0.9440047399586164
EarlyStopping counter: 14 out of 50
epoch:  116
[Epoch 117, Batch 10] loss: 0.071
epoch:  117 val_f1:  0.7932273763653603 val_auroc:  0.8691860465116278 val_auprc:  0.94380709613209
EarlyStopping counter: 15 out of 50
epoch:  117
[Epoch 118, Batch 10] loss: 0.082
epoch:  118 val_f1:  0.8008946034661633 val_auroc:  0.8682170542635659 val_auprc:  0.9435686500852432
EarlyStopping counter: 16 out of 50
epoch:  118
[Epoch 119, Batch 10] loss: 0.079
epoch:  119 val_f1:  0.7932273763653603 val_auroc:  0.8703972868217054 val_auprc:  0.9445761896202908
EarlyStopping counter: 17 out of 50
epoch:  119
[Epoch 120, Batch 10] loss: 0.073
epoch:  120 val_f1:  0.7854893118997625 val_auroc:  0.8696705426356589 val_auprc:  0.943950028440351
EarlyStopping counter: 18 out of 50
epoch:  120
[Epoch 121, Batch 10] loss: 0.067
epoch:  121 val_f1:  0.8008946034661633 val_auroc:  0.8691860465116279 val_auprc:  0.9444708752152104
EarlyStopping counter: 19 out of 50
epoch:  121
[Epoch 122, Batch 10] loss: 0.070
epoch:  122 val_f1:  0.8008946034661633 val_auroc:  0.8699127906976745 val_auprc:  0.9446771430646559
EarlyStopping counter: 20 out of 50
epoch:  122
[Epoch 123, Batch 10] loss: 0.067
epoch:  123 val_f1:  0.8168429178951009 val_auroc:  0.8677325581395349 val_auprc:  0.9435353656463026
Validation loss improved to 0.136091
epoch:  123
[Epoch 124, Batch 10] loss: 0.071
epoch:  124 val_f1:  0.7854893118997625 val_auroc:  0.870639534883721 val_auprc:  0.9445783723329293
EarlyStopping counter: 1 out of 50
epoch:  124
[Epoch 125, Batch 10] loss: 0.068
epoch:  125 val_f1:  0.7932273763653603 val_auroc:  0.8708817829457365 val_auprc:  0.9444017300225335
EarlyStopping counter: 2 out of 50
epoch:  125
[Epoch 126, Batch 10] loss: 0.065
epoch:  126 val_f1:  0.7854893118997625 val_auroc:  0.8687015503875969 val_auprc:  0.9435118395131443
EarlyStopping counter: 3 out of 50
epoch:  126
[Epoch 127, Batch 10] loss: 0.070
epoch:  127 val_f1:  0.792019787311512 val_auroc:  0.869670542635659 val_auprc:  0.94453207520298
EarlyStopping counter: 4 out of 50
epoch:  127
[Epoch 128, Batch 10] loss: 0.064
epoch:  128 val_f1:  0.7854893118997625 val_auroc:  0.8723352713178295 val_auprc:  0.9456530195141378
EarlyStopping counter: 5 out of 50
epoch:  128
[Epoch 129, Batch 10] loss: 0.063
epoch:  129 val_f1:  0.7854893118997625 val_auroc:  0.869186046511628 val_auprc:  0.9441049048751167
EarlyStopping counter: 6 out of 50
epoch:  129
[Epoch 130, Batch 10] loss: 0.063
epoch:  130 val_f1:  0.7697841726618705 val_auroc:  0.8699127906976744 val_auprc:  0.9436503658459204
EarlyStopping counter: 7 out of 50
epoch:  130
[Epoch 131, Batch 10] loss: 0.059
epoch:  131 val_f1:  0.7932273763653603 val_auroc:  0.869186046511628 val_auprc:  0.9443812952244582
EarlyStopping counter: 8 out of 50
epoch:  131
[Epoch 132, Batch 10] loss: 0.068
epoch:  132 val_f1:  0.7746634573712671 val_auroc:  0.8701550387596899 val_auprc:  0.9442076305046704
EarlyStopping counter: 9 out of 50
epoch:  132
[Epoch 133, Batch 10] loss: 0.066
epoch:  133 val_f1:  0.8093907785715628 val_auroc:  0.8689437984496123 val_auprc:  0.9436131140620247
EarlyStopping counter: 10 out of 50
epoch:  133
[Epoch 134, Batch 10] loss: 0.066
epoch:  134 val_f1:  0.7932273763653603 val_auroc:  0.87015503875969 val_auprc:  0.9435286486669666
EarlyStopping counter: 11 out of 50
epoch:  134
[Epoch 135, Batch 10] loss: 0.063
epoch:  135 val_f1:  0.7932273763653603 val_auroc:  0.8703972868217055 val_auprc:  0.9434263939385805
EarlyStopping counter: 12 out of 50
epoch:  135
[Epoch 136, Batch 10] loss: 0.063
epoch:  136 val_f1:  0.7932273763653603 val_auroc:  0.8713662790697675 val_auprc:  0.9448619522808308
EarlyStopping counter: 13 out of 50
epoch:  136
[Epoch 137, Batch 10] loss: 0.062
epoch:  137 val_f1:  0.7932273763653603 val_auroc:  0.8723352713178295 val_auprc:  0.945337727842757
EarlyStopping counter: 14 out of 50
epoch:  137
[Epoch 138, Batch 10] loss: 0.060
epoch:  138 val_f1:  0.7746634573712671 val_auroc:  0.8703972868217054 val_auprc:  0.9436730770329687
EarlyStopping counter: 15 out of 50
epoch:  138
[Epoch 139, Batch 10] loss: 0.056
epoch:  139 val_f1:  0.8084949329130455 val_auroc:  0.8713662790697676 val_auprc:  0.9451024449606431
EarlyStopping counter: 16 out of 50
epoch:  139
[Epoch 140, Batch 10] loss: 0.056
epoch:  140 val_f1:  0.8168429178951009 val_auroc:  0.8694282945736435 val_auprc:  0.9441065074089194
EarlyStopping counter: 17 out of 50
epoch:  140
[Epoch 141, Batch 10] loss: 0.062
epoch:  141 val_f1:  0.7932273763653603 val_auroc:  0.8703972868217054 val_auprc:  0.9442473575045456
EarlyStopping counter: 18 out of 50
epoch:  141
[Epoch 142, Batch 10] loss: 0.058
epoch:  142 val_f1:  0.7932273763653603 val_auroc:  0.8713662790697674 val_auprc:  0.9444806297360514
EarlyStopping counter: 19 out of 50
epoch:  142
[Epoch 143, Batch 10] loss: 0.057
epoch:  143 val_f1:  0.7968569383258559 val_auroc:  0.8689437984496123 val_auprc:  0.9442094538200317
Validation loss improved to 0.134930
epoch:  143
[Epoch 144, Batch 10] loss: 0.061
epoch:  144 val_f1:  0.7932273763653603 val_auroc:  0.8703972868217055 val_auprc:  0.9441837652510818
EarlyStopping counter: 1 out of 50
epoch:  144
[Epoch 145, Batch 10] loss: 0.059
epoch:  145 val_f1:  0.7811109002295425 val_auroc:  0.868701550387597 val_auprc:  0.9440107161005472
EarlyStopping counter: 2 out of 50
epoch:  145
[Epoch 146, Batch 10] loss: 0.053
epoch:  146 val_f1:  0.7854893118997625 val_auroc:  0.8733042635658915 val_auprc:  0.9449138040278647
EarlyStopping counter: 3 out of 50
epoch:  146
[Epoch 147, Batch 10] loss: 0.052
epoch:  147 val_f1:  0.8160321672535743 val_auroc:  0.8711240310077519 val_auprc:  0.9448981959945438
EarlyStopping counter: 4 out of 50
epoch:  147
[Epoch 148, Batch 10] loss: 0.059
epoch:  148 val_f1:  0.7932273763653603 val_auroc:  0.8703972868217054 val_auprc:  0.9446215815727232
EarlyStopping counter: 5 out of 50
epoch:  148
[Epoch 149, Batch 10] loss: 0.047
epoch:  149 val_f1:  0.7932273763653603 val_auroc:  0.872577519379845 val_auprc:  0.9448596819635069
EarlyStopping counter: 6 out of 50
epoch:  149
[Epoch 150, Batch 10] loss: 0.046
epoch:  150 val_f1:  0.8084949329130455 val_auroc:  0.8720930232558141 val_auprc:  0.9455369410862439
EarlyStopping counter: 7 out of 50
epoch:  150
[Epoch 151, Batch 10] loss: 0.045
epoch:  151 val_f1:  0.8084949329130455 val_auroc:  0.8718507751937984 val_auprc:  0.9449374778477244
EarlyStopping counter: 8 out of 50
epoch:  151
[Epoch 152, Batch 10] loss: 0.053
epoch:  152 val_f1:  0.7682301875730638 val_auroc:  0.8733042635658914 val_auprc:  0.9453285974597493
EarlyStopping counter: 9 out of 50
epoch:  152
[Epoch 153, Batch 10] loss: 0.051
epoch:  153 val_f1:  0.7932273763653603 val_auroc:  0.872577519379845 val_auprc:  0.944964153418823
EarlyStopping counter: 10 out of 50
epoch:  153
[Epoch 154, Batch 10] loss: 0.044
epoch:  154 val_f1:  0.792019787311512 val_auroc:  0.872093023255814 val_auprc:  0.9453354360723506
EarlyStopping counter: 11 out of 50
epoch:  154
[Epoch 155, Batch 10] loss: 0.047
epoch:  155 val_f1:  0.7932273763653603 val_auroc:  0.8733042635658915 val_auprc:  0.9450451567419884
EarlyStopping counter: 12 out of 50
epoch:  155
[Epoch 156, Batch 10] loss: 0.044
epoch:  156 val_f1:  0.8084949329130455 val_auroc:  0.874031007751938 val_auprc:  0.9455882082761123
EarlyStopping counter: 13 out of 50
epoch:  156
[Epoch 157, Batch 10] loss: 0.043
epoch:  157 val_f1:  0.8093907785715628 val_auroc:  0.872093023255814 val_auprc:  0.9449218647426085
EarlyStopping counter: 14 out of 50
epoch:  157
[Epoch 158, Batch 10] loss: 0.048
epoch:  158 val_f1:  0.8084949329130455 val_auroc:  0.8718507751937985 val_auprc:  0.9450859741018228
EarlyStopping counter: 15 out of 50
epoch:  158
[Epoch 159, Batch 10] loss: 0.046
epoch:  159 val_f1:  0.8008946034661633 val_auroc:  0.8713662790697674 val_auprc:  0.9444125777469485
EarlyStopping counter: 16 out of 50
epoch:  159
[Epoch 160, Batch 10] loss: 0.041
epoch:  160 val_f1:  0.7932273763653603 val_auroc:  0.8723352713178294 val_auprc:  0.9447444671712619
EarlyStopping counter: 17 out of 50
epoch:  160
[Epoch 161, Batch 10] loss: 0.042
epoch:  161 val_f1:  0.764639197732723 val_auroc:  0.872093023255814 val_auprc:  0.9442439324080025
EarlyStopping counter: 18 out of 50
epoch:  161
[Epoch 162, Batch 10] loss: 0.041
epoch:  162 val_f1:  0.8101799492243995 val_auroc:  0.8720930232558138 val_auprc:  0.9453700153451496
EarlyStopping counter: 19 out of 50
epoch:  162
[Epoch 163, Batch 10] loss: 0.040
epoch:  163 val_f1:  0.7710202043822609 val_auroc:  0.873546511627907 val_auprc:  0.9446459234679387
EarlyStopping counter: 20 out of 50
epoch:  163
[Epoch 164, Batch 10] loss: 0.044
epoch:  164 val_f1:  0.8008946034661633 val_auroc:  0.8708817829457365 val_auprc:  0.9442315703228901
EarlyStopping counter: 21 out of 50
epoch:  164
[Epoch 165, Batch 10] loss: 0.041
epoch:  165 val_f1:  0.7854893118997625 val_auroc:  0.8728197674418605 val_auprc:  0.9448200672326625
EarlyStopping counter: 22 out of 50
epoch:  165
[Epoch 166, Batch 10] loss: 0.042
epoch:  166 val_f1:  0.8008946034661633 val_auroc:  0.8720930232558138 val_auprc:  0.9440833367986382
EarlyStopping counter: 23 out of 50
epoch:  166
[Epoch 167, Batch 10] loss: 0.039
epoch:  167 val_f1:  0.8084949329130455 val_auroc:  0.8708817829457365 val_auprc:  0.9441478387640339
EarlyStopping counter: 24 out of 50
epoch:  167
[Epoch 168, Batch 10] loss: 0.044
epoch:  168 val_f1:  0.8008946034661633 val_auroc:  0.8730620155038759 val_auprc:  0.9442906606485029
EarlyStopping counter: 25 out of 50
epoch:  168
[Epoch 169, Batch 10] loss: 0.038
epoch:  169 val_f1:  0.764639197732723 val_auroc:  0.8745155038759691 val_auprc:  0.9450875401005236
EarlyStopping counter: 26 out of 50
epoch:  169
[Epoch 170, Batch 10] loss: 0.035
epoch:  170 val_f1:  0.7710202043822609 val_auroc:  0.872093023255814 val_auprc:  0.9439184345696887
EarlyStopping counter: 27 out of 50
epoch:  170
[Epoch 171, Batch 10] loss: 0.041
epoch:  171 val_f1:  0.7827158008497472 val_auroc:  0.8742732558139534 val_auprc:  0.9450056103190725
EarlyStopping counter: 28 out of 50
epoch:  171
[Epoch 172, Batch 10] loss: 0.041
epoch:  172 val_f1:  0.8084949329130455 val_auroc:  0.8723352713178295 val_auprc:  0.9448295833410405
EarlyStopping counter: 29 out of 50
epoch:  172
[Epoch 173, Batch 10] loss: 0.039
epoch:  173 val_f1:  0.8008946034661633 val_auroc:  0.8713662790697675 val_auprc:  0.943328450195343
EarlyStopping counter: 30 out of 50
epoch:  173
[Epoch 174, Batch 10] loss: 0.038
epoch:  174 val_f1:  0.8035187234827523 val_auroc:  0.873062015503876 val_auprc:  0.9448090565373065
Validation loss improved to 0.131435
epoch:  174
[Epoch 175, Batch 10] loss: 0.042
epoch:  175 val_f1:  0.8084949329130455 val_auroc:  0.8728197674418603 val_auprc:  0.9445872684574426
EarlyStopping counter: 1 out of 50
epoch:  175
[Epoch 176, Batch 10] loss: 0.036
epoch:  176 val_f1:  0.7710202043822609 val_auroc:  0.875 val_auprc:  0.9449607823639945
EarlyStopping counter: 2 out of 50
epoch:  176
[Epoch 177, Batch 10] loss: 0.034
epoch:  177 val_f1:  0.7710202043822609 val_auroc:  0.8747577519379846 val_auprc:  0.9453873185826325
EarlyStopping counter: 3 out of 50
epoch:  177
[Epoch 178, Batch 10] loss: 0.035
epoch:  178 val_f1:  0.7710202043822609 val_auroc:  0.875 val_auprc:  0.9454043195928381
EarlyStopping counter: 4 out of 50
epoch:  178
[Epoch 179, Batch 10] loss: 0.031
epoch:  179 val_f1:  0.7774211400110681 val_auroc:  0.8742732558139534 val_auprc:  0.9443446960409498
EarlyStopping counter: 5 out of 50
epoch:  179
[Epoch 180, Batch 10] loss: 0.032
epoch:  180 val_f1:  0.7774211400110681 val_auroc:  0.8759689922480619 val_auprc:  0.9453151711308448
EarlyStopping counter: 6 out of 50
epoch:  180
[Epoch 181, Batch 10] loss: 0.032
epoch:  181 val_f1:  0.8151164175042944 val_auroc:  0.8747577519379846 val_auprc:  0.9457843686109784
EarlyStopping counter: 7 out of 50
epoch:  181
[Epoch 182, Batch 10] loss: 0.032
epoch:  182 val_f1:  0.8008946034661633 val_auroc:  0.874031007751938 val_auprc:  0.945342548824987
EarlyStopping counter: 8 out of 50
epoch:  182
[Epoch 183, Batch 10] loss: 0.036
epoch:  183 val_f1:  0.8063632502555458 val_auroc:  0.8745155038759689 val_auprc:  0.945148168297259
EarlyStopping counter: 9 out of 50
epoch:  183
[Epoch 184, Batch 10] loss: 0.031
epoch:  184 val_f1:  0.7710202043822609 val_auroc:  0.8747577519379844 val_auprc:  0.9446180023821308
EarlyStopping counter: 10 out of 50
epoch:  184
[Epoch 185, Batch 10] loss: 0.030
epoch:  185 val_f1:  0.7892012988311853 val_auroc:  0.874031007751938 val_auprc:  0.9448972559079054
EarlyStopping counter: 11 out of 50
epoch:  185
[Epoch 186, Batch 10] loss: 0.033
epoch:  186 val_f1:  0.8168429178951009 val_auroc:  0.8737887596899224 val_auprc:  0.9455913257057396
EarlyStopping counter: 12 out of 50
epoch:  186
[Epoch 187, Batch 10] loss: 0.038
epoch:  187 val_f1:  0.8018807955038493 val_auroc:  0.8728197674418604 val_auprc:  0.9452614378634867
EarlyStopping counter: 13 out of 50
epoch:  187
[Epoch 188, Batch 10] loss: 0.038
epoch:  188 val_f1:  0.7746634573712671 val_auroc:  0.872577519379845 val_auprc:  0.9448922519218172
EarlyStopping counter: 14 out of 50
epoch:  188
[Epoch 189, Batch 10] loss: 0.031
epoch:  189 val_f1:  0.7665182935781787 val_auroc:  0.8728197674418604 val_auprc:  0.9438161950690659
EarlyStopping counter: 15 out of 50
epoch:  189
[Epoch 190, Batch 10] loss: 0.028
epoch:  190 val_f1:  0.792019787311512 val_auroc:  0.8733042635658915 val_auprc:  0.9444572253530842
EarlyStopping counter: 16 out of 50
epoch:  190
[Epoch 191, Batch 10] loss: 0.031
epoch:  191 val_f1:  0.8151164175042944 val_auroc:  0.8723352713178294 val_auprc:  0.9441146944067187
EarlyStopping counter: 17 out of 50
epoch:  191
[Epoch 192, Batch 10] loss: 0.032
epoch:  192 val_f1:  0.8151164175042944 val_auroc:  0.874031007751938 val_auprc:  0.9450405017422592
EarlyStopping counter: 18 out of 50
epoch:  192
[Epoch 193, Batch 10] loss: 0.029
epoch:  193 val_f1:  0.7729252582141845 val_auroc:  0.874515503875969 val_auprc:  0.9443608156426115
EarlyStopping counter: 19 out of 50
epoch:  193
[Epoch 194, Batch 10] loss: 0.033
epoch:  194 val_f1:  0.7811109002295425 val_auroc:  0.8728197674418605 val_auprc:  0.9443375761065019
EarlyStopping counter: 20 out of 50
epoch:  194
[Epoch 195, Batch 10] loss: 0.028
epoch:  195 val_f1:  0.7710202043822609 val_auroc:  0.874515503875969 val_auprc:  0.94470019418429
EarlyStopping counter: 21 out of 50
epoch:  195
[Epoch 196, Batch 10] loss: 0.026
epoch:  196 val_f1:  0.7793492478744277 val_auroc:  0.873546511627907 val_auprc:  0.9443379082210817
EarlyStopping counter: 22 out of 50
epoch:  196
[Epoch 197, Batch 10] loss: 0.029
epoch:  197 val_f1:  0.7892012988311853 val_auroc:  0.8733042635658915 val_auprc:  0.9451946751307816
EarlyStopping counter: 23 out of 50
epoch:  197
[Epoch 198, Batch 10] loss: 0.027
epoch:  198 val_f1:  0.7811109002295425 val_auroc:  0.8737887596899224 val_auprc:  0.9445429659972202
EarlyStopping counter: 24 out of 50
epoch:  198
[Epoch 199, Batch 10] loss: 0.027
epoch:  199 val_f1:  0.8063632502555458 val_auroc:  0.8733042635658915 val_auprc:  0.944870569978001
EarlyStopping counter: 25 out of 50
epoch:  199
[Epoch 200, Batch 10] loss: 0.029
epoch:  200 val_f1:  0.7892012988311853 val_auroc:  0.8752422480620156 val_auprc:  0.9453668036839755
EarlyStopping counter: 26 out of 50
epoch:  200
[Epoch 201, Batch 10] loss: 0.028
epoch:  201 val_f1:  0.7892012988311853 val_auroc:  0.8737887596899225 val_auprc:  0.944828630876337
EarlyStopping counter: 27 out of 50
epoch:  201
[Epoch 202, Batch 10] loss: 0.029
epoch:  202 val_f1:  0.7892012988311853 val_auroc:  0.873546511627907 val_auprc:  0.9447020401149455
EarlyStopping counter: 28 out of 50
epoch:  202
[Epoch 203, Batch 10] loss: 0.025
epoch:  203 val_f1:  0.8063632502555458 val_auroc:  0.8735465116279069 val_auprc:  0.9446960553479888
EarlyStopping counter: 29 out of 50
epoch:  203
[Epoch 204, Batch 10] loss: 0.025
epoch:  204 val_f1:  0.8063632502555458 val_auroc:  0.874031007751938 val_auprc:  0.9449375531828311
EarlyStopping counter: 30 out of 50
epoch:  204
[Epoch 205, Batch 10] loss: 0.026
epoch:  205 val_f1:  0.7811109002295425 val_auroc:  0.8723352713178295 val_auprc:  0.9424974928221708
EarlyStopping counter: 31 out of 50
epoch:  205
[Epoch 206, Batch 10] loss: 0.022
epoch:  206 val_f1:  0.7892012988311853 val_auroc:  0.8730620155038759 val_auprc:  0.943332438709058
EarlyStopping counter: 32 out of 50
epoch:  206
[Epoch 207, Batch 10] loss: 0.025
epoch:  207 val_f1:  0.7892012988311853 val_auroc:  0.8735465116279071 val_auprc:  0.944574524925863
EarlyStopping counter: 33 out of 50
epoch:  207
[Epoch 208, Batch 10] loss: 0.024
epoch:  208 val_f1:  0.7811109002295425 val_auroc:  0.875484496124031 val_auprc:  0.9450681216088853
EarlyStopping counter: 34 out of 50
epoch:  208
[Epoch 209, Batch 10] loss: 0.023
epoch:  209 val_f1:  0.7710202043822609 val_auroc:  0.8747577519379844 val_auprc:  0.9450153564990783
EarlyStopping counter: 35 out of 50
epoch:  209
[Epoch 210, Batch 10] loss: 0.024
epoch:  210 val_f1:  0.7811109002295425 val_auroc:  0.8752422480620156 val_auprc:  0.9452091665280045
EarlyStopping counter: 36 out of 50
epoch:  210
[Epoch 211, Batch 10] loss: 0.022
epoch:  211 val_f1:  0.7729252582141845 val_auroc:  0.875 val_auprc:  0.9443546654757606
EarlyStopping counter: 37 out of 50
epoch:  211
[Epoch 212, Batch 10] loss: 0.023
epoch:  212 val_f1:  0.8217477382460002 val_auroc:  0.8740310077519381 val_auprc:  0.9448334385142361
EarlyStopping counter: 38 out of 50
epoch:  212
[Epoch 213, Batch 10] loss: 0.022
epoch:  213 val_f1:  0.7811109002295425 val_auroc:  0.873546511627907 val_auprc:  0.9434845803396305
EarlyStopping counter: 39 out of 50
epoch:  213
[Epoch 214, Batch 10] loss: 0.024
epoch:  214 val_f1:  0.7906801532257888 val_auroc:  0.873062015503876 val_auprc:  0.9438422387295327
EarlyStopping counter: 40 out of 50
epoch:  214
[Epoch 215, Batch 10] loss: 0.022
epoch:  215 val_f1:  0.7811109002295425 val_auroc:  0.8728197674418605 val_auprc:  0.9425812520461359
EarlyStopping counter: 41 out of 50
epoch:  215
[Epoch 216, Batch 10] loss: 0.022
epoch:  216 val_f1:  0.7892012988311853 val_auroc:  0.873546511627907 val_auprc:  0.9436655447581928
EarlyStopping counter: 42 out of 50
epoch:  216
[Epoch 217, Batch 10] loss: 0.020
epoch:  217 val_f1:  0.7811109002295425 val_auroc:  0.8723352713178295 val_auprc:  0.9434686592460646
EarlyStopping counter: 43 out of 50
epoch:  217
[Epoch 218, Batch 10] loss: 0.021
epoch:  218 val_f1:  0.7811109002295425 val_auroc:  0.8742732558139534 val_auprc:  0.9443139179617939
EarlyStopping counter: 44 out of 50
epoch:  218
[Epoch 219, Batch 10] loss: 0.020
epoch:  219 val_f1:  0.7906801532257888 val_auroc:  0.872577519379845 val_auprc:  0.9439478431450905
EarlyStopping counter: 45 out of 50
epoch:  219
[Epoch 220, Batch 10] loss: 0.019
epoch:  220 val_f1:  0.7811109002295425 val_auroc:  0.873062015503876 val_auprc:  0.9442443528371147
EarlyStopping counter: 46 out of 50
epoch:  220
[Epoch 221, Batch 10] loss: 0.021
epoch:  221 val_f1:  0.7729252582141845 val_auroc:  0.873546511627907 val_auprc:  0.943668294773331
EarlyStopping counter: 47 out of 50
epoch:  221
[Epoch 222, Batch 10] loss: 0.021
epoch:  222 val_f1:  0.7811109002295425 val_auroc:  0.8747577519379844 val_auprc:  0.9440524665398554
EarlyStopping counter: 48 out of 50
epoch:  222
[Epoch 223, Batch 10] loss: 0.020
epoch:  223 val_f1:  0.7827158008497472 val_auroc:  0.8728197674418605 val_auprc:  0.9432903184323985
EarlyStopping counter: 49 out of 50
epoch:  223
[Epoch 224, Batch 10] loss: 0.018
epoch:  224 val_f1:  0.7811109002295425 val_auroc:  0.873546511627907 val_auprc:  0.944106899681067
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  5814.209354400635
{'time_elapsed': [5814.209354400635], 'epoch': [223], 'fold': [3], 'f1_train': [0.9981997060342249], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7811109002295425], 'auroc_test': [0.873546511627907], 'auprc_test': [0.944106899681067]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [32, 1]                   --
├─Sequential: 1-1                        [32, 1]                   --
│    └─Conv1d: 2-1                       [32, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [32, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [32, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [32, 1024, 1278]          --
│    └─Dropout: 2-5                      [32, 1024, 1278]          --
│    └─Flatten: 2-6                      [32, 1308672]             --
│    └─Linear: 2-7                       [32, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.16
Forward/backward pass size (MB): 671.09
Params size (MB): 5.26
Estimated Total Size (MB): 676.51
==========================================================================================
tensor(0.4369)
epoch:  0
[Epoch 1, Batch 10] loss: 0.608
epoch:  1 val_f1:  0.5992345818432775 val_auroc:  0.7527281746031745 val_auprc:  0.8118755852864454
epoch:  1
[Epoch 2, Batch 10] loss: 0.391
epoch:  2 val_f1:  0.29845230725272637 val_auroc:  0.7765376984126985 val_auprc:  0.8324381120248942
Validation loss improved to 0.399131
epoch:  2
[Epoch 3, Batch 10] loss: 0.371
epoch:  3 val_f1:  0.7621343873517787 val_auroc:  0.8249007936507937 val_auprc:  0.8838435354049107
Validation loss improved to 0.358932
epoch:  3
[Epoch 4, Batch 10] loss: 0.362
epoch:  4 val_f1:  0.7630946431546132 val_auroc:  0.8385416666666669 val_auprc:  0.9113885027322173
Validation loss improved to 0.342679
epoch:  4
[Epoch 5, Batch 10] loss: 0.346
epoch:  5 val_f1:  0.7494824016563146 val_auroc:  0.8588789682539684 val_auprc:  0.9304637601946699
Validation loss improved to 0.326544
epoch:  5
[Epoch 6, Batch 10] loss: 0.325
epoch:  6 val_f1:  0.7563598080432068 val_auroc:  0.8621031746031745 val_auprc:  0.9324420827819151
Validation loss improved to 0.314197
epoch:  6
[Epoch 7, Batch 10] loss: 0.327
epoch:  7 val_f1:  0.7564718869066693 val_auroc:  0.8745039682539684 val_auprc:  0.9409026523902767
Validation loss improved to 0.309122
epoch:  7
[Epoch 8, Batch 10] loss: 0.316
epoch:  8 val_f1:  0.7346809324365923 val_auroc:  0.8762400793650794 val_auprc:  0.9412635015999338
Validation loss improved to 0.302522
epoch:  8
[Epoch 9, Batch 10] loss: 0.324
epoch:  9 val_f1:  0.8030193236714975 val_auroc:  0.8747519841269842 val_auprc:  0.9401339771494308
Validation loss improved to 0.291702
epoch:  9
[Epoch 10, Batch 10] loss: 0.302
epoch:  10 val_f1:  0.7632485643970468 val_auroc:  0.8774801587301587 val_auprc:  0.9422727160821536
Validation loss improved to 0.284924
epoch:  10
[Epoch 11, Batch 10] loss: 0.299
epoch:  11 val_f1:  0.7905459035188288 val_auroc:  0.8779761904761906 val_auprc:  0.9406976439833113
Validation loss improved to 0.278375
epoch:  11
[Epoch 12, Batch 10] loss: 0.289
epoch:  12 val_f1:  0.8061683443992288 val_auroc:  0.878720238095238 val_auprc:  0.9411282330977196
EarlyStopping counter: 1 out of 50
epoch:  12
[Epoch 13, Batch 10] loss: 0.287
epoch:  13 val_f1:  0.8103538508923273 val_auroc:  0.8777281746031745 val_auprc:  0.9396919317902799
Validation loss improved to 0.275464
epoch:  13
[Epoch 14, Batch 10] loss: 0.257
epoch:  14 val_f1:  0.756376995929398 val_auroc:  0.8792162698412699 val_auprc:  0.9420654935802051
Validation loss improved to 0.273530
epoch:  14
[Epoch 15, Batch 10] loss: 0.269
epoch:  15 val_f1:  0.8014350667803353 val_auroc:  0.878720238095238 val_auprc:  0.9398569621804175
EarlyStopping counter: 1 out of 50
epoch:  15
[Epoch 16, Batch 10] loss: 0.276
epoch:  16 val_f1:  0.8348841452289729 val_auroc:  0.8809523809523809 val_auprc:  0.9420682397338171
Validation loss improved to 0.273487
epoch:  16
[Epoch 17, Batch 10] loss: 0.272
epoch:  17 val_f1:  0.770099160945843 val_auroc:  0.8821924603174603 val_auprc:  0.9427054013976836
Validation loss improved to 0.263163
epoch:  17
[Epoch 18, Batch 10] loss: 0.250
epoch:  18 val_f1:  0.7810348219555381 val_auroc:  0.8767361111111112 val_auprc:  0.939344761667283
EarlyStopping counter: 1 out of 50
epoch:  18
[Epoch 19, Batch 10] loss: 0.261
epoch:  19 val_f1:  0.792371879328401 val_auroc:  0.882936507936508 val_auprc:  0.9433202568535766
EarlyStopping counter: 2 out of 50
epoch:  19
[Epoch 20, Batch 10] loss: 0.280
epoch:  20 val_f1:  0.8097298254042504 val_auroc:  0.8774801587301587 val_auprc:  0.941864563000858
Validation loss improved to 0.261571
epoch:  20
[Epoch 21, Batch 10] loss: 0.259
epoch:  21 val_f1:  0.7769308547872755 val_auroc:  0.8809523809523808 val_auprc:  0.9424740627494528
Validation loss improved to 0.252000
epoch:  21
[Epoch 22, Batch 10] loss: 0.244
epoch:  22 val_f1:  0.7494824016563146 val_auroc:  0.8814484126984127 val_auprc:  0.9426775611199062
EarlyStopping counter: 1 out of 50
epoch:  22
[Epoch 23, Batch 10] loss: 0.231
epoch:  23 val_f1:  0.822380909337431 val_auroc:  0.8794642857142857 val_auprc:  0.9409284247510163
EarlyStopping counter: 2 out of 50
epoch:  23
[Epoch 24, Batch 10] loss: 0.233
epoch:  24 val_f1:  0.8138718358422335 val_auroc:  0.8787202380952381 val_auprc:  0.941298195082346
EarlyStopping counter: 3 out of 50
epoch:  24
[Epoch 25, Batch 10] loss: 0.238
epoch:  25 val_f1:  0.8100998424466828 val_auroc:  0.8717757936507936 val_auprc:  0.9372472572523803
EarlyStopping counter: 4 out of 50
epoch:  25
[Epoch 26, Batch 10] loss: 0.244
epoch:  26 val_f1:  0.8215074100875418 val_auroc:  0.8799603174603174 val_auprc:  0.941941313154596
EarlyStopping counter: 5 out of 50
epoch:  26
[Epoch 27, Batch 10] loss: 0.226
epoch:  27 val_f1:  0.7969889682024659 val_auroc:  0.8762400793650794 val_auprc:  0.9406014016484676
EarlyStopping counter: 6 out of 50
epoch:  27
[Epoch 28, Batch 10] loss: 0.244
epoch:  28 val_f1:  0.7949078298424175 val_auroc:  0.8752480158730158 val_auprc:  0.9394204191888573
EarlyStopping counter: 7 out of 50
epoch:  28
[Epoch 29, Batch 10] loss: 0.208
epoch:  29 val_f1:  0.8281893869312926 val_auroc:  0.8754960317460317 val_auprc:  0.9397682059077594
EarlyStopping counter: 8 out of 50
epoch:  29
[Epoch 30, Batch 10] loss: 0.213
epoch:  30 val_f1:  0.7904805491990847 val_auroc:  0.8757440476190477 val_auprc:  0.9391623997685046
EarlyStopping counter: 9 out of 50
epoch:  30
[Epoch 31, Batch 10] loss: 0.226
epoch:  31 val_f1:  0.8231516182680737 val_auroc:  0.8740079365079366 val_auprc:  0.9388820664504178
EarlyStopping counter: 10 out of 50
epoch:  31
[Epoch 32, Batch 10] loss: 0.213
epoch:  32 val_f1:  0.8054462242562929 val_auroc:  0.8705357142857143 val_auprc:  0.9366942034542359
EarlyStopping counter: 11 out of 50
epoch:  32
[Epoch 33, Batch 10] loss: 0.220
epoch:  33 val_f1:  0.8022296544035674 val_auroc:  0.8759920634920635 val_auprc:  0.9394089848257157
EarlyStopping counter: 12 out of 50
epoch:  33
[Epoch 34, Batch 10] loss: 0.198
epoch:  34 val_f1:  0.807228002894545 val_auroc:  0.8715277777777778 val_auprc:  0.9374610815596346
EarlyStopping counter: 13 out of 50
epoch:  34
[Epoch 35, Batch 10] loss: 0.195
epoch:  35 val_f1:  0.8054462242562929 val_auroc:  0.8705357142857142 val_auprc:  0.9369475158910868
EarlyStopping counter: 14 out of 50
epoch:  35
[Epoch 36, Batch 10] loss: 0.202
epoch:  36 val_f1:  0.8194319840387783 val_auroc:  0.8745039682539683 val_auprc:  0.9388566559465933
EarlyStopping counter: 15 out of 50
epoch:  36
[Epoch 37, Batch 10] loss: 0.206
epoch:  37 val_f1:  0.7969889682024659 val_auroc:  0.8695436507936508 val_auprc:  0.9363668540455311
EarlyStopping counter: 16 out of 50
epoch:  37
[Epoch 38, Batch 10] loss: 0.202
epoch:  38 val_f1:  0.8061683443992288 val_auroc:  0.8717757936507937 val_auprc:  0.9376631300803526
EarlyStopping counter: 17 out of 50
epoch:  38
[Epoch 39, Batch 10] loss: 0.188
epoch:  39 val_f1:  0.8103538508923273 val_auroc:  0.873263888888889 val_auprc:  0.9384398631037607
Validation loss improved to 0.246149
epoch:  39
[Epoch 40, Batch 10] loss: 0.199
epoch:  40 val_f1:  0.8103538508923273 val_auroc:  0.8752480158730159 val_auprc:  0.9397323982923356
EarlyStopping counter: 1 out of 50
epoch:  40
[Epoch 41, Batch 10] loss: 0.183
epoch:  41 val_f1:  0.8090037477295196 val_auroc:  0.873015873015873 val_auprc:  0.9384741042187172
EarlyStopping counter: 2 out of 50
epoch:  41
[Epoch 42, Batch 10] loss: 0.189
epoch:  42 val_f1:  0.8220330394243437 val_auroc:  0.8700396825396826 val_auprc:  0.9365019116977306
EarlyStopping counter: 3 out of 50
epoch:  42
[Epoch 43, Batch 10] loss: 0.194
epoch:  43 val_f1:  0.7971014492753623 val_auroc:  0.8730158730158731 val_auprc:  0.9377323076178685
EarlyStopping counter: 4 out of 50
epoch:  43
[Epoch 44, Batch 10] loss: 0.184
epoch:  44 val_f1:  0.8231516182680737 val_auroc:  0.8742559523809523 val_auprc:  0.93956190357179
EarlyStopping counter: 5 out of 50
epoch:  44
[Epoch 45, Batch 10] loss: 0.180
epoch:  45 val_f1:  0.8170893719806764 val_auroc:  0.8742559523809523 val_auprc:  0.9377816769753621
EarlyStopping counter: 6 out of 50
epoch:  45
[Epoch 46, Batch 10] loss: 0.185
epoch:  46 val_f1:  0.7773176903611687 val_auroc:  0.8752480158730158 val_auprc:  0.939137808857904
EarlyStopping counter: 7 out of 50
epoch:  46
[Epoch 47, Batch 10] loss: 0.199
epoch:  47 val_f1:  0.7969889682024659 val_auroc:  0.8725198412698413 val_auprc:  0.93699776621912
EarlyStopping counter: 8 out of 50
epoch:  47
[Epoch 48, Batch 10] loss: 0.184
epoch:  48 val_f1:  0.7949078298424175 val_auroc:  0.8697916666666666 val_auprc:  0.933779999192489
EarlyStopping counter: 9 out of 50
epoch:  48
[Epoch 49, Batch 10] loss: 0.192
epoch:  49 val_f1:  0.8054462242562929 val_auroc:  0.8700396825396826 val_auprc:  0.9365950133681851
EarlyStopping counter: 10 out of 50
epoch:  49
[Epoch 50, Batch 10] loss: 0.169
epoch:  50 val_f1:  0.8088065661047027 val_auroc:  0.8720238095238095 val_auprc:  0.9374953841973463
EarlyStopping counter: 11 out of 50
epoch:  50
[Epoch 51, Batch 10] loss: 0.162
epoch:  51 val_f1:  0.817642543094424 val_auroc:  0.8722718253968255 val_auprc:  0.9376426657577481
EarlyStopping counter: 12 out of 50
epoch:  51
[Epoch 52, Batch 10] loss: 0.171
epoch:  52 val_f1:  0.8041106719367591 val_auroc:  0.8735119047619048 val_auprc:  0.939877673578339
Validation loss improved to 0.246038
epoch:  52
[Epoch 53, Batch 10] loss: 0.176
epoch:  53 val_f1:  0.8022296544035674 val_auroc:  0.8717757936507936 val_auprc:  0.9368668558050994
EarlyStopping counter: 1 out of 50
epoch:  53
[Epoch 54, Batch 10] loss: 0.174
epoch:  54 val_f1:  0.7956729455237178 val_auroc:  0.8673115079365081 val_auprc:  0.9337274964433048
EarlyStopping counter: 2 out of 50
epoch:  54
[Epoch 55, Batch 10] loss: 0.171
epoch:  55 val_f1:  0.7891335560760728 val_auroc:  0.8710317460317459 val_auprc:  0.9358010665977179
EarlyStopping counter: 3 out of 50
epoch:  55
[Epoch 56, Batch 10] loss: 0.164
epoch:  56 val_f1:  0.7891335560760728 val_auroc:  0.8737599206349206 val_auprc:  0.9387512139052852
EarlyStopping counter: 4 out of 50
epoch:  56
[Epoch 57, Batch 10] loss: 0.163
epoch:  57 val_f1:  0.8138718358422335 val_auroc:  0.8730158730158729 val_auprc:  0.9379568895060224
EarlyStopping counter: 5 out of 50
epoch:  57
[Epoch 58, Batch 10] loss: 0.146
epoch:  58 val_f1:  0.7956729455237178 val_auroc:  0.8707837301587301 val_auprc:  0.9364067761385386
EarlyStopping counter: 6 out of 50
epoch:  58
[Epoch 59, Batch 10] loss: 0.146
epoch:  59 val_f1:  0.7971014492753623 val_auroc:  0.8702876984126985 val_auprc:  0.9355316555249662
EarlyStopping counter: 7 out of 50
epoch:  59
[Epoch 60, Batch 10] loss: 0.149
epoch:  60 val_f1:  0.7971014492753623 val_auroc:  0.8692956349206349 val_auprc:  0.9347184901788803
EarlyStopping counter: 8 out of 50
epoch:  60
[Epoch 61, Batch 10] loss: 0.145
epoch:  61 val_f1:  0.8205262448141007 val_auroc:  0.8695436507936508 val_auprc:  0.9349440948945449
EarlyStopping counter: 9 out of 50
epoch:  61
[Epoch 62, Batch 10] loss: 0.148
epoch:  62 val_f1:  0.7926396128627546 val_auroc:  0.8683035714285715 val_auprc:  0.9328274892153305
EarlyStopping counter: 10 out of 50
epoch:  62
[Epoch 63, Batch 10] loss: 0.163
epoch:  63 val_f1:  0.8215074100875418 val_auroc:  0.8735119047619048 val_auprc:  0.9380232252880485
Validation loss improved to 0.244455
epoch:  63
[Epoch 64, Batch 10] loss: 0.141
epoch:  64 val_f1:  0.795635738397158 val_auroc:  0.871279761904762 val_auprc:  0.9365168873500496
Validation loss improved to 0.241206
epoch:  64
[Epoch 65, Batch 10] loss: 0.160
epoch:  65 val_f1:  0.8023197893688181 val_auroc:  0.8752480158730158 val_auprc:  0.9402454055828067
Validation loss improved to 0.240660
epoch:  65
[Epoch 66, Batch 10] loss: 0.137
epoch:  66 val_f1:  0.8036760694501368 val_auroc:  0.8735119047619048 val_auprc:  0.9377608019585344
EarlyStopping counter: 1 out of 50
epoch:  66
[Epoch 67, Batch 10] loss: 0.132
epoch:  67 val_f1:  0.8138718358422335 val_auroc:  0.8735119047619047 val_auprc:  0.9367196560797012
EarlyStopping counter: 2 out of 50
epoch:  67
[Epoch 68, Batch 10] loss: 0.149
epoch:  68 val_f1:  0.7973334973248877 val_auroc:  0.8762400793650794 val_auprc:  0.9399164908973472
Validation loss improved to 0.237880
epoch:  68
[Epoch 69, Batch 10] loss: 0.138
epoch:  69 val_f1:  0.7904805491990847 val_auroc:  0.8678075396825397 val_auprc:  0.9310337409482418
EarlyStopping counter: 1 out of 50
epoch:  69
[Epoch 70, Batch 10] loss: 0.130
epoch:  70 val_f1:  0.792371879328401 val_auroc:  0.8695436507936508 val_auprc:  0.9334117927087591
EarlyStopping counter: 2 out of 50
epoch:  70
[Epoch 71, Batch 10] loss: 0.145
epoch:  71 val_f1:  0.7904805491990847 val_auroc:  0.8675595238095238 val_auprc:  0.9309033444168603
EarlyStopping counter: 3 out of 50
epoch:  71
[Epoch 72, Batch 10] loss: 0.136
epoch:  72 val_f1:  0.792371879328401 val_auroc:  0.8690476190476191 val_auprc:  0.9322164806093165
EarlyStopping counter: 4 out of 50
epoch:  72
[Epoch 73, Batch 10] loss: 0.131
epoch:  73 val_f1:  0.8036760694501368 val_auroc:  0.8725198412698413 val_auprc:  0.935949928400214
EarlyStopping counter: 5 out of 50
epoch:  73
[Epoch 74, Batch 10] loss: 0.130
epoch:  74 val_f1:  0.8023197893688181 val_auroc:  0.873263888888889 val_auprc:  0.9357367646324382
EarlyStopping counter: 6 out of 50
epoch:  74
[Epoch 75, Batch 10] loss: 0.133
epoch:  75 val_f1:  0.7976976212494236 val_auroc:  0.8754960317460317 val_auprc:  0.9391704001515464
EarlyStopping counter: 7 out of 50
epoch:  75
[Epoch 76, Batch 10] loss: 0.137
epoch:  76 val_f1:  0.8115942028985508 val_auroc:  0.8725198412698413 val_auprc:  0.9355901483526698
EarlyStopping counter: 8 out of 50
epoch:  76
[Epoch 77, Batch 10] loss: 0.131
epoch:  77 val_f1:  0.8022296544035674 val_auroc:  0.8745039682539683 val_auprc:  0.9369953967237579
EarlyStopping counter: 9 out of 50
epoch:  77
[Epoch 78, Batch 10] loss: 0.131
epoch:  78 val_f1:  0.7904805491990847 val_auroc:  0.8705357142857143 val_auprc:  0.9330712700660753
EarlyStopping counter: 10 out of 50
epoch:  78
[Epoch 79, Batch 10] loss: 0.118
epoch:  79 val_f1:  0.7839990466164816 val_auroc:  0.8707837301587301 val_auprc:  0.9328631542357274
EarlyStopping counter: 11 out of 50
epoch:  79
[Epoch 80, Batch 10] loss: 0.128
epoch:  80 val_f1:  0.7839990466164816 val_auroc:  0.8725198412698412 val_auprc:  0.9336482692285931
EarlyStopping counter: 12 out of 50
epoch:  80
[Epoch 81, Batch 10] loss: 0.114
epoch:  81 val_f1:  0.7956729455237178 val_auroc:  0.8725198412698412 val_auprc:  0.9328014283048238
EarlyStopping counter: 13 out of 50
epoch:  81
[Epoch 82, Batch 10] loss: 0.122
epoch:  82 val_f1:  0.7839990466164816 val_auroc:  0.8720238095238095 val_auprc:  0.9333815675361579
EarlyStopping counter: 14 out of 50
epoch:  82
[Epoch 83, Batch 10] loss: 0.096
epoch:  83 val_f1:  0.7956729455237178 val_auroc:  0.8735119047619048 val_auprc:  0.9338054032987393
EarlyStopping counter: 15 out of 50
epoch:  83
[Epoch 84, Batch 10] loss: 0.114
epoch:  84 val_f1:  0.8022296544035674 val_auroc:  0.8707837301587302 val_auprc:  0.9313899568551051
EarlyStopping counter: 16 out of 50
epoch:  84
[Epoch 85, Batch 10] loss: 0.125
epoch:  85 val_f1:  0.800639197204071 val_auroc:  0.8717757936507937 val_auprc:  0.9335304237217336
EarlyStopping counter: 17 out of 50
epoch:  85
[Epoch 86, Batch 10] loss: 0.106
epoch:  86 val_f1:  0.8271938694055665 val_auroc:  0.8737599206349206 val_auprc:  0.9343206598192828
EarlyStopping counter: 18 out of 50
epoch:  86
[Epoch 87, Batch 10] loss: 0.110
epoch:  87 val_f1:  0.8036760694501368 val_auroc:  0.8715277777777778 val_auprc:  0.9329537706420896
EarlyStopping counter: 19 out of 50
epoch:  87
[Epoch 88, Batch 10] loss: 0.111
epoch:  88 val_f1:  0.8015122873345937 val_auroc:  0.8737599206349207 val_auprc:  0.9344230312026538
EarlyStopping counter: 20 out of 50
epoch:  88
[Epoch 89, Batch 10] loss: 0.116
epoch:  89 val_f1:  0.8036760694501368 val_auroc:  0.8727678571428572 val_auprc:  0.9339620465594689
EarlyStopping counter: 21 out of 50
epoch:  89
[Epoch 90, Batch 10] loss: 0.104
epoch:  90 val_f1:  0.8036760694501368 val_auroc:  0.8757440476190477 val_auprc:  0.9352813236216034
EarlyStopping counter: 22 out of 50
epoch:  90
[Epoch 91, Batch 10] loss: 0.113
epoch:  91 val_f1:  0.8102677351291666 val_auroc:  0.8742559523809523 val_auprc:  0.9344278955239421
EarlyStopping counter: 23 out of 50
epoch:  91
[Epoch 92, Batch 10] loss: 0.101
epoch:  92 val_f1:  0.7940993788819876 val_auroc:  0.8700396825396826 val_auprc:  0.9301278252841053
EarlyStopping counter: 24 out of 50
epoch:  92
[Epoch 93, Batch 10] loss: 0.102
epoch:  93 val_f1:  0.8102677351291666 val_auroc:  0.8735119047619048 val_auprc:  0.9321062438045822
EarlyStopping counter: 25 out of 50
epoch:  93
[Epoch 94, Batch 10] loss: 0.104
epoch:  94 val_f1:  0.7839990466164816 val_auroc:  0.8745039682539684 val_auprc:  0.9329932757826973
EarlyStopping counter: 26 out of 50
epoch:  94
[Epoch 95, Batch 10] loss: 0.105
epoch:  95 val_f1:  0.792371879328401 val_auroc:  0.8685515873015872 val_auprc:  0.9281282200511709
EarlyStopping counter: 27 out of 50
epoch:  95
[Epoch 96, Batch 10] loss: 0.101
epoch:  96 val_f1:  0.792371879328401 val_auroc:  0.8705357142857142 val_auprc:  0.9283607862495653
EarlyStopping counter: 28 out of 50
epoch:  96
[Epoch 97, Batch 10] loss: 0.104
epoch:  97 val_f1:  0.8036760694501368 val_auroc:  0.8740079365079365 val_auprc:  0.932640108481235
EarlyStopping counter: 29 out of 50
epoch:  97
[Epoch 98, Batch 10] loss: 0.104
epoch:  98 val_f1:  0.8102677351291666 val_auroc:  0.8735119047619049 val_auprc:  0.9315952854691462
EarlyStopping counter: 30 out of 50
epoch:  98
[Epoch 99, Batch 10] loss: 0.097
epoch:  99 val_f1:  0.7904805491990847 val_auroc:  0.8712797619047619 val_auprc:  0.9284378256466601
EarlyStopping counter: 31 out of 50
epoch:  99
[Epoch 100, Batch 10] loss: 0.097
epoch:  100 val_f1:  0.7839990466164816 val_auroc:  0.8707837301587302 val_auprc:  0.9297660431386183
EarlyStopping counter: 32 out of 50
epoch:  100
[Epoch 101, Batch 10] loss: 0.095
epoch:  101 val_f1:  0.8102677351291666 val_auroc:  0.8705357142857143 val_auprc:  0.9297046047320727
EarlyStopping counter: 33 out of 50
epoch:  101
[Epoch 102, Batch 10] loss: 0.098
epoch:  102 val_f1:  0.8022296544035674 val_auroc:  0.8727678571428571 val_auprc:  0.9306769891288476
EarlyStopping counter: 34 out of 50
epoch:  102
[Epoch 103, Batch 10] loss: 0.093
epoch:  103 val_f1:  0.8088065661047027 val_auroc:  0.8725198412698413 val_auprc:  0.9306013731238048
EarlyStopping counter: 35 out of 50
epoch:  103
[Epoch 104, Batch 10] loss: 0.101
epoch:  104 val_f1:  0.8194319840387783 val_auroc:  0.8717757936507937 val_auprc:  0.9304487803989633
EarlyStopping counter: 36 out of 50
epoch:  104
[Epoch 105, Batch 10] loss: 0.088
epoch:  105 val_f1:  0.8115942028985508 val_auroc:  0.873015873015873 val_auprc:  0.930593413726125
EarlyStopping counter: 37 out of 50
epoch:  105
[Epoch 106, Batch 10] loss: 0.088
epoch:  106 val_f1:  0.792371879328401 val_auroc:  0.8705357142857142 val_auprc:  0.9279032285745648
EarlyStopping counter: 38 out of 50
epoch:  106
[Epoch 107, Batch 10] loss: 0.088
epoch:  107 val_f1:  0.8088065661047027 val_auroc:  0.8712797619047619 val_auprc:  0.9287951367130407
EarlyStopping counter: 39 out of 50
epoch:  107
[Epoch 108, Batch 10] loss: 0.080
epoch:  108 val_f1:  0.8102677351291666 val_auroc:  0.8705357142857143 val_auprc:  0.9289074807200196
EarlyStopping counter: 40 out of 50
epoch:  108
[Epoch 109, Batch 10] loss: 0.079
epoch:  109 val_f1:  0.8138718358422335 val_auroc:  0.8745039682539683 val_auprc:  0.9298976761731781
EarlyStopping counter: 41 out of 50
epoch:  109
[Epoch 110, Batch 10] loss: 0.082
epoch:  110 val_f1:  0.8127933585226971 val_auroc:  0.8740079365079365 val_auprc:  0.930062510711334
EarlyStopping counter: 42 out of 50
epoch:  110
[Epoch 111, Batch 10] loss: 0.082
epoch:  111 val_f1:  0.8102677351291666 val_auroc:  0.8740079365079365 val_auprc:  0.9304562924866362
EarlyStopping counter: 43 out of 50
epoch:  111
[Epoch 112, Batch 10] loss: 0.090
epoch:  112 val_f1:  0.792371879328401 val_auroc:  0.8722718253968254 val_auprc:  0.9261011243576439
EarlyStopping counter: 44 out of 50
epoch:  112
[Epoch 113, Batch 10] loss: 0.075
epoch:  113 val_f1:  0.7839990466164816 val_auroc:  0.8740079365079365 val_auprc:  0.9260838674423224
EarlyStopping counter: 45 out of 50
epoch:  113
[Epoch 114, Batch 10] loss: 0.082
epoch:  114 val_f1:  0.8036760694501368 val_auroc:  0.8720238095238095 val_auprc:  0.9252068441211796
EarlyStopping counter: 46 out of 50
epoch:  114
[Epoch 115, Batch 10] loss: 0.088
epoch:  115 val_f1:  0.8102677351291666 val_auroc:  0.871031746031746 val_auprc:  0.9250582002535833
EarlyStopping counter: 47 out of 50
epoch:  115
[Epoch 116, Batch 10] loss: 0.080
epoch:  116 val_f1:  0.8022296544035674 val_auroc:  0.8702876984126984 val_auprc:  0.9177913721746229
EarlyStopping counter: 48 out of 50
epoch:  116
[Epoch 117, Batch 10] loss: 0.075
epoch:  117 val_f1:  0.7904805491990847 val_auroc:  0.8705357142857142 val_auprc:  0.9179762673030535
EarlyStopping counter: 49 out of 50
epoch:  117
[Epoch 118, Batch 10] loss: 0.079
epoch:  118 val_f1:  0.800639197204071 val_auroc:  0.8717757936507936 val_auprc:  0.9218292539164458
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  3040.9954533576965
{'time_elapsed': [3040.9954533576965], 'epoch': [117], 'fold': [4], 'f1_train': [0.9785861146792981], 'auroc_train': [0.998532177423054], 'auprc_train': [0.9994094208232671], 'f1_test': [0.800639197204071], 'auroc_test': [0.8717757936507936], 'auprc_test': [0.9218292539164458]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [32, 1]                   --
├─Sequential: 1-1                        [32, 1]                   --
│    └─Conv1d: 2-1                       [32, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [32, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [32, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [32, 1024, 1278]          --
│    └─Dropout: 2-5                      [32, 1024, 1278]          --
│    └─Flatten: 2-6                      [32, 1308672]             --
│    └─Linear: 2-7                       [32, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.16
Forward/backward pass size (MB): 671.09
Params size (MB): 5.26
Estimated Total Size (MB): 676.51
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_3', 'config': {'hidden_channels': [1024], 'epochs': 500, 'kernel_size': 3, 'pool_kernel_size': 3, 'classes': 2, 'seed': 42, 'batch_size': 32, 'lr': 1e-05, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
[Epoch 1, Batch 10] loss: 0.464
epoch:  1 val_f1:  0.5334581649748694 val_auroc:  0.6107020127638685 val_auprc:  0.7993597399890623
epoch:  1
[Epoch 2, Batch 10] loss: 0.401
epoch:  2 val_f1:  0.629092664954331 val_auroc:  0.5984290623465882 val_auprc:  0.7439934949602676
EarlyStopping counter: 1 out of 50
epoch:  2
[Epoch 3, Batch 10] loss: 0.405
epoch:  3 val_f1:  0.5985139007438117 val_auroc:  0.616593028964163 val_auprc:  0.7612093942069866
Validation loss improved to 2.119396
epoch:  3
[Epoch 4, Batch 10] loss: 0.397
epoch:  4 val_f1:  0.5968970095046283 val_auroc:  0.631566028473245 val_auprc:  0.7729112420013473
Validation loss improved to 2.101659
epoch:  4
[Epoch 5, Batch 10] loss: 0.396
epoch:  5 val_f1:  0.6463519903996252 val_auroc:  0.6428571428571429 val_auprc:  0.7867694638460627
EarlyStopping counter: 1 out of 50
epoch:  5
[Epoch 6, Batch 10] loss: 0.398
epoch:  6 val_f1:  0.5968970095046283 val_auroc:  0.6669121256750123 val_auprc:  0.8063703692412869
Validation loss improved to 2.071489
epoch:  6
[Epoch 7, Batch 10] loss: 0.394
epoch:  7 val_f1:  0.6338388558291804 val_auroc:  0.6755031909671085 val_auprc:  0.8113095675455565
Validation loss improved to 2.070431
epoch:  7
[Epoch 8, Batch 10] loss: 0.390
epoch:  8 val_f1:  0.6480571813790269 val_auroc:  0.6907216494845361 val_auprc:  0.8269501139096944
Validation loss improved to 2.055847
epoch:  8
[Epoch 9, Batch 10] loss: 0.370
epoch:  9 val_f1:  0.6472345296242701 val_auroc:  0.6971035837015219 val_auprc:  0.8326106778012707
Validation loss improved to 2.032885
epoch:  9
[Epoch 10, Batch 10] loss: 0.379
epoch:  10 val_f1:  0.646667571603095 val_auroc:  0.710112911143839 val_auprc:  0.8446977524579211
Validation loss improved to 2.015393
epoch:  10
[Epoch 11, Batch 10] loss: 0.375
epoch:  11 val_f1:  0.6618588605406337 val_auroc:  0.7137947962690231 val_auprc:  0.8461111225751214
EarlyStopping counter: 1 out of 50
epoch:  11
[Epoch 12, Batch 10] loss: 0.370
epoch:  12 val_f1:  0.6614736591628271 val_auroc:  0.7248404516445754 val_auprc:  0.8538442543850321
Validation loss improved to 1.992575
epoch:  12
[Epoch 13, Batch 10] loss: 0.351
epoch:  13 val_f1:  0.6538912937446653 val_auroc:  0.729504172803142 val_auprc:  0.8559018350516197
Validation loss improved to 1.977381
epoch:  13
[Epoch 14, Batch 10] loss: 0.351
epoch:  14 val_f1:  0.6617377698806362 val_auroc:  0.729504172803142 val_auprc:  0.8567466498557457
Validation loss improved to 1.974738
epoch:  14
[Epoch 15, Batch 10] loss: 0.348
epoch:  15 val_f1:  0.6754718212640907 val_auroc:  0.7368679430535101 val_auprc:  0.8632197462077018
Validation loss improved to 1.969461
epoch:  15
[Epoch 16, Batch 10] loss: 0.352
epoch:  16 val_f1:  0.6756372438556401 val_auroc:  0.7437407952871871 val_auprc:  0.8669127172845146
Validation loss improved to 1.954608
epoch:  16
[Epoch 17, Batch 10] loss: 0.349
epoch:  17 val_f1:  0.6823403921278894 val_auroc:  0.7511045655375552 val_auprc:  0.8713756592460036
Validation loss improved to 1.934870
epoch:  17
[Epoch 18, Batch 10] loss: 0.338
epoch:  18 val_f1:  0.6687657666074932 val_auroc:  0.750613647520864 val_auprc:  0.8714233554882226
Validation loss improved to 1.931977
epoch:  18
[Epoch 19, Batch 10] loss: 0.335
epoch:  19 val_f1:  0.6824751963135375 val_auroc:  0.753804614629357 val_auprc:  0.8731883429508775
Validation loss improved to 1.924399
epoch:  19
[Epoch 20, Batch 10] loss: 0.336
epoch:  20 val_f1:  0.6825214527173443 val_auroc:  0.7584683357879234 val_auprc:  0.8769784918675431
Validation loss improved to 1.906691
epoch:  20
[Epoch 21, Batch 10] loss: 0.332
epoch:  21 val_f1:  0.6893510131556864 val_auroc:  0.7638684339715267 val_auprc:  0.88047200020387
Validation loss improved to 1.894258
epoch:  21
[Epoch 22, Batch 10] loss: 0.332
epoch:  22 val_f1:  0.7229061670449737 val_auroc:  0.7638684339715268 val_auprc:  0.8809966252752046
EarlyStopping counter: 1 out of 50
epoch:  22
[Epoch 23, Batch 10] loss: 0.330
epoch:  23 val_f1:  0.730071543320129 val_auroc:  0.7695139911634757 val_auprc:  0.8859222312058996
Validation loss improved to 1.883978
epoch:  23
[Epoch 24, Batch 10] loss: 0.313
epoch:  24 val_f1:  0.7169009504644194 val_auroc:  0.7722140402552774 val_auprc:  0.887084528970624
Validation loss improved to 1.871685
epoch:  24
[Epoch 25, Batch 10] loss: 0.322
epoch:  25 val_f1:  0.7101700457815566 val_auroc:  0.7727049582719685 val_auprc:  0.8873705995568131
Validation loss improved to 1.864367
epoch:  25
[Epoch 26, Batch 10] loss: 0.322
epoch:  26 val_f1:  0.7367608586927249 val_auroc:  0.7749140893470791 val_auprc:  0.8884782788421735
Validation loss improved to 1.862659
epoch:  26
[Epoch 27, Batch 10] loss: 0.323
epoch:  27 val_f1:  0.7371937993371881 val_auroc:  0.7785959744722631 val_auprc:  0.8917868140125942
Validation loss improved to 1.847846
epoch:  27
[Epoch 28, Batch 10] loss: 0.303
epoch:  28 val_f1:  0.703263898025454 val_auroc:  0.7822778595974472 val_auprc:  0.8936278634221784
Validation loss improved to 1.831861
epoch:  28
[Epoch 29, Batch 10] loss: 0.316
epoch:  29 val_f1:  0.743431836172277 val_auroc:  0.7800687285223367 val_auprc:  0.8917260998516832
EarlyStopping counter: 1 out of 50
epoch:  29
[Epoch 30, Batch 10] loss: 0.317
epoch:  30 val_f1:  0.7304528631430115 val_auroc:  0.7837506136475209 val_auprc:  0.8953967293797364
Validation loss improved to 1.826335
epoch:  30
[Epoch 31, Batch 10] loss: 0.299
epoch:  31 val_f1:  0.7304528631430115 val_auroc:  0.7866961217476681 val_auprc:  0.8977091962244064
Validation loss improved to 1.814750
epoch:  31
[Epoch 32, Batch 10] loss: 0.307
epoch:  32 val_f1:  0.7428255465713769 val_auroc:  0.783014236622484 val_auprc:  0.8950060853219126
EarlyStopping counter: 1 out of 50
epoch:  32
[Epoch 33, Batch 10] loss: 0.315
epoch:  33 val_f1:  0.703263898025454 val_auroc:  0.7857142857142857 val_auprc:  0.8967504659345948
Validation loss improved to 1.804225
epoch:  33
[Epoch 34, Batch 10] loss: 0.291
epoch:  34 val_f1:  0.7304528631430115 val_auroc:  0.7876779577810505 val_auprc:  0.8982273003201748
Validation loss improved to 1.802315
epoch:  34
[Epoch 35, Batch 10] loss: 0.302
epoch:  35 val_f1:  0.7304528631430115 val_auroc:  0.787432498772705 val_auprc:  0.8990231551694247
Validation loss improved to 1.796801
epoch:  35
[Epoch 36, Batch 10] loss: 0.299
epoch:  36 val_f1:  0.7367608586927249 val_auroc:  0.7866961217476681 val_auprc:  0.8985456420396252
EarlyStopping counter: 1 out of 50
epoch:  36
[Epoch 37, Batch 10] loss: 0.304
epoch:  37 val_f1:  0.730071543320129 val_auroc:  0.788659793814433 val_auprc:  0.900061828740816
Validation loss improved to 1.796626
epoch:  37
[Epoch 38, Batch 10] loss: 0.293
epoch:  38 val_f1:  0.7304528631430115 val_auroc:  0.7896416298478155 val_auprc:  0.9008127737517295
Validation loss improved to 1.783465
epoch:  38
[Epoch 39, Batch 10] loss: 0.294
epoch:  39 val_f1:  0.7169009504644194 val_auroc:  0.7906234658811977 val_auprc:  0.9019012735305144
Validation loss improved to 1.775732
epoch:  39
[Epoch 40, Batch 10] loss: 0.294
epoch:  40 val_f1:  0.7295632867761842 val_auroc:  0.7903780068728522 val_auprc:  0.9015647967336845
EarlyStopping counter: 1 out of 50
epoch:  40
[Epoch 41, Batch 10] loss: 0.287
epoch:  41 val_f1:  0.7295632867761842 val_auroc:  0.7896416298478155 val_auprc:  0.9010605584085909
EarlyStopping counter: 2 out of 50
epoch:  41
[Epoch 42, Batch 10] loss: 0.287
epoch:  42 val_f1:  0.7362024088594293 val_auroc:  0.7928325969563084 val_auprc:  0.9037466304710083
EarlyStopping counter: 3 out of 50
epoch:  42
[Epoch 43, Batch 10] loss: 0.282
epoch:  43 val_f1:  0.7371937993371881 val_auroc:  0.794305351006382 val_auprc:  0.9046164691565961
Validation loss improved to 1.760848
epoch:  43
[Epoch 44, Batch 10] loss: 0.288
epoch:  44 val_f1:  0.7295632867761842 val_auroc:  0.7962690230731468 val_auprc:  0.905624207965094
EarlyStopping counter: 1 out of 50
epoch:  44
[Epoch 45, Batch 10] loss: 0.276
epoch:  45 val_f1:  0.72389147505525 val_auroc:  0.7974963181148749 val_auprc:  0.9061879854134092
Validation loss improved to 1.750130
epoch:  45
[Epoch 46, Batch 10] loss: 0.262
epoch:  46 val_f1:  0.7229061670449737 val_auroc:  0.7962690230731467 val_auprc:  0.9052414449540314
EarlyStopping counter: 1 out of 50
epoch:  46
[Epoch 47, Batch 10] loss: 0.279
epoch:  47 val_f1:  0.7229061670449737 val_auroc:  0.7974963181148748 val_auprc:  0.9062336314748596
Validation loss improved to 1.749352
epoch:  47
[Epoch 48, Batch 10] loss: 0.299
epoch:  48 val_f1:  0.7552115339652351 val_auroc:  0.7962690230731468 val_auprc:  0.9064495802064092
EarlyStopping counter: 1 out of 50
epoch:  48
[Epoch 49, Batch 10] loss: 0.267
epoch:  49 val_f1:  0.7229061670449737 val_auroc:  0.7984781541482572 val_auprc:  0.9074924576836432
Validation loss improved to 1.738246
epoch:  49
[Epoch 50, Batch 10] loss: 0.275
epoch:  50 val_f1:  0.7420910227448273 val_auroc:  0.7982326951399117 val_auprc:  0.9076998019352964
EarlyStopping counter: 1 out of 50
epoch:  50
[Epoch 51, Batch 10] loss: 0.267
epoch:  51 val_f1:  0.7233618940391454 val_auroc:  0.8031418753068238 val_auprc:  0.9110042066857629
Validation loss improved to 1.719861
epoch:  51
[Epoch 52, Batch 10] loss: 0.268
epoch:  52 val_f1:  0.7295632867761842 val_auroc:  0.8006872852233676 val_auprc:  0.909166294493028
EarlyStopping counter: 1 out of 50
epoch:  52
[Epoch 53, Batch 10] loss: 0.271
epoch:  53 val_f1:  0.7295632867761842 val_auroc:  0.8028964162984782 val_auprc:  0.9101476115683761
EarlyStopping counter: 2 out of 50
epoch:  53
[Epoch 54, Batch 10] loss: 0.257
epoch:  54 val_f1:  0.7362024088594293 val_auroc:  0.8004418262150221 val_auprc:  0.9086877896492385
EarlyStopping counter: 3 out of 50
epoch:  54
[Epoch 55, Batch 10] loss: 0.259
epoch:  55 val_f1:  0.7236892364125374 val_auroc:  0.8016691212567502 val_auprc:  0.9091730771104556
EarlyStopping counter: 4 out of 50
epoch:  55
[Epoch 56, Batch 10] loss: 0.256
epoch:  56 val_f1:  0.7428255465713769 val_auroc:  0.8021600392734413 val_auprc:  0.9108143478087617
EarlyStopping counter: 5 out of 50
epoch:  56
[Epoch 57, Batch 10] loss: 0.272
epoch:  57 val_f1:  0.7420910227448273 val_auroc:  0.8051055473735885 val_auprc:  0.9133737193860788
Validation loss improved to 1.717355
epoch:  57
[Epoch 58, Batch 10] loss: 0.266
epoch:  58 val_f1:  0.7229061670449737 val_auroc:  0.8028964162984782 val_auprc:  0.9106431596096445
Validation loss improved to 1.714946
epoch:  58
[Epoch 59, Batch 10] loss: 0.261
epoch:  59 val_f1:  0.7229061670449737 val_auroc:  0.8055964653902798 val_auprc:  0.9126271242927695
Validation loss improved to 1.709337
epoch:  59
[Epoch 60, Batch 10] loss: 0.235
epoch:  60 val_f1:  0.7233618940391454 val_auroc:  0.804860088365243 val_auprc:  0.9119485008136001
Validation loss improved to 1.707954
epoch:  60
[Epoch 61, Batch 10] loss: 0.258
epoch:  61 val_f1:  0.7494347379239465 val_auroc:  0.8070692194403535 val_auprc:  0.9139376477762244
EarlyStopping counter: 1 out of 50
epoch:  61
[Epoch 62, Batch 10] loss: 0.257
epoch:  62 val_f1:  0.7560320485424044 val_auroc:  0.8068237604320079 val_auprc:  0.9129967258538361
EarlyStopping counter: 2 out of 50
epoch:  62
[Epoch 63, Batch 10] loss: 0.248
epoch:  63 val_f1:  0.7362024088594293 val_auroc:  0.8065783014236623 val_auprc:  0.9124170131815784
EarlyStopping counter: 3 out of 50
epoch:  63
[Epoch 64, Batch 10] loss: 0.247
epoch:  64 val_f1:  0.7236892364125374 val_auroc:  0.8058419243986253 val_auprc:  0.9116905294822608
Validation loss improved to 1.705345
epoch:  64
[Epoch 65, Batch 10] loss: 0.260
epoch:  65 val_f1:  0.7560320485424044 val_auroc:  0.8065783014236623 val_auprc:  0.9129724041062014
EarlyStopping counter: 1 out of 50
epoch:  65
[Epoch 66, Batch 10] loss: 0.236
epoch:  66 val_f1:  0.730071543320129 val_auroc:  0.8092783505154639 val_auprc:  0.9144557510589565
Validation loss improved to 1.703841
epoch:  66
[Epoch 67, Batch 10] loss: 0.247
epoch:  67 val_f1:  0.7295632867761842 val_auroc:  0.8075601374570448 val_auprc:  0.9136795235889539
EarlyStopping counter: 1 out of 50
epoch:  67
[Epoch 68, Batch 10] loss: 0.249
epoch:  68 val_f1:  0.730071543320129 val_auroc:  0.8095238095238095 val_auprc:  0.914681351543398
EarlyStopping counter: 2 out of 50
epoch:  68
[Epoch 69, Batch 10] loss: 0.256
epoch:  69 val_f1:  0.730071543320129 val_auroc:  0.8087874324987728 val_auprc:  0.9140604801835361
EarlyStopping counter: 3 out of 50
epoch:  69
[Epoch 70, Batch 10] loss: 0.245
epoch:  70 val_f1:  0.730071543320129 val_auroc:  0.81173294059892 val_auprc:  0.9168823556801404
Validation loss improved to 1.700909
epoch:  70
[Epoch 71, Batch 10] loss: 0.250
epoch:  71 val_f1:  0.743431836172277 val_auroc:  0.8119783996072656 val_auprc:  0.9169251655948064
EarlyStopping counter: 1 out of 50
epoch:  71
[Epoch 72, Batch 10] loss: 0.256
epoch:  72 val_f1:  0.730071543320129 val_auroc:  0.8134511536573392 val_auprc:  0.9180418827765673
Validation loss improved to 1.691176
epoch:  72
[Epoch 73, Batch 10] loss: 0.240
epoch:  73 val_f1:  0.743431836172277 val_auroc:  0.8117329405989201 val_auprc:  0.9169864308226857
EarlyStopping counter: 1 out of 50
epoch:  73
[Epoch 74, Batch 10] loss: 0.241
epoch:  74 val_f1:  0.730071543320129 val_auroc:  0.8095238095238095 val_auprc:  0.914733042313062
EarlyStopping counter: 2 out of 50
epoch:  74
[Epoch 75, Batch 10] loss: 0.255
epoch:  75 val_f1:  0.730071543320129 val_auroc:  0.810505645557192 val_auprc:  0.9154257100431473
EarlyStopping counter: 3 out of 50
epoch:  75
[Epoch 76, Batch 10] loss: 0.244
epoch:  76 val_f1:  0.730071543320129 val_auroc:  0.8124693176239568 val_auprc:  0.9174050993239737
EarlyStopping counter: 4 out of 50
epoch:  76
[Epoch 77, Batch 10] loss: 0.240
epoch:  77 val_f1:  0.743431836172277 val_auroc:  0.8114874815905744 val_auprc:  0.9163306795603529
EarlyStopping counter: 5 out of 50
epoch:  77
[Epoch 78, Batch 10] loss: 0.243
epoch:  78 val_f1:  0.7412236216203913 val_auroc:  0.8105056455571921 val_auprc:  0.9152447533530425
EarlyStopping counter: 6 out of 50
epoch:  78
[Epoch 79, Batch 10] loss: 0.247
epoch:  79 val_f1:  0.743431836172277 val_auroc:  0.8127147766323024 val_auprc:  0.9175654415570569
EarlyStopping counter: 7 out of 50
epoch:  79
[Epoch 80, Batch 10] loss: 0.225
epoch:  80 val_f1:  0.730071543320129 val_auroc:  0.8127147766323025 val_auprc:  0.9174280120328171
EarlyStopping counter: 8 out of 50
epoch:  80
[Epoch 81, Batch 10] loss: 0.231
epoch:  81 val_f1:  0.7346924658075737 val_auroc:  0.8132056946489937 val_auprc:  0.9182099447500391
EarlyStopping counter: 9 out of 50
epoch:  81
[Epoch 82, Batch 10] loss: 0.251
epoch:  82 val_f1:  0.730071543320129 val_auroc:  0.8122238586156112 val_auprc:  0.9170353997108942
EarlyStopping counter: 10 out of 50
epoch:  82
[Epoch 83, Batch 10] loss: 0.231
epoch:  83 val_f1:  0.7098736982331642 val_auroc:  0.812960235640648 val_auprc:  0.9177723427799219
EarlyStopping counter: 11 out of 50
epoch:  83
[Epoch 84, Batch 10] loss: 0.237
epoch:  84 val_f1:  0.7560320485424044 val_auroc:  0.8109965635738832 val_auprc:  0.9159804393069433
EarlyStopping counter: 12 out of 50
epoch:  84
[Epoch 85, Batch 10] loss: 0.214
epoch:  85 val_f1:  0.730071543320129 val_auroc:  0.8134511536573392 val_auprc:  0.9180637430116174
EarlyStopping counter: 13 out of 50
epoch:  85
[Epoch 86, Batch 10] loss: 0.231
epoch:  86 val_f1:  0.7494347379239465 val_auroc:  0.8134511536573392 val_auprc:  0.918178137086693
EarlyStopping counter: 14 out of 50
epoch:  86
[Epoch 87, Batch 10] loss: 0.226
epoch:  87 val_f1:  0.7362024088594293 val_auroc:  0.8134511536573392 val_auprc:  0.9180165376845679
EarlyStopping counter: 15 out of 50
epoch:  87
[Epoch 88, Batch 10] loss: 0.221
epoch:  88 val_f1:  0.7362024088594293 val_auroc:  0.8129602356406479 val_auprc:  0.9176192905877888
EarlyStopping counter: 16 out of 50
epoch:  88
[Epoch 89, Batch 10] loss: 0.228
epoch:  89 val_f1:  0.7362024088594293 val_auroc:  0.8136966126656848 val_auprc:  0.9183838880003465
EarlyStopping counter: 17 out of 50
epoch:  89
[Epoch 90, Batch 10] loss: 0.223
epoch:  90 val_f1:  0.7367608586927249 val_auroc:  0.8159057437407954 val_auprc:  0.9199052726500107
Validation loss improved to 1.685979
epoch:  90
[Epoch 91, Batch 10] loss: 0.242
epoch:  91 val_f1:  0.748656020238754 val_auroc:  0.8151693667157585 val_auprc:  0.9192898058086065
EarlyStopping counter: 1 out of 50
epoch:  91
[Epoch 92, Batch 10] loss: 0.215
epoch:  92 val_f1:  0.7362024088594293 val_auroc:  0.8149239077074129 val_auprc:  0.9187424194776406
EarlyStopping counter: 2 out of 50
epoch:  92
[Epoch 93, Batch 10] loss: 0.222
epoch:  93 val_f1:  0.7362024088594293 val_auroc:  0.8168875797741778 val_auprc:  0.9201159206701055
EarlyStopping counter: 3 out of 50
epoch:  93
[Epoch 94, Batch 10] loss: 0.234
epoch:  94 val_f1:  0.7362024088594293 val_auroc:  0.8132056946489936 val_auprc:  0.9174131735533431
EarlyStopping counter: 4 out of 50
epoch:  94
[Epoch 95, Batch 10] loss: 0.218
epoch:  95 val_f1:  0.7362024088594293 val_auroc:  0.8107511045655375 val_auprc:  0.9161592446912801
EarlyStopping counter: 5 out of 50
epoch:  95
[Epoch 96, Batch 10] loss: 0.227
epoch:  96 val_f1:  0.730071543320129 val_auroc:  0.814923907707413 val_auprc:  0.9191583712461306
EarlyStopping counter: 6 out of 50
epoch:  96
[Epoch 97, Batch 10] loss: 0.225
epoch:  97 val_f1:  0.7289242247644242 val_auroc:  0.8134511536573392 val_auprc:  0.9183670940032146
EarlyStopping counter: 7 out of 50
epoch:  97
[Epoch 98, Batch 10] loss: 0.218
epoch:  98 val_f1:  0.7362024088594293 val_auroc:  0.8132056946489937 val_auprc:  0.9181442921745919
EarlyStopping counter: 8 out of 50
epoch:  98
[Epoch 99, Batch 10] loss: 0.225
epoch:  99 val_f1:  0.7289242247644242 val_auroc:  0.812960235640648 val_auprc:  0.9181789053892093
EarlyStopping counter: 9 out of 50
epoch:  99
[Epoch 100, Batch 10] loss: 0.226
epoch:  100 val_f1:  0.7367608586927249 val_auroc:  0.8156602847324497 val_auprc:  0.9192461146673535
EarlyStopping counter: 10 out of 50
epoch:  100
[Epoch 101, Batch 10] loss: 0.218
epoch:  101 val_f1:  0.7289242247644242 val_auroc:  0.8134511536573391 val_auprc:  0.9180608565634567
EarlyStopping counter: 11 out of 50
epoch:  101
[Epoch 102, Batch 10] loss: 0.217
epoch:  102 val_f1:  0.7289242247644242 val_auroc:  0.8112420225822288 val_auprc:  0.9167851869509032
EarlyStopping counter: 12 out of 50
epoch:  102
[Epoch 103, Batch 10] loss: 0.206
epoch:  103 val_f1:  0.7289242247644242 val_auroc:  0.8134511536573392 val_auprc:  0.918272591744357
EarlyStopping counter: 13 out of 50
epoch:  103
[Epoch 104, Batch 10] loss: 0.210
epoch:  104 val_f1:  0.7420910227448273 val_auroc:  0.812960235640648 val_auprc:  0.9178015257413608
EarlyStopping counter: 14 out of 50
epoch:  104
[Epoch 105, Batch 10] loss: 0.210
epoch:  105 val_f1:  0.7362024088594293 val_auroc:  0.8127147766323024 val_auprc:  0.9176004580379142
EarlyStopping counter: 15 out of 50
epoch:  105
[Epoch 106, Batch 10] loss: 0.216
epoch:  106 val_f1:  0.7362024088594293 val_auroc:  0.8163966617574866 val_auprc:  0.9206915425241061
EarlyStopping counter: 16 out of 50
epoch:  106
[Epoch 107, Batch 10] loss: 0.222
epoch:  107 val_f1:  0.7289242247644242 val_auroc:  0.8146784486990672 val_auprc:  0.9191113099859197
EarlyStopping counter: 17 out of 50
epoch:  107
[Epoch 108, Batch 10] loss: 0.210
epoch:  108 val_f1:  0.7362024088594293 val_auroc:  0.8161512027491409 val_auprc:  0.9194481621901486
EarlyStopping counter: 18 out of 50
epoch:  108
[Epoch 109, Batch 10] loss: 0.223
epoch:  109 val_f1:  0.735514445586388 val_auroc:  0.8161512027491409 val_auprc:  0.9202987678694186
EarlyStopping counter: 19 out of 50
epoch:  109
[Epoch 110, Batch 10] loss: 0.199
epoch:  110 val_f1:  0.7289242247644242 val_auroc:  0.816151202749141 val_auprc:  0.9202271417729984
EarlyStopping counter: 20 out of 50
epoch:  110
[Epoch 111, Batch 10] loss: 0.216
epoch:  111 val_f1:  0.7295632867761842 val_auroc:  0.8168875797741778 val_auprc:  0.9202711181480087
EarlyStopping counter: 21 out of 50
epoch:  111
[Epoch 112, Batch 10] loss: 0.204
epoch:  112 val_f1:  0.7420910227448273 val_auroc:  0.8171330387825233 val_auprc:  0.9209580034542098
EarlyStopping counter: 22 out of 50
epoch:  112
[Epoch 113, Batch 10] loss: 0.212
epoch:  113 val_f1:  0.7420910227448273 val_auroc:  0.8171330387825233 val_auprc:  0.9204343822510389
EarlyStopping counter: 23 out of 50
epoch:  113
[Epoch 114, Batch 10] loss: 0.212
epoch:  114 val_f1:  0.735514445586388 val_auroc:  0.8171330387825233 val_auprc:  0.9204343822510389
EarlyStopping counter: 24 out of 50
epoch:  114
[Epoch 115, Batch 10] loss: 0.198
epoch:  115 val_f1:  0.748656020238754 val_auroc:  0.8173784977908689 val_auprc:  0.9202816054815002
EarlyStopping counter: 25 out of 50
epoch:  115
[Epoch 116, Batch 10] loss: 0.205
epoch:  116 val_f1:  0.7542604103291037 val_auroc:  0.8163966617574865 val_auprc:  0.9197600549148628
EarlyStopping counter: 26 out of 50
epoch:  116
[Epoch 117, Batch 10] loss: 0.218
epoch:  117 val_f1:  0.735514445586388 val_auroc:  0.8161512027491409 val_auprc:  0.9197663480056517
EarlyStopping counter: 27 out of 50
epoch:  117
[Epoch 118, Batch 10] loss: 0.190
epoch:  118 val_f1:  0.7420910227448273 val_auroc:  0.8168875797741777 val_auprc:  0.9200007888599925
EarlyStopping counter: 28 out of 50
epoch:  118
[Epoch 119, Batch 10] loss: 0.199
epoch:  119 val_f1:  0.735514445586388 val_auroc:  0.8171330387825233 val_auprc:  0.9210831910603243
EarlyStopping counter: 29 out of 50
epoch:  119
[Epoch 120, Batch 10] loss: 0.207
epoch:  120 val_f1:  0.7477455593342162 val_auroc:  0.8163966617574865 val_auprc:  0.9207617874016492
EarlyStopping counter: 30 out of 50
epoch:  120
[Epoch 121, Batch 10] loss: 0.197
epoch:  121 val_f1:  0.7542604103291037 val_auroc:  0.8159057437407953 val_auprc:  0.9206354418564476
EarlyStopping counter: 31 out of 50
epoch:  121
[Epoch 122, Batch 10] loss: 0.209
epoch:  122 val_f1:  0.735514445586388 val_auroc:  0.8168875797741777 val_auprc:  0.9200645373212466
EarlyStopping counter: 32 out of 50
epoch:  122
[Epoch 123, Batch 10] loss: 0.194
epoch:  123 val_f1:  0.7477455593342162 val_auroc:  0.8163966617574865 val_auprc:  0.9197267777698157
EarlyStopping counter: 33 out of 50
epoch:  123
[Epoch 124, Batch 10] loss: 0.211
epoch:  124 val_f1:  0.7412236216203913 val_auroc:  0.8151693667157586 val_auprc:  0.919231163100542
EarlyStopping counter: 34 out of 50
epoch:  124
[Epoch 125, Batch 10] loss: 0.213
epoch:  125 val_f1:  0.7542604103291037 val_auroc:  0.8139420716740304 val_auprc:  0.9185208482400264
EarlyStopping counter: 35 out of 50
epoch:  125
[Epoch 126, Batch 10] loss: 0.193
epoch:  126 val_f1:  0.7295632867761842 val_auroc:  0.814187530682376 val_auprc:  0.918289301008724
EarlyStopping counter: 36 out of 50
epoch:  126
[Epoch 127, Batch 10] loss: 0.185
epoch:  127 val_f1:  0.7412236216203913 val_auroc:  0.8136966126656848 val_auprc:  0.9182938633533033
EarlyStopping counter: 37 out of 50
epoch:  127
[Epoch 128, Batch 10] loss: 0.193
epoch:  128 val_f1:  0.7289242247644242 val_auroc:  0.8166421207658321 val_auprc:  0.9207691227383065
EarlyStopping counter: 38 out of 50
epoch:  128
[Epoch 129, Batch 10] loss: 0.192
epoch:  129 val_f1:  0.7346924658075737 val_auroc:  0.8159057437407953 val_auprc:  0.9200285148074588
EarlyStopping counter: 39 out of 50
epoch:  129
[Epoch 130, Batch 10] loss: 0.197
epoch:  130 val_f1:  0.7281499969472504 val_auroc:  0.8144329896907216 val_auprc:  0.9190628497384352
EarlyStopping counter: 40 out of 50
epoch:  130
[Epoch 131, Batch 10] loss: 0.187
epoch:  131 val_f1:  0.735514445586388 val_auroc:  0.8159057437407953 val_auprc:  0.9198605160504749
EarlyStopping counter: 41 out of 50
epoch:  131
[Epoch 132, Batch 10] loss: 0.197
epoch:  132 val_f1:  0.7281499969472504 val_auroc:  0.814923907707413 val_auprc:  0.9189300310471116
EarlyStopping counter: 42 out of 50
epoch:  132
[Epoch 133, Batch 10] loss: 0.190
epoch:  133 val_f1:  0.7281499969472504 val_auroc:  0.8163966617574866 val_auprc:  0.9194942026436468
EarlyStopping counter: 43 out of 50
epoch:  133
[Epoch 134, Batch 10] loss: 0.193
epoch:  134 val_f1:  0.7607703458551531 val_auroc:  0.8132056946489935 val_auprc:  0.9178355059616867
EarlyStopping counter: 44 out of 50
epoch:  134
[Epoch 135, Batch 10] loss: 0.188
epoch:  135 val_f1:  0.735514445586388 val_auroc:  0.8134511536573393 val_auprc:  0.91754573590714
EarlyStopping counter: 45 out of 50
epoch:  135
[Epoch 136, Batch 10] loss: 0.180
epoch:  136 val_f1:  0.7281499969472504 val_auroc:  0.8132056946489937 val_auprc:  0.9176139532082173
EarlyStopping counter: 46 out of 50
epoch:  136
[Epoch 137, Batch 10] loss: 0.183
epoch:  137 val_f1:  0.7346924658075737 val_auroc:  0.8119783996072656 val_auprc:  0.9168821885708897
EarlyStopping counter: 47 out of 50
epoch:  137
[Epoch 138, Batch 10] loss: 0.186
epoch:  138 val_f1:  0.7412236216203913 val_auroc:  0.8139420716740304 val_auprc:  0.918461454801918
EarlyStopping counter: 48 out of 50
epoch:  138
[Epoch 139, Batch 10] loss: 0.184
epoch:  139 val_f1:  0.7412236216203913 val_auroc:  0.8132056946489936 val_auprc:  0.917970876354059
EarlyStopping counter: 49 out of 50
epoch:  139
[Epoch 140, Batch 10] loss: 0.187
epoch:  140 val_f1:  0.7281499969472504 val_auroc:  0.8127147766323023 val_auprc:  0.9174777194149795
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  865.2323431968689
{'time_elapsed': [865.2323431968689], 'epoch': [139], 'fold': [0], 'f1_train': [0.8929527963619407], 'auroc_train': [0.9660146549345433], 'auprc_train': [0.9841856387545319], 'f1_test': [0.7281499969472504], 'auroc_test': [0.8127147766323023], 'auprc_test': [0.9174777194149795]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [32, 1]                   --
├─Sequential: 1-1                        [32, 1]                   --
│    └─Conv1d: 2-1                       [32, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [32, 1024, 427]           2,048
│    └─Tanh: 2-3                         [32, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [32, 1024, 142]           --
│    └─Dropout: 2-5                      [32, 1024, 142]           --
│    └─Flatten: 2-6                      [32, 145408]              --
│    └─Linear: 2-7                       [32, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.16
Forward/backward pass size (MB): 223.87
Params size (MB): 0.61
Estimated Total Size (MB): 224.64
==========================================================================================
tensor(0.4369)
epoch:  0
[Epoch 1, Batch 10] loss: 0.442
epoch:  1 val_f1:  0.18446204833885702 val_auroc:  0.7326951399116348 val_auprc:  0.8692883759534815
epoch:  1
[Epoch 2, Batch 10] loss: 0.411
epoch:  2 val_f1:  0.612901249881321 val_auroc:  0.7191948944526265 val_auprc:  0.8551365155395237
Validation loss improved to 1.964026
epoch:  2
[Epoch 3, Batch 10] loss: 0.391
epoch:  3 val_f1:  0.6980913612614702 val_auroc:  0.7147766323024055 val_auprc:  0.8518699554372667
Validation loss improved to 1.944600
epoch:  3
[Epoch 4, Batch 10] loss: 0.404
epoch:  4 val_f1:  0.6072781774580336 val_auroc:  0.7206676485027 val_auprc:  0.8637740681288948
Validation loss improved to 1.943874
epoch:  4
[Epoch 5, Batch 10] loss: 0.390
epoch:  5 val_f1:  0.6813420921017198 val_auroc:  0.7265586647029946 val_auprc:  0.8666313735417425
Validation loss improved to 1.918758
epoch:  5
[Epoch 6, Batch 10] loss: 0.393
epoch:  6 val_f1:  0.6472345296242701 val_auroc:  0.7290132547864507 val_auprc:  0.8725422756373981
Validation loss improved to 1.911019
epoch:  6
[Epoch 7, Batch 10] loss: 0.392
epoch:  7 val_f1:  0.6945501576267077 val_auroc:  0.7334315169366715 val_auprc:  0.8755622210471588
Validation loss improved to 1.890747
epoch:  7
[Epoch 8, Batch 10] loss: 0.385
epoch:  8 val_f1:  0.6824751963135375 val_auroc:  0.7380952380952381 val_auprc:  0.8821796601571487
Validation loss improved to 1.878942
epoch:  8
[Epoch 9, Batch 10] loss: 0.381
epoch:  9 val_f1:  0.6756605397022405 val_auroc:  0.7484045164457536 val_auprc:  0.8890626349011976
Validation loss improved to 1.865564
epoch:  9
[Epoch 10, Batch 10] loss: 0.381
epoch:  10 val_f1:  0.7156947373800909 val_auroc:  0.7601865488463427 val_auprc:  0.8964944496001321
Validation loss improved to 1.847532
epoch:  10
[Epoch 11, Batch 10] loss: 0.373
epoch:  11 val_f1:  0.7169009504644194 val_auroc:  0.756259204712813 val_auprc:  0.8955017006876034
Validation loss improved to 1.836657
epoch:  11
[Epoch 12, Batch 10] loss: 0.363
epoch:  12 val_f1:  0.7170452552783244 val_auroc:  0.7616593028964163 val_auprc:  0.8984542530915824
Validation loss improved to 1.824852
epoch:  12
[Epoch 13, Batch 10] loss: 0.362
epoch:  13 val_f1:  0.7375047745919104 val_auroc:  0.768041237113402 val_auprc:  0.9025900589378661
Validation loss improved to 1.812658
epoch:  13
[Epoch 14, Batch 10] loss: 0.361
epoch:  14 val_f1:  0.7375047745919104 val_auroc:  0.7736867943053509 val_auprc:  0.9057950916432194
Validation loss improved to 1.801305
epoch:  14
[Epoch 15, Batch 10] loss: 0.354
epoch:  15 val_f1:  0.7170452552783244 val_auroc:  0.7722140402552774 val_auprc:  0.9063026612951617
Validation loss improved to 1.795672
epoch:  15
[Epoch 16, Batch 10] loss: 0.355
epoch:  16 val_f1:  0.7362024088594293 val_auroc:  0.7844869906725578 val_auprc:  0.9115933554844246
Validation loss improved to 1.774300
epoch:  16
[Epoch 17, Batch 10] loss: 0.353
epoch:  17 val_f1:  0.7442757932382417 val_auroc:  0.7812960235640648 val_auprc:  0.9099006535317018
Validation loss improved to 1.764095
epoch:  17
[Epoch 18, Batch 10] loss: 0.355
epoch:  18 val_f1:  0.7442757932382417 val_auroc:  0.7896416298478155 val_auprc:  0.9145123373553314
Validation loss improved to 1.755236
epoch:  18
[Epoch 19, Batch 10] loss: 0.343
epoch:  19 val_f1:  0.7442757932382417 val_auroc:  0.7889052528227785 val_auprc:  0.9142497958982415
Validation loss improved to 1.743960
epoch:  19
[Epoch 20, Batch 10] loss: 0.329
epoch:  20 val_f1:  0.7442757932382417 val_auroc:  0.7947962690230732 val_auprc:  0.9168712957556996
Validation loss improved to 1.734185
epoch:  20
[Epoch 21, Batch 10] loss: 0.350
epoch:  21 val_f1:  0.7500864926036699 val_auroc:  0.7940598919980364 val_auprc:  0.9164532486182023
Validation loss improved to 1.722248
epoch:  21
[Epoch 22, Batch 10] loss: 0.339
epoch:  22 val_f1:  0.7500864926036699 val_auroc:  0.7938144329896908 val_auprc:  0.9163190412797277
Validation loss improved to 1.714495
epoch:  22
[Epoch 23, Batch 10] loss: 0.318
epoch:  23 val_f1:  0.7513203127712835 val_auroc:  0.7957781050564556 val_auprc:  0.9176698890611691
Validation loss improved to 1.709469
epoch:  23
[Epoch 24, Batch 10] loss: 0.323
epoch:  24 val_f1:  0.7513203127712835 val_auroc:  0.7962690230731467 val_auprc:  0.9178090976807526
Validation loss improved to 1.701993
epoch:  24
[Epoch 25, Batch 10] loss: 0.331
epoch:  25 val_f1:  0.7567268683783295 val_auroc:  0.7957781050564556 val_auprc:  0.9170013833100519
Validation loss improved to 1.693321
epoch:  25
[Epoch 26, Batch 10] loss: 0.328
epoch:  26 val_f1:  0.758098723333472 val_auroc:  0.7970054000981835 val_auprc:  0.9182133609966713
Validation loss improved to 1.688357
epoch:  26
[Epoch 27, Batch 10] loss: 0.308
epoch:  27 val_f1:  0.778324933635979 val_auroc:  0.7997054491899853 val_auprc:  0.9190224193445915
Validation loss improved to 1.678107
epoch:  27
[Epoch 28, Batch 10] loss: 0.309
epoch:  28 val_f1:  0.778324933635979 val_auroc:  0.7987236131566029 val_auprc:  0.9185735579654366
Validation loss improved to 1.671485
epoch:  28
[Epoch 29, Batch 10] loss: 0.319
epoch:  29 val_f1:  0.7494347379239465 val_auroc:  0.7974963181148748 val_auprc:  0.9171007011538088
Validation loss improved to 1.667056
epoch:  29
[Epoch 30, Batch 10] loss: 0.314
epoch:  30 val_f1:  0.7494347379239465 val_auroc:  0.7997054491899853 val_auprc:  0.9186671871622691
Validation loss improved to 1.660568
epoch:  30
[Epoch 31, Batch 10] loss: 0.301
epoch:  31 val_f1:  0.7711689349644636 val_auroc:  0.8038782523318606 val_auprc:  0.9201084254478162
Validation loss improved to 1.652609
epoch:  31
[Epoch 32, Batch 10] loss: 0.297
epoch:  32 val_f1:  0.7639705763479104 val_auroc:  0.8053510063819342 val_auprc:  0.9206285567804928
Validation loss improved to 1.649606
epoch:  32
[Epoch 33, Batch 10] loss: 0.310
epoch:  33 val_f1:  0.7639705763479104 val_auroc:  0.8046146293568974 val_auprc:  0.9202580295082682
Validation loss improved to 1.643773
epoch:  33
[Epoch 34, Batch 10] loss: 0.294
epoch:  34 val_f1:  0.7639705763479104 val_auroc:  0.8065783014236623 val_auprc:  0.9212801151274058
Validation loss improved to 1.637177
epoch:  34
[Epoch 35, Batch 10] loss: 0.285
epoch:  35 val_f1:  0.7573003855683703 val_auroc:  0.8060873834069711 val_auprc:  0.920844057723615
Validation loss improved to 1.632922
epoch:  35
[Epoch 36, Batch 10] loss: 0.286
epoch:  36 val_f1:  0.7639705763479104 val_auroc:  0.8060873834069711 val_auprc:  0.9204708173936789
Validation loss improved to 1.628363
epoch:  36
[Epoch 37, Batch 10] loss: 0.306
epoch:  37 val_f1:  0.7573003855683703 val_auroc:  0.8068237604320079 val_auprc:  0.9211734622970759
Validation loss improved to 1.626151
epoch:  37
[Epoch 38, Batch 10] loss: 0.301
epoch:  38 val_f1:  0.7552115339652351 val_auroc:  0.8055964653902798 val_auprc:  0.9206596461467015
EarlyStopping counter: 1 out of 50
epoch:  38
[Epoch 39, Batch 10] loss: 0.294
epoch:  39 val_f1:  0.770628190185282 val_auroc:  0.8060873834069711 val_auprc:  0.9211173569643332
Validation loss improved to 1.620965
epoch:  39
[Epoch 40, Batch 10] loss: 0.291
epoch:  40 val_f1:  0.770628190185282 val_auroc:  0.8075601374570447 val_auprc:  0.9218978305564243
Validation loss improved to 1.614052
epoch:  40
[Epoch 41, Batch 10] loss: 0.296
epoch:  41 val_f1:  0.7633550302615051 val_auroc:  0.8087874324987727 val_auprc:  0.9219752144029576
Validation loss improved to 1.613145
epoch:  41
[Epoch 42, Batch 10] loss: 0.274
epoch:  42 val_f1:  0.7633550302615051 val_auroc:  0.8080510554737358 val_auprc:  0.9218988892237381
Validation loss improved to 1.610221
epoch:  42
[Epoch 43, Batch 10] loss: 0.280
epoch:  43 val_f1:  0.7506155503404762 val_auroc:  0.8095238095238095 val_auprc:  0.9221189166947452
Validation loss improved to 1.607218
epoch:  43
[Epoch 44, Batch 10] loss: 0.272
epoch:  44 val_f1:  0.7699730743399811 val_auroc:  0.8097692685321551 val_auprc:  0.922221834023073
Validation loss improved to 1.606108
epoch:  44
[Epoch 45, Batch 10] loss: 0.284
epoch:  45 val_f1:  0.7500864926036699 val_auroc:  0.8095238095238095 val_auprc:  0.9218849675368914
Validation loss improved to 1.601742
epoch:  45
[Epoch 46, Batch 10] loss: 0.287
epoch:  46 val_f1:  0.7699730743399811 val_auroc:  0.8092783505154639 val_auprc:  0.9213244468015431
EarlyStopping counter: 1 out of 50
epoch:  46
[Epoch 47, Batch 10] loss: 0.268
epoch:  47 val_f1:  0.7500864926036699 val_auroc:  0.8119783996072656 val_auprc:  0.923000014425724
Validation loss improved to 1.598337
epoch:  47
[Epoch 48, Batch 10] loss: 0.259
epoch:  48 val_f1:  0.7500864926036699 val_auroc:  0.8107511045655376 val_auprc:  0.921903126488175
Validation loss improved to 1.596842
epoch:  48
[Epoch 49, Batch 10] loss: 0.269
epoch:  49 val_f1:  0.7567268683783295 val_auroc:  0.8102601865488464 val_auprc:  0.9215139202771312
EarlyStopping counter: 1 out of 50
epoch:  49
[Epoch 50, Batch 10] loss: 0.268
epoch:  50 val_f1:  0.7765831291011147 val_auroc:  0.8078055964653904 val_auprc:  0.9202670826236121
EarlyStopping counter: 2 out of 50
epoch:  50
[Epoch 51, Batch 10] loss: 0.284
epoch:  51 val_f1:  0.7500864926036699 val_auroc:  0.8107511045655376 val_auprc:  0.9215483088705205
Validation loss improved to 1.594228
epoch:  51
[Epoch 52, Batch 10] loss: 0.282
epoch:  52 val_f1:  0.7500864926036699 val_auroc:  0.8102601865488464 val_auprc:  0.9213017740693343
Validation loss improved to 1.593053
epoch:  52
[Epoch 53, Batch 10] loss: 0.268
epoch:  53 val_f1:  0.7691994463100789 val_auroc:  0.8097692685321553 val_auprc:  0.9209279456004069
EarlyStopping counter: 1 out of 50
epoch:  53
[Epoch 54, Batch 10] loss: 0.257
epoch:  54 val_f1:  0.7567268683783295 val_auroc:  0.8100147275405007 val_auprc:  0.9211507738350815
Validation loss improved to 1.591275
epoch:  54
[Epoch 55, Batch 10] loss: 0.250
epoch:  55 val_f1:  0.743431836172277 val_auroc:  0.8100147275405007 val_auprc:  0.9211319028496529
Validation loss improved to 1.590788
epoch:  55
[Epoch 56, Batch 10] loss: 0.267
epoch:  56 val_f1:  0.7691994463100789 val_auroc:  0.8114874815905745 val_auprc:  0.9215753842597811
Validation loss improved to 1.588855
epoch:  56
[Epoch 57, Batch 10] loss: 0.259
epoch:  57 val_f1:  0.7617596949267598 val_auroc:  0.8136966126656848 val_auprc:  0.9225366138345874
Validation loss improved to 1.585062
epoch:  57
[Epoch 58, Batch 10] loss: 0.260
epoch:  58 val_f1:  0.7626195746699344 val_auroc:  0.8112420225822289 val_auprc:  0.9215181510971526
EarlyStopping counter: 1 out of 50
epoch:  58
[Epoch 59, Batch 10] loss: 0.267
epoch:  59 val_f1:  0.7683026725960121 val_auroc:  0.8107511045655377 val_auprc:  0.9213024715586206
EarlyStopping counter: 2 out of 50
epoch:  59
[Epoch 60, Batch 10] loss: 0.248
epoch:  60 val_f1:  0.7626195746699344 val_auroc:  0.8102601865488462 val_auprc:  0.921387719154596
Validation loss improved to 1.584884
epoch:  60
[Epoch 61, Batch 10] loss: 0.242
epoch:  61 val_f1:  0.7573003855683703 val_auroc:  0.8119783996072656 val_auprc:  0.9216328491707935
Validation loss improved to 1.582524
epoch:  61
[Epoch 62, Batch 10] loss: 0.259
epoch:  62 val_f1:  0.7617596949267598 val_auroc:  0.8119783996072656 val_auprc:  0.9220606342826074
EarlyStopping counter: 1 out of 50
epoch:  62
[Epoch 63, Batch 10] loss: 0.270
epoch:  63 val_f1:  0.7567268683783295 val_auroc:  0.8097692685321551 val_auprc:  0.9207385139568237
Validation loss improved to 1.582416
epoch:  63
[Epoch 64, Batch 10] loss: 0.250
epoch:  64 val_f1:  0.7683026725960121 val_auroc:  0.8090328915071183 val_auprc:  0.9206765183694987
EarlyStopping counter: 1 out of 50
epoch:  64
[Epoch 65, Batch 10] loss: 0.247
epoch:  65 val_f1:  0.7691994463100789 val_auroc:  0.8097692685321551 val_auprc:  0.9206886828077993
Validation loss improved to 1.582304
epoch:  65
[Epoch 66, Batch 10] loss: 0.252
epoch:  66 val_f1:  0.7560320485424044 val_auroc:  0.809278350515464 val_auprc:  0.9205895377045485
EarlyStopping counter: 1 out of 50
epoch:  66
[Epoch 67, Batch 10] loss: 0.254
epoch:  67 val_f1:  0.7691994463100789 val_auroc:  0.8100147275405007 val_auprc:  0.9207961327062449
Validation loss improved to 1.581857
epoch:  67
[Epoch 68, Batch 10] loss: 0.243
epoch:  68 val_f1:  0.7691994463100789 val_auroc:  0.8097692685321551 val_auprc:  0.9206285023674097
Validation loss improved to 1.581039
epoch:  68
[Epoch 69, Batch 10] loss: 0.236
epoch:  69 val_f1:  0.7560320485424044 val_auroc:  0.8097692685321551 val_auprc:  0.920731853747794
EarlyStopping counter: 1 out of 50
epoch:  69
[Epoch 70, Batch 10] loss: 0.252
epoch:  70 val_f1:  0.7691994463100789 val_auroc:  0.8095238095238095 val_auprc:  0.9207106487159971
EarlyStopping counter: 2 out of 50
epoch:  70
[Epoch 71, Batch 10] loss: 0.238
epoch:  71 val_f1:  0.7500864926036699 val_auroc:  0.8114874815905744 val_auprc:  0.9216226129215539
EarlyStopping counter: 3 out of 50
epoch:  71
[Epoch 72, Batch 10] loss: 0.243
epoch:  72 val_f1:  0.7617596949267598 val_auroc:  0.8102601865488464 val_auprc:  0.9207581768531674
EarlyStopping counter: 4 out of 50
epoch:  72
[Epoch 73, Batch 10] loss: 0.234
epoch:  73 val_f1:  0.7500864926036699 val_auroc:  0.8114874815905744 val_auprc:  0.9216409923733385
EarlyStopping counter: 5 out of 50
epoch:  73
[Epoch 74, Batch 10] loss: 0.243
epoch:  74 val_f1:  0.7626195746699344 val_auroc:  0.8109965635738832 val_auprc:  0.921174312599248
EarlyStopping counter: 6 out of 50
epoch:  74
[Epoch 75, Batch 10] loss: 0.257
epoch:  75 val_f1:  0.7567268683783295 val_auroc:  0.8109965635738832 val_auprc:  0.9215603799402379
Validation loss improved to 1.578208
epoch:  75
[Epoch 76, Batch 10] loss: 0.239
epoch:  76 val_f1:  0.7699730743399811 val_auroc:  0.8105056455571921 val_auprc:  0.921065031222275
EarlyStopping counter: 1 out of 50
epoch:  76
[Epoch 77, Batch 10] loss: 0.238
epoch:  77 val_f1:  0.7691994463100789 val_auroc:  0.812960235640648 val_auprc:  0.9221144715797069
EarlyStopping counter: 2 out of 50
epoch:  77
[Epoch 78, Batch 10] loss: 0.231
epoch:  78 val_f1:  0.7626195746699344 val_auroc:  0.8097692685321553 val_auprc:  0.9202676755284256
EarlyStopping counter: 3 out of 50
epoch:  78
[Epoch 79, Batch 10] loss: 0.219
epoch:  79 val_f1:  0.7633550302615051 val_auroc:  0.8095238095238095 val_auprc:  0.9200597290208622
EarlyStopping counter: 4 out of 50
epoch:  79
[Epoch 80, Batch 10] loss: 0.237
epoch:  80 val_f1:  0.7377691212466089 val_auroc:  0.8095238095238095 val_auprc:  0.9199014833991863
EarlyStopping counter: 5 out of 50
epoch:  80
[Epoch 81, Batch 10] loss: 0.228
epoch:  81 val_f1:  0.7633550302615051 val_auroc:  0.8102601865488464 val_auprc:  0.9207968425666821
Validation loss improved to 1.577484
epoch:  81
[Epoch 82, Batch 10] loss: 0.242
epoch:  82 val_f1:  0.7626195746699344 val_auroc:  0.809769268532155 val_auprc:  0.9204279972983359
EarlyStopping counter: 1 out of 50
epoch:  82
[Epoch 83, Batch 10] loss: 0.221
epoch:  83 val_f1:  0.7567268683783295 val_auroc:  0.8117329405989199 val_auprc:  0.9215878065942781
Validation loss improved to 1.576228
epoch:  83
[Epoch 84, Batch 10] loss: 0.239
epoch:  84 val_f1:  0.7552115339652351 val_auroc:  0.8117329405989201 val_auprc:  0.9213119370262498
EarlyStopping counter: 1 out of 50
epoch:  84
[Epoch 85, Batch 10] loss: 0.230
epoch:  85 val_f1:  0.7626195746699344 val_auroc:  0.8109965635738832 val_auprc:  0.9210818861134159
EarlyStopping counter: 2 out of 50
epoch:  85
[Epoch 86, Batch 10] loss: 0.229
epoch:  86 val_f1:  0.7633550302615051 val_auroc:  0.8102601865488464 val_auprc:  0.9207142096842501
Validation loss improved to 1.574415
epoch:  86
[Epoch 87, Batch 10] loss: 0.228
epoch:  87 val_f1:  0.7691994463100789 val_auroc:  0.8092783505154639 val_auprc:  0.9198127288153709
EarlyStopping counter: 1 out of 50
epoch:  87
[Epoch 88, Batch 10] loss: 0.221
epoch:  88 val_f1:  0.7633550302615051 val_auroc:  0.8114874815905745 val_auprc:  0.921019901307318
Validation loss improved to 1.574187
epoch:  88
[Epoch 89, Batch 10] loss: 0.224
epoch:  89 val_f1:  0.7699730743399811 val_auroc:  0.8124693176239568 val_auprc:  0.9216838251968664
Validation loss improved to 1.573594
epoch:  89
[Epoch 90, Batch 10] loss: 0.234
epoch:  90 val_f1:  0.7542604103291037 val_auroc:  0.8114874815905744 val_auprc:  0.9207421689246984
EarlyStopping counter: 1 out of 50
epoch:  90
[Epoch 91, Batch 10] loss: 0.236
epoch:  91 val_f1:  0.7691994463100789 val_auroc:  0.810505645557192 val_auprc:  0.9200199069458821
EarlyStopping counter: 2 out of 50
epoch:  91
[Epoch 92, Batch 10] loss: 0.231
epoch:  92 val_f1:  0.7699730743399811 val_auroc:  0.8100147275405007 val_auprc:  0.9197034406336075
EarlyStopping counter: 3 out of 50
epoch:  92
[Epoch 93, Batch 10] loss: 0.214
epoch:  93 val_f1:  0.7633550302615051 val_auroc:  0.8124693176239568 val_auprc:  0.9213845612745667
Validation loss improved to 1.572709
epoch:  93
[Epoch 94, Batch 10] loss: 0.225
epoch:  94 val_f1:  0.7699730743399811 val_auroc:  0.8122238586156112 val_auprc:  0.9210407287082497
EarlyStopping counter: 1 out of 50
epoch:  94
[Epoch 95, Batch 10] loss: 0.222
epoch:  95 val_f1:  0.7626195746699344 val_auroc:  0.8127147766323024 val_auprc:  0.9212463633509935
EarlyStopping counter: 2 out of 50
epoch:  95
[Epoch 96, Batch 10] loss: 0.222
epoch:  96 val_f1:  0.7466980132583976 val_auroc:  0.8114874815905744 val_auprc:  0.9203443974146244
EarlyStopping counter: 3 out of 50
epoch:  96
[Epoch 97, Batch 10] loss: 0.221
epoch:  97 val_f1:  0.7691994463100789 val_auroc:  0.8102601865488464 val_auprc:  0.9198535972667852
EarlyStopping counter: 4 out of 50
epoch:  97
[Epoch 98, Batch 10] loss: 0.219
epoch:  98 val_f1:  0.7617596949267598 val_auroc:  0.810505645557192 val_auprc:  0.9197523851841207
EarlyStopping counter: 5 out of 50
epoch:  98
[Epoch 99, Batch 10] loss: 0.218
epoch:  99 val_f1:  0.7542604103291037 val_auroc:  0.8109965635738833 val_auprc:  0.9199611138291436
EarlyStopping counter: 6 out of 50
epoch:  99
[Epoch 100, Batch 10] loss: 0.223
epoch:  100 val_f1:  0.7633550302615051 val_auroc:  0.81173294059892 val_auprc:  0.9204824457913531
EarlyStopping counter: 7 out of 50
epoch:  100
[Epoch 101, Batch 10] loss: 0.209
epoch:  101 val_f1:  0.7542604103291037 val_auroc:  0.8107511045655376 val_auprc:  0.9199998157646333
EarlyStopping counter: 8 out of 50
epoch:  101
[Epoch 102, Batch 10] loss: 0.220
epoch:  102 val_f1:  0.7617596949267598 val_auroc:  0.8114874815905744 val_auprc:  0.920351103833869
EarlyStopping counter: 9 out of 50
epoch:  102
[Epoch 103, Batch 10] loss: 0.199
epoch:  103 val_f1:  0.7617596949267598 val_auroc:  0.81173294059892 val_auprc:  0.920559070744474
EarlyStopping counter: 10 out of 50
epoch:  103
[Epoch 104, Batch 10] loss: 0.208
epoch:  104 val_f1:  0.7617596949267598 val_auroc:  0.8112420225822288 val_auprc:  0.9203547289336087
EarlyStopping counter: 11 out of 50
epoch:  104
[Epoch 105, Batch 10] loss: 0.218
epoch:  105 val_f1:  0.7542604103291037 val_auroc:  0.8107511045655376 val_auprc:  0.9201447782136499
EarlyStopping counter: 12 out of 50
epoch:  105
[Epoch 106, Batch 10] loss: 0.201
epoch:  106 val_f1:  0.7560320485424044 val_auroc:  0.81173294059892 val_auprc:  0.9206015500768567
EarlyStopping counter: 13 out of 50
epoch:  106
[Epoch 107, Batch 10] loss: 0.219
epoch:  107 val_f1:  0.7466980132583976 val_auroc:  0.8107511045655376 val_auprc:  0.9199797752877815
EarlyStopping counter: 14 out of 50
epoch:  107
[Epoch 108, Batch 10] loss: 0.202
epoch:  108 val_f1:  0.7542604103291037 val_auroc:  0.8112420225822288 val_auprc:  0.9202259307547029
EarlyStopping counter: 15 out of 50
epoch:  108
[Epoch 109, Batch 10] loss: 0.210
epoch:  109 val_f1:  0.7542604103291037 val_auroc:  0.8090328915071183 val_auprc:  0.9192399733148773
EarlyStopping counter: 16 out of 50
epoch:  109
[Epoch 110, Batch 10] loss: 0.204
epoch:  110 val_f1:  0.7560320485424044 val_auroc:  0.8122238586156112 val_auprc:  0.9211425880204255
EarlyStopping counter: 17 out of 50
epoch:  110
[Epoch 111, Batch 10] loss: 0.205
epoch:  111 val_f1:  0.7626195746699344 val_auroc:  0.8112420225822288 val_auprc:  0.9207309257359346
EarlyStopping counter: 18 out of 50
epoch:  111
[Epoch 112, Batch 10] loss: 0.217
epoch:  112 val_f1:  0.7466980132583976 val_auroc:  0.8112420225822288 val_auprc:  0.9203013704688399
EarlyStopping counter: 19 out of 50
epoch:  112
[Epoch 113, Batch 10] loss: 0.208
epoch:  113 val_f1:  0.7542604103291037 val_auroc:  0.8127147766323024 val_auprc:  0.9211162720640602
EarlyStopping counter: 20 out of 50
epoch:  113
[Epoch 114, Batch 10] loss: 0.212
epoch:  114 val_f1:  0.7560320485424044 val_auroc:  0.8122238586156112 val_auprc:  0.92093508400482
Validation loss improved to 1.571479
epoch:  114
[Epoch 115, Batch 10] loss: 0.212
epoch:  115 val_f1:  0.7466980132583976 val_auroc:  0.81173294059892 val_auprc:  0.9205599002116039
EarlyStopping counter: 1 out of 50
epoch:  115
[Epoch 116, Batch 10] loss: 0.192
epoch:  116 val_f1:  0.7542604103291037 val_auroc:  0.8122238586156111 val_auprc:  0.9208250353931716
EarlyStopping counter: 2 out of 50
epoch:  116
[Epoch 117, Batch 10] loss: 0.214
epoch:  117 val_f1:  0.7617596949267598 val_auroc:  0.8127147766323024 val_auprc:  0.9211931775207883
EarlyStopping counter: 3 out of 50
epoch:  117
[Epoch 118, Batch 10] loss: 0.200
epoch:  118 val_f1:  0.7542604103291037 val_auroc:  0.812960235640648 val_auprc:  0.9212372216633216
EarlyStopping counter: 4 out of 50
epoch:  118
[Epoch 119, Batch 10] loss: 0.198
epoch:  119 val_f1:  0.7542604103291037 val_auroc:  0.8134511536573391 val_auprc:  0.9216066427981883
EarlyStopping counter: 5 out of 50
epoch:  119
[Epoch 120, Batch 10] loss: 0.195
epoch:  120 val_f1:  0.7542604103291037 val_auroc:  0.8134511536573391 val_auprc:  0.9214926770839528
EarlyStopping counter: 6 out of 50
epoch:  120
[Epoch 121, Batch 10] loss: 0.200
epoch:  121 val_f1:  0.7626195746699344 val_auroc:  0.8129602356406481 val_auprc:  0.9210953493724536
EarlyStopping counter: 7 out of 50
epoch:  121
[Epoch 122, Batch 10] loss: 0.208
epoch:  122 val_f1:  0.7542604103291037 val_auroc:  0.8132056946489936 val_auprc:  0.9210927437675456
EarlyStopping counter: 8 out of 50
epoch:  122
[Epoch 123, Batch 10] loss: 0.203
epoch:  123 val_f1:  0.7617596949267598 val_auroc:  0.8127147766323024 val_auprc:  0.9208520966235358
EarlyStopping counter: 9 out of 50
epoch:  123
[Epoch 124, Batch 10] loss: 0.207
epoch:  124 val_f1:  0.7617596949267598 val_auroc:  0.812960235640648 val_auprc:  0.9209371722715577
EarlyStopping counter: 10 out of 50
epoch:  124
[Epoch 125, Batch 10] loss: 0.198
epoch:  125 val_f1:  0.7626195746699344 val_auroc:  0.8146784486990674 val_auprc:  0.9219738217122229
EarlyStopping counter: 11 out of 50
epoch:  125
[Epoch 126, Batch 10] loss: 0.215
epoch:  126 val_f1:  0.7390688025474315 val_auroc:  0.8132056946489936 val_auprc:  0.9210749177939953
EarlyStopping counter: 12 out of 50
epoch:  126
[Epoch 127, Batch 10] loss: 0.200
epoch:  127 val_f1:  0.7542604103291037 val_auroc:  0.8139420716740304 val_auprc:  0.9215084386662453
EarlyStopping counter: 13 out of 50
epoch:  127
[Epoch 128, Batch 10] loss: 0.186
epoch:  128 val_f1:  0.7466980132583976 val_auroc:  0.8132056946489936 val_auprc:  0.9213117587760751
EarlyStopping counter: 14 out of 50
epoch:  128
[Epoch 129, Batch 10] loss: 0.198
epoch:  129 val_f1:  0.7617596949267598 val_auroc:  0.812960235640648 val_auprc:  0.9209541879391536
EarlyStopping counter: 15 out of 50
epoch:  129
[Epoch 130, Batch 10] loss: 0.175
epoch:  130 val_f1:  0.7542604103291037 val_auroc:  0.8136966126656848 val_auprc:  0.9212479283990487
EarlyStopping counter: 16 out of 50
epoch:  130
[Epoch 131, Batch 10] loss: 0.177
epoch:  131 val_f1:  0.7466980132583976 val_auroc:  0.8139420716740305 val_auprc:  0.9213200276032985
EarlyStopping counter: 17 out of 50
epoch:  131
[Epoch 132, Batch 10] loss: 0.186
epoch:  132 val_f1:  0.7552115339652351 val_auroc:  0.8139420716740305 val_auprc:  0.9214467337742781
EarlyStopping counter: 18 out of 50
epoch:  132
[Epoch 133, Batch 10] loss: 0.183
epoch:  133 val_f1:  0.7617596949267598 val_auroc:  0.8146784486990672 val_auprc:  0.9214147189017392
EarlyStopping counter: 19 out of 50
epoch:  133
[Epoch 134, Batch 10] loss: 0.187
epoch:  134 val_f1:  0.7617596949267598 val_auroc:  0.8144329896907216 val_auprc:  0.9212507231279059
EarlyStopping counter: 20 out of 50
epoch:  134
[Epoch 135, Batch 10] loss: 0.187
epoch:  135 val_f1:  0.7617596949267598 val_auroc:  0.8127147766323024 val_auprc:  0.9206588473863483
EarlyStopping counter: 21 out of 50
epoch:  135
[Epoch 136, Batch 10] loss: 0.196
epoch:  136 val_f1:  0.7617596949267598 val_auroc:  0.8136966126656848 val_auprc:  0.9209653037215612
EarlyStopping counter: 22 out of 50
epoch:  136
[Epoch 137, Batch 10] loss: 0.184
epoch:  137 val_f1:  0.7617596949267598 val_auroc:  0.8134511536573391 val_auprc:  0.9209542297880073
EarlyStopping counter: 23 out of 50
epoch:  137
[Epoch 138, Batch 10] loss: 0.191
epoch:  138 val_f1:  0.7542604103291037 val_auroc:  0.814187530682376 val_auprc:  0.9213097719856195
EarlyStopping counter: 24 out of 50
epoch:  138
[Epoch 139, Batch 10] loss: 0.195
epoch:  139 val_f1:  0.7617596949267598 val_auroc:  0.8159057437407953 val_auprc:  0.9218504283306777
EarlyStopping counter: 25 out of 50
epoch:  139
[Epoch 140, Batch 10] loss: 0.183
epoch:  140 val_f1:  0.7617596949267598 val_auroc:  0.8144329896907218 val_auprc:  0.9213357563568719
EarlyStopping counter: 26 out of 50
epoch:  140
[Epoch 141, Batch 10] loss: 0.180
epoch:  141 val_f1:  0.7542604103291037 val_auroc:  0.8132056946489936 val_auprc:  0.9207139190262462
EarlyStopping counter: 27 out of 50
epoch:  141
[Epoch 142, Batch 10] loss: 0.175
epoch:  142 val_f1:  0.7542604103291037 val_auroc:  0.8134511536573392 val_auprc:  0.9207867677276771
EarlyStopping counter: 28 out of 50
epoch:  142
[Epoch 143, Batch 10] loss: 0.180
epoch:  143 val_f1:  0.7552115339652351 val_auroc:  0.8127147766323024 val_auprc:  0.9205801364751052
EarlyStopping counter: 29 out of 50
epoch:  143
[Epoch 144, Batch 10] loss: 0.184
epoch:  144 val_f1:  0.7542604103291037 val_auroc:  0.812960235640648 val_auprc:  0.9205559235787095
EarlyStopping counter: 30 out of 50
epoch:  144
[Epoch 145, Batch 10] loss: 0.189
epoch:  145 val_f1:  0.7542604103291037 val_auroc:  0.8144329896907218 val_auprc:  0.9212316440931232
EarlyStopping counter: 31 out of 50
epoch:  145
[Epoch 146, Batch 10] loss: 0.188
epoch:  146 val_f1:  0.7552115339652351 val_auroc:  0.8136966126656848 val_auprc:  0.9208518837362237
EarlyStopping counter: 32 out of 50
epoch:  146
[Epoch 147, Batch 10] loss: 0.181
epoch:  147 val_f1:  0.7617596949267598 val_auroc:  0.8139420716740304 val_auprc:  0.9210056181833434
EarlyStopping counter: 33 out of 50
epoch:  147
[Epoch 148, Batch 10] loss: 0.193
epoch:  148 val_f1:  0.7617596949267598 val_auroc:  0.8154148257241041 val_auprc:  0.9216399811915619
EarlyStopping counter: 34 out of 50
epoch:  148
[Epoch 149, Batch 10] loss: 0.161
epoch:  149 val_f1:  0.7552115339652351 val_auroc:  0.8156602847324497 val_auprc:  0.9216442428715026
EarlyStopping counter: 35 out of 50
epoch:  149
[Epoch 150, Batch 10] loss: 0.174
epoch:  150 val_f1:  0.7737843767539161 val_auroc:  0.8168875797741778 val_auprc:  0.9219712863223347
EarlyStopping counter: 36 out of 50
epoch:  150
[Epoch 151, Batch 10] loss: 0.168
epoch:  151 val_f1:  0.7552115339652351 val_auroc:  0.8144329896907216 val_auprc:  0.9211498285816315
EarlyStopping counter: 37 out of 50
epoch:  151
[Epoch 152, Batch 10] loss: 0.161
epoch:  152 val_f1:  0.7617596949267598 val_auroc:  0.8159057437407953 val_auprc:  0.9216667383846537
EarlyStopping counter: 38 out of 50
epoch:  152
[Epoch 153, Batch 10] loss: 0.168
epoch:  153 val_f1:  0.7617596949267598 val_auroc:  0.8159057437407952 val_auprc:  0.9216140279149199
EarlyStopping counter: 39 out of 50
epoch:  153
[Epoch 154, Batch 10] loss: 0.181
epoch:  154 val_f1:  0.7542604103291037 val_auroc:  0.8134511536573393 val_auprc:  0.9205366470752568
EarlyStopping counter: 40 out of 50
epoch:  154
[Epoch 155, Batch 10] loss: 0.170
epoch:  155 val_f1:  0.7617596949267598 val_auroc:  0.8161512027491409 val_auprc:  0.9217178368762504
EarlyStopping counter: 41 out of 50
epoch:  155
[Epoch 156, Batch 10] loss: 0.181
epoch:  156 val_f1:  0.7672775806504117 val_auroc:  0.8136966126656847 val_auprc:  0.9204687342737056
EarlyStopping counter: 42 out of 50
epoch:  156
[Epoch 157, Batch 10] loss: 0.176
epoch:  157 val_f1:  0.7552115339652351 val_auroc:  0.8139420716740305 val_auprc:  0.9207575071416708
EarlyStopping counter: 43 out of 50
epoch:  157
[Epoch 158, Batch 10] loss: 0.168
epoch:  158 val_f1:  0.7607703458551531 val_auroc:  0.8163966617574865 val_auprc:  0.9218114102948776
EarlyStopping counter: 44 out of 50
epoch:  158
[Epoch 159, Batch 10] loss: 0.177
epoch:  159 val_f1:  0.7617596949267598 val_auroc:  0.8159057437407952 val_auprc:  0.9217174139735431
EarlyStopping counter: 45 out of 50
epoch:  159
[Epoch 160, Batch 10] loss: 0.159
epoch:  160 val_f1:  0.7542604103291037 val_auroc:  0.8156602847324497 val_auprc:  0.9213905784044343
EarlyStopping counter: 46 out of 50
epoch:  160
[Epoch 161, Batch 10] loss: 0.170
epoch:  161 val_f1:  0.7531731915989216 val_auroc:  0.8149239077074129 val_auprc:  0.9211258155037412
EarlyStopping counter: 47 out of 50
epoch:  161
[Epoch 162, Batch 10] loss: 0.159
epoch:  162 val_f1:  0.7542604103291037 val_auroc:  0.8146784486990672 val_auprc:  0.9211038539753575
EarlyStopping counter: 48 out of 50
epoch:  162
[Epoch 163, Batch 10] loss: 0.160
epoch:  163 val_f1:  0.7542604103291037 val_auroc:  0.8144329896907216 val_auprc:  0.9208510530862222
EarlyStopping counter: 49 out of 50
epoch:  163
[Epoch 164, Batch 10] loss: 0.163
epoch:  164 val_f1:  0.7661184054361647 val_auroc:  0.8139420716740304 val_auprc:  0.9207061531651373
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  984.2680320739746
{'time_elapsed': [984.2680320739746], 'epoch': [163], 'fold': [1], 'f1_train': [0.9205400588371899], 'auroc_train': [0.9727596038875433], 'auprc_train': [0.988051764437454], 'f1_test': [0.7661184054361647], 'auroc_test': [0.8139420716740304], 'auprc_test': [0.9207061531651373]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [32, 1]                   --
├─Sequential: 1-1                        [32, 1]                   --
│    └─Conv1d: 2-1                       [32, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [32, 1024, 427]           2,048
│    └─Tanh: 2-3                         [32, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [32, 1024, 142]           --
│    └─Dropout: 2-5                      [32, 1024, 142]           --
│    └─Flatten: 2-6                      [32, 145408]              --
│    └─Linear: 2-7                       [32, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.16
Forward/backward pass size (MB): 223.87
Params size (MB): 0.61
Estimated Total Size (MB): 224.64
==========================================================================================
tensor(0.4369)
epoch:  0
[Epoch 1, Batch 10] loss: 0.453
epoch:  1 val_f1:  0.6873154108292314 val_auroc:  0.7216494845360825 val_auprc:  0.8677047674765721
epoch:  1
[Epoch 2, Batch 10] loss: 0.399
epoch:  2 val_f1:  0.6640110571641208 val_auroc:  0.738831615120275 val_auprc:  0.870621197697699
Validation loss improved to 1.982122
epoch:  2
[Epoch 3, Batch 10] loss: 0.403
epoch:  3 val_f1:  0.43835312981286517 val_auroc:  0.735640648011782 val_auprc:  0.8772315598064386
EarlyStopping counter: 1 out of 50
epoch:  3
[Epoch 4, Batch 10] loss: 0.393
epoch:  4 val_f1:  0.6385973188662184 val_auroc:  0.7366224840451644 val_auprc:  0.8767150151973373
Validation loss improved to 1.961128
epoch:  4
[Epoch 5, Batch 10] loss: 0.391
epoch:  5 val_f1:  0.600961958701277 val_auroc:  0.7292587137947962 val_auprc:  0.8738939704471202
Validation loss improved to 1.951154
epoch:  5
[Epoch 6, Batch 10] loss: 0.385
epoch:  6 val_f1:  0.5800249311040678 val_auroc:  0.7258222876779579 val_auprc:  0.8752288253403002
Validation loss improved to 1.947401
epoch:  6
[Epoch 7, Batch 10] loss: 0.378
epoch:  7 val_f1:  0.6538912937446653 val_auroc:  0.7226313205694649 val_auprc:  0.8730573058235318
Validation loss improved to 1.926332
epoch:  7
[Epoch 8, Batch 10] loss: 0.383
epoch:  8 val_f1:  0.5917124096980212 val_auroc:  0.7280314187530682 val_auprc:  0.8757952883997457
Validation loss improved to 1.921349
epoch:  8
[Epoch 9, Batch 10] loss: 0.371
epoch:  9 val_f1:  0.5917124096980212 val_auroc:  0.7292587137947963 val_auprc:  0.8751165707332406
Validation loss improved to 1.913545
epoch:  9
[Epoch 10, Batch 10] loss: 0.362
epoch:  10 val_f1:  0.6524974219867484 val_auroc:  0.7317133038782523 val_auprc:  0.8756435019081474
Validation loss improved to 1.900401
epoch:  10
[Epoch 11, Batch 10] loss: 0.363
epoch:  11 val_f1:  0.5657884880906463 val_auroc:  0.7380952380952381 val_auprc:  0.8784441341209414
EarlyStopping counter: 1 out of 50
epoch:  11
[Epoch 12, Batch 10] loss: 0.376
epoch:  12 val_f1:  0.667134140788635 val_auroc:  0.7430044182621501 val_auprc:  0.8801213816249125
Validation loss improved to 1.885314
epoch:  12
[Epoch 13, Batch 10] loss: 0.362
epoch:  13 val_f1:  0.7166299330477814 val_auroc:  0.7432498772704957 val_auprc:  0.8797929019389064
Validation loss improved to 1.866653
epoch:  13
[Epoch 14, Batch 10] loss: 0.348
epoch:  14 val_f1:  0.6451024231755431 val_auroc:  0.7454590083456063 val_auprc:  0.8792198704052896
EarlyStopping counter: 1 out of 50
epoch:  14
[Epoch 15, Batch 10] loss: 0.356
epoch:  15 val_f1:  0.6532647299881614 val_auroc:  0.7488954344624448 val_auprc:  0.8803576199072555
Validation loss improved to 1.865388
epoch:  15
[Epoch 16, Batch 10] loss: 0.348
epoch:  16 val_f1:  0.7375047745919104 val_auroc:  0.7503681885125184 val_auprc:  0.8804324014215764
Validation loss improved to 1.845575
epoch:  16
[Epoch 17, Batch 10] loss: 0.343
epoch:  17 val_f1:  0.6891084624964738 val_auroc:  0.7515954835542464 val_auprc:  0.8802448421483842
Validation loss improved to 1.845202
epoch:  17
[Epoch 18, Batch 10] loss: 0.332
epoch:  18 val_f1:  0.7445203699313053 val_auroc:  0.7545409916543937 val_auprc:  0.8811524527125588
Validation loss improved to 1.834311
epoch:  18
[Epoch 19, Batch 10] loss: 0.335
epoch:  19 val_f1:  0.667134140788635 val_auroc:  0.7550319096710849 val_auprc:  0.8807919438308713
EarlyStopping counter: 1 out of 50
epoch:  19
[Epoch 20, Batch 10] loss: 0.330
epoch:  20 val_f1:  0.743914028278071 val_auroc:  0.7557682866961217 val_auprc:  0.8811536160615603
Validation loss improved to 1.821153
epoch:  20
[Epoch 21, Batch 10] loss: 0.331
epoch:  21 val_f1:  0.6598406488264144 val_auroc:  0.7562592047128129 val_auprc:  0.880605151415443
EarlyStopping counter: 1 out of 50
epoch:  21
[Epoch 22, Batch 10] loss: 0.333
epoch:  22 val_f1:  0.7375047745919104 val_auroc:  0.7582228767795779 val_auprc:  0.8811689412775366
Validation loss improved to 1.811152
epoch:  22
[Epoch 23, Batch 10] loss: 0.319
epoch:  23 val_f1:  0.6524974219867484 val_auroc:  0.7572410407461955 val_auprc:  0.8801156749241372
EarlyStopping counter: 1 out of 50
epoch:  23
[Epoch 24, Batch 10] loss: 0.319
epoch:  24 val_f1:  0.7239714721729109 val_auroc:  0.7584683357879234 val_auprc:  0.8803446251383167
Validation loss improved to 1.806905
epoch:  24
[Epoch 25, Batch 10] loss: 0.311
epoch:  25 val_f1:  0.7170452552783244 val_auroc:  0.7569955817378498 val_auprc:  0.8769735170123527
Validation loss improved to 1.802715
epoch:  25
[Epoch 26, Batch 10] loss: 0.314
epoch:  26 val_f1:  0.7170452552783244 val_auroc:  0.7577319587628866 val_auprc:  0.8769615900912452
Validation loss improved to 1.802173
epoch:  26
[Epoch 27, Batch 10] loss: 0.308
epoch:  27 val_f1:  0.6958509820496094 val_auroc:  0.7572410407461955 val_auprc:  0.8763762831499813
EarlyStopping counter: 1 out of 50
epoch:  27
[Epoch 28, Batch 10] loss: 0.307
epoch:  28 val_f1:  0.7170452552783244 val_auroc:  0.7579774177712323 val_auprc:  0.877922170975175
Validation loss improved to 1.789048
epoch:  28
[Epoch 29, Batch 10] loss: 0.326
epoch:  29 val_f1:  0.7170452552783244 val_auroc:  0.7592047128129602 val_auprc:  0.8774269327182139
Validation loss improved to 1.785517
epoch:  29
[Epoch 30, Batch 10] loss: 0.294
epoch:  30 val_f1:  0.703263898025454 val_auroc:  0.7579774177712323 val_auprc:  0.876999784427269
EarlyStopping counter: 1 out of 50
epoch:  30
[Epoch 31, Batch 10] loss: 0.289
epoch:  31 val_f1:  0.72389147505525 val_auroc:  0.758713794796269 val_auprc:  0.8773806333500443
Validation loss improved to 1.777811
epoch:  31
[Epoch 32, Batch 10] loss: 0.303
epoch:  32 val_f1:  0.7101700457815566 val_auroc:  0.7569955817378498 val_auprc:  0.8758805199219916
EarlyStopping counter: 1 out of 50
epoch:  32
[Epoch 33, Batch 10] loss: 0.300
epoch:  33 val_f1:  0.7307106601978622 val_auroc:  0.7599410898379971 val_auprc:  0.8768480610096991
Validation loss improved to 1.771018
epoch:  33
[Epoch 34, Batch 10] loss: 0.310
epoch:  34 val_f1:  0.7644702419882276 val_auroc:  0.7601865488463427 val_auprc:  0.8774564920169838
Validation loss improved to 1.762524
epoch:  34
[Epoch 35, Batch 10] loss: 0.290
epoch:  35 val_f1:  0.6963248678165901 val_auroc:  0.7577319587628866 val_auprc:  0.8758947983276131
EarlyStopping counter: 1 out of 50
epoch:  35
[Epoch 36, Batch 10] loss: 0.276
epoch:  36 val_f1:  0.7307106601978622 val_auroc:  0.7589592538046147 val_auprc:  0.8764977905472058
EarlyStopping counter: 2 out of 50
epoch:  36
[Epoch 37, Batch 10] loss: 0.283
epoch:  37 val_f1:  0.7307106601978622 val_auroc:  0.759941089837997 val_auprc:  0.8759666032881355
EarlyStopping counter: 3 out of 50
epoch:  37
[Epoch 38, Batch 10] loss: 0.286
epoch:  38 val_f1:  0.7101700457815566 val_auroc:  0.7606774668630338 val_auprc:  0.8757543630883504
EarlyStopping counter: 4 out of 50
epoch:  38
[Epoch 39, Batch 10] loss: 0.286
epoch:  39 val_f1:  0.7170452552783244 val_auroc:  0.7594501718213058 val_auprc:  0.8753700679500643
EarlyStopping counter: 5 out of 50
epoch:  39
[Epoch 40, Batch 10] loss: 0.290
epoch:  40 val_f1:  0.7307106601978622 val_auroc:  0.7616593028964163 val_auprc:  0.8769471718465954
Validation loss improved to 1.758161
epoch:  40
[Epoch 41, Batch 10] loss: 0.273
epoch:  41 val_f1:  0.7307106601978622 val_auroc:  0.7623956799214532 val_auprc:  0.8766242548941632
Validation loss improved to 1.756055
epoch:  41
[Epoch 42, Batch 10] loss: 0.278
epoch:  42 val_f1:  0.7170452552783244 val_auroc:  0.7619047619047619 val_auprc:  0.8763101034046212
EarlyStopping counter: 1 out of 50
epoch:  42
[Epoch 43, Batch 10] loss: 0.269
epoch:  43 val_f1:  0.7307106601978622 val_auroc:  0.764359351988218 val_auprc:  0.8773866993173164
Validation loss improved to 1.754171
epoch:  43
[Epoch 44, Batch 10] loss: 0.263
epoch:  44 val_f1:  0.7101700457815566 val_auroc:  0.7638684339715267 val_auprc:  0.8770070967330723
EarlyStopping counter: 1 out of 50
epoch:  44
[Epoch 45, Batch 10] loss: 0.256
epoch:  45 val_f1:  0.7577565132360132 val_auroc:  0.7668139420716741 val_auprc:  0.8786722020957745
Validation loss improved to 1.745610
epoch:  45
[Epoch 46, Batch 10] loss: 0.276
epoch:  46 val_f1:  0.7375047745919104 val_auroc:  0.7636229749631812 val_auprc:  0.8764914110870752
EarlyStopping counter: 1 out of 50
epoch:  46
[Epoch 47, Batch 10] loss: 0.259
epoch:  47 val_f1:  0.7101700457815566 val_auroc:  0.7641138929798723 val_auprc:  0.8770923517039718
EarlyStopping counter: 2 out of 50
epoch:  47
[Epoch 48, Batch 10] loss: 0.281
epoch:  48 val_f1:  0.7506155503404762 val_auroc:  0.7665684830633285 val_auprc:  0.8783549982974299
Validation loss improved to 1.742584
epoch:  48
[Epoch 49, Batch 10] loss: 0.266
epoch:  49 val_f1:  0.7170452552783244 val_auroc:  0.7665684830633285 val_auprc:  0.8780971750147031
EarlyStopping counter: 1 out of 50
epoch:  49
[Epoch 50, Batch 10] loss: 0.265
epoch:  50 val_f1:  0.72389147505525 val_auroc:  0.7648502700049091 val_auprc:  0.8763551038460722
EarlyStopping counter: 2 out of 50
epoch:  50
[Epoch 51, Batch 10] loss: 0.270
epoch:  51 val_f1:  0.72389147505525 val_auroc:  0.7668139420716741 val_auprc:  0.8776190782709341
EarlyStopping counter: 3 out of 50
epoch:  51
[Epoch 52, Batch 10] loss: 0.258
epoch:  52 val_f1:  0.7375047745919104 val_auroc:  0.7658321060382917 val_auprc:  0.8760570979474259
EarlyStopping counter: 4 out of 50
epoch:  52
[Epoch 53, Batch 10] loss: 0.252
epoch:  53 val_f1:  0.7375047745919104 val_auroc:  0.7660775650466372 val_auprc:  0.8762292871725976
EarlyStopping counter: 5 out of 50
epoch:  53
[Epoch 54, Batch 10] loss: 0.273
epoch:  54 val_f1:  0.7371937993371881 val_auroc:  0.7668139420716741 val_auprc:  0.876461679732502
Validation loss improved to 1.742144
epoch:  54
[Epoch 55, Batch 10] loss: 0.246
epoch:  55 val_f1:  0.72389147505525 val_auroc:  0.7665684830633285 val_auprc:  0.876383170323708
EarlyStopping counter: 1 out of 50
epoch:  55
[Epoch 56, Batch 10] loss: 0.263
epoch:  56 val_f1:  0.7307106601978622 val_auroc:  0.7692685321551301 val_auprc:  0.8790302117794324
Validation loss improved to 1.736037
epoch:  56
[Epoch 57, Batch 10] loss: 0.268
epoch:  57 val_f1:  0.72389147505525 val_auroc:  0.7695139911634756 val_auprc:  0.8799897768274962
EarlyStopping counter: 1 out of 50
epoch:  57
[Epoch 58, Batch 10] loss: 0.258
epoch:  58 val_f1:  0.743914028278071 val_auroc:  0.770004909180167 val_auprc:  0.8796373705914746
Validation loss improved to 1.731763
epoch:  58
[Epoch 59, Batch 10] loss: 0.242
epoch:  59 val_f1:  0.7307106601978622 val_auroc:  0.7668139420716741 val_auprc:  0.8773563708015523
EarlyStopping counter: 1 out of 50
epoch:  59
[Epoch 60, Batch 10] loss: 0.237
epoch:  60 val_f1:  0.743914028278071 val_auroc:  0.7695139911634756 val_auprc:  0.8797433629806007
EarlyStopping counter: 2 out of 50
epoch:  60
[Epoch 61, Batch 10] loss: 0.250
epoch:  61 val_f1:  0.72389147505525 val_auroc:  0.7680412371134021 val_auprc:  0.8782086826279369
EarlyStopping counter: 3 out of 50
epoch:  61
[Epoch 62, Batch 10] loss: 0.246
epoch:  62 val_f1:  0.7307106601978622 val_auroc:  0.7677957781050565 val_auprc:  0.8776150337597319
EarlyStopping counter: 4 out of 50
epoch:  62
[Epoch 63, Batch 10] loss: 0.249
epoch:  63 val_f1:  0.730071543320129 val_auroc:  0.7682866961217476 val_auprc:  0.8785026033165227
EarlyStopping counter: 5 out of 50
epoch:  63
[Epoch 64, Batch 10] loss: 0.249
epoch:  64 val_f1:  0.7371937993371881 val_auroc:  0.7717231222385862 val_auprc:  0.8812149870188
EarlyStopping counter: 6 out of 50
epoch:  64
[Epoch 65, Batch 10] loss: 0.241
epoch:  65 val_f1:  0.7236892364125374 val_auroc:  0.7677957781050565 val_auprc:  0.8779181188242559
EarlyStopping counter: 7 out of 50
epoch:  65
[Epoch 66, Batch 10] loss: 0.254
epoch:  66 val_f1:  0.7307106601978622 val_auroc:  0.7714776632302406 val_auprc:  0.8810278777167462
EarlyStopping counter: 8 out of 50
epoch:  66
[Epoch 67, Batch 10] loss: 0.248
epoch:  67 val_f1:  0.7233618940391454 val_auroc:  0.7653411880216004 val_auprc:  0.8764560047803066
EarlyStopping counter: 9 out of 50
epoch:  67
[Epoch 68, Batch 10] loss: 0.240
epoch:  68 val_f1:  0.743431836172277 val_auroc:  0.7670594010800197 val_auprc:  0.8774940241241836
EarlyStopping counter: 10 out of 50
epoch:  68
[Epoch 69, Batch 10] loss: 0.245
epoch:  69 val_f1:  0.730071543320129 val_auroc:  0.7695139911634757 val_auprc:  0.8796343215907957
EarlyStopping counter: 11 out of 50
epoch:  69
[Epoch 70, Batch 10] loss: 0.242
epoch:  70 val_f1:  0.7233618940391454 val_auroc:  0.7707412862052038 val_auprc:  0.8806655219612805
EarlyStopping counter: 12 out of 50
epoch:  70
[Epoch 71, Batch 10] loss: 0.225
epoch:  71 val_f1:  0.7233618940391454 val_auroc:  0.7729504172803142 val_auprc:  0.881776689354743
EarlyStopping counter: 13 out of 50
epoch:  71
[Epoch 72, Batch 10] loss: 0.253
epoch:  72 val_f1:  0.743431836172277 val_auroc:  0.7719685812469319 val_auprc:  0.8811653948734681
EarlyStopping counter: 14 out of 50
epoch:  72
[Epoch 73, Batch 10] loss: 0.241
epoch:  73 val_f1:  0.7166299330477814 val_auroc:  0.7734413352970054 val_auprc:  0.8821489619378653
EarlyStopping counter: 15 out of 50
epoch:  73
[Epoch 74, Batch 10] loss: 0.238
epoch:  74 val_f1:  0.743431836172277 val_auroc:  0.7697594501718212 val_auprc:  0.8776564351638566
EarlyStopping counter: 16 out of 50
epoch:  74
[Epoch 75, Batch 10] loss: 0.252
epoch:  75 val_f1:  0.743431836172277 val_auroc:  0.771232204221895 val_auprc:  0.8798997413456932
EarlyStopping counter: 17 out of 50
epoch:  75
[Epoch 76, Batch 10] loss: 0.242
epoch:  76 val_f1:  0.7236892364125374 val_auroc:  0.770495827196858 val_auprc:  0.8794540873319014
EarlyStopping counter: 18 out of 50
epoch:  76
[Epoch 77, Batch 10] loss: 0.227
epoch:  77 val_f1:  0.743431836172277 val_auroc:  0.7709867452135494 val_auprc:  0.8801381173910369
EarlyStopping counter: 19 out of 50
epoch:  77
[Epoch 78, Batch 10] loss: 0.241
epoch:  78 val_f1:  0.7367608586927249 val_auroc:  0.7714776632302406 val_auprc:  0.8798389959597608
EarlyStopping counter: 20 out of 50
epoch:  78
[Epoch 79, Batch 10] loss: 0.248
epoch:  79 val_f1:  0.7367608586927249 val_auroc:  0.7734413352970054 val_auprc:  0.8825842629877693
EarlyStopping counter: 21 out of 50
epoch:  79
[Epoch 80, Batch 10] loss: 0.243
epoch:  80 val_f1:  0.743431836172277 val_auroc:  0.7719685812469318 val_auprc:  0.8799220293645096
EarlyStopping counter: 22 out of 50
epoch:  80
[Epoch 81, Batch 10] loss: 0.221
epoch:  81 val_f1:  0.730071543320129 val_auroc:  0.770004909180167 val_auprc:  0.8788147695980428
EarlyStopping counter: 23 out of 50
epoch:  81
[Epoch 82, Batch 10] loss: 0.228
epoch:  82 val_f1:  0.743431836172277 val_auroc:  0.773686794305351 val_auprc:  0.8827145700068993
EarlyStopping counter: 24 out of 50
epoch:  82
[Epoch 83, Batch 10] loss: 0.226
epoch:  83 val_f1:  0.730071543320129 val_auroc:  0.773686794305351 val_auprc:  0.8829415064623369
EarlyStopping counter: 25 out of 50
epoch:  83
[Epoch 84, Batch 10] loss: 0.216
epoch:  84 val_f1:  0.730071543320129 val_auroc:  0.7744231713303878 val_auprc:  0.8833261843951772
EarlyStopping counter: 26 out of 50
epoch:  84
[Epoch 85, Batch 10] loss: 0.230
epoch:  85 val_f1:  0.743431836172277 val_auroc:  0.7756504663721159 val_auprc:  0.8837726104410465
EarlyStopping counter: 27 out of 50
epoch:  85
[Epoch 86, Batch 10] loss: 0.214
epoch:  86 val_f1:  0.743431836172277 val_auroc:  0.776141384388807 val_auprc:  0.8839232223233119
EarlyStopping counter: 28 out of 50
epoch:  86
[Epoch 87, Batch 10] loss: 0.226
epoch:  87 val_f1:  0.7367608586927249 val_auroc:  0.7781050564555719 val_auprc:  0.885112543125794
Validation loss improved to 1.730777
epoch:  87
[Epoch 88, Batch 10] loss: 0.223
epoch:  88 val_f1:  0.743431836172277 val_auroc:  0.7746686303387335 val_auprc:  0.8833830366929449
EarlyStopping counter: 1 out of 50
epoch:  88
[Epoch 89, Batch 10] loss: 0.219
epoch:  89 val_f1:  0.743431836172277 val_auroc:  0.7754050073637703 val_auprc:  0.8835854762172775
EarlyStopping counter: 2 out of 50
epoch:  89
[Epoch 90, Batch 10] loss: 0.217
epoch:  90 val_f1:  0.743431836172277 val_auroc:  0.7741777123220422 val_auprc:  0.882257125587109
EarlyStopping counter: 3 out of 50
epoch:  90
[Epoch 91, Batch 10] loss: 0.206
epoch:  91 val_f1:  0.7233618940391454 val_auroc:  0.7739322533136966 val_auprc:  0.8822011058072357
EarlyStopping counter: 4 out of 50
epoch:  91
[Epoch 92, Batch 10] loss: 0.228
epoch:  92 val_f1:  0.743431836172277 val_auroc:  0.7746686303387333 val_auprc:  0.882184542829951
EarlyStopping counter: 5 out of 50
epoch:  92
[Epoch 93, Batch 10] loss: 0.202
epoch:  93 val_f1:  0.7367608586927249 val_auroc:  0.7746686303387335 val_auprc:  0.8821573512442391
EarlyStopping counter: 6 out of 50
epoch:  93
[Epoch 94, Batch 10] loss: 0.209
epoch:  94 val_f1:  0.743431836172277 val_auroc:  0.7756504663721159 val_auprc:  0.8824851173863619
EarlyStopping counter: 7 out of 50
epoch:  94
[Epoch 95, Batch 10] loss: 0.209
epoch:  95 val_f1:  0.743431836172277 val_auroc:  0.7788414334806087 val_auprc:  0.8841292027942176
EarlyStopping counter: 8 out of 50
epoch:  95
[Epoch 96, Batch 10] loss: 0.224
epoch:  96 val_f1:  0.7362024088594293 val_auroc:  0.7788414334806087 val_auprc:  0.884268205039764
EarlyStopping counter: 9 out of 50
epoch:  96
[Epoch 97, Batch 10] loss: 0.210
epoch:  97 val_f1:  0.7367608586927249 val_auroc:  0.7741777123220422 val_auprc:  0.8809324581626581
EarlyStopping counter: 10 out of 50
epoch:  97
[Epoch 98, Batch 10] loss: 0.215
epoch:  98 val_f1:  0.7289242247644242 val_auroc:  0.7778595974472263 val_auprc:  0.883646523186964
EarlyStopping counter: 11 out of 50
epoch:  98
[Epoch 99, Batch 10] loss: 0.206
epoch:  99 val_f1:  0.7367608586927249 val_auroc:  0.7773686794305351 val_auprc:  0.883255971550736
EarlyStopping counter: 12 out of 50
epoch:  99
[Epoch 100, Batch 10] loss: 0.216
epoch:  100 val_f1:  0.7289242247644242 val_auroc:  0.7776141384388807 val_auprc:  0.8834132503300016
EarlyStopping counter: 13 out of 50
epoch:  100
[Epoch 101, Batch 10] loss: 0.203
epoch:  101 val_f1:  0.7289242247644242 val_auroc:  0.7795778105056456 val_auprc:  0.8844709573260752
EarlyStopping counter: 14 out of 50
epoch:  101
[Epoch 102, Batch 10] loss: 0.215
epoch:  102 val_f1:  0.7367608586927249 val_auroc:  0.7766323024054983 val_auprc:  0.8822404036586695
EarlyStopping counter: 15 out of 50
epoch:  102
[Epoch 103, Batch 10] loss: 0.212
epoch:  103 val_f1:  0.7362024088594293 val_auroc:  0.7773686794305351 val_auprc:  0.8836657420042455
EarlyStopping counter: 16 out of 50
epoch:  103
[Epoch 104, Batch 10] loss: 0.197
epoch:  104 val_f1:  0.743431836172277 val_auroc:  0.7773686794305351 val_auprc:  0.8831730171130141
EarlyStopping counter: 17 out of 50
epoch:  104
[Epoch 105, Batch 10] loss: 0.207
epoch:  105 val_f1:  0.7281499969472504 val_auroc:  0.7795778105056456 val_auprc:  0.8848201419962483
EarlyStopping counter: 18 out of 50
epoch:  105
[Epoch 106, Batch 10] loss: 0.210
epoch:  106 val_f1:  0.7362024088594293 val_auroc:  0.7751595483554247 val_auprc:  0.882127729326328
EarlyStopping counter: 19 out of 50
epoch:  106
[Epoch 107, Batch 10] loss: 0.213
epoch:  107 val_f1:  0.7281499969472504 val_auroc:  0.7771232204221894 val_auprc:  0.8830688063031442
EarlyStopping counter: 20 out of 50
epoch:  107
[Epoch 108, Batch 10] loss: 0.207
epoch:  108 val_f1:  0.7289242247644242 val_auroc:  0.7744231713303878 val_auprc:  0.8819083312212099
EarlyStopping counter: 21 out of 50
epoch:  108
[Epoch 109, Batch 10] loss: 0.197
epoch:  109 val_f1:  0.735514445586388 val_auroc:  0.7758959253804614 val_auprc:  0.8825132416648358
EarlyStopping counter: 22 out of 50
epoch:  109
[Epoch 110, Batch 10] loss: 0.196
epoch:  110 val_f1:  0.7362024088594293 val_auroc:  0.7739322533136966 val_auprc:  0.8817596835193358
EarlyStopping counter: 23 out of 50
epoch:  110
[Epoch 111, Batch 10] loss: 0.208
epoch:  111 val_f1:  0.7362024088594293 val_auroc:  0.776141384388807 val_auprc:  0.8831356540539094
EarlyStopping counter: 24 out of 50
epoch:  111
[Epoch 112, Batch 10] loss: 0.205
epoch:  112 val_f1:  0.730071543320129 val_auroc:  0.7736867943053511 val_auprc:  0.8815701964303531
EarlyStopping counter: 25 out of 50
epoch:  112
[Epoch 113, Batch 10] loss: 0.204
epoch:  113 val_f1:  0.7281499969472504 val_auroc:  0.7781050564555719 val_auprc:  0.8839074998422978
EarlyStopping counter: 26 out of 50
epoch:  113
[Epoch 114, Batch 10] loss: 0.214
epoch:  114 val_f1:  0.7281499969472504 val_auroc:  0.7785959744722631 val_auprc:  0.8847160147520547
EarlyStopping counter: 27 out of 50
epoch:  114
[Epoch 115, Batch 10] loss: 0.188
epoch:  115 val_f1:  0.7362024088594293 val_auroc:  0.7766323024054983 val_auprc:  0.8834450425590221
EarlyStopping counter: 28 out of 50
epoch:  115
[Epoch 116, Batch 10] loss: 0.203
epoch:  116 val_f1:  0.7281499969472504 val_auroc:  0.7795778105056456 val_auprc:  0.885741370715755
EarlyStopping counter: 29 out of 50
epoch:  116
[Epoch 117, Batch 10] loss: 0.181
epoch:  117 val_f1:  0.7362024088594293 val_auroc:  0.7776141384388807 val_auprc:  0.8844699918266234
EarlyStopping counter: 30 out of 50
epoch:  117
[Epoch 118, Batch 10] loss: 0.199
epoch:  118 val_f1:  0.7281499969472504 val_auroc:  0.7790868924889544 val_auprc:  0.8857611291658296
EarlyStopping counter: 31 out of 50
epoch:  118
[Epoch 119, Batch 10] loss: 0.190
epoch:  119 val_f1:  0.7362024088594293 val_auroc:  0.777368679430535 val_auprc:  0.8843018072366532
EarlyStopping counter: 32 out of 50
epoch:  119
[Epoch 120, Batch 10] loss: 0.198
epoch:  120 val_f1:  0.7281499969472504 val_auroc:  0.7803141875306824 val_auprc:  0.8862209772660845
EarlyStopping counter: 33 out of 50
epoch:  120
[Epoch 121, Batch 10] loss: 0.192
epoch:  121 val_f1:  0.7367608586927249 val_auroc:  0.7746686303387335 val_auprc:  0.882808584626372
EarlyStopping counter: 34 out of 50
epoch:  121
[Epoch 122, Batch 10] loss: 0.218
epoch:  122 val_f1:  0.7281499969472504 val_auroc:  0.7783505154639175 val_auprc:  0.8848844584677718
EarlyStopping counter: 35 out of 50
epoch:  122
[Epoch 123, Batch 10] loss: 0.188
epoch:  123 val_f1:  0.7281499969472504 val_auroc:  0.7768777614138439 val_auprc:  0.8841612779021626
EarlyStopping counter: 36 out of 50
epoch:  123
[Epoch 124, Batch 10] loss: 0.199
epoch:  124 val_f1:  0.7289242247644242 val_auroc:  0.7768777614138439 val_auprc:  0.8840305446830798
EarlyStopping counter: 37 out of 50
epoch:  124
[Epoch 125, Batch 10] loss: 0.180
epoch:  125 val_f1:  0.7362024088594293 val_auroc:  0.7783505154639175 val_auprc:  0.88521066796441
EarlyStopping counter: 38 out of 50
epoch:  125
[Epoch 126, Batch 10] loss: 0.201
epoch:  126 val_f1:  0.7281499969472504 val_auroc:  0.7803141875306824 val_auprc:  0.8865219173568868
EarlyStopping counter: 39 out of 50
epoch:  126
[Epoch 127, Batch 10] loss: 0.193
epoch:  127 val_f1:  0.7428255465713769 val_auroc:  0.7800687285223367 val_auprc:  0.8874743936691755
EarlyStopping counter: 40 out of 50
epoch:  127
[Epoch 128, Batch 10] loss: 0.177
epoch:  128 val_f1:  0.7281499969472504 val_auroc:  0.7783505154639176 val_auprc:  0.8856618980240163
EarlyStopping counter: 41 out of 50
epoch:  128
[Epoch 129, Batch 10] loss: 0.180
epoch:  129 val_f1:  0.7281499969472504 val_auroc:  0.780559646539028 val_auprc:  0.8873283613515268
EarlyStopping counter: 42 out of 50
epoch:  129
[Epoch 130, Batch 10] loss: 0.199
epoch:  130 val_f1:  0.7402181480621955 val_auroc:  0.7803141875306824 val_auprc:  0.8868910418025019
EarlyStopping counter: 43 out of 50
epoch:  130
[Epoch 131, Batch 10] loss: 0.187
epoch:  131 val_f1:  0.735514445586388 val_auroc:  0.7771232204221895 val_auprc:  0.8842452931997693
EarlyStopping counter: 44 out of 50
epoch:  131
[Epoch 132, Batch 10] loss: 0.186
epoch:  132 val_f1:  0.7281499969472504 val_auroc:  0.7795778105056456 val_auprc:  0.8863923929405038
EarlyStopping counter: 45 out of 50
epoch:  132
[Epoch 133, Batch 10] loss: 0.192
epoch:  133 val_f1:  0.735514445586388 val_auroc:  0.7778595974472263 val_auprc:  0.8855837515087621
EarlyStopping counter: 46 out of 50
epoch:  133
[Epoch 134, Batch 10] loss: 0.176
epoch:  134 val_f1:  0.7346924658075737 val_auroc:  0.7793323514973 val_auprc:  0.8870093118126253
EarlyStopping counter: 47 out of 50
epoch:  134
[Epoch 135, Batch 10] loss: 0.178
epoch:  135 val_f1:  0.7281499969472504 val_auroc:  0.7778595974472263 val_auprc:  0.8850775453429387
EarlyStopping counter: 48 out of 50
epoch:  135
[Epoch 136, Batch 10] loss: 0.182
epoch:  136 val_f1:  0.7281499969472504 val_auroc:  0.7781050564555719 val_auprc:  0.8855162376091559
EarlyStopping counter: 49 out of 50
epoch:  136
[Epoch 137, Batch 10] loss: 0.183
epoch:  137 val_f1:  0.7281499969472504 val_auroc:  0.7785959744722633 val_auprc:  0.8852539258610792
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  777.7698955535889
{'time_elapsed': [777.7698955535889], 'epoch': [136], 'fold': [2], 'f1_train': [0.8811295002916216], 'auroc_train': [0.9618450501272343], 'auprc_train': [0.9836446643687775], 'f1_test': [0.7281499969472504], 'auroc_test': [0.7785959744722633], 'auprc_test': [0.8852539258610792]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [32, 1]                   --
├─Sequential: 1-1                        [32, 1]                   --
│    └─Conv1d: 2-1                       [32, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [32, 1024, 427]           2,048
│    └─Tanh: 2-3                         [32, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [32, 1024, 142]           --
│    └─Dropout: 2-5                      [32, 1024, 142]           --
│    └─Flatten: 2-6                      [32, 145408]              --
│    └─Linear: 2-7                       [32, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.16
Forward/backward pass size (MB): 223.87
Params size (MB): 0.61
Estimated Total Size (MB): 224.64
==========================================================================================
tensor(0.4369)
epoch:  0
[Epoch 1, Batch 10] loss: 0.456
epoch:  1 val_f1:  0.6399060469211281 val_auroc:  0.6843507751937984 val_auprc:  0.8031535648475389
epoch:  1
[Epoch 2, Batch 10] loss: 0.410
epoch:  2 val_f1:  0.6836332487073328 val_auroc:  0.7056686046511628 val_auprc:  0.8149319390839902
Validation loss improved to 2.016351
epoch:  2
[Epoch 3, Batch 10] loss: 0.404
epoch:  3 val_f1:  0.7052780852241284 val_auroc:  0.711482558139535 val_auprc:  0.8216385559109554
Validation loss improved to 1.995499
epoch:  3
[Epoch 4, Batch 10] loss: 0.390
epoch:  4 val_f1:  0.6370658814381256 val_auroc:  0.7262596899224807 val_auprc:  0.8444642408846704
Validation loss improved to 1.976216
epoch:  4
[Epoch 5, Batch 10] loss: 0.397
epoch:  5 val_f1:  0.6525437877546064 val_auroc:  0.7296511627906976 val_auprc:  0.8505277971559533
Validation loss improved to 1.954517
epoch:  5
[Epoch 6, Batch 10] loss: 0.400
epoch:  6 val_f1:  0.7408174730364365 val_auroc:  0.7357073643410852 val_auprc:  0.8564935334993842
Validation loss improved to 1.937257
epoch:  6
[Epoch 7, Batch 10] loss: 0.387
epoch:  7 val_f1:  0.7473812159063956 val_auroc:  0.7453972868217055 val_auprc:  0.8662541009902689
Validation loss improved to 1.919669
epoch:  7
[Epoch 8, Batch 10] loss: 0.381
epoch:  8 val_f1:  0.6602450481086705 val_auroc:  0.7577519379844961 val_auprc:  0.8801791562174874
Validation loss improved to 1.899563
epoch:  8
[Epoch 9, Batch 10] loss: 0.382
epoch:  9 val_f1:  0.7361362899070663 val_auroc:  0.7630813953488371 val_auprc:  0.8841794549335147
Validation loss improved to 1.881083
epoch:  9
[Epoch 10, Batch 10] loss: 0.372
epoch:  10 val_f1:  0.7539369712168144 val_auroc:  0.7686531007751939 val_auprc:  0.8880651317512229
Validation loss improved to 1.866018
epoch:  10
[Epoch 11, Batch 10] loss: 0.376
epoch:  11 val_f1:  0.7548273393587915 val_auroc:  0.777858527131783 val_auprc:  0.895036543184401
Validation loss improved to 1.849610
epoch:  11
[Epoch 12, Batch 10] loss: 0.368
epoch:  12 val_f1:  0.7529139722223964 val_auroc:  0.7863372093023256 val_auprc:  0.9014101725238829
Validation loss improved to 1.836684
epoch:  12
[Epoch 13, Batch 10] loss: 0.346
epoch:  13 val_f1:  0.7571561248111338 val_auroc:  0.7885174418604651 val_auprc:  0.9045000670211555
Validation loss improved to 1.814777
epoch:  13
[Epoch 14, Batch 10] loss: 0.362
epoch:  14 val_f1:  0.7634619577065621 val_auroc:  0.7948158914728681 val_auprc:  0.907426643240548
Validation loss improved to 1.802956
epoch:  14
[Epoch 15, Batch 10] loss: 0.348
epoch:  15 val_f1:  0.7688372056811462 val_auroc:  0.7943313953488371 val_auprc:  0.9079561826393518
Validation loss improved to 1.788852
epoch:  15
[Epoch 16, Batch 10] loss: 0.352
epoch:  16 val_f1:  0.7440073473136385 val_auroc:  0.7955426356589147 val_auprc:  0.9078560483287749
Validation loss improved to 1.777923
epoch:  16
[Epoch 17, Batch 10] loss: 0.354
epoch:  17 val_f1:  0.7529139722223964 val_auroc:  0.7996608527131783 val_auprc:  0.9107704533626575
Validation loss improved to 1.766335
epoch:  17
[Epoch 18, Batch 10] loss: 0.343
epoch:  18 val_f1:  0.7840893588200424 val_auroc:  0.8015988372093023 val_auprc:  0.9127824461611307
Validation loss improved to 1.747171
epoch:  18
[Epoch 19, Batch 10] loss: 0.332
epoch:  19 val_f1:  0.7614155928004849 val_auroc:  0.8011143410852712 val_auprc:  0.9126304925285824
Validation loss improved to 1.737867
epoch:  19
[Epoch 20, Batch 10] loss: 0.311
epoch:  20 val_f1:  0.7768458491633659 val_auroc:  0.8013565891472869 val_auprc:  0.9128116923534446
Validation loss improved to 1.722923
epoch:  20
[Epoch 21, Batch 10] loss: 0.343
epoch:  21 val_f1:  0.7701596400342386 val_auroc:  0.80765503875969 val_auprc:  0.9166515105192592
Validation loss improved to 1.711863
epoch:  21
[Epoch 22, Batch 10] loss: 0.329
epoch:  22 val_f1:  0.7735780520043992 val_auroc:  0.8066860465116279 val_auprc:  0.9161910384875445
Validation loss improved to 1.708563
epoch:  22
[Epoch 23, Batch 10] loss: 0.325
epoch:  23 val_f1:  0.7762051583223217 val_auroc:  0.8069282945736432 val_auprc:  0.916512860263661
Validation loss improved to 1.691015
epoch:  23
[Epoch 24, Batch 10] loss: 0.315
epoch:  24 val_f1:  0.7701596400342386 val_auroc:  0.8086240310077518 val_auprc:  0.9172406588122738
Validation loss improved to 1.677586
epoch:  24
[Epoch 25, Batch 10] loss: 0.321
epoch:  25 val_f1:  0.7877294237541244 val_auroc:  0.8091085271317829 val_auprc:  0.9170839051661092
Validation loss improved to 1.677397
epoch:  25
[Epoch 26, Batch 10] loss: 0.312
epoch:  26 val_f1:  0.7711885993597467 val_auroc:  0.8086240310077519 val_auprc:  0.9169730647186503
Validation loss improved to 1.673882
epoch:  26
[Epoch 27, Batch 10] loss: 0.323
epoch:  27 val_f1:  0.7679977157187104 val_auroc:  0.8117732558139535 val_auprc:  0.9188707014344597
Validation loss improved to 1.656266
epoch:  27
[Epoch 28, Batch 10] loss: 0.303
epoch:  28 val_f1:  0.7695564219015847 val_auroc:  0.8156492248062015 val_auprc:  0.9205740170777024
Validation loss improved to 1.640299
epoch:  28
[Epoch 29, Batch 10] loss: 0.314
epoch:  29 val_f1:  0.7745758989478168 val_auroc:  0.8151647286821705 val_auprc:  0.9198555641658872
EarlyStopping counter: 1 out of 50
epoch:  29
[Epoch 30, Batch 10] loss: 0.308
epoch:  30 val_f1:  0.7762051583223217 val_auroc:  0.8146802325581396 val_auprc:  0.9193335144340419
Validation loss improved to 1.627115
epoch:  30
[Epoch 31, Batch 10] loss: 0.322
epoch:  31 val_f1:  0.7724509753899008 val_auroc:  0.815406976744186 val_auprc:  0.9191816806837645
EarlyStopping counter: 1 out of 50
epoch:  31
[Epoch 32, Batch 10] loss: 0.312
epoch:  32 val_f1:  0.7695564219015847 val_auroc:  0.8158914728682171 val_auprc:  0.9198396776585213
Validation loss improved to 1.609608
epoch:  32
[Epoch 33, Batch 10] loss: 0.285
epoch:  33 val_f1:  0.7801238118631262 val_auroc:  0.8168604651162791 val_auprc:  0.9198324910234312
EarlyStopping counter: 1 out of 50
epoch:  33
[Epoch 34, Batch 10] loss: 0.298
epoch:  34 val_f1:  0.7762051583223217 val_auroc:  0.8171027131782945 val_auprc:  0.9196660891243473
Validation loss improved to 1.598367
epoch:  34
[Epoch 35, Batch 10] loss: 0.308
epoch:  35 val_f1:  0.7811523753969797 val_auroc:  0.8185562015503877 val_auprc:  0.9199498531566868
EarlyStopping counter: 1 out of 50
epoch:  35
[Epoch 36, Batch 10] loss: 0.308
epoch:  36 val_f1:  0.7811523753969797 val_auroc:  0.818313953488372 val_auprc:  0.9202916411690274
Validation loss improved to 1.590218
epoch:  36
[Epoch 37, Batch 10] loss: 0.284
epoch:  37 val_f1:  0.7811523753969797 val_auroc:  0.8180717054263565 val_auprc:  0.9204133969734865
Validation loss improved to 1.583985
epoch:  37
[Epoch 38, Batch 10] loss: 0.294
epoch:  38 val_f1:  0.7735780520043992 val_auroc:  0.8224321705426356 val_auprc:  0.9222244231534628
Validation loss improved to 1.580318
epoch:  38
[Epoch 39, Batch 10] loss: 0.289
epoch:  39 val_f1:  0.7762051583223217 val_auroc:  0.8234011627906977 val_auprc:  0.9231398254054632
Validation loss improved to 1.567208
epoch:  39
[Epoch 40, Batch 10] loss: 0.298
epoch:  40 val_f1:  0.7735780520043992 val_auroc:  0.8221899224806203 val_auprc:  0.9222553976629049
Validation loss improved to 1.566251
epoch:  40
[Epoch 41, Batch 10] loss: 0.297
epoch:  41 val_f1:  0.7659382513381667 val_auroc:  0.8238856589147286 val_auprc:  0.9230733406845602
Validation loss improved to 1.564032
epoch:  41
[Epoch 42, Batch 10] loss: 0.284
epoch:  42 val_f1:  0.7768458491633659 val_auroc:  0.8255813953488372 val_auprc:  0.924027195578174
Validation loss improved to 1.545426
epoch:  42
[Epoch 43, Batch 10] loss: 0.287
epoch:  43 val_f1:  0.7659382513381667 val_auroc:  0.8234011627906976 val_auprc:  0.9221977322618677
EarlyStopping counter: 1 out of 50
epoch:  43
[Epoch 44, Batch 10] loss: 0.286
epoch:  44 val_f1:  0.7745758989478168 val_auroc:  0.8255813953488372 val_auprc:  0.9239988362301355
Validation loss improved to 1.541157
epoch:  44
[Epoch 45, Batch 10] loss: 0.291
epoch:  45 val_f1:  0.7724509753899008 val_auroc:  0.8243701550387597 val_auprc:  0.9227105499365851
EarlyStopping counter: 1 out of 50
epoch:  45
[Epoch 46, Batch 10] loss: 0.305
epoch:  46 val_f1:  0.7659382513381667 val_auroc:  0.8253391472868217 val_auprc:  0.9232079128442774
Validation loss improved to 1.540325
epoch:  46
[Epoch 47, Batch 10] loss: 0.285
epoch:  47 val_f1:  0.7659382513381667 val_auroc:  0.8277616279069768 val_auprc:  0.9242096735540447
EarlyStopping counter: 1 out of 50
epoch:  47
[Epoch 48, Batch 10] loss: 0.284
epoch:  48 val_f1:  0.7594266802546743 val_auroc:  0.8272771317829457 val_auprc:  0.9237638136174315
Validation loss improved to 1.531137
epoch:  48
[Epoch 49, Batch 10] loss: 0.277
epoch:  49 val_f1:  0.7828470720035011 val_auroc:  0.8270348837209301 val_auprc:  0.924192537412156
Validation loss improved to 1.516126
epoch:  49
[Epoch 50, Batch 10] loss: 0.286
epoch:  50 val_f1:  0.7504468335444003 val_auroc:  0.8284883720930233 val_auprc:  0.9242989116516772
EarlyStopping counter: 1 out of 50
epoch:  50
[Epoch 51, Batch 10] loss: 0.269
epoch:  51 val_f1:  0.7659382513381667 val_auroc:  0.8277616279069767 val_auprc:  0.9238313966706541
EarlyStopping counter: 2 out of 50
epoch:  51
[Epoch 52, Batch 10] loss: 0.287
epoch:  52 val_f1:  0.7568878868197308 val_auroc:  0.8296996124031008 val_auprc:  0.9247406013542387
EarlyStopping counter: 3 out of 50
epoch:  52
[Epoch 53, Batch 10] loss: 0.274
epoch:  53 val_f1:  0.767033173809688 val_auroc:  0.8296996124031008 val_auprc:  0.9246572876453675
Validation loss improved to 1.505997
epoch:  53
[Epoch 54, Batch 10] loss: 0.277
epoch:  54 val_f1:  0.7582291613517698 val_auroc:  0.8299418604651163 val_auprc:  0.9245058652977888
EarlyStopping counter: 1 out of 50
epoch:  54
[Epoch 55, Batch 10] loss: 0.278
epoch:  55 val_f1:  0.7504468335444003 val_auroc:  0.8299418604651162 val_auprc:  0.9243694538769495
EarlyStopping counter: 2 out of 50
epoch:  55
[Epoch 56, Batch 10] loss: 0.265
epoch:  56 val_f1:  0.7659382513381667 val_auroc:  0.8292151162790697 val_auprc:  0.9240543727028712
EarlyStopping counter: 3 out of 50
epoch:  56
[Epoch 57, Batch 10] loss: 0.257
epoch:  57 val_f1:  0.7594266802546743 val_auroc:  0.8301841085271318 val_auprc:  0.9247812471118122
Validation loss improved to 1.497169
epoch:  57
[Epoch 58, Batch 10] loss: 0.264
epoch:  58 val_f1:  0.767033173809688 val_auroc:  0.8306686046511628 val_auprc:  0.925055475501006
Validation loss improved to 1.496360
epoch:  58
[Epoch 59, Batch 10] loss: 0.263
epoch:  59 val_f1:  0.767033173809688 val_auroc:  0.8311531007751938 val_auprc:  0.9253380280608436
Validation loss improved to 1.487918
epoch:  59
[Epoch 60, Batch 10] loss: 0.284
epoch:  60 val_f1:  0.767033173809688 val_auroc:  0.8313953488372093 val_auprc:  0.9255612440178523
Validation loss improved to 1.485619
epoch:  60
[Epoch 61, Batch 10] loss: 0.265
epoch:  61 val_f1:  0.7582291613517698 val_auroc:  0.8313953488372093 val_auprc:  0.9254481910678077
EarlyStopping counter: 1 out of 50
epoch:  61
[Epoch 62, Batch 10] loss: 0.265
epoch:  62 val_f1:  0.767033173809688 val_auroc:  0.8323643410852712 val_auprc:  0.9259456197479723
Validation loss improved to 1.481077
epoch:  62
[Epoch 63, Batch 10] loss: 0.261
epoch:  63 val_f1:  0.7820584602206068 val_auroc:  0.8326065891472869 val_auprc:  0.9259223005567361
Validation loss improved to 1.470685
epoch:  63
[Epoch 64, Batch 10] loss: 0.266
epoch:  64 val_f1:  0.7594266802546743 val_auroc:  0.8326065891472868 val_auprc:  0.9259450677682564
EarlyStopping counter: 1 out of 50
epoch:  64
[Epoch 65, Batch 10] loss: 0.260
epoch:  65 val_f1:  0.767033173809688 val_auroc:  0.8335755813953488 val_auprc:  0.9264395644795156
EarlyStopping counter: 2 out of 50
epoch:  65
[Epoch 66, Batch 10] loss: 0.254
epoch:  66 val_f1:  0.767033173809688 val_auroc:  0.8338178294573643 val_auprc:  0.9268314242104838
Validation loss improved to 1.468439
epoch:  66
[Epoch 67, Batch 10] loss: 0.260
epoch:  67 val_f1:  0.7745758989478168 val_auroc:  0.8338178294573643 val_auprc:  0.9266139238044631
EarlyStopping counter: 1 out of 50
epoch:  67
[Epoch 68, Batch 10] loss: 0.260
epoch:  68 val_f1:  0.7745758989478168 val_auroc:  0.8330910852713178 val_auprc:  0.9265333916172813
Validation loss improved to 1.459977
epoch:  68
[Epoch 69, Batch 10] loss: 0.246
epoch:  69 val_f1:  0.7745758989478168 val_auroc:  0.8335755813953489 val_auprc:  0.926854580028749
Validation loss improved to 1.455636
epoch:  69
[Epoch 70, Batch 10] loss: 0.259
epoch:  70 val_f1:  0.7594266802546743 val_auroc:  0.8340600775193798 val_auprc:  0.9270159223501256
EarlyStopping counter: 1 out of 50
epoch:  70
[Epoch 71, Batch 10] loss: 0.256
epoch:  71 val_f1:  0.7820584602206068 val_auroc:  0.834544573643411 val_auprc:  0.9276675837974391
Validation loss improved to 1.451571
epoch:  71
[Epoch 72, Batch 10] loss: 0.235
epoch:  72 val_f1:  0.7745758989478168 val_auroc:  0.8350290697674418 val_auprc:  0.9276896077650649
EarlyStopping counter: 1 out of 50
epoch:  72
[Epoch 73, Batch 10] loss: 0.249
epoch:  73 val_f1:  0.7745758989478168 val_auroc:  0.8347868217054263 val_auprc:  0.9273481248500861
Validation loss improved to 1.450173
epoch:  73
[Epoch 74, Batch 10] loss: 0.252
epoch:  74 val_f1:  0.7659382513381667 val_auroc:  0.8338178294573644 val_auprc:  0.9270995539249784
EarlyStopping counter: 1 out of 50
epoch:  74
[Epoch 75, Batch 10] loss: 0.235
epoch:  75 val_f1:  0.7745758989478168 val_auroc:  0.8347868217054264 val_auprc:  0.9275877821341743
EarlyStopping counter: 2 out of 50
epoch:  75
[Epoch 76, Batch 10] loss: 0.251
epoch:  76 val_f1:  0.7659382513381667 val_auroc:  0.8350290697674418 val_auprc:  0.9278785505130025
EarlyStopping counter: 3 out of 50
epoch:  76
[Epoch 77, Batch 10] loss: 0.249
epoch:  77 val_f1:  0.7659382513381667 val_auroc:  0.8352713178294574 val_auprc:  0.9277927304864413
EarlyStopping counter: 4 out of 50
epoch:  77
[Epoch 78, Batch 10] loss: 0.229
epoch:  78 val_f1:  0.7659382513381667 val_auroc:  0.8347868217054264 val_auprc:  0.928004939090969
EarlyStopping counter: 5 out of 50
epoch:  78
[Epoch 79, Batch 10] loss: 0.241
epoch:  79 val_f1:  0.7659382513381667 val_auroc:  0.8357558139534883 val_auprc:  0.928279407627372
EarlyStopping counter: 6 out of 50
epoch:  79
[Epoch 80, Batch 10] loss: 0.247
epoch:  80 val_f1:  0.767033173809688 val_auroc:  0.8359980620155038 val_auprc:  0.9284726685651558
Validation loss improved to 1.447500
epoch:  80
[Epoch 81, Batch 10] loss: 0.248
epoch:  81 val_f1:  0.7659382513381667 val_auroc:  0.8367248062015503 val_auprc:  0.9289382568474448
EarlyStopping counter: 1 out of 50
epoch:  81
[Epoch 82, Batch 10] loss: 0.248
epoch:  82 val_f1:  0.7659382513381667 val_auroc:  0.8372093023255813 val_auprc:  0.9287461455997886
EarlyStopping counter: 2 out of 50
epoch:  82
[Epoch 83, Batch 10] loss: 0.234
epoch:  83 val_f1:  0.7745758989478168 val_auroc:  0.836967054263566 val_auprc:  0.928826982471445
Validation loss improved to 1.437245
epoch:  83
[Epoch 84, Batch 10] loss: 0.244
epoch:  84 val_f1:  0.7659382513381667 val_auroc:  0.8379360465116279 val_auprc:  0.9290196225160023
EarlyStopping counter: 1 out of 50
epoch:  84
[Epoch 85, Batch 10] loss: 0.234
epoch:  85 val_f1:  0.767033173809688 val_auroc:  0.8376937984496123 val_auprc:  0.9291427270615933
Validation loss improved to 1.433712
epoch:  85
[Epoch 86, Batch 10] loss: 0.235
epoch:  86 val_f1:  0.7659382513381667 val_auroc:  0.8374515503875969 val_auprc:  0.9289477671030978
EarlyStopping counter: 1 out of 50
epoch:  86
[Epoch 87, Batch 10] loss: 0.225
epoch:  87 val_f1:  0.767033173809688 val_auroc:  0.8374515503875969 val_auprc:  0.9289948638476175
Validation loss improved to 1.432244
epoch:  87
[Epoch 88, Batch 10] loss: 0.244
epoch:  88 val_f1:  0.7659382513381667 val_auroc:  0.8398740310077519 val_auprc:  0.9302934652543569
EarlyStopping counter: 1 out of 50
epoch:  88
[Epoch 89, Batch 10] loss: 0.226
epoch:  89 val_f1:  0.7745758989478168 val_auroc:  0.8381782945736435 val_auprc:  0.9293391452040665
Validation loss improved to 1.424682
epoch:  89
[Epoch 90, Batch 10] loss: 0.235
epoch:  90 val_f1:  0.7659382513381667 val_auroc:  0.8391472868217055 val_auprc:  0.9299603817685553
EarlyStopping counter: 1 out of 50
epoch:  90
[Epoch 91, Batch 10] loss: 0.229
epoch:  91 val_f1:  0.7659382513381667 val_auroc:  0.8393895348837209 val_auprc:  0.930301814380095
EarlyStopping counter: 2 out of 50
epoch:  91
[Epoch 92, Batch 10] loss: 0.230
epoch:  92 val_f1:  0.7659382513381667 val_auroc:  0.8403585271317829 val_auprc:  0.9304692637038916
EarlyStopping counter: 3 out of 50
epoch:  92
[Epoch 93, Batch 10] loss: 0.237
epoch:  93 val_f1:  0.7724509753899008 val_auroc:  0.8403585271317829 val_auprc:  0.9304978367639068
EarlyStopping counter: 4 out of 50
epoch:  93
[Epoch 94, Batch 10] loss: 0.216
epoch:  94 val_f1:  0.7659382513381667 val_auroc:  0.8398740310077519 val_auprc:  0.9302514271588226
EarlyStopping counter: 5 out of 50
epoch:  94
[Epoch 95, Batch 10] loss: 0.223
epoch:  95 val_f1:  0.7724509753899008 val_auroc:  0.8398740310077519 val_auprc:  0.9302413762036457
EarlyStopping counter: 6 out of 50
epoch:  95
[Epoch 96, Batch 10] loss: 0.229
epoch:  96 val_f1:  0.7820584602206068 val_auroc:  0.8393895348837209 val_auprc:  0.9303426597769491
Validation loss improved to 1.412040
epoch:  96
[Epoch 97, Batch 10] loss: 0.224
epoch:  97 val_f1:  0.7789671954250403 val_auroc:  0.8403585271317829 val_auprc:  0.9303572573431702
EarlyStopping counter: 1 out of 50
epoch:  97
[Epoch 98, Batch 10] loss: 0.220
epoch:  98 val_f1:  0.7724509753899008 val_auroc:  0.8408430232558138 val_auprc:  0.9309530401008954
EarlyStopping counter: 2 out of 50
epoch:  98
[Epoch 99, Batch 10] loss: 0.220
epoch:  99 val_f1:  0.7724509753899008 val_auroc:  0.8410852713178294 val_auprc:  0.9309900269835932
EarlyStopping counter: 3 out of 50
epoch:  99
[Epoch 100, Batch 10] loss: 0.205
epoch:  100 val_f1:  0.7724509753899008 val_auroc:  0.8413275193798448 val_auprc:  0.9311994659117926
EarlyStopping counter: 4 out of 50
epoch:  100
[Epoch 101, Batch 10] loss: 0.232
epoch:  101 val_f1:  0.7820584602206068 val_auroc:  0.8403585271317829 val_auprc:  0.93123774563439
Validation loss improved to 1.402683
epoch:  101
[Epoch 102, Batch 10] loss: 0.220
epoch:  102 val_f1:  0.792019787311512 val_auroc:  0.8415697674418604 val_auprc:  0.931579938690227
EarlyStopping counter: 1 out of 50
epoch:  102
[Epoch 103, Batch 10] loss: 0.211
epoch:  103 val_f1:  0.7659382513381667 val_auroc:  0.8403585271317829 val_auprc:  0.9311359357415507
EarlyStopping counter: 2 out of 50
epoch:  103
[Epoch 104, Batch 10] loss: 0.213
epoch:  104 val_f1:  0.7724509753899008 val_auroc:  0.841812015503876 val_auprc:  0.9316584244876336
EarlyStopping counter: 3 out of 50
epoch:  104
[Epoch 105, Batch 10] loss: 0.207
epoch:  105 val_f1:  0.7724509753899008 val_auroc:  0.840843023255814 val_auprc:  0.9314745656229231
EarlyStopping counter: 4 out of 50
epoch:  105
[Epoch 106, Batch 10] loss: 0.207
epoch:  106 val_f1:  0.767033173809688 val_auroc:  0.840358527131783 val_auprc:  0.9312324852318051
Validation loss improved to 1.399446
epoch:  106
[Epoch 107, Batch 10] loss: 0.199
epoch:  107 val_f1:  0.7724509753899008 val_auroc:  0.841327519379845 val_auprc:  0.9320014214583614
EarlyStopping counter: 1 out of 50
epoch:  107
[Epoch 108, Batch 10] loss: 0.229
epoch:  108 val_f1:  0.7789671954250403 val_auroc:  0.8413275193798448 val_auprc:  0.9316598440716551
EarlyStopping counter: 2 out of 50
epoch:  108
[Epoch 109, Batch 10] loss: 0.227
epoch:  109 val_f1:  0.7789671954250403 val_auroc:  0.841812015503876 val_auprc:  0.9317176274005201
EarlyStopping counter: 3 out of 50
epoch:  109
[Epoch 110, Batch 10] loss: 0.208
epoch:  110 val_f1:  0.7724509753899008 val_auroc:  0.8427810077519381 val_auprc:  0.9327415964934362
EarlyStopping counter: 4 out of 50
epoch:  110
[Epoch 111, Batch 10] loss: 0.209
epoch:  111 val_f1:  0.7801238118631262 val_auroc:  0.842781007751938 val_auprc:  0.9320708443812311
EarlyStopping counter: 5 out of 50
epoch:  111
[Epoch 112, Batch 10] loss: 0.219
epoch:  112 val_f1:  0.7789671954250403 val_auroc:  0.8439922480620154 val_auprc:  0.9327747954426944
EarlyStopping counter: 6 out of 50
epoch:  112
[Epoch 113, Batch 10] loss: 0.196
epoch:  113 val_f1:  0.7801238118631262 val_auroc:  0.843265503875969 val_auprc:  0.932314556188163
EarlyStopping counter: 7 out of 50
epoch:  113
[Epoch 114, Batch 10] loss: 0.191
epoch:  114 val_f1:  0.7724509753899008 val_auroc:  0.8435077519379844 val_auprc:  0.9327142460527518
EarlyStopping counter: 8 out of 50
epoch:  114
[Epoch 115, Batch 10] loss: 0.210
epoch:  115 val_f1:  0.7789671954250403 val_auroc:  0.8425387596899225 val_auprc:  0.9321730014000255
EarlyStopping counter: 9 out of 50
epoch:  115
[Epoch 116, Batch 10] loss: 0.210
epoch:  116 val_f1:  0.7724509753899008 val_auroc:  0.842781007751938 val_auprc:  0.9322623083948294
Validation loss improved to 1.399043
epoch:  116
[Epoch 117, Batch 10] loss: 0.210
epoch:  117 val_f1:  0.767033173809688 val_auroc:  0.8430232558139535 val_auprc:  0.9328884251221168
Validation loss improved to 1.383718
epoch:  117
[Epoch 118, Batch 10] loss: 0.219
epoch:  118 val_f1:  0.7724509753899008 val_auroc:  0.842296511627907 val_auprc:  0.9325234834254903
EarlyStopping counter: 1 out of 50
epoch:  118
[Epoch 119, Batch 10] loss: 0.204
epoch:  119 val_f1:  0.792019787311512 val_auroc:  0.842781007751938 val_auprc:  0.932975150072783
EarlyStopping counter: 2 out of 50
epoch:  119
[Epoch 120, Batch 10] loss: 0.210
epoch:  120 val_f1:  0.7877294237541244 val_auroc:  0.8442344961240311 val_auprc:  0.9333249321303129
EarlyStopping counter: 3 out of 50
epoch:  120
[Epoch 121, Batch 10] loss: 0.210
epoch:  121 val_f1:  0.792019787311512 val_auroc:  0.844234496124031 val_auprc:  0.9333194382647328
EarlyStopping counter: 4 out of 50
epoch:  121
[Epoch 122, Batch 10] loss: 0.202
epoch:  122 val_f1:  0.7724509753899008 val_auroc:  0.844234496124031 val_auprc:  0.9334812608294295
EarlyStopping counter: 5 out of 50
epoch:  122
[Epoch 123, Batch 10] loss: 0.182
epoch:  123 val_f1:  0.7724509753899008 val_auroc:  0.8435077519379846 val_auprc:  0.9333185048030814
EarlyStopping counter: 6 out of 50
epoch:  123
[Epoch 124, Batch 10] loss: 0.216
epoch:  124 val_f1:  0.792019787311512 val_auroc:  0.84375 val_auprc:  0.9333679808229494
EarlyStopping counter: 7 out of 50
epoch:  124
[Epoch 125, Batch 10] loss: 0.217
epoch:  125 val_f1:  0.7801238118631262 val_auroc:  0.8425387596899225 val_auprc:  0.9331245877325645
EarlyStopping counter: 8 out of 50
epoch:  125
[Epoch 126, Batch 10] loss: 0.201
epoch:  126 val_f1:  0.792019787311512 val_auroc:  0.8430232558139534 val_auprc:  0.9332708827684557
EarlyStopping counter: 9 out of 50
epoch:  126
[Epoch 127, Batch 10] loss: 0.208
epoch:  127 val_f1:  0.7801238118631262 val_auroc:  0.843265503875969 val_auprc:  0.9333523866484139
EarlyStopping counter: 10 out of 50
epoch:  127
[Epoch 128, Batch 10] loss: 0.204
epoch:  128 val_f1:  0.792019787311512 val_auroc:  0.84375 val_auprc:  0.9334279957709146
EarlyStopping counter: 11 out of 50
epoch:  128
[Epoch 129, Batch 10] loss: 0.192
epoch:  129 val_f1:  0.792019787311512 val_auroc:  0.8452034883720931 val_auprc:  0.9341071263678069
EarlyStopping counter: 12 out of 50
epoch:  129
[Epoch 130, Batch 10] loss: 0.187
epoch:  130 val_f1:  0.7877294237541244 val_auroc:  0.8459302325581396 val_auprc:  0.9346119355176529
Validation loss improved to 1.373251
epoch:  130
[Epoch 131, Batch 10] loss: 0.195
epoch:  131 val_f1:  0.792019787311512 val_auroc:  0.8439922480620154 val_auprc:  0.933935410417452
EarlyStopping counter: 1 out of 50
epoch:  131
[Epoch 132, Batch 10] loss: 0.211
epoch:  132 val_f1:  0.792019787311512 val_auroc:  0.8454457364341086 val_auprc:  0.9344393856826121
EarlyStopping counter: 2 out of 50
epoch:  132
[Epoch 133, Batch 10] loss: 0.197
epoch:  133 val_f1:  0.7801238118631262 val_auroc:  0.8452034883720931 val_auprc:  0.9344097752131988
Validation loss improved to 1.372817
epoch:  133
[Epoch 134, Batch 10] loss: 0.201
epoch:  134 val_f1:  0.792019787311512 val_auroc:  0.8449612403100776 val_auprc:  0.9336748471284276
EarlyStopping counter: 1 out of 50
epoch:  134
[Epoch 135, Batch 10] loss: 0.200
epoch:  135 val_f1:  0.792019787311512 val_auroc:  0.846172480620155 val_auprc:  0.9347667672188671
EarlyStopping counter: 2 out of 50
epoch:  135
[Epoch 136, Batch 10] loss: 0.195
epoch:  136 val_f1:  0.7801238118631262 val_auroc:  0.8468992248062015 val_auprc:  0.9351853147710797
EarlyStopping counter: 3 out of 50
epoch:  136
[Epoch 137, Batch 10] loss: 0.194
epoch:  137 val_f1:  0.7841726618705036 val_auroc:  0.8464147286821706 val_auprc:  0.9347770454439929
EarlyStopping counter: 4 out of 50
epoch:  137
[Epoch 138, Batch 10] loss: 0.202
epoch:  138 val_f1:  0.792019787311512 val_auroc:  0.8478682170542635 val_auprc:  0.9357450127859179
EarlyStopping counter: 5 out of 50
epoch:  138
[Epoch 139, Batch 10] loss: 0.205
epoch:  139 val_f1:  0.7854893118997625 val_auroc:  0.8490794573643411 val_auprc:  0.9361115960462227
EarlyStopping counter: 6 out of 50
epoch:  139
[Epoch 140, Batch 10] loss: 0.202
epoch:  140 val_f1:  0.7854893118997625 val_auroc:  0.8476259689922481 val_auprc:  0.9357864910717759
EarlyStopping counter: 7 out of 50
epoch:  140
[Epoch 141, Batch 10] loss: 0.191
epoch:  141 val_f1:  0.792019787311512 val_auroc:  0.8473837209302325 val_auprc:  0.9359526948699628
EarlyStopping counter: 8 out of 50
epoch:  141
[Epoch 142, Batch 10] loss: 0.187
epoch:  142 val_f1:  0.7877294237541244 val_auroc:  0.8468992248062015 val_auprc:  0.9355740792528267
Validation loss improved to 1.365212
epoch:  142
[Epoch 143, Batch 10] loss: 0.190
epoch:  143 val_f1:  0.7841726618705036 val_auroc:  0.8468992248062015 val_auprc:  0.9354960328257514
EarlyStopping counter: 1 out of 50
epoch:  143
[Epoch 144, Batch 10] loss: 0.191
epoch:  144 val_f1:  0.7841726618705036 val_auroc:  0.8485949612403101 val_auprc:  0.9362625854599436
EarlyStopping counter: 2 out of 50
epoch:  144
[Epoch 145, Batch 10] loss: 0.183
epoch:  145 val_f1:  0.7866727894280321 val_auroc:  0.8485949612403101 val_auprc:  0.9363502024161372
Validation loss improved to 1.365094
epoch:  145
[Epoch 146, Batch 10] loss: 0.190
epoch:  146 val_f1:  0.7841726618705036 val_auroc:  0.8493217054263565 val_auprc:  0.9367092590093943
EarlyStopping counter: 1 out of 50
epoch:  146
[Epoch 147, Batch 10] loss: 0.168
epoch:  147 val_f1:  0.792019787311512 val_auroc:  0.850048449612403 val_auprc:  0.9368366077557212
EarlyStopping counter: 2 out of 50
epoch:  147
[Epoch 148, Batch 10] loss: 0.176
epoch:  148 val_f1:  0.7841726618705036 val_auroc:  0.850532945736434 val_auprc:  0.936958604671386
EarlyStopping counter: 3 out of 50
epoch:  148
[Epoch 149, Batch 10] loss: 0.190
epoch:  149 val_f1:  0.792019787311512 val_auroc:  0.8524709302325582 val_auprc:  0.9381906058475982
EarlyStopping counter: 4 out of 50
epoch:  149
[Epoch 150, Batch 10] loss: 0.186
epoch:  150 val_f1:  0.792019787311512 val_auroc:  0.8524709302325582 val_auprc:  0.9384223357549991
EarlyStopping counter: 5 out of 50
epoch:  150
[Epoch 151, Batch 10] loss: 0.167
epoch:  151 val_f1:  0.792019787311512 val_auroc:  0.8515019379844961 val_auprc:  0.9377388041974417
Validation loss improved to 1.364538
epoch:  151
[Epoch 152, Batch 10] loss: 0.186
epoch:  152 val_f1:  0.7841726618705036 val_auroc:  0.852955426356589 val_auprc:  0.9387154496014435
EarlyStopping counter: 1 out of 50
epoch:  152
[Epoch 153, Batch 10] loss: 0.194
epoch:  153 val_f1:  0.7932273763653603 val_auroc:  0.8529554263565892 val_auprc:  0.9388166766856921
Validation loss improved to 1.358376
epoch:  153
[Epoch 154, Batch 10] loss: 0.179
epoch:  154 val_f1:  0.7841726618705036 val_auroc:  0.8534399224806202 val_auprc:  0.9388669935342486
EarlyStopping counter: 1 out of 50
epoch:  154
[Epoch 155, Batch 10] loss: 0.171
epoch:  155 val_f1:  0.7841726618705036 val_auroc:  0.8524709302325582 val_auprc:  0.938546711376143
EarlyStopping counter: 2 out of 50
epoch:  155
[Epoch 156, Batch 10] loss: 0.188
epoch:  156 val_f1:  0.8008946034661633 val_auroc:  0.8524709302325582 val_auprc:  0.9384500977803503
Validation loss improved to 1.351945
epoch:  156
[Epoch 157, Batch 10] loss: 0.175
epoch:  157 val_f1:  0.792019787311512 val_auroc:  0.8534399224806201 val_auprc:  0.938823159574377
EarlyStopping counter: 1 out of 50
epoch:  157
[Epoch 158, Batch 10] loss: 0.173
epoch:  158 val_f1:  0.8008946034661633 val_auroc:  0.8536821705426356 val_auprc:  0.9388719396116005
EarlyStopping counter: 2 out of 50
epoch:  158
[Epoch 159, Batch 10] loss: 0.194
epoch:  159 val_f1:  0.7841726618705036 val_auroc:  0.8534399224806203 val_auprc:  0.9386160893615272
EarlyStopping counter: 3 out of 50
epoch:  159
[Epoch 160, Batch 10] loss: 0.179
epoch:  160 val_f1:  0.7841726618705036 val_auroc:  0.8534399224806202 val_auprc:  0.938876397714185
EarlyStopping counter: 4 out of 50
epoch:  160
[Epoch 161, Batch 10] loss: 0.181
epoch:  161 val_f1:  0.7841726618705036 val_auroc:  0.8529554263565892 val_auprc:  0.9386890275405491
EarlyStopping counter: 5 out of 50
epoch:  161
[Epoch 162, Batch 10] loss: 0.174
epoch:  162 val_f1:  0.7841726618705036 val_auroc:  0.8541666666666667 val_auprc:  0.9391234845850882
EarlyStopping counter: 6 out of 50
epoch:  162
[Epoch 163, Batch 10] loss: 0.184
epoch:  163 val_f1:  0.792019787311512 val_auroc:  0.8546511627906976 val_auprc:  0.9393217055307338
Validation loss improved to 1.351800
epoch:  163
[Epoch 164, Batch 10] loss: 0.177
epoch:  164 val_f1:  0.7841726618705036 val_auroc:  0.8546511627906976 val_auprc:  0.9394422522621028
EarlyStopping counter: 1 out of 50
epoch:  164
[Epoch 165, Batch 10] loss: 0.169
epoch:  165 val_f1:  0.7841726618705036 val_auroc:  0.8534399224806202 val_auprc:  0.9390204569309123
EarlyStopping counter: 2 out of 50
epoch:  165
[Epoch 166, Batch 10] loss: 0.166
epoch:  166 val_f1:  0.794309372388086 val_auroc:  0.8544089147286823 val_auprc:  0.9392487088851221
Validation loss improved to 1.341753
epoch:  166
[Epoch 167, Batch 10] loss: 0.165
epoch:  167 val_f1:  0.7841726618705036 val_auroc:  0.8544089147286822 val_auprc:  0.9393815149421381
EarlyStopping counter: 1 out of 50
epoch:  167
[Epoch 168, Batch 10] loss: 0.191
epoch:  168 val_f1:  0.7841726618705036 val_auroc:  0.8536821705426356 val_auprc:  0.9394423681512653
EarlyStopping counter: 2 out of 50
epoch:  168
[Epoch 169, Batch 10] loss: 0.172
epoch:  169 val_f1:  0.7841726618705036 val_auroc:  0.8539244186046512 val_auprc:  0.9393715403261947
EarlyStopping counter: 3 out of 50
epoch:  169
[Epoch 170, Batch 10] loss: 0.165
epoch:  170 val_f1:  0.7841726618705036 val_auroc:  0.8539244186046512 val_auprc:  0.9395392552531652
EarlyStopping counter: 4 out of 50
epoch:  170
[Epoch 171, Batch 10] loss: 0.176
epoch:  171 val_f1:  0.7841726618705036 val_auroc:  0.8529554263565892 val_auprc:  0.9390953999705572
EarlyStopping counter: 5 out of 50
epoch:  171
[Epoch 172, Batch 10] loss: 0.166
epoch:  172 val_f1:  0.794309372388086 val_auroc:  0.8541666666666667 val_auprc:  0.9395465226134333
Validation loss improved to 1.334962
epoch:  172
[Epoch 173, Batch 10] loss: 0.172
epoch:  173 val_f1:  0.7841726618705036 val_auroc:  0.8541666666666666 val_auprc:  0.9390988019480019
EarlyStopping counter: 1 out of 50
epoch:  173
[Epoch 174, Batch 10] loss: 0.174
epoch:  174 val_f1:  0.7841726618705036 val_auroc:  0.8539244186046512 val_auprc:  0.939180757385258
EarlyStopping counter: 2 out of 50
epoch:  174
[Epoch 175, Batch 10] loss: 0.157
epoch:  175 val_f1:  0.7841726618705036 val_auroc:  0.8536821705426357 val_auprc:  0.9394238180845268
EarlyStopping counter: 3 out of 50
epoch:  175
[Epoch 176, Batch 10] loss: 0.176
epoch:  176 val_f1:  0.7841726618705036 val_auroc:  0.8544089147286821 val_auprc:  0.9394229183827423
EarlyStopping counter: 4 out of 50
epoch:  176
[Epoch 177, Batch 10] loss: 0.170
epoch:  177 val_f1:  0.794309372388086 val_auroc:  0.8548934108527132 val_auprc:  0.9399783899852959
Validation loss improved to 1.331846
epoch:  177
[Epoch 178, Batch 10] loss: 0.172
epoch:  178 val_f1:  0.7841726618705036 val_auroc:  0.8556201550387597 val_auprc:  0.940316568759873
EarlyStopping counter: 1 out of 50
epoch:  178
[Epoch 179, Batch 10] loss: 0.170
epoch:  179 val_f1:  0.7841726618705036 val_auroc:  0.8551356589147286 val_auprc:  0.9403210015505861
EarlyStopping counter: 2 out of 50
epoch:  179
[Epoch 180, Batch 10] loss: 0.168
epoch:  180 val_f1:  0.7841726618705036 val_auroc:  0.8565891472868218 val_auprc:  0.9405046592529641
EarlyStopping counter: 3 out of 50
epoch:  180
[Epoch 181, Batch 10] loss: 0.159
epoch:  181 val_f1:  0.7841726618705036 val_auroc:  0.8561046511627907 val_auprc:  0.9401287533992371
EarlyStopping counter: 4 out of 50
epoch:  181
[Epoch 182, Batch 10] loss: 0.163
epoch:  182 val_f1:  0.7866727894280321 val_auroc:  0.8568313953488372 val_auprc:  0.9414379763365275
Validation loss improved to 1.327057
epoch:  182
[Epoch 183, Batch 10] loss: 0.154
epoch:  183 val_f1:  0.7841726618705036 val_auroc:  0.8563468992248062 val_auprc:  0.9407639876147269
EarlyStopping counter: 1 out of 50
epoch:  183
[Epoch 184, Batch 10] loss: 0.166
epoch:  184 val_f1:  0.7841726618705036 val_auroc:  0.8570736434108527 val_auprc:  0.9413865247566935
EarlyStopping counter: 2 out of 50
epoch:  184
[Epoch 185, Batch 10] loss: 0.154
epoch:  185 val_f1:  0.7841726618705036 val_auroc:  0.8563468992248062 val_auprc:  0.9407471663298577
EarlyStopping counter: 3 out of 50
epoch:  185
[Epoch 186, Batch 10] loss: 0.149
epoch:  186 val_f1:  0.7997900244397783 val_auroc:  0.8590116279069767 val_auprc:  0.9423194195458497
EarlyStopping counter: 4 out of 50
epoch:  186
[Epoch 187, Batch 10] loss: 0.161
epoch:  187 val_f1:  0.7841726618705036 val_auroc:  0.8565891472868217 val_auprc:  0.9404518016741352
EarlyStopping counter: 5 out of 50
epoch:  187
[Epoch 188, Batch 10] loss: 0.169
epoch:  188 val_f1:  0.7932273763653603 val_auroc:  0.8587693798449614 val_auprc:  0.9423068644836281
EarlyStopping counter: 6 out of 50
epoch:  188
[Epoch 189, Batch 10] loss: 0.148
epoch:  189 val_f1:  0.7841726618705036 val_auroc:  0.8568313953488372 val_auprc:  0.9412490433133394
EarlyStopping counter: 7 out of 50
epoch:  189
[Epoch 190, Batch 10] loss: 0.158
epoch:  190 val_f1:  0.7841726618705036 val_auroc:  0.8580426356589147 val_auprc:  0.941777885882755
EarlyStopping counter: 8 out of 50
epoch:  190
[Epoch 191, Batch 10] loss: 0.154
epoch:  191 val_f1:  0.7932273763653603 val_auroc:  0.8594961240310076 val_auprc:  0.942777841514882
EarlyStopping counter: 9 out of 50
epoch:  191
[Epoch 192, Batch 10] loss: 0.159
epoch:  192 val_f1:  0.7841726618705036 val_auroc:  0.8602228682170543 val_auprc:  0.94280418294714
EarlyStopping counter: 10 out of 50
epoch:  192
[Epoch 193, Batch 10] loss: 0.168
epoch:  193 val_f1:  0.7841726618705036 val_auroc:  0.8592538759689922 val_auprc:  0.9426608748084361
EarlyStopping counter: 11 out of 50
epoch:  193
[Epoch 194, Batch 10] loss: 0.155
epoch:  194 val_f1:  0.7932273763653603 val_auroc:  0.8590116279069767 val_auprc:  0.9424517833173396
Validation loss improved to 1.319352
epoch:  194
[Epoch 195, Batch 10] loss: 0.163
epoch:  195 val_f1:  0.7841726618705036 val_auroc:  0.8594961240310078 val_auprc:  0.9426281092037434
EarlyStopping counter: 1 out of 50
epoch:  195
[Epoch 196, Batch 10] loss: 0.141
epoch:  196 val_f1:  0.7932273763653603 val_auroc:  0.8599806201550387 val_auprc:  0.9428787290121419
EarlyStopping counter: 2 out of 50
epoch:  196
[Epoch 197, Batch 10] loss: 0.141
epoch:  197 val_f1:  0.7841726618705036 val_auroc:  0.8592538759689923 val_auprc:  0.9425884995720331
EarlyStopping counter: 3 out of 50
epoch:  197
[Epoch 198, Batch 10] loss: 0.161
epoch:  198 val_f1:  0.7841726618705036 val_auroc:  0.8599806201550388 val_auprc:  0.9428670743430839
EarlyStopping counter: 4 out of 50
epoch:  198
[Epoch 199, Batch 10] loss: 0.152
epoch:  199 val_f1:  0.7841726618705036 val_auroc:  0.8594961240310078 val_auprc:  0.9427089135550021
EarlyStopping counter: 5 out of 50
epoch:  199
[Epoch 200, Batch 10] loss: 0.154
epoch:  200 val_f1:  0.7841726618705036 val_auroc:  0.8594961240310077 val_auprc:  0.9428602471225138
EarlyStopping counter: 6 out of 50
epoch:  200
[Epoch 201, Batch 10] loss: 0.164
epoch:  201 val_f1:  0.7841726618705036 val_auroc:  0.8597383720930232 val_auprc:  0.9428443891937749
EarlyStopping counter: 7 out of 50
epoch:  201
[Epoch 202, Batch 10] loss: 0.161
epoch:  202 val_f1:  0.7841726618705036 val_auroc:  0.8592538759689923 val_auprc:  0.9427565185732167
EarlyStopping counter: 8 out of 50
epoch:  202
[Epoch 203, Batch 10] loss: 0.158
epoch:  203 val_f1:  0.7841726618705036 val_auroc:  0.8604651162790696 val_auprc:  0.9432640564225963
EarlyStopping counter: 9 out of 50
epoch:  203
[Epoch 204, Batch 10] loss: 0.165
epoch:  204 val_f1:  0.7841726618705036 val_auroc:  0.8621608527131783 val_auprc:  0.9436046688750851
EarlyStopping counter: 10 out of 50
epoch:  204
[Epoch 205, Batch 10] loss: 0.161
epoch:  205 val_f1:  0.7866727894280321 val_auroc:  0.8609496124031008 val_auprc:  0.9432617702552877
Validation loss improved to 1.311202
epoch:  205
[Epoch 206, Batch 10] loss: 0.151
epoch:  206 val_f1:  0.792019787311512 val_auroc:  0.8621608527131783 val_auprc:  0.9436753349630329
EarlyStopping counter: 1 out of 50
epoch:  206
[Epoch 207, Batch 10] loss: 0.157
epoch:  207 val_f1:  0.7841726618705036 val_auroc:  0.8626453488372093 val_auprc:  0.9438047224759061
EarlyStopping counter: 2 out of 50
epoch:  207
[Epoch 208, Batch 10] loss: 0.142
epoch:  208 val_f1:  0.7854893118997625 val_auroc:  0.8621608527131783 val_auprc:  0.9439228824705239
EarlyStopping counter: 3 out of 50
epoch:  208
[Epoch 209, Batch 10] loss: 0.142
epoch:  209 val_f1:  0.7841726618705036 val_auroc:  0.8636143410852715 val_auprc:  0.9442182093489644
EarlyStopping counter: 4 out of 50
epoch:  209
[Epoch 210, Batch 10] loss: 0.146
epoch:  210 val_f1:  0.7932273763653603 val_auroc:  0.8633720930232558 val_auprc:  0.9441616774064153
EarlyStopping counter: 5 out of 50
epoch:  210
[Epoch 211, Batch 10] loss: 0.149
epoch:  211 val_f1:  0.7841726618705036 val_auroc:  0.8614341085271318 val_auprc:  0.9435542922716307
EarlyStopping counter: 6 out of 50
epoch:  211
[Epoch 212, Batch 10] loss: 0.137
epoch:  212 val_f1:  0.7776763243674784 val_auroc:  0.8619186046511628 val_auprc:  0.9442848854622083
EarlyStopping counter: 7 out of 50
epoch:  212
[Epoch 213, Batch 10] loss: 0.150
epoch:  213 val_f1:  0.7841726618705036 val_auroc:  0.8636143410852714 val_auprc:  0.9446927831381102
EarlyStopping counter: 8 out of 50
epoch:  213
[Epoch 214, Batch 10] loss: 0.144
epoch:  214 val_f1:  0.7866727894280321 val_auroc:  0.8633720930232558 val_auprc:  0.9447236831586723
Validation loss improved to 1.305509
epoch:  214
[Epoch 215, Batch 10] loss: 0.149
epoch:  215 val_f1:  0.7841726618705036 val_auroc:  0.8638565891472868 val_auprc:  0.9448711594782653
EarlyStopping counter: 1 out of 50
epoch:  215
[Epoch 216, Batch 10] loss: 0.147
epoch:  216 val_f1:  0.7841726618705036 val_auroc:  0.8628875968992249 val_auprc:  0.9445861018892168
EarlyStopping counter: 2 out of 50
epoch:  216
[Epoch 217, Batch 10] loss: 0.153
epoch:  217 val_f1:  0.7776763243674784 val_auroc:  0.8631298449612403 val_auprc:  0.9445952227209222
EarlyStopping counter: 3 out of 50
epoch:  217
[Epoch 218, Batch 10] loss: 0.151
epoch:  218 val_f1:  0.7841726618705036 val_auroc:  0.8636143410852714 val_auprc:  0.9448536506873024
EarlyStopping counter: 4 out of 50
epoch:  218
[Epoch 219, Batch 10] loss: 0.138
epoch:  219 val_f1:  0.7932273763653603 val_auroc:  0.8626453488372092 val_auprc:  0.9445864517950583
EarlyStopping counter: 5 out of 50
epoch:  219
[Epoch 220, Batch 10] loss: 0.134
epoch:  220 val_f1:  0.7776763243674784 val_auroc:  0.8648255813953489 val_auprc:  0.9452378151027996
EarlyStopping counter: 6 out of 50
epoch:  220
[Epoch 221, Batch 10] loss: 0.142
epoch:  221 val_f1:  0.7841726618705036 val_auroc:  0.8648255813953489 val_auprc:  0.9449294666382959
EarlyStopping counter: 7 out of 50
epoch:  221
[Epoch 222, Batch 10] loss: 0.139
epoch:  222 val_f1:  0.7841726618705036 val_auroc:  0.8645833333333333 val_auprc:  0.9450592897905996
EarlyStopping counter: 8 out of 50
epoch:  222
[Epoch 223, Batch 10] loss: 0.138
epoch:  223 val_f1:  0.7854893118997625 val_auroc:  0.8633720930232558 val_auprc:  0.9448093845875611
EarlyStopping counter: 9 out of 50
epoch:  223
[Epoch 224, Batch 10] loss: 0.138
epoch:  224 val_f1:  0.7841726618705036 val_auroc:  0.8653100775193798 val_auprc:  0.9454485237347217
EarlyStopping counter: 10 out of 50
epoch:  224
[Epoch 225, Batch 10] loss: 0.134
epoch:  225 val_f1:  0.7841726618705036 val_auroc:  0.8657945736434108 val_auprc:  0.9456592625474567
EarlyStopping counter: 11 out of 50
epoch:  225
[Epoch 226, Batch 10] loss: 0.136
epoch:  226 val_f1:  0.7841726618705036 val_auroc:  0.8648255813953489 val_auprc:  0.9452689026183477
EarlyStopping counter: 12 out of 50
epoch:  226
[Epoch 227, Batch 10] loss: 0.129
epoch:  227 val_f1:  0.792019787311512 val_auroc:  0.8650678294573645 val_auprc:  0.9453558155405151
EarlyStopping counter: 13 out of 50
epoch:  227
[Epoch 228, Batch 10] loss: 0.138
epoch:  228 val_f1:  0.7932273763653603 val_auroc:  0.8648255813953489 val_auprc:  0.9452623250284391
Validation loss improved to 1.304451
epoch:  228
[Epoch 229, Batch 10] loss: 0.133
epoch:  229 val_f1:  0.7776763243674784 val_auroc:  0.8660368217054263 val_auprc:  0.9457552475050524
EarlyStopping counter: 1 out of 50
epoch:  229
[Epoch 230, Batch 10] loss: 0.139
epoch:  230 val_f1:  0.7932273763653603 val_auroc:  0.8648255813953488 val_auprc:  0.9452286906444363
EarlyStopping counter: 2 out of 50
epoch:  230
[Epoch 231, Batch 10] loss: 0.140
epoch:  231 val_f1:  0.7854893118997625 val_auroc:  0.8657945736434108 val_auprc:  0.945685165718657
EarlyStopping counter: 3 out of 50
epoch:  231
[Epoch 232, Batch 10] loss: 0.134
epoch:  232 val_f1:  0.7841726618705036 val_auroc:  0.8665213178294574 val_auprc:  0.9458254434254406
EarlyStopping counter: 4 out of 50
epoch:  232
[Epoch 233, Batch 10] loss: 0.134
epoch:  233 val_f1:  0.7841726618705036 val_auroc:  0.8670058139534885 val_auprc:  0.9460050281570037
EarlyStopping counter: 5 out of 50
epoch:  233
[Epoch 234, Batch 10] loss: 0.139
epoch:  234 val_f1:  0.7776763243674784 val_auroc:  0.8660368217054263 val_auprc:  0.945844623933856
EarlyStopping counter: 6 out of 50
epoch:  234
[Epoch 235, Batch 10] loss: 0.133
epoch:  235 val_f1:  0.7932273763653603 val_auroc:  0.8653100775193798 val_auprc:  0.9454449181946374
EarlyStopping counter: 7 out of 50
epoch:  235
[Epoch 236, Batch 10] loss: 0.128
epoch:  236 val_f1:  0.7841726618705036 val_auroc:  0.8667635658914729 val_auprc:  0.9459708535401172
EarlyStopping counter: 8 out of 50
epoch:  236
[Epoch 237, Batch 10] loss: 0.132
epoch:  237 val_f1:  0.7932273763653603 val_auroc:  0.8662790697674418 val_auprc:  0.9458891980095057
Validation loss improved to 1.302466
epoch:  237
[Epoch 238, Batch 10] loss: 0.141
epoch:  238 val_f1:  0.7841726618705036 val_auroc:  0.868217054263566 val_auprc:  0.9463976269283416
EarlyStopping counter: 1 out of 50
epoch:  238
[Epoch 239, Batch 10] loss: 0.130
epoch:  239 val_f1:  0.7854893118997625 val_auroc:  0.867248062015504 val_auprc:  0.9463010958632156
EarlyStopping counter: 2 out of 50
epoch:  239
[Epoch 240, Batch 10] loss: 0.122
epoch:  240 val_f1:  0.7776763243674784 val_auroc:  0.8679748062015503 val_auprc:  0.9465730136869273
EarlyStopping counter: 3 out of 50
epoch:  240
[Epoch 241, Batch 10] loss: 0.136
epoch:  241 val_f1:  0.7776763243674784 val_auroc:  0.8674903100775193 val_auprc:  0.9463678996469583
EarlyStopping counter: 4 out of 50
epoch:  241
[Epoch 242, Batch 10] loss: 0.134
epoch:  242 val_f1:  0.7776763243674784 val_auroc:  0.8674903100775194 val_auprc:  0.9463530029364913
EarlyStopping counter: 5 out of 50
epoch:  242
[Epoch 243, Batch 10] loss: 0.121
epoch:  243 val_f1:  0.7932273763653603 val_auroc:  0.867732558139535 val_auprc:  0.9466654866288986
Validation loss improved to 1.295845
epoch:  243
[Epoch 244, Batch 10] loss: 0.134
epoch:  244 val_f1:  0.7841726618705036 val_auroc:  0.8689437984496123 val_auprc:  0.9468281089055459
EarlyStopping counter: 1 out of 50
epoch:  244
[Epoch 245, Batch 10] loss: 0.121
epoch:  245 val_f1:  0.8008946034661633 val_auroc:  0.868217054263566 val_auprc:  0.9469968420825666
Validation loss improved to 1.290339
epoch:  245
[Epoch 246, Batch 10] loss: 0.132
epoch:  246 val_f1:  0.7776763243674784 val_auroc:  0.868217054263566 val_auprc:  0.9467370021992936
EarlyStopping counter: 1 out of 50
epoch:  246
[Epoch 247, Batch 10] loss: 0.127
epoch:  247 val_f1:  0.7854893118997625 val_auroc:  0.8684593023255814 val_auprc:  0.9467068482339951
EarlyStopping counter: 2 out of 50
epoch:  247
[Epoch 248, Batch 10] loss: 0.126
epoch:  248 val_f1:  0.7854893118997625 val_auroc:  0.8689437984496123 val_auprc:  0.946885841165962
EarlyStopping counter: 3 out of 50
epoch:  248
[Epoch 249, Batch 10] loss: 0.122
epoch:  249 val_f1:  0.7854893118997625 val_auroc:  0.8691860465116279 val_auprc:  0.9470012326195743
EarlyStopping counter: 4 out of 50
epoch:  249
[Epoch 250, Batch 10] loss: 0.126
epoch:  250 val_f1:  0.7854893118997625 val_auroc:  0.8684593023255813 val_auprc:  0.9467129347945782
EarlyStopping counter: 5 out of 50
epoch:  250
[Epoch 251, Batch 10] loss: 0.133
epoch:  251 val_f1:  0.7776763243674784 val_auroc:  0.8703972868217054 val_auprc:  0.9473880635131765
EarlyStopping counter: 6 out of 50
epoch:  251
[Epoch 252, Batch 10] loss: 0.120
epoch:  252 val_f1:  0.7854893118997625 val_auroc:  0.8694282945736433 val_auprc:  0.9471683076232599
EarlyStopping counter: 7 out of 50
epoch:  252
[Epoch 253, Batch 10] loss: 0.130
epoch:  253 val_f1:  0.7776763243674784 val_auroc:  0.8706395348837209 val_auprc:  0.9475004142737751
EarlyStopping counter: 8 out of 50
epoch:  253
[Epoch 254, Batch 10] loss: 0.117
epoch:  254 val_f1:  0.7854893118997625 val_auroc:  0.869670542635659 val_auprc:  0.947137472787879
EarlyStopping counter: 9 out of 50
epoch:  254
[Epoch 255, Batch 10] loss: 0.128
epoch:  255 val_f1:  0.7776763243674784 val_auroc:  0.8706395348837209 val_auprc:  0.94745550871287
EarlyStopping counter: 10 out of 50
epoch:  255
[Epoch 256, Batch 10] loss: 0.128
epoch:  256 val_f1:  0.7932273763653603 val_auroc:  0.8699127906976744 val_auprc:  0.9475142752339226
EarlyStopping counter: 11 out of 50
epoch:  256
[Epoch 257, Batch 10] loss: 0.123
epoch:  257 val_f1:  0.7854893118997625 val_auroc:  0.8699127906976744 val_auprc:  0.9471915967340856
EarlyStopping counter: 12 out of 50
epoch:  257
[Epoch 258, Batch 10] loss: 0.120
epoch:  258 val_f1:  0.7854893118997625 val_auroc:  0.870639534883721 val_auprc:  0.9475489058085703
EarlyStopping counter: 13 out of 50
epoch:  258
[Epoch 259, Batch 10] loss: 0.122
epoch:  259 val_f1:  0.7776763243674784 val_auroc:  0.8716085271317829 val_auprc:  0.9479243125299432
EarlyStopping counter: 14 out of 50
epoch:  259
[Epoch 260, Batch 10] loss: 0.109
epoch:  260 val_f1:  0.7932273763653603 val_auroc:  0.8699127906976744 val_auprc:  0.9473556439545467
EarlyStopping counter: 15 out of 50
epoch:  260
[Epoch 261, Batch 10] loss: 0.124
epoch:  261 val_f1:  0.7776763243674784 val_auroc:  0.871124031007752 val_auprc:  0.947776058979648
EarlyStopping counter: 16 out of 50
epoch:  261
[Epoch 262, Batch 10] loss: 0.125
epoch:  262 val_f1:  0.7932273763653603 val_auroc:  0.8708817829457364 val_auprc:  0.947790591933247
EarlyStopping counter: 17 out of 50
epoch:  262
[Epoch 263, Batch 10] loss: 0.128
epoch:  263 val_f1:  0.7854893118997625 val_auroc:  0.8708817829457364 val_auprc:  0.9477106380919468
EarlyStopping counter: 18 out of 50
epoch:  263
[Epoch 264, Batch 10] loss: 0.119
epoch:  264 val_f1:  0.792019787311512 val_auroc:  0.8718507751937984 val_auprc:  0.9480122033449443
EarlyStopping counter: 19 out of 50
epoch:  264
[Epoch 265, Batch 10] loss: 0.119
epoch:  265 val_f1:  0.7854893118997625 val_auroc:  0.872093023255814 val_auprc:  0.9483062563523665
EarlyStopping counter: 20 out of 50
epoch:  265
[Epoch 266, Batch 10] loss: 0.115
epoch:  266 val_f1:  0.7854893118997625 val_auroc:  0.8713662790697674 val_auprc:  0.9479002161855736
EarlyStopping counter: 21 out of 50
epoch:  266
[Epoch 267, Batch 10] loss: 0.114
epoch:  267 val_f1:  0.792019787311512 val_auroc:  0.8711240310077519 val_auprc:  0.9477660571519625
EarlyStopping counter: 22 out of 50
epoch:  267
[Epoch 268, Batch 10] loss: 0.121
epoch:  268 val_f1:  0.7854893118997625 val_auroc:  0.8711240310077519 val_auprc:  0.9480084715071586
EarlyStopping counter: 23 out of 50
epoch:  268
[Epoch 269, Batch 10] loss: 0.111
epoch:  269 val_f1:  0.7841726618705036 val_auroc:  0.8720930232558141 val_auprc:  0.9482498720271146
EarlyStopping counter: 24 out of 50
epoch:  269
[Epoch 270, Batch 10] loss: 0.124
epoch:  270 val_f1:  0.8008946034661633 val_auroc:  0.8730620155038761 val_auprc:  0.9488919556784785
Validation loss improved to 1.288449
epoch:  270
[Epoch 271, Batch 10] loss: 0.118
epoch:  271 val_f1:  0.7841726618705036 val_auroc:  0.872577519379845 val_auprc:  0.9484540300046176
EarlyStopping counter: 1 out of 50
epoch:  271
[Epoch 272, Batch 10] loss: 0.107
epoch:  272 val_f1:  0.7854893118997625 val_auroc:  0.872577519379845 val_auprc:  0.9484446525077947
EarlyStopping counter: 2 out of 50
epoch:  272
[Epoch 273, Batch 10] loss: 0.103
epoch:  273 val_f1:  0.7776763243674784 val_auroc:  0.872577519379845 val_auprc:  0.9486072199172657
EarlyStopping counter: 3 out of 50
epoch:  273
[Epoch 274, Batch 10] loss: 0.114
epoch:  274 val_f1:  0.8008946034661633 val_auroc:  0.8728197674418604 val_auprc:  0.9489037621369812
Validation loss improved to 1.286510
epoch:  274
[Epoch 275, Batch 10] loss: 0.109
epoch:  275 val_f1:  0.7841726618705036 val_auroc:  0.8733042635658914 val_auprc:  0.9488965966359456
EarlyStopping counter: 1 out of 50
epoch:  275
[Epoch 276, Batch 10] loss: 0.116
epoch:  276 val_f1:  0.8008946034661633 val_auroc:  0.872577519379845 val_auprc:  0.948900046523413
Validation loss improved to 1.281353
epoch:  276
[Epoch 277, Batch 10] loss: 0.114
epoch:  277 val_f1:  0.7841726618705036 val_auroc:  0.8728197674418605 val_auprc:  0.9486581940376366
EarlyStopping counter: 1 out of 50
epoch:  277
[Epoch 278, Batch 10] loss: 0.124
epoch:  278 val_f1:  0.7854893118997625 val_auroc:  0.8716085271317829 val_auprc:  0.9480932047341089
EarlyStopping counter: 2 out of 50
epoch:  278
[Epoch 279, Batch 10] loss: 0.103
epoch:  279 val_f1:  0.7932273763653603 val_auroc:  0.872093023255814 val_auprc:  0.9485423021081354
EarlyStopping counter: 3 out of 50
epoch:  279
[Epoch 280, Batch 10] loss: 0.107
epoch:  280 val_f1:  0.7932273763653603 val_auroc:  0.8718507751937984 val_auprc:  0.9484979324827998
EarlyStopping counter: 4 out of 50
epoch:  280
[Epoch 281, Batch 10] loss: 0.112
epoch:  281 val_f1:  0.7854893118997625 val_auroc:  0.872577519379845 val_auprc:  0.9486513522481134
EarlyStopping counter: 5 out of 50
epoch:  281
[Epoch 282, Batch 10] loss: 0.122
epoch:  282 val_f1:  0.7854893118997625 val_auroc:  0.8720930232558138 val_auprc:  0.9482035089034105
EarlyStopping counter: 6 out of 50
epoch:  282
[Epoch 283, Batch 10] loss: 0.112
epoch:  283 val_f1:  0.7854893118997625 val_auroc:  0.8723352713178294 val_auprc:  0.9484428955783983
EarlyStopping counter: 7 out of 50
epoch:  283
[Epoch 284, Batch 10] loss: 0.112
epoch:  284 val_f1:  0.7854893118997625 val_auroc:  0.8723352713178294 val_auprc:  0.9483086918257866
EarlyStopping counter: 8 out of 50
epoch:  284
[Epoch 285, Batch 10] loss: 0.109
epoch:  285 val_f1:  0.7841726618705036 val_auroc:  0.8742732558139535 val_auprc:  0.9490419276291657
EarlyStopping counter: 9 out of 50
epoch:  285
[Epoch 286, Batch 10] loss: 0.105
epoch:  286 val_f1:  0.7854893118997625 val_auroc:  0.8733042635658913 val_auprc:  0.9489797042957637
EarlyStopping counter: 10 out of 50
epoch:  286
[Epoch 287, Batch 10] loss: 0.114
epoch:  287 val_f1:  0.7854893118997625 val_auroc:  0.8737887596899224 val_auprc:  0.949014921280277
EarlyStopping counter: 11 out of 50
epoch:  287
[Epoch 288, Batch 10] loss: 0.116
epoch:  288 val_f1:  0.7854893118997625 val_auroc:  0.8742732558139535 val_auprc:  0.9492269397749167
EarlyStopping counter: 12 out of 50
epoch:  288
[Epoch 289, Batch 10] loss: 0.108
epoch:  289 val_f1:  0.7854893118997625 val_auroc:  0.8747577519379844 val_auprc:  0.9493712374966536
EarlyStopping counter: 13 out of 50
epoch:  289
[Epoch 290, Batch 10] loss: 0.102
epoch:  290 val_f1:  0.7854893118997625 val_auroc:  0.875 val_auprc:  0.9494402282949022
EarlyStopping counter: 14 out of 50
epoch:  290
[Epoch 291, Batch 10] loss: 0.103
epoch:  291 val_f1:  0.7932273763653603 val_auroc:  0.8747577519379844 val_auprc:  0.9493785603481535
EarlyStopping counter: 15 out of 50
epoch:  291
[Epoch 292, Batch 10] loss: 0.104
epoch:  292 val_f1:  0.7932273763653603 val_auroc:  0.8747577519379844 val_auprc:  0.9495364797783203
EarlyStopping counter: 16 out of 50
epoch:  292
[Epoch 293, Batch 10] loss: 0.095
epoch:  293 val_f1:  0.7932273763653603 val_auroc:  0.874031007751938 val_auprc:  0.949115670293588
EarlyStopping counter: 17 out of 50
epoch:  293
[Epoch 294, Batch 10] loss: 0.096
epoch:  294 val_f1:  0.7932273763653603 val_auroc:  0.874515503875969 val_auprc:  0.9493553654224197
EarlyStopping counter: 18 out of 50
epoch:  294
[Epoch 295, Batch 10] loss: 0.107
epoch:  295 val_f1:  0.7932273763653603 val_auroc:  0.874515503875969 val_auprc:  0.9495920215084448
EarlyStopping counter: 19 out of 50
epoch:  295
[Epoch 296, Batch 10] loss: 0.109
epoch:  296 val_f1:  0.792019787311512 val_auroc:  0.8740310077519379 val_auprc:  0.9490324844108963
EarlyStopping counter: 20 out of 50
epoch:  296
[Epoch 297, Batch 10] loss: 0.102
epoch:  297 val_f1:  0.7932273763653603 val_auroc:  0.8740310077519381 val_auprc:  0.9494826031255372
EarlyStopping counter: 21 out of 50
epoch:  297
[Epoch 298, Batch 10] loss: 0.093
epoch:  298 val_f1:  0.7932273763653603 val_auroc:  0.8740310077519379 val_auprc:  0.9493877467008724
EarlyStopping counter: 22 out of 50
epoch:  298
[Epoch 299, Batch 10] loss: 0.098
epoch:  299 val_f1:  0.7932273763653603 val_auroc:  0.8742732558139535 val_auprc:  0.9495179756186714
EarlyStopping counter: 23 out of 50
epoch:  299
[Epoch 300, Batch 10] loss: 0.099
epoch:  300 val_f1:  0.7932273763653603 val_auroc:  0.8752422480620156 val_auprc:  0.9497610955919333
EarlyStopping counter: 24 out of 50
epoch:  300
[Epoch 301, Batch 10] loss: 0.103
epoch:  301 val_f1:  0.7932273763653603 val_auroc:  0.8749999999999999 val_auprc:  0.9497047056387494
EarlyStopping counter: 25 out of 50
epoch:  301
[Epoch 302, Batch 10] loss: 0.110
epoch:  302 val_f1:  0.8008946034661633 val_auroc:  0.875484496124031 val_auprc:  0.9500781318947075
EarlyStopping counter: 26 out of 50
epoch:  302
[Epoch 303, Batch 10] loss: 0.086
epoch:  303 val_f1:  0.7932273763653603 val_auroc:  0.8762112403100774 val_auprc:  0.9502083149606955
EarlyStopping counter: 27 out of 50
epoch:  303
[Epoch 304, Batch 10] loss: 0.093
epoch:  304 val_f1:  0.8084949329130455 val_auroc:  0.8766957364341085 val_auprc:  0.950593432578091
Validation loss improved to 1.274381
epoch:  304
[Epoch 305, Batch 10] loss: 0.105
epoch:  305 val_f1:  0.792019787311512 val_auroc:  0.8747577519379844 val_auprc:  0.9493723617528318
EarlyStopping counter: 1 out of 50
epoch:  305
[Epoch 306, Batch 10] loss: 0.097
epoch:  306 val_f1:  0.8084949329130455 val_auroc:  0.875968992248062 val_auprc:  0.9501621997436054
Validation loss improved to 1.273257
epoch:  306
[Epoch 307, Batch 10] loss: 0.089
epoch:  307 val_f1:  0.7932273763653603 val_auroc:  0.874515503875969 val_auprc:  0.9494585892887295
EarlyStopping counter: 1 out of 50
epoch:  307
[Epoch 308, Batch 10] loss: 0.105
epoch:  308 val_f1:  0.7932273763653603 val_auroc:  0.8764534883720929 val_auprc:  0.9503167951458559
EarlyStopping counter: 2 out of 50
epoch:  308
[Epoch 309, Batch 10] loss: 0.094
epoch:  309 val_f1:  0.7932273763653603 val_auroc:  0.877422480620155 val_auprc:  0.9502165729437562
EarlyStopping counter: 3 out of 50
epoch:  309
[Epoch 310, Batch 10] loss: 0.098
epoch:  310 val_f1:  0.7932273763653603 val_auroc:  0.875968992248062 val_auprc:  0.9501983750700798
EarlyStopping counter: 4 out of 50
epoch:  310
[Epoch 311, Batch 10] loss: 0.096
epoch:  311 val_f1:  0.7932273763653603 val_auroc:  0.8762112403100775 val_auprc:  0.950430310643785
EarlyStopping counter: 5 out of 50
epoch:  311
[Epoch 312, Batch 10] loss: 0.095
epoch:  312 val_f1:  0.7932273763653603 val_auroc:  0.875968992248062 val_auprc:  0.9502229468282913
EarlyStopping counter: 6 out of 50
epoch:  312
[Epoch 313, Batch 10] loss: 0.105
epoch:  313 val_f1:  0.7932273763653603 val_auroc:  0.8752422480620154 val_auprc:  0.9500181853928243
EarlyStopping counter: 7 out of 50
epoch:  313
[Epoch 314, Batch 10] loss: 0.096
epoch:  314 val_f1:  0.7932273763653603 val_auroc:  0.875968992248062 val_auprc:  0.9504056817327207
EarlyStopping counter: 8 out of 50
epoch:  314
[Epoch 315, Batch 10] loss: 0.095
epoch:  315 val_f1:  0.7932273763653603 val_auroc:  0.8754844961240309 val_auprc:  0.9501551790481102
EarlyStopping counter: 9 out of 50
epoch:  315
[Epoch 316, Batch 10] loss: 0.095
epoch:  316 val_f1:  0.7932273763653603 val_auroc:  0.8762112403100775 val_auprc:  0.9504649970270262
EarlyStopping counter: 10 out of 50
epoch:  316
[Epoch 317, Batch 10] loss: 0.093
epoch:  317 val_f1:  0.7932273763653603 val_auroc:  0.8762112403100775 val_auprc:  0.9505579944933649
EarlyStopping counter: 11 out of 50
epoch:  317
[Epoch 318, Batch 10] loss: 0.096
epoch:  318 val_f1:  0.7932273763653603 val_auroc:  0.8766957364341086 val_auprc:  0.9506712336039391
EarlyStopping counter: 12 out of 50
epoch:  318
[Epoch 319, Batch 10] loss: 0.105
epoch:  319 val_f1:  0.7932273763653603 val_auroc:  0.8776647286821705 val_auprc:  0.9508856020344071
EarlyStopping counter: 13 out of 50
epoch:  319
[Epoch 320, Batch 10] loss: 0.094
epoch:  320 val_f1:  0.8008946034661633 val_auroc:  0.8771802325581396 val_auprc:  0.9509309398803529
EarlyStopping counter: 14 out of 50
epoch:  320
[Epoch 321, Batch 10] loss: 0.102
epoch:  321 val_f1:  0.7932273763653603 val_auroc:  0.877422480620155 val_auprc:  0.950730232549692
EarlyStopping counter: 15 out of 50
epoch:  321
[Epoch 322, Batch 10] loss: 0.086
epoch:  322 val_f1:  0.7932273763653603 val_auroc:  0.8771802325581395 val_auprc:  0.9506930710978718
EarlyStopping counter: 16 out of 50
epoch:  322
[Epoch 323, Batch 10] loss: 0.094
epoch:  323 val_f1:  0.7932273763653603 val_auroc:  0.877422480620155 val_auprc:  0.9508491803512742
EarlyStopping counter: 17 out of 50
epoch:  323
[Epoch 324, Batch 10] loss: 0.083
epoch:  324 val_f1:  0.7932273763653603 val_auroc:  0.8781492248062015 val_auprc:  0.9511422119158942
EarlyStopping counter: 18 out of 50
epoch:  324
[Epoch 325, Batch 10] loss: 0.087
epoch:  325 val_f1:  0.7932273763653603 val_auroc:  0.8781492248062016 val_auprc:  0.9512867914807568
EarlyStopping counter: 19 out of 50
epoch:  325
[Epoch 326, Batch 10] loss: 0.088
epoch:  326 val_f1:  0.7932273763653603 val_auroc:  0.8779069767441859 val_auprc:  0.9511687225917951
EarlyStopping counter: 20 out of 50
epoch:  326
[Epoch 327, Batch 10] loss: 0.086
epoch:  327 val_f1:  0.7932273763653603 val_auroc:  0.8786337209302325 val_auprc:  0.9513867087568713
EarlyStopping counter: 21 out of 50
epoch:  327
[Epoch 328, Batch 10] loss: 0.093
epoch:  328 val_f1:  0.7932273763653603 val_auroc:  0.8776647286821705 val_auprc:  0.950972359525443
EarlyStopping counter: 22 out of 50
epoch:  328
[Epoch 329, Batch 10] loss: 0.084
epoch:  329 val_f1:  0.8008946034661633 val_auroc:  0.877422480620155 val_auprc:  0.9510199879155953
EarlyStopping counter: 23 out of 50
epoch:  329
[Epoch 330, Batch 10] loss: 0.098
epoch:  330 val_f1:  0.7932273763653603 val_auroc:  0.8788759689922482 val_auprc:  0.95127201025744
EarlyStopping counter: 24 out of 50
epoch:  330
[Epoch 331, Batch 10] loss: 0.098
epoch:  331 val_f1:  0.8084949329130455 val_auroc:  0.8786337209302326 val_auprc:  0.9516861747821574
EarlyStopping counter: 25 out of 50
epoch:  331
[Epoch 332, Batch 10] loss: 0.090
epoch:  332 val_f1:  0.7932273763653603 val_auroc:  0.8791182170542635 val_auprc:  0.9514559233771502
EarlyStopping counter: 26 out of 50
epoch:  332
[Epoch 333, Batch 10] loss: 0.094
epoch:  333 val_f1:  0.7932273763653603 val_auroc:  0.87984496124031 val_auprc:  0.9518435195909856
EarlyStopping counter: 27 out of 50
epoch:  333
[Epoch 334, Batch 10] loss: 0.085
epoch:  334 val_f1:  0.8008946034661633 val_auroc:  0.877906976744186 val_auprc:  0.951186219303637
EarlyStopping counter: 28 out of 50
epoch:  334
[Epoch 335, Batch 10] loss: 0.092
epoch:  335 val_f1:  0.7932273763653603 val_auroc:  0.8793604651162791 val_auprc:  0.9518740978143131
EarlyStopping counter: 29 out of 50
epoch:  335
[Epoch 336, Batch 10] loss: 0.086
epoch:  336 val_f1:  0.8008946034661633 val_auroc:  0.8798449612403101 val_auprc:  0.9520674730747285
EarlyStopping counter: 30 out of 50
epoch:  336
[Epoch 337, Batch 10] loss: 0.086
epoch:  337 val_f1:  0.7932273763653603 val_auroc:  0.8800872093023255 val_auprc:  0.9521908703699999
EarlyStopping counter: 31 out of 50
epoch:  337
[Epoch 338, Batch 10] loss: 0.086
epoch:  338 val_f1:  0.8008946034661633 val_auroc:  0.8796027131782946 val_auprc:  0.9519995308194826
EarlyStopping counter: 32 out of 50
epoch:  338
[Epoch 339, Batch 10] loss: 0.086
epoch:  339 val_f1:  0.8084949329130455 val_auroc:  0.8788759689922481 val_auprc:  0.9516478544807133
EarlyStopping counter: 33 out of 50
epoch:  339
[Epoch 340, Batch 10] loss: 0.092
epoch:  340 val_f1:  0.7997900244397783 val_auroc:  0.8805717054263567 val_auprc:  0.9520707938854699
EarlyStopping counter: 34 out of 50
epoch:  340
[Epoch 341, Batch 10] loss: 0.082
epoch:  341 val_f1:  0.8008946034661633 val_auroc:  0.8791182170542636 val_auprc:  0.9519130265319968
EarlyStopping counter: 35 out of 50
epoch:  341
[Epoch 342, Batch 10] loss: 0.081
epoch:  342 val_f1:  0.7932273763653603 val_auroc:  0.881782945736434 val_auprc:  0.9527995878828386
EarlyStopping counter: 36 out of 50
epoch:  342
[Epoch 343, Batch 10] loss: 0.093
epoch:  343 val_f1:  0.7932273763653603 val_auroc:  0.8815406976744187 val_auprc:  0.9527904807287335
EarlyStopping counter: 37 out of 50
epoch:  343
[Epoch 344, Batch 10] loss: 0.081
epoch:  344 val_f1:  0.7932273763653603 val_auroc:  0.8810562015503876 val_auprc:  0.9524990385714681
EarlyStopping counter: 38 out of 50
epoch:  344
[Epoch 345, Batch 10] loss: 0.089
epoch:  345 val_f1:  0.7932273763653603 val_auroc:  0.8815406976744186 val_auprc:  0.9529158305854513
EarlyStopping counter: 39 out of 50
epoch:  345
[Epoch 346, Batch 10] loss: 0.083
epoch:  346 val_f1:  0.7932273763653603 val_auroc:  0.8815406976744186 val_auprc:  0.9529195216092425
EarlyStopping counter: 40 out of 50
epoch:  346
[Epoch 347, Batch 10] loss: 0.076
epoch:  347 val_f1:  0.7997900244397783 val_auroc:  0.8812984496124031 val_auprc:  0.9527652418218089
EarlyStopping counter: 41 out of 50
epoch:  347
[Epoch 348, Batch 10] loss: 0.083
epoch:  348 val_f1:  0.8018807955038493 val_auroc:  0.8808139534883721 val_auprc:  0.9526680054694101
EarlyStopping counter: 42 out of 50
epoch:  348
[Epoch 349, Batch 10] loss: 0.082
epoch:  349 val_f1:  0.7997900244397783 val_auroc:  0.8798449612403101 val_auprc:  0.9519702723579294
EarlyStopping counter: 43 out of 50
epoch:  349
[Epoch 350, Batch 10] loss: 0.078
epoch:  350 val_f1:  0.8008946034661633 val_auroc:  0.880813953488372 val_auprc:  0.95275600199541
EarlyStopping counter: 44 out of 50
epoch:  350
[Epoch 351, Batch 10] loss: 0.080
epoch:  351 val_f1:  0.7997900244397783 val_auroc:  0.8817829457364341 val_auprc:  0.9530302012540259
EarlyStopping counter: 45 out of 50
epoch:  351
[Epoch 352, Batch 10] loss: 0.089
epoch:  352 val_f1:  0.8008946034661633 val_auroc:  0.8820251937984496 val_auprc:  0.9531759987848221
EarlyStopping counter: 46 out of 50
epoch:  352
[Epoch 353, Batch 10] loss: 0.086
epoch:  353 val_f1:  0.7997900244397783 val_auroc:  0.8829941860465116 val_auprc:  0.9533185362886591
EarlyStopping counter: 47 out of 50
epoch:  353
[Epoch 354, Batch 10] loss: 0.088
epoch:  354 val_f1:  0.8084949329130455 val_auroc:  0.8810562015503876 val_auprc:  0.9528378128235071
EarlyStopping counter: 48 out of 50
epoch:  354
[Epoch 355, Batch 10] loss: 0.081
epoch:  355 val_f1:  0.7932273763653603 val_auroc:  0.8822674418604651 val_auprc:  0.9531964599554609
EarlyStopping counter: 49 out of 50
epoch:  355
[Epoch 356, Batch 10] loss: 0.077
epoch:  356 val_f1:  0.8008946034661633 val_auroc:  0.8825096899224806 val_auprc:  0.9532859446845812
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  2012.8730964660645
{'time_elapsed': [2012.8730964660645], 'epoch': [355], 'fold': [3], 'f1_train': [0.9785493267985776], 'auroc_train': [0.9977543989171896], 'auprc_train': [0.9990893862604158], 'f1_test': [0.8008946034661633], 'auroc_test': [0.8825096899224806], 'auprc_test': [0.9532859446845812]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [32, 1]                   --
├─Sequential: 1-1                        [32, 1]                   --
│    └─Conv1d: 2-1                       [32, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [32, 1024, 427]           2,048
│    └─Tanh: 2-3                         [32, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [32, 1024, 142]           --
│    └─Dropout: 2-5                      [32, 1024, 142]           --
│    └─Flatten: 2-6                      [32, 145408]              --
│    └─Linear: 2-7                       [32, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.16
Forward/backward pass size (MB): 223.87
Params size (MB): 0.61
Estimated Total Size (MB): 224.64
==========================================================================================
tensor(0.4369)
epoch:  0
[Epoch 1, Batch 10] loss: 0.466
epoch:  1 val_f1:  0.6316751534142838 val_auroc:  0.6240079365079365 val_auprc:  0.7629334307848845
epoch:  1
[Epoch 2, Batch 10] loss: 0.419
epoch:  2 val_f1:  0.7064584212747994 val_auroc:  0.6676587301587301 val_auprc:  0.7864191079558708
Validation loss improved to 2.051041
epoch:  2
[Epoch 3, Batch 10] loss: 0.408
epoch:  3 val_f1:  0.5717117529231559 val_auroc:  0.6986607142857143 val_auprc:  0.8080190812119958
Validation loss improved to 2.023210
epoch:  3
[Epoch 4, Batch 10] loss: 0.404
epoch:  4 val_f1:  0.6657626791487717 val_auroc:  0.7160218253968254 val_auprc:  0.8164195496735154
Validation loss improved to 2.003249
epoch:  4
[Epoch 5, Batch 10] loss: 0.401
epoch:  5 val_f1:  0.6302489780750651 val_auroc:  0.7331349206349207 val_auprc:  0.8284417674743786
Validation loss improved to 1.981265
epoch:  5
[Epoch 6, Batch 10] loss: 0.395
epoch:  6 val_f1:  0.6446664866324603 val_auroc:  0.7487599206349207 val_auprc:  0.8546435386888642
Validation loss improved to 1.955942
epoch:  6
[Epoch 7, Batch 10] loss: 0.395
epoch:  7 val_f1:  0.6839230848205453 val_auroc:  0.7554563492063492 val_auprc:  0.8608168196039707
Validation loss improved to 1.936671
epoch:  7
[Epoch 8, Batch 10] loss: 0.399
epoch:  8 val_f1:  0.6869006303308818 val_auroc:  0.7765376984126984 val_auprc:  0.877892690994494
Validation loss improved to 1.912561
epoch:  8
[Epoch 9, Batch 10] loss: 0.391
epoch:  9 val_f1:  0.7229142185663925 val_auroc:  0.7867063492063493 val_auprc:  0.8845458673269988
Validation loss improved to 1.893649
epoch:  9
[Epoch 10, Batch 10] loss: 0.374
epoch:  10 val_f1:  0.6729765338460991 val_auroc:  0.796875 val_auprc:  0.8909469535075847
Validation loss improved to 1.868560
epoch:  10
[Epoch 11, Batch 10] loss: 0.374
epoch:  11 val_f1:  0.6708425579265818 val_auroc:  0.8090277777777779 val_auprc:  0.897454629334782
Validation loss improved to 1.847771
epoch:  11
[Epoch 12, Batch 10] loss: 0.387
epoch:  12 val_f1:  0.7282990083905416 val_auroc:  0.818700396825397 val_auprc:  0.9043480924332947
Validation loss improved to 1.825425
epoch:  12
[Epoch 13, Batch 10] loss: 0.356
epoch:  13 val_f1:  0.7608091787439614 val_auroc:  0.8224206349206349 val_auprc:  0.9056758043348959
Validation loss improved to 1.809165
epoch:  13
[Epoch 14, Batch 10] loss: 0.366
epoch:  14 val_f1:  0.7353954543261111 val_auroc:  0.8251488095238095 val_auprc:  0.9069579907735676
Validation loss improved to 1.788910
epoch:  14
[Epoch 15, Batch 10] loss: 0.368
epoch:  15 val_f1:  0.7621343873517787 val_auroc:  0.8365575396825395 val_auprc:  0.9134302613868999
Validation loss improved to 1.771109
epoch:  15
[Epoch 16, Batch 10] loss: 0.362
epoch:  16 val_f1:  0.7621343873517787 val_auroc:  0.8375496031746033 val_auprc:  0.9140911625941872
Validation loss improved to 1.753424
epoch:  16
[Epoch 17, Batch 10] loss: 0.363
epoch:  17 val_f1:  0.7769308547872755 val_auroc:  0.8407738095238096 val_auprc:  0.9163588115879462
Validation loss improved to 1.736431
epoch:  17
[Epoch 18, Batch 10] loss: 0.352
epoch:  18 val_f1:  0.770099160945843 val_auroc:  0.8427579365079364 val_auprc:  0.9171500947165175
Validation loss improved to 1.719058
epoch:  18
[Epoch 19, Batch 10] loss: 0.361
epoch:  19 val_f1:  0.7608091787439614 val_auroc:  0.8442460317460319 val_auprc:  0.9176348120891791
Validation loss improved to 1.704489
epoch:  19
[Epoch 20, Batch 10] loss: 0.338
epoch:  20 val_f1:  0.79396185483142 val_auroc:  0.8439980158730159 val_auprc:  0.9174365277070822
Validation loss improved to 1.692502
epoch:  20
[Epoch 21, Batch 10] loss: 0.344
epoch:  21 val_f1:  0.7807080066524115 val_auroc:  0.8467261904761905 val_auprc:  0.9182470277415669
Validation loss improved to 1.678667
epoch:  21
[Epoch 22, Batch 10] loss: 0.338
epoch:  22 val_f1:  0.7765822970867508 val_auroc:  0.8479662698412698 val_auprc:  0.9173654688424284
Validation loss improved to 1.664478
epoch:  22
[Epoch 23, Batch 10] loss: 0.335
epoch:  23 val_f1:  0.7889492753623188 val_auroc:  0.8529265873015874 val_auprc:  0.9210525606599864
Validation loss improved to 1.654438
epoch:  23
[Epoch 24, Batch 10] loss: 0.335
epoch:  24 val_f1:  0.7948558771909655 val_auroc:  0.8546626984126984 val_auprc:  0.9184131528821327
Validation loss improved to 1.643152
epoch:  24
[Epoch 25, Batch 10] loss: 0.325
epoch:  25 val_f1:  0.7765822970867508 val_auroc:  0.855654761904762 val_auprc:  0.9211948654458241
Validation loss improved to 1.627626
epoch:  25
[Epoch 26, Batch 10] loss: 0.338
epoch:  26 val_f1:  0.7822581250985979 val_auroc:  0.8591269841269841 val_auprc:  0.9225924915489443
Validation loss improved to 1.617454
epoch:  26
[Epoch 27, Batch 10] loss: 0.326
epoch:  27 val_f1:  0.7807080066524115 val_auroc:  0.859375 val_auprc:  0.9227275459406182
Validation loss improved to 1.608740
epoch:  27
[Epoch 28, Batch 10] loss: 0.326
epoch:  28 val_f1:  0.7822581250985979 val_auroc:  0.8598710317460316 val_auprc:  0.9228373110115262
Validation loss improved to 1.594102
epoch:  28
[Epoch 29, Batch 10] loss: 0.316
epoch:  29 val_f1:  0.7807080066524115 val_auroc:  0.8606150793650793 val_auprc:  0.9243218116912015
Validation loss improved to 1.585977
epoch:  29
[Epoch 30, Batch 10] loss: 0.330
epoch:  30 val_f1:  0.7755600530392909 val_auroc:  0.8625992063492064 val_auprc:  0.9261528996084742
Validation loss improved to 1.572322
epoch:  30
[Epoch 31, Batch 10] loss: 0.324
epoch:  31 val_f1:  0.7815416513900654 val_auroc:  0.8616071428571429 val_auprc:  0.9226630306118947
Validation loss improved to 1.562578
epoch:  31
[Epoch 32, Batch 10] loss: 0.312
epoch:  32 val_f1:  0.7807080066524115 val_auroc:  0.8623511904761905 val_auprc:  0.9228123059403456
Validation loss improved to 1.556485
epoch:  32
[Epoch 33, Batch 10] loss: 0.316
epoch:  33 val_f1:  0.7889492753623188 val_auroc:  0.8635912698412699 val_auprc:  0.9255718915210585
Validation loss improved to 1.543509
epoch:  33
[Epoch 34, Batch 10] loss: 0.302
epoch:  34 val_f1:  0.7815416513900654 val_auroc:  0.863095238095238 val_auprc:  0.924274044385615
Validation loss improved to 1.537227
epoch:  34
[Epoch 35, Batch 10] loss: 0.306
epoch:  35 val_f1:  0.7833564971403972 val_auroc:  0.8628472222222221 val_auprc:  0.9244661309164808
Validation loss improved to 1.530026
epoch:  35
[Epoch 36, Batch 10] loss: 0.309
epoch:  36 val_f1:  0.7873345935727789 val_auroc:  0.8645833333333334 val_auprc:  0.9249144223349394
Validation loss improved to 1.524986
epoch:  36
[Epoch 37, Batch 10] loss: 0.302
epoch:  37 val_f1:  0.7837457330597287 val_auroc:  0.8643353174603176 val_auprc:  0.9269974544462594
Validation loss improved to 1.512813
epoch:  37
[Epoch 38, Batch 10] loss: 0.309
epoch:  38 val_f1:  0.79396185483142 val_auroc:  0.865079365079365 val_auprc:  0.9270691682471737
EarlyStopping counter: 1 out of 50
epoch:  38
[Epoch 39, Batch 10] loss: 0.305
epoch:  39 val_f1:  0.7815416513900654 val_auroc:  0.8658234126984127 val_auprc:  0.9277082538138224
Validation loss improved to 1.499508
epoch:  39
[Epoch 40, Batch 10] loss: 0.314
epoch:  40 val_f1:  0.7761264822134387 val_auroc:  0.8655753968253969 val_auprc:  0.9284655986004527
Validation loss improved to 1.491400
epoch:  40
[Epoch 41, Batch 10] loss: 0.290
epoch:  41 val_f1:  0.7748792270531402 val_auroc:  0.8658234126984127 val_auprc:  0.9277551544863715
Validation loss improved to 1.485665
epoch:  41
[Epoch 42, Batch 10] loss: 0.291
epoch:  42 val_f1:  0.7815416513900654 val_auroc:  0.8663194444444445 val_auprc:  0.9279169052158395
Validation loss improved to 1.480813
epoch:  42
[Epoch 43, Batch 10] loss: 0.285
epoch:  43 val_f1:  0.7815416513900654 val_auroc:  0.8668154761904762 val_auprc:  0.9278563656585737
Validation loss improved to 1.477737
epoch:  43
[Epoch 44, Batch 10] loss: 0.290
epoch:  44 val_f1:  0.7948558771909655 val_auroc:  0.8668154761904762 val_auprc:  0.929706471754677
Validation loss improved to 1.475429
epoch:  44
[Epoch 45, Batch 10] loss: 0.272
epoch:  45 val_f1:  0.7822581250985979 val_auroc:  0.8680555555555556 val_auprc:  0.9294654256865662
Validation loss improved to 1.462908
epoch:  45
[Epoch 46, Batch 10] loss: 0.284
epoch:  46 val_f1:  0.7815416513900654 val_auroc:  0.8668154761904763 val_auprc:  0.9296026735706872
Validation loss improved to 1.460148
epoch:  46
[Epoch 47, Batch 10] loss: 0.295
epoch:  47 val_f1:  0.7881997743237336 val_auroc:  0.8675595238095237 val_auprc:  0.9299891855327904
Validation loss improved to 1.459699
epoch:  47
[Epoch 48, Batch 10] loss: 0.279
epoch:  48 val_f1:  0.7815416513900654 val_auroc:  0.868799603174603 val_auprc:  0.9312617776445815
Validation loss improved to 1.448935
epoch:  48
[Epoch 49, Batch 10] loss: 0.292
epoch:  49 val_f1:  0.7881997743237336 val_auroc:  0.8695436507936508 val_auprc:  0.931611515247581
Validation loss improved to 1.446067
epoch:  49
[Epoch 50, Batch 10] loss: 0.286
epoch:  50 val_f1:  0.7895875497243353 val_auroc:  0.8683035714285715 val_auprc:  0.9310953561119127
Validation loss improved to 1.440106
epoch:  50
[Epoch 51, Batch 10] loss: 0.291
epoch:  51 val_f1:  0.7815416513900654 val_auroc:  0.8678075396825397 val_auprc:  0.9309048777677805
EarlyStopping counter: 1 out of 50
epoch:  51
[Epoch 52, Batch 10] loss: 0.275
epoch:  52 val_f1:  0.7697938448700337 val_auroc:  0.8690476190476191 val_auprc:  0.9315251897924886
Validation loss improved to 1.428946
epoch:  52
[Epoch 53, Batch 10] loss: 0.272
epoch:  53 val_f1:  0.7895875497243353 val_auroc:  0.8683035714285715 val_auprc:  0.9312415475526747
Validation loss improved to 1.426095
epoch:  53
[Epoch 54, Batch 10] loss: 0.285
epoch:  54 val_f1:  0.7822581250985979 val_auroc:  0.8685515873015873 val_auprc:  0.9314295094695868
Validation loss improved to 1.423440
epoch:  54
[Epoch 55, Batch 10] loss: 0.276
epoch:  55 val_f1:  0.7833564971403972 val_auroc:  0.8695436507936508 val_auprc:  0.9317931428238999
Validation loss improved to 1.415973
epoch:  55
[Epoch 56, Batch 10] loss: 0.275
epoch:  56 val_f1:  0.7895875497243353 val_auroc:  0.8702876984126984 val_auprc:  0.9319915691975496
Validation loss improved to 1.415373
epoch:  56
[Epoch 57, Batch 10] loss: 0.273
epoch:  57 val_f1:  0.7697938448700337 val_auroc:  0.8697916666666667 val_auprc:  0.9317996860036751
Validation loss improved to 1.412403
epoch:  57
[Epoch 58, Batch 10] loss: 0.276
epoch:  58 val_f1:  0.7889492753623188 val_auroc:  0.8680555555555556 val_auprc:  0.9311568893528323
EarlyStopping counter: 1 out of 50
epoch:  58
[Epoch 59, Batch 10] loss: 0.274
epoch:  59 val_f1:  0.7828617791771808 val_auroc:  0.8685515873015874 val_auprc:  0.9313040302029434
Validation loss improved to 1.409247
epoch:  59
[Epoch 60, Batch 10] loss: 0.272
epoch:  60 val_f1:  0.7889492753623188 val_auroc:  0.8692956349206349 val_auprc:  0.931578804355073
Validation loss improved to 1.408918
epoch:  60
[Epoch 61, Batch 10] loss: 0.273
epoch:  61 val_f1:  0.7761264822134387 val_auroc:  0.8692956349206349 val_auprc:  0.9316167104798103
Validation loss improved to 1.401209
epoch:  61
[Epoch 62, Batch 10] loss: 0.279
epoch:  62 val_f1:  0.7948558771909655 val_auroc:  0.8712797619047619 val_auprc:  0.9325435322224798
EarlyStopping counter: 1 out of 50
epoch:  62
[Epoch 63, Batch 10] loss: 0.258
epoch:  63 val_f1:  0.7963059879954627 val_auroc:  0.8702876984126984 val_auprc:  0.9323384297613366
Validation loss improved to 1.393482
epoch:  63
[Epoch 64, Batch 10] loss: 0.264
epoch:  64 val_f1:  0.7963059879954627 val_auroc:  0.8702876984126985 val_auprc:  0.9322933230128745
Validation loss improved to 1.390077
epoch:  64
[Epoch 65, Batch 10] loss: 0.262
epoch:  65 val_f1:  0.7963059879954627 val_auroc:  0.8715277777777777 val_auprc:  0.9329311463565197
EarlyStopping counter: 1 out of 50
epoch:  65
[Epoch 66, Batch 10] loss: 0.268
epoch:  66 val_f1:  0.7963059879954627 val_auroc:  0.8720238095238095 val_auprc:  0.9331851911127192
Validation loss improved to 1.384764
epoch:  66
[Epoch 67, Batch 10] loss: 0.253
epoch:  67 val_f1:  0.7963059879954627 val_auroc:  0.8717757936507937 val_auprc:  0.9330343151712347
Validation loss improved to 1.382884
epoch:  67
[Epoch 68, Batch 10] loss: 0.264
epoch:  68 val_f1:  0.7881997743237336 val_auroc:  0.8717757936507937 val_auprc:  0.9331240603538667
EarlyStopping counter: 1 out of 50
epoch:  68
[Epoch 69, Batch 10] loss: 0.265
epoch:  69 val_f1:  0.7889492753623188 val_auroc:  0.8715277777777778 val_auprc:  0.9329694241298446
EarlyStopping counter: 2 out of 50
epoch:  69
[Epoch 70, Batch 10] loss: 0.254
epoch:  70 val_f1:  0.7963059879954627 val_auroc:  0.8702876984126984 val_auprc:  0.9323916644913173
Validation loss improved to 1.378881
epoch:  70
[Epoch 71, Batch 10] loss: 0.276
epoch:  71 val_f1:  0.807228002894545 val_auroc:  0.8705357142857143 val_auprc:  0.9325096900288552
EarlyStopping counter: 1 out of 50
epoch:  71
[Epoch 72, Batch 10] loss: 0.263
epoch:  72 val_f1:  0.7963059879954627 val_auroc:  0.8722718253968254 val_auprc:  0.9340822628167011
Validation loss improved to 1.377639
epoch:  72
[Epoch 73, Batch 10] loss: 0.246
epoch:  73 val_f1:  0.7963059879954627 val_auroc:  0.873015873015873 val_auprc:  0.9343747919804726
Validation loss improved to 1.374081
epoch:  73
[Epoch 74, Batch 10] loss: 0.246
epoch:  74 val_f1:  0.7963059879954627 val_auroc:  0.873015873015873 val_auprc:  0.9344729511560016
Validation loss improved to 1.371095
epoch:  74
[Epoch 75, Batch 10] loss: 0.251
epoch:  75 val_f1:  0.795635738397158 val_auroc:  0.8737599206349207 val_auprc:  0.9347033204789504
EarlyStopping counter: 1 out of 50
epoch:  75
[Epoch 76, Batch 10] loss: 0.251
epoch:  76 val_f1:  0.807228002894545 val_auroc:  0.8735119047619049 val_auprc:  0.9346068827991771
EarlyStopping counter: 2 out of 50
epoch:  76
[Epoch 77, Batch 10] loss: 0.252
epoch:  77 val_f1:  0.8030193236714975 val_auroc:  0.8735119047619048 val_auprc:  0.9345499164858357
Validation loss improved to 1.365482
epoch:  77
[Epoch 78, Batch 10] loss: 0.228
epoch:  78 val_f1:  0.8023197893688181 val_auroc:  0.8742559523809524 val_auprc:  0.9343909718714973
EarlyStopping counter: 1 out of 50
epoch:  78
[Epoch 79, Batch 10] loss: 0.241
epoch:  79 val_f1:  0.8030193236714975 val_auroc:  0.8742559523809523 val_auprc:  0.9342686044946464
EarlyStopping counter: 2 out of 50
epoch:  79
[Epoch 80, Batch 10] loss: 0.254
epoch:  80 val_f1:  0.8090037477295196 val_auroc:  0.8742559523809523 val_auprc:  0.9350110650572447
EarlyStopping counter: 3 out of 50
epoch:  80
[Epoch 81, Batch 10] loss: 0.245
epoch:  81 val_f1:  0.7765822970867508 val_auroc:  0.8735119047619048 val_auprc:  0.9345399061091076
Validation loss improved to 1.353124
epoch:  81
[Epoch 82, Batch 10] loss: 0.241
epoch:  82 val_f1:  0.795635738397158 val_auroc:  0.8752480158730158 val_auprc:  0.9353893942233599
EarlyStopping counter: 1 out of 50
epoch:  82
[Epoch 83, Batch 10] loss: 0.244
epoch:  83 val_f1:  0.7833564971403972 val_auroc:  0.8757440476190477 val_auprc:  0.9357466499429579
Validation loss improved to 1.349458
epoch:  83
[Epoch 84, Batch 10] loss: 0.234
epoch:  84 val_f1:  0.8005921770297647 val_auroc:  0.8762400793650793 val_auprc:  0.9360714764208531
EarlyStopping counter: 1 out of 50
epoch:  84
[Epoch 85, Batch 10] loss: 0.248
epoch:  85 val_f1:  0.7963059879954627 val_auroc:  0.8757440476190477 val_auprc:  0.9357093018409911
EarlyStopping counter: 2 out of 50
epoch:  85
[Epoch 86, Batch 10] loss: 0.240
epoch:  86 val_f1:  0.7948558771909655 val_auroc:  0.8762400793650794 val_auprc:  0.93624504607777
EarlyStopping counter: 3 out of 50
epoch:  86
[Epoch 87, Batch 10] loss: 0.239
epoch:  87 val_f1:  0.8036150464093796 val_auroc:  0.8762400793650794 val_auprc:  0.9361102921740504
Validation loss improved to 1.346602
epoch:  87
[Epoch 88, Batch 10] loss: 0.233
epoch:  88 val_f1:  0.7948558771909655 val_auroc:  0.8752480158730158 val_auprc:  0.9355488600162574
EarlyStopping counter: 1 out of 50
epoch:  88
[Epoch 89, Batch 10] loss: 0.236
epoch:  89 val_f1:  0.7948558771909655 val_auroc:  0.8772321428571429 val_auprc:  0.936840125815908
EarlyStopping counter: 2 out of 50
epoch:  89
[Epoch 90, Batch 10] loss: 0.221
epoch:  90 val_f1:  0.7901185770750988 val_auroc:  0.8747519841269841 val_auprc:  0.9359670341998201
Validation loss improved to 1.343205
epoch:  90
[Epoch 91, Batch 10] loss: 0.240
epoch:  91 val_f1:  0.8005921770297647 val_auroc:  0.8767361111111112 val_auprc:  0.9367668604854577
EarlyStopping counter: 1 out of 50
epoch:  91
[Epoch 92, Batch 10] loss: 0.243
epoch:  92 val_f1:  0.7948558771909655 val_auroc:  0.8772321428571428 val_auprc:  0.9372834638657379
EarlyStopping counter: 2 out of 50
epoch:  92
[Epoch 93, Batch 10] loss: 0.241
epoch:  93 val_f1:  0.7948558771909655 val_auroc:  0.8762400793650793 val_auprc:  0.9368469715811297
EarlyStopping counter: 3 out of 50
epoch:  93
[Epoch 94, Batch 10] loss: 0.224
epoch:  94 val_f1:  0.7881997743237336 val_auroc:  0.876984126984127 val_auprc:  0.9372850470511829
EarlyStopping counter: 4 out of 50
epoch:  94
[Epoch 95, Batch 10] loss: 0.233
epoch:  95 val_f1:  0.7948558771909655 val_auroc:  0.8782242063492063 val_auprc:  0.937636375044691
EarlyStopping counter: 5 out of 50
epoch:  95
[Epoch 96, Batch 10] loss: 0.216
epoch:  96 val_f1:  0.8036150464093796 val_auroc:  0.8767361111111112 val_auprc:  0.9372007481515524
Validation loss improved to 1.341087
epoch:  96
[Epoch 97, Batch 10] loss: 0.219
epoch:  97 val_f1:  0.7881997743237336 val_auroc:  0.876984126984127 val_auprc:  0.9372210655208886
EarlyStopping counter: 1 out of 50
epoch:  97
[Epoch 98, Batch 10] loss: 0.207
epoch:  98 val_f1:  0.7881997743237336 val_auroc:  0.8772321428571428 val_auprc:  0.9374121540604377
EarlyStopping counter: 2 out of 50
epoch:  98
[Epoch 99, Batch 10] loss: 0.233
epoch:  99 val_f1:  0.7837457330597287 val_auroc:  0.8759920634920635 val_auprc:  0.9369325224713688
Validation loss improved to 1.335041
epoch:  99
[Epoch 100, Batch 10] loss: 0.220
epoch:  100 val_f1:  0.8061683443992288 val_auroc:  0.8762400793650793 val_auprc:  0.9371033569294818
EarlyStopping counter: 1 out of 50
epoch:  100
[Epoch 101, Batch 10] loss: 0.229
epoch:  101 val_f1:  0.7948558771909655 val_auroc:  0.8757440476190477 val_auprc:  0.936865469170372
EarlyStopping counter: 2 out of 50
epoch:  101
[Epoch 102, Batch 10] loss: 0.228
epoch:  102 val_f1:  0.7948558771909655 val_auroc:  0.8764880952380953 val_auprc:  0.9372629888399593
EarlyStopping counter: 3 out of 50
epoch:  102
[Epoch 103, Batch 10] loss: 0.221
epoch:  103 val_f1:  0.7881997743237336 val_auroc:  0.8752480158730158 val_auprc:  0.9367110901364326
EarlyStopping counter: 4 out of 50
epoch:  103
[Epoch 104, Batch 10] loss: 0.233
epoch:  104 val_f1:  0.7873345935727789 val_auroc:  0.8754960317460319 val_auprc:  0.9367363203831842
EarlyStopping counter: 5 out of 50
epoch:  104
[Epoch 105, Batch 10] loss: 0.188
epoch:  105 val_f1:  0.7873345935727789 val_auroc:  0.8754960317460317 val_auprc:  0.9368426546348397
EarlyStopping counter: 6 out of 50
epoch:  105
[Epoch 106, Batch 10] loss: 0.220
epoch:  106 val_f1:  0.7995542847531747 val_auroc:  0.8752480158730159 val_auprc:  0.9368421539343122
EarlyStopping counter: 7 out of 50
epoch:  106
[Epoch 107, Batch 10] loss: 0.219
epoch:  107 val_f1:  0.7881997743237336 val_auroc:  0.8754960317460317 val_auprc:  0.9370562287893208
EarlyStopping counter: 8 out of 50
epoch:  107
[Epoch 108, Batch 10] loss: 0.216
epoch:  108 val_f1:  0.7948558771909655 val_auroc:  0.8762400793650793 val_auprc:  0.9374213987933794
EarlyStopping counter: 9 out of 50
epoch:  108
[Epoch 109, Batch 10] loss: 0.207
epoch:  109 val_f1:  0.7881997743237336 val_auroc:  0.8767361111111112 val_auprc:  0.9375670239290135
EarlyStopping counter: 10 out of 50
epoch:  109
[Epoch 110, Batch 10] loss: 0.219
epoch:  110 val_f1:  0.7815416513900654 val_auroc:  0.875 val_auprc:  0.9367676005071862
EarlyStopping counter: 11 out of 50
epoch:  110
[Epoch 111, Batch 10] loss: 0.219
epoch:  111 val_f1:  0.7963059879954627 val_auroc:  0.8764880952380952 val_auprc:  0.937516806192308
EarlyStopping counter: 12 out of 50
epoch:  111
[Epoch 112, Batch 10] loss: 0.204
epoch:  112 val_f1:  0.8115942028985508 val_auroc:  0.8747519841269842 val_auprc:  0.9364500342126619
EarlyStopping counter: 13 out of 50
epoch:  112
[Epoch 113, Batch 10] loss: 0.218
epoch:  113 val_f1:  0.8030193236714975 val_auroc:  0.8759920634920635 val_auprc:  0.937111659331169
EarlyStopping counter: 14 out of 50
epoch:  113
[Epoch 114, Batch 10] loss: 0.214
epoch:  114 val_f1:  0.8005921770297647 val_auroc:  0.8740079365079365 val_auprc:  0.9361862725266672
EarlyStopping counter: 15 out of 50
epoch:  114
[Epoch 115, Batch 10] loss: 0.200
epoch:  115 val_f1:  0.7807080066524115 val_auroc:  0.8752480158730158 val_auprc:  0.9369136182613366
EarlyStopping counter: 16 out of 50
epoch:  115
[Epoch 116, Batch 10] loss: 0.221
epoch:  116 val_f1:  0.795635738397158 val_auroc:  0.8747519841269842 val_auprc:  0.936539548640187
EarlyStopping counter: 17 out of 50
epoch:  116
[Epoch 117, Batch 10] loss: 0.208
epoch:  117 val_f1:  0.8049865427618805 val_auroc:  0.8737599206349207 val_auprc:  0.9360686544086354
EarlyStopping counter: 18 out of 50
epoch:  117
[Epoch 118, Batch 10] loss: 0.213
epoch:  118 val_f1:  0.795635738397158 val_auroc:  0.8754960317460317 val_auprc:  0.9371153093290203
EarlyStopping counter: 19 out of 50
epoch:  118
[Epoch 119, Batch 10] loss: 0.212
epoch:  119 val_f1:  0.8049865427618805 val_auroc:  0.8745039682539683 val_auprc:  0.9364829709744362
EarlyStopping counter: 20 out of 50
epoch:  119
[Epoch 120, Batch 10] loss: 0.213
epoch:  120 val_f1:  0.8030193236714975 val_auroc:  0.875 val_auprc:  0.9367804498973591
Validation loss improved to 1.332050
epoch:  120
[Epoch 121, Batch 10] loss: 0.226
epoch:  121 val_f1:  0.8182185828242006 val_auroc:  0.873015873015873 val_auprc:  0.9356964856846876
EarlyStopping counter: 1 out of 50
epoch:  121
[Epoch 122, Batch 10] loss: 0.213
epoch:  122 val_f1:  0.7889492753623188 val_auroc:  0.8732638888888888 val_auprc:  0.9358584321414033
EarlyStopping counter: 2 out of 50
epoch:  122
[Epoch 123, Batch 10] loss: 0.205
epoch:  123 val_f1:  0.7873345935727789 val_auroc:  0.873263888888889 val_auprc:  0.9358921366767201
EarlyStopping counter: 3 out of 50
epoch:  123
[Epoch 124, Batch 10] loss: 0.201
epoch:  124 val_f1:  0.7995542847531747 val_auroc:  0.873015873015873 val_auprc:  0.9357101519465982
EarlyStopping counter: 4 out of 50
epoch:  124
[Epoch 125, Batch 10] loss: 0.193
epoch:  125 val_f1:  0.7873345935727789 val_auroc:  0.873263888888889 val_auprc:  0.9358059258769689
EarlyStopping counter: 5 out of 50
epoch:  125
[Epoch 126, Batch 10] loss: 0.192
epoch:  126 val_f1:  0.8005921770297647 val_auroc:  0.873263888888889 val_auprc:  0.9358731425852432
EarlyStopping counter: 6 out of 50
epoch:  126
[Epoch 127, Batch 10] loss: 0.202
epoch:  127 val_f1:  0.8005921770297647 val_auroc:  0.8737599206349206 val_auprc:  0.9359937909425982
EarlyStopping counter: 7 out of 50
epoch:  127
[Epoch 128, Batch 10] loss: 0.208
epoch:  128 val_f1:  0.7948558771909655 val_auroc:  0.8735119047619049 val_auprc:  0.9360246784316073
EarlyStopping counter: 8 out of 50
epoch:  128
[Epoch 129, Batch 10] loss: 0.205
epoch:  129 val_f1:  0.79396185483142 val_auroc:  0.8732638888888888 val_auprc:  0.9357668892597497
EarlyStopping counter: 9 out of 50
epoch:  129
[Epoch 130, Batch 10] loss: 0.183
epoch:  130 val_f1:  0.8182185828242006 val_auroc:  0.8737599206349206 val_auprc:  0.9359517113115334
EarlyStopping counter: 10 out of 50
epoch:  130
[Epoch 131, Batch 10] loss: 0.189
epoch:  131 val_f1:  0.7948558771909655 val_auroc:  0.873263888888889 val_auprc:  0.9356934979129139
EarlyStopping counter: 11 out of 50
epoch:  131
[Epoch 132, Batch 10] loss: 0.200
epoch:  132 val_f1:  0.8061683443992288 val_auroc:  0.873015873015873 val_auprc:  0.9356300718284807
EarlyStopping counter: 12 out of 50
epoch:  132
[Epoch 133, Batch 10] loss: 0.192
epoch:  133 val_f1:  0.79396185483142 val_auroc:  0.873015873015873 val_auprc:  0.9355903390805924
EarlyStopping counter: 13 out of 50
epoch:  133
[Epoch 134, Batch 10] loss: 0.200
epoch:  134 val_f1:  0.79396185483142 val_auroc:  0.8717757936507936 val_auprc:  0.9351889752204166
EarlyStopping counter: 14 out of 50
epoch:  134
[Epoch 135, Batch 10] loss: 0.201
epoch:  135 val_f1:  0.7995542847531747 val_auroc:  0.873263888888889 val_auprc:  0.9356903472648397
EarlyStopping counter: 15 out of 50
epoch:  135
[Epoch 136, Batch 10] loss: 0.196
epoch:  136 val_f1:  0.7881997743237336 val_auroc:  0.8720238095238095 val_auprc:  0.9353617286641616
EarlyStopping counter: 16 out of 50
epoch:  136
[Epoch 137, Batch 10] loss: 0.189
epoch:  137 val_f1:  0.791810443984357 val_auroc:  0.8712797619047619 val_auprc:  0.9349762873066152
EarlyStopping counter: 17 out of 50
epoch:  137
[Epoch 138, Batch 10] loss: 0.188
epoch:  138 val_f1:  0.79396185483142 val_auroc:  0.8720238095238095 val_auprc:  0.9352292476931746
EarlyStopping counter: 18 out of 50
epoch:  138
[Epoch 139, Batch 10] loss: 0.206
epoch:  139 val_f1:  0.8115942028985508 val_auroc:  0.8717757936507937 val_auprc:  0.9350561248456754
EarlyStopping counter: 19 out of 50
epoch:  139
[Epoch 140, Batch 10] loss: 0.197
epoch:  140 val_f1:  0.79396185483142 val_auroc:  0.8715277777777778 val_auprc:  0.9351031890562522
EarlyStopping counter: 20 out of 50
epoch:  140
[Epoch 141, Batch 10] loss: 0.188
epoch:  141 val_f1:  0.7983928476398275 val_auroc:  0.8705357142857143 val_auprc:  0.934618619091104
EarlyStopping counter: 21 out of 50
epoch:  141
[Epoch 142, Batch 10] loss: 0.181
epoch:  142 val_f1:  0.8115942028985508 val_auroc:  0.8707837301587302 val_auprc:  0.9347076622302579
EarlyStopping counter: 22 out of 50
epoch:  142
[Epoch 143, Batch 10] loss: 0.186
epoch:  143 val_f1:  0.8182185828242006 val_auroc:  0.8705357142857144 val_auprc:  0.9346123256026727
EarlyStopping counter: 23 out of 50
epoch:  143
[Epoch 144, Batch 10] loss: 0.188
epoch:  144 val_f1:  0.7948558771909655 val_auroc:  0.8712797619047619 val_auprc:  0.9349445719248973
EarlyStopping counter: 24 out of 50
epoch:  144
[Epoch 145, Batch 10] loss: 0.178
epoch:  145 val_f1:  0.8115942028985508 val_auroc:  0.8705357142857142 val_auprc:  0.9344163051303896
EarlyStopping counter: 25 out of 50
epoch:  145
[Epoch 146, Batch 10] loss: 0.177
epoch:  146 val_f1:  0.7863487611033193 val_auroc:  0.8712797619047619 val_auprc:  0.9354480535050371
EarlyStopping counter: 26 out of 50
epoch:  146
[Epoch 147, Batch 10] loss: 0.184
epoch:  147 val_f1:  0.8382209405501332 val_auroc:  0.8712797619047619 val_auprc:  0.9352345220491195
EarlyStopping counter: 27 out of 50
epoch:  147
[Epoch 148, Batch 10] loss: 0.188
epoch:  148 val_f1:  0.8015122873345937 val_auroc:  0.8715277777777778 val_auprc:  0.9351048771117252
EarlyStopping counter: 28 out of 50
epoch:  148
[Epoch 149, Batch 10] loss: 0.191
epoch:  149 val_f1:  0.7863487611033193 val_auroc:  0.871031746031746 val_auprc:  0.9349572546138287
EarlyStopping counter: 29 out of 50
epoch:  149
[Epoch 150, Batch 10] loss: 0.167
epoch:  150 val_f1:  0.8182185828242006 val_auroc:  0.8705357142857143 val_auprc:  0.9343641626914383
EarlyStopping counter: 30 out of 50
epoch:  150
[Epoch 151, Batch 10] loss: 0.165
epoch:  151 val_f1:  0.8023197893688181 val_auroc:  0.871031746031746 val_auprc:  0.9347873092147874
EarlyStopping counter: 31 out of 50
epoch:  151
[Epoch 152, Batch 10] loss: 0.183
epoch:  152 val_f1:  0.8182185828242006 val_auroc:  0.8702876984126985 val_auprc:  0.9340714615113541
EarlyStopping counter: 32 out of 50
epoch:  152
[Epoch 153, Batch 10] loss: 0.179
epoch:  153 val_f1:  0.8138718358422335 val_auroc:  0.871031746031746 val_auprc:  0.9356582676627425
EarlyStopping counter: 33 out of 50
epoch:  153
[Epoch 154, Batch 10] loss: 0.185
epoch:  154 val_f1:  0.8061683443992288 val_auroc:  0.8727678571428571 val_auprc:  0.9364396819016918
EarlyStopping counter: 34 out of 50
epoch:  154
[Epoch 155, Batch 10] loss: 0.193
epoch:  155 val_f1:  0.8061683443992288 val_auroc:  0.8715277777777778 val_auprc:  0.9353701132407402
EarlyStopping counter: 35 out of 50
epoch:  155
[Epoch 156, Batch 10] loss: 0.177
epoch:  156 val_f1:  0.8005921770297647 val_auroc:  0.8722718253968255 val_auprc:  0.9361649224008736
EarlyStopping counter: 36 out of 50
epoch:  156
[Epoch 157, Batch 10] loss: 0.171
epoch:  157 val_f1:  0.8194319840387783 val_auroc:  0.8727678571428572 val_auprc:  0.9365451300115302
EarlyStopping counter: 37 out of 50
epoch:  157
[Epoch 158, Batch 10] loss: 0.183
epoch:  158 val_f1:  0.8061683443992288 val_auroc:  0.8722718253968255 val_auprc:  0.9364363690121856
EarlyStopping counter: 38 out of 50
epoch:  158
[Epoch 159, Batch 10] loss: 0.173
epoch:  159 val_f1:  0.8115942028985508 val_auroc:  0.8722718253968255 val_auprc:  0.9363520929615858
EarlyStopping counter: 39 out of 50
epoch:  159
[Epoch 160, Batch 10] loss: 0.175
epoch:  160 val_f1:  0.8194319840387783 val_auroc:  0.8725198412698412 val_auprc:  0.9364295890145142
EarlyStopping counter: 40 out of 50
epoch:  160
[Epoch 161, Batch 10] loss: 0.176
epoch:  161 val_f1:  0.8182185828242006 val_auroc:  0.8720238095238095 val_auprc:  0.9361538149324256
EarlyStopping counter: 41 out of 50
epoch:  161
[Epoch 162, Batch 10] loss: 0.164
epoch:  162 val_f1:  0.8061683443992288 val_auroc:  0.8725198412698413 val_auprc:  0.9364099997786458
EarlyStopping counter: 42 out of 50
epoch:  162
[Epoch 163, Batch 10] loss: 0.175
epoch:  163 val_f1:  0.8248625247346153 val_auroc:  0.871031746031746 val_auprc:  0.9352901402105118
EarlyStopping counter: 43 out of 50
epoch:  163
[Epoch 164, Batch 10] loss: 0.180
epoch:  164 val_f1:  0.8023197893688181 val_auroc:  0.8720238095238095 val_auprc:  0.9354865568706001
EarlyStopping counter: 44 out of 50
epoch:  164
[Epoch 165, Batch 10] loss: 0.183
epoch:  165 val_f1:  0.8168793096329329 val_auroc:  0.8717757936507937 val_auprc:  0.9354791357397033
EarlyStopping counter: 45 out of 50
epoch:  165
[Epoch 166, Batch 10] loss: 0.172
epoch:  166 val_f1:  0.8015122873345937 val_auroc:  0.8720238095238095 val_auprc:  0.9360008112280412
EarlyStopping counter: 46 out of 50
epoch:  166
[Epoch 167, Batch 10] loss: 0.166
epoch:  167 val_f1:  0.8182185828242006 val_auroc:  0.8707837301587301 val_auprc:  0.9351106315780626
EarlyStopping counter: 47 out of 50
epoch:  167
[Epoch 168, Batch 10] loss: 0.181
epoch:  168 val_f1:  0.8182185828242006 val_auroc:  0.871031746031746 val_auprc:  0.9351620822951385
EarlyStopping counter: 48 out of 50
epoch:  168
[Epoch 169, Batch 10] loss: 0.169
epoch:  169 val_f1:  0.8127933585226971 val_auroc:  0.871031746031746 val_auprc:  0.9353401190925275
EarlyStopping counter: 49 out of 50
epoch:  169
[Epoch 170, Batch 10] loss: 0.169
epoch:  170 val_f1:  0.8127933585226971 val_auroc:  0.8715277777777777 val_auprc:  0.9354106900490536
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  974.9886620044708
{'time_elapsed': [974.9886620044708], 'epoch': [169], 'fold': [4], 'f1_train': [0.9039195839241361], 'auroc_train': [0.9720196321269666], 'auprc_train': [0.9886486548031166], 'f1_test': [0.8127933585226971], 'auroc_test': [0.8715277777777777], 'auprc_test': [0.9354106900490536]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [32, 1]                   --
├─Sequential: 1-1                        [32, 1]                   --
│    └─Conv1d: 2-1                       [32, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [32, 1024, 427]           2,048
│    └─Tanh: 2-3                         [32, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [32, 1024, 142]           --
│    └─Dropout: 2-5                      [32, 1024, 142]           --
│    └─Flatten: 2-6                      [32, 145408]              --
│    └─Linear: 2-7                       [32, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.16
Forward/backward pass size (MB): 223.87
Params size (MB): 0.61
Estimated Total Size (MB): 224.64
==========================================================================================
