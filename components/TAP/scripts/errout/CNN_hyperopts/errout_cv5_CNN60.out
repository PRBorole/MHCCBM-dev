config:  {'project': 'MHCCBM', 'name': 'CNN_60', 'config': {'hidden_channels': [256], 'epochs': 500, 'kernel_size': 5, 'pool_kernel_size': 5, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5088427160369606 val_auroc:  0.6723122238586156 val_auprc:  0.7683405795913767
epoch:  1
epoch:  2 val_f1:  0.6375684773282293 val_auroc:  0.6935444280805105 val_auprc:  0.8430161155365543
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6997814539066421 val_auroc:  0.7167403043691704 val_auprc:  0.86535497710531
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6301488691399822 val_auroc:  0.7334315169366716 val_auprc:  0.8728297582291474
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6894622188638474 val_auroc:  0.7579774177712322 val_auprc:  0.8832137505866741
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6963686193902022 val_auroc:  0.757486499754541 val_auprc:  0.8858579415784238
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.6962806225607748 val_auroc:  0.7729504172803142 val_auprc:  0.8988780282079566
Validation loss improved to 1.144232
epoch:  7
epoch:  8 val_f1:  0.743431836172277 val_auroc:  0.7933235149729996 val_auprc:  0.9115029548563491
Validation loss improved to 0.867643
epoch:  8
epoch:  9 val_f1:  0.6416835003980583 val_auroc:  0.8041237113402062 val_auprc:  0.9170942787917471
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7169009504644194 val_auroc:  0.7972508591065293 val_auprc:  0.9103984491304555
Validation loss improved to 0.767407
epoch:  10
epoch:  11 val_f1:  0.696151679426677 val_auroc:  0.80559646539028 val_auprc:  0.9160022404281353
Validation loss improved to 0.754358
epoch:  11
epoch:  12 val_f1:  0.7029258641632973 val_auroc:  0.8122238586156112 val_auprc:  0.9200901594567
Validation loss improved to 0.723600
epoch:  12
epoch:  13 val_f1:  0.7681512331200245 val_auroc:  0.7957781050564556 val_auprc:  0.9081295470821658
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7639705763479104 val_auroc:  0.8075601374570447 val_auprc:  0.9172249431719625
Validation loss improved to 0.684669
epoch:  14
epoch:  15 val_f1:  0.7376969013024874 val_auroc:  0.8097692685321551 val_auprc:  0.9178520734027371
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7777125328082551 val_auroc:  0.8092783505154639 val_auprc:  0.9168396366151976
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.7510257046352308 val_auroc:  0.8124693176239568 val_auprc:  0.9195152416078096
Validation loss improved to 0.636895
epoch:  17
epoch:  18 val_f1:  0.7510724063582411 val_auroc:  0.8070692194403535 val_auprc:  0.912648227936017
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7442757932382417 val_auroc:  0.8286696121747668 val_auprc:  0.9284443695542374
Validation loss improved to 0.599092
epoch:  19
epoch:  20 val_f1:  0.742136387976997 val_auroc:  0.8073146784486991 val_auprc:  0.9111092081896424
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.6515899973778831 val_auroc:  0.8195876288659794 val_auprc:  0.9197337548110984
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7905466835322951 val_auroc:  0.8259695630829652 val_auprc:  0.9284541025625284
Validation loss improved to 0.587469
epoch:  22
epoch:  23 val_f1:  0.743914028278071 val_auroc:  0.8232695139911635 val_auprc:  0.9208294517443348
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7826417810500232 val_auroc:  0.8070692194403535 val_auprc:  0.9089422651958146
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.7442757932382417 val_auroc:  0.8303878252331861 val_auprc:  0.9264866602198738
EarlyStopping counter: 3 out of 50
epoch:  25
epoch:  26 val_f1:  0.7868059619290214 val_auroc:  0.8350515463917525 val_auprc:  0.9303561856211775
EarlyStopping counter: 4 out of 50
epoch:  26
epoch:  27 val_f1:  0.7371937993371881 val_auroc:  0.8232695139911634 val_auprc:  0.9215395079426323
EarlyStopping counter: 5 out of 50
epoch:  27
epoch:  28 val_f1:  0.7971323289800215 val_auroc:  0.816151202749141 val_auprc:  0.915930441783888
EarlyStopping counter: 6 out of 50
epoch:  28
epoch:  29 val_f1:  0.7573003855683703 val_auroc:  0.8269513991163476 val_auprc:  0.9257861001116491
EarlyStopping counter: 7 out of 50
epoch:  29
epoch:  30 val_f1:  0.8010188978004199 val_auroc:  0.8286696121747668 val_auprc:  0.9262953014745497
EarlyStopping counter: 8 out of 50
epoch:  30
epoch:  31 val_f1:  0.7573003855683703 val_auroc:  0.8264604810996564 val_auprc:  0.9247740511792841
EarlyStopping counter: 9 out of 50
epoch:  31
epoch:  32 val_f1:  0.7944676896257205 val_auroc:  0.8345606283750613 val_auprc:  0.9308908146606614
EarlyStopping counter: 10 out of 50
epoch:  32
epoch:  33 val_f1:  0.8029873436454202 val_auroc:  0.8269513991163475 val_auprc:  0.9252385680916025
EarlyStopping counter: 11 out of 50
epoch:  33
epoch:  34 val_f1:  0.7506155503404762 val_auroc:  0.8262150220913108 val_auprc:  0.9248912197686654
EarlyStopping counter: 12 out of 50
epoch:  34
epoch:  35 val_f1:  0.8010188978004199 val_auroc:  0.8232695139911635 val_auprc:  0.9233916370590375
EarlyStopping counter: 13 out of 50
epoch:  35
epoch:  36 val_f1:  0.8020613296596766 val_auroc:  0.8203240058910162 val_auprc:  0.9211357250491661
EarlyStopping counter: 14 out of 50
epoch:  36
epoch:  37 val_f1:  0.7823449348629204 val_auroc:  0.8308787432498773 val_auprc:  0.9284349297485915
EarlyStopping counter: 15 out of 50
epoch:  37
epoch:  38 val_f1:  0.7897879661118469 val_auroc:  0.8267059401080019 val_auprc:  0.9254444488561373
EarlyStopping counter: 16 out of 50
epoch:  38
epoch:  39 val_f1:  0.7963871971298289 val_auroc:  0.8328424153166422 val_auprc:  0.9294406968770432
EarlyStopping counter: 17 out of 50
epoch:  39
epoch:  40 val_f1:  0.7496568898727172 val_auroc:  0.8183603338242514 val_auprc:  0.9185971523576082
EarlyStopping counter: 18 out of 50
epoch:  40
epoch:  41 val_f1:  0.7307708780682615 val_auroc:  0.8316151202749141 val_auprc:  0.9292283747428935
EarlyStopping counter: 19 out of 50
epoch:  41
epoch:  42 val_f1:  0.7855581813618873 val_auroc:  0.8181148748159058 val_auprc:  0.9203375284005759
EarlyStopping counter: 20 out of 50
epoch:  42
epoch:  43 val_f1:  0.7944676896257205 val_auroc:  0.825478645066274 val_auprc:  0.9253083033645124
EarlyStopping counter: 21 out of 50
epoch:  43
epoch:  44 val_f1:  0.7839141001375581 val_auroc:  0.8355424644084438 val_auprc:  0.9321458952927326
EarlyStopping counter: 22 out of 50
epoch:  44
epoch:  45 val_f1:  0.7745465218349855 val_auroc:  0.8217967599410898 val_auprc:  0.9208636182089593
EarlyStopping counter: 23 out of 50
epoch:  45
epoch:  46 val_f1:  0.8010188978004199 val_auroc:  0.8227785959744722 val_auprc:  0.9225091379053629
EarlyStopping counter: 24 out of 50
epoch:  46
epoch:  47 val_f1:  0.8010188978004199 val_auroc:  0.8262150220913108 val_auprc:  0.9250094822843091
EarlyStopping counter: 25 out of 50
epoch:  47
epoch:  48 val_f1:  0.7933255489848959 val_auroc:  0.8237604320078546 val_auprc:  0.9229058252543975
EarlyStopping counter: 26 out of 50
epoch:  48
epoch:  49 val_f1:  0.8010188978004199 val_auroc:  0.8308787432498773 val_auprc:  0.9278176390514896
EarlyStopping counter: 27 out of 50
epoch:  49
epoch:  50 val_f1:  0.8010188978004199 val_auroc:  0.8269513991163476 val_auprc:  0.9254124087847548
EarlyStopping counter: 28 out of 50
epoch:  50
epoch:  51 val_f1:  0.7745465218349855 val_auroc:  0.8249877270495827 val_auprc:  0.9235199904265576
EarlyStopping counter: 29 out of 50
epoch:  51
epoch:  52 val_f1:  0.7933255489848959 val_auroc:  0.824251350024546 val_auprc:  0.9234941258432374
EarlyStopping counter: 30 out of 50
epoch:  52
epoch:  53 val_f1:  0.7777125328082551 val_auroc:  0.8249877270495827 val_auprc:  0.9239938679120754
EarlyStopping counter: 31 out of 50
epoch:  53
epoch:  54 val_f1:  0.8010188978004199 val_auroc:  0.8279332351497299 val_auprc:  0.9274358883668246
EarlyStopping counter: 32 out of 50
epoch:  54
epoch:  55 val_f1:  0.8010188978004199 val_auroc:  0.8257241040746195 val_auprc:  0.924859861129334
EarlyStopping counter: 33 out of 50
epoch:  55
epoch:  56 val_f1:  0.8010188978004199 val_auroc:  0.8269513991163475 val_auprc:  0.9258133299440693
EarlyStopping counter: 34 out of 50
epoch:  56
epoch:  57 val_f1:  0.8010188978004199 val_auroc:  0.8247422680412371 val_auprc:  0.9252586686665979
EarlyStopping counter: 35 out of 50
epoch:  57
epoch:  58 val_f1:  0.8010188978004199 val_auroc:  0.8225331369661266 val_auprc:  0.9234049799373533
EarlyStopping counter: 36 out of 50
epoch:  58
epoch:  59 val_f1:  0.8010188978004199 val_auroc:  0.8262150220913107 val_auprc:  0.925577631719564
EarlyStopping counter: 37 out of 50
epoch:  59
epoch:  60 val_f1:  0.7963871971298289 val_auroc:  0.8308787432498772 val_auprc:  0.928485059566037
EarlyStopping counter: 38 out of 50
epoch:  60
epoch:  61 val_f1:  0.7697841726618705 val_auroc:  0.8262150220913107 val_auprc:  0.9250466666781902
EarlyStopping counter: 39 out of 50
epoch:  61
epoch:  62 val_f1:  0.8010188978004199 val_auroc:  0.82793323514973 val_auprc:  0.9272108768072085
EarlyStopping counter: 40 out of 50
epoch:  62
epoch:  63 val_f1:  0.7765831291011147 val_auroc:  0.8311242022582229 val_auprc:  0.9281157069655173
EarlyStopping counter: 41 out of 50
epoch:  63
epoch:  64 val_f1:  0.8010188978004199 val_auroc:  0.829160530191458 val_auprc:  0.9281405632207242
EarlyStopping counter: 42 out of 50
epoch:  64
epoch:  65 val_f1:  0.7681512331200245 val_auroc:  0.8269513991163475 val_auprc:  0.9253798528684665
EarlyStopping counter: 43 out of 50
epoch:  65
epoch:  66 val_f1:  0.7617684906754855 val_auroc:  0.8244968090328915 val_auprc:  0.9234064177357055
EarlyStopping counter: 44 out of 50
epoch:  66
epoch:  67 val_f1:  0.7933255489848959 val_auroc:  0.8276877761413844 val_auprc:  0.9263597176181518
EarlyStopping counter: 45 out of 50
epoch:  67
epoch:  68 val_f1:  0.7536606851900262 val_auroc:  0.8259695630829652 val_auprc:  0.924553226985411
EarlyStopping counter: 46 out of 50
epoch:  68
epoch:  69 val_f1:  0.7697841726618705 val_auroc:  0.8286696121747668 val_auprc:  0.9264125829931042
EarlyStopping counter: 47 out of 50
epoch:  69
epoch:  70 val_f1:  0.7697841726618705 val_auroc:  0.8247422680412371 val_auprc:  0.9237340508621362
EarlyStopping counter: 48 out of 50
epoch:  70
epoch:  71 val_f1:  0.7777125328082551 val_auroc:  0.8249877270495827 val_auprc:  0.9241846056605354
EarlyStopping counter: 49 out of 50
epoch:  71
epoch:  72 val_f1:  0.7697841726618705 val_auroc:  0.8262150220913107 val_auprc:  0.9250137268144373
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  519.9717004299164
{'time_elapsed': [519.9717004299164], 'epoch': [71], 'fold': [0], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7697841726618705], 'auroc_test': [0.8262150220913107], 'auprc_test': [0.9250137268144373]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1278]           1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 1278]           512
│    └─Tanh: 2-3                         [64, 256, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1274]           --
│    └─Dropout: 2-5                      [64, 256, 1274]           --
│    └─Flatten: 2-6                      [64, 326144]              --
│    └─Linear: 2-7                       [64, 1]                   326,145
==========================================================================================
Total params: 328,193
Trainable params: 328,193
Non-trainable params: 0
Total mult-adds (M): 146.54
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.02
Params size (MB): 1.31
Estimated Total Size (MB): 336.66
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.6318114874815906 val_auprc:  0.8403773408199922
epoch:  1
epoch:  2 val_f1:  0.5853772378229669 val_auroc:  0.6071428571428572 val_auprc:  0.8369108335712083
Validation loss improved to 2.848907
epoch:  2
epoch:  3 val_f1:  0.6687180376180983 val_auroc:  0.6637211585665194 val_auprc:  0.8614459955816917
Validation loss improved to 1.837690
epoch:  3
epoch:  4 val_f1:  0.6633812949640289 val_auroc:  0.6912125675012273 val_auprc:  0.875414156051308
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.6607005776287218 val_auroc:  0.7459499263622975 val_auprc:  0.8978452968964012
Validation loss improved to 0.980232
epoch:  5
epoch:  6 val_f1:  0.7328919440906961 val_auroc:  0.8016691212567502 val_auprc:  0.9170280027272536
Validation loss improved to 0.587313
epoch:  6
epoch:  7 val_f1:  0.7390688025474315 val_auroc:  0.8092783505154639 val_auprc:  0.9157607078591259
Validation loss improved to 0.396901
epoch:  7
epoch:  8 val_f1:  0.7307106601978622 val_auroc:  0.8100147275405007 val_auprc:  0.9213769526011772
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7307106601978622 val_auroc:  0.8095238095238095 val_auprc:  0.923979567735886
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.7349308245711123 val_auroc:  0.8119783996072656 val_auprc:  0.9229477158342311
Validation loss improved to 0.321775
epoch:  10
epoch:  11 val_f1:  0.7841726618705036 val_auroc:  0.8100147275405006 val_auprc:  0.9178882169972409
Validation loss improved to 0.274134
epoch:  11
epoch:  12 val_f1:  0.7633550302615051 val_auroc:  0.8193421698576339 val_auprc:  0.9213875567931263
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7712620601193464 val_auroc:  0.8213058419243986 val_auprc:  0.9244228351613971
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.7802930475309426 val_auroc:  0.8178694158075602 val_auprc:  0.9190659399745693
EarlyStopping counter: 3 out of 50
epoch:  14
epoch:  15 val_f1:  0.7473654218886486 val_auroc:  0.8237604320078546 val_auprc:  0.9215326348160042
Validation loss improved to 0.247902
epoch:  15
epoch:  16 val_f1:  0.7236892364125374 val_auroc:  0.8195876288659794 val_auprc:  0.9222797345988138
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7685409504908388 val_auroc:  0.8289150711831124 val_auprc:  0.9234879655969156
Validation loss improved to 0.232147
epoch:  17
epoch:  18 val_f1:  0.7933255489848959 val_auroc:  0.8289150711831124 val_auprc:  0.9240981637910078
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.687028943170779 val_auroc:  0.8333333333333334 val_auprc:  0.9248903232066846
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.743914028278071 val_auroc:  0.8318605792832596 val_auprc:  0.9259161172644883
EarlyStopping counter: 3 out of 50
epoch:  20
epoch:  21 val_f1:  0.7868059619290214 val_auroc:  0.8259695630829651 val_auprc:  0.9224208355289922
EarlyStopping counter: 4 out of 50
epoch:  21
epoch:  22 val_f1:  0.7791090204759269 val_auroc:  0.8313696612665685 val_auprc:  0.9259255030730614
EarlyStopping counter: 5 out of 50
epoch:  22
epoch:  23 val_f1:  0.7376969013024874 val_auroc:  0.8262150220913108 val_auprc:  0.9231084616051645
EarlyStopping counter: 6 out of 50
epoch:  23
epoch:  24 val_f1:  0.7067808808208037 val_auroc:  0.8321060382916053 val_auprc:  0.9211362170054233
Validation loss improved to 0.231128
epoch:  24
epoch:  25 val_f1:  0.7506155503404762 val_auroc:  0.8222876779577811 val_auprc:  0.918367984506954
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.7971323289800215 val_auroc:  0.82793323514973 val_auprc:  0.919164652547021
Validation loss improved to 0.216799
epoch:  26
epoch:  27 val_f1:  0.7879228532067962 val_auroc:  0.8325969563082966 val_auprc:  0.9239230483877389
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7890919075230509 val_auroc:  0.8301423662248405 val_auprc:  0.9223703807189514
EarlyStopping counter: 2 out of 50
epoch:  28
epoch:  29 val_f1:  0.7971323289800215 val_auroc:  0.8313696612665685 val_auprc:  0.9222798684260508
EarlyStopping counter: 3 out of 50
epoch:  29
epoch:  30 val_f1:  0.7971323289800215 val_auroc:  0.82793323514973 val_auprc:  0.9191879631812574
EarlyStopping counter: 4 out of 50
epoch:  30
epoch:  31 val_f1:  0.7855164986057286 val_auroc:  0.8286696121747669 val_auprc:  0.9183536893696674
Validation loss improved to 0.203391
epoch:  31
epoch:  32 val_f1:  0.7855581813618873 val_auroc:  0.8267059401080019 val_auprc:  0.9186087010742658
EarlyStopping counter: 1 out of 50
epoch:  32
epoch:  33 val_f1:  0.6925918724479876 val_auroc:  0.8271968581246932 val_auprc:  0.9172928610729991
EarlyStopping counter: 2 out of 50
epoch:  33
epoch:  34 val_f1:  0.5942613741174892 val_auroc:  0.8195876288659795 val_auprc:  0.9215503133680735
EarlyStopping counter: 3 out of 50
epoch:  34
epoch:  35 val_f1:  0.7324246948924567 val_auroc:  0.8279332351497299 val_auprc:  0.9202782863478819
EarlyStopping counter: 4 out of 50
epoch:  35
epoch:  36 val_f1:  0.7809570525397864 val_auroc:  0.8281786941580757 val_auprc:  0.9188593107796165
EarlyStopping counter: 5 out of 50
epoch:  36
epoch:  37 val_f1:  0.7633550302615051 val_auroc:  0.8311242022582229 val_auprc:  0.9215989984896351
EarlyStopping counter: 6 out of 50
epoch:  37
epoch:  38 val_f1:  0.7727225509205256 val_auroc:  0.8227785959744723 val_auprc:  0.9167802546006079
EarlyStopping counter: 7 out of 50
epoch:  38
epoch:  39 val_f1:  0.7082463061808618 val_auroc:  0.8271968581246932 val_auprc:  0.9182920775764287
EarlyStopping counter: 8 out of 50
epoch:  39
epoch:  40 val_f1:  0.7707245329923307 val_auroc:  0.8171330387825234 val_auprc:  0.9135537690637254
EarlyStopping counter: 9 out of 50
epoch:  40
epoch:  41 val_f1:  0.7777125328082551 val_auroc:  0.8281786941580755 val_auprc:  0.9181330095766577
EarlyStopping counter: 10 out of 50
epoch:  41
epoch:  42 val_f1:  0.7841726618705036 val_auroc:  0.8257241040746196 val_auprc:  0.9169545797503174
EarlyStopping counter: 11 out of 50
epoch:  42
epoch:  43 val_f1:  0.7483101088021195 val_auroc:  0.8232695139911635 val_auprc:  0.9144065037684878
Validation loss improved to 0.190955
epoch:  43
epoch:  44 val_f1:  0.7955599157038007 val_auroc:  0.8294059891998036 val_auprc:  0.918110782309962
EarlyStopping counter: 1 out of 50
epoch:  44
epoch:  45 val_f1:  0.7790721385700611 val_auroc:  0.8225331369661266 val_auprc:  0.9159007006049878
EarlyStopping counter: 2 out of 50
epoch:  45
epoch:  46 val_f1:  0.7748796193569787 val_auroc:  0.8267059401080019 val_auprc:  0.9153062636956373
Validation loss improved to 0.179000
epoch:  46
epoch:  47 val_f1:  0.7661589271850144 val_auroc:  0.8230240549828178 val_auprc:  0.9132873573496272
EarlyStopping counter: 1 out of 50
epoch:  47
epoch:  48 val_f1:  0.7745465218349855 val_auroc:  0.8230240549828178 val_auprc:  0.9147403303387778
EarlyStopping counter: 2 out of 50
epoch:  48
epoch:  49 val_f1:  0.7727225509205256 val_auroc:  0.8188512518409425 val_auprc:  0.9111480004357473
EarlyStopping counter: 3 out of 50
epoch:  49
epoch:  50 val_f1:  0.7809570525397864 val_auroc:  0.8183603338242513 val_auprc:  0.9096775907104178
EarlyStopping counter: 4 out of 50
epoch:  50
epoch:  51 val_f1:  0.7906450372602754 val_auroc:  0.8188512518409424 val_auprc:  0.9103360002969246
EarlyStopping counter: 5 out of 50
epoch:  51
epoch:  52 val_f1:  0.757304835743056 val_auroc:  0.8190967108492883 val_auprc:  0.9084112549391691
EarlyStopping counter: 6 out of 50
epoch:  52
epoch:  53 val_f1:  0.7685409504908388 val_auroc:  0.8222876779577811 val_auprc:  0.9079911606177716
EarlyStopping counter: 7 out of 50
epoch:  53
epoch:  54 val_f1:  0.7643829551743221 val_auroc:  0.8178694158075601 val_auprc:  0.9063480857291759
EarlyStopping counter: 8 out of 50
epoch:  54
epoch:  55 val_f1:  0.7510724063582411 val_auroc:  0.8190967108492881 val_auprc:  0.907452966721007
EarlyStopping counter: 9 out of 50
epoch:  55
epoch:  56 val_f1:  0.7823449348629204 val_auroc:  0.821060382916053 val_auprc:  0.9125775972697251
EarlyStopping counter: 10 out of 50
epoch:  56
epoch:  57 val_f1:  0.7770871369605723 val_auroc:  0.8171330387825233 val_auprc:  0.9044362937343791
Validation loss improved to 0.178722
epoch:  57
epoch:  58 val_f1:  0.7635640416019908 val_auroc:  0.8168875797741777 val_auprc:  0.9012216752710591
Validation loss improved to 0.167472
epoch:  58
epoch:  59 val_f1:  0.7536081085870222 val_auroc:  0.814923907707413 val_auprc:  0.905141603968027
EarlyStopping counter: 1 out of 50
epoch:  59
epoch:  60 val_f1:  0.7598715939807772 val_auroc:  0.817378497790869 val_auprc:  0.8988359028364341
Validation loss improved to 0.164430
epoch:  60
epoch:  61 val_f1:  0.7510724063582411 val_auroc:  0.8178694158075601 val_auprc:  0.9000442097484036
EarlyStopping counter: 1 out of 50
epoch:  61
epoch:  62 val_f1:  0.7809570525397864 val_auroc:  0.8195876288659794 val_auprc:  0.9077686489437828
EarlyStopping counter: 2 out of 50
epoch:  62
epoch:  63 val_f1:  0.7727225509205256 val_auroc:  0.8237604320078546 val_auprc:  0.912419227247211
EarlyStopping counter: 3 out of 50
epoch:  63
epoch:  64 val_f1:  0.7643829551743221 val_auroc:  0.8217967599410898 val_auprc:  0.9096089967879672
EarlyStopping counter: 4 out of 50
epoch:  64
epoch:  65 val_f1:  0.7707245329923307 val_auroc:  0.8181148748159057 val_auprc:  0.9018699695459226
EarlyStopping counter: 5 out of 50
epoch:  65
epoch:  66 val_f1:  0.7510724063582411 val_auroc:  0.8168875797741778 val_auprc:  0.8983311684724727
EarlyStopping counter: 6 out of 50
epoch:  66
epoch:  67 val_f1:  0.7598715939807772 val_auroc:  0.8244968090328916 val_auprc:  0.9088950337916365
EarlyStopping counter: 7 out of 50
epoch:  67
epoch:  68 val_f1:  0.7536081085870222 val_auroc:  0.8217967599410898 val_auprc:  0.9076698039786864
EarlyStopping counter: 8 out of 50
epoch:  68
epoch:  69 val_f1:  0.7510724063582411 val_auroc:  0.8173784977908689 val_auprc:  0.9028818104358376
EarlyStopping counter: 9 out of 50
epoch:  69
epoch:  70 val_f1:  0.7448635686045757 val_auroc:  0.8159057437407954 val_auprc:  0.8982383318555579
EarlyStopping counter: 10 out of 50
epoch:  70
epoch:  71 val_f1:  0.7791090204759269 val_auroc:  0.8151693667157585 val_auprc:  0.8995475449255279
EarlyStopping counter: 11 out of 50
epoch:  71
epoch:  72 val_f1:  0.7685409504908388 val_auroc:  0.8171330387825233 val_auprc:  0.9000393686778292
EarlyStopping counter: 12 out of 50
epoch:  72
epoch:  73 val_f1:  0.7598715939807772 val_auroc:  0.8163966617574865 val_auprc:  0.8989110338017845
EarlyStopping counter: 13 out of 50
epoch:  73
epoch:  74 val_f1:  0.7536081085870222 val_auroc:  0.8172557682866961 val_auprc:  0.8989150786196559
EarlyStopping counter: 14 out of 50
epoch:  74
epoch:  75 val_f1:  0.7770871369605723 val_auroc:  0.8163966617574865 val_auprc:  0.8971613410741907
EarlyStopping counter: 15 out of 50
epoch:  75
epoch:  76 val_f1:  0.7622262794246104 val_auroc:  0.8168875797741777 val_auprc:  0.8993138208415945
EarlyStopping counter: 16 out of 50
epoch:  76
epoch:  77 val_f1:  0.7622262794246104 val_auroc:  0.8173784977908689 val_auprc:  0.8980123111360538
EarlyStopping counter: 17 out of 50
epoch:  77
epoch:  78 val_f1:  0.7707245329923307 val_auroc:  0.8156602847324497 val_auprc:  0.8970921220733058
EarlyStopping counter: 18 out of 50
epoch:  78
epoch:  79 val_f1:  0.7598715939807772 val_auroc:  0.8168875797741778 val_auprc:  0.8975297971365737
EarlyStopping counter: 19 out of 50
epoch:  79
epoch:  80 val_f1:  0.7536081085870222 val_auroc:  0.8173784977908689 val_auprc:  0.8981134307325465
EarlyStopping counter: 20 out of 50
epoch:  80
epoch:  81 val_f1:  0.7622262794246104 val_auroc:  0.816151202749141 val_auprc:  0.89729688402809
EarlyStopping counter: 21 out of 50
epoch:  81
epoch:  82 val_f1:  0.7536081085870222 val_auroc:  0.8149239077074129 val_auprc:  0.8950373487998722
EarlyStopping counter: 22 out of 50
epoch:  82
epoch:  83 val_f1:  0.7510724063582411 val_auroc:  0.8154148257241041 val_auprc:  0.8960586155834706
EarlyStopping counter: 23 out of 50
epoch:  83
epoch:  84 val_f1:  0.7510724063582411 val_auroc:  0.8161512027491409 val_auprc:  0.8967509667162593
EarlyStopping counter: 24 out of 50
epoch:  84
epoch:  85 val_f1:  0.7622262794246104 val_auroc:  0.8171330387825234 val_auprc:  0.8966338777614147
EarlyStopping counter: 25 out of 50
epoch:  85
epoch:  86 val_f1:  0.7707245329923307 val_auroc:  0.8168875797741777 val_auprc:  0.8993641898956234
EarlyStopping counter: 26 out of 50
epoch:  86
epoch:  87 val_f1:  0.7643829551743221 val_auroc:  0.8159057437407953 val_auprc:  0.8958513716890948
EarlyStopping counter: 27 out of 50
epoch:  87
epoch:  88 val_f1:  0.7727225509205256 val_auroc:  0.8139420716740304 val_auprc:  0.8945994768385029
EarlyStopping counter: 28 out of 50
epoch:  88
epoch:  89 val_f1:  0.7727225509205256 val_auroc:  0.8156602847324497 val_auprc:  0.8952659937100421
EarlyStopping counter: 29 out of 50
epoch:  89
epoch:  90 val_f1:  0.7762067639678805 val_auroc:  0.8144329896907216 val_auprc:  0.895107293114091
EarlyStopping counter: 30 out of 50
epoch:  90
epoch:  91 val_f1:  0.7685409504908388 val_auroc:  0.8156602847324498 val_auprc:  0.8969628586583261
EarlyStopping counter: 31 out of 50
epoch:  91
epoch:  92 val_f1:  0.7727225509205256 val_auroc:  0.8139420716740304 val_auprc:  0.8941972810451939
EarlyStopping counter: 32 out of 50
epoch:  92
epoch:  93 val_f1:  0.7622262794246104 val_auroc:  0.8159057437407953 val_auprc:  0.8971006596737829
EarlyStopping counter: 33 out of 50
epoch:  93
epoch:  94 val_f1:  0.7622262794246104 val_auroc:  0.81480117820324 val_auprc:  0.8958905137983626
EarlyStopping counter: 34 out of 50
epoch:  94
epoch:  95 val_f1:  0.7598715939807772 val_auroc:  0.81480117820324 val_auprc:  0.896941617763344
EarlyStopping counter: 35 out of 50
epoch:  95
epoch:  96 val_f1:  0.7661589271850144 val_auroc:  0.813573883161512 val_auprc:  0.8953982299467955
EarlyStopping counter: 36 out of 50
epoch:  96
epoch:  97 val_f1:  0.7685409504908388 val_auroc:  0.8166421207658321 val_auprc:  0.8951669935339192
EarlyStopping counter: 37 out of 50
epoch:  97
epoch:  98 val_f1:  0.766354189375772 val_auroc:  0.8122238586156111 val_auprc:  0.8914395654184397
EarlyStopping counter: 38 out of 50
epoch:  98
epoch:  99 val_f1:  0.7681512331200245 val_auroc:  0.8122238586156112 val_auprc:  0.8916601664866229
EarlyStopping counter: 39 out of 50
epoch:  99
epoch:  100 val_f1:  0.7643829551743221 val_auroc:  0.8121011291114384 val_auprc:  0.8921124935289788
EarlyStopping counter: 40 out of 50
epoch:  100
epoch:  101 val_f1:  0.7622262794246104 val_auroc:  0.8144329896907216 val_auprc:  0.8965869764669845
EarlyStopping counter: 41 out of 50
epoch:  101
epoch:  102 val_f1:  0.7727225509205256 val_auroc:  0.8136966126656848 val_auprc:  0.8942399002774176
EarlyStopping counter: 42 out of 50
epoch:  102
epoch:  103 val_f1:  0.7727225509205256 val_auroc:  0.812346588119784 val_auprc:  0.8925374532728398
EarlyStopping counter: 43 out of 50
epoch:  103
epoch:  104 val_f1:  0.7622262794246104 val_auroc:  0.8136966126656848 val_auprc:  0.8936341116005712
EarlyStopping counter: 44 out of 50
epoch:  104
epoch:  105 val_f1:  0.7727225509205256 val_auroc:  0.8125920471281296 val_auprc:  0.8918462677357011
EarlyStopping counter: 45 out of 50
epoch:  105
epoch:  106 val_f1:  0.766354189375772 val_auroc:  0.8130829651448208 val_auprc:  0.8926334000040264
EarlyStopping counter: 46 out of 50
epoch:  106
epoch:  107 val_f1:  0.7745465218349855 val_auroc:  0.81480117820324 val_auprc:  0.8938101412302276
EarlyStopping counter: 47 out of 50
epoch:  107
epoch:  108 val_f1:  0.7727225509205256 val_auroc:  0.8133284241531664 val_auprc:  0.8926259808617328
EarlyStopping counter: 48 out of 50
epoch:  108
epoch:  109 val_f1:  0.7727225509205256 val_auroc:  0.8122238586156112 val_auprc:  0.8921701180091897
EarlyStopping counter: 49 out of 50
epoch:  109
epoch:  110 val_f1:  0.7727225509205256 val_auroc:  0.8119783996072657 val_auprc:  0.8908523268424114
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  803.0055129528046
{'time_elapsed': [803.0055129528046], 'epoch': [109], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7727225509205256], 'auroc_test': [0.8119783996072657], 'auprc_test': [0.8908523268424114]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1278]           1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 1278]           512
│    └─Tanh: 2-3                         [64, 256, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1274]           --
│    └─Dropout: 2-5                      [64, 256, 1274]           --
│    └─Flatten: 2-6                      [64, 326144]              --
│    └─Linear: 2-7                       [64, 1]                   326,145
==========================================================================================
Total params: 328,193
Trainable params: 328,193
Non-trainable params: 0
Total mult-adds (M): 146.54
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.02
Params size (MB): 1.31
Estimated Total Size (MB): 336.66
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5382337608174329 val_auroc:  0.731958762886598 val_auprc:  0.8737532910370256
epoch:  1
epoch:  2 val_f1:  0.29918145073158425 val_auroc:  0.6831124202258223 val_auprc:  0.8080737926406232
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.5179856115107913 val_auroc:  0.6961217476681395 val_auprc:  0.8153741194721089
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5869606239188656 val_auroc:  0.6971035837015218 val_auprc:  0.8013385094389416
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6602205397957183 val_auroc:  0.687039764359352 val_auprc:  0.8138265457095101
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6852719722410164 val_auroc:  0.719440353460972 val_auprc:  0.8532737042327619
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.7024482739389885 val_auroc:  0.7466863033873343 val_auprc:  0.8589394591451117
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.7092263500553166 val_auroc:  0.7614138438880708 val_auprc:  0.8677424194671952
EarlyStopping counter: 7 out of 50
epoch:  8
epoch:  9 val_f1:  0.7249644134959412 val_auroc:  0.7697594501718213 val_auprc:  0.8758215519029078
EarlyStopping counter: 8 out of 50
epoch:  9
epoch:  10 val_f1:  0.6863269195545199 val_auroc:  0.7395679921453118 val_auprc:  0.8600004996283339
EarlyStopping counter: 9 out of 50
epoch:  10
epoch:  11 val_f1:  0.7078050864958872 val_auroc:  0.7648502700049091 val_auprc:  0.8758395782814662
Validation loss improved to 0.401304
epoch:  11
epoch:  12 val_f1:  0.6376535972729985 val_auroc:  0.7670594010800197 val_auprc:  0.8836420017189552
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7002679453520968 val_auroc:  0.7459499263622974 val_auprc:  0.8671345271185946
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.7009452472327455 val_auroc:  0.7697594501718213 val_auprc:  0.8812015777883873
EarlyStopping counter: 3 out of 50
epoch:  14
epoch:  15 val_f1:  0.6909311987030095 val_auroc:  0.7729504172803142 val_auprc:  0.8832132034005141
EarlyStopping counter: 4 out of 50
epoch:  15
epoch:  16 val_f1:  0.72389147505525 val_auroc:  0.7687776141384388 val_auprc:  0.8847161988358124
Validation loss improved to 0.379739
epoch:  16
epoch:  17 val_f1:  0.735514445586388 val_auroc:  0.7717231222385861 val_auprc:  0.8883111119359797
Validation loss improved to 0.358715
epoch:  17
epoch:  18 val_f1:  0.6879219917448011 val_auroc:  0.7643593519882179 val_auprc:  0.879416723137015
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.6872742077065929 val_auroc:  0.7695139911634756 val_auprc:  0.8815583808178135
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7002679453520968 val_auroc:  0.7628865979381443 val_auprc:  0.8853790766436338
Validation loss improved to 0.336365
epoch:  20
epoch:  21 val_f1:  0.6916657713146764 val_auroc:  0.7515954835542465 val_auprc:  0.8697633143946641
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.6847441835349226 val_auroc:  0.765586647029946 val_auprc:  0.8804729840435188
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.6751388509211166 val_auroc:  0.7594501718213059 val_auprc:  0.8760150301638412
EarlyStopping counter: 3 out of 50
epoch:  23
epoch:  24 val_f1:  0.6895771242135116 val_auroc:  0.7655866470299459 val_auprc:  0.8790466490886291
EarlyStopping counter: 4 out of 50
epoch:  24
epoch:  25 val_f1:  0.7289242247644242 val_auroc:  0.7565046637211585 val_auprc:  0.8723903778853263
EarlyStopping counter: 5 out of 50
epoch:  25
epoch:  26 val_f1:  0.696151679426677 val_auroc:  0.749386352479136 val_auprc:  0.8697131774658353
EarlyStopping counter: 6 out of 50
epoch:  26
epoch:  27 val_f1:  0.6977368320649064 val_auroc:  0.7682866961217476 val_auprc:  0.8791463516779088
EarlyStopping counter: 7 out of 50
epoch:  27
epoch:  28 val_f1:  0.6794975987802813 val_auroc:  0.7682866961217476 val_auprc:  0.8806562860015879
EarlyStopping counter: 8 out of 50
epoch:  28
epoch:  29 val_f1:  0.6834532374100719 val_auroc:  0.7560137457044673 val_auprc:  0.8683114288602113
EarlyStopping counter: 9 out of 50
epoch:  29
epoch:  30 val_f1:  0.7031576347932113 val_auroc:  0.7565046637211584 val_auprc:  0.8732561887656746
EarlyStopping counter: 10 out of 50
epoch:  30
epoch:  31 val_f1:  0.6834532374100719 val_auroc:  0.7623956799214532 val_auprc:  0.873853749469822
EarlyStopping counter: 11 out of 50
epoch:  31
epoch:  32 val_f1:  0.68520552340289 val_auroc:  0.7668139420716741 val_auprc:  0.8748627219982764
EarlyStopping counter: 12 out of 50
epoch:  32
epoch:  33 val_f1:  0.7054786939679025 val_auroc:  0.770495827196858 val_auprc:  0.8780527818361207
EarlyStopping counter: 13 out of 50
epoch:  33
epoch:  34 val_f1:  0.6854853326641013 val_auroc:  0.766813942071674 val_auprc:  0.8746101128696091
EarlyStopping counter: 14 out of 50
epoch:  34
epoch:  35 val_f1:  0.7015283467006299 val_auroc:  0.7655866470299459 val_auprc:  0.8752584041765514
EarlyStopping counter: 15 out of 50
epoch:  35
epoch:  36 val_f1:  0.6935516760810525 val_auroc:  0.761904761904762 val_auprc:  0.8732693157117922
EarlyStopping counter: 16 out of 50
epoch:  36
epoch:  37 val_f1:  0.6935516760810525 val_auroc:  0.757486499754541 val_auprc:  0.8690552934457232
EarlyStopping counter: 17 out of 50
epoch:  37
epoch:  38 val_f1:  0.7054786939679025 val_auroc:  0.7589592538046146 val_auprc:  0.871193463927952
EarlyStopping counter: 18 out of 50
epoch:  38
epoch:  39 val_f1:  0.7057031525565856 val_auroc:  0.7567501227295041 val_auprc:  0.8679934750236846
EarlyStopping counter: 19 out of 50
epoch:  39
epoch:  40 val_f1:  0.6826512463414706 val_auroc:  0.7503681885125184 val_auprc:  0.8627941056893736
EarlyStopping counter: 20 out of 50
epoch:  40
epoch:  41 val_f1:  0.7122302158273381 val_auroc:  0.7601865488463426 val_auprc:  0.8709771181097128
EarlyStopping counter: 21 out of 50
epoch:  41
epoch:  42 val_f1:  0.6951318622544138 val_auroc:  0.7611683848797252 val_auprc:  0.8695563917022692
EarlyStopping counter: 22 out of 50
epoch:  42
epoch:  43 val_f1:  0.7178022432023763 val_auroc:  0.758713794796269 val_auprc:  0.8685500211915533
EarlyStopping counter: 23 out of 50
epoch:  43
epoch:  44 val_f1:  0.7101890414000308 val_auroc:  0.7503681885125184 val_auprc:  0.8613728949481763
EarlyStopping counter: 24 out of 50
epoch:  44
epoch:  45 val_f1:  0.708480907581627 val_auroc:  0.7619047619047619 val_auprc:  0.8709226342256622
EarlyStopping counter: 25 out of 50
epoch:  45
epoch:  46 val_f1:  0.7079427367197151 val_auroc:  0.7557682866961217 val_auprc:  0.8628449768371662
EarlyStopping counter: 26 out of 50
epoch:  46
epoch:  47 val_f1:  0.7079427367197151 val_auroc:  0.7535591556210113 val_auprc:  0.8609781351854848
EarlyStopping counter: 27 out of 50
epoch:  47
epoch:  48 val_f1:  0.7044810154681304 val_auroc:  0.7582228767795779 val_auprc:  0.8671654530191499
EarlyStopping counter: 28 out of 50
epoch:  48
epoch:  49 val_f1:  0.7044810154681304 val_auroc:  0.7501227295041728 val_auprc:  0.8594791070645574
EarlyStopping counter: 29 out of 50
epoch:  49
epoch:  50 val_f1:  0.7078050864958872 val_auroc:  0.7412862052037309 val_auprc:  0.8516608141895387
EarlyStopping counter: 30 out of 50
epoch:  50
epoch:  51 val_f1:  0.6794975987802813 val_auroc:  0.7653411880216003 val_auprc:  0.8745366660708807
EarlyStopping counter: 31 out of 50
epoch:  51
epoch:  52 val_f1:  0.7140703059967902 val_auroc:  0.7567501227295041 val_auprc:  0.8613847601884417
EarlyStopping counter: 32 out of 50
epoch:  52
epoch:  53 val_f1:  0.7122302158273381 val_auroc:  0.7457044673539519 val_auprc:  0.8558450076215576
EarlyStopping counter: 33 out of 50
epoch:  53
epoch:  54 val_f1:  0.6904086828713746 val_auroc:  0.7582228767795778 val_auprc:  0.8694230478408635
EarlyStopping counter: 34 out of 50
epoch:  54
epoch:  55 val_f1:  0.6992598845858601 val_auroc:  0.7457044673539519 val_auprc:  0.8542367503554966
EarlyStopping counter: 35 out of 50
epoch:  55
epoch:  56 val_f1:  0.7030919944895149 val_auroc:  0.7542955326460481 val_auprc:  0.862557314314021
EarlyStopping counter: 36 out of 50
epoch:  56
epoch:  57 val_f1:  0.722058496910722 val_auroc:  0.7474226804123711 val_auprc:  0.8572587584359888
EarlyStopping counter: 37 out of 50
epoch:  57
epoch:  58 val_f1:  0.7122302158273381 val_auroc:  0.7508591065292096 val_auprc:  0.8573440746046832
EarlyStopping counter: 38 out of 50
epoch:  58
epoch:  59 val_f1:  0.7184536707983012 val_auroc:  0.7550319096710849 val_auprc:  0.8625092139149664
EarlyStopping counter: 39 out of 50
epoch:  59
epoch:  60 val_f1:  0.7094198370570532 val_auroc:  0.7488954344624448 val_auprc:  0.8578326693189182
EarlyStopping counter: 40 out of 50
epoch:  60
epoch:  61 val_f1:  0.7002679453520968 val_auroc:  0.749386352479136 val_auprc:  0.8581370290015076
EarlyStopping counter: 41 out of 50
epoch:  61
epoch:  62 val_f1:  0.7235944791518311 val_auroc:  0.7496318114874816 val_auprc:  0.8550697435931032
EarlyStopping counter: 42 out of 50
epoch:  62
epoch:  63 val_f1:  0.7044810154681304 val_auroc:  0.7466863033873343 val_auprc:  0.8571367986476787
EarlyStopping counter: 43 out of 50
epoch:  63
epoch:  64 val_f1:  0.7002679453520968 val_auroc:  0.7432498772704959 val_auprc:  0.8519000884291015
EarlyStopping counter: 44 out of 50
epoch:  64
epoch:  65 val_f1:  0.7140775751491829 val_auroc:  0.7427589592538046 val_auprc:  0.8519447100494688
EarlyStopping counter: 45 out of 50
epoch:  65
epoch:  66 val_f1:  0.7328919440906961 val_auroc:  0.7488954344624448 val_auprc:  0.8565237264890009
EarlyStopping counter: 46 out of 50
epoch:  66
epoch:  67 val_f1:  0.7246795893300292 val_auroc:  0.7447226313205695 val_auprc:  0.8490239997621469
EarlyStopping counter: 47 out of 50
epoch:  67
epoch:  68 val_f1:  0.7140703059967902 val_auroc:  0.7528227785959745 val_auprc:  0.8579911939170708
EarlyStopping counter: 48 out of 50
epoch:  68
epoch:  69 val_f1:  0.7140703059967902 val_auroc:  0.7508591065292096 val_auprc:  0.8567188299872719
EarlyStopping counter: 49 out of 50
epoch:  69
epoch:  70 val_f1:  0.7101890414000308 val_auroc:  0.7503681885125184 val_auprc:  0.8539362740999296
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  502.094850063324
{'time_elapsed': [502.094850063324], 'epoch': [69], 'fold': [2], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7101890414000308], 'auroc_test': [0.7503681885125184], 'auprc_test': [0.8539362740999296]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1278]           1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 1278]           512
│    └─Tanh: 2-3                         [64, 256, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1274]           --
│    └─Dropout: 2-5                      [64, 256, 1274]           --
│    └─Flatten: 2-6                      [64, 326144]              --
│    └─Linear: 2-7                       [64, 1]                   326,145
==========================================================================================
Total params: 328,193
Trainable params: 328,193
Non-trainable params: 0
Total mult-adds (M): 146.54
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.02
Params size (MB): 1.31
Estimated Total Size (MB): 336.66
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5500765915850584 val_auroc:  0.6598837209302327 val_auprc:  0.8411270124961152
epoch:  1
epoch:  2 val_f1:  0.5946480910509687 val_auroc:  0.629360465116279 val_auprc:  0.8350148034561738
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.5034390398129258 val_auroc:  0.6678779069767443 val_auprc:  0.831592200494081
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6853843241196516 val_auroc:  0.6967054263565892 val_auprc:  0.8456715392030782
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.687931907994731 val_auroc:  0.7560562015503876 val_auprc:  0.8841379692971908
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.7428507568425149 val_auroc:  0.8052325581395349 val_auprc:  0.9145706884670494
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.7289507977529213 val_auroc:  0.8086240310077519 val_auprc:  0.9001474669321592
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.7482308031126119 val_auroc:  0.8175872093023255 val_auprc:  0.9085728285974498
Validation loss improved to 0.392179
epoch:  8
epoch:  9 val_f1:  0.726807606714082 val_auroc:  0.8246124031007753 val_auprc:  0.9216140291371642
Validation loss improved to 0.276280
epoch:  9
epoch:  10 val_f1:  0.7517526908132072 val_auroc:  0.8306686046511628 val_auprc:  0.9276257310748375
Validation loss improved to 0.233931
epoch:  10
epoch:  11 val_f1:  0.7489893984794112 val_auroc:  0.8338178294573644 val_auprc:  0.9282745266441084
Validation loss improved to 0.207762
epoch:  11
epoch:  12 val_f1:  0.7335046248715313 val_auroc:  0.841327519379845 val_auprc:  0.9295128766803671
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7516121487046815 val_auroc:  0.8357558139534884 val_auprc:  0.9300449906721704
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.7622179807174668 val_auroc:  0.8376937984496123 val_auprc:  0.9323082015002728
Validation loss improved to 0.161603
epoch:  14
epoch:  15 val_f1:  0.7594266802546743 val_auroc:  0.8391472868217055 val_auprc:  0.9329662151126494
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7633328614234447 val_auroc:  0.8468992248062016 val_auprc:  0.9364236720578316
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.7695564219015847 val_auroc:  0.8488372093023256 val_auprc:  0.9382761694155874
Validation loss improved to 0.159277
epoch:  17
epoch:  18 val_f1:  0.7710202043822609 val_auroc:  0.8534399224806201 val_auprc:  0.9381414710664869
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7659382513381667 val_auroc:  0.8541666666666667 val_auprc:  0.9396787712697215
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7835226993620948 val_auroc:  0.8556201550387597 val_auprc:  0.9411567759499223
Validation loss improved to 0.143152
epoch:  20
epoch:  21 val_f1:  0.7789671954250403 val_auroc:  0.8568313953488372 val_auprc:  0.9414599161640262
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7801238118631262 val_auroc:  0.8594961240310078 val_auprc:  0.9424117309588274
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.7980190776058461 val_auroc:  0.8582848837209303 val_auprc:  0.942797723742675
EarlyStopping counter: 3 out of 50
epoch:  23
epoch:  24 val_f1:  0.7724509753899008 val_auroc:  0.8672480620155039 val_auprc:  0.945731300629032
EarlyStopping counter: 4 out of 50
epoch:  24
epoch:  25 val_f1:  0.767033173809688 val_auroc:  0.8621608527131783 val_auprc:  0.9436370569471302
Validation loss improved to 0.135362
epoch:  25
epoch:  26 val_f1:  0.7912899626822607 val_auroc:  0.8643410852713179 val_auprc:  0.9445094103998852
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7729252582141845 val_auroc:  0.8655523255813955 val_auprc:  0.9443061938317392
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7877294237541244 val_auroc:  0.8653100775193799 val_auprc:  0.9454469834746606
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.7980190776058461 val_auroc:  0.8682170542635659 val_auprc:  0.9471250776741564
Validation loss improved to 0.116916
epoch:  29
epoch:  30 val_f1:  0.768937708914086 val_auroc:  0.8657945736434108 val_auprc:  0.9453658645575747
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7901923359271766 val_auroc:  0.8648255813953489 val_auprc:  0.9447236551016085
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.7980190776058461 val_auroc:  0.865794573643411 val_auprc:  0.9451763767091577
EarlyStopping counter: 3 out of 50
epoch:  32
epoch:  33 val_f1:  0.7746634573712671 val_auroc:  0.8611918604651163 val_auprc:  0.9441595388102321
EarlyStopping counter: 4 out of 50
epoch:  33
epoch:  34 val_f1:  0.7705233871155502 val_auroc:  0.8706395348837208 val_auprc:  0.9451978695297701
EarlyStopping counter: 5 out of 50
epoch:  34
epoch:  35 val_f1:  0.7783357627623393 val_auroc:  0.8672480620155039 val_auprc:  0.9449206149785336
Validation loss improved to 0.116247
epoch:  35
epoch:  36 val_f1:  0.7912899626822607 val_auroc:  0.8670058139534884 val_auprc:  0.9453416816609091
EarlyStopping counter: 1 out of 50
epoch:  36
epoch:  37 val_f1:  0.7625825493451395 val_auroc:  0.8684593023255813 val_auprc:  0.9462823897044443
EarlyStopping counter: 2 out of 50
epoch:  37
epoch:  38 val_f1:  0.7682301875730638 val_auroc:  0.866763565891473 val_auprc:  0.945880092984424
EarlyStopping counter: 3 out of 50
epoch:  38
epoch:  39 val_f1:  0.776244301724119 val_auroc:  0.8633720930232557 val_auprc:  0.9441734389505316
EarlyStopping counter: 4 out of 50
epoch:  39
epoch:  40 val_f1:  0.7932273763653603 val_auroc:  0.8682170542635659 val_auprc:  0.946256704962258
EarlyStopping counter: 5 out of 50
epoch:  40
epoch:  41 val_f1:  0.7820584602206068 val_auroc:  0.868217054263566 val_auprc:  0.9453337976221088
EarlyStopping counter: 6 out of 50
epoch:  41
epoch:  42 val_f1:  0.7562473143424068 val_auroc:  0.8670058139534884 val_auprc:  0.9449964226577965
EarlyStopping counter: 7 out of 50
epoch:  42
epoch:  43 val_f1:  0.7633328614234447 val_auroc:  0.867732558139535 val_auprc:  0.9462803516499688
EarlyStopping counter: 8 out of 50
epoch:  43
epoch:  44 val_f1:  0.7894843465886632 val_auroc:  0.8655523255813954 val_auprc:  0.9446612872798181
EarlyStopping counter: 9 out of 50
epoch:  44
epoch:  45 val_f1:  0.7835226993620948 val_auroc:  0.8597383720930233 val_auprc:  0.9438761038673346
Validation loss improved to 0.107466
epoch:  45
epoch:  46 val_f1:  0.7562473143424068 val_auroc:  0.8677325581395349 val_auprc:  0.9454264160658581
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.7562473143424068 val_auroc:  0.869670542635659 val_auprc:  0.9464791921639911
EarlyStopping counter: 2 out of 50
epoch:  47
epoch:  48 val_f1:  0.764639197732723 val_auroc:  0.8679748062015504 val_auprc:  0.9462109028671521
EarlyStopping counter: 3 out of 50
epoch:  48
epoch:  49 val_f1:  0.7906801532257888 val_auroc:  0.8687015503875969 val_auprc:  0.946366055029073
EarlyStopping counter: 4 out of 50
epoch:  49
epoch:  50 val_f1:  0.7892012988311853 val_auroc:  0.8708817829457365 val_auprc:  0.9468978302398835
EarlyStopping counter: 5 out of 50
epoch:  50
epoch:  51 val_f1:  0.7729252582141845 val_auroc:  0.8725775193798451 val_auprc:  0.9473704611428206
EarlyStopping counter: 6 out of 50
epoch:  51
epoch:  52 val_f1:  0.7827158008497472 val_auroc:  0.8694282945736433 val_auprc:  0.9465460448763733
EarlyStopping counter: 7 out of 50
epoch:  52
epoch:  53 val_f1:  0.7789671954250403 val_auroc:  0.8674903100775194 val_auprc:  0.9461437797471516
EarlyStopping counter: 8 out of 50
epoch:  53
epoch:  54 val_f1:  0.7886649052635782 val_auroc:  0.8689437984496124 val_auprc:  0.9466237958893212
EarlyStopping counter: 9 out of 50
epoch:  54
epoch:  55 val_f1:  0.7972014141264308 val_auroc:  0.872577519379845 val_auprc:  0.9474331942251303
EarlyStopping counter: 10 out of 50
epoch:  55
epoch:  56 val_f1:  0.7540304643278981 val_auroc:  0.8728197674418605 val_auprc:  0.9480520572468338
EarlyStopping counter: 11 out of 50
epoch:  56
epoch:  57 val_f1:  0.764639197732723 val_auroc:  0.8716085271317828 val_auprc:  0.9475219983222162
EarlyStopping counter: 12 out of 50
epoch:  57
epoch:  58 val_f1:  0.7540304643278981 val_auroc:  0.8728197674418604 val_auprc:  0.947867223284943
EarlyStopping counter: 13 out of 50
epoch:  58
epoch:  59 val_f1:  0.7841726618705036 val_auroc:  0.8708817829457365 val_auprc:  0.9472295812419912
EarlyStopping counter: 14 out of 50
epoch:  59
epoch:  60 val_f1:  0.794309372388086 val_auroc:  0.8701550387596899 val_auprc:  0.9472147272230165
EarlyStopping counter: 15 out of 50
epoch:  60
epoch:  61 val_f1:  0.8101799492243995 val_auroc:  0.8703972868217054 val_auprc:  0.9473163591526926
EarlyStopping counter: 16 out of 50
epoch:  61
epoch:  62 val_f1:  0.8175531003768415 val_auroc:  0.870639534883721 val_auprc:  0.9474384639115001
EarlyStopping counter: 17 out of 50
epoch:  62
epoch:  63 val_f1:  0.7877294237541244 val_auroc:  0.8679748062015505 val_auprc:  0.9460437219741167
EarlyStopping counter: 18 out of 50
epoch:  63
epoch:  64 val_f1:  0.7801238118631262 val_auroc:  0.8703972868217055 val_auprc:  0.9470787502128932
EarlyStopping counter: 19 out of 50
epoch:  64
epoch:  65 val_f1:  0.7724509753899008 val_auroc:  0.8677325581395349 val_auprc:  0.9457092875553056
EarlyStopping counter: 20 out of 50
epoch:  65
epoch:  66 val_f1:  0.8101799492243995 val_auroc:  0.8682170542635659 val_auprc:  0.9461684462073828
EarlyStopping counter: 21 out of 50
epoch:  66
epoch:  67 val_f1:  0.8027539115793398 val_auroc:  0.8689437984496124 val_auprc:  0.9467756822806899
EarlyStopping counter: 22 out of 50
epoch:  67
epoch:  68 val_f1:  0.7776763243674784 val_auroc:  0.870639534883721 val_auprc:  0.946572956059486
EarlyStopping counter: 23 out of 50
epoch:  68
epoch:  69 val_f1:  0.7906801532257888 val_auroc:  0.8723352713178295 val_auprc:  0.9478699621585791
EarlyStopping counter: 24 out of 50
epoch:  69
epoch:  70 val_f1:  0.7776763243674784 val_auroc:  0.8708817829457365 val_auprc:  0.9469022346389003
EarlyStopping counter: 25 out of 50
epoch:  70
epoch:  71 val_f1:  0.7841726618705036 val_auroc:  0.8701550387596899 val_auprc:  0.9471754082486645
EarlyStopping counter: 26 out of 50
epoch:  71
epoch:  72 val_f1:  0.7729252582141845 val_auroc:  0.8737887596899225 val_auprc:  0.9483793288791277
EarlyStopping counter: 27 out of 50
epoch:  72
epoch:  73 val_f1:  0.7892012988311853 val_auroc:  0.8723352713178294 val_auprc:  0.9474482428357227
EarlyStopping counter: 28 out of 50
epoch:  73
epoch:  74 val_f1:  0.7892012988311853 val_auroc:  0.8708817829457364 val_auprc:  0.9471350687428475
EarlyStopping counter: 29 out of 50
epoch:  74
epoch:  75 val_f1:  0.7711885993597467 val_auroc:  0.8682170542635659 val_auprc:  0.9460038590956562
EarlyStopping counter: 30 out of 50
epoch:  75
epoch:  76 val_f1:  0.7625825493451395 val_auroc:  0.872093023255814 val_auprc:  0.947269617951666
EarlyStopping counter: 31 out of 50
epoch:  76
epoch:  77 val_f1:  0.7682301875730638 val_auroc:  0.869186046511628 val_auprc:  0.9462949787843522
EarlyStopping counter: 32 out of 50
epoch:  77
epoch:  78 val_f1:  0.7877294237541244 val_auroc:  0.8674903100775194 val_auprc:  0.9457129242332405
EarlyStopping counter: 33 out of 50
epoch:  78
epoch:  79 val_f1:  0.7776763243674784 val_auroc:  0.8701550387596899 val_auprc:  0.9462932306998497
EarlyStopping counter: 34 out of 50
epoch:  79
epoch:  80 val_f1:  0.7811109002295425 val_auroc:  0.8713662790697674 val_auprc:  0.9474506140669492
EarlyStopping counter: 35 out of 50
epoch:  80
epoch:  81 val_f1:  0.7776763243674784 val_auroc:  0.8689437984496124 val_auprc:  0.9466280213326138
EarlyStopping counter: 36 out of 50
epoch:  81
epoch:  82 val_f1:  0.7697841726618705 val_auroc:  0.870639534883721 val_auprc:  0.9467732620285579
EarlyStopping counter: 37 out of 50
epoch:  82
epoch:  83 val_f1:  0.7866727894280321 val_auroc:  0.8684593023255813 val_auprc:  0.9461248303552336
EarlyStopping counter: 38 out of 50
epoch:  83
epoch:  84 val_f1:  0.776244301724119 val_auroc:  0.8691860465116279 val_auprc:  0.9463038185507572
EarlyStopping counter: 39 out of 50
epoch:  84
epoch:  85 val_f1:  0.7841726618705036 val_auroc:  0.8699127906976745 val_auprc:  0.9465105432633295
EarlyStopping counter: 40 out of 50
epoch:  85
epoch:  86 val_f1:  0.7729252582141845 val_auroc:  0.8701550387596899 val_auprc:  0.9466652391177488
EarlyStopping counter: 41 out of 50
epoch:  86
epoch:  87 val_f1:  0.7746634573712671 val_auroc:  0.8689437984496124 val_auprc:  0.9464523412847352
EarlyStopping counter: 42 out of 50
epoch:  87
epoch:  88 val_f1:  0.7811109002295425 val_auroc:  0.8703972868217055 val_auprc:  0.9461749668921883
EarlyStopping counter: 43 out of 50
epoch:  88
epoch:  89 val_f1:  0.7682301875730638 val_auroc:  0.8677325581395349 val_auprc:  0.9458085366436064
EarlyStopping counter: 44 out of 50
epoch:  89
epoch:  90 val_f1:  0.7603368061152953 val_auroc:  0.8728197674418604 val_auprc:  0.9472715587607656
EarlyStopping counter: 45 out of 50
epoch:  90
epoch:  91 val_f1:  0.7841726618705036 val_auroc:  0.8691860465116279 val_auprc:  0.946172456052757
EarlyStopping counter: 46 out of 50
epoch:  91
epoch:  92 val_f1:  0.7866727894280321 val_auroc:  0.8682170542635659 val_auprc:  0.9458480117673821
EarlyStopping counter: 47 out of 50
epoch:  92
epoch:  93 val_f1:  0.7789671954250403 val_auroc:  0.8694282945736433 val_auprc:  0.9462191463849021
EarlyStopping counter: 48 out of 50
epoch:  93
epoch:  94 val_f1:  0.776244301724119 val_auroc:  0.8687015503875969 val_auprc:  0.9459160389246226
EarlyStopping counter: 49 out of 50
epoch:  94
epoch:  95 val_f1:  0.7711885993597467 val_auroc:  0.8662790697674418 val_auprc:  0.9451100840899491
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  673.7082257270813
{'time_elapsed': [673.7082257270813], 'epoch': [94], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7711885993597467], 'auroc_test': [0.8662790697674418], 'auprc_test': [0.9451100840899491]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1278]           1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 1278]           512
│    └─Tanh: 2-3                         [64, 256, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1274]           --
│    └─Dropout: 2-5                      [64, 256, 1274]           --
│    └─Flatten: 2-6                      [64, 326144]              --
│    └─Linear: 2-7                       [64, 1]                   326,145
==========================================================================================
Total params: 328,193
Trainable params: 328,193
Non-trainable params: 0
Total mult-adds (M): 146.54
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.02
Params size (MB): 1.31
Estimated Total Size (MB): 336.66
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5707915273132664 val_auroc:  0.6846478174603174 val_auprc:  0.785888757745122
epoch:  1
epoch:  2 val_f1:  0.4752663857196697 val_auroc:  0.552951388888889 val_auprc:  0.7110354568809227
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.5614476544777723 val_auroc:  0.5580357142857143 val_auprc:  0.7453144284455001
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5078246106148963 val_auroc:  0.5626240079365079 val_auprc:  0.722690216731263
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6410834468805483 val_auroc:  0.5804811507936507 val_auprc:  0.7520925146455857
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.5889278963002972 val_auroc:  0.6541418650793651 val_auprc:  0.7542748497367147
Validation loss improved to 1.409518
epoch:  6
epoch:  7 val_f1:  0.6502229654403567 val_auroc:  0.7715773809523808 val_auprc:  0.8492591349773798
Validation loss improved to 0.661302
epoch:  7
epoch:  8 val_f1:  0.6614492753623189 val_auroc:  0.8320932539682541 val_auprc:  0.9271238925071367
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7837457330597287 val_auroc:  0.8554067460317459 val_auprc:  0.9349944790390917
Validation loss improved to 0.397818
epoch:  9
epoch:  10 val_f1:  0.7682566483748418 val_auroc:  0.8593750000000001 val_auprc:  0.9287758331650935
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.7590842260029405 val_auroc:  0.8464781746031745 val_auprc:  0.9146158159731741
EarlyStopping counter: 2 out of 50
epoch:  11
epoch:  12 val_f1:  0.7755148741418765 val_auroc:  0.8544146825396826 val_auprc:  0.9201328224728119
Validation loss improved to 0.289781
epoch:  12
epoch:  13 val_f1:  0.8049865427618805 val_auroc:  0.8591269841269842 val_auprc:  0.9252215894885101
Validation loss improved to 0.233821
epoch:  13
epoch:  14 val_f1:  0.7873345935727789 val_auroc:  0.8568948412698412 val_auprc:  0.9259716827726296
Validation loss improved to 0.218325
epoch:  14
epoch:  15 val_f1:  0.7630946431546132 val_auroc:  0.8514384920634921 val_auprc:  0.9191673801605106
Validation loss improved to 0.212675
epoch:  15
epoch:  16 val_f1:  0.8014350667803353 val_auroc:  0.8504464285714285 val_auprc:  0.9174817630569205
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.773156899810964 val_auroc:  0.8521825396825397 val_auprc:  0.9186764645301568
Validation loss improved to 0.183545
epoch:  17
epoch:  18 val_f1:  0.8116495094391185 val_auroc:  0.855406746031746 val_auprc:  0.9213220661470269
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7793921916592724 val_auroc:  0.8603670634920636 val_auprc:  0.9239625502927514
Validation loss improved to 0.170287
epoch:  19
epoch:  20 val_f1:  0.7729303439448368 val_auroc:  0.8556547619047619 val_auprc:  0.9193286832036417
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7861608411480533 val_auroc:  0.8556547619047619 val_auprc:  0.9195652527070023
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7793921916592724 val_auroc:  0.8586309523809524 val_auprc:  0.9227413347779091
Validation loss improved to 0.165148
epoch:  22
epoch:  23 val_f1:  0.7563367965827533 val_auroc:  0.8551587301587302 val_auprc:  0.9192729242309953
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7745910427020087 val_auroc:  0.8606150793650794 val_auprc:  0.9234433459548166
Validation loss improved to 0.159021
epoch:  24
epoch:  25 val_f1:  0.795635738397158 val_auroc:  0.8670634920634921 val_auprc:  0.9264373908226364
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.7745910427020087 val_auroc:  0.8670634920634921 val_auprc:  0.9261841773753943
Validation loss improved to 0.158579
epoch:  26
epoch:  27 val_f1:  0.7891335560760728 val_auroc:  0.8680555555555556 val_auprc:  0.9270896487201089
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7891335560760728 val_auroc:  0.8650793650793651 val_auprc:  0.9256012817146781
Validation loss improved to 0.156990
epoch:  28
epoch:  29 val_f1:  0.7627107192324585 val_auroc:  0.8645833333333333 val_auprc:  0.9252038325701016
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.791810443984357 val_auroc:  0.8673115079365079 val_auprc:  0.9264958828181472
EarlyStopping counter: 2 out of 50
epoch:  30
epoch:  31 val_f1:  0.7729303439448368 val_auroc:  0.8673115079365079 val_auprc:  0.9265244719535656
EarlyStopping counter: 3 out of 50
epoch:  31
epoch:  32 val_f1:  0.7956729455237178 val_auroc:  0.8673115079365079 val_auprc:  0.9248621471320625
EarlyStopping counter: 4 out of 50
epoch:  32
epoch:  33 val_f1:  0.8097298254042504 val_auroc:  0.8670634920634921 val_auprc:  0.9255920670345132
EarlyStopping counter: 5 out of 50
epoch:  33
epoch:  34 val_f1:  0.7755148741418765 val_auroc:  0.8650793650793651 val_auprc:  0.9216018247817879
EarlyStopping counter: 6 out of 50
epoch:  34
epoch:  35 val_f1:  0.804814497938866 val_auroc:  0.8715277777777778 val_auprc:  0.929592452484303
EarlyStopping counter: 7 out of 50
epoch:  35
epoch:  36 val_f1:  0.782608695652174 val_auroc:  0.8697916666666666 val_auprc:  0.9264168089968908
EarlyStopping counter: 8 out of 50
epoch:  36
epoch:  37 val_f1:  0.7749692370795734 val_auroc:  0.8675595238095238 val_auprc:  0.92288400638423
EarlyStopping counter: 9 out of 50
epoch:  37
epoch:  38 val_f1:  0.8041106719367591 val_auroc:  0.875 val_auprc:  0.9315455513694509
EarlyStopping counter: 10 out of 50
epoch:  38
epoch:  39 val_f1:  0.800639197204071 val_auroc:  0.8705357142857143 val_auprc:  0.9267025058421559
EarlyStopping counter: 11 out of 50
epoch:  39
epoch:  40 val_f1:  0.7755148741418765 val_auroc:  0.8680555555555556 val_auprc:  0.9239650383350438
EarlyStopping counter: 12 out of 50
epoch:  40
epoch:  41 val_f1:  0.7563367965827533 val_auroc:  0.8658234126984127 val_auprc:  0.9202205417051481
EarlyStopping counter: 13 out of 50
epoch:  41
epoch:  42 val_f1:  0.7819511139952413 val_auroc:  0.8628472222222222 val_auprc:  0.90877450026743
EarlyStopping counter: 14 out of 50
epoch:  42
epoch:  43 val_f1:  0.7755148741418765 val_auroc:  0.863343253968254 val_auprc:  0.9089182237171745
EarlyStopping counter: 15 out of 50
epoch:  43
epoch:  44 val_f1:  0.782608695652174 val_auroc:  0.871031746031746 val_auprc:  0.9256473217379284
EarlyStopping counter: 16 out of 50
epoch:  44
epoch:  45 val_f1:  0.7891335560760728 val_auroc:  0.873263888888889 val_auprc:  0.9258408582007147
EarlyStopping counter: 17 out of 50
epoch:  45
epoch:  46 val_f1:  0.8231516182680737 val_auroc:  0.8745039682539683 val_auprc:  0.9281230394967668
EarlyStopping counter: 18 out of 50
epoch:  46
epoch:  47 val_f1:  0.7627107192324585 val_auroc:  0.8702876984126985 val_auprc:  0.9208703834959365
EarlyStopping counter: 19 out of 50
epoch:  47
epoch:  48 val_f1:  0.7627107192324585 val_auroc:  0.869295634920635 val_auprc:  0.9150005311086061
EarlyStopping counter: 20 out of 50
epoch:  48
epoch:  49 val_f1:  0.7793921916592724 val_auroc:  0.8745039682539683 val_auprc:  0.9254414073505481
EarlyStopping counter: 21 out of 50
epoch:  49
epoch:  50 val_f1:  0.7891335560760728 val_auroc:  0.8720238095238094 val_auprc:  0.9217858782127296
EarlyStopping counter: 22 out of 50
epoch:  50
epoch:  51 val_f1:  0.7819511139952413 val_auroc:  0.8715277777777778 val_auprc:  0.9228399822941071
EarlyStopping counter: 23 out of 50
epoch:  51
epoch:  52 val_f1:  0.7819511139952413 val_auroc:  0.8655753968253969 val_auprc:  0.9099577873360395
EarlyStopping counter: 24 out of 50
epoch:  52
epoch:  53 val_f1:  0.8281893869312926 val_auroc:  0.8740079365079366 val_auprc:  0.9285589101902454
EarlyStopping counter: 25 out of 50
epoch:  53
epoch:  54 val_f1:  0.7793921916592724 val_auroc:  0.8665674603174605 val_auprc:  0.9195375122796456
EarlyStopping counter: 26 out of 50
epoch:  54
epoch:  55 val_f1:  0.7733010668869473 val_auroc:  0.8590029761904762 val_auprc:  0.9015492433592875
EarlyStopping counter: 27 out of 50
epoch:  55
epoch:  56 val_f1:  0.7905411014849827 val_auroc:  0.869295634920635 val_auprc:  0.9172003746884396
EarlyStopping counter: 28 out of 50
epoch:  56
epoch:  57 val_f1:  0.7733010668869473 val_auroc:  0.8675595238095238 val_auprc:  0.912165619088605
EarlyStopping counter: 29 out of 50
epoch:  57
epoch:  58 val_f1:  0.7819511139952413 val_auroc:  0.8690476190476191 val_auprc:  0.916254213452222
EarlyStopping counter: 30 out of 50
epoch:  58
epoch:  59 val_f1:  0.7627107192324585 val_auroc:  0.867063492063492 val_auprc:  0.9066540008319381
EarlyStopping counter: 31 out of 50
epoch:  59
epoch:  60 val_f1:  0.7755148741418765 val_auroc:  0.8655753968253967 val_auprc:  0.9108833357630998
EarlyStopping counter: 32 out of 50
epoch:  60
epoch:  61 val_f1:  0.7627107192324585 val_auroc:  0.8680555555555557 val_auprc:  0.9116350916628051
EarlyStopping counter: 33 out of 50
epoch:  61
epoch:  62 val_f1:  0.7891335560760728 val_auroc:  0.8727678571428572 val_auprc:  0.9227664453097548
EarlyStopping counter: 34 out of 50
epoch:  62
epoch:  63 val_f1:  0.7627107192324585 val_auroc:  0.8709077380952381 val_auprc:  0.9188969130568316
EarlyStopping counter: 35 out of 50
epoch:  63
epoch:  64 val_f1:  0.7819511139952413 val_auroc:  0.8690476190476191 val_auprc:  0.917759766629722
EarlyStopping counter: 36 out of 50
epoch:  64
epoch:  65 val_f1:  0.7627107192324585 val_auroc:  0.8702876984126985 val_auprc:  0.9178882075626624
EarlyStopping counter: 37 out of 50
epoch:  65
epoch:  66 val_f1:  0.7891335560760728 val_auroc:  0.8721478174603174 val_auprc:  0.9220529039606792
EarlyStopping counter: 38 out of 50
epoch:  66
epoch:  67 val_f1:  0.7729303439448368 val_auroc:  0.8700396825396826 val_auprc:  0.9177269708564615
EarlyStopping counter: 39 out of 50
epoch:  67
epoch:  68 val_f1:  0.7971014492753623 val_auroc:  0.8727678571428572 val_auprc:  0.9229517062994379
EarlyStopping counter: 40 out of 50
epoch:  68
epoch:  69 val_f1:  0.7711042634565258 val_auroc:  0.8718998015873015 val_auprc:  0.9219022864412781
EarlyStopping counter: 41 out of 50
epoch:  69
epoch:  70 val_f1:  0.7793921916592724 val_auroc:  0.8702876984126984 val_auprc:  0.9181388482332552
EarlyStopping counter: 42 out of 50
epoch:  70
epoch:  71 val_f1:  0.7669132597880164 val_auroc:  0.8671875 val_auprc:  0.9130368317696612
EarlyStopping counter: 43 out of 50
epoch:  71
epoch:  72 val_f1:  0.7797158172381521 val_auroc:  0.8664434523809523 val_auprc:  0.9095276405517512
EarlyStopping counter: 44 out of 50
epoch:  72
epoch:  73 val_f1:  0.7956729455237178 val_auroc:  0.8717757936507937 val_auprc:  0.9211846745599157
EarlyStopping counter: 45 out of 50
epoch:  73
epoch:  74 val_f1:  0.7971014492753623 val_auroc:  0.8712797619047619 val_auprc:  0.91912257299187
EarlyStopping counter: 46 out of 50
epoch:  74
epoch:  75 val_f1:  0.7775412992804297 val_auroc:  0.8683035714285714 val_auprc:  0.9154188152221074
EarlyStopping counter: 47 out of 50
epoch:  75
epoch:  76 val_f1:  0.7669132597880164 val_auroc:  0.8678075396825398 val_auprc:  0.9126802334184603
EarlyStopping counter: 48 out of 50
epoch:  76
epoch:  77 val_f1:  0.7605491990846683 val_auroc:  0.8684275793650794 val_auprc:  0.916709606086713
EarlyStopping counter: 49 out of 50
epoch:  77
epoch:  78 val_f1:  0.7971014492753623 val_auroc:  0.8742559523809523 val_auprc:  0.9237585292737787
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  555.0705168247223
{'time_elapsed': [555.0705168247223], 'epoch': [77], 'fold': [4], 'f1_train': [0.9946175537860844], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7971014492753623], 'auroc_test': [0.8742559523809523], 'auprc_test': [0.9237585292737787]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1278]           1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 1278]           512
│    └─Tanh: 2-3                         [64, 256, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1274]           --
│    └─Dropout: 2-5                      [64, 256, 1274]           --
│    └─Flatten: 2-6                      [64, 326144]              --
│    └─Linear: 2-7                       [64, 1]                   326,145
==========================================================================================
Total params: 328,193
Trainable params: 328,193
Non-trainable params: 0
Total mult-adds (M): 146.54
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.02
Params size (MB): 1.31
Estimated Total Size (MB): 336.66
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_60', 'config': {'hidden_channels': [256], 'epochs': 500, 'kernel_size': 5, 'pool_kernel_size': 5, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.6588119783996073 val_auprc:  0.8356198916007627
epoch:  1
epoch:  2 val_f1:  0.5736495549323253 val_auroc:  0.6008836524300443 val_auprc:  0.7671483188931063
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.43835312981286517 val_auroc:  0.6620029455081001 val_auprc:  0.8191689369486446
Validation loss improved to 1.254334
epoch:  3
epoch:  4 val_f1:  0.6731024749578328 val_auroc:  0.654639175257732 val_auprc:  0.8101873064772642
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.512158720228786 val_auroc:  0.695139911634757 val_auprc:  0.8378599846316694
Validation loss improved to 1.224681
epoch:  5
epoch:  6 val_f1:  0.6680342728469744 val_auroc:  0.7025036818851251 val_auprc:  0.8407356606834904
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.6480571813790269 val_auroc:  0.7245949926362297 val_auprc:  0.8579774219547224
Validation loss improved to 1.212213
epoch:  7
epoch:  8 val_f1:  0.675161142762091 val_auroc:  0.740058910162003 val_auprc:  0.8678038066067673
Validation loss improved to 1.210558
epoch:  8
epoch:  9 val_f1:  0.6459565936764723 val_auroc:  0.7523318605792834 val_auprc:  0.876523331598362
Validation loss improved to 1.178574
epoch:  9
epoch:  10 val_f1:  0.6605237452657186 val_auroc:  0.7582228767795779 val_auprc:  0.8799571927024809
Validation loss improved to 1.165957
epoch:  10
epoch:  11 val_f1:  0.7309103647707891 val_auroc:  0.7542955326460481 val_auprc:  0.8768623323397045
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.681579990245092 val_auroc:  0.771232204221895 val_auprc:  0.8879176488357269
Validation loss improved to 1.141362
epoch:  12
epoch:  13 val_f1:  0.7519437633413868 val_auroc:  0.7675503190967109 val_auprc:  0.8834063414630515
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.6590199752078746 val_auroc:  0.7790868924889544 val_auprc:  0.8933582063175338
Validation loss improved to 1.121402
epoch:  14
epoch:  15 val_f1:  0.6892815309975336 val_auroc:  0.774914089347079 val_auprc:  0.8914112321253073
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7346924658075737 val_auroc:  0.7776141384388807 val_auprc:  0.8923032355404862
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.703263898025454 val_auroc:  0.7812960235640648 val_auprc:  0.8953978802906849
Validation loss improved to 1.115689
epoch:  17
epoch:  18 val_f1:  0.7531731915989216 val_auroc:  0.7808051055473736 val_auprc:  0.8951929281325851
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.703263898025454 val_auroc:  0.7896416298478154 val_auprc:  0.9019599234329352
Validation loss improved to 1.099972
epoch:  19
epoch:  20 val_f1:  0.7569659388768054 val_auroc:  0.7812960235640648 val_auprc:  0.8962078265384322
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.6598406488264144 val_auroc:  0.7974963181148748 val_auprc:  0.908064931088891
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7617596949267598 val_auroc:  0.7898870888561611 val_auprc:  0.9034517083305811
EarlyStopping counter: 3 out of 50
epoch:  22
epoch:  23 val_f1:  0.7223183251151889 val_auroc:  0.7940598919980364 val_auprc:  0.9042276210208873
EarlyStopping counter: 4 out of 50
epoch:  23
epoch:  24 val_f1:  0.703263898025454 val_auroc:  0.8009327442317133 val_auprc:  0.9094784505734188
Validation loss improved to 1.091040
epoch:  24
epoch:  25 val_f1:  0.7552115339652351 val_auroc:  0.7943053510063819 val_auprc:  0.9052079097946312
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.7494347379239465 val_auroc:  0.7982326951399117 val_auprc:  0.9081409484052626
EarlyStopping counter: 2 out of 50
epoch:  26
epoch:  27 val_f1:  0.7560320485424044 val_auroc:  0.801178203240059 val_auprc:  0.9108070952459093
EarlyStopping counter: 3 out of 50
epoch:  27
epoch:  28 val_f1:  0.7362024088594293 val_auroc:  0.804860088365243 val_auprc:  0.9132632953288108
EarlyStopping counter: 4 out of 50
epoch:  28
epoch:  29 val_f1:  0.7531731915989216 val_auroc:  0.8031418753068237 val_auprc:  0.9123787482246675
EarlyStopping counter: 5 out of 50
epoch:  29
epoch:  30 val_f1:  0.7552115339652351 val_auroc:  0.8082965144820815 val_auprc:  0.915088862118441
EarlyStopping counter: 6 out of 50
epoch:  30
epoch:  31 val_f1:  0.6729375272402062 val_auroc:  0.8139420716740303 val_auprc:  0.9188233488320143
EarlyStopping counter: 7 out of 50
epoch:  31
epoch:  32 val_f1:  0.7466980132583976 val_auroc:  0.8055964653902798 val_auprc:  0.9133485030142364
EarlyStopping counter: 8 out of 50
epoch:  32
epoch:  33 val_f1:  0.6963686193902022 val_auroc:  0.8151693667157585 val_auprc:  0.9205250107506016
EarlyStopping counter: 9 out of 50
epoch:  33
epoch:  34 val_f1:  0.7455074238481555 val_auroc:  0.8082965144820815 val_auprc:  0.915642102155745
EarlyStopping counter: 10 out of 50
epoch:  34
epoch:  35 val_f1:  0.7626195746699344 val_auroc:  0.8107511045655376 val_auprc:  0.9167743332127085
EarlyStopping counter: 11 out of 50
epoch:  35
epoch:  36 val_f1:  0.7428255465713769 val_auroc:  0.8190967108492881 val_auprc:  0.9219500739414008
EarlyStopping counter: 12 out of 50
epoch:  36
epoch:  37 val_f1:  0.7428255465713769 val_auroc:  0.8163966617574865 val_auprc:  0.9198600542069851
EarlyStopping counter: 13 out of 50
epoch:  37
epoch:  38 val_f1:  0.7531731915989216 val_auroc:  0.8100147275405009 val_auprc:  0.9160904688289478
EarlyStopping counter: 14 out of 50
epoch:  38
epoch:  39 val_f1:  0.7096759374109908 val_auroc:  0.8230240549828179 val_auprc:  0.9249544251924546
EarlyStopping counter: 15 out of 50
epoch:  39
epoch:  40 val_f1:  0.7505653177403916 val_auroc:  0.8053510063819342 val_auprc:  0.9127843165271312
EarlyStopping counter: 16 out of 50
epoch:  40
epoch:  41 val_f1:  0.7428255465713769 val_auroc:  0.8166421207658321 val_auprc:  0.9207560847061843
EarlyStopping counter: 17 out of 50
epoch:  41
epoch:  42 val_f1:  0.7466980132583976 val_auroc:  0.8124693176239568 val_auprc:  0.918062961992308
EarlyStopping counter: 18 out of 50
epoch:  42
epoch:  43 val_f1:  0.7295632867761842 val_auroc:  0.819833087874325 val_auprc:  0.9221414724700698
EarlyStopping counter: 19 out of 50
epoch:  43
epoch:  44 val_f1:  0.7648187281552264 val_auroc:  0.8134511536573392 val_auprc:  0.9179625103389444
EarlyStopping counter: 20 out of 50
epoch:  44
epoch:  45 val_f1:  0.7304528631430115 val_auroc:  0.823514972999509 val_auprc:  0.9249171798349316
EarlyStopping counter: 21 out of 50
epoch:  45
epoch:  46 val_f1:  0.7390688025474315 val_auroc:  0.8178694158075602 val_auprc:  0.9213455619388095
EarlyStopping counter: 22 out of 50
epoch:  46
epoch:  47 val_f1:  0.7428255465713769 val_auroc:  0.8186057928325969 val_auprc:  0.9217035101544052
EarlyStopping counter: 23 out of 50
epoch:  47
epoch:  48 val_f1:  0.7236892364125374 val_auroc:  0.821060382916053 val_auprc:  0.9232013601867083
EarlyStopping counter: 24 out of 50
epoch:  48
epoch:  49 val_f1:  0.7455074238481555 val_auroc:  0.8176239567992145 val_auprc:  0.9199771381815037
EarlyStopping counter: 25 out of 50
epoch:  49
epoch:  50 val_f1:  0.7402181480621955 val_auroc:  0.8225331369661267 val_auprc:  0.9235856019640463
EarlyStopping counter: 26 out of 50
epoch:  50
epoch:  51 val_f1:  0.7633550302615051 val_auroc:  0.8225331369661266 val_auprc:  0.9236051318343664
EarlyStopping counter: 27 out of 50
epoch:  51
epoch:  52 val_f1:  0.748656020238754 val_auroc:  0.8217967599410899 val_auprc:  0.9231358262604941
EarlyStopping counter: 28 out of 50
epoch:  52
epoch:  53 val_f1:  0.7633550302615051 val_auroc:  0.8195876288659794 val_auprc:  0.9221257421301218
EarlyStopping counter: 29 out of 50
epoch:  53
epoch:  54 val_f1:  0.7583800901862243 val_auroc:  0.8124693176239568 val_auprc:  0.9167907843821794
EarlyStopping counter: 30 out of 50
epoch:  54
epoch:  55 val_f1:  0.748656020238754 val_auroc:  0.823514972999509 val_auprc:  0.9252536821642648
EarlyStopping counter: 31 out of 50
epoch:  55
epoch:  56 val_f1:  0.7500864926036699 val_auroc:  0.8237604320078548 val_auprc:  0.9262495561768301
EarlyStopping counter: 32 out of 50
epoch:  56
epoch:  57 val_f1:  0.7346924658075737 val_auroc:  0.8217967599410898 val_auprc:  0.9238065857008757
EarlyStopping counter: 33 out of 50
epoch:  57
epoch:  58 val_f1:  0.7428255465713769 val_auroc:  0.8230240549828179 val_auprc:  0.9242216015481762
EarlyStopping counter: 34 out of 50
epoch:  58
epoch:  59 val_f1:  0.7402181480621955 val_auroc:  0.8232695139911634 val_auprc:  0.9241118415380762
EarlyStopping counter: 35 out of 50
epoch:  59
epoch:  60 val_f1:  0.748656020238754 val_auroc:  0.823514972999509 val_auprc:  0.9247860934926315
EarlyStopping counter: 36 out of 50
epoch:  60
epoch:  61 val_f1:  0.7402181480621955 val_auroc:  0.8252331860579284 val_auprc:  0.924763518188292
EarlyStopping counter: 37 out of 50
epoch:  61
epoch:  62 val_f1:  0.7725930260576229 val_auroc:  0.8208149239077074 val_auprc:  0.9227148612841043
EarlyStopping counter: 38 out of 50
epoch:  62
epoch:  63 val_f1:  0.7697841726618705 val_auroc:  0.8181148748159057 val_auprc:  0.9215325262086693
EarlyStopping counter: 39 out of 50
epoch:  63
epoch:  64 val_f1:  0.7402181480621955 val_auroc:  0.8208149239077075 val_auprc:  0.9229345132405393
EarlyStopping counter: 40 out of 50
epoch:  64
epoch:  65 val_f1:  0.7337314237416728 val_auroc:  0.822287677957781 val_auprc:  0.9242870716135476
EarlyStopping counter: 41 out of 50
epoch:  65
epoch:  66 val_f1:  0.7506155503404762 val_auroc:  0.8240058910162003 val_auprc:  0.9254545589356693
EarlyStopping counter: 42 out of 50
epoch:  66
epoch:  67 val_f1:  0.7648187281552264 val_auroc:  0.8190967108492881 val_auprc:  0.9217454237817657
EarlyStopping counter: 43 out of 50
epoch:  67
epoch:  68 val_f1:  0.7633550302615051 val_auroc:  0.8244968090328915 val_auprc:  0.9256099299924762
EarlyStopping counter: 44 out of 50
epoch:  68
epoch:  69 val_f1:  0.7402181480621955 val_auroc:  0.8213058419243986 val_auprc:  0.9230287915544129
EarlyStopping counter: 45 out of 50
epoch:  69
epoch:  70 val_f1:  0.7648187281552264 val_auroc:  0.8168875797741778 val_auprc:  0.920857057871515
EarlyStopping counter: 46 out of 50
epoch:  70
epoch:  71 val_f1:  0.7583800901862243 val_auroc:  0.8205694648993618 val_auprc:  0.9229882286665297
EarlyStopping counter: 47 out of 50
epoch:  71
epoch:  72 val_f1:  0.7494347379239465 val_auroc:  0.823514972999509 val_auprc:  0.9244529243497925
EarlyStopping counter: 48 out of 50
epoch:  72
epoch:  73 val_f1:  0.7552115339652351 val_auroc:  0.8222876779577811 val_auprc:  0.923333336348651
EarlyStopping counter: 49 out of 50
epoch:  73
epoch:  74 val_f1:  0.7633550302615051 val_auroc:  0.8237604320078546 val_auprc:  0.925092193250517
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  56.550750732421875
{'time_elapsed': [56.550750732421875], 'epoch': [73], 'fold': [0], 'f1_train': [0.9732420167202777], 'auroc_train': [0.9989116105098568], 'auprc_train': [0.9995225480082692], 'f1_test': [0.7633550302615051], 'auroc_test': [0.8237604320078546], 'auprc_test': [0.925092193250517]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 256]            1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 256]            512
│    └─Tanh: 2-3                         [64, 256, 256]            --
│    └─MaxPool1d: 2-4                    [64, 256, 51]             --
│    └─Dropout: 2-5                      [64, 256, 51]             --
│    └─Flatten: 2-6                      [64, 13056]               --
│    └─Linear: 2-7                       [64, 1]                   13,057
==========================================================================================
Total params: 15,105
Trainable params: 15,105
Non-trainable params: 0
Total mult-adds (M): 26.03
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 67.11
Params size (MB): 0.06
Estimated Total Size (MB): 67.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5901444900487328 val_auroc:  0.6536573392243495 val_auprc:  0.8058182068231462
epoch:  1
epoch:  2 val_f1:  0.48681017726789383 val_auroc:  0.6752577319587628 val_auprc:  0.8637526165875178
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6152937189172818 val_auroc:  0.6934216985763378 val_auprc:  0.8742531111102132
Validation loss improved to 1.173590
epoch:  3
epoch:  4 val_f1:  0.6663975251072785 val_auroc:  0.7022582228767795 val_auprc:  0.8791605355492222
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.6115107913669066 val_auroc:  0.7187039764359353 val_auprc:  0.8893297467526051
Validation loss improved to 1.124983
epoch:  5
epoch:  6 val_f1:  0.7028070029525513 val_auroc:  0.7290132547864506 val_auprc:  0.8935763242339696
Validation loss improved to 1.105186
epoch:  6
epoch:  7 val_f1:  0.7215941532488295 val_auroc:  0.7503681885125184 val_auprc:  0.9001136533902828
Validation loss improved to 1.073542
epoch:  7
epoch:  8 val_f1:  0.72389147505525 val_auroc:  0.7614138438880708 val_auprc:  0.9042563490416944
Validation loss improved to 1.063343
epoch:  8
epoch:  9 val_f1:  0.6580621620350778 val_auroc:  0.7727049582719686 val_auprc:  0.9083116539758989
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7283736963917239 val_auroc:  0.7869415807560137 val_auprc:  0.9118697274669401
Validation loss improved to 1.019132
epoch:  10
epoch:  11 val_f1:  0.7567268683783295 val_auroc:  0.7906234658811979 val_auprc:  0.9132366986537093
Validation loss improved to 1.002625
epoch:  11
epoch:  12 val_f1:  0.7510257046352308 val_auroc:  0.8031418753068238 val_auprc:  0.9195783386350227
Validation loss improved to 0.999283
epoch:  12
epoch:  13 val_f1:  0.7515385282135737 val_auroc:  0.8065783014236623 val_auprc:  0.921683326454326
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7490302789770621 val_auroc:  0.8124693176239568 val_auprc:  0.9221154078149523
Validation loss improved to 0.972695
epoch:  14
epoch:  15 val_f1:  0.7560320485424044 val_auroc:  0.8124693176239568 val_auprc:  0.9220882729911339
Validation loss improved to 0.959618
epoch:  15
epoch:  16 val_f1:  0.7644702419882276 val_auroc:  0.8124693176239568 val_auprc:  0.9225586373279482
Validation loss improved to 0.959284
epoch:  16
epoch:  17 val_f1:  0.7573003855683703 val_auroc:  0.8168875797741777 val_auprc:  0.9240874682308504
Validation loss improved to 0.951914
epoch:  17
epoch:  18 val_f1:  0.7567268683783295 val_auroc:  0.8190967108492883 val_auprc:  0.9244367293259088
Validation loss improved to 0.944358
epoch:  18
epoch:  19 val_f1:  0.7683026725960121 val_auroc:  0.8195876288659794 val_auprc:  0.9238185397953923
Validation loss improved to 0.937345
epoch:  19
epoch:  20 val_f1:  0.7748426784519089 val_auroc:  0.8188512518409427 val_auprc:  0.9232629132996307
Validation loss improved to 0.935448
epoch:  20
epoch:  21 val_f1:  0.7596459003010357 val_auroc:  0.8193421698576338 val_auprc:  0.9233834706554762
Validation loss improved to 0.934969
epoch:  21
epoch:  22 val_f1:  0.7596459003010357 val_auroc:  0.8203240058910163 val_auprc:  0.9230603885938328
Validation loss improved to 0.927000
epoch:  22
epoch:  23 val_f1:  0.7633550302615051 val_auroc:  0.8240058910162003 val_auprc:  0.9254203892152588
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7552115339652351 val_auroc:  0.8240058910162004 val_auprc:  0.9249147661200288
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.7617596949267598 val_auroc:  0.8247422680412372 val_auprc:  0.9254967214266634
Validation loss improved to 0.926749
epoch:  25
epoch:  26 val_f1:  0.7496568898727172 val_auroc:  0.8230240549828179 val_auprc:  0.9231422724184125
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7719216534287021 val_auroc:  0.8227785959744723 val_auprc:  0.9247164308175506
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7648187281552264 val_auroc:  0.822287677957781 val_auprc:  0.9232591941023691
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.7691994463100789 val_auroc:  0.8227785959744722 val_auprc:  0.923830768564835
EarlyStopping counter: 4 out of 50
epoch:  29
epoch:  30 val_f1:  0.7683026725960121 val_auroc:  0.8242513500245459 val_auprc:  0.9243699732905135
Validation loss improved to 0.925319
epoch:  30
epoch:  31 val_f1:  0.7569659388768054 val_auroc:  0.8242513500245459 val_auprc:  0.9241103012430146
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.7496568898727172 val_auroc:  0.8213058419243986 val_auprc:  0.9218075177123357
EarlyStopping counter: 2 out of 50
epoch:  32
epoch:  33 val_f1:  0.7500864926036699 val_auroc:  0.8227785959744723 val_auprc:  0.9236824729624942
EarlyStopping counter: 3 out of 50
epoch:  33
epoch:  34 val_f1:  0.7569659388768054 val_auroc:  0.8205694648993619 val_auprc:  0.9221465521240352
EarlyStopping counter: 4 out of 50
epoch:  34
epoch:  35 val_f1:  0.7839141001375581 val_auroc:  0.8232695139911635 val_auprc:  0.9241529855360661
EarlyStopping counter: 5 out of 50
epoch:  35
epoch:  36 val_f1:  0.7748426784519089 val_auroc:  0.8217967599410899 val_auprc:  0.9229097441768402
EarlyStopping counter: 6 out of 50
epoch:  36
epoch:  37 val_f1:  0.7617684906754855 val_auroc:  0.821060382916053 val_auprc:  0.9221416355532221
EarlyStopping counter: 7 out of 50
epoch:  37
epoch:  38 val_f1:  0.7519437633413868 val_auroc:  0.8215513009327443 val_auprc:  0.9225567900464272
EarlyStopping counter: 8 out of 50
epoch:  38
epoch:  39 val_f1:  0.76000113614692 val_auroc:  0.8200785468826706 val_auprc:  0.9210762519101086
EarlyStopping counter: 9 out of 50
epoch:  39
epoch:  40 val_f1:  0.7691994463100789 val_auroc:  0.8276877761413844 val_auprc:  0.9258027705328989
EarlyStopping counter: 10 out of 50
epoch:  40
epoch:  41 val_f1:  0.7536606851900262 val_auroc:  0.8190967108492881 val_auprc:  0.9209449974636033
EarlyStopping counter: 11 out of 50
epoch:  41
epoch:  42 val_f1:  0.766354189375772 val_auroc:  0.8193421698576339 val_auprc:  0.9205033241100474
EarlyStopping counter: 12 out of 50
epoch:  42
epoch:  43 val_f1:  0.76000113614692 val_auroc:  0.8186057928325969 val_auprc:  0.9202549345904364
EarlyStopping counter: 13 out of 50
epoch:  43
epoch:  44 val_f1:  0.7552115339652351 val_auroc:  0.8215513009327442 val_auprc:  0.9225475683062411
EarlyStopping counter: 14 out of 50
epoch:  44
epoch:  45 val_f1:  0.7542604103291037 val_auroc:  0.8225331369661266 val_auprc:  0.9226947419943925
EarlyStopping counter: 15 out of 50
epoch:  45
epoch:  46 val_f1:  0.7685409504908388 val_auroc:  0.8139420716740304 val_auprc:  0.9167400777351341
EarlyStopping counter: 16 out of 50
epoch:  46
epoch:  47 val_f1:  0.7473302173830908 val_auroc:  0.8166421207658321 val_auprc:  0.9189777045116168
EarlyStopping counter: 17 out of 50
epoch:  47
epoch:  48 val_f1:  0.7583800901862243 val_auroc:  0.8200785468826707 val_auprc:  0.9212910598032741
EarlyStopping counter: 18 out of 50
epoch:  48
epoch:  49 val_f1:  0.7643829551743221 val_auroc:  0.81173294059892 val_auprc:  0.9148250785909163
EarlyStopping counter: 19 out of 50
epoch:  49
epoch:  50 val_f1:  0.7607703458551531 val_auroc:  0.8193421698576338 val_auprc:  0.9199402235845772
EarlyStopping counter: 20 out of 50
epoch:  50
epoch:  51 val_f1:  0.7542604103291037 val_auroc:  0.8178694158075602 val_auprc:  0.9190988371858593
EarlyStopping counter: 21 out of 50
epoch:  51
epoch:  52 val_f1:  0.7812454480117876 val_auroc:  0.8085419734904271 val_auprc:  0.9129415117257227
EarlyStopping counter: 22 out of 50
epoch:  52
epoch:  53 val_f1:  0.7454557504588546 val_auroc:  0.8122238586156112 val_auprc:  0.915277953996579
EarlyStopping counter: 23 out of 50
epoch:  53
epoch:  54 val_f1:  0.7583800901862243 val_auroc:  0.8144329896907216 val_auprc:  0.9168218117474176
EarlyStopping counter: 24 out of 50
epoch:  54
epoch:  55 val_f1:  0.7643829551743221 val_auroc:  0.814187530682376 val_auprc:  0.9163180841908474
EarlyStopping counter: 25 out of 50
epoch:  55
epoch:  56 val_f1:  0.7643829551743221 val_auroc:  0.8119783996072656 val_auprc:  0.9146829364410793
EarlyStopping counter: 26 out of 50
epoch:  56
epoch:  57 val_f1:  0.7685409504908388 val_auroc:  0.8100147275405007 val_auprc:  0.9135237176979517
EarlyStopping counter: 27 out of 50
epoch:  57
epoch:  58 val_f1:  0.7505653177403916 val_auroc:  0.8139420716740304 val_auprc:  0.9163426875818417
EarlyStopping counter: 28 out of 50
epoch:  58
epoch:  59 val_f1:  0.7536606851900262 val_auroc:  0.8107511045655376 val_auprc:  0.9143827728850107
EarlyStopping counter: 29 out of 50
epoch:  59
epoch:  60 val_f1:  0.7812454480117876 val_auroc:  0.8060873834069711 val_auprc:  0.9101905948143676
EarlyStopping counter: 30 out of 50
epoch:  60
epoch:  61 val_f1:  0.7490302789770621 val_auroc:  0.8124693176239568 val_auprc:  0.9152794725897236
EarlyStopping counter: 31 out of 50
epoch:  61
epoch:  62 val_f1:  0.7580594896895918 val_auroc:  0.8080510554737359 val_auprc:  0.9109817143615571
EarlyStopping counter: 32 out of 50
epoch:  62
epoch:  63 val_f1:  0.7617684906754855 val_auroc:  0.8102601865488464 val_auprc:  0.9127840186765311
EarlyStopping counter: 33 out of 50
epoch:  63
epoch:  64 val_f1:  0.7812454480117876 val_auroc:  0.8024054982817869 val_auprc:  0.9071548881437608
EarlyStopping counter: 34 out of 50
epoch:  64
epoch:  65 val_f1:  0.7617684906754855 val_auroc:  0.8087874324987727 val_auprc:  0.9113949658035543
EarlyStopping counter: 35 out of 50
epoch:  65
epoch:  66 val_f1:  0.7426698176342648 val_auroc:  0.8075601374570447 val_auprc:  0.9109882218497425
EarlyStopping counter: 36 out of 50
epoch:  66
epoch:  67 val_f1:  0.7580594896895918 val_auroc:  0.8053510063819342 val_auprc:  0.9097174300369908
EarlyStopping counter: 37 out of 50
epoch:  67
epoch:  68 val_f1:  0.787641731275174 val_auroc:  0.8009327442317132 val_auprc:  0.906304120006989
EarlyStopping counter: 38 out of 50
epoch:  68
epoch:  69 val_f1:  0.7553956834532374 val_auroc:  0.8078055964653903 val_auprc:  0.9102565699816284
EarlyStopping counter: 39 out of 50
epoch:  69
epoch:  70 val_f1:  0.7748796193569787 val_auroc:  0.8048600883652429 val_auprc:  0.908599815710585
EarlyStopping counter: 40 out of 50
epoch:  70
epoch:  71 val_f1:  0.7748796193569787 val_auroc:  0.8006872852233676 val_auprc:  0.9068258627725768
EarlyStopping counter: 41 out of 50
epoch:  71
epoch:  72 val_f1:  0.7940719072017342 val_auroc:  0.7989690721649484 val_auprc:  0.9041945293616732
EarlyStopping counter: 42 out of 50
epoch:  72
epoch:  73 val_f1:  0.7617684906754855 val_auroc:  0.802405498281787 val_auprc:  0.906581465285709
EarlyStopping counter: 43 out of 50
epoch:  73
epoch:  74 val_f1:  0.76000113614692 val_auroc:  0.8026509572901325 val_auprc:  0.9065926684690166
EarlyStopping counter: 44 out of 50
epoch:  74
epoch:  75 val_f1:  0.7940719072017342 val_auroc:  0.8009327442317132 val_auprc:  0.9048883731544586
EarlyStopping counter: 45 out of 50
epoch:  75
epoch:  76 val_f1:  0.7727225509205256 val_auroc:  0.8068237604320079 val_auprc:  0.9082804433697993
EarlyStopping counter: 46 out of 50
epoch:  76
epoch:  77 val_f1:  0.7748796193569787 val_auroc:  0.8031418753068237 val_auprc:  0.9063953077970631
EarlyStopping counter: 47 out of 50
epoch:  77
epoch:  78 val_f1:  0.7685409504908388 val_auroc:  0.8001963672066765 val_auprc:  0.9048573398237794
EarlyStopping counter: 48 out of 50
epoch:  78
epoch:  79 val_f1:  0.7748796193569787 val_auroc:  0.801178203240059 val_auprc:  0.9053292850945612
EarlyStopping counter: 49 out of 50
epoch:  79
epoch:  80 val_f1:  0.766354189375772 val_auroc:  0.8036327933235149 val_auprc:  0.9069517358830463
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  55.785383224487305
{'time_elapsed': [55.785383224487305], 'epoch': [79], 'fold': [1], 'f1_train': [0.9803492824837834], 'auroc_train': [0.9999540117116842], 'auprc_train': [0.9999799084533625], 'f1_test': [0.766354189375772], 'auroc_test': [0.8036327933235149], 'auprc_test': [0.9069517358830463]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 256]            1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 256]            512
│    └─Tanh: 2-3                         [64, 256, 256]            --
│    └─MaxPool1d: 2-4                    [64, 256, 51]             --
│    └─Dropout: 2-5                      [64, 256, 51]             --
│    └─Flatten: 2-6                      [64, 13056]               --
│    └─Linear: 2-7                       [64, 1]                   13,057
==========================================================================================
Total params: 15,105
Trainable params: 15,105
Non-trainable params: 0
Total mult-adds (M): 26.03
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 67.11
Params size (MB): 0.06
Estimated Total Size (MB): 67.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.6438389788905253 val_auprc:  0.7852814232460497
epoch:  1
epoch:  2 val_f1:  0.6169361362484226 val_auroc:  0.62346588119784 val_auprc:  0.7670622359757422
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.18143887306667505 val_auroc:  0.6563573883161513 val_auprc:  0.7910256100983214
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.653726075743179 val_auroc:  0.6485027000490918 val_auprc:  0.7838976504941436
Validation loss improved to 1.194663
epoch:  4
epoch:  5 val_f1:  0.45168788046485886 val_auroc:  0.6828669612174767 val_auprc:  0.8115108296703765
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.5666729774075476 val_auroc:  0.7032400589101621 val_auprc:  0.8268600354629364
Validation loss improved to 1.125222
epoch:  6
epoch:  7 val_f1:  0.619566649594801 val_auroc:  0.7302405498281787 val_auprc:  0.8589960999107353
Validation loss improved to 1.103704
epoch:  7
epoch:  8 val_f1:  0.6097807970632291 val_auroc:  0.7535591556210113 val_auprc:  0.8794351590533458
Validation loss improved to 1.097677
epoch:  8
epoch:  9 val_f1:  0.682026026688228 val_auroc:  0.780559646539028 val_auprc:  0.8952683626250595
Validation loss improved to 1.081528
epoch:  9
epoch:  10 val_f1:  0.6532647299881614 val_auroc:  0.7820324005891016 val_auprc:  0.8941744530464214
Validation loss improved to 1.078554
epoch:  10
epoch:  11 val_f1:  0.6737247039763566 val_auroc:  0.7763868433971527 val_auprc:  0.8914240534757318
Validation loss improved to 1.071816
epoch:  11
epoch:  12 val_f1:  0.6825214527173443 val_auroc:  0.7749140893470791 val_auprc:  0.8903686177528793
Validation loss improved to 1.056284
epoch:  12
epoch:  13 val_f1:  0.6441055155875299 val_auroc:  0.7647275405007363 val_auprc:  0.8853796618431617
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7410071942446043 val_auroc:  0.7751595483554248 val_auprc:  0.8902272721030211
Validation loss improved to 1.035602
epoch:  14
epoch:  15 val_f1:  0.6135802455273177 val_auroc:  0.7621502209131075 val_auprc:  0.8836517255800582
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7473302173830908 val_auroc:  0.7734413352970053 val_auprc:  0.8881298282781933
Validation loss improved to 1.024484
epoch:  16
epoch:  17 val_f1:  0.6598406488264144 val_auroc:  0.7628865979381443 val_auprc:  0.8843834809687394
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.7170655771870609 val_auroc:  0.7670594010800197 val_auprc:  0.8868032465693765
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7101700457815566 val_auroc:  0.7670594010800197 val_auprc:  0.8852910305550454
EarlyStopping counter: 3 out of 50
epoch:  19
epoch:  20 val_f1:  0.7090514753972222 val_auroc:  0.7709867452135494 val_auprc:  0.8874914220834934
Validation loss improved to 1.014065
epoch:  20
epoch:  21 val_f1:  0.7281499969472504 val_auroc:  0.772459499263623 val_auprc:  0.8874517024958886
Validation loss improved to 1.006890
epoch:  21
epoch:  22 val_f1:  0.681579990245092 val_auroc:  0.764359351988218 val_auprc:  0.8857995470967894
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7090514753972222 val_auroc:  0.770495827196858 val_auprc:  0.8864353848282343
Validation loss improved to 1.006193
epoch:  23
epoch:  24 val_f1:  0.7023865734042448 val_auroc:  0.7702503681885126 val_auprc:  0.8859233167041861
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7023865734042448 val_auroc:  0.7731958762886598 val_auprc:  0.8878652755972989
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.7023865734042448 val_auroc:  0.7744231713303878 val_auprc:  0.8871405987939711
Validation loss improved to 1.005845
epoch:  26
epoch:  27 val_f1:  0.7236892364125374 val_auroc:  0.7722140402552773 val_auprc:  0.8852932834158367
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7100860488080124 val_auroc:  0.7709867452135494 val_auprc:  0.8846887557003562
EarlyStopping counter: 2 out of 50
epoch:  28
epoch:  29 val_f1:  0.7283736963917239 val_auroc:  0.7778595974472263 val_auprc:  0.885379621276251
EarlyStopping counter: 3 out of 50
epoch:  29
epoch:  30 val_f1:  0.7272357092755477 val_auroc:  0.7785959744722631 val_auprc:  0.8852089758160021
EarlyStopping counter: 4 out of 50
epoch:  30
epoch:  31 val_f1:  0.6524974219867484 val_auroc:  0.7633775159548356 val_auprc:  0.8809221675608486
EarlyStopping counter: 5 out of 50
epoch:  31
epoch:  32 val_f1:  0.7032425848040964 val_auroc:  0.7741777123220422 val_auprc:  0.8859719133010588
EarlyStopping counter: 6 out of 50
epoch:  32
epoch:  33 val_f1:  0.7391671278361928 val_auroc:  0.794305351006382 val_auprc:  0.8956069691957664
EarlyStopping counter: 7 out of 50
epoch:  33
epoch:  34 val_f1:  0.703263898025454 val_auroc:  0.7724594992636231 val_auprc:  0.8860784304781126
EarlyStopping counter: 8 out of 50
epoch:  34
epoch:  35 val_f1:  0.7233618940391454 val_auroc:  0.7734413352970054 val_auprc:  0.8852850634151922
EarlyStopping counter: 9 out of 50
epoch:  35
epoch:  36 val_f1:  0.7328919440906961 val_auroc:  0.7832596956308298 val_auprc:  0.8898179855390767
EarlyStopping counter: 10 out of 50
epoch:  36
epoch:  37 val_f1:  0.696151679426677 val_auroc:  0.7653411880216004 val_auprc:  0.8811469853351724
EarlyStopping counter: 11 out of 50
epoch:  37
epoch:  38 val_f1:  0.7157412825720284 val_auroc:  0.780559646539028 val_auprc:  0.8876907050221385
EarlyStopping counter: 12 out of 50
epoch:  38
epoch:  39 val_f1:  0.7156947373800909 val_auroc:  0.7729504172803142 val_auprc:  0.8844734011271507
EarlyStopping counter: 13 out of 50
epoch:  39
epoch:  40 val_f1:  0.7098736982331642 val_auroc:  0.7702503681885126 val_auprc:  0.8846604603411528
EarlyStopping counter: 14 out of 50
epoch:  40
epoch:  41 val_f1:  0.7166299330477814 val_auroc:  0.7709867452135494 val_auprc:  0.8847324484363985
EarlyStopping counter: 15 out of 50
epoch:  41
epoch:  42 val_f1:  0.7095299887411026 val_auroc:  0.771232204221895 val_auprc:  0.8845157319866308
EarlyStopping counter: 16 out of 50
epoch:  42
epoch:  43 val_f1:  0.7018261879839978 val_auroc:  0.7741777123220422 val_auprc:  0.8863065453931039
EarlyStopping counter: 17 out of 50
epoch:  43
epoch:  44 val_f1:  0.7346891520614657 val_auroc:  0.7751595483554247 val_auprc:  0.8854541914776473
EarlyStopping counter: 18 out of 50
epoch:  44
epoch:  45 val_f1:  0.7030912407309765 val_auroc:  0.7668139420716741 val_auprc:  0.8824598137522937
EarlyStopping counter: 19 out of 50
epoch:  45
epoch:  46 val_f1:  0.7272357092755477 val_auroc:  0.773686794305351 val_auprc:  0.8862149174437701
EarlyStopping counter: 20 out of 50
epoch:  46
epoch:  47 val_f1:  0.7121336235283787 val_auroc:  0.7754050073637703 val_auprc:  0.8862066651191518
EarlyStopping counter: 21 out of 50
epoch:  47
epoch:  48 val_f1:  0.7249644134959412 val_auroc:  0.7749140893470791 val_auprc:  0.8859249961473238
EarlyStopping counter: 22 out of 50
epoch:  48
epoch:  49 val_f1:  0.6894622188638474 val_auroc:  0.7663230240549829 val_auprc:  0.8821458426362778
EarlyStopping counter: 23 out of 50
epoch:  49
epoch:  50 val_f1:  0.7473302173830908 val_auroc:  0.7744231713303878 val_auprc:  0.8868469696309907
EarlyStopping counter: 24 out of 50
epoch:  50
epoch:  51 val_f1:  0.7346891520614657 val_auroc:  0.7727049582719685 val_auprc:  0.8860895357643814
EarlyStopping counter: 25 out of 50
epoch:  51
epoch:  52 val_f1:  0.6937535685737124 val_auroc:  0.7675503190967109 val_auprc:  0.883135465877793
EarlyStopping counter: 26 out of 50
epoch:  52
epoch:  53 val_f1:  0.7011215811505187 val_auroc:  0.7677957781050565 val_auprc:  0.8831507092320177
EarlyStopping counter: 27 out of 50
epoch:  53
epoch:  54 val_f1:  0.6937535685737124 val_auroc:  0.7712322042218949 val_auprc:  0.8859537465946581
EarlyStopping counter: 28 out of 50
epoch:  54
epoch:  55 val_f1:  0.7002679453520968 val_auroc:  0.7675503190967109 val_auprc:  0.8838718389757991
EarlyStopping counter: 29 out of 50
epoch:  55
epoch:  56 val_f1:  0.7235944791518311 val_auroc:  0.7658321060382917 val_auprc:  0.8829136297609714
EarlyStopping counter: 30 out of 50
epoch:  56
epoch:  57 val_f1:  0.7346891520614657 val_auroc:  0.7670594010800197 val_auprc:  0.8832087495665795
EarlyStopping counter: 31 out of 50
epoch:  57
epoch:  58 val_f1:  0.6813420921017198 val_auroc:  0.7594501718213059 val_auprc:  0.8799514415877402
EarlyStopping counter: 32 out of 50
epoch:  58
epoch:  59 val_f1:  0.7057031525565856 val_auroc:  0.7638684339715268 val_auprc:  0.8825063185931257
EarlyStopping counter: 33 out of 50
epoch:  59
epoch:  60 val_f1:  0.6813420921017198 val_auroc:  0.7577319587628867 val_auprc:  0.8796627573685056
EarlyStopping counter: 34 out of 50
epoch:  60
epoch:  61 val_f1:  0.7057031525565856 val_auroc:  0.7623956799214532 val_auprc:  0.8815098818693022
EarlyStopping counter: 35 out of 50
epoch:  61
epoch:  62 val_f1:  0.7057031525565856 val_auroc:  0.7616593028964164 val_auprc:  0.8812415630661332
EarlyStopping counter: 36 out of 50
epoch:  62
epoch:  63 val_f1:  0.7057031525565856 val_auroc:  0.7619047619047619 val_auprc:  0.8812350356591696
EarlyStopping counter: 37 out of 50
epoch:  63
epoch:  64 val_f1:  0.7011215811505187 val_auroc:  0.7574864997545411 val_auprc:  0.8794453076404596
EarlyStopping counter: 38 out of 50
epoch:  64
epoch:  65 val_f1:  0.6992598845858601 val_auroc:  0.758713794796269 val_auprc:  0.8800372984675205
EarlyStopping counter: 39 out of 50
epoch:  65
epoch:  66 val_f1:  0.7057031525565856 val_auroc:  0.7582228767795779 val_auprc:  0.8796689933524011
EarlyStopping counter: 40 out of 50
epoch:  66
epoch:  67 val_f1:  0.7371484630477437 val_auroc:  0.7660775650466373 val_auprc:  0.8828815526757335
EarlyStopping counter: 41 out of 50
epoch:  67
epoch:  68 val_f1:  0.7030919944895149 val_auroc:  0.7589592538046146 val_auprc:  0.8801145077782181
EarlyStopping counter: 42 out of 50
epoch:  68
epoch:  69 val_f1:  0.7057031525565856 val_auroc:  0.7523318605792833 val_auprc:  0.8762278017181433
EarlyStopping counter: 43 out of 50
epoch:  69
epoch:  70 val_f1:  0.7448635686045757 val_auroc:  0.7643593519882179 val_auprc:  0.8833636215526302
EarlyStopping counter: 44 out of 50
epoch:  70
epoch:  71 val_f1:  0.7411406017655346 val_auroc:  0.7569955817378496 val_auprc:  0.878439519907141
EarlyStopping counter: 45 out of 50
epoch:  71
epoch:  72 val_f1:  0.6967556353929608 val_auroc:  0.7515954835542464 val_auprc:  0.8752595812666533
EarlyStopping counter: 46 out of 50
epoch:  72
epoch:  73 val_f1:  0.6674874004539683 val_auroc:  0.7486499754540993 val_auprc:  0.8736210709194145
EarlyStopping counter: 47 out of 50
epoch:  73
epoch:  74 val_f1:  0.7057031525565856 val_auroc:  0.7511045655375552 val_auprc:  0.8741739710472116
EarlyStopping counter: 48 out of 50
epoch:  74
epoch:  75 val_f1:  0.7346891520614657 val_auroc:  0.7577319587628866 val_auprc:  0.8783088166241346
EarlyStopping counter: 49 out of 50
epoch:  75
epoch:  76 val_f1:  0.7328919440906961 val_auroc:  0.7547864506627393 val_auprc:  0.8759430810527193
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  52.28586959838867
{'time_elapsed': [52.28586959838867], 'epoch': [75], 'fold': [2], 'f1_train': [0.9750080606922711], 'auroc_train': [0.9992028696691909], 'auprc_train': [0.999643495327196], 'f1_test': [0.7328919440906961], 'auroc_test': [0.7547864506627393], 'auprc_test': [0.8759430810527193]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 256]            1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 256]            512
│    └─Tanh: 2-3                         [64, 256, 256]            --
│    └─MaxPool1d: 2-4                    [64, 256, 51]             --
│    └─Dropout: 2-5                      [64, 256, 51]             --
│    └─Flatten: 2-6                      [64, 13056]               --
│    └─Linear: 2-7                       [64, 1]                   13,057
==========================================================================================
Total params: 15,105
Trainable params: 15,105
Non-trainable params: 0
Total mult-adds (M): 26.03
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 67.11
Params size (MB): 0.06
Estimated Total Size (MB): 67.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.607556839303357 val_auroc:  0.6705426356589147 val_auprc:  0.8118995083739742
epoch:  1
epoch:  2 val_f1:  0.5618579763055227 val_auroc:  0.7068798449612402 val_auprc:  0.8723465082167414
Validation loss improved to 1.191097
epoch:  2
epoch:  3 val_f1:  0.6328374193848804 val_auroc:  0.7279554263565892 val_auprc:  0.8850367934630776
Validation loss improved to 1.158999
epoch:  3
epoch:  4 val_f1:  0.67308393638829 val_auroc:  0.7323158914728682 val_auprc:  0.8857482938381068
Validation loss improved to 1.125212
epoch:  4
epoch:  5 val_f1:  0.6634343011028072 val_auroc:  0.7664728682170543 val_auprc:  0.9019371399195383
Validation loss improved to 1.114402
epoch:  5
epoch:  6 val_f1:  0.7230046514777908 val_auroc:  0.778827519379845 val_auprc:  0.9073468007316507
Validation loss improved to 1.064075
epoch:  6
epoch:  7 val_f1:  0.7311239367552241 val_auroc:  0.7996608527131782 val_auprc:  0.9150725594605891
Validation loss improved to 1.040983
epoch:  7
epoch:  8 val_f1:  0.7628987147360764 val_auroc:  0.8074127906976744 val_auprc:  0.9175022970222483
Validation loss improved to 1.013622
epoch:  8
epoch:  9 val_f1:  0.7165120915315941 val_auroc:  0.8204941860465116 val_auprc:  0.9216885537383217
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7506277331076315 val_auroc:  0.8185562015503876 val_auprc:  0.9214849551988756
Validation loss improved to 0.976753
epoch:  10
epoch:  11 val_f1:  0.7701596400342386 val_auroc:  0.8226744186046512 val_auprc:  0.9221185741307785
Validation loss improved to 0.958949
epoch:  11
epoch:  12 val_f1:  0.7633328614234447 val_auroc:  0.8260658914728681 val_auprc:  0.9223831903641991
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7773759601944114 val_auroc:  0.8246124031007751 val_auprc:  0.9232693169512038
Validation loss improved to 0.926654
epoch:  13
epoch:  14 val_f1:  0.7849097105470042 val_auroc:  0.8265503875968992 val_auprc:  0.9240337248337288
Validation loss improved to 0.914843
epoch:  14
epoch:  15 val_f1:  0.7659382513381667 val_auroc:  0.8313953488372092 val_auprc:  0.9250345002019921
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7713093666729185 val_auroc:  0.8299418604651163 val_auprc:  0.9257523404548443
Validation loss improved to 0.895345
epoch:  16
epoch:  17 val_f1:  0.7849097105470042 val_auroc:  0.8343023255813954 val_auprc:  0.9273424323177293
Validation loss improved to 0.874767
epoch:  17
epoch:  18 val_f1:  0.7886649052635782 val_auroc:  0.835998062015504 val_auprc:  0.9275268373802181
Validation loss improved to 0.871123
epoch:  18
epoch:  19 val_f1:  0.7811523753969797 val_auroc:  0.8369670542635659 val_auprc:  0.928034246788049
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7781180058147428 val_auroc:  0.8379360465116279 val_auprc:  0.9302351980436139
Validation loss improved to 0.855161
epoch:  20
epoch:  21 val_f1:  0.764639197732723 val_auroc:  0.8391472868217055 val_auprc:  0.9286089986746653
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.8008946034661633 val_auroc:  0.841327519379845 val_auprc:  0.9300300851476713
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.7713093666729185 val_auroc:  0.8422965116279071 val_auprc:  0.933184211702428
Validation loss improved to 0.842748
epoch:  23
epoch:  24 val_f1:  0.7729252582141845 val_auroc:  0.8449612403100776 val_auprc:  0.9321153058261203
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7854893118997625 val_auroc:  0.8439922480620154 val_auprc:  0.9325716635582999
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.7713093666729185 val_auroc:  0.8449612403100776 val_auprc:  0.9343796262590536
Validation loss improved to 0.821256
epoch:  26
epoch:  27 val_f1:  0.8093907785715628 val_auroc:  0.8468992248062015 val_auprc:  0.9334875634071225
Validation loss improved to 0.820464
epoch:  27
epoch:  28 val_f1:  0.792019787311512 val_auroc:  0.8476259689922482 val_auprc:  0.933643251790897
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.7701596400342386 val_auroc:  0.8490794573643411 val_auprc:  0.9357026237822454
Validation loss improved to 0.802077
epoch:  29
epoch:  30 val_f1:  0.7701596400342386 val_auroc:  0.8524709302325582 val_auprc:  0.9375200304847335
Validation loss improved to 0.793099
epoch:  30
epoch:  31 val_f1:  0.8084949329130455 val_auroc:  0.8534399224806202 val_auprc:  0.9380751683223916
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.8027539115793398 val_auroc:  0.8548934108527132 val_auprc:  0.9392147146707832
Validation loss improved to 0.788003
epoch:  32
epoch:  33 val_f1:  0.7706506750217025 val_auroc:  0.8556201550387595 val_auprc:  0.9398988125482023
Validation loss improved to 0.782413
epoch:  33
epoch:  34 val_f1:  0.7997900244397783 val_auroc:  0.8575581395348836 val_auprc:  0.9395816922946445
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.8018807955038493 val_auroc:  0.8565891472868218 val_auprc:  0.9402467092547762
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.8093907785715628 val_auroc:  0.8578003875968992 val_auprc:  0.9408648078789343
Validation loss improved to 0.779910
epoch:  36
epoch:  37 val_f1:  0.7972014141264308 val_auroc:  0.8609496124031008 val_auprc:  0.9411928167230533
EarlyStopping counter: 1 out of 50
epoch:  37
epoch:  38 val_f1:  0.794309372388086 val_auroc:  0.8599806201550387 val_auprc:  0.9418285311405324
Validation loss improved to 0.777290
epoch:  38
epoch:  39 val_f1:  0.7768458491633659 val_auroc:  0.8602228682170543 val_auprc:  0.9426478723721956
Validation loss improved to 0.770158
epoch:  39
epoch:  40 val_f1:  0.8074875573056803 val_auroc:  0.8619186046511628 val_auprc:  0.9425310254449929
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.794309372388086 val_auroc:  0.8624031007751938 val_auprc:  0.9434595879096274
Validation loss improved to 0.768170
epoch:  41
epoch:  42 val_f1:  0.8008946034661633 val_auroc:  0.8638565891472868 val_auprc:  0.9442849850224199
EarlyStopping counter: 1 out of 50
epoch:  42
epoch:  43 val_f1:  0.8018807955038493 val_auroc:  0.8653100775193797 val_auprc:  0.9450637457597575
Validation loss improved to 0.761214
epoch:  43
epoch:  44 val_f1:  0.8140907369797942 val_auroc:  0.8653100775193798 val_auprc:  0.9452682297564632
EarlyStopping counter: 1 out of 50
epoch:  44
epoch:  45 val_f1:  0.8063632502555458 val_auroc:  0.8650678294573644 val_auprc:  0.945398066506455
EarlyStopping counter: 2 out of 50
epoch:  45
epoch:  46 val_f1:  0.8018807955038493 val_auroc:  0.8648255813953488 val_auprc:  0.945259708470832
EarlyStopping counter: 3 out of 50
epoch:  46
epoch:  47 val_f1:  0.8008946034661633 val_auroc:  0.8653100775193798 val_auprc:  0.9459599024448739
EarlyStopping counter: 4 out of 50
epoch:  47
epoch:  48 val_f1:  0.8027539115793398 val_auroc:  0.8648255813953488 val_auprc:  0.9458567907452684
Validation loss improved to 0.755220
epoch:  48
epoch:  49 val_f1:  0.794309372388086 val_auroc:  0.8674903100775194 val_auprc:  0.9468583210257755
EarlyStopping counter: 1 out of 50
epoch:  49
epoch:  50 val_f1:  0.7972014141264308 val_auroc:  0.872577519379845 val_auprc:  0.9486655780018715
EarlyStopping counter: 2 out of 50
epoch:  50
epoch:  51 val_f1:  0.8027539115793398 val_auroc:  0.868217054263566 val_auprc:  0.9473954859497131
Validation loss improved to 0.744416
epoch:  51
epoch:  52 val_f1:  0.8129496402877698 val_auroc:  0.8708817829457365 val_auprc:  0.94819262065047
EarlyStopping counter: 1 out of 50
epoch:  52
epoch:  53 val_f1:  0.7881529434639887 val_auroc:  0.8752422480620156 val_auprc:  0.9490026623712344
EarlyStopping counter: 2 out of 50
epoch:  53
epoch:  54 val_f1:  0.8018807955038493 val_auroc:  0.8703972868217055 val_auprc:  0.9483199720599973
EarlyStopping counter: 3 out of 50
epoch:  54
epoch:  55 val_f1:  0.7932273763653603 val_auroc:  0.868217054263566 val_auprc:  0.9474537026574263
EarlyStopping counter: 4 out of 50
epoch:  55
epoch:  56 val_f1:  0.8037391402911035 val_auroc:  0.8725775193798448 val_auprc:  0.9493392830504481
EarlyStopping counter: 5 out of 50
epoch:  56
epoch:  57 val_f1:  0.8018807955038493 val_auroc:  0.8728197674418604 val_auprc:  0.9498338950898039
Validation loss improved to 0.742882
epoch:  57
epoch:  58 val_f1:  0.8093907785715628 val_auroc:  0.873062015503876 val_auprc:  0.949646626803569
EarlyStopping counter: 1 out of 50
epoch:  58
epoch:  59 val_f1:  0.783844953500274 val_auroc:  0.8771802325581394 val_auprc:  0.9509198280975215
EarlyStopping counter: 2 out of 50
epoch:  59
epoch:  60 val_f1:  0.8093907785715628 val_auroc:  0.8708817829457364 val_auprc:  0.9488199900793153
EarlyStopping counter: 3 out of 50
epoch:  60
epoch:  61 val_f1:  0.8008946034661633 val_auroc:  0.8730620155038759 val_auprc:  0.9497941956351097
EarlyStopping counter: 4 out of 50
epoch:  61
epoch:  62 val_f1:  0.8063632502555458 val_auroc:  0.875968992248062 val_auprc:  0.9508457356236508
EarlyStopping counter: 5 out of 50
epoch:  62
epoch:  63 val_f1:  0.8063632502555458 val_auroc:  0.876937984496124 val_auprc:  0.9511801161327558
EarlyStopping counter: 6 out of 50
epoch:  63
epoch:  64 val_f1:  0.7932273763653603 val_auroc:  0.875484496124031 val_auprc:  0.9507152256535945
EarlyStopping counter: 7 out of 50
epoch:  64
epoch:  65 val_f1:  0.8063632502555458 val_auroc:  0.8752422480620154 val_auprc:  0.9504302154601891
EarlyStopping counter: 8 out of 50
epoch:  65
epoch:  66 val_f1:  0.7866727894280321 val_auroc:  0.8749999999999999 val_auprc:  0.9502839041130643
EarlyStopping counter: 9 out of 50
epoch:  66
epoch:  67 val_f1:  0.7875752415552048 val_auroc:  0.8759689922480619 val_auprc:  0.9510540530340922
EarlyStopping counter: 10 out of 50
epoch:  67
epoch:  68 val_f1:  0.7997900244397783 val_auroc:  0.876453488372093 val_auprc:  0.9512735445079699
EarlyStopping counter: 11 out of 50
epoch:  68
epoch:  69 val_f1:  0.8063632502555458 val_auroc:  0.8766957364341086 val_auprc:  0.9510964251427392
EarlyStopping counter: 12 out of 50
epoch:  69
epoch:  70 val_f1:  0.7985611510791367 val_auroc:  0.8764534883720931 val_auprc:  0.9510868148349539
EarlyStopping counter: 13 out of 50
epoch:  70
epoch:  71 val_f1:  0.8063632502555458 val_auroc:  0.8771802325581395 val_auprc:  0.9517267024315689
EarlyStopping counter: 14 out of 50
epoch:  71
epoch:  72 val_f1:  0.8063632502555458 val_auroc:  0.8771802325581395 val_auprc:  0.9515494676878434
EarlyStopping counter: 15 out of 50
epoch:  72
epoch:  73 val_f1:  0.7985611510791367 val_auroc:  0.8774224806201549 val_auprc:  0.95168559518957
EarlyStopping counter: 16 out of 50
epoch:  73
epoch:  74 val_f1:  0.7866727894280321 val_auroc:  0.8737887596899225 val_auprc:  0.950201684362626
EarlyStopping counter: 17 out of 50
epoch:  74
epoch:  75 val_f1:  0.7985611510791367 val_auroc:  0.876937984496124 val_auprc:  0.951571823462906
EarlyStopping counter: 18 out of 50
epoch:  75
epoch:  76 val_f1:  0.7774211400110681 val_auroc:  0.8781492248062015 val_auprc:  0.9522142799428172
EarlyStopping counter: 19 out of 50
epoch:  76
epoch:  77 val_f1:  0.7997900244397783 val_auroc:  0.877422480620155 val_auprc:  0.9518415980268959
EarlyStopping counter: 20 out of 50
epoch:  77
epoch:  78 val_f1:  0.7997900244397783 val_auroc:  0.8783914728682172 val_auprc:  0.9522260415419523
EarlyStopping counter: 21 out of 50
epoch:  78
epoch:  79 val_f1:  0.7875752415552048 val_auroc:  0.877422480620155 val_auprc:  0.9519188020474134
EarlyStopping counter: 22 out of 50
epoch:  79
epoch:  80 val_f1:  0.8051160047274586 val_auroc:  0.877906976744186 val_auprc:  0.9521873131183809
EarlyStopping counter: 23 out of 50
epoch:  80
epoch:  81 val_f1:  0.7997900244397783 val_auroc:  0.8764534883720931 val_auprc:  0.9511344055222233
EarlyStopping counter: 24 out of 50
epoch:  81
epoch:  82 val_f1:  0.7985611510791367 val_auroc:  0.8776647286821706 val_auprc:  0.9516573912747357
EarlyStopping counter: 25 out of 50
epoch:  82
epoch:  83 val_f1:  0.792019787311512 val_auroc:  0.8781492248062015 val_auprc:  0.9519928352541986
EarlyStopping counter: 26 out of 50
epoch:  83
epoch:  84 val_f1:  0.7957035068809065 val_auroc:  0.8776647286821705 val_auprc:  0.9521116807746459
EarlyStopping counter: 27 out of 50
epoch:  84
epoch:  85 val_f1:  0.792019787311512 val_auroc:  0.8762112403100775 val_auprc:  0.9512048897140851
EarlyStopping counter: 28 out of 50
epoch:  85
epoch:  86 val_f1:  0.792019787311512 val_auroc:  0.8771802325581395 val_auprc:  0.9517560284962958
EarlyStopping counter: 29 out of 50
epoch:  86
epoch:  87 val_f1:  0.792259730676997 val_auroc:  0.8800872093023256 val_auprc:  0.9529720575176275
EarlyStopping counter: 30 out of 50
epoch:  87
epoch:  88 val_f1:  0.7985611510791367 val_auroc:  0.8759689922480619 val_auprc:  0.9514055174189049
EarlyStopping counter: 31 out of 50
epoch:  88
epoch:  89 val_f1:  0.7972014141264308 val_auroc:  0.8766957364341085 val_auprc:  0.9516846650189161
EarlyStopping counter: 32 out of 50
epoch:  89
epoch:  90 val_f1:  0.7906801532257888 val_auroc:  0.8776647286821706 val_auprc:  0.9519188667053484
EarlyStopping counter: 33 out of 50
epoch:  90
epoch:  91 val_f1:  0.8037391402911035 val_auroc:  0.877422480620155 val_auprc:  0.9517118072392625
EarlyStopping counter: 34 out of 50
epoch:  91
epoch:  92 val_f1:  0.7957035068809065 val_auroc:  0.8762112403100776 val_auprc:  0.9516304934846488
EarlyStopping counter: 35 out of 50
epoch:  92
epoch:  93 val_f1:  0.792019787311512 val_auroc:  0.8759689922480621 val_auprc:  0.9508478603163605
EarlyStopping counter: 36 out of 50
epoch:  93
epoch:  94 val_f1:  0.7957035068809065 val_auroc:  0.8781492248062015 val_auprc:  0.9520843725948418
EarlyStopping counter: 37 out of 50
epoch:  94
epoch:  95 val_f1:  0.8022252248962252 val_auroc:  0.8781492248062016 val_auprc:  0.9521891109429789
EarlyStopping counter: 38 out of 50
epoch:  95
epoch:  96 val_f1:  0.7892012988311853 val_auroc:  0.877422480620155 val_auprc:  0.9517377987790836
EarlyStopping counter: 39 out of 50
epoch:  96
epoch:  97 val_f1:  0.7957035068809065 val_auroc:  0.8764534883720929 val_auprc:  0.9512766987584326
EarlyStopping counter: 40 out of 50
epoch:  97
epoch:  98 val_f1:  0.7940592980161325 val_auroc:  0.8776647286821706 val_auprc:  0.9521302802124604
EarlyStopping counter: 41 out of 50
epoch:  98
epoch:  99 val_f1:  0.7827158008497472 val_auroc:  0.8759689922480621 val_auprc:  0.9513129665586155
EarlyStopping counter: 42 out of 50
epoch:  99
epoch:  100 val_f1:  0.7957035068809065 val_auroc:  0.876453488372093 val_auprc:  0.9513901946235968
EarlyStopping counter: 43 out of 50
epoch:  100
epoch:  101 val_f1:  0.8022252248962252 val_auroc:  0.8759689922480619 val_auprc:  0.9512074776344879
EarlyStopping counter: 44 out of 50
epoch:  101
epoch:  102 val_f1:  0.8037391402911035 val_auroc:  0.8752422480620156 val_auprc:  0.9504235010507391
EarlyStopping counter: 45 out of 50
epoch:  102
epoch:  103 val_f1:  0.8022252248962252 val_auroc:  0.8783914728682171 val_auprc:  0.9523516637646646
EarlyStopping counter: 46 out of 50
epoch:  103
epoch:  104 val_f1:  0.7892012988311853 val_auroc:  0.876937984496124 val_auprc:  0.9516223298917166
EarlyStopping counter: 47 out of 50
epoch:  104
epoch:  105 val_f1:  0.7957035068809065 val_auroc:  0.8752422480620156 val_auprc:  0.9506775229594537
EarlyStopping counter: 48 out of 50
epoch:  105
epoch:  106 val_f1:  0.8022252248962252 val_auroc:  0.8771802325581396 val_auprc:  0.9515139027194047
EarlyStopping counter: 49 out of 50
epoch:  106
epoch:  107 val_f1:  0.7892012988311853 val_auroc:  0.8771802325581396 val_auprc:  0.9515109424542705
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  74.0550045967102
{'time_elapsed': [74.0550045967102], 'epoch': [106], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7892012988311853], 'auroc_test': [0.8771802325581396], 'auprc_test': [0.9515109424542705]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 256]            1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 256]            512
│    └─Tanh: 2-3                         [64, 256, 256]            --
│    └─MaxPool1d: 2-4                    [64, 256, 51]             --
│    └─Dropout: 2-5                      [64, 256, 51]             --
│    └─Flatten: 2-6                      [64, 13056]               --
│    └─Linear: 2-7                       [64, 1]                   13,057
==========================================================================================
Total params: 15,105
Trainable params: 15,105
Non-trainable params: 0
Total mult-adds (M): 26.03
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 67.11
Params size (MB): 0.06
Estimated Total Size (MB): 67.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.2149634093844167 val_auroc:  0.7740575396825398 val_auprc:  0.8884631732315892
epoch:  1
epoch:  2 val_f1:  0.6243325705568269 val_auroc:  0.8018353174603173 val_auprc:  0.9019733369762647
Validation loss improved to 1.167243
epoch:  2
epoch:  3 val_f1:  0.6921962095875139 val_auroc:  0.8070436507936508 val_auprc:  0.9067981312232298
Validation loss improved to 1.075683
epoch:  3
epoch:  4 val_f1:  0.7665601361138573 val_auroc:  0.8216765873015873 val_auprc:  0.9106987994273542
Validation loss improved to 1.041229
epoch:  4
epoch:  5 val_f1:  0.7822581250985979 val_auroc:  0.8392857142857143 val_auprc:  0.916693443737757
Validation loss improved to 1.019142
epoch:  5
epoch:  6 val_f1:  0.7207167709858867 val_auroc:  0.8526785714285715 val_auprc:  0.9218713371874305
Validation loss improved to 1.002374
epoch:  6
epoch:  7 val_f1:  0.782608695652174 val_auroc:  0.8633432539682541 val_auprc:  0.9241027276866495
Validation loss improved to 0.997173
epoch:  7
epoch:  8 val_f1:  0.7703877790834313 val_auroc:  0.8648313492063493 val_auprc:  0.9269956011078323
Validation loss improved to 0.964776
epoch:  8
epoch:  9 val_f1:  0.7822581250985979 val_auroc:  0.8665674603174603 val_auprc:  0.9302902717883456
Validation loss improved to 0.948864
epoch:  9
epoch:  10 val_f1:  0.7346809324365923 val_auroc:  0.8705357142857143 val_auprc:  0.9324512999917369
Validation loss improved to 0.938587
epoch:  10
epoch:  11 val_f1:  0.7901185770750988 val_auroc:  0.8628472222222223 val_auprc:  0.9319109015760594
Validation loss improved to 0.913602
epoch:  11
epoch:  12 val_f1:  0.7664833663128204 val_auroc:  0.8630952380952381 val_auprc:  0.9330070355814204
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7881997743237336 val_auroc:  0.8655753968253969 val_auprc:  0.9338939261317616
Validation loss improved to 0.892399
epoch:  13
epoch:  14 val_f1:  0.7769308547872755 val_auroc:  0.8635912698412699 val_auprc:  0.9328391448294552
Validation loss improved to 0.867883
epoch:  14
epoch:  15 val_f1:  0.7837457330597287 val_auroc:  0.8645833333333334 val_auprc:  0.9331757948589466
Validation loss improved to 0.856870
epoch:  15
epoch:  16 val_f1:  0.7995542847531747 val_auroc:  0.8663194444444446 val_auprc:  0.9343307117397178
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.791810443984357 val_auroc:  0.8663194444444444 val_auprc:  0.9341736946688701
EarlyStopping counter: 2 out of 50
epoch:  17
epoch:  18 val_f1:  0.7911016744679825 val_auroc:  0.8678075396825397 val_auprc:  0.9346980859880551
Validation loss improved to 0.824269
epoch:  18
epoch:  19 val_f1:  0.7842196249660383 val_auroc:  0.8670634920634921 val_auprc:  0.9354241589449112
Validation loss improved to 0.815286
epoch:  19
epoch:  20 val_f1:  0.7745910427020087 val_auroc:  0.8660714285714286 val_auprc:  0.9345633790687875
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7681159420289855 val_auroc:  0.8658234126984127 val_auprc:  0.9350373500664083
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7564718869066693 val_auroc:  0.871031746031746 val_auprc:  0.9379115227683189
EarlyStopping counter: 3 out of 50
epoch:  22
epoch:  23 val_f1:  0.7973334973248877 val_auroc:  0.8697916666666666 val_auprc:  0.9378338121165266
Validation loss improved to 0.795638
epoch:  23
epoch:  24 val_f1:  0.7646850044365572 val_auroc:  0.865327380952381 val_auprc:  0.9352334581538335
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.817642543094424 val_auroc:  0.8695436507936508 val_auprc:  0.9378318166399886
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.7905459035188288 val_auroc:  0.8687996031746031 val_auprc:  0.9375590046460831
Validation loss improved to 0.789526
epoch:  26
epoch:  27 val_f1:  0.8170893719806764 val_auroc:  0.8675595238095238 val_auprc:  0.9366758684128913
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7760956602080848 val_auroc:  0.8658234126984127 val_auprc:  0.9359013913977842
EarlyStopping counter: 2 out of 50
epoch:  28
epoch:  29 val_f1:  0.7968706966496207 val_auroc:  0.8680555555555557 val_auprc:  0.9373669436141558
EarlyStopping counter: 3 out of 50
epoch:  29
epoch:  30 val_f1:  0.7852367336641158 val_auroc:  0.8663194444444444 val_auprc:  0.9360085886306266
EarlyStopping counter: 4 out of 50
epoch:  30
epoch:  31 val_f1:  0.7669132597880164 val_auroc:  0.8618551587301587 val_auprc:  0.9345700922678972
EarlyStopping counter: 5 out of 50
epoch:  31
epoch:  32 val_f1:  0.7681159420289855 val_auroc:  0.8650793650793651 val_auprc:  0.935293062032021
EarlyStopping counter: 6 out of 50
epoch:  32
epoch:  33 val_f1:  0.7908726763630708 val_auroc:  0.8717757936507936 val_auprc:  0.9383819765226449
Validation loss improved to 0.776369
epoch:  33
epoch:  34 val_f1:  0.7833564971403972 val_auroc:  0.8725198412698413 val_auprc:  0.9387511259645656
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.7833564971403972 val_auroc:  0.8737599206349206 val_auprc:  0.9400901938120143
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.7600485293279448 val_auroc:  0.865079365079365 val_auprc:  0.9362890719545351
EarlyStopping counter: 3 out of 50
epoch:  36
epoch:  37 val_f1:  0.7840325451309432 val_auroc:  0.8754960317460319 val_auprc:  0.9410985693460163
Validation loss improved to 0.769969
epoch:  37
epoch:  38 val_f1:  0.8061683443992288 val_auroc:  0.8707837301587301 val_auprc:  0.9389216382029633
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.7956729455237178 val_auroc:  0.873015873015873 val_auprc:  0.9397667274291124
EarlyStopping counter: 2 out of 50
epoch:  39
epoch:  40 val_f1:  0.8030193236714975 val_auroc:  0.8735119047619048 val_auprc:  0.9400280364544712
EarlyStopping counter: 3 out of 50
epoch:  40
epoch:  41 val_f1:  0.8164398044139025 val_auroc:  0.8730158730158731 val_auprc:  0.9397790055889845
EarlyStopping counter: 4 out of 50
epoch:  41
epoch:  42 val_f1:  0.7963059879954627 val_auroc:  0.8737599206349206 val_auprc:  0.939746247098902
EarlyStopping counter: 5 out of 50
epoch:  42
epoch:  43 val_f1:  0.7858717303302986 val_auroc:  0.869047619047619 val_auprc:  0.9377031376859309
EarlyStopping counter: 6 out of 50
epoch:  43
epoch:  44 val_f1:  0.7793921916592724 val_auroc:  0.8655753968253969 val_auprc:  0.9360763489476626
EarlyStopping counter: 7 out of 50
epoch:  44
epoch:  45 val_f1:  0.8030193236714975 val_auroc:  0.8717757936507936 val_auprc:  0.938799435228142
EarlyStopping counter: 8 out of 50
epoch:  45
epoch:  46 val_f1:  0.8049865427618805 val_auroc:  0.8692956349206348 val_auprc:  0.9378272171028011
EarlyStopping counter: 9 out of 50
epoch:  46
epoch:  47 val_f1:  0.7733010668869473 val_auroc:  0.8621031746031745 val_auprc:  0.9339626377855417
EarlyStopping counter: 10 out of 50
epoch:  47
epoch:  48 val_f1:  0.7755148741418765 val_auroc:  0.863095238095238 val_auprc:  0.9351352054116452
EarlyStopping counter: 11 out of 50
epoch:  48
epoch:  49 val_f1:  0.7956729455237178 val_auroc:  0.869295634920635 val_auprc:  0.9381389771749271
EarlyStopping counter: 12 out of 50
epoch:  49
epoch:  50 val_f1:  0.8127933585226971 val_auroc:  0.8715277777777779 val_auprc:  0.9395027295441728
EarlyStopping counter: 13 out of 50
epoch:  50
epoch:  51 val_f1:  0.7875799991742021 val_auroc:  0.8695436507936508 val_auprc:  0.9383171491675122
EarlyStopping counter: 14 out of 50
epoch:  51
epoch:  52 val_f1:  0.795635738397158 val_auroc:  0.8745039682539683 val_auprc:  0.9405669863552721
EarlyStopping counter: 15 out of 50
epoch:  52
epoch:  53 val_f1:  0.8049865427618805 val_auroc:  0.8720238095238095 val_auprc:  0.9393794867847401
EarlyStopping counter: 16 out of 50
epoch:  53
epoch:  54 val_f1:  0.7940993788819876 val_auroc:  0.8727678571428571 val_auprc:  0.9396131670063153
EarlyStopping counter: 17 out of 50
epoch:  54
epoch:  55 val_f1:  0.8022296544035674 val_auroc:  0.8720238095238095 val_auprc:  0.9403260616744765
EarlyStopping counter: 18 out of 50
epoch:  55
epoch:  56 val_f1:  0.8081713820844254 val_auroc:  0.8750000000000001 val_auprc:  0.941643916539714
EarlyStopping counter: 19 out of 50
epoch:  56
epoch:  57 val_f1:  0.7889492753623188 val_auroc:  0.8759920634920635 val_auprc:  0.9421320130876387
EarlyStopping counter: 20 out of 50
epoch:  57
epoch:  58 val_f1:  0.7881997743237336 val_auroc:  0.876984126984127 val_auprc:  0.9427310757066546
EarlyStopping counter: 21 out of 50
epoch:  58
epoch:  59 val_f1:  0.8138718358422335 val_auroc:  0.8774801587301587 val_auprc:  0.9429018271151597
EarlyStopping counter: 22 out of 50
epoch:  59
epoch:  60 val_f1:  0.7858717303302986 val_auroc:  0.8735119047619048 val_auprc:  0.9405220457094626
EarlyStopping counter: 23 out of 50
epoch:  60
epoch:  61 val_f1:  0.8036760694501368 val_auroc:  0.8752480158730158 val_auprc:  0.9410930913400258
EarlyStopping counter: 24 out of 50
epoch:  61
epoch:  62 val_f1:  0.8081713820844254 val_auroc:  0.876984126984127 val_auprc:  0.9425574705819358
EarlyStopping counter: 25 out of 50
epoch:  62
epoch:  63 val_f1:  0.8115942028985508 val_auroc:  0.8777281746031745 val_auprc:  0.9427090743995687
EarlyStopping counter: 26 out of 50
epoch:  63
epoch:  64 val_f1:  0.8088065661047027 val_auroc:  0.876984126984127 val_auprc:  0.9422329348191902
EarlyStopping counter: 27 out of 50
epoch:  64
epoch:  65 val_f1:  0.8049865427618805 val_auroc:  0.8754960317460319 val_auprc:  0.9416189912474862
EarlyStopping counter: 28 out of 50
epoch:  65
epoch:  66 val_f1:  0.8036760694501368 val_auroc:  0.875 val_auprc:  0.9407139826097268
EarlyStopping counter: 29 out of 50
epoch:  66
epoch:  67 val_f1:  0.8072024593763724 val_auroc:  0.8737599206349207 val_auprc:  0.9406883325183122
EarlyStopping counter: 30 out of 50
epoch:  67
epoch:  68 val_f1:  0.8115942028985508 val_auroc:  0.8782242063492064 val_auprc:  0.942970127575499
EarlyStopping counter: 31 out of 50
epoch:  68
epoch:  69 val_f1:  0.8154066640778435 val_auroc:  0.8740079365079364 val_auprc:  0.940953827028689
EarlyStopping counter: 32 out of 50
epoch:  69
epoch:  70 val_f1:  0.7988956640912072 val_auroc:  0.8730158730158731 val_auprc:  0.9401321315773497
EarlyStopping counter: 33 out of 50
epoch:  70
epoch:  71 val_f1:  0.8215074100875418 val_auroc:  0.8799603174603176 val_auprc:  0.9440655673403774
EarlyStopping counter: 34 out of 50
epoch:  71
epoch:  72 val_f1:  0.8215074100875418 val_auroc:  0.8797123015873015 val_auprc:  0.9437660781505308
EarlyStopping counter: 35 out of 50
epoch:  72
epoch:  73 val_f1:  0.8154066640778435 val_auroc:  0.8784722222222221 val_auprc:  0.9429508983543119
EarlyStopping counter: 36 out of 50
epoch:  73
epoch:  74 val_f1:  0.8205262448141007 val_auroc:  0.8812003968253969 val_auprc:  0.9444650002598576
EarlyStopping counter: 37 out of 50
epoch:  74
epoch:  75 val_f1:  0.8049865427618805 val_auroc:  0.8802083333333333 val_auprc:  0.9438338493450302
EarlyStopping counter: 38 out of 50
epoch:  75
epoch:  76 val_f1:  0.7861608411480533 val_auroc:  0.8725198412698413 val_auprc:  0.9395575541112546
EarlyStopping counter: 39 out of 50
epoch:  76
epoch:  77 val_f1:  0.7988956640912072 val_auroc:  0.8749999999999999 val_auprc:  0.9406674725104014
EarlyStopping counter: 40 out of 50
epoch:  77
epoch:  78 val_f1:  0.8248625247346153 val_auroc:  0.8804563492063493 val_auprc:  0.9438511100832352
EarlyStopping counter: 41 out of 50
epoch:  78
epoch:  79 val_f1:  0.8281893869312926 val_auroc:  0.8807043650793652 val_auprc:  0.9440019392694214
EarlyStopping counter: 42 out of 50
epoch:  79
epoch:  80 val_f1:  0.8248625247346153 val_auroc:  0.878968253968254 val_auprc:  0.9432595835760311
EarlyStopping counter: 43 out of 50
epoch:  80
epoch:  81 val_f1:  0.7819511139952413 val_auroc:  0.8727678571428571 val_auprc:  0.9402652767517623
EarlyStopping counter: 44 out of 50
epoch:  81
epoch:  82 val_f1:  0.7819511139952413 val_auroc:  0.8725198412698414 val_auprc:  0.9403596641154199
EarlyStopping counter: 45 out of 50
epoch:  82
epoch:  83 val_f1:  0.8271938694055665 val_auroc:  0.8792162698412699 val_auprc:  0.943473271411346
EarlyStopping counter: 46 out of 50
epoch:  83
epoch:  84 val_f1:  0.8168793096329329 val_auroc:  0.8777281746031746 val_auprc:  0.942478736697137
EarlyStopping counter: 47 out of 50
epoch:  84
epoch:  85 val_f1:  0.7733010668869473 val_auroc:  0.8742559523809524 val_auprc:  0.9414493381212987
EarlyStopping counter: 48 out of 50
epoch:  85
epoch:  86 val_f1:  0.8088065661047027 val_auroc:  0.8782242063492063 val_auprc:  0.9432618778228895
EarlyStopping counter: 49 out of 50
epoch:  86
epoch:  87 val_f1:  0.8248625247346153 val_auroc:  0.8784722222222223 val_auprc:  0.9429382698349205
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  61.07885932922363
{'time_elapsed': [61.07885932922363], 'epoch': [86], 'fold': [4], 'f1_train': [0.9946175537860844], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8248625247346153], 'auroc_test': [0.8784722222222223], 'auprc_test': [0.9429382698349205]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 256]            1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 256]            512
│    └─Tanh: 2-3                         [64, 256, 256]            --
│    └─MaxPool1d: 2-4                    [64, 256, 51]             --
│    └─Dropout: 2-5                      [64, 256, 51]             --
│    └─Flatten: 2-6                      [64, 13056]               --
│    └─Linear: 2-7                       [64, 1]                   13,057
==========================================================================================
Total params: 15,105
Trainable params: 15,105
Non-trainable params: 0
Total mult-adds (M): 26.03
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 67.11
Params size (MB): 0.06
Estimated Total Size (MB): 67.50
==========================================================================================
