config:  {'project': 'MHCCBM', 'name': 'CNN_52', 'config': {'hidden_channels': [256], 'epochs': 500, 'kernel_size': 3, 'pool_kernel_size': 3, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.570151538343793 val_auroc:  0.6327933235149731 val_auprc:  0.8217199867577661
epoch:  1
epoch:  2 val_f1:  0.6613382126668607 val_auroc:  0.6631075110456554 val_auprc:  0.8162792958906058
Validation loss improved to 4.048304
epoch:  2
epoch:  3 val_f1:  0.6951967837494709 val_auroc:  0.7193176239567992 val_auprc:  0.8494729632656379
Validation loss improved to 1.822152
epoch:  3
epoch:  4 val_f1:  0.7466980132583976 val_auroc:  0.7633775159548356 val_auprc:  0.8981095536410721
Validation loss improved to 0.954828
epoch:  4
epoch:  5 val_f1:  0.6413571845226521 val_auroc:  0.8097692685321551 val_auprc:  0.924386768833095
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.7349308245711123 val_auroc:  0.7866961217476681 val_auprc:  0.9008729117711276
Validation loss improved to 0.942712
epoch:  6
epoch:  7 val_f1:  0.6954243384953055 val_auroc:  0.791850760922926 val_auprc:  0.9065952870201115
Validation loss improved to 0.714466
epoch:  7
epoch:  8 val_f1:  0.7150229029574715 val_auroc:  0.804860088365243 val_auprc:  0.91765514491967
Validation loss improved to 0.590462
epoch:  8
epoch:  9 val_f1:  0.710128282915836 val_auroc:  0.810505645557192 val_auprc:  0.9191787650925348
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7496568898727172 val_auroc:  0.8028964162984782 val_auprc:  0.9099902498385565
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.7239714721729109 val_auroc:  0.806087383406971 val_auprc:  0.9105167596901079
EarlyStopping counter: 3 out of 50
epoch:  11
epoch:  12 val_f1:  0.6891084624964738 val_auroc:  0.81173294059892 val_auprc:  0.9162671053540898
EarlyStopping counter: 4 out of 50
epoch:  12
epoch:  13 val_f1:  0.72389147505525 val_auroc:  0.8127147766323024 val_auprc:  0.9142629019725808
EarlyStopping counter: 5 out of 50
epoch:  13
epoch:  14 val_f1:  0.681579990245092 val_auroc:  0.8188512518409427 val_auprc:  0.918976282460729
EarlyStopping counter: 6 out of 50
epoch:  14
epoch:  15 val_f1:  0.6743799189283424 val_auroc:  0.8195876288659795 val_auprc:  0.918730929872095
EarlyStopping counter: 7 out of 50
epoch:  15
epoch:  16 val_f1:  0.7841726618705036 val_auroc:  0.8178694158075602 val_auprc:  0.9169637695618671
EarlyStopping counter: 8 out of 50
epoch:  16
epoch:  17 val_f1:  0.720403844991234 val_auroc:  0.8230240549828179 val_auprc:  0.9211272470879969
EarlyStopping counter: 9 out of 50
epoch:  17
epoch:  18 val_f1:  0.7681512331200245 val_auroc:  0.821060382916053 val_auprc:  0.920552111965506
EarlyStopping counter: 10 out of 50
epoch:  18
epoch:  19 val_f1:  0.7519437633413868 val_auroc:  0.817378497790869 val_auprc:  0.9178956630824558
EarlyStopping counter: 11 out of 50
epoch:  19
epoch:  20 val_f1:  0.7809570525397864 val_auroc:  0.8181148748159057 val_auprc:  0.9180700378680924
EarlyStopping counter: 12 out of 50
epoch:  20
epoch:  21 val_f1:  0.7651358509506568 val_auroc:  0.8244968090328915 val_auprc:  0.9210891109705208
EarlyStopping counter: 13 out of 50
epoch:  21
epoch:  22 val_f1:  0.7933255489848959 val_auroc:  0.825478645066274 val_auprc:  0.9213014080090804
EarlyStopping counter: 14 out of 50
epoch:  22
epoch:  23 val_f1:  0.7644702419882276 val_auroc:  0.8286696121747668 val_auprc:  0.9240722866439239
EarlyStopping counter: 15 out of 50
epoch:  23
epoch:  24 val_f1:  0.7683026725960121 val_auroc:  0.8205694648993619 val_auprc:  0.9170309547909355
EarlyStopping counter: 16 out of 50
epoch:  24
epoch:  25 val_f1:  0.7622262794246104 val_auroc:  0.8161512027491409 val_auprc:  0.913278844834215
EarlyStopping counter: 17 out of 50
epoch:  25
epoch:  26 val_f1:  0.7790721385700611 val_auroc:  0.8316151202749141 val_auprc:  0.9289999804084201
Validation loss improved to 0.568898
epoch:  26
epoch:  27 val_f1:  0.751502327549725 val_auroc:  0.8188512518409425 val_auprc:  0.9181276139525107
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.766354189375772 val_auroc:  0.8114874815905744 val_auprc:  0.9131402829949696
EarlyStopping counter: 2 out of 50
epoch:  28
epoch:  29 val_f1:  0.7933255489848959 val_auroc:  0.8144329896907216 val_auprc:  0.9158233212490536
EarlyStopping counter: 3 out of 50
epoch:  29
epoch:  30 val_f1:  0.6663975251072785 val_auroc:  0.8274423171330387 val_auprc:  0.9244700642679775
EarlyStopping counter: 4 out of 50
epoch:  30
epoch:  31 val_f1:  0.7391671278361928 val_auroc:  0.8276877761413843 val_auprc:  0.9231110505894184
EarlyStopping counter: 5 out of 50
epoch:  31
epoch:  32 val_f1:  0.7745465218349855 val_auroc:  0.8173784977908689 val_auprc:  0.9140874732560323
EarlyStopping counter: 6 out of 50
epoch:  32
epoch:  33 val_f1:  0.7661184054361647 val_auroc:  0.8379970544918998 val_auprc:  0.9324657151686522
EarlyStopping counter: 7 out of 50
epoch:  33
epoch:  34 val_f1:  0.7839141001375581 val_auroc:  0.8237604320078548 val_auprc:  0.9204651571283042
EarlyStopping counter: 8 out of 50
epoch:  34
epoch:  35 val_f1:  0.7777125328082551 val_auroc:  0.819833087874325 val_auprc:  0.9172748522241596
EarlyStopping counter: 9 out of 50
epoch:  35
epoch:  36 val_f1:  0.7725930260576229 val_auroc:  0.82793323514973 val_auprc:  0.9219363791613614
EarlyStopping counter: 10 out of 50
epoch:  36
epoch:  37 val_f1:  0.7813819697019021 val_auroc:  0.8262150220913107 val_auprc:  0.9212438696519669
EarlyStopping counter: 11 out of 50
epoch:  37
epoch:  38 val_f1:  0.7536081085870222 val_auroc:  0.8181148748159058 val_auprc:  0.9153751923577851
EarlyStopping counter: 12 out of 50
epoch:  38
epoch:  39 val_f1:  0.7911956149366222 val_auroc:  0.8338242513500246 val_auprc:  0.9279253779404564
EarlyStopping counter: 13 out of 50
epoch:  39
epoch:  40 val_f1:  0.7559325673789327 val_auroc:  0.821060382916053 val_auprc:  0.9155308400970682
EarlyStopping counter: 14 out of 50
epoch:  40
epoch:  41 val_f1:  0.7786895152313162 val_auroc:  0.8276877761413843 val_auprc:  0.9205477536114418
EarlyStopping counter: 15 out of 50
epoch:  41
epoch:  42 val_f1:  0.7411406017655346 val_auroc:  0.833578792341679 val_auprc:  0.9249156880513982
EarlyStopping counter: 16 out of 50
epoch:  42
epoch:  43 val_f1:  0.798430833799187 val_auroc:  0.8276877761413844 val_auprc:  0.9203590875783744
EarlyStopping counter: 17 out of 50
epoch:  43
epoch:  44 val_f1:  0.7802930475309426 val_auroc:  0.8308787432498772 val_auprc:  0.9230063768265914
EarlyStopping counter: 18 out of 50
epoch:  44
epoch:  45 val_f1:  0.7536081085870222 val_auroc:  0.8230240549828178 val_auprc:  0.9158734903114696
EarlyStopping counter: 19 out of 50
epoch:  45
epoch:  46 val_f1:  0.7559325673789327 val_auroc:  0.8225331369661267 val_auprc:  0.9178250529804579
EarlyStopping counter: 20 out of 50
epoch:  46
epoch:  47 val_f1:  0.7583800901862243 val_auroc:  0.8338242513500245 val_auprc:  0.9271095829344955
EarlyStopping counter: 21 out of 50
epoch:  47
epoch:  48 val_f1:  0.7823449348629204 val_auroc:  0.8294059891998037 val_auprc:  0.9229181028283859
EarlyStopping counter: 22 out of 50
epoch:  48
epoch:  49 val_f1:  0.7633714058926586 val_auroc:  0.8274423171330387 val_auprc:  0.9210734028039259
EarlyStopping counter: 23 out of 50
epoch:  49
epoch:  50 val_f1:  0.7681512331200245 val_auroc:  0.8269513991163476 val_auprc:  0.920793535988259
EarlyStopping counter: 24 out of 50
epoch:  50
epoch:  51 val_f1:  0.7536081085870222 val_auroc:  0.82793323514973 val_auprc:  0.9214768182893809
EarlyStopping counter: 25 out of 50
epoch:  51
epoch:  52 val_f1:  0.7536081085870222 val_auroc:  0.8274423171330387 val_auprc:  0.9191852978187917
EarlyStopping counter: 26 out of 50
epoch:  52
epoch:  53 val_f1:  0.7496568898727172 val_auroc:  0.8291605301914581 val_auprc:  0.9201720517950043
EarlyStopping counter: 27 out of 50
epoch:  53
epoch:  54 val_f1:  0.7648187281552264 val_auroc:  0.8311242022582229 val_auprc:  0.924827317158669
EarlyStopping counter: 28 out of 50
epoch:  54
epoch:  55 val_f1:  0.7745465218349855 val_auroc:  0.8291605301914581 val_auprc:  0.9220715108843572
EarlyStopping counter: 29 out of 50
epoch:  55
epoch:  56 val_f1:  0.7580594896895918 val_auroc:  0.8271968581246932 val_auprc:  0.9184255301130081
EarlyStopping counter: 30 out of 50
epoch:  56
epoch:  57 val_f1:  0.7697841726618705 val_auroc:  0.8308787432498773 val_auprc:  0.9245942719404011
EarlyStopping counter: 31 out of 50
epoch:  57
epoch:  58 val_f1:  0.7633714058926586 val_auroc:  0.8284241531664213 val_auprc:  0.9222908983563918
EarlyStopping counter: 32 out of 50
epoch:  58
epoch:  59 val_f1:  0.7802930475309426 val_auroc:  0.8281786941580755 val_auprc:  0.9221137474047787
EarlyStopping counter: 33 out of 50
epoch:  59
epoch:  60 val_f1:  0.7868059619290214 val_auroc:  0.8291605301914581 val_auprc:  0.9229089984410832
EarlyStopping counter: 34 out of 50
epoch:  60
epoch:  61 val_f1:  0.7737843767539161 val_auroc:  0.8306332842415317 val_auprc:  0.9237555771078492
EarlyStopping counter: 35 out of 50
epoch:  61
epoch:  62 val_f1:  0.7802930475309426 val_auroc:  0.8330878743249878 val_auprc:  0.9250428465477689
EarlyStopping counter: 36 out of 50
epoch:  62
epoch:  63 val_f1:  0.7737843767539161 val_auroc:  0.8303878252331861 val_auprc:  0.9231877479258856
EarlyStopping counter: 37 out of 50
epoch:  63
epoch:  64 val_f1:  0.7712620601193464 val_auroc:  0.8301423662248405 val_auprc:  0.9231153926075293
EarlyStopping counter: 38 out of 50
epoch:  64
epoch:  65 val_f1:  0.7725930260576229 val_auroc:  0.8325969563082964 val_auprc:  0.9251832896999204
EarlyStopping counter: 39 out of 50
epoch:  65
epoch:  66 val_f1:  0.7697841726618705 val_auroc:  0.8284241531664212 val_auprc:  0.922300026720613
EarlyStopping counter: 40 out of 50
epoch:  66
epoch:  67 val_f1:  0.7762067639678805 val_auroc:  0.8249877270495828 val_auprc:  0.9199734681645868
EarlyStopping counter: 41 out of 50
epoch:  67
epoch:  68 val_f1:  0.7762067639678805 val_auroc:  0.8298969072164949 val_auprc:  0.9237402287408469
EarlyStopping counter: 42 out of 50
epoch:  68
epoch:  69 val_f1:  0.7672775806504117 val_auroc:  0.8330878743249878 val_auprc:  0.9263408743255069
EarlyStopping counter: 43 out of 50
epoch:  69
epoch:  70 val_f1:  0.7648187281552264 val_auroc:  0.8276877761413843 val_auprc:  0.9213923288455887
EarlyStopping counter: 44 out of 50
epoch:  70
epoch:  71 val_f1:  0.7777125328082551 val_auroc:  0.8291605301914581 val_auprc:  0.9229630921530945
EarlyStopping counter: 45 out of 50
epoch:  71
epoch:  72 val_f1:  0.7762067639678805 val_auroc:  0.8306332842415316 val_auprc:  0.9237505685298962
EarlyStopping counter: 46 out of 50
epoch:  72
epoch:  73 val_f1:  0.7672775806504117 val_auroc:  0.8303878252331861 val_auprc:  0.9241607654628053
EarlyStopping counter: 47 out of 50
epoch:  73
epoch:  74 val_f1:  0.7661184054361647 val_auroc:  0.829160530191458 val_auprc:  0.9233421470030445
EarlyStopping counter: 48 out of 50
epoch:  74
epoch:  75 val_f1:  0.7712620601193464 val_auroc:  0.8289150711831125 val_auprc:  0.9229496061213276
EarlyStopping counter: 49 out of 50
epoch:  75
epoch:  76 val_f1:  0.7697841726618705 val_auroc:  0.8269513991163476 val_auprc:  0.9220781011594225
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  538.8604502677917
{'time_elapsed': [538.8604502677917], 'epoch': [75], 'fold': [0], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7697841726618705], 'auroc_test': [0.8269513991163476], 'auprc_test': [0.9220781011594225]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1280]           1,024
│    └─BatchNorm1d: 2-2                  [64, 256, 1280]           512
│    └─Tanh: 2-3                         [64, 256, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1278]           --
│    └─Dropout: 2-5                      [64, 256, 1278]           --
│    └─Flatten: 2-6                      [64, 327168]              --
│    └─Linear: 2-7                       [64, 1]                   327,169
==========================================================================================
Total params: 328,705
Trainable params: 328,705
Non-trainable params: 0
Total mult-adds (M): 104.86
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.54
Params size (MB): 1.31
Estimated Total Size (MB): 337.19
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6916657713146764 val_auroc:  0.6699803632793323 val_auprc:  0.8104919312523629
epoch:  1
epoch:  2 val_f1:  0.6650448552513829 val_auroc:  0.7351497299950909 val_auprc:  0.8903660361197965
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.652897906393986 val_auroc:  0.7324496809032892 val_auprc:  0.8811687747999085
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.7309103647707891 val_auroc:  0.7962690230731468 val_auprc:  0.9138634092498547
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.72389147505525 val_auroc:  0.7987236131566029 val_auprc:  0.9136856985828501
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.7420910227448273 val_auroc:  0.8166421207658321 val_auprc:  0.9224921749435068
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.6618558114706329 val_auroc:  0.8118556701030928 val_auprc:  0.9198052382259416
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.7176437068167247 val_auroc:  0.7957781050564556 val_auprc:  0.9147348908253842
Validation loss improved to 0.564402
epoch:  8
epoch:  9 val_f1:  0.6868550792725379 val_auroc:  0.8036327933235149 val_auprc:  0.9169259497751583
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7577565132360132 val_auroc:  0.814923907707413 val_auprc:  0.9197796899309062
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.6814979364470806 val_auroc:  0.8068237604320079 val_auprc:  0.9124968978992284
Validation loss improved to 0.380100
epoch:  11
epoch:  12 val_f1:  0.7510257046352308 val_auroc:  0.832842415316642 val_auprc:  0.9270281012883002
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.797175270999766 val_auroc:  0.8269513991163476 val_auprc:  0.9232017922239255
Validation loss improved to 0.339125
epoch:  13
epoch:  14 val_f1:  0.742136387976997 val_auroc:  0.8357879234167895 val_auprc:  0.9278615661726854
Validation loss improved to 0.221375
epoch:  14
epoch:  15 val_f1:  0.7727225509205256 val_auroc:  0.8333333333333334 val_auprc:  0.9262830406675067
Validation loss improved to 0.211744
epoch:  15
epoch:  16 val_f1:  0.6814979364470806 val_auroc:  0.8271968581246931 val_auprc:  0.9202680633000937
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.6416835003980583 val_auroc:  0.8357879234167894 val_auprc:  0.9288915331513403
EarlyStopping counter: 2 out of 50
epoch:  17
epoch:  18 val_f1:  0.7607401077265918 val_auroc:  0.84413352970054 val_auprc:  0.9308272592921325
Validation loss improved to 0.192353
epoch:  18
epoch:  19 val_f1:  0.7386752666832053 val_auroc:  0.8291605301914581 val_auprc:  0.9252154865968463
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7711689349644636 val_auroc:  0.8352970054000981 val_auprc:  0.9296264458476906
EarlyStopping counter: 2 out of 50
epoch:  20
epoch:  21 val_f1:  0.7737843767539161 val_auroc:  0.824251350024546 val_auprc:  0.9207783192150849
EarlyStopping counter: 3 out of 50
epoch:  21
epoch:  22 val_f1:  0.7985611510791367 val_auroc:  0.825478645066274 val_auprc:  0.9181427188244409
EarlyStopping counter: 4 out of 50
epoch:  22
epoch:  23 val_f1:  0.7890919075230509 val_auroc:  0.8257241040746196 val_auprc:  0.9163380996865568
Validation loss improved to 0.176057
epoch:  23
epoch:  24 val_f1:  0.806394786639448 val_auroc:  0.8340697103583701 val_auprc:  0.9201378466270699
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7536081085870222 val_auroc:  0.8291605301914581 val_auprc:  0.917529770795872
Validation loss improved to 0.160103
epoch:  25
epoch:  26 val_f1:  0.7286063672426545 val_auroc:  0.8259695630829651 val_auprc:  0.9153839849735161
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7963871971298289 val_auroc:  0.822287677957781 val_auprc:  0.9136602931052008
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7971323289800215 val_auroc:  0.8274423171330387 val_auprc:  0.9177517931840672
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.7791090204759269 val_auroc:  0.8289150711831125 val_auprc:  0.9161664623264589
Validation loss improved to 0.156961
epoch:  29
epoch:  30 val_f1:  0.7873856121514594 val_auroc:  0.8269513991163476 val_auprc:  0.9155787500536222
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7938350857775318 val_auroc:  0.8313696612665685 val_auprc:  0.9160392411881161
Validation loss improved to 0.136989
epoch:  31
epoch:  32 val_f1:  0.7770871369605723 val_auroc:  0.8311242022582229 val_auprc:  0.9160987025406793
EarlyStopping counter: 1 out of 50
epoch:  32
epoch:  33 val_f1:  0.7448635686045757 val_auroc:  0.8313696612665685 val_auprc:  0.9161843818626383
EarlyStopping counter: 2 out of 50
epoch:  33
epoch:  34 val_f1:  0.7536081085870222 val_auroc:  0.8281786941580755 val_auprc:  0.9158278800116175
Validation loss improved to 0.134920
epoch:  34
epoch:  35 val_f1:  0.7761762298087471 val_auroc:  0.8286696121747669 val_auprc:  0.9115435898695718
Validation loss improved to 0.131191
epoch:  35
epoch:  36 val_f1:  0.7873856121514594 val_auroc:  0.8259695630829652 val_auprc:  0.91190927997716
EarlyStopping counter: 1 out of 50
epoch:  36
epoch:  37 val_f1:  0.7707245329923307 val_auroc:  0.833578792341679 val_auprc:  0.9168784691885806
EarlyStopping counter: 2 out of 50
epoch:  37
epoch:  38 val_f1:  0.7453039856444363 val_auroc:  0.8252331860579284 val_auprc:  0.9119977779078435
Validation loss improved to 0.127679
epoch:  38
epoch:  39 val_f1:  0.7890919075230509 val_auroc:  0.8372606774668631 val_auprc:  0.9206988443766535
EarlyStopping counter: 1 out of 50
epoch:  39
epoch:  40 val_f1:  0.7712620601193464 val_auroc:  0.8220422189494354 val_auprc:  0.9102010224032674
EarlyStopping counter: 2 out of 50
epoch:  40
epoch:  41 val_f1:  0.7724732835091151 val_auroc:  0.8337015218458518 val_auprc:  0.9145921010173012
Validation loss improved to 0.126291
epoch:  41
epoch:  42 val_f1:  0.7971323289800215 val_auroc:  0.8242513500245459 val_auprc:  0.9121863978916173
EarlyStopping counter: 1 out of 50
epoch:  42
epoch:  43 val_f1:  0.7791090204759269 val_auroc:  0.8281786941580757 val_auprc:  0.9098971414843227
EarlyStopping counter: 2 out of 50
epoch:  43
epoch:  44 val_f1:  0.7536081085870222 val_auroc:  0.82793323514973 val_auprc:  0.9098245504827686
Validation loss improved to 0.116572
epoch:  44
epoch:  45 val_f1:  0.7834737923946559 val_auroc:  0.8313696612665684 val_auprc:  0.9108179488160603
Validation loss improved to 0.112004
epoch:  45
epoch:  46 val_f1:  0.7707245329923307 val_auroc:  0.8298969072164949 val_auprc:  0.9079016055335369
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.7791090204759269 val_auroc:  0.8289150711831125 val_auprc:  0.9075298026023055
EarlyStopping counter: 2 out of 50
epoch:  47
epoch:  48 val_f1:  0.7707245329923307 val_auroc:  0.8294059891998037 val_auprc:  0.9049559161337482
EarlyStopping counter: 3 out of 50
epoch:  48
epoch:  49 val_f1:  0.7514700844366524 val_auroc:  0.8286696121747668 val_auprc:  0.9060112104396851
Validation loss improved to 0.097599
epoch:  49
epoch:  50 val_f1:  0.7791090204759269 val_auroc:  0.8301423662248405 val_auprc:  0.9058805109135806
EarlyStopping counter: 1 out of 50
epoch:  50
epoch:  51 val_f1:  0.7748796193569787 val_auroc:  0.8294059891998037 val_auprc:  0.9036742810737335
EarlyStopping counter: 2 out of 50
epoch:  51
epoch:  52 val_f1:  0.7707245329923307 val_auroc:  0.8289150711831125 val_auprc:  0.9035045774873204
EarlyStopping counter: 3 out of 50
epoch:  52
epoch:  53 val_f1:  0.7898876447331801 val_auroc:  0.8334560628375062 val_auprc:  0.907727852140533
EarlyStopping counter: 4 out of 50
epoch:  53
epoch:  54 val_f1:  0.7724732835091151 val_auroc:  0.8286696121747669 val_auprc:  0.9034114004393142
EarlyStopping counter: 5 out of 50
epoch:  54
epoch:  55 val_f1:  0.748164418722312 val_auroc:  0.8306332842415317 val_auprc:  0.9031404210872148
Validation loss improved to 0.093957
epoch:  55
epoch:  56 val_f1:  0.7724732835091151 val_auroc:  0.8328424153166422 val_auprc:  0.9087287080158113
Validation loss improved to 0.093015
epoch:  56
epoch:  57 val_f1:  0.7598715939807772 val_auroc:  0.8284241531664213 val_auprc:  0.9074061780259044
EarlyStopping counter: 1 out of 50
epoch:  57
epoch:  58 val_f1:  0.7761762298087471 val_auroc:  0.8281786941580755 val_auprc:  0.90232744132162
Validation loss improved to 0.088365
epoch:  58
epoch:  59 val_f1:  0.7791090204759269 val_auroc:  0.8284241531664213 val_auprc:  0.9031099868671223
EarlyStopping counter: 1 out of 50
epoch:  59
epoch:  60 val_f1:  0.7791090204759269 val_auroc:  0.8291605301914581 val_auprc:  0.9042762870620505
EarlyStopping counter: 2 out of 50
epoch:  60
epoch:  61 val_f1:  0.7791090204759269 val_auroc:  0.8294059891998037 val_auprc:  0.9035171298148346
EarlyStopping counter: 3 out of 50
epoch:  61
epoch:  62 val_f1:  0.7707245329923307 val_auroc:  0.8252331860579284 val_auprc:  0.9013254633765373
EarlyStopping counter: 4 out of 50
epoch:  62
epoch:  63 val_f1:  0.7598715939807772 val_auroc:  0.8251104565537555 val_auprc:  0.8979758728846008
EarlyStopping counter: 5 out of 50
epoch:  63
epoch:  64 val_f1:  0.7770871369605723 val_auroc:  0.8244968090328916 val_auprc:  0.9008481386529728
EarlyStopping counter: 6 out of 50
epoch:  64
epoch:  65 val_f1:  0.7770871369605723 val_auroc:  0.8242513500245459 val_auprc:  0.8989474082197598
EarlyStopping counter: 7 out of 50
epoch:  65
epoch:  66 val_f1:  0.7685409504908388 val_auroc:  0.8281786941580757 val_auprc:  0.9034872870770086
EarlyStopping counter: 8 out of 50
epoch:  66
epoch:  67 val_f1:  0.7598715939807772 val_auroc:  0.8262150220913107 val_auprc:  0.9026125244931911
Validation loss improved to 0.086694
epoch:  67
epoch:  68 val_f1:  0.7761762298087471 val_auroc:  0.8278105056455571 val_auprc:  0.901138271851407
Validation loss improved to 0.072885
epoch:  68
epoch:  69 val_f1:  0.7661589271850144 val_auroc:  0.8246195385370644 val_auprc:  0.8981329537904278
EarlyStopping counter: 1 out of 50
epoch:  69
epoch:  70 val_f1:  0.7770871369605723 val_auroc:  0.8251104565537556 val_auprc:  0.9007229457517593
EarlyStopping counter: 2 out of 50
epoch:  70
epoch:  71 val_f1:  0.7770871369605723 val_auroc:  0.8247422680412372 val_auprc:  0.8998560836252608
EarlyStopping counter: 3 out of 50
epoch:  71
epoch:  72 val_f1:  0.7855164986057286 val_auroc:  0.8260922925871379 val_auprc:  0.9007916857087068
EarlyStopping counter: 4 out of 50
epoch:  72
epoch:  73 val_f1:  0.7727225509205256 val_auroc:  0.8259695630829651 val_auprc:  0.9024032802539058
EarlyStopping counter: 5 out of 50
epoch:  73
epoch:  74 val_f1:  0.7791090204759269 val_auroc:  0.8251104565537556 val_auprc:  0.9011848693873691
EarlyStopping counter: 6 out of 50
epoch:  74
epoch:  75 val_f1:  0.7770871369605723 val_auroc:  0.8258468335787924 val_auprc:  0.8991753280008697
EarlyStopping counter: 7 out of 50
epoch:  75
epoch:  76 val_f1:  0.7598715939807772 val_auroc:  0.8257241040746195 val_auprc:  0.8978979046451299
EarlyStopping counter: 8 out of 50
epoch:  76
epoch:  77 val_f1:  0.7685409504908388 val_auroc:  0.8262150220913108 val_auprc:  0.898986269929849
EarlyStopping counter: 9 out of 50
epoch:  77
epoch:  78 val_f1:  0.7770871369605723 val_auroc:  0.8253559155621012 val_auprc:  0.8988490037026655
EarlyStopping counter: 10 out of 50
epoch:  78
epoch:  79 val_f1:  0.7770871369605723 val_auroc:  0.8258468335787924 val_auprc:  0.9013283211568213
EarlyStopping counter: 11 out of 50
epoch:  79
epoch:  80 val_f1:  0.7598715939807772 val_auroc:  0.8247422680412371 val_auprc:  0.8983459641679994
EarlyStopping counter: 12 out of 50
epoch:  80
epoch:  81 val_f1:  0.7685409504908388 val_auroc:  0.8238831615120275 val_auprc:  0.8980510176832996
EarlyStopping counter: 13 out of 50
epoch:  81
epoch:  82 val_f1:  0.7770871369605723 val_auroc:  0.8264604810996563 val_auprc:  0.9008822728849437
EarlyStopping counter: 14 out of 50
epoch:  82
epoch:  83 val_f1:  0.7770871369605723 val_auroc:  0.8258468335787924 val_auprc:  0.901775525171467
EarlyStopping counter: 15 out of 50
epoch:  83
epoch:  84 val_f1:  0.7727225509205256 val_auroc:  0.8253559155621011 val_auprc:  0.9010760158041967
EarlyStopping counter: 16 out of 50
epoch:  84
epoch:  85 val_f1:  0.7770871369605723 val_auroc:  0.8258468335787924 val_auprc:  0.9013615344974926
EarlyStopping counter: 17 out of 50
epoch:  85
epoch:  86 val_f1:  0.7685409504908388 val_auroc:  0.8254786450662739 val_auprc:  0.900021628617153
EarlyStopping counter: 18 out of 50
epoch:  86
epoch:  87 val_f1:  0.7855164986057286 val_auroc:  0.8258468335787924 val_auprc:  0.8986679488359258
EarlyStopping counter: 19 out of 50
epoch:  87
epoch:  88 val_f1:  0.7685409504908388 val_auroc:  0.825478645066274 val_auprc:  0.9000353883159761
EarlyStopping counter: 20 out of 50
epoch:  88
epoch:  89 val_f1:  0.7685409504908388 val_auroc:  0.8244968090328916 val_auprc:  0.8993406085916518
EarlyStopping counter: 21 out of 50
epoch:  89
epoch:  90 val_f1:  0.7770871369605723 val_auroc:  0.8262150220913107 val_auprc:  0.9004141713618825
EarlyStopping counter: 22 out of 50
epoch:  90
epoch:  91 val_f1:  0.7855164986057286 val_auroc:  0.8259695630829652 val_auprc:  0.9003478423430423
EarlyStopping counter: 23 out of 50
epoch:  91
epoch:  92 val_f1:  0.7685409504908388 val_auroc:  0.8259695630829651 val_auprc:  0.8958580584916165
EarlyStopping counter: 24 out of 50
epoch:  92
epoch:  93 val_f1:  0.7598715939807772 val_auroc:  0.8252331860579284 val_auprc:  0.8960017665020141
EarlyStopping counter: 25 out of 50
epoch:  93
epoch:  94 val_f1:  0.7770871369605723 val_auroc:  0.8257241040746195 val_auprc:  0.895945884821807
EarlyStopping counter: 26 out of 50
epoch:  94
epoch:  95 val_f1:  0.7770871369605723 val_auroc:  0.8254786450662739 val_auprc:  0.8959859182095027
EarlyStopping counter: 27 out of 50
epoch:  95
epoch:  96 val_f1:  0.7855164986057286 val_auroc:  0.8264604810996563 val_auprc:  0.9000941947930027
EarlyStopping counter: 28 out of 50
epoch:  96
epoch:  97 val_f1:  0.7685409504908388 val_auroc:  0.8226558664702995 val_auprc:  0.8964564554204912
EarlyStopping counter: 29 out of 50
epoch:  97
epoch:  98 val_f1:  0.7770871369605723 val_auroc:  0.8242513500245459 val_auprc:  0.8950491642903836
EarlyStopping counter: 30 out of 50
epoch:  98
epoch:  99 val_f1:  0.7855164986057286 val_auroc:  0.8252331860579284 val_auprc:  0.8959305492443719
EarlyStopping counter: 31 out of 50
epoch:  99
epoch:  100 val_f1:  0.7698533480907581 val_auroc:  0.8252331860579284 val_auprc:  0.8970007398664042
Validation loss improved to 0.067907
epoch:  100
epoch:  101 val_f1:  0.7770871369605723 val_auroc:  0.8251104565537555 val_auprc:  0.8972888376942065
EarlyStopping counter: 1 out of 50
epoch:  101
epoch:  102 val_f1:  0.7770871369605723 val_auroc:  0.8269513991163475 val_auprc:  0.89647650270997
EarlyStopping counter: 2 out of 50
epoch:  102
epoch:  103 val_f1:  0.7685409504908388 val_auroc:  0.8257241040746196 val_auprc:  0.897275524521119
EarlyStopping counter: 3 out of 50
epoch:  103
epoch:  104 val_f1:  0.7770871369605723 val_auroc:  0.8248649975454099 val_auprc:  0.8975139610412202
EarlyStopping counter: 4 out of 50
epoch:  104
epoch:  105 val_f1:  0.7770871369605723 val_auroc:  0.8240058910162003 val_auprc:  0.895402832710227
EarlyStopping counter: 5 out of 50
epoch:  105
epoch:  106 val_f1:  0.7685409504908388 val_auroc:  0.8257241040746196 val_auprc:  0.8986906425189609
EarlyStopping counter: 6 out of 50
epoch:  106
epoch:  107 val_f1:  0.7770871369605723 val_auroc:  0.8238831615120276 val_auprc:  0.8968348484207376
EarlyStopping counter: 7 out of 50
epoch:  107
epoch:  108 val_f1:  0.7770871369605723 val_auroc:  0.8258468335787923 val_auprc:  0.8973843267983621
EarlyStopping counter: 8 out of 50
epoch:  108
epoch:  109 val_f1:  0.7685409504908388 val_auroc:  0.8256013745704467 val_auprc:  0.9000190380046993
EarlyStopping counter: 9 out of 50
epoch:  109
epoch:  110 val_f1:  0.7855164986057286 val_auroc:  0.8270741286205204 val_auprc:  0.8984887692652979
EarlyStopping counter: 10 out of 50
epoch:  110
epoch:  111 val_f1:  0.7770871369605723 val_auroc:  0.825478645066274 val_auprc:  0.8988842100765292
EarlyStopping counter: 11 out of 50
epoch:  111
epoch:  112 val_f1:  0.7685409504908388 val_auroc:  0.8247422680412371 val_auprc:  0.8998244345053287
EarlyStopping counter: 12 out of 50
epoch:  112
epoch:  113 val_f1:  0.7855164986057286 val_auroc:  0.8257241040746195 val_auprc:  0.8976021016100444
EarlyStopping counter: 13 out of 50
epoch:  113
epoch:  114 val_f1:  0.7855164986057286 val_auroc:  0.8256013745704467 val_auprc:  0.8987240276338321
EarlyStopping counter: 14 out of 50
epoch:  114
epoch:  115 val_f1:  0.7685409504908388 val_auroc:  0.8247422680412371 val_auprc:  0.9011094994805577
EarlyStopping counter: 15 out of 50
epoch:  115
epoch:  116 val_f1:  0.7685409504908388 val_auroc:  0.8258468335787924 val_auprc:  0.900388119770939
EarlyStopping counter: 16 out of 50
epoch:  116
epoch:  117 val_f1:  0.7770871369605723 val_auroc:  0.8274423171330387 val_auprc:  0.9000190147728128
EarlyStopping counter: 17 out of 50
epoch:  117
epoch:  118 val_f1:  0.7685409504908388 val_auroc:  0.8265832106038292 val_auprc:  0.9006358160403738
EarlyStopping counter: 18 out of 50
epoch:  118
epoch:  119 val_f1:  0.7685409504908388 val_auroc:  0.8268286696121748 val_auprc:  0.9007012326878571
EarlyStopping counter: 19 out of 50
epoch:  119
epoch:  120 val_f1:  0.7770871369605723 val_auroc:  0.8252331860579284 val_auprc:  0.9002690919626575
EarlyStopping counter: 20 out of 50
epoch:  120
epoch:  121 val_f1:  0.7770871369605723 val_auroc:  0.8258468335787924 val_auprc:  0.9003844517090682
EarlyStopping counter: 21 out of 50
epoch:  121
epoch:  122 val_f1:  0.7770871369605723 val_auroc:  0.8263377515954836 val_auprc:  0.900635153598719
EarlyStopping counter: 22 out of 50
epoch:  122
epoch:  123 val_f1:  0.7770871369605723 val_auroc:  0.8244968090328916 val_auprc:  0.8998210880041007
EarlyStopping counter: 23 out of 50
epoch:  123
epoch:  124 val_f1:  0.7770871369605723 val_auroc:  0.827319587628866 val_auprc:  0.9009439803972026
EarlyStopping counter: 24 out of 50
epoch:  124
epoch:  125 val_f1:  0.7770871369605723 val_auroc:  0.8263377515954836 val_auprc:  0.9000969249230748
EarlyStopping counter: 25 out of 50
epoch:  125
epoch:  126 val_f1:  0.7770871369605723 val_auroc:  0.8257241040746195 val_auprc:  0.9009509714284809
EarlyStopping counter: 26 out of 50
epoch:  126
epoch:  127 val_f1:  0.7770871369605723 val_auroc:  0.8258468335787923 val_auprc:  0.9023290237332893
EarlyStopping counter: 27 out of 50
epoch:  127
epoch:  128 val_f1:  0.7685409504908388 val_auroc:  0.8254786450662739 val_auprc:  0.9029717347201407
EarlyStopping counter: 28 out of 50
epoch:  128
epoch:  129 val_f1:  0.7685409504908388 val_auroc:  0.8257241040746196 val_auprc:  0.903119439908853
EarlyStopping counter: 29 out of 50
epoch:  129
epoch:  130 val_f1:  0.7770871369605723 val_auroc:  0.8275650466372115 val_auprc:  0.9041243414957718
EarlyStopping counter: 30 out of 50
epoch:  130
epoch:  131 val_f1:  0.7770871369605723 val_auroc:  0.8259695630829651 val_auprc:  0.9032301521982458
EarlyStopping counter: 31 out of 50
epoch:  131
epoch:  132 val_f1:  0.7685409504908388 val_auroc:  0.8269513991163475 val_auprc:  0.9032436196442772
EarlyStopping counter: 32 out of 50
epoch:  132
epoch:  133 val_f1:  0.7770871369605723 val_auroc:  0.8262150220913108 val_auprc:  0.9032616785242672
EarlyStopping counter: 33 out of 50
epoch:  133
epoch:  134 val_f1:  0.7770871369605723 val_auroc:  0.8264604810996564 val_auprc:  0.9031951023602408
EarlyStopping counter: 34 out of 50
epoch:  134
epoch:  135 val_f1:  0.7685409504908388 val_auroc:  0.8254786450662739 val_auprc:  0.9029133538740574
EarlyStopping counter: 35 out of 50
epoch:  135
epoch:  136 val_f1:  0.7770871369605723 val_auroc:  0.8264604810996563 val_auprc:  0.9034161789017323
EarlyStopping counter: 36 out of 50
epoch:  136
epoch:  137 val_f1:  0.7685409504908388 val_auroc:  0.8262150220913108 val_auprc:  0.9030026092631956
EarlyStopping counter: 37 out of 50
epoch:  137
epoch:  138 val_f1:  0.7685409504908388 val_auroc:  0.8264604810996563 val_auprc:  0.9031773690306837
EarlyStopping counter: 38 out of 50
epoch:  138
epoch:  139 val_f1:  0.7770871369605723 val_auroc:  0.8259695630829651 val_auprc:  0.9032842797570921
EarlyStopping counter: 39 out of 50
epoch:  139
epoch:  140 val_f1:  0.7685409504908388 val_auroc:  0.8259695630829651 val_auprc:  0.9031048071977941
EarlyStopping counter: 40 out of 50
epoch:  140
epoch:  141 val_f1:  0.7770871369605723 val_auroc:  0.8264604810996563 val_auprc:  0.9037334414076653
EarlyStopping counter: 41 out of 50
epoch:  141
epoch:  142 val_f1:  0.7685409504908388 val_auroc:  0.8268286696121748 val_auprc:  0.903285523750709
EarlyStopping counter: 42 out of 50
epoch:  142
epoch:  143 val_f1:  0.7770871369605723 val_auroc:  0.8262150220913106 val_auprc:  0.9032661379933993
EarlyStopping counter: 43 out of 50
epoch:  143
epoch:  144 val_f1:  0.7685409504908388 val_auroc:  0.826092292587138 val_auprc:  0.9037005264387199
EarlyStopping counter: 44 out of 50
epoch:  144
epoch:  145 val_f1:  0.7770871369605723 val_auroc:  0.8262150220913107 val_auprc:  0.9029726423287867
EarlyStopping counter: 45 out of 50
epoch:  145
epoch:  146 val_f1:  0.7685409504908388 val_auroc:  0.8247422680412372 val_auprc:  0.9024335881491858
EarlyStopping counter: 46 out of 50
epoch:  146
epoch:  147 val_f1:  0.7685409504908388 val_auroc:  0.825478645066274 val_auprc:  0.9027518815982074
EarlyStopping counter: 47 out of 50
epoch:  147
epoch:  148 val_f1:  0.7685409504908388 val_auroc:  0.8251104565537556 val_auprc:  0.9035212548879652
EarlyStopping counter: 48 out of 50
epoch:  148
epoch:  149 val_f1:  0.7770871369605723 val_auroc:  0.8259695630829652 val_auprc:  0.9029085923126772
EarlyStopping counter: 49 out of 50
epoch:  149
epoch:  150 val_f1:  0.7685409504908388 val_auroc:  0.8265832106038291 val_auprc:  0.9054406663043414
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1032.104735136032
{'time_elapsed': [1032.104735136032], 'epoch': [149], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7685409504908388], 'auroc_test': [0.8265832106038291], 'auprc_test': [0.9054406663043414]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1280]           1,024
│    └─BatchNorm1d: 2-2                  [64, 256, 1280]           512
│    └─Tanh: 2-3                         [64, 256, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1278]           --
│    └─Dropout: 2-5                      [64, 256, 1278]           --
│    └─Flatten: 2-6                      [64, 327168]              --
│    └─Linear: 2-7                       [64, 1]                   327,169
==========================================================================================
Total params: 328,705
Trainable params: 328,705
Non-trainable params: 0
Total mult-adds (M): 104.86
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.54
Params size (MB): 1.31
Estimated Total Size (MB): 337.19
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.31182356267437905 val_auroc:  0.7010309278350515 val_auprc:  0.8592292487177086
epoch:  1
epoch:  2 val_f1:  0.3648612882269435 val_auroc:  0.7209131075110456 val_auprc:  0.8472517102700046
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.646667571603095 val_auroc:  0.742513500245459 val_auprc:  0.8597609204019868
Validation loss improved to 0.862117
epoch:  3
epoch:  4 val_f1:  0.6740890891918117 val_auroc:  0.7542955326460481 val_auprc:  0.8460560904939753
Validation loss improved to 0.743573
epoch:  4
epoch:  5 val_f1:  0.6825671929988476 val_auroc:  0.7422680412371134 val_auprc:  0.8283310015167293
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.6225861416130253 val_auroc:  0.7560137457044674 val_auprc:  0.856169949692862
EarlyStopping counter: 2 out of 50
epoch:  6
epoch:  7 val_f1:  0.6301488691399822 val_auroc:  0.7592047128129602 val_auprc:  0.8636389126228414
Validation loss improved to 0.693365
epoch:  7
epoch:  8 val_f1:  0.7349308245711123 val_auroc:  0.7565046637211587 val_auprc:  0.8510205723206878
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7002679453520968 val_auroc:  0.7663230240549828 val_auprc:  0.8622457554679271
Validation loss improved to 0.607205
epoch:  9
epoch:  10 val_f1:  0.6966777045653197 val_auroc:  0.7719685812469318 val_auprc:  0.8754994266976664
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.6441055155875299 val_auroc:  0.7560137457044673 val_auprc:  0.8676052202716843
Validation loss improved to 0.560540
epoch:  11
epoch:  12 val_f1:  0.7058128438779214 val_auroc:  0.7709867452135493 val_auprc:  0.8755129722323952
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.5695518119665757 val_auroc:  0.7673048600883653 val_auprc:  0.874440688744145
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.6960581600537912 val_auroc:  0.7673048600883652 val_auprc:  0.8779986976926639
Validation loss improved to 0.459594
epoch:  14
epoch:  15 val_f1:  0.7044810154681304 val_auroc:  0.7604320078546883 val_auprc:  0.8782830255367922
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7095299887411026 val_auroc:  0.765586647029946 val_auprc:  0.8810277310667429
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.7067808808208037 val_auroc:  0.7702503681885126 val_auprc:  0.8799816863337515
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.7100860488080124 val_auroc:  0.7670594010800196 val_auprc:  0.8826379728763485
Validation loss improved to 0.411865
epoch:  18
epoch:  19 val_f1:  0.7170655771870609 val_auroc:  0.7808051055473736 val_auprc:  0.8948819597193605
Validation loss improved to 0.360311
epoch:  19
epoch:  20 val_f1:  0.730071543320129 val_auroc:  0.781786941580756 val_auprc:  0.8937931005000497
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.713247796930704 val_auroc:  0.7567501227295041 val_auprc:  0.876084353402453
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.6956984934700323 val_auroc:  0.7783505154639175 val_auprc:  0.8900168949421582
EarlyStopping counter: 3 out of 50
epoch:  22
epoch:  23 val_f1:  0.7215941532488295 val_auroc:  0.7569955817378498 val_auprc:  0.8730065355268712
EarlyStopping counter: 4 out of 50
epoch:  23
epoch:  24 val_f1:  0.6869909576925616 val_auroc:  0.7776141384388807 val_auprc:  0.8877810582137141
EarlyStopping counter: 5 out of 50
epoch:  24
epoch:  25 val_f1:  0.6198701745464336 val_auroc:  0.7783505154639175 val_auprc:  0.8871298892608792
EarlyStopping counter: 6 out of 50
epoch:  25
epoch:  26 val_f1:  0.7325045643526866 val_auroc:  0.7783505154639175 val_auprc:  0.8855546982145266
EarlyStopping counter: 7 out of 50
epoch:  26
epoch:  27 val_f1:  0.6980913612614702 val_auroc:  0.7690230731467845 val_auprc:  0.8814198774212814
EarlyStopping counter: 8 out of 50
epoch:  27
epoch:  28 val_f1:  0.7375047745919104 val_auroc:  0.7744231713303877 val_auprc:  0.8843465374886252
EarlyStopping counter: 9 out of 50
epoch:  28
epoch:  29 val_f1:  0.6916657713146764 val_auroc:  0.7692685321551301 val_auprc:  0.8803572778592702
EarlyStopping counter: 10 out of 50
epoch:  29
epoch:  30 val_f1:  0.6909311987030095 val_auroc:  0.7754050073637704 val_auprc:  0.8825886542188286
EarlyStopping counter: 11 out of 50
epoch:  30
epoch:  31 val_f1:  0.6213039568345323 val_auroc:  0.7714776632302405 val_auprc:  0.8810143569281853
EarlyStopping counter: 12 out of 50
epoch:  31
epoch:  32 val_f1:  0.7092263500553166 val_auroc:  0.7827687776141384 val_auprc:  0.8860269697817993
EarlyStopping counter: 13 out of 50
epoch:  32
epoch:  33 val_f1:  0.7420910227448273 val_auroc:  0.7727049582719686 val_auprc:  0.8809084335509357
EarlyStopping counter: 14 out of 50
epoch:  33
epoch:  34 val_f1:  0.7237424247793883 val_auroc:  0.7790868924889544 val_auprc:  0.8834063740619409
EarlyStopping counter: 15 out of 50
epoch:  34
epoch:  35 val_f1:  0.675081516585215 val_auroc:  0.7778595974472263 val_auprc:  0.8783613096804502
EarlyStopping counter: 16 out of 50
epoch:  35
epoch:  36 val_f1:  0.7148475178521729 val_auroc:  0.7616593028964163 val_auprc:  0.8663075712847571
EarlyStopping counter: 17 out of 50
epoch:  36
epoch:  37 val_f1:  0.7346891520614657 val_auroc:  0.7756504663721159 val_auprc:  0.8766207080227528
EarlyStopping counter: 18 out of 50
epoch:  37
epoch:  38 val_f1:  0.7428255465713769 val_auroc:  0.7677957781050564 val_auprc:  0.8705591820650558
EarlyStopping counter: 19 out of 50
epoch:  38
epoch:  39 val_f1:  0.7176437068167247 val_auroc:  0.7682866961217476 val_auprc:  0.8691940915974159
EarlyStopping counter: 20 out of 50
epoch:  39
epoch:  40 val_f1:  0.7203480251458693 val_auroc:  0.7763868433971527 val_auprc:  0.8755243365462329
EarlyStopping counter: 21 out of 50
epoch:  40
epoch:  41 val_f1:  0.7121336235283787 val_auroc:  0.7700049091801668 val_auprc:  0.8712001694889558
EarlyStopping counter: 22 out of 50
epoch:  41
epoch:  42 val_f1:  0.7078050864958872 val_auroc:  0.7746686303387335 val_auprc:  0.8775777791443011
EarlyStopping counter: 23 out of 50
epoch:  42
epoch:  43 val_f1:  0.7176437068167247 val_auroc:  0.7719685812469318 val_auprc:  0.8742982291463233
EarlyStopping counter: 24 out of 50
epoch:  43
epoch:  44 val_f1:  0.7371484630477437 val_auroc:  0.7768777614138438 val_auprc:  0.8768814038674595
EarlyStopping counter: 25 out of 50
epoch:  44
epoch:  45 val_f1:  0.726175885795287 val_auroc:  0.7729504172803142 val_auprc:  0.8746329572547686
EarlyStopping counter: 26 out of 50
epoch:  45
epoch:  46 val_f1:  0.7156947373800909 val_auroc:  0.7677957781050564 val_auprc:  0.8715367231212465
EarlyStopping counter: 27 out of 50
epoch:  46
epoch:  47 val_f1:  0.7313689473952751 val_auroc:  0.7766323024054983 val_auprc:  0.8795055919988108
EarlyStopping counter: 28 out of 50
epoch:  47
epoch:  48 val_f1:  0.7371484630477437 val_auroc:  0.7668139420716741 val_auprc:  0.8718522834481287
EarlyStopping counter: 29 out of 50
epoch:  48
epoch:  49 val_f1:  0.7309103647707891 val_auroc:  0.772459499263623 val_auprc:  0.8738613298336741
EarlyStopping counter: 30 out of 50
epoch:  49
epoch:  50 val_f1:  0.7117994924448791 val_auroc:  0.7660775650466372 val_auprc:  0.8688143762404336
EarlyStopping counter: 31 out of 50
epoch:  50
epoch:  51 val_f1:  0.7402181480621955 val_auroc:  0.7749140893470791 val_auprc:  0.8749298904874113
EarlyStopping counter: 32 out of 50
epoch:  51
epoch:  52 val_f1:  0.7090514753972222 val_auroc:  0.7731958762886598 val_auprc:  0.8747020080692598
Validation loss improved to 0.342080
epoch:  52
epoch:  53 val_f1:  0.7030919944895149 val_auroc:  0.7642366224840452 val_auprc:  0.8640503666483764
EarlyStopping counter: 1 out of 50
epoch:  53
epoch:  54 val_f1:  0.7030919944895149 val_auroc:  0.7604320078546882 val_auprc:  0.8616744301550903
EarlyStopping counter: 2 out of 50
epoch:  54
epoch:  55 val_f1:  0.743396428458658 val_auroc:  0.7717231222385861 val_auprc:  0.8731807064143245
EarlyStopping counter: 3 out of 50
epoch:  55
epoch:  56 val_f1:  0.7025483104025048 val_auroc:  0.7595729013254787 val_auprc:  0.8622629228415848
EarlyStopping counter: 4 out of 50
epoch:  56
epoch:  57 val_f1:  0.7263486361521366 val_auroc:  0.7783505154639175 val_auprc:  0.8799219286781976
EarlyStopping counter: 5 out of 50
epoch:  57
epoch:  58 val_f1:  0.7208993647046947 val_auroc:  0.7569955817378498 val_auprc:  0.8613627816665725
EarlyStopping counter: 6 out of 50
epoch:  58
epoch:  59 val_f1:  0.7411406017655346 val_auroc:  0.7697594501718213 val_auprc:  0.871807551860607
EarlyStopping counter: 7 out of 50
epoch:  59
epoch:  60 val_f1:  0.7299542184434271 val_auroc:  0.7707412862052038 val_auprc:  0.8725841206436777
EarlyStopping counter: 8 out of 50
epoch:  60
epoch:  61 val_f1:  0.726175885795287 val_auroc:  0.7638684339715268 val_auprc:  0.8617556582018522
EarlyStopping counter: 9 out of 50
epoch:  61
epoch:  62 val_f1:  0.726175885795287 val_auroc:  0.7722140402552774 val_auprc:  0.8724976814781206
EarlyStopping counter: 10 out of 50
epoch:  62
epoch:  63 val_f1:  0.7246795893300292 val_auroc:  0.7621502209131075 val_auprc:  0.859771829911949
EarlyStopping counter: 11 out of 50
epoch:  63
epoch:  64 val_f1:  0.7246795893300292 val_auroc:  0.7687776141384389 val_auprc:  0.8679571118562702
EarlyStopping counter: 12 out of 50
epoch:  64
epoch:  65 val_f1:  0.7184536707983012 val_auroc:  0.7628865979381443 val_auprc:  0.8670780887267658
EarlyStopping counter: 13 out of 50
epoch:  65
epoch:  66 val_f1:  0.7325045643526866 val_auroc:  0.7670594010800197 val_auprc:  0.8687094122521337
EarlyStopping counter: 14 out of 50
epoch:  66
epoch:  67 val_f1:  0.7349308245711123 val_auroc:  0.7653411880216004 val_auprc:  0.8667884458696332
EarlyStopping counter: 15 out of 50
epoch:  67
epoch:  68 val_f1:  0.7371484630477437 val_auroc:  0.7631320569464899 val_auprc:  0.8634049098700042
EarlyStopping counter: 16 out of 50
epoch:  68
epoch:  69 val_f1:  0.7246795893300292 val_auroc:  0.76926853215513 val_auprc:  0.8712676025443187
EarlyStopping counter: 17 out of 50
epoch:  69
epoch:  70 val_f1:  0.7283736963917239 val_auroc:  0.7626411389297987 val_auprc:  0.8612200540279948
EarlyStopping counter: 18 out of 50
epoch:  70
epoch:  71 val_f1:  0.7426698176342648 val_auroc:  0.7663230240549828 val_auprc:  0.8656547519533194
EarlyStopping counter: 19 out of 50
epoch:  71
epoch:  72 val_f1:  0.7246795893300292 val_auroc:  0.7628865979381444 val_auprc:  0.8606894098270833
EarlyStopping counter: 20 out of 50
epoch:  72
epoch:  73 val_f1:  0.7349308245711123 val_auroc:  0.7659548355424644 val_auprc:  0.8660490040118666
EarlyStopping counter: 21 out of 50
epoch:  73
epoch:  74 val_f1:  0.7235944791518311 val_auroc:  0.7590819833087874 val_auprc:  0.8542017749329096
EarlyStopping counter: 22 out of 50
epoch:  74
epoch:  75 val_f1:  0.7249644134959412 val_auroc:  0.7619047619047619 val_auprc:  0.8517751793544267
EarlyStopping counter: 23 out of 50
epoch:  75
epoch:  76 val_f1:  0.7249644134959412 val_auroc:  0.7657093765341187 val_auprc:  0.8626776638497483
EarlyStopping counter: 24 out of 50
epoch:  76
epoch:  77 val_f1:  0.7101890414000308 val_auroc:  0.7596956308296514 val_auprc:  0.855089984410571
EarlyStopping counter: 25 out of 50
epoch:  77
epoch:  78 val_f1:  0.7246795893300292 val_auroc:  0.7673048600883652 val_auprc:  0.8613442148514312
EarlyStopping counter: 26 out of 50
epoch:  78
epoch:  79 val_f1:  0.7122302158273381 val_auroc:  0.7584683357879235 val_auprc:  0.8601192459965991
EarlyStopping counter: 27 out of 50
epoch:  79
epoch:  80 val_f1:  0.722058496910722 val_auroc:  0.7577319587628866 val_auprc:  0.857654109979332
EarlyStopping counter: 28 out of 50
epoch:  80
epoch:  81 val_f1:  0.7309103647707891 val_auroc:  0.7631320569464899 val_auprc:  0.8605834745400187
EarlyStopping counter: 29 out of 50
epoch:  81
epoch:  82 val_f1:  0.7426698176342648 val_auroc:  0.7670594010800196 val_auprc:  0.8661425031366367
EarlyStopping counter: 30 out of 50
epoch:  82
epoch:  83 val_f1:  0.722058496910722 val_auroc:  0.7592047128129602 val_auprc:  0.8574871036026566
EarlyStopping counter: 31 out of 50
epoch:  83
epoch:  84 val_f1:  0.7249644134959412 val_auroc:  0.7663230240549828 val_auprc:  0.8647777330331214
EarlyStopping counter: 32 out of 50
epoch:  84
epoch:  85 val_f1:  0.7328919440906961 val_auroc:  0.7628865979381443 val_auprc:  0.8602493889556435
EarlyStopping counter: 33 out of 50
epoch:  85
epoch:  86 val_f1:  0.7249644134959412 val_auroc:  0.7606774668630338 val_auprc:  0.8582841878814507
EarlyStopping counter: 34 out of 50
epoch:  86
epoch:  87 val_f1:  0.7163649790827238 val_auroc:  0.7677957781050564 val_auprc:  0.8661075845682795
EarlyStopping counter: 35 out of 50
epoch:  87
epoch:  88 val_f1:  0.7140775751491829 val_auroc:  0.7603092783505155 val_auprc:  0.8575718164068006
EarlyStopping counter: 36 out of 50
epoch:  88
epoch:  89 val_f1:  0.7283736963917239 val_auroc:  0.7614138438880707 val_auprc:  0.8594281374080059
EarlyStopping counter: 37 out of 50
epoch:  89
epoch:  90 val_f1:  0.7202047592695074 val_auroc:  0.7621502209131075 val_auprc:  0.8597535114897362
EarlyStopping counter: 38 out of 50
epoch:  90
epoch:  91 val_f1:  0.7246795893300292 val_auroc:  0.7614138438880707 val_auprc:  0.8585360183841848
EarlyStopping counter: 39 out of 50
epoch:  91
epoch:  92 val_f1:  0.7346891520614657 val_auroc:  0.7643593519882179 val_auprc:  0.8618198963439234
EarlyStopping counter: 40 out of 50
epoch:  92
epoch:  93 val_f1:  0.7363119073255568 val_auroc:  0.7655866470299459 val_auprc:  0.8617429091148108
EarlyStopping counter: 41 out of 50
epoch:  93
epoch:  94 val_f1:  0.7202047592695074 val_auroc:  0.7628865979381443 val_auprc:  0.8604639240227266
EarlyStopping counter: 42 out of 50
epoch:  94
epoch:  95 val_f1:  0.7202047592695074 val_auroc:  0.7621502209131075 val_auprc:  0.8603916952820909
EarlyStopping counter: 43 out of 50
epoch:  95
epoch:  96 val_f1:  0.7163649790827238 val_auroc:  0.7627638684339716 val_auprc:  0.8589485418012651
EarlyStopping counter: 44 out of 50
epoch:  96
epoch:  97 val_f1:  0.7328919440906961 val_auroc:  0.7621502209131075 val_auprc:  0.858861233313389
EarlyStopping counter: 45 out of 50
epoch:  97
epoch:  98 val_f1:  0.7299542184434271 val_auroc:  0.7630093274423171 val_auprc:  0.8579329976140735
EarlyStopping counter: 46 out of 50
epoch:  98
epoch:  99 val_f1:  0.7079427367197151 val_auroc:  0.7654639175257733 val_auprc:  0.8637355301435927
EarlyStopping counter: 47 out of 50
epoch:  99
epoch:  100 val_f1:  0.7202047592695074 val_auroc:  0.7612911143838978 val_auprc:  0.858452781250135
EarlyStopping counter: 48 out of 50
epoch:  100
epoch:  101 val_f1:  0.7283736963917239 val_auroc:  0.7637457044673539 val_auprc:  0.8586272006865661
EarlyStopping counter: 49 out of 50
epoch:  101
epoch:  102 val_f1:  0.7266187050359713 val_auroc:  0.7647275405007364 val_auprc:  0.8596692582859311
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  701.7095341682434
{'time_elapsed': [701.7095341682434], 'epoch': [101], 'fold': [2], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7266187050359713], 'auroc_test': [0.7647275405007364], 'auprc_test': [0.8596692582859311]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1280]           1,024
│    └─BatchNorm1d: 2-2                  [64, 256, 1280]           512
│    └─Tanh: 2-3                         [64, 256, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1278]           --
│    └─Dropout: 2-5                      [64, 256, 1278]           --
│    └─Flatten: 2-6                      [64, 327168]              --
│    └─Linear: 2-7                       [64, 1]                   327,169
==========================================================================================
Total params: 328,705
Trainable params: 328,705
Non-trainable params: 0
Total mult-adds (M): 104.86
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.54
Params size (MB): 1.31
Estimated Total Size (MB): 337.19
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1461775634437505 val_auroc:  0.7771317829457365 val_auprc:  0.8998826300538089
epoch:  1
epoch:  2 val_f1:  0.5500765915850584 val_auroc:  0.7170542635658915 val_auprc:  0.8544835009511014
Validation loss improved to 1.358094
epoch:  2
epoch:  3 val_f1:  0.6949122579952712 val_auroc:  0.7572674418604652 val_auprc:  0.8809283310340396
Validation loss improved to 0.690889
epoch:  3
epoch:  4 val_f1:  0.73912321974171 val_auroc:  0.8037790697674418 val_auprc:  0.9111486032144113
Validation loss improved to 0.651680
epoch:  4
epoch:  5 val_f1:  0.7578890782445586 val_auroc:  0.8151647286821705 val_auprc:  0.9077949731378087
Validation loss improved to 0.543049
epoch:  5
epoch:  6 val_f1:  0.7503827565415855 val_auroc:  0.8258236434108527 val_auprc:  0.9146293971320306
Validation loss improved to 0.244617
epoch:  6
epoch:  7 val_f1:  0.7227964754633075 val_auroc:  0.8250968992248062 val_auprc:  0.9199411378264257
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.7461132135320524 val_auroc:  0.8270348837209304 val_auprc:  0.9241616741741171
EarlyStopping counter: 2 out of 50
epoch:  8
epoch:  9 val_f1:  0.7714826564458221 val_auroc:  0.8255813953488372 val_auprc:  0.9262832888412762
Validation loss improved to 0.159365
epoch:  9
epoch:  10 val_f1:  0.7489783115038208 val_auroc:  0.836967054263566 val_auprc:  0.9282037943781385
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.7489893984794112 val_auroc:  0.842296511627907 val_auprc:  0.9322739514359353
EarlyStopping counter: 2 out of 50
epoch:  11
epoch:  12 val_f1:  0.7762051583223217 val_auroc:  0.8406007751937984 val_auprc:  0.9334375326288907
Validation loss improved to 0.156327
epoch:  12
epoch:  13 val_f1:  0.7601256159113488 val_auroc:  0.842781007751938 val_auprc:  0.9313042806765597
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7688372056811462 val_auroc:  0.843265503875969 val_auprc:  0.9329812917565236
Validation loss improved to 0.132710
epoch:  14
epoch:  15 val_f1:  0.7679977157187104 val_auroc:  0.841812015503876 val_auprc:  0.9337208039038444
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7679977157187104 val_auroc:  0.8473837209302326 val_auprc:  0.9345905005426781
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.7633328614234447 val_auroc:  0.8558624031007751 val_auprc:  0.9365556212712902
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.7711885993597467 val_auroc:  0.8585271317829457 val_auprc:  0.9383442295947463
EarlyStopping counter: 4 out of 50
epoch:  18
epoch:  19 val_f1:  0.7980190776058461 val_auroc:  0.8578003875968991 val_auprc:  0.9401372238564417
EarlyStopping counter: 5 out of 50
epoch:  19
epoch:  20 val_f1:  0.7665182935781787 val_auroc:  0.8626453488372092 val_auprc:  0.9393898007540662
EarlyStopping counter: 6 out of 50
epoch:  20
epoch:  21 val_f1:  0.7841726618705036 val_auroc:  0.8565891472868217 val_auprc:  0.938879685364532
EarlyStopping counter: 7 out of 50
epoch:  21
epoch:  22 val_f1:  0.783844953500274 val_auroc:  0.8570736434108527 val_auprc:  0.938455134885205
EarlyStopping counter: 8 out of 50
epoch:  22
epoch:  23 val_f1:  0.7866727894280321 val_auroc:  0.8616763565891473 val_auprc:  0.939832922569224
Validation loss improved to 0.131463
epoch:  23
epoch:  24 val_f1:  0.7552249462565869 val_auroc:  0.8607073643410852 val_auprc:  0.9396520959536849
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7491808234085 val_auroc:  0.8607073643410853 val_auprc:  0.9386187849396078
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.8018807955038493 val_auroc:  0.8619186046511628 val_auprc:  0.9396792077691334
EarlyStopping counter: 3 out of 50
epoch:  26
epoch:  27 val_f1:  0.8041795135320315 val_auroc:  0.8609496124031009 val_auprc:  0.9433633565994923
Validation loss improved to 0.123304
epoch:  27
epoch:  28 val_f1:  0.7789671954250403 val_auroc:  0.8733042635658914 val_auprc:  0.9454365094992527
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.794309372388086 val_auroc:  0.8764534883720931 val_auprc:  0.9457990791233639
EarlyStopping counter: 2 out of 50
epoch:  29
epoch:  30 val_f1:  0.7866727894280321 val_auroc:  0.8766957364341085 val_auprc:  0.9470506967058558
EarlyStopping counter: 3 out of 50
epoch:  30
epoch:  31 val_f1:  0.7789671954250403 val_auroc:  0.8733042635658915 val_auprc:  0.9455938246796527
EarlyStopping counter: 4 out of 50
epoch:  31
epoch:  32 val_f1:  0.7866727894280321 val_auroc:  0.8694282945736435 val_auprc:  0.9449159864966316
EarlyStopping counter: 5 out of 50
epoch:  32
epoch:  33 val_f1:  0.7866727894280321 val_auroc:  0.8672480620155038 val_auprc:  0.9430171738828481
EarlyStopping counter: 6 out of 50
epoch:  33
epoch:  34 val_f1:  0.7932273763653603 val_auroc:  0.872093023255814 val_auprc:  0.9444472320768503
EarlyStopping counter: 7 out of 50
epoch:  34
epoch:  35 val_f1:  0.8027539115793398 val_auroc:  0.8665213178294573 val_auprc:  0.9439535775224948
Validation loss improved to 0.123070
epoch:  35
epoch:  36 val_f1:  0.7477439586792105 val_auroc:  0.8769379844961241 val_auprc:  0.9461418119047476
EarlyStopping counter: 1 out of 50
epoch:  36
epoch:  37 val_f1:  0.7793492478744277 val_auroc:  0.8716085271317829 val_auprc:  0.9445970597510456
EarlyStopping counter: 2 out of 50
epoch:  37
epoch:  38 val_f1:  0.7854893118997625 val_auroc:  0.873546511627907 val_auprc:  0.9441498130692957
EarlyStopping counter: 3 out of 50
epoch:  38
epoch:  39 val_f1:  0.8168429178951009 val_auroc:  0.8720930232558141 val_auprc:  0.9444962378699999
EarlyStopping counter: 4 out of 50
epoch:  39
epoch:  40 val_f1:  0.7841726618705036 val_auroc:  0.8677325581395349 val_auprc:  0.9422634145148547
EarlyStopping counter: 5 out of 50
epoch:  40
epoch:  41 val_f1:  0.8123505522904839 val_auroc:  0.8667635658914729 val_auprc:  0.9433542218191098
Validation loss improved to 0.107884
epoch:  41
epoch:  42 val_f1:  0.7665182935781787 val_auroc:  0.8711240310077519 val_auprc:  0.9441758620223736
EarlyStopping counter: 1 out of 50
epoch:  42
epoch:  43 val_f1:  0.794309372388086 val_auroc:  0.8643410852713178 val_auprc:  0.9417803713727203
EarlyStopping counter: 2 out of 50
epoch:  43
epoch:  44 val_f1:  0.776244301724119 val_auroc:  0.8699127906976744 val_auprc:  0.9426866884370717
EarlyStopping counter: 3 out of 50
epoch:  44
epoch:  45 val_f1:  0.7710202043822609 val_auroc:  0.8703972868217055 val_auprc:  0.9432932772514895
EarlyStopping counter: 4 out of 50
epoch:  45
epoch:  46 val_f1:  0.8018807955038493 val_auroc:  0.8655523255813954 val_auprc:  0.941641779293735
EarlyStopping counter: 5 out of 50
epoch:  46
epoch:  47 val_f1:  0.776244301724119 val_auroc:  0.869670542635659 val_auprc:  0.943575404111496
EarlyStopping counter: 6 out of 50
epoch:  47
epoch:  48 val_f1:  0.8027539115793398 val_auroc:  0.8672480620155039 val_auprc:  0.9427782528651761
EarlyStopping counter: 7 out of 50
epoch:  48
epoch:  49 val_f1:  0.7774211400110681 val_auroc:  0.867732558139535 val_auprc:  0.9432092468773329
EarlyStopping counter: 8 out of 50
epoch:  49
epoch:  50 val_f1:  0.7932273763653603 val_auroc:  0.8713662790697675 val_auprc:  0.9450130848124842
EarlyStopping counter: 9 out of 50
epoch:  50
epoch:  51 val_f1:  0.7854893118997625 val_auroc:  0.867248062015504 val_auprc:  0.9440750457770326
EarlyStopping counter: 10 out of 50
epoch:  51
epoch:  52 val_f1:  0.7894843465886632 val_auroc:  0.8694282945736433 val_auprc:  0.943374537861273
EarlyStopping counter: 11 out of 50
epoch:  52
epoch:  53 val_f1:  0.7875752415552048 val_auroc:  0.8645833333333333 val_auprc:  0.942972480546969
EarlyStopping counter: 12 out of 50
epoch:  53
epoch:  54 val_f1:  0.792019787311512 val_auroc:  0.8672480620155039 val_auprc:  0.942926996375782
EarlyStopping counter: 13 out of 50
epoch:  54
epoch:  55 val_f1:  0.8084949329130455 val_auroc:  0.8699127906976745 val_auprc:  0.9447234848121584
EarlyStopping counter: 14 out of 50
epoch:  55
epoch:  56 val_f1:  0.7578890782445586 val_auroc:  0.8747577519379846 val_auprc:  0.9454631761805219
EarlyStopping counter: 15 out of 50
epoch:  56
epoch:  57 val_f1:  0.8074875573056803 val_auroc:  0.8701550387596899 val_auprc:  0.9445483616117283
EarlyStopping counter: 16 out of 50
epoch:  57
epoch:  58 val_f1:  0.7932273763653603 val_auroc:  0.8662790697674417 val_auprc:  0.9436782152305783
EarlyStopping counter: 17 out of 50
epoch:  58
epoch:  59 val_f1:  0.792019787311512 val_auroc:  0.8706395348837209 val_auprc:  0.9428684528079028
EarlyStopping counter: 18 out of 50
epoch:  59
epoch:  60 val_f1:  0.7875752415552048 val_auroc:  0.8708817829457364 val_auprc:  0.9436194228759113
EarlyStopping counter: 19 out of 50
epoch:  60
epoch:  61 val_f1:  0.7901923359271766 val_auroc:  0.8691860465116279 val_auprc:  0.9429619156378455
Validation loss improved to 0.106514
epoch:  61
epoch:  62 val_f1:  0.7932273763653603 val_auroc:  0.8694282945736435 val_auprc:  0.9433714498116609
EarlyStopping counter: 1 out of 50
epoch:  62
epoch:  63 val_f1:  0.7578890782445586 val_auroc:  0.8706395348837209 val_auprc:  0.9425538538606428
EarlyStopping counter: 2 out of 50
epoch:  63
epoch:  64 val_f1:  0.7906801532257888 val_auroc:  0.8679748062015504 val_auprc:  0.9430588647765139
EarlyStopping counter: 3 out of 50
epoch:  64
epoch:  65 val_f1:  0.8018807955038493 val_auroc:  0.8684593023255814 val_auprc:  0.9424162147047056
EarlyStopping counter: 4 out of 50
epoch:  65
epoch:  66 val_f1:  0.7932273763653603 val_auroc:  0.8706395348837209 val_auprc:  0.9442603957252527
EarlyStopping counter: 5 out of 50
epoch:  66
epoch:  67 val_f1:  0.7932273763653603 val_auroc:  0.8713662790697675 val_auprc:  0.9434907864504882
EarlyStopping counter: 6 out of 50
epoch:  67
epoch:  68 val_f1:  0.8008946034661633 val_auroc:  0.8679748062015504 val_auprc:  0.9429349776747833
EarlyStopping counter: 7 out of 50
epoch:  68
epoch:  69 val_f1:  0.794309372388086 val_auroc:  0.8682170542635659 val_auprc:  0.9421373822578846
EarlyStopping counter: 8 out of 50
epoch:  69
epoch:  70 val_f1:  0.7776763243674784 val_auroc:  0.8694282945736433 val_auprc:  0.9424704141300823
EarlyStopping counter: 9 out of 50
epoch:  70
epoch:  71 val_f1:  0.7932273763653603 val_auroc:  0.8694282945736435 val_auprc:  0.9434217807569885
EarlyStopping counter: 10 out of 50
epoch:  71
epoch:  72 val_f1:  0.7875752415552048 val_auroc:  0.8691860465116279 val_auprc:  0.9415303198808472
EarlyStopping counter: 11 out of 50
epoch:  72
epoch:  73 val_f1:  0.7857930944221151 val_auroc:  0.871124031007752 val_auprc:  0.943905631046209
EarlyStopping counter: 12 out of 50
epoch:  73
epoch:  74 val_f1:  0.7753157557330894 val_auroc:  0.873062015503876 val_auprc:  0.9427285995864423
EarlyStopping counter: 13 out of 50
epoch:  74
epoch:  75 val_f1:  0.7811109002295425 val_auroc:  0.8703972868217054 val_auprc:  0.9437511008266882
EarlyStopping counter: 14 out of 50
epoch:  75
epoch:  76 val_f1:  0.7906801532257888 val_auroc:  0.8674903100775194 val_auprc:  0.9423487437745699
EarlyStopping counter: 15 out of 50
epoch:  76
epoch:  77 val_f1:  0.7793492478744277 val_auroc:  0.8699127906976744 val_auprc:  0.9433100218366202
EarlyStopping counter: 16 out of 50
epoch:  77
epoch:  78 val_f1:  0.7857930944221151 val_auroc:  0.8716085271317829 val_auprc:  0.9435463827737336
EarlyStopping counter: 17 out of 50
epoch:  78
epoch:  79 val_f1:  0.8008946034661633 val_auroc:  0.8694282945736435 val_auprc:  0.9436701486075202
EarlyStopping counter: 18 out of 50
epoch:  79
epoch:  80 val_f1:  0.7932273763653603 val_auroc:  0.8713662790697676 val_auprc:  0.943920070732528
EarlyStopping counter: 19 out of 50
epoch:  80
epoch:  81 val_f1:  0.8008946034661633 val_auroc:  0.8723352713178294 val_auprc:  0.9446565865416432
EarlyStopping counter: 20 out of 50
epoch:  81
epoch:  82 val_f1:  0.7952715769842713 val_auroc:  0.8701550387596898 val_auprc:  0.9438337377670915
EarlyStopping counter: 21 out of 50
epoch:  82
epoch:  83 val_f1:  0.7932273763653603 val_auroc:  0.8684593023255814 val_auprc:  0.942940451758951
EarlyStopping counter: 22 out of 50
epoch:  83
epoch:  84 val_f1:  0.7932273763653603 val_auroc:  0.8691860465116279 val_auprc:  0.9432313644772023
EarlyStopping counter: 23 out of 50
epoch:  84
epoch:  85 val_f1:  0.7827158008497472 val_auroc:  0.8728197674418604 val_auprc:  0.944226450647127
EarlyStopping counter: 24 out of 50
epoch:  85
epoch:  86 val_f1:  0.7811109002295425 val_auroc:  0.8723352713178294 val_auprc:  0.9445191741152048
EarlyStopping counter: 25 out of 50
epoch:  86
epoch:  87 val_f1:  0.7682301875730638 val_auroc:  0.8701550387596899 val_auprc:  0.9430523281234969
EarlyStopping counter: 26 out of 50
epoch:  87
epoch:  88 val_f1:  0.8008946034661633 val_auroc:  0.8684593023255814 val_auprc:  0.9432941507911032
EarlyStopping counter: 27 out of 50
epoch:  88
epoch:  89 val_f1:  0.7932273763653603 val_auroc:  0.8689437984496124 val_auprc:  0.9413768731553444
EarlyStopping counter: 28 out of 50
epoch:  89
epoch:  90 val_f1:  0.7952715769842713 val_auroc:  0.8691860465116279 val_auprc:  0.9434995815211611
EarlyStopping counter: 29 out of 50
epoch:  90
epoch:  91 val_f1:  0.7901923359271766 val_auroc:  0.8679748062015504 val_auprc:  0.9423815187176637
Validation loss improved to 0.096865
epoch:  91
epoch:  92 val_f1:  0.8035187234827523 val_auroc:  0.8670058139534884 val_auprc:  0.9426058364922681
EarlyStopping counter: 1 out of 50
epoch:  92
epoch:  93 val_f1:  0.7877294237541244 val_auroc:  0.8689437984496124 val_auprc:  0.9413109395032541
EarlyStopping counter: 2 out of 50
epoch:  93
epoch:  94 val_f1:  0.7952715769842713 val_auroc:  0.8665213178294573 val_auprc:  0.9430115887665501
EarlyStopping counter: 3 out of 50
epoch:  94
epoch:  95 val_f1:  0.7776763243674784 val_auroc:  0.8720930232558141 val_auprc:  0.9436577186339323
EarlyStopping counter: 4 out of 50
epoch:  95
epoch:  96 val_f1:  0.7854893118997625 val_auroc:  0.8703972868217055 val_auprc:  0.9436301342462468
EarlyStopping counter: 5 out of 50
epoch:  96
epoch:  97 val_f1:  0.7697841726618705 val_auroc:  0.8706395348837209 val_auprc:  0.9440457643819795
EarlyStopping counter: 6 out of 50
epoch:  97
epoch:  98 val_f1:  0.7776763243674784 val_auroc:  0.8689437984496124 val_auprc:  0.9433898208737063
EarlyStopping counter: 7 out of 50
epoch:  98
epoch:  99 val_f1:  0.7776763243674784 val_auroc:  0.8716085271317829 val_auprc:  0.9443900309722219
EarlyStopping counter: 8 out of 50
epoch:  99
epoch:  100 val_f1:  0.7697841726618705 val_auroc:  0.8708817829457365 val_auprc:  0.9439933503698521
EarlyStopping counter: 9 out of 50
epoch:  100
epoch:  101 val_f1:  0.7746634573712671 val_auroc:  0.8699127906976744 val_auprc:  0.9433071725454072
EarlyStopping counter: 10 out of 50
epoch:  101
epoch:  102 val_f1:  0.7940592980161325 val_auroc:  0.8703972868217055 val_auprc:  0.9427790520032474
EarlyStopping counter: 11 out of 50
epoch:  102
epoch:  103 val_f1:  0.7618084502224494 val_auroc:  0.8694282945736435 val_auprc:  0.9430584950132519
EarlyStopping counter: 12 out of 50
epoch:  103
epoch:  104 val_f1:  0.7776763243674784 val_auroc:  0.8708817829457365 val_auprc:  0.9436596775765465
EarlyStopping counter: 13 out of 50
epoch:  104
epoch:  105 val_f1:  0.7682301875730638 val_auroc:  0.870639534883721 val_auprc:  0.9436221855150113
EarlyStopping counter: 14 out of 50
epoch:  105
epoch:  106 val_f1:  0.7776763243674784 val_auroc:  0.8684593023255814 val_auprc:  0.9422085748888206
EarlyStopping counter: 15 out of 50
epoch:  106
epoch:  107 val_f1:  0.7854893118997625 val_auroc:  0.8687015503875969 val_auprc:  0.9427003706931084
EarlyStopping counter: 16 out of 50
epoch:  107
epoch:  108 val_f1:  0.7811109002295425 val_auroc:  0.87015503875969 val_auprc:  0.94155518399828
EarlyStopping counter: 17 out of 50
epoch:  108
epoch:  109 val_f1:  0.776244301724119 val_auroc:  0.873062015503876 val_auprc:  0.9448678694314256
EarlyStopping counter: 18 out of 50
epoch:  109
epoch:  110 val_f1:  0.7682301875730638 val_auroc:  0.8703972868217054 val_auprc:  0.9433103975813155
EarlyStopping counter: 19 out of 50
epoch:  110
epoch:  111 val_f1:  0.7854893118997625 val_auroc:  0.8682170542635659 val_auprc:  0.9424946767971278
EarlyStopping counter: 20 out of 50
epoch:  111
epoch:  112 val_f1:  0.7776763243674784 val_auroc:  0.8703972868217054 val_auprc:  0.9435978571625266
EarlyStopping counter: 21 out of 50
epoch:  112
epoch:  113 val_f1:  0.7682301875730638 val_auroc:  0.8708817829457363 val_auprc:  0.9438228449200396
EarlyStopping counter: 22 out of 50
epoch:  113
epoch:  114 val_f1:  0.7746634573712671 val_auroc:  0.8694282945736435 val_auprc:  0.9428444187102123
EarlyStopping counter: 23 out of 50
epoch:  114
epoch:  115 val_f1:  0.7776763243674784 val_auroc:  0.8689437984496124 val_auprc:  0.9429172822925502
EarlyStopping counter: 24 out of 50
epoch:  115
epoch:  116 val_f1:  0.7746634573712671 val_auroc:  0.8696705426356588 val_auprc:  0.9427363849739482
EarlyStopping counter: 25 out of 50
epoch:  116
epoch:  117 val_f1:  0.7682301875730638 val_auroc:  0.8699127906976745 val_auprc:  0.94329235893497
EarlyStopping counter: 26 out of 50
epoch:  117
epoch:  118 val_f1:  0.7854893118997625 val_auroc:  0.8679748062015504 val_auprc:  0.9424605178574273
EarlyStopping counter: 27 out of 50
epoch:  118
epoch:  119 val_f1:  0.7875752415552048 val_auroc:  0.8696705426356589 val_auprc:  0.9429336409246915
EarlyStopping counter: 28 out of 50
epoch:  119
epoch:  120 val_f1:  0.7682301875730638 val_auroc:  0.8691860465116279 val_auprc:  0.9431999413258152
EarlyStopping counter: 29 out of 50
epoch:  120
epoch:  121 val_f1:  0.776244301724119 val_auroc:  0.8670058139534884 val_auprc:  0.9420653762136305
EarlyStopping counter: 30 out of 50
epoch:  121
epoch:  122 val_f1:  0.7682301875730638 val_auroc:  0.867248062015504 val_auprc:  0.9416176758724618
EarlyStopping counter: 31 out of 50
epoch:  122
epoch:  123 val_f1:  0.7776763243674784 val_auroc:  0.8696705426356589 val_auprc:  0.9427516525524464
EarlyStopping counter: 32 out of 50
epoch:  123
epoch:  124 val_f1:  0.7875752415552048 val_auroc:  0.8706395348837209 val_auprc:  0.9430113217826018
EarlyStopping counter: 33 out of 50
epoch:  124
epoch:  125 val_f1:  0.7682301875730638 val_auroc:  0.8696705426356589 val_auprc:  0.9425604232780188
EarlyStopping counter: 34 out of 50
epoch:  125
epoch:  126 val_f1:  0.7854893118997625 val_auroc:  0.8694282945736435 val_auprc:  0.9425952998808248
EarlyStopping counter: 35 out of 50
epoch:  126
epoch:  127 val_f1:  0.776244301724119 val_auroc:  0.8701550387596899 val_auprc:  0.9431176707613114
EarlyStopping counter: 36 out of 50
epoch:  127
epoch:  128 val_f1:  0.7776763243674784 val_auroc:  0.8703972868217054 val_auprc:  0.9434159465997045
EarlyStopping counter: 37 out of 50
epoch:  128
epoch:  129 val_f1:  0.7841726618705036 val_auroc:  0.8689437984496124 val_auprc:  0.9426594153482304
EarlyStopping counter: 38 out of 50
epoch:  129
epoch:  130 val_f1:  0.7854893118997625 val_auroc:  0.8706395348837209 val_auprc:  0.9436260299631002
EarlyStopping counter: 39 out of 50
epoch:  130
epoch:  131 val_f1:  0.776244301724119 val_auroc:  0.8706395348837209 val_auprc:  0.94315629426491
EarlyStopping counter: 40 out of 50
epoch:  131
epoch:  132 val_f1:  0.7682301875730638 val_auroc:  0.8679748062015503 val_auprc:  0.941898803407925
EarlyStopping counter: 41 out of 50
epoch:  132
epoch:  133 val_f1:  0.7776763243674784 val_auroc:  0.8684593023255814 val_auprc:  0.9424031312067831
EarlyStopping counter: 42 out of 50
epoch:  133
epoch:  134 val_f1:  0.7682301875730638 val_auroc:  0.8689437984496126 val_auprc:  0.942187459274958
EarlyStopping counter: 43 out of 50
epoch:  134
epoch:  135 val_f1:  0.7682301875730638 val_auroc:  0.8703972868217056 val_auprc:  0.9429137421256746
EarlyStopping counter: 44 out of 50
epoch:  135
epoch:  136 val_f1:  0.7854893118997625 val_auroc:  0.8703972868217054 val_auprc:  0.9436541905480497
EarlyStopping counter: 45 out of 50
epoch:  136
epoch:  137 val_f1:  0.7682301875730638 val_auroc:  0.8696705426356589 val_auprc:  0.9422424290589735
EarlyStopping counter: 46 out of 50
epoch:  137
epoch:  138 val_f1:  0.776244301724119 val_auroc:  0.8699127906976744 val_auprc:  0.9426478605688555
EarlyStopping counter: 47 out of 50
epoch:  138
epoch:  139 val_f1:  0.7776763243674784 val_auroc:  0.8699127906976744 val_auprc:  0.9426478605688554
EarlyStopping counter: 48 out of 50
epoch:  139
epoch:  140 val_f1:  0.776244301724119 val_auroc:  0.8713662790697675 val_auprc:  0.9437975035898984
EarlyStopping counter: 49 out of 50
epoch:  140
epoch:  141 val_f1:  0.7776763243674784 val_auroc:  0.8691860465116278 val_auprc:  0.9422344038246018
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  971.0027084350586
{'time_elapsed': [971.0027084350586], 'epoch': [140], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7776763243674784], 'auroc_test': [0.8691860465116278], 'auprc_test': [0.9422344038246018]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1280]           1,024
│    └─BatchNorm1d: 2-2                  [64, 256, 1280]           512
│    └─Tanh: 2-3                         [64, 256, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1278]           --
│    └─Dropout: 2-5                      [64, 256, 1278]           --
│    └─Flatten: 2-6                      [64, 327168]              --
│    └─Linear: 2-7                       [64, 1]                   327,169
==========================================================================================
Total params: 328,705
Trainable params: 328,705
Non-trainable params: 0
Total mult-adds (M): 104.86
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.54
Params size (MB): 1.31
Estimated Total Size (MB): 337.19
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5707915273132664 val_auroc:  0.6852678571428572 val_auprc:  0.8449475847083913
epoch:  1
epoch:  2 val_f1:  0.6764418811002663 val_auroc:  0.5967261904761906 val_auprc:  0.7510230910767495
Validation loss improved to 2.332709
epoch:  2
epoch:  3 val_f1:  0.6828830423404176 val_auroc:  0.667782738095238 val_auprc:  0.7827445515078894
Validation loss improved to 1.604467
epoch:  3
epoch:  4 val_f1:  0.7436310334861059 val_auroc:  0.7621527777777778 val_auprc:  0.8515836322531005
Validation loss improved to 0.876873
epoch:  4
epoch:  5 val_f1:  0.7905411014849827 val_auroc:  0.8392857142857142 val_auprc:  0.9214552883679796
Validation loss improved to 0.438084
epoch:  5
epoch:  6 val_f1:  0.818640853509558 val_auroc:  0.8663194444444445 val_auprc:  0.9376971857741323
Validation loss improved to 0.412227
epoch:  6
epoch:  7 val_f1:  0.7563598080432068 val_auroc:  0.8675595238095238 val_auprc:  0.9365652238566129
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.7627107192324585 val_auroc:  0.861111111111111 val_auprc:  0.9327052783100379
Validation loss improved to 0.359044
epoch:  8
epoch:  9 val_f1:  0.7771751194325146 val_auroc:  0.8653273809523809 val_auprc:  0.9346940605364273
Validation loss improved to 0.303652
epoch:  9
epoch:  10 val_f1:  0.7842196249660383 val_auroc:  0.8650793650793651 val_auprc:  0.936309125768616
Validation loss improved to 0.270474
epoch:  10
epoch:  11 val_f1:  0.7542058116670308 val_auroc:  0.8541666666666667 val_auprc:  0.9275750649173099
Validation loss improved to 0.268788
epoch:  11
epoch:  12 val_f1:  0.7810348219555381 val_auroc:  0.8499503968253969 val_auprc:  0.9248683437526046
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7912353347135956 val_auroc:  0.8467261904761906 val_auprc:  0.9234671179660375
Validation loss improved to 0.218767
epoch:  13
epoch:  14 val_f1:  0.7563598080432068 val_auroc:  0.8571428571428571 val_auprc:  0.9297425806795736
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.7981409394843585 val_auroc:  0.8675595238095237 val_auprc:  0.9326208059093302
Validation loss improved to 0.186225
epoch:  15
epoch:  16 val_f1:  0.7781291172595521 val_auroc:  0.8722718253968255 val_auprc:  0.9350262208950503
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7875799991742021 val_auroc:  0.8720238095238095 val_auprc:  0.9352086232443393
EarlyStopping counter: 2 out of 50
epoch:  17
epoch:  18 val_f1:  0.7793921916592724 val_auroc:  0.8687996031746033 val_auprc:  0.9306114287216949
EarlyStopping counter: 3 out of 50
epoch:  18
epoch:  19 val_f1:  0.7711042634565258 val_auroc:  0.8687996031746033 val_auprc:  0.9334106927663346
Validation loss improved to 0.176486
epoch:  19
epoch:  20 val_f1:  0.7983928476398275 val_auroc:  0.8658234126984127 val_auprc:  0.9268686421365127
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.792371879328401 val_auroc:  0.8694196428571429 val_auprc:  0.9307791676859359
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7988956640912072 val_auroc:  0.8735119047619049 val_auprc:  0.9318937650427024
Validation loss improved to 0.148251
epoch:  22
epoch:  23 val_f1:  0.7858717303302986 val_auroc:  0.8643353174603174 val_auprc:  0.9237345843234058
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7819511139952413 val_auroc:  0.8663194444444444 val_auprc:  0.9262906276982162
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.7819511139952413 val_auroc:  0.8683035714285715 val_auprc:  0.9275549173618127
EarlyStopping counter: 3 out of 50
epoch:  25
epoch:  26 val_f1:  0.8036760694501368 val_auroc:  0.8683035714285714 val_auprc:  0.9264922924972276
EarlyStopping counter: 4 out of 50
epoch:  26
epoch:  27 val_f1:  0.7819511139952413 val_auroc:  0.8697916666666666 val_auprc:  0.9272468232175577
EarlyStopping counter: 5 out of 50
epoch:  27
epoch:  28 val_f1:  0.7819511139952413 val_auroc:  0.873015873015873 val_auprc:  0.9282644061609477
EarlyStopping counter: 6 out of 50
epoch:  28
epoch:  29 val_f1:  0.7797158172381521 val_auroc:  0.8675595238095238 val_auprc:  0.9233881327199909
EarlyStopping counter: 7 out of 50
epoch:  29
epoch:  30 val_f1:  0.807228002894545 val_auroc:  0.8715277777777777 val_auprc:  0.9244464804762424
EarlyStopping counter: 8 out of 50
epoch:  30
epoch:  31 val_f1:  0.8452294685990339 val_auroc:  0.8764880952380952 val_auprc:  0.9283448960059923
EarlyStopping counter: 9 out of 50
epoch:  31
epoch:  32 val_f1:  0.7949078298424175 val_auroc:  0.8705357142857143 val_auprc:  0.9254652152491714
EarlyStopping counter: 10 out of 50
epoch:  32
epoch:  33 val_f1:  0.7845614924947297 val_auroc:  0.8676835317460316 val_auprc:  0.9158912537728202
EarlyStopping counter: 11 out of 50
epoch:  33
epoch:  34 val_f1:  0.7819511139952413 val_auroc:  0.8697916666666666 val_auprc:  0.9220251977394238
EarlyStopping counter: 12 out of 50
epoch:  34
epoch:  35 val_f1:  0.7619195555090884 val_auroc:  0.8645833333333333 val_auprc:  0.8994377313800125
EarlyStopping counter: 13 out of 50
epoch:  35
epoch:  36 val_f1:  0.792371879328401 val_auroc:  0.8747519841269841 val_auprc:  0.9236343950930037
EarlyStopping counter: 14 out of 50
epoch:  36
epoch:  37 val_f1:  0.8108796141220607 val_auroc:  0.8707837301587301 val_auprc:  0.9088372584003871
EarlyStopping counter: 15 out of 50
epoch:  37
epoch:  38 val_f1:  0.8088065661047027 val_auroc:  0.8715277777777778 val_auprc:  0.9106449142937213
EarlyStopping counter: 16 out of 50
epoch:  38
epoch:  39 val_f1:  0.792371879328401 val_auroc:  0.8720238095238095 val_auprc:  0.9107813943263402
EarlyStopping counter: 17 out of 50
epoch:  39
epoch:  40 val_f1:  0.7839990466164816 val_auroc:  0.8712797619047619 val_auprc:  0.9180984693862059
EarlyStopping counter: 18 out of 50
epoch:  40
epoch:  41 val_f1:  0.8061683443992288 val_auroc:  0.8742559523809524 val_auprc:  0.918425098553133
EarlyStopping counter: 19 out of 50
epoch:  41
epoch:  42 val_f1:  0.7717414591283235 val_auroc:  0.8695436507936508 val_auprc:  0.9140262373213301
EarlyStopping counter: 20 out of 50
epoch:  42
epoch:  43 val_f1:  0.7686030845313764 val_auroc:  0.8628472222222222 val_auprc:  0.8986841685962135
EarlyStopping counter: 21 out of 50
epoch:  43
epoch:  44 val_f1:  0.7858717303302986 val_auroc:  0.8687996031746031 val_auprc:  0.9008805480610846
EarlyStopping counter: 22 out of 50
epoch:  44
epoch:  45 val_f1:  0.8244017137891919 val_auroc:  0.873015873015873 val_auprc:  0.9155474081460293
EarlyStopping counter: 23 out of 50
epoch:  45
epoch:  46 val_f1:  0.7239811321395462 val_auroc:  0.8738839285714285 val_auprc:  0.9149283682300945
EarlyStopping counter: 24 out of 50
epoch:  46
epoch:  47 val_f1:  0.8258326976862446 val_auroc:  0.882688492063492 val_auprc:  0.9234914304775057
EarlyStopping counter: 25 out of 50
epoch:  47
epoch:  48 val_f1:  0.792371879328401 val_auroc:  0.8726438492063492 val_auprc:  0.9082253952828359
EarlyStopping counter: 26 out of 50
epoch:  48
epoch:  49 val_f1:  0.8205262448141007 val_auroc:  0.8754960317460317 val_auprc:  0.9210269079849712
EarlyStopping counter: 27 out of 50
epoch:  49
epoch:  50 val_f1:  0.8072024593763724 val_auroc:  0.8766121031746031 val_auprc:  0.9225516615714401
EarlyStopping counter: 28 out of 50
epoch:  50
epoch:  51 val_f1:  0.8072024593763724 val_auroc:  0.8735119047619048 val_auprc:  0.9172458745552714
EarlyStopping counter: 29 out of 50
epoch:  51
epoch:  52 val_f1:  0.8022296544035674 val_auroc:  0.8803323412698412 val_auprc:  0.9247046280979792
EarlyStopping counter: 30 out of 50
epoch:  52
epoch:  53 val_f1:  0.800639197204071 val_auroc:  0.8761160714285715 val_auprc:  0.9178980738432505
EarlyStopping counter: 31 out of 50
epoch:  53
epoch:  54 val_f1:  0.8115942028985508 val_auroc:  0.8756200396825398 val_auprc:  0.9163675734441513
EarlyStopping counter: 32 out of 50
epoch:  54
epoch:  55 val_f1:  0.8036760694501368 val_auroc:  0.8758680555555556 val_auprc:  0.9234075652905878
EarlyStopping counter: 33 out of 50
epoch:  55
epoch:  56 val_f1:  0.8115942028985508 val_auroc:  0.8723958333333335 val_auprc:  0.9159292041101428
EarlyStopping counter: 34 out of 50
epoch:  56
epoch:  57 val_f1:  0.7875799991742021 val_auroc:  0.8733878968253969 val_auprc:  0.9094845395976048
EarlyStopping counter: 35 out of 50
epoch:  57
epoch:  58 val_f1:  0.7904805491990847 val_auroc:  0.8733878968253969 val_auprc:  0.9156981525283266
EarlyStopping counter: 36 out of 50
epoch:  58
epoch:  59 val_f1:  0.8049865427618805 val_auroc:  0.8766121031746033 val_auprc:  0.9174768909697082
EarlyStopping counter: 37 out of 50
epoch:  59
epoch:  60 val_f1:  0.8127933585226971 val_auroc:  0.8783482142857143 val_auprc:  0.9228684018583588
EarlyStopping counter: 38 out of 50
epoch:  60
epoch:  61 val_f1:  0.792371879328401 val_auroc:  0.8741319444444444 val_auprc:  0.915883886200082
EarlyStopping counter: 39 out of 50
epoch:  61
epoch:  62 val_f1:  0.792371879328401 val_auroc:  0.874875992063492 val_auprc:  0.9157506973913139
EarlyStopping counter: 40 out of 50
epoch:  62
epoch:  63 val_f1:  0.8088065661047027 val_auroc:  0.8746279761904762 val_auprc:  0.9222486099305809
EarlyStopping counter: 41 out of 50
epoch:  63
epoch:  64 val_f1:  0.8115942028985508 val_auroc:  0.8753720238095238 val_auprc:  0.9199331577899962
EarlyStopping counter: 42 out of 50
epoch:  64
epoch:  65 val_f1:  0.8115942028985508 val_auroc:  0.8715277777777777 val_auprc:  0.9122264549302856
EarlyStopping counter: 43 out of 50
epoch:  65
epoch:  66 val_f1:  0.7940993788819876 val_auroc:  0.8732638888888888 val_auprc:  0.91740953186486
EarlyStopping counter: 44 out of 50
epoch:  66
epoch:  67 val_f1:  0.7940993788819876 val_auroc:  0.8709077380952381 val_auprc:  0.9150326133131341
EarlyStopping counter: 45 out of 50
epoch:  67
epoch:  68 val_f1:  0.800639197204071 val_auroc:  0.8733878968253967 val_auprc:  0.9166708309491297
EarlyStopping counter: 46 out of 50
epoch:  68
epoch:  69 val_f1:  0.8022296544035674 val_auroc:  0.876984126984127 val_auprc:  0.9194902367012234
EarlyStopping counter: 47 out of 50
epoch:  69
epoch:  70 val_f1:  0.8115942028985508 val_auroc:  0.8758680555555556 val_auprc:  0.9172408458733067
EarlyStopping counter: 48 out of 50
epoch:  70
epoch:  71 val_f1:  0.8102677351291666 val_auroc:  0.8767361111111112 val_auprc:  0.9198176566210015
EarlyStopping counter: 49 out of 50
epoch:  71
epoch:  72 val_f1:  0.8102677351291666 val_auroc:  0.8736359126984127 val_auprc:  0.9160626121128961
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  496.2259683609009
{'time_elapsed': [496.2259683609009], 'epoch': [71], 'fold': [4], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8102677351291666], 'auroc_test': [0.8736359126984127], 'auprc_test': [0.9160626121128961]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1280]           1,024
│    └─BatchNorm1d: 2-2                  [64, 256, 1280]           512
│    └─Tanh: 2-3                         [64, 256, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1278]           --
│    └─Dropout: 2-5                      [64, 256, 1278]           --
│    └─Flatten: 2-6                      [64, 327168]              --
│    └─Linear: 2-7                       [64, 1]                   327,169
==========================================================================================
Total params: 328,705
Trainable params: 328,705
Non-trainable params: 0
Total mult-adds (M): 104.86
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.54
Params size (MB): 1.31
Estimated Total Size (MB): 337.19
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_52', 'config': {'hidden_channels': [256], 'epochs': 500, 'kernel_size': 3, 'pool_kernel_size': 3, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6410589175718249 val_auroc:  0.676485027000491 val_auprc:  0.7760192842984499
epoch:  1
epoch:  2 val_f1:  0.34248666948793904 val_auroc:  0.6018654884634266 val_auprc:  0.7431095047570853
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6120686338629632 val_auroc:  0.6136475208640157 val_auprc:  0.7547024335274651
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6043044282266453 val_auroc:  0.665193912616593 val_auprc:  0.7956906471542609
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.5946295595102864 val_auroc:  0.7309769268532155 val_auprc:  0.8472370231251313
Validation loss improved to 1.243814
epoch:  5
epoch:  6 val_f1:  0.7326256806616418 val_auroc:  0.7616593028964163 val_auprc:  0.8825989445134841
Validation loss improved to 1.195096
epoch:  6
epoch:  7 val_f1:  0.7448635686045757 val_auroc:  0.7744231713303878 val_auprc:  0.8894869347003659
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.7745465218349855 val_auroc:  0.7803141875306824 val_auprc:  0.89430591190935
EarlyStopping counter: 2 out of 50
epoch:  8
epoch:  9 val_f1:  0.7617684906754855 val_auroc:  0.7812960235640647 val_auprc:  0.8946662181090338
EarlyStopping counter: 3 out of 50
epoch:  9
epoch:  10 val_f1:  0.7304528631430115 val_auroc:  0.7879234167893961 val_auprc:  0.9019950876016499
Validation loss improved to 1.125250
epoch:  10
epoch:  11 val_f1:  0.6663975251072785 val_auroc:  0.7935689739813452 val_auprc:  0.9048019728847051
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.675544391518161 val_auroc:  0.7945508100147275 val_auprc:  0.9061922981849648
Validation loss improved to 1.124578
epoch:  12
epoch:  13 val_f1:  0.7100860488080124 val_auroc:  0.7950417280314188 val_auprc:  0.9051853927873983
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7229061670449737 val_auroc:  0.7962690230731467 val_auprc:  0.9079730012604135
EarlyStopping counter: 2 out of 50
epoch:  14
epoch:  15 val_f1:  0.7712620601193464 val_auroc:  0.7974963181148749 val_auprc:  0.9083480514708236
EarlyStopping counter: 3 out of 50
epoch:  15
epoch:  16 val_f1:  0.7169009504644194 val_auroc:  0.8092783505154638 val_auprc:  0.9165693986004897
Validation loss improved to 1.098526
epoch:  16
epoch:  17 val_f1:  0.7725930260576229 val_auroc:  0.8026509572901326 val_auprc:  0.9116816030396298
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.7841726618705036 val_auroc:  0.8041237113402062 val_auprc:  0.9122196789924635
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7813819697019021 val_auroc:  0.8087874324987727 val_auprc:  0.9158393248782497
EarlyStopping counter: 3 out of 50
epoch:  19
epoch:  20 val_f1:  0.766354189375772 val_auroc:  0.8065783014236622 val_auprc:  0.9149227334904737
EarlyStopping counter: 4 out of 50
epoch:  20
epoch:  21 val_f1:  0.7583800901862243 val_auroc:  0.806823760432008 val_auprc:  0.9154434379371187
EarlyStopping counter: 5 out of 50
epoch:  21
epoch:  22 val_f1:  0.6963686193902022 val_auroc:  0.8087874324987727 val_auprc:  0.9151154426276715
EarlyStopping counter: 6 out of 50
epoch:  22
epoch:  23 val_f1:  0.7455074238481555 val_auroc:  0.8085419734904271 val_auprc:  0.9156605340558579
EarlyStopping counter: 7 out of 50
epoch:  23
epoch:  24 val_f1:  0.7455074238481555 val_auroc:  0.8087874324987727 val_auprc:  0.9152562461986754
EarlyStopping counter: 8 out of 50
epoch:  24
epoch:  25 val_f1:  0.7560320485424044 val_auroc:  0.8078055964653903 val_auprc:  0.9146633847191902
EarlyStopping counter: 9 out of 50
epoch:  25
epoch:  26 val_f1:  0.743431836172277 val_auroc:  0.8114874815905744 val_auprc:  0.9186209220592876
EarlyStopping counter: 10 out of 50
epoch:  26
epoch:  27 val_f1:  0.7500864926036699 val_auroc:  0.8092783505154639 val_auprc:  0.9154332470617095
EarlyStopping counter: 11 out of 50
epoch:  27
epoch:  28 val_f1:  0.7494347379239465 val_auroc:  0.8161512027491409 val_auprc:  0.9214109550519408
EarlyStopping counter: 12 out of 50
epoch:  28
epoch:  29 val_f1:  0.7633714058926586 val_auroc:  0.8053510063819341 val_auprc:  0.9135007881849859
EarlyStopping counter: 13 out of 50
epoch:  29
epoch:  30 val_f1:  0.7441671543148256 val_auroc:  0.8004418262150221 val_auprc:  0.9098702375077352
EarlyStopping counter: 14 out of 50
epoch:  30
epoch:  31 val_f1:  0.7560320485424044 val_auroc:  0.8119783996072656 val_auprc:  0.9184053255529279
EarlyStopping counter: 15 out of 50
epoch:  31
epoch:  32 val_f1:  0.7377691212466089 val_auroc:  0.8073146784486991 val_auprc:  0.9147316338171007
EarlyStopping counter: 16 out of 50
epoch:  32
epoch:  33 val_f1:  0.7494347379239465 val_auroc:  0.8078055964653903 val_auprc:  0.9160767000571811
EarlyStopping counter: 17 out of 50
epoch:  33
epoch:  34 val_f1:  0.7639705763479104 val_auroc:  0.8041237113402062 val_auprc:  0.9134710529883263
EarlyStopping counter: 18 out of 50
epoch:  34
epoch:  35 val_f1:  0.7473302173830908 val_auroc:  0.80166912125675 val_auprc:  0.912614042911039
EarlyStopping counter: 19 out of 50
epoch:  35
epoch:  36 val_f1:  0.7346891520614657 val_auroc:  0.7982326951399117 val_auprc:  0.9084105829614737
EarlyStopping counter: 20 out of 50
epoch:  36
epoch:  37 val_f1:  0.7299542184434271 val_auroc:  0.8038782523318606 val_auprc:  0.9135264125246989
EarlyStopping counter: 21 out of 50
epoch:  37
epoch:  38 val_f1:  0.7377691212466089 val_auroc:  0.8100147275405007 val_auprc:  0.9176623283813115
EarlyStopping counter: 22 out of 50
epoch:  38
epoch:  39 val_f1:  0.748656020238754 val_auroc:  0.8082965144820815 val_auprc:  0.9158769405219875
EarlyStopping counter: 23 out of 50
epoch:  39
epoch:  40 val_f1:  0.7249644134959412 val_auroc:  0.8087874324987727 val_auprc:  0.9166139303101423
EarlyStopping counter: 24 out of 50
epoch:  40
epoch:  41 val_f1:  0.7363119073255568 val_auroc:  0.8080510554737359 val_auprc:  0.9152792735734026
EarlyStopping counter: 25 out of 50
epoch:  41
epoch:  42 val_f1:  0.748656020238754 val_auroc:  0.8132056946489936 val_auprc:  0.918544910062862
EarlyStopping counter: 26 out of 50
epoch:  42
epoch:  43 val_f1:  0.717230470942395 val_auroc:  0.8122238586156112 val_auprc:  0.9171197040755974
EarlyStopping counter: 27 out of 50
epoch:  43
epoch:  44 val_f1:  0.7235944791518311 val_auroc:  0.8060873834069711 val_auprc:  0.9142729953197166
EarlyStopping counter: 28 out of 50
epoch:  44
epoch:  45 val_f1:  0.7567268683783295 val_auroc:  0.814187530682376 val_auprc:  0.9187091516048298
EarlyStopping counter: 29 out of 50
epoch:  45
epoch:  46 val_f1:  0.717230470942395 val_auroc:  0.8163966617574865 val_auprc:  0.9207568697941579
EarlyStopping counter: 30 out of 50
epoch:  46
epoch:  47 val_f1:  0.7553956834532374 val_auroc:  0.8053510063819341 val_auprc:  0.9129998679372205
EarlyStopping counter: 31 out of 50
epoch:  47
epoch:  48 val_f1:  0.7235944791518311 val_auroc:  0.8053510063819341 val_auprc:  0.9140874062128679
EarlyStopping counter: 32 out of 50
epoch:  48
epoch:  49 val_f1:  0.7402181480621955 val_auroc:  0.8097692685321551 val_auprc:  0.9161790691792562
EarlyStopping counter: 33 out of 50
epoch:  49
epoch:  50 val_f1:  0.7235944791518311 val_auroc:  0.8063328424153166 val_auprc:  0.9137185344705523
EarlyStopping counter: 34 out of 50
epoch:  50
epoch:  51 val_f1:  0.7363119073255568 val_auroc:  0.81173294059892 val_auprc:  0.9171604586701264
EarlyStopping counter: 35 out of 50
epoch:  51
epoch:  52 val_f1:  0.717230470942395 val_auroc:  0.8132056946489935 val_auprc:  0.9182949796660489
EarlyStopping counter: 36 out of 50
epoch:  52
epoch:  53 val_f1:  0.717230470942395 val_auroc:  0.8105056455571918 val_auprc:  0.9167650953323246
EarlyStopping counter: 37 out of 50
epoch:  53
epoch:  54 val_f1:  0.7235944791518311 val_auroc:  0.8075601374570447 val_auprc:  0.915010611625062
EarlyStopping counter: 38 out of 50
epoch:  54
epoch:  55 val_f1:  0.7299542184434271 val_auroc:  0.8080510554737359 val_auprc:  0.9149803144353502
EarlyStopping counter: 39 out of 50
epoch:  55
epoch:  56 val_f1:  0.7553956834532374 val_auroc:  0.8053510063819342 val_auprc:  0.9132439759636128
EarlyStopping counter: 40 out of 50
epoch:  56
epoch:  57 val_f1:  0.7617684906754855 val_auroc:  0.8136966126656848 val_auprc:  0.9190891979582088
EarlyStopping counter: 41 out of 50
epoch:  57
epoch:  58 val_f1:  0.7490302789770621 val_auroc:  0.8043691703485518 val_auprc:  0.9119389712229573
EarlyStopping counter: 42 out of 50
epoch:  58
epoch:  59 val_f1:  0.7249644134959412 val_auroc:  0.8154148257241041 val_auprc:  0.9200725970002901
EarlyStopping counter: 43 out of 50
epoch:  59
epoch:  60 val_f1:  0.7441671543148256 val_auroc:  0.8132056946489936 val_auprc:  0.9173984036784772
EarlyStopping counter: 44 out of 50
epoch:  60
epoch:  61 val_f1:  0.7313689473952751 val_auroc:  0.8122238586156112 val_auprc:  0.9178460624731708
EarlyStopping counter: 45 out of 50
epoch:  61
epoch:  62 val_f1:  0.7617684906754855 val_auroc:  0.8028964162984782 val_auprc:  0.9121002773557076
EarlyStopping counter: 46 out of 50
epoch:  62
epoch:  63 val_f1:  0.7426698176342648 val_auroc:  0.8031418753068238 val_auprc:  0.9121022294185658
EarlyStopping counter: 47 out of 50
epoch:  63
epoch:  64 val_f1:  0.7363119073255568 val_auroc:  0.8092783505154639 val_auprc:  0.9156448573739275
EarlyStopping counter: 48 out of 50
epoch:  64
epoch:  65 val_f1:  0.7313689473952751 val_auroc:  0.8127147766323024 val_auprc:  0.9178499788393822
EarlyStopping counter: 49 out of 50
epoch:  65
epoch:  66 val_f1:  0.7377691212466089 val_auroc:  0.8090328915071183 val_auprc:  0.915249186281298
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  67.00481796264648
{'time_elapsed': [67.00481796264648], 'epoch': [65], 'fold': [0], 'f1_train': [0.9946078283340751], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7377691212466089], 'auroc_test': [0.8090328915071183], 'auprc_test': [0.915249186281298]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 427]            1,024
│    └─BatchNorm1d: 2-2                  [64, 256, 427]            512
│    └─Tanh: 2-3                         [64, 256, 427]            --
│    └─MaxPool1d: 2-4                    [64, 256, 142]            --
│    └─Dropout: 2-5                      [64, 256, 142]            --
│    └─Flatten: 2-6                      [64, 36352]               --
│    └─Linear: 2-7                       [64, 1]                   36,353
==========================================================================================
Total params: 37,889
Trainable params: 37,889
Non-trainable params: 0
Total mult-adds (M): 30.34
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 111.94
Params size (MB): 0.15
Estimated Total Size (MB): 112.42
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6667173976100353 val_auroc:  0.6161021109474718 val_auprc:  0.7533172511444437
epoch:  1
epoch:  2 val_f1:  0.3820744151876506 val_auroc:  0.6516936671575847 val_auprc:  0.7449481171643786
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6135600610420754 val_auroc:  0.6686303387334315 val_auprc:  0.756475737870105
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5387163953048087 val_auroc:  0.6828669612174767 val_auprc:  0.7602464874658386
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.7142089711496735 val_auroc:  0.711340206185567 val_auprc:  0.7815065457311772
Validation loss improved to 1.223428
epoch:  5
epoch:  6 val_f1:  0.7648187281552264 val_auroc:  0.740058910162003 val_auprc:  0.8220418106477011
Validation loss improved to 1.111515
epoch:  6
epoch:  7 val_f1:  0.7349308245711123 val_auroc:  0.7555228276877761 val_auprc:  0.8629545408657314
Validation loss improved to 1.078998
epoch:  7
epoch:  8 val_f1:  0.7337314237416728 val_auroc:  0.7690230731467845 val_auprc:  0.8888734026667975
Validation loss improved to 1.044857
epoch:  8
epoch:  9 val_f1:  0.6893510131556864 val_auroc:  0.7724594992636229 val_auprc:  0.8950871841353965
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.6882360925909661 val_auroc:  0.7771232204221895 val_auprc:  0.9005512380348027
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.7304528631430115 val_auroc:  0.7827687776141384 val_auprc:  0.9049480467708844
Validation loss improved to 1.016680
epoch:  11
epoch:  12 val_f1:  0.7032425848040964 val_auroc:  0.7933235149729996 val_auprc:  0.9094785499695598
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7100860488080124 val_auroc:  0.7933235149729996 val_auprc:  0.9110018805952753
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.7169009504644194 val_auroc:  0.791850760922926 val_auprc:  0.9090488803084719
Validation loss improved to 1.010506
epoch:  14
epoch:  15 val_f1:  0.7617596949267598 val_auroc:  0.7957781050564555 val_auprc:  0.9116199205164655
Validation loss improved to 0.977603
epoch:  15
epoch:  16 val_f1:  0.7295632867761842 val_auroc:  0.7987236131566029 val_auprc:  0.9137364101780494
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7236892364125374 val_auroc:  0.7984781541482573 val_auprc:  0.9130447340613778
EarlyStopping counter: 2 out of 50
epoch:  17
epoch:  18 val_f1:  0.7304528631430115 val_auroc:  0.7952871870397643 val_auprc:  0.9115433407197673
EarlyStopping counter: 3 out of 50
epoch:  18
epoch:  19 val_f1:  0.7096759374109908 val_auroc:  0.7992145311732941 val_auprc:  0.9139880307353208
EarlyStopping counter: 4 out of 50
epoch:  19
epoch:  20 val_f1:  0.7375047745919104 val_auroc:  0.7950417280314187 val_auprc:  0.9113940775664335
EarlyStopping counter: 5 out of 50
epoch:  20
epoch:  21 val_f1:  0.743914028278071 val_auroc:  0.7952871870397643 val_auprc:  0.9108948394563634
EarlyStopping counter: 6 out of 50
epoch:  21
epoch:  22 val_f1:  0.7519437633413868 val_auroc:  0.8026509572901325 val_auprc:  0.9144597616557507
EarlyStopping counter: 7 out of 50
epoch:  22
epoch:  23 val_f1:  0.7542604103291037 val_auroc:  0.8043691703485518 val_auprc:  0.9148018117139691
EarlyStopping counter: 8 out of 50
epoch:  23
epoch:  24 val_f1:  0.7346924658075737 val_auroc:  0.8038782523318606 val_auprc:  0.914590857596187
EarlyStopping counter: 9 out of 50
epoch:  24
epoch:  25 val_f1:  0.7328919440906961 val_auroc:  0.8038782523318606 val_auprc:  0.9136596867296307
EarlyStopping counter: 10 out of 50
epoch:  25
epoch:  26 val_f1:  0.7346924658075737 val_auroc:  0.8046146293568974 val_auprc:  0.9155568878015703
EarlyStopping counter: 11 out of 50
epoch:  26
epoch:  27 val_f1:  0.7346924658075737 val_auroc:  0.8028964162984781 val_auprc:  0.9137569677233577
EarlyStopping counter: 12 out of 50
epoch:  27
epoch:  28 val_f1:  0.6882360925909661 val_auroc:  0.8058419243986255 val_auprc:  0.9167084470389213
EarlyStopping counter: 13 out of 50
epoch:  28
epoch:  29 val_f1:  0.7170452552783244 val_auroc:  0.8033873343151693 val_auprc:  0.9139111650526217
EarlyStopping counter: 14 out of 50
epoch:  29
epoch:  30 val_f1:  0.7223183251151889 val_auroc:  0.8075601374570447 val_auprc:  0.9166364830731675
EarlyStopping counter: 15 out of 50
epoch:  30
epoch:  31 val_f1:  0.7289242247644242 val_auroc:  0.8087874324987727 val_auprc:  0.9172187277943683
Validation loss improved to 0.977336
epoch:  31
epoch:  32 val_f1:  0.7607703458551531 val_auroc:  0.8058419243986255 val_auprc:  0.9149339588198849
EarlyStopping counter: 1 out of 50
epoch:  32
epoch:  33 val_f1:  0.72389147505525 val_auroc:  0.804860088365243 val_auprc:  0.9158669217224984
EarlyStopping counter: 2 out of 50
epoch:  33
epoch:  34 val_f1:  0.7371937993371881 val_auroc:  0.806823760432008 val_auprc:  0.915900819143466
EarlyStopping counter: 3 out of 50
epoch:  34
epoch:  35 val_f1:  0.7169009504644194 val_auroc:  0.8080510554737359 val_auprc:  0.9167706671735203
EarlyStopping counter: 4 out of 50
epoch:  35
epoch:  36 val_f1:  0.7542604103291037 val_auroc:  0.8019145802650958 val_auprc:  0.9123789804353754
EarlyStopping counter: 5 out of 50
epoch:  36
epoch:  37 val_f1:  0.7519437633413868 val_auroc:  0.8080510554737358 val_auprc:  0.9149235798385664
EarlyStopping counter: 6 out of 50
epoch:  37
epoch:  38 val_f1:  0.7448635686045757 val_auroc:  0.8053510063819342 val_auprc:  0.9121065924585965
EarlyStopping counter: 7 out of 50
epoch:  38
epoch:  39 val_f1:  0.7386752666832053 val_auroc:  0.8068237604320079 val_auprc:  0.9125099926317958
EarlyStopping counter: 8 out of 50
epoch:  39
epoch:  40 val_f1:  0.735514445586388 val_auroc:  0.8043691703485518 val_auprc:  0.9135127071001525
EarlyStopping counter: 9 out of 50
epoch:  40
epoch:  41 val_f1:  0.7596459003010357 val_auroc:  0.8063328424153166 val_auprc:  0.9144055980426369
EarlyStopping counter: 10 out of 50
epoch:  41
epoch:  42 val_f1:  0.7661184054361647 val_auroc:  0.8078055964653904 val_auprc:  0.9141973160765746
EarlyStopping counter: 11 out of 50
epoch:  42
epoch:  43 val_f1:  0.7272357092755477 val_auroc:  0.8082965144820815 val_auprc:  0.9147568706772281
EarlyStopping counter: 12 out of 50
epoch:  43
epoch:  44 val_f1:  0.7028070029525513 val_auroc:  0.8063328424153167 val_auprc:  0.9146435119143321
EarlyStopping counter: 13 out of 50
epoch:  44
epoch:  45 val_f1:  0.7337314237416728 val_auroc:  0.8090328915071183 val_auprc:  0.9148702563010681
EarlyStopping counter: 14 out of 50
epoch:  45
epoch:  46 val_f1:  0.7536606851900262 val_auroc:  0.8085419734904271 val_auprc:  0.9142099826725777
EarlyStopping counter: 15 out of 50
epoch:  46
epoch:  47 val_f1:  0.7531731915989216 val_auroc:  0.8065783014236623 val_auprc:  0.9131112768279187
EarlyStopping counter: 16 out of 50
epoch:  47
epoch:  48 val_f1:  0.7477455593342162 val_auroc:  0.8063328424153167 val_auprc:  0.9138696193296921
EarlyStopping counter: 17 out of 50
epoch:  48
epoch:  49 val_f1:  0.7428255465713769 val_auroc:  0.8075601374570447 val_auprc:  0.9139077031477321
EarlyStopping counter: 18 out of 50
epoch:  49
epoch:  50 val_f1:  0.7473302173830908 val_auroc:  0.8095238095238095 val_auprc:  0.9128217396265536
EarlyStopping counter: 19 out of 50
epoch:  50
epoch:  51 val_f1:  0.7519437633413868 val_auroc:  0.8080510554737358 val_auprc:  0.9130686588129393
EarlyStopping counter: 20 out of 50
epoch:  51
epoch:  52 val_f1:  0.7727225509205256 val_auroc:  0.8087874324987726 val_auprc:  0.9131244552390847
EarlyStopping counter: 21 out of 50
epoch:  52
epoch:  53 val_f1:  0.76000113614692 val_auroc:  0.8073146784486991 val_auprc:  0.9121094157013453
EarlyStopping counter: 22 out of 50
epoch:  53
epoch:  54 val_f1:  0.7483101088021195 val_auroc:  0.8041237113402062 val_auprc:  0.9101705253581918
EarlyStopping counter: 23 out of 50
epoch:  54
epoch:  55 val_f1:  0.742136387976997 val_auroc:  0.8055964653902797 val_auprc:  0.9095228076210375
EarlyStopping counter: 24 out of 50
epoch:  55
epoch:  56 val_f1:  0.766354189375772 val_auroc:  0.8031418753068238 val_auprc:  0.9108759227148879
EarlyStopping counter: 25 out of 50
epoch:  56
epoch:  57 val_f1:  0.7473302173830908 val_auroc:  0.8024054982817869 val_auprc:  0.9102047326425814
EarlyStopping counter: 26 out of 50
epoch:  57
epoch:  58 val_f1:  0.7410071942446043 val_auroc:  0.801178203240059 val_auprc:  0.910277258641445
EarlyStopping counter: 27 out of 50
epoch:  58
epoch:  59 val_f1:  0.7473302173830908 val_auroc:  0.8024054982817869 val_auprc:  0.9106040806618401
EarlyStopping counter: 28 out of 50
epoch:  59
epoch:  60 val_f1:  0.7410071942446043 val_auroc:  0.8021600392734413 val_auprc:  0.9097291531148415
EarlyStopping counter: 29 out of 50
epoch:  60
epoch:  61 val_f1:  0.7337314237416728 val_auroc:  0.8001963672066765 val_auprc:  0.9096527095677149
EarlyStopping counter: 30 out of 50
epoch:  61
epoch:  62 val_f1:  0.7363119073255568 val_auroc:  0.801178203240059 val_auprc:  0.9081580110451648
EarlyStopping counter: 31 out of 50
epoch:  62
epoch:  63 val_f1:  0.7473302173830908 val_auroc:  0.8001963672066765 val_auprc:  0.9070592821699173
EarlyStopping counter: 32 out of 50
epoch:  63
epoch:  64 val_f1:  0.7770871369605723 val_auroc:  0.7997054491899853 val_auprc:  0.9063138993149388
EarlyStopping counter: 33 out of 50
epoch:  64
epoch:  65 val_f1:  0.7598715939807772 val_auroc:  0.7997054491899853 val_auprc:  0.9065957641493778
EarlyStopping counter: 34 out of 50
epoch:  65
epoch:  66 val_f1:  0.76000113614692 val_auroc:  0.7977417771232205 val_auprc:  0.9067933829313632
EarlyStopping counter: 35 out of 50
epoch:  66
epoch:  67 val_f1:  0.7707245329923307 val_auroc:  0.8004418262150221 val_auprc:  0.9079086158936496
EarlyStopping counter: 36 out of 50
epoch:  67
epoch:  68 val_f1:  0.7283736963917239 val_auroc:  0.8021600392734413 val_auprc:  0.9095473739677817
EarlyStopping counter: 37 out of 50
epoch:  68
epoch:  69 val_f1:  0.7363119073255568 val_auroc:  0.8006872852233676 val_auprc:  0.9089423260424179
EarlyStopping counter: 38 out of 50
epoch:  69
epoch:  70 val_f1:  0.7299542184434271 val_auroc:  0.797987236131566 val_auprc:  0.9062305069363306
EarlyStopping counter: 39 out of 50
epoch:  70
epoch:  71 val_f1:  0.7473302173830908 val_auroc:  0.8006872852233676 val_auprc:  0.9062611064186905
EarlyStopping counter: 40 out of 50
epoch:  71
epoch:  72 val_f1:  0.7770871369605723 val_auroc:  0.8001963672066765 val_auprc:  0.9052942176984244
EarlyStopping counter: 41 out of 50
epoch:  72
epoch:  73 val_f1:  0.7536606851900262 val_auroc:  0.7977417771232205 val_auprc:  0.9052680460358277
EarlyStopping counter: 42 out of 50
epoch:  73
epoch:  74 val_f1:  0.7536606851900262 val_auroc:  0.7994599901816396 val_auprc:  0.9066203424721642
EarlyStopping counter: 43 out of 50
epoch:  74
epoch:  75 val_f1:  0.7791090204759269 val_auroc:  0.7984781541482572 val_auprc:  0.9054991954637173
EarlyStopping counter: 44 out of 50
epoch:  75
epoch:  76 val_f1:  0.7770871369605723 val_auroc:  0.7984781541482572 val_auprc:  0.9050382211541027
EarlyStopping counter: 45 out of 50
epoch:  76
epoch:  77 val_f1:  0.7707245329923307 val_auroc:  0.7982326951399117 val_auprc:  0.905240117492586
EarlyStopping counter: 46 out of 50
epoch:  77
epoch:  78 val_f1:  0.7770871369605723 val_auroc:  0.7999509081983309 val_auprc:  0.905313133285203
EarlyStopping counter: 47 out of 50
epoch:  78
epoch:  79 val_f1:  0.7536606851900262 val_auroc:  0.7974963181148749 val_auprc:  0.9061138624340401
EarlyStopping counter: 48 out of 50
epoch:  79
epoch:  80 val_f1:  0.766354189375772 val_auroc:  0.7970054000981835 val_auprc:  0.9053874270334178
EarlyStopping counter: 49 out of 50
epoch:  80
epoch:  81 val_f1:  0.7685409504908388 val_auroc:  0.7994599901816397 val_auprc:  0.9054411835787202
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  78.30309295654297
{'time_elapsed': [78.30309295654297], 'epoch': [80], 'fold': [1], 'f1_train': [0.9981996872393208], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7685409504908388], 'auroc_test': [0.7994599901816397], 'auprc_test': [0.9054411835787202]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 427]            1,024
│    └─BatchNorm1d: 2-2                  [64, 256, 427]            512
│    └─Tanh: 2-3                         [64, 256, 427]            --
│    └─MaxPool1d: 2-4                    [64, 256, 142]            --
│    └─Dropout: 2-5                      [64, 256, 142]            --
│    └─Flatten: 2-6                      [64, 36352]               --
│    └─Linear: 2-7                       [64, 1]                   36,353
==========================================================================================
Total params: 37,889
Trainable params: 37,889
Non-trainable params: 0
Total mult-adds (M): 30.34
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 111.94
Params size (MB): 0.15
Estimated Total Size (MB): 112.42
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.4231103510096066 val_auroc:  0.6188021600392735 val_auprc:  0.8218961833969323
epoch:  1
epoch:  2 val_f1:  0.3817806514282245 val_auroc:  0.7047128129602357 val_auprc:  0.8471548607077651
Validation loss improved to 1.366993
epoch:  2
epoch:  3 val_f1:  0.7272357092755477 val_auroc:  0.7385861561119292 val_auprc:  0.8663216456334073
Validation loss improved to 1.050255
epoch:  3
epoch:  4 val_f1:  0.7048707252685248 val_auroc:  0.7614138438880707 val_auprc:  0.8743321826524895
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.5238035658429778 val_auroc:  0.7444771723122239 val_auprc:  0.8555750780003939
EarlyStopping counter: 2 out of 50
epoch:  5
epoch:  6 val_f1:  0.7304528631430115 val_auroc:  0.7393225331369662 val_auprc:  0.8558217658204992
EarlyStopping counter: 3 out of 50
epoch:  6
epoch:  7 val_f1:  0.6758292290898464 val_auroc:  0.742513500245459 val_auprc:  0.8599787624592953
EarlyStopping counter: 4 out of 50
epoch:  7
epoch:  8 val_f1:  0.7304528631430115 val_auroc:  0.7493863524791361 val_auprc:  0.8685164630992869
EarlyStopping counter: 5 out of 50
epoch:  8
epoch:  9 val_f1:  0.6237171971681137 val_auroc:  0.7420225822287678 val_auprc:  0.8608959901379694
EarlyStopping counter: 6 out of 50
epoch:  9
epoch:  10 val_f1:  0.608607850561656 val_auroc:  0.7457044673539519 val_auprc:  0.8591795372761537
EarlyStopping counter: 7 out of 50
epoch:  10
epoch:  11 val_f1:  0.6893510131556864 val_auroc:  0.7574864997545411 val_auprc:  0.8650498813705907
EarlyStopping counter: 8 out of 50
epoch:  11
epoch:  12 val_f1:  0.7236892364125374 val_auroc:  0.7631320569464899 val_auprc:  0.8674465909640747
EarlyStopping counter: 9 out of 50
epoch:  12
epoch:  13 val_f1:  0.7725930260576229 val_auroc:  0.7707412862052038 val_auprc:  0.8735763831464312
EarlyStopping counter: 10 out of 50
epoch:  13
epoch:  14 val_f1:  0.7349308245711123 val_auroc:  0.7690230731467845 val_auprc:  0.872705217475787
EarlyStopping counter: 11 out of 50
epoch:  14
epoch:  15 val_f1:  0.7428255465713769 val_auroc:  0.7653411880216004 val_auprc:  0.8707877004893257
EarlyStopping counter: 12 out of 50
epoch:  15
epoch:  16 val_f1:  0.6057912921222274 val_auroc:  0.7577319587628867 val_auprc:  0.864560231547504
EarlyStopping counter: 13 out of 50
epoch:  16
epoch:  17 val_f1:  0.6149632934836883 val_auroc:  0.7650957290132548 val_auprc:  0.8707250995364615
EarlyStopping counter: 14 out of 50
epoch:  17
epoch:  18 val_f1:  0.6538912937446653 val_auroc:  0.7579774177712322 val_auprc:  0.8652439925200202
EarlyStopping counter: 15 out of 50
epoch:  18
epoch:  19 val_f1:  0.7391701372600277 val_auroc:  0.7771232204221895 val_auprc:  0.8788050686530369
EarlyStopping counter: 16 out of 50
epoch:  19
epoch:  20 val_f1:  0.7349308245711123 val_auroc:  0.7746686303387335 val_auprc:  0.8753517990605779
EarlyStopping counter: 17 out of 50
epoch:  20
epoch:  21 val_f1:  0.743431836172277 val_auroc:  0.772459499263623 val_auprc:  0.8737330558686678
EarlyStopping counter: 18 out of 50
epoch:  21
epoch:  22 val_f1:  0.682026026688228 val_auroc:  0.7648502700049092 val_auprc:  0.8710121545494016
EarlyStopping counter: 19 out of 50
epoch:  22
epoch:  23 val_f1:  0.7371484630477437 val_auroc:  0.7763868433971527 val_auprc:  0.8777271930955237
EarlyStopping counter: 20 out of 50
epoch:  23
epoch:  24 val_f1:  0.7238240177089098 val_auroc:  0.7727049582719686 val_auprc:  0.8762753921159576
EarlyStopping counter: 21 out of 50
epoch:  24
epoch:  25 val_f1:  0.7607703458551531 val_auroc:  0.7751595483554247 val_auprc:  0.8804001189556794
EarlyStopping counter: 22 out of 50
epoch:  25
epoch:  26 val_f1:  0.7362024088594293 val_auroc:  0.7690230731467845 val_auprc:  0.8757643596891734
EarlyStopping counter: 23 out of 50
epoch:  26
epoch:  27 val_f1:  0.7420910227448273 val_auroc:  0.7709867452135494 val_auprc:  0.8759842426175529
EarlyStopping counter: 24 out of 50
epoch:  27
epoch:  28 val_f1:  0.7607703458551531 val_auroc:  0.7761413843888071 val_auprc:  0.8808474308024644
EarlyStopping counter: 25 out of 50
epoch:  28
epoch:  29 val_f1:  0.7617596949267598 val_auroc:  0.7803141875306824 val_auprc:  0.8847159213029648
EarlyStopping counter: 26 out of 50
epoch:  29
epoch:  30 val_f1:  0.7420910227448273 val_auroc:  0.771232204221895 val_auprc:  0.8781937735895597
EarlyStopping counter: 27 out of 50
epoch:  30
epoch:  31 val_f1:  0.7202047592695074 val_auroc:  0.7830142366224841 val_auprc:  0.8872668822579708
EarlyStopping counter: 28 out of 50
epoch:  31
epoch:  32 val_f1:  0.7420910227448273 val_auroc:  0.7744231713303878 val_auprc:  0.8830273009563381
EarlyStopping counter: 29 out of 50
epoch:  32
epoch:  33 val_f1:  0.748656020238754 val_auroc:  0.7751595483554247 val_auprc:  0.8815985675043398
EarlyStopping counter: 30 out of 50
epoch:  33
epoch:  34 val_f1:  0.7246795893300292 val_auroc:  0.7854688267059402 val_auprc:  0.8898944837247055
EarlyStopping counter: 31 out of 50
epoch:  34
epoch:  35 val_f1:  0.7552115339652351 val_auroc:  0.7741777123220422 val_auprc:  0.8782886989359739
EarlyStopping counter: 32 out of 50
epoch:  35
epoch:  36 val_f1:  0.7163649790827238 val_auroc:  0.7820324005891017 val_auprc:  0.887546157178938
EarlyStopping counter: 33 out of 50
epoch:  36
epoch:  37 val_f1:  0.7122302158273381 val_auroc:  0.7741777123220422 val_auprc:  0.8800690647677707
EarlyStopping counter: 34 out of 50
epoch:  37
epoch:  38 val_f1:  0.7184536707983012 val_auroc:  0.7781050564555719 val_auprc:  0.8828693651628192
EarlyStopping counter: 35 out of 50
epoch:  38
epoch:  39 val_f1:  0.7018195933946583 val_auroc:  0.7739322533136966 val_auprc:  0.8777376813909592
EarlyStopping counter: 36 out of 50
epoch:  39
epoch:  40 val_f1:  0.7617596949267598 val_auroc:  0.772459499263623 val_auprc:  0.8824713048634361
EarlyStopping counter: 37 out of 50
epoch:  40
epoch:  41 val_f1:  0.7079427367197151 val_auroc:  0.7736867943053509 val_auprc:  0.8775255023181499
EarlyStopping counter: 38 out of 50
epoch:  41
epoch:  42 val_f1:  0.7101890414000308 val_auroc:  0.7783505154639175 val_auprc:  0.8846184338543972
EarlyStopping counter: 39 out of 50
epoch:  42
epoch:  43 val_f1:  0.6956984934700323 val_auroc:  0.7702503681885126 val_auprc:  0.8731339137202105
EarlyStopping counter: 40 out of 50
epoch:  43
epoch:  44 val_f1:  0.6956984934700323 val_auroc:  0.773686794305351 val_auprc:  0.8827742805014632
EarlyStopping counter: 41 out of 50
epoch:  44
epoch:  45 val_f1:  0.7079427367197151 val_auroc:  0.7717231222385862 val_auprc:  0.8758166248045587
EarlyStopping counter: 42 out of 50
epoch:  45
epoch:  46 val_f1:  0.7060068982302729 val_auroc:  0.7731958762886598 val_auprc:  0.8820973838422589
EarlyStopping counter: 43 out of 50
epoch:  46
epoch:  47 val_f1:  0.7079427367197151 val_auroc:  0.773686794305351 val_auprc:  0.8789973693481234
EarlyStopping counter: 44 out of 50
epoch:  47
epoch:  48 val_f1:  0.7060068982302729 val_auroc:  0.7727049582719686 val_auprc:  0.8777058396829007
EarlyStopping counter: 45 out of 50
epoch:  48
epoch:  49 val_f1:  0.7466980132583976 val_auroc:  0.7756504663721158 val_auprc:  0.8844944823486859
EarlyStopping counter: 46 out of 50
epoch:  49
epoch:  50 val_f1:  0.7060068982302729 val_auroc:  0.7658321060382915 val_auprc:  0.8720069130780758
EarlyStopping counter: 47 out of 50
epoch:  50
epoch:  51 val_f1:  0.7060068982302729 val_auroc:  0.7707412862052037 val_auprc:  0.8796123466862015
EarlyStopping counter: 48 out of 50
epoch:  51
epoch:  52 val_f1:  0.7163649790827238 val_auroc:  0.7704958271968582 val_auprc:  0.8784678938194411
EarlyStopping counter: 49 out of 50
epoch:  52
epoch:  53 val_f1:  0.7287333672277241 val_auroc:  0.7785959744722631 val_auprc:  0.8841001322943182
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  51.88147234916687
{'time_elapsed': [51.88147234916687], 'epoch': [52], 'fold': [2], 'f1_train': [0.9803203167663946], 'auroc_train': [0.9985590336327682], 'auprc_train': [0.9993845836708904], 'f1_test': [0.7287333672277241], 'auroc_test': [0.7785959744722631], 'auprc_test': [0.8841001322943182]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 427]            1,024
│    └─BatchNorm1d: 2-2                  [64, 256, 427]            512
│    └─Tanh: 2-3                         [64, 256, 427]            --
│    └─MaxPool1d: 2-4                    [64, 256, 142]            --
│    └─Dropout: 2-5                      [64, 256, 142]            --
│    └─Flatten: 2-6                      [64, 36352]               --
│    └─Linear: 2-7                       [64, 1]                   36,353
==========================================================================================
Total params: 37,889
Trainable params: 37,889
Non-trainable params: 0
Total mult-adds (M): 30.34
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 111.94
Params size (MB): 0.15
Estimated Total Size (MB): 112.42
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5961515781069973 val_auroc:  0.6928294573643411 val_auprc:  0.8480917976718627
epoch:  1
epoch:  2 val_f1:  0.5913220359263525 val_auroc:  0.7347383720930232 val_auprc:  0.8254217263512197
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.7219264716637606 val_auroc:  0.7531492248062015 val_auprc:  0.8366970925385977
Validation loss improved to 1.017827
epoch:  3
epoch:  4 val_f1:  0.7080547346801063 val_auroc:  0.782703488372093 val_auprc:  0.8664324368641421
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.7267015342626987 val_auroc:  0.8103197674418603 val_auprc:  0.8968158775730433
Validation loss improved to 0.959302
epoch:  5
epoch:  6 val_f1:  0.7436964485493495 val_auroc:  0.815406976744186 val_auprc:  0.9138481514146085
Validation loss improved to 0.923316
epoch:  6
epoch:  7 val_f1:  0.7292114619704269 val_auroc:  0.8166182170542636 val_auprc:  0.9189233537923389
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.7768458491633659 val_auroc:  0.8195251937984495 val_auprc:  0.9189404980200574
Validation loss improved to 0.862581
epoch:  8
epoch:  9 val_f1:  0.7489893984794112 val_auroc:  0.8234011627906976 val_auprc:  0.9184101849986646
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7329053680132817 val_auroc:  0.8255813953488371 val_auprc:  0.9195071502927445
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.7695564219015847 val_auroc:  0.8248546511627907 val_auprc:  0.9200234489138949
Validation loss improved to 0.837890
epoch:  11
epoch:  12 val_f1:  0.7507862900729332 val_auroc:  0.8263081395348837 val_auprc:  0.9223264683654867
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7724509753899008 val_auroc:  0.8294573643410853 val_auprc:  0.9228892928626546
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.7414744243025527 val_auroc:  0.8311531007751938 val_auprc:  0.924246118730495
EarlyStopping counter: 3 out of 50
epoch:  14
epoch:  15 val_f1:  0.7776763243674784 val_auroc:  0.8338178294573643 val_auprc:  0.9257029036120221
Validation loss improved to 0.823551
epoch:  15
epoch:  16 val_f1:  0.7368544189039011 val_auroc:  0.8352713178294573 val_auprc:  0.9289705122608789
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7789671954250403 val_auroc:  0.8338178294573644 val_auprc:  0.9275139703822104
Validation loss improved to 0.808342
epoch:  17
epoch:  18 val_f1:  0.7776763243674784 val_auroc:  0.8301841085271318 val_auprc:  0.9257963053764009
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7495479552187128 val_auroc:  0.8304263565891473 val_auprc:  0.9273520332533723
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7562299212484351 val_auroc:  0.8338178294573643 val_auprc:  0.9287151936746361
Validation loss improved to 0.778751
epoch:  20
epoch:  21 val_f1:  0.7906801532257888 val_auroc:  0.8386627906976744 val_auprc:  0.9301707449414514
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7854893118997625 val_auroc:  0.8384205426356589 val_auprc:  0.9305201114499658
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.7711885993597467 val_auroc:  0.8432655038759689 val_auprc:  0.9324576692400546
EarlyStopping counter: 3 out of 50
epoch:  23
epoch:  24 val_f1:  0.7710202043822609 val_auroc:  0.8430232558139535 val_auprc:  0.9310926755573521
EarlyStopping counter: 4 out of 50
epoch:  24
epoch:  25 val_f1:  0.7997900244397783 val_auroc:  0.842296511627907 val_auprc:  0.9332280594790157
Validation loss improved to 0.772955
epoch:  25
epoch:  26 val_f1:  0.7892012988311853 val_auroc:  0.8459302325581396 val_auprc:  0.9342030311429845
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7932273763653603 val_auroc:  0.8439922480620156 val_auprc:  0.934497600735212
Validation loss improved to 0.769843
epoch:  27
epoch:  28 val_f1:  0.792019787311512 val_auroc:  0.84859496124031 val_auprc:  0.9367010684150472
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.7841726618705036 val_auroc:  0.8519864341085271 val_auprc:  0.9377827207199303
Validation loss improved to 0.766048
epoch:  29
epoch:  30 val_f1:  0.7866727894280321 val_auroc:  0.8493217054263565 val_auprc:  0.9378637883658227
Validation loss improved to 0.744086
epoch:  30
epoch:  31 val_f1:  0.7892012988311853 val_auroc:  0.8517441860465116 val_auprc:  0.9384809142953807
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.792019787311512 val_auroc:  0.8594961240310077 val_auprc:  0.9416195228200743
EarlyStopping counter: 2 out of 50
epoch:  32
epoch:  33 val_f1:  0.7801238118631262 val_auroc:  0.8544089147286821 val_auprc:  0.9402659256037409
Validation loss improved to 0.731927
epoch:  33
epoch:  34 val_f1:  0.792019787311512 val_auroc:  0.8575581395348837 val_auprc:  0.94187685836156
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.792019787311512 val_auroc:  0.8565891472868218 val_auprc:  0.9408490750926746
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.7932273763653603 val_auroc:  0.8573158914728682 val_auprc:  0.9411346999421015
EarlyStopping counter: 3 out of 50
epoch:  36
epoch:  37 val_f1:  0.7877294237541244 val_auroc:  0.8628875968992248 val_auprc:  0.9449629811528704
Validation loss improved to 0.719780
epoch:  37
epoch:  38 val_f1:  0.776244301724119 val_auroc:  0.8667635658914729 val_auprc:  0.9450731613631649
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.794309372388086 val_auroc:  0.8631298449612403 val_auprc:  0.943998032600334
Validation loss improved to 0.714415
epoch:  39
epoch:  40 val_f1:  0.7901923359271766 val_auroc:  0.8648255813953488 val_auprc:  0.9455097012502864
Validation loss improved to 0.700460
epoch:  40
epoch:  41 val_f1:  0.7961192047225032 val_auroc:  0.8645833333333334 val_auprc:  0.9452374074726834
EarlyStopping counter: 1 out of 50
epoch:  41
epoch:  42 val_f1:  0.8074875573056803 val_auroc:  0.8691860465116279 val_auprc:  0.9471871344054773
EarlyStopping counter: 2 out of 50
epoch:  42
epoch:  43 val_f1:  0.8008946034661633 val_auroc:  0.872093023255814 val_auprc:  0.948170369901773
EarlyStopping counter: 3 out of 50
epoch:  43
epoch:  44 val_f1:  0.8008946034661633 val_auroc:  0.872093023255814 val_auprc:  0.9476672465143998
EarlyStopping counter: 4 out of 50
epoch:  44
epoch:  45 val_f1:  0.7886649052635782 val_auroc:  0.872093023255814 val_auprc:  0.9486517715129544
Validation loss improved to 0.694863
epoch:  45
epoch:  46 val_f1:  0.794309372388086 val_auroc:  0.873546511627907 val_auprc:  0.9486371093491872
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.7985611510791367 val_auroc:  0.875 val_auprc:  0.9484633087592105
EarlyStopping counter: 2 out of 50
epoch:  47
epoch:  48 val_f1:  0.8008946034661633 val_auroc:  0.8742732558139533 val_auprc:  0.9487370861990834
EarlyStopping counter: 3 out of 50
epoch:  48
epoch:  49 val_f1:  0.7877294237541244 val_auroc:  0.8762112403100776 val_auprc:  0.9496647432280507
EarlyStopping counter: 4 out of 50
epoch:  49
epoch:  50 val_f1:  0.8018807955038493 val_auroc:  0.877906976744186 val_auprc:  0.9505995276286616
Validation loss improved to 0.694728
epoch:  50
epoch:  51 val_f1:  0.7997900244397783 val_auroc:  0.8757267441860465 val_auprc:  0.9492496898901245
EarlyStopping counter: 1 out of 50
epoch:  51
epoch:  52 val_f1:  0.7906801532257888 val_auroc:  0.875968992248062 val_auprc:  0.9493455343532176
EarlyStopping counter: 2 out of 50
epoch:  52
epoch:  53 val_f1:  0.7985611510791367 val_auroc:  0.876937984496124 val_auprc:  0.9493661562869774
EarlyStopping counter: 3 out of 50
epoch:  53
epoch:  54 val_f1:  0.8084949329130455 val_auroc:  0.8786337209302325 val_auprc:  0.9501720884651689
EarlyStopping counter: 4 out of 50
epoch:  54
epoch:  55 val_f1:  0.7997900244397783 val_auroc:  0.8817829457364341 val_auprc:  0.9516087306622733
EarlyStopping counter: 5 out of 50
epoch:  55
epoch:  56 val_f1:  0.794309372388086 val_auroc:  0.87984496124031 val_auprc:  0.9509619971725891
EarlyStopping counter: 6 out of 50
epoch:  56
epoch:  57 val_f1:  0.7932273763653603 val_auroc:  0.8800872093023255 val_auprc:  0.9516670076319536
EarlyStopping counter: 7 out of 50
epoch:  57
epoch:  58 val_f1:  0.7985611510791367 val_auroc:  0.8805717054263567 val_auprc:  0.9508898330705804
EarlyStopping counter: 8 out of 50
epoch:  58
epoch:  59 val_f1:  0.7854893118997625 val_auroc:  0.8817829457364341 val_auprc:  0.952019061654017
EarlyStopping counter: 9 out of 50
epoch:  59
epoch:  60 val_f1:  0.7932273763653603 val_auroc:  0.8798449612403101 val_auprc:  0.9511189474863595
EarlyStopping counter: 10 out of 50
epoch:  60
epoch:  61 val_f1:  0.8027539115793398 val_auroc:  0.881298449612403 val_auprc:  0.9515377222636516
EarlyStopping counter: 11 out of 50
epoch:  61
epoch:  62 val_f1:  0.8008946034661633 val_auroc:  0.880813953488372 val_auprc:  0.9514307194255117
EarlyStopping counter: 12 out of 50
epoch:  62
epoch:  63 val_f1:  0.7932273763653603 val_auroc:  0.8837209302325582 val_auprc:  0.9524960572589922
EarlyStopping counter: 13 out of 50
epoch:  63
epoch:  64 val_f1:  0.7753157557330894 val_auroc:  0.8825096899224806 val_auprc:  0.9522142225607827
EarlyStopping counter: 14 out of 50
epoch:  64
epoch:  65 val_f1:  0.7932273763653603 val_auroc:  0.8812984496124031 val_auprc:  0.951404372576327
EarlyStopping counter: 15 out of 50
epoch:  65
epoch:  66 val_f1:  0.7841726618705036 val_auroc:  0.8808139534883721 val_auprc:  0.95105774591307
EarlyStopping counter: 16 out of 50
epoch:  66
epoch:  67 val_f1:  0.7997900244397783 val_auroc:  0.8832364341085273 val_auprc:  0.952294651822768
EarlyStopping counter: 17 out of 50
epoch:  67
epoch:  68 val_f1:  0.7985611510791367 val_auroc:  0.8849321705426356 val_auprc:  0.9525869531427273
EarlyStopping counter: 18 out of 50
epoch:  68
epoch:  69 val_f1:  0.8301835390032996 val_auroc:  0.8851744186046511 val_auprc:  0.9533570800088431
EarlyStopping counter: 19 out of 50
epoch:  69
epoch:  70 val_f1:  0.7811109002295425 val_auroc:  0.8859011627906976 val_auprc:  0.9528886389189088
EarlyStopping counter: 20 out of 50
epoch:  70
epoch:  71 val_f1:  0.792019787311512 val_auroc:  0.8827519379844961 val_auprc:  0.951931931725378
EarlyStopping counter: 21 out of 50
epoch:  71
epoch:  72 val_f1:  0.7997900244397783 val_auroc:  0.8846899224806202 val_auprc:  0.9527932847401988
EarlyStopping counter: 22 out of 50
epoch:  72
epoch:  73 val_f1:  0.7892012988311853 val_auroc:  0.8854166666666667 val_auprc:  0.9529764255026109
EarlyStopping counter: 23 out of 50
epoch:  73
epoch:  74 val_f1:  0.7997900244397783 val_auroc:  0.8844476744186047 val_auprc:  0.9526826789897691
EarlyStopping counter: 24 out of 50
epoch:  74
epoch:  75 val_f1:  0.7985611510791367 val_auroc:  0.8866279069767442 val_auprc:  0.9532878626594379
EarlyStopping counter: 25 out of 50
epoch:  75
epoch:  76 val_f1:  0.7985611510791367 val_auroc:  0.8859011627906976 val_auprc:  0.9531756750463993
EarlyStopping counter: 26 out of 50
epoch:  76
epoch:  77 val_f1:  0.7892012988311853 val_auroc:  0.8863856589147286 val_auprc:  0.9531200661652263
EarlyStopping counter: 27 out of 50
epoch:  77
epoch:  78 val_f1:  0.7997900244397783 val_auroc:  0.8851744186046512 val_auprc:  0.9528297544813857
EarlyStopping counter: 28 out of 50
epoch:  78
epoch:  79 val_f1:  0.7746634573712671 val_auroc:  0.8849321705426356 val_auprc:  0.9527806995460097
EarlyStopping counter: 29 out of 50
epoch:  79
epoch:  80 val_f1:  0.7746634573712671 val_auroc:  0.8851744186046512 val_auprc:  0.9526140946655891
EarlyStopping counter: 30 out of 50
epoch:  80
epoch:  81 val_f1:  0.8151164175042944 val_auroc:  0.8856589147286822 val_auprc:  0.9535826207431484
EarlyStopping counter: 31 out of 50
epoch:  81
epoch:  82 val_f1:  0.7811109002295425 val_auroc:  0.8885658914728682 val_auprc:  0.9540574097937833
EarlyStopping counter: 32 out of 50
epoch:  82
epoch:  83 val_f1:  0.8063632502555458 val_auroc:  0.8868701550387597 val_auprc:  0.9531691051634461
EarlyStopping counter: 33 out of 50
epoch:  83
epoch:  84 val_f1:  0.7827158008497472 val_auroc:  0.8863856589147288 val_auprc:  0.9536032212234895
EarlyStopping counter: 34 out of 50
epoch:  84
epoch:  85 val_f1:  0.7997900244397783 val_auroc:  0.8854166666666665 val_auprc:  0.9527001792549801
EarlyStopping counter: 35 out of 50
epoch:  85
epoch:  86 val_f1:  0.7811109002295425 val_auroc:  0.8859011627906976 val_auprc:  0.9532819929119261
EarlyStopping counter: 36 out of 50
epoch:  86
epoch:  87 val_f1:  0.7985611510791367 val_auroc:  0.8863856589147288 val_auprc:  0.9535229537537908
EarlyStopping counter: 37 out of 50
epoch:  87
epoch:  88 val_f1:  0.7972014141264308 val_auroc:  0.8875968992248062 val_auprc:  0.9536779682998926
EarlyStopping counter: 38 out of 50
epoch:  88
epoch:  89 val_f1:  0.7827158008497472 val_auroc:  0.8863856589147288 val_auprc:  0.9535421257247791
EarlyStopping counter: 39 out of 50
epoch:  89
epoch:  90 val_f1:  0.7906801532257888 val_auroc:  0.8871124031007751 val_auprc:  0.9534288992376733
EarlyStopping counter: 40 out of 50
epoch:  90
epoch:  91 val_f1:  0.7906801532257888 val_auroc:  0.8871124031007751 val_auprc:  0.9539449403731354
EarlyStopping counter: 41 out of 50
epoch:  91
epoch:  92 val_f1:  0.7972014141264308 val_auroc:  0.8873546511627908 val_auprc:  0.953430276544267
EarlyStopping counter: 42 out of 50
epoch:  92
epoch:  93 val_f1:  0.7906801532257888 val_auroc:  0.8866279069767442 val_auprc:  0.9534504506188374
EarlyStopping counter: 43 out of 50
epoch:  93
epoch:  94 val_f1:  0.792019787311512 val_auroc:  0.8859011627906976 val_auprc:  0.9532317869356954
EarlyStopping counter: 44 out of 50
epoch:  94
epoch:  95 val_f1:  0.7811109002295425 val_auroc:  0.8871124031007752 val_auprc:  0.9538604119283154
EarlyStopping counter: 45 out of 50
epoch:  95
epoch:  96 val_f1:  0.7906801532257888 val_auroc:  0.8863856589147288 val_auprc:  0.95353116983187
EarlyStopping counter: 46 out of 50
epoch:  96
epoch:  97 val_f1:  0.7827158008497472 val_auroc:  0.8871124031007752 val_auprc:  0.9533212379754918
EarlyStopping counter: 47 out of 50
epoch:  97
epoch:  98 val_f1:  0.7906801532257888 val_auroc:  0.8873546511627908 val_auprc:  0.9540522548959409
EarlyStopping counter: 48 out of 50
epoch:  98
epoch:  99 val_f1:  0.7906801532257888 val_auroc:  0.8866279069767442 val_auprc:  0.9535225327747813
EarlyStopping counter: 49 out of 50
epoch:  99
epoch:  100 val_f1:  0.7906801532257888 val_auroc:  0.8851744186046512 val_auprc:  0.9526377352691346
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  96.46374893188477
{'time_elapsed': [96.46374893188477], 'epoch': [99], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7906801532257888], 'auroc_test': [0.8851744186046512], 'auprc_test': [0.9526377352691346]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 427]            1,024
│    └─BatchNorm1d: 2-2                  [64, 256, 427]            512
│    └─Tanh: 2-3                         [64, 256, 427]            --
│    └─MaxPool1d: 2-4                    [64, 256, 142]            --
│    └─Dropout: 2-5                      [64, 256, 142]            --
│    └─Flatten: 2-6                      [64, 36352]               --
│    └─Linear: 2-7                       [64, 1]                   36,353
==========================================================================================
Total params: 37,889
Trainable params: 37,889
Non-trainable params: 0
Total mult-adds (M): 30.34
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 111.94
Params size (MB): 0.15
Estimated Total Size (MB): 112.42
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6222408026755852 val_auroc:  0.7606646825396826 val_auprc:  0.8678371221979152
epoch:  1
epoch:  2 val_f1:  0.624144501076467 val_auroc:  0.7943948412698413 val_auprc:  0.838624728452354
Validation loss improved to 1.121622
epoch:  2
epoch:  3 val_f1:  0.6796621182586094 val_auroc:  0.800843253968254 val_auprc:  0.8482760295815993
Validation loss improved to 1.072374
epoch:  3
epoch:  4 val_f1:  0.7448015122873347 val_auroc:  0.8278769841269842 val_auprc:  0.8856214639982429
Validation loss improved to 1.015860
epoch:  4
epoch:  5 val_f1:  0.7665601361138573 val_auroc:  0.8566468253968255 val_auprc:  0.9134495225536792
Validation loss improved to 0.941917
epoch:  5
epoch:  6 val_f1:  0.8194319840387783 val_auroc:  0.8707837301587301 val_auprc:  0.9279129900359131
Validation loss improved to 0.914829
epoch:  6
epoch:  7 val_f1:  0.8081713820844254 val_auroc:  0.8787202380952381 val_auprc:  0.9334040716459255
Validation loss improved to 0.863324
epoch:  7
epoch:  8 val_f1:  0.81483559295621 val_auroc:  0.8802083333333334 val_auprc:  0.9358357307753016
Validation loss improved to 0.857008
epoch:  8
epoch:  9 val_f1:  0.7697938448700337 val_auroc:  0.8812003968253967 val_auprc:  0.9364772869860033
Validation loss improved to 0.832594
epoch:  9
epoch:  10 val_f1:  0.8248625247346153 val_auroc:  0.8814484126984127 val_auprc:  0.9351174425763012
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.8205262448141007 val_auroc:  0.8819444444444444 val_auprc:  0.9347041066264256
Validation loss improved to 0.822334
epoch:  11
epoch:  12 val_f1:  0.8030193236714975 val_auroc:  0.8809523809523809 val_auprc:  0.9366414770699674
Validation loss improved to 0.797989
epoch:  12
epoch:  13 val_f1:  0.7211394302848576 val_auroc:  0.8834325396825397 val_auprc:  0.9376180437430075
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.8138718358422335 val_auroc:  0.8819444444444444 val_auprc:  0.9374663185976418
EarlyStopping counter: 2 out of 50
epoch:  14
epoch:  15 val_f1:  0.8449415978253886 val_auroc:  0.8764880952380953 val_auprc:  0.9348610287277898
EarlyStopping counter: 3 out of 50
epoch:  15
epoch:  16 val_f1:  0.8368636194723152 val_auroc:  0.876736111111111 val_auprc:  0.9344012059528095
EarlyStopping counter: 4 out of 50
epoch:  16
epoch:  17 val_f1:  0.8248625247346153 val_auroc:  0.8782242063492064 val_auprc:  0.9353577830965725
EarlyStopping counter: 5 out of 50
epoch:  17
epoch:  18 val_f1:  0.8382209405501332 val_auroc:  0.8799603174603174 val_auprc:  0.9380549806349087
EarlyStopping counter: 6 out of 50
epoch:  18
epoch:  19 val_f1:  0.8138718358422335 val_auroc:  0.878968253968254 val_auprc:  0.9361250915198962
Validation loss improved to 0.787258
epoch:  19
epoch:  20 val_f1:  0.8449415978253886 val_auroc:  0.8757440476190477 val_auprc:  0.9362642715526506
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7833564971403972 val_auroc:  0.8762400793650794 val_auprc:  0.9367823782758901
Validation loss improved to 0.777568
epoch:  21
epoch:  22 val_f1:  0.8090037477295196 val_auroc:  0.875 val_auprc:  0.9355641543668775
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7688528617047408 val_auroc:  0.8762400793650794 val_auprc:  0.9374439703348076
Validation loss improved to 0.776460
epoch:  23
epoch:  24 val_f1:  0.8215074100875418 val_auroc:  0.8774801587301588 val_auprc:  0.9379940324336153
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.8235137533274179 val_auroc:  0.8730158730158731 val_auprc:  0.9362151542334308
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.8115942028985508 val_auroc:  0.873263888888889 val_auprc:  0.935296908436739
EarlyStopping counter: 3 out of 50
epoch:  26
epoch:  27 val_f1:  0.756376995929398 val_auroc:  0.8762400793650794 val_auprc:  0.9378996317220223
EarlyStopping counter: 4 out of 50
epoch:  27
epoch:  28 val_f1:  0.7948558771909655 val_auroc:  0.8745039682539681 val_auprc:  0.936473353782663
EarlyStopping counter: 5 out of 50
epoch:  28
epoch:  29 val_f1:  0.8290790088826556 val_auroc:  0.8752480158730159 val_auprc:  0.9360484113613402
EarlyStopping counter: 6 out of 50
epoch:  29
epoch:  30 val_f1:  0.8022296544035674 val_auroc:  0.8727678571428572 val_auprc:  0.9344713774293489
EarlyStopping counter: 7 out of 50
epoch:  30
epoch:  31 val_f1:  0.8115942028985508 val_auroc:  0.873015873015873 val_auprc:  0.9346095933345646
EarlyStopping counter: 8 out of 50
epoch:  31
epoch:  32 val_f1:  0.8088065661047027 val_auroc:  0.869047619047619 val_auprc:  0.934403581049152
EarlyStopping counter: 9 out of 50
epoch:  32
epoch:  33 val_f1:  0.7940993788819876 val_auroc:  0.8759920634920634 val_auprc:  0.9347674178794437
EarlyStopping counter: 10 out of 50
epoch:  33
epoch:  34 val_f1:  0.8115942028985508 val_auroc:  0.8730158730158729 val_auprc:  0.9363942518472625
EarlyStopping counter: 11 out of 50
epoch:  34
epoch:  35 val_f1:  0.8164398044139025 val_auroc:  0.8779761904761905 val_auprc:  0.9361895435705018
EarlyStopping counter: 12 out of 50
epoch:  35
epoch:  36 val_f1:  0.8154066640778435 val_auroc:  0.8715277777777778 val_auprc:  0.9347520967073648
EarlyStopping counter: 13 out of 50
epoch:  36
epoch:  37 val_f1:  0.8194319840387783 val_auroc:  0.8774801587301587 val_auprc:  0.9372983334979721
EarlyStopping counter: 14 out of 50
epoch:  37
epoch:  38 val_f1:  0.8357868172805383 val_auroc:  0.8799603174603176 val_auprc:  0.9385144004490781
EarlyStopping counter: 15 out of 50
epoch:  38
epoch:  39 val_f1:  0.8168793096329329 val_auroc:  0.8722718253968254 val_auprc:  0.9351739833439259
EarlyStopping counter: 16 out of 50
epoch:  39
epoch:  40 val_f1:  0.8315289648622983 val_auroc:  0.8812003968253969 val_auprc:  0.9388395629069528
EarlyStopping counter: 17 out of 50
epoch:  40
epoch:  41 val_f1:  0.8182185828242006 val_auroc:  0.8804563492063491 val_auprc:  0.9378755725097769
EarlyStopping counter: 18 out of 50
epoch:  41
epoch:  42 val_f1:  0.8156899810964081 val_auroc:  0.8809523809523809 val_auprc:  0.938808189797055
EarlyStopping counter: 19 out of 50
epoch:  42
epoch:  43 val_f1:  0.8194319840387783 val_auroc:  0.8861607142857143 val_auprc:  0.9405999364529513
EarlyStopping counter: 20 out of 50
epoch:  43
epoch:  44 val_f1:  0.8248625247346153 val_auroc:  0.8752480158730159 val_auprc:  0.935804158959704
EarlyStopping counter: 21 out of 50
epoch:  44
epoch:  45 val_f1:  0.8248625247346153 val_auroc:  0.8802083333333335 val_auprc:  0.9393845336661207
EarlyStopping counter: 22 out of 50
epoch:  45
epoch:  46 val_f1:  0.8182185828242006 val_auroc:  0.8812003968253969 val_auprc:  0.9391410580071013
EarlyStopping counter: 23 out of 50
epoch:  46
epoch:  47 val_f1:  0.8182185828242006 val_auroc:  0.8834325396825398 val_auprc:  0.9396074652664926
EarlyStopping counter: 24 out of 50
epoch:  47
epoch:  48 val_f1:  0.8315289648622983 val_auroc:  0.8821924603174602 val_auprc:  0.939269845185409
EarlyStopping counter: 25 out of 50
epoch:  48
epoch:  49 val_f1:  0.8100998424466828 val_auroc:  0.8797123015873016 val_auprc:  0.9388265925417096
EarlyStopping counter: 26 out of 50
epoch:  49
epoch:  50 val_f1:  0.8220330394243437 val_auroc:  0.8831845238095237 val_auprc:  0.9400116526051876
EarlyStopping counter: 27 out of 50
epoch:  50
epoch:  51 val_f1:  0.8115942028985508 val_auroc:  0.8804563492063493 val_auprc:  0.9384166432079559
EarlyStopping counter: 28 out of 50
epoch:  51
epoch:  52 val_f1:  0.8182185828242006 val_auroc:  0.8757440476190477 val_auprc:  0.9356014405076793
EarlyStopping counter: 29 out of 50
epoch:  52
epoch:  53 val_f1:  0.8315289648622983 val_auroc:  0.8792162698412699 val_auprc:  0.9372206691937043
EarlyStopping counter: 30 out of 50
epoch:  53
epoch:  54 val_f1:  0.8248625247346153 val_auroc:  0.8836805555555557 val_auprc:  0.9396093950035529
EarlyStopping counter: 31 out of 50
epoch:  54
epoch:  55 val_f1:  0.8382209405501332 val_auroc:  0.8789682539682541 val_auprc:  0.9375825519545395
EarlyStopping counter: 32 out of 50
epoch:  55
epoch:  56 val_f1:  0.8220330394243437 val_auroc:  0.8844246031746031 val_auprc:  0.9395398271253155
EarlyStopping counter: 33 out of 50
epoch:  56
epoch:  57 val_f1:  0.8182185828242006 val_auroc:  0.8799603174603176 val_auprc:  0.9372066506357805
EarlyStopping counter: 34 out of 50
epoch:  57
epoch:  58 val_f1:  0.8115942028985508 val_auroc:  0.8864087301587301 val_auprc:  0.9416248789757231
EarlyStopping counter: 35 out of 50
epoch:  58
epoch:  59 val_f1:  0.8248625247346153 val_auroc:  0.880704365079365 val_auprc:  0.9391788712908911
EarlyStopping counter: 36 out of 50
epoch:  59
epoch:  60 val_f1:  0.8235137533274179 val_auroc:  0.8821924603174603 val_auprc:  0.9385669063388542
EarlyStopping counter: 37 out of 50
epoch:  60
epoch:  61 val_f1:  0.8248625247346153 val_auroc:  0.8819444444444445 val_auprc:  0.9400419822325858
EarlyStopping counter: 38 out of 50
epoch:  61
epoch:  62 val_f1:  0.8115942028985508 val_auroc:  0.8866567460317462 val_auprc:  0.9413322535151525
EarlyStopping counter: 39 out of 50
epoch:  62
epoch:  63 val_f1:  0.8115942028985508 val_auroc:  0.884672619047619 val_auprc:  0.9403296112866746
EarlyStopping counter: 40 out of 50
epoch:  63
epoch:  64 val_f1:  0.8382209405501332 val_auroc:  0.8804563492063493 val_auprc:  0.9377420103460101
EarlyStopping counter: 41 out of 50
epoch:  64
epoch:  65 val_f1:  0.8220330394243437 val_auroc:  0.8804563492063492 val_auprc:  0.9380651513469834
EarlyStopping counter: 42 out of 50
epoch:  65
epoch:  66 val_f1:  0.8182185828242006 val_auroc:  0.8854166666666666 val_auprc:  0.9415352526380474
EarlyStopping counter: 43 out of 50
epoch:  66
epoch:  67 val_f1:  0.8182185828242006 val_auroc:  0.8846726190476191 val_auprc:  0.9398845190170331
EarlyStopping counter: 44 out of 50
epoch:  67
epoch:  68 val_f1:  0.8102677351291666 val_auroc:  0.8816964285714286 val_auprc:  0.9388109142030536
EarlyStopping counter: 45 out of 50
epoch:  68
epoch:  69 val_f1:  0.8182185828242006 val_auroc:  0.8849206349206349 val_auprc:  0.9412266160577047
EarlyStopping counter: 46 out of 50
epoch:  69
epoch:  70 val_f1:  0.8248625247346153 val_auroc:  0.8844246031746031 val_auprc:  0.9409643550520628
EarlyStopping counter: 47 out of 50
epoch:  70
epoch:  71 val_f1:  0.8137922815659323 val_auroc:  0.8839285714285714 val_auprc:  0.9396106608604982
EarlyStopping counter: 48 out of 50
epoch:  71
epoch:  72 val_f1:  0.8049865427618805 val_auroc:  0.886904761904762 val_auprc:  0.9416720273528051
EarlyStopping counter: 49 out of 50
epoch:  72
epoch:  73 val_f1:  0.8182185828242006 val_auroc:  0.8861607142857143 val_auprc:  0.9410740316310456
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  69.97105669975281
{'time_elapsed': [69.97105669975281], 'epoch': [72], 'fold': [4], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [0.9999999999999999], 'f1_test': [0.8182185828242006], 'auroc_test': [0.8861607142857143], 'auprc_test': [0.9410740316310456]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 427]            1,024
│    └─BatchNorm1d: 2-2                  [64, 256, 427]            512
│    └─Tanh: 2-3                         [64, 256, 427]            --
│    └─MaxPool1d: 2-4                    [64, 256, 142]            --
│    └─Dropout: 2-5                      [64, 256, 142]            --
│    └─Flatten: 2-6                      [64, 36352]               --
│    └─Linear: 2-7                       [64, 1]                   36,353
==========================================================================================
Total params: 37,889
Trainable params: 37,889
Non-trainable params: 0
Total mult-adds (M): 30.34
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 111.94
Params size (MB): 0.15
Estimated Total Size (MB): 112.42
==========================================================================================
