config:  {'project': 'MHCCBM', 'name': 'CNN_20', 'config': {'hidden_channels': [1024], 'epochs': 500, 'kernel_size': 7, 'pool_kernel_size': 7, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5231235011990408 val_auroc:  0.6688757977417772 val_auprc:  0.7624300061736677
epoch:  1
epoch:  2 val_f1:  0.38364255963650135 val_auroc:  0.4385125184094256 val_auprc:  0.6914401702561925
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.4751710826460783 val_auroc:  0.4332351497299951 val_auprc:  0.7100757687634577
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.4363391426905683 val_auroc:  0.4333578792341679 val_auprc:  0.7000080485936414
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.5545506451981272 val_auroc:  0.4543446244477172 val_auprc:  0.7234881014533363
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.5823912298732441 val_auroc:  0.4650220913107511 val_auprc:  0.7205238910091067
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.5164561637219404 val_auroc:  0.4896907216494846 val_auprc:  0.7129162504879207
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.4368447030317534 val_auroc:  0.5255277368679431 val_auprc:  0.7162084026141677
EarlyStopping counter: 7 out of 50
epoch:  8
epoch:  9 val_f1:  0.6272051266549784 val_auroc:  0.5783014236622483 val_auprc:  0.7608763441045662
EarlyStopping counter: 8 out of 50
epoch:  9
epoch:  10 val_f1:  0.634928420899644 val_auroc:  0.6397889052528228 val_auprc:  0.7974544193785396
EarlyStopping counter: 9 out of 50
epoch:  10
epoch:  11 val_f1:  0.5151409855187755 val_auroc:  0.6902307314678449 val_auprc:  0.8377055047636783
Validation loss improved to 1.423412
epoch:  11
epoch:  12 val_f1:  0.6172673191108796 val_auroc:  0.7231222385861562 val_auprc:  0.8583622583864385
Validation loss improved to 1.010117
epoch:  12
epoch:  13 val_f1:  0.7079427367197151 val_auroc:  0.73686794305351 val_auprc:  0.867417166034665
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7140703059967902 val_auroc:  0.7449680903289151 val_auprc:  0.873494633283512
EarlyStopping counter: 2 out of 50
epoch:  14
epoch:  15 val_f1:  0.5906675612539238 val_auroc:  0.7554000981836033 val_auprc:  0.8829493614404332
EarlyStopping counter: 3 out of 50
epoch:  15
epoch:  16 val_f1:  0.6451024231755431 val_auroc:  0.7648502700049092 val_auprc:  0.8863876649616325
EarlyStopping counter: 4 out of 50
epoch:  16
epoch:  17 val_f1:  0.6451024231755431 val_auroc:  0.7793323514973 val_auprc:  0.8936974709385846
EarlyStopping counter: 5 out of 50
epoch:  17
epoch:  18 val_f1:  0.6441055155875299 val_auroc:  0.7808051055473736 val_auprc:  0.8949342532707687
EarlyStopping counter: 6 out of 50
epoch:  18
epoch:  19 val_f1:  0.726967940210938 val_auroc:  0.7805596465390281 val_auprc:  0.8964224903342113
EarlyStopping counter: 7 out of 50
epoch:  19
epoch:  20 val_f1:  0.6413571845226521 val_auroc:  0.7884143348060874 val_auprc:  0.9037124169376383
EarlyStopping counter: 8 out of 50
epoch:  20
epoch:  21 val_f1:  0.726967940210938 val_auroc:  0.793078055964654 val_auprc:  0.9069404094936854
EarlyStopping counter: 9 out of 50
epoch:  21
epoch:  22 val_f1:  0.703263898025454 val_auroc:  0.8016691212567502 val_auprc:  0.9136800608187166
Validation loss improved to 0.874128
epoch:  22
epoch:  23 val_f1:  0.5616342746698164 val_auroc:  0.8006872852233677 val_auprc:  0.9149814504525156
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.6103487445977881 val_auroc:  0.8019145802650957 val_auprc:  0.9159748777038099
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.7092686867455189 val_auroc:  0.7984781541482573 val_auprc:  0.9124358368750622
EarlyStopping counter: 3 out of 50
epoch:  25
epoch:  26 val_f1:  0.6580621620350778 val_auroc:  0.7866961217476681 val_auprc:  0.9019341703474957
EarlyStopping counter: 4 out of 50
epoch:  26
epoch:  27 val_f1:  0.735514445586388 val_auroc:  0.7893961708394698 val_auprc:  0.9038755024885288
EarlyStopping counter: 5 out of 50
epoch:  27
epoch:  28 val_f1:  0.7308672563486676 val_auroc:  0.7889052528227786 val_auprc:  0.9049502039318364
EarlyStopping counter: 6 out of 50
epoch:  28
epoch:  29 val_f1:  0.7087423731900556 val_auroc:  0.7950417280314188 val_auprc:  0.9116217048942798
EarlyStopping counter: 7 out of 50
epoch:  29
epoch:  30 val_f1:  0.748656020238754 val_auroc:  0.7935689739813451 val_auprc:  0.9081845009325504
EarlyStopping counter: 8 out of 50
epoch:  30
epoch:  31 val_f1:  0.7088095828755714 val_auroc:  0.7997054491899854 val_auprc:  0.9115233204890492
EarlyStopping counter: 9 out of 50
epoch:  31
epoch:  32 val_f1:  0.6023420069914218 val_auroc:  0.8087874324987728 val_auprc:  0.9180397891754062
EarlyStopping counter: 10 out of 50
epoch:  32
epoch:  33 val_f1:  0.7377728985642654 val_auroc:  0.7992145311732941 val_auprc:  0.9099530655825979
EarlyStopping counter: 11 out of 50
epoch:  33
epoch:  34 val_f1:  0.7202047592695074 val_auroc:  0.8070692194403535 val_auprc:  0.9184179366669972
Validation loss improved to 0.867984
epoch:  34
epoch:  35 val_f1:  0.7375855413230392 val_auroc:  0.8141875306823761 val_auprc:  0.9222437738924115
Validation loss improved to 0.765720
epoch:  35
epoch:  36 val_f1:  0.7107661257285465 val_auroc:  0.808051055473736 val_auprc:  0.9139657141012607
EarlyStopping counter: 1 out of 50
epoch:  36
epoch:  37 val_f1:  0.7672775806504117 val_auroc:  0.8092783505154639 val_auprc:  0.916207375819471
EarlyStopping counter: 2 out of 50
epoch:  37
epoch:  38 val_f1:  0.7446689355102744 val_auroc:  0.810505645557192 val_auprc:  0.9182555968981783
Validation loss improved to 0.761731
epoch:  38
epoch:  39 val_f1:  0.7633714058926586 val_auroc:  0.8127147766323024 val_auprc:  0.9219093134511249
EarlyStopping counter: 1 out of 50
epoch:  39
epoch:  40 val_f1:  0.5824847418202775 val_auroc:  0.8198330878743251 val_auprc:  0.9270008195624098
EarlyStopping counter: 2 out of 50
epoch:  40
epoch:  41 val_f1:  0.4882109350113894 val_auroc:  0.8220422189494354 val_auprc:  0.926092782887567
EarlyStopping counter: 3 out of 50
epoch:  41
epoch:  42 val_f1:  0.6720188084826255 val_auroc:  0.8178694158075602 val_auprc:  0.9246811475853483
EarlyStopping counter: 4 out of 50
epoch:  42
epoch:  43 val_f1:  0.6758292290898464 val_auroc:  0.8059646539027983 val_auprc:  0.913734881642394
EarlyStopping counter: 5 out of 50
epoch:  43
epoch:  44 val_f1:  0.7349308245711123 val_auroc:  0.8008100147275405 val_auprc:  0.9063812319965148
EarlyStopping counter: 6 out of 50
epoch:  44
epoch:  45 val_f1:  0.7376969013024874 val_auroc:  0.8247422680412372 val_auprc:  0.9273292144004921
EarlyStopping counter: 7 out of 50
epoch:  45
epoch:  46 val_f1:  0.7559325673789327 val_auroc:  0.8136966126656848 val_auprc:  0.9209523672338938
EarlyStopping counter: 8 out of 50
epoch:  46
epoch:  47 val_f1:  0.7691994463100789 val_auroc:  0.8109965635738832 val_auprc:  0.916714622445716
EarlyStopping counter: 9 out of 50
epoch:  47
epoch:  48 val_f1:  0.726967940210938 val_auroc:  0.8296514482081493 val_auprc:  0.9311569552536523
EarlyStopping counter: 10 out of 50
epoch:  48
epoch:  49 val_f1:  0.7092686867455189 val_auroc:  0.8262150220913107 val_auprc:  0.929572450744113
EarlyStopping counter: 11 out of 50
epoch:  49
epoch:  50 val_f1:  0.7569659388768054 val_auroc:  0.8065783014236623 val_auprc:  0.9145629111704998
EarlyStopping counter: 12 out of 50
epoch:  50
epoch:  51 val_f1:  0.7622262794246104 val_auroc:  0.8090328915071183 val_auprc:  0.9169082216431537
EarlyStopping counter: 13 out of 50
epoch:  51
epoch:  52 val_f1:  0.7238240177089098 val_auroc:  0.8166421207658321 val_auprc:  0.9225292240010728
EarlyStopping counter: 14 out of 50
epoch:  52
epoch:  53 val_f1:  0.7448635686045757 val_auroc:  0.8092783505154639 val_auprc:  0.9165637866216276
EarlyStopping counter: 15 out of 50
epoch:  53
epoch:  54 val_f1:  0.723931698015082 val_auroc:  0.8173784977908689 val_auprc:  0.9226408027798815
EarlyStopping counter: 16 out of 50
epoch:  54
epoch:  55 val_f1:  0.7510257046352308 val_auroc:  0.8173784977908689 val_auprc:  0.9222512363203099
EarlyStopping counter: 17 out of 50
epoch:  55
epoch:  56 val_f1:  0.7683026725960121 val_auroc:  0.8154148257241041 val_auprc:  0.9206962957499212
EarlyStopping counter: 18 out of 50
epoch:  56
epoch:  57 val_f1:  0.6951318622544138 val_auroc:  0.8087874324987727 val_auprc:  0.9164165454357329
EarlyStopping counter: 19 out of 50
epoch:  57
epoch:  58 val_f1:  0.7569659388768054 val_auroc:  0.8119783996072656 val_auprc:  0.9195072206909518
EarlyStopping counter: 20 out of 50
epoch:  58
epoch:  59 val_f1:  0.7446689355102744 val_auroc:  0.8114874815905744 val_auprc:  0.9199756622004441
EarlyStopping counter: 21 out of 50
epoch:  59
epoch:  60 val_f1:  0.7466980132583976 val_auroc:  0.8107511045655376 val_auprc:  0.9181763526756157
EarlyStopping counter: 22 out of 50
epoch:  60
epoch:  61 val_f1:  0.7648187281552264 val_auroc:  0.8112420225822288 val_auprc:  0.9180926128032609
EarlyStopping counter: 23 out of 50
epoch:  61
epoch:  62 val_f1:  0.7410071942446043 val_auroc:  0.8107511045655376 val_auprc:  0.9183783227100233
EarlyStopping counter: 24 out of 50
epoch:  62
epoch:  63 val_f1:  0.7500864926036699 val_auroc:  0.8144329896907216 val_auprc:  0.9223586690663641
EarlyStopping counter: 25 out of 50
epoch:  63
epoch:  64 val_f1:  0.694872962389582 val_auroc:  0.8190967108492881 val_auprc:  0.9241767826310366
EarlyStopping counter: 26 out of 50
epoch:  64
epoch:  65 val_f1:  0.7515743249556199 val_auroc:  0.8195876288659795 val_auprc:  0.9248712608709078
EarlyStopping counter: 27 out of 50
epoch:  65
epoch:  66 val_f1:  0.7573003855683703 val_auroc:  0.8198330878743251 val_auprc:  0.9248877773133535
EarlyStopping counter: 28 out of 50
epoch:  66
epoch:  67 val_f1:  0.7515743249556199 val_auroc:  0.8095238095238095 val_auprc:  0.9169086865010714
EarlyStopping counter: 29 out of 50
epoch:  67
epoch:  68 val_f1:  0.7633714058926586 val_auroc:  0.8151693667157583 val_auprc:  0.9217178718847174
EarlyStopping counter: 30 out of 50
epoch:  68
epoch:  69 val_f1:  0.76000113614692 val_auroc:  0.8166421207658321 val_auprc:  0.923267631612771
EarlyStopping counter: 31 out of 50
epoch:  69
epoch:  70 val_f1:  0.7330561760022478 val_auroc:  0.8144329896907216 val_auprc:  0.9207133980983422
EarlyStopping counter: 32 out of 50
epoch:  70
epoch:  71 val_f1:  0.7144317414801258 val_auroc:  0.8244968090328915 val_auprc:  0.9280727608669549
EarlyStopping counter: 33 out of 50
epoch:  71
epoch:  72 val_f1:  0.777854660092151 val_auroc:  0.8262150220913108 val_auprc:  0.9292781983844938
EarlyStopping counter: 34 out of 50
epoch:  72
epoch:  73 val_f1:  0.3514449261186385 val_auroc:  0.8149239077074129 val_auprc:  0.9217578205261796
EarlyStopping counter: 35 out of 50
epoch:  73
epoch:  74 val_f1:  0.612555769145391 val_auroc:  0.7954099165439372 val_auprc:  0.9071796555890799
EarlyStopping counter: 36 out of 50
epoch:  74
epoch:  75 val_f1:  0.5492496824096865 val_auroc:  0.7952871870397643 val_auprc:  0.9046053849801285
EarlyStopping counter: 37 out of 50
epoch:  75
epoch:  76 val_f1:  0.6307461493491773 val_auroc:  0.8294059891998037 val_auprc:  0.9309705710923748
EarlyStopping counter: 38 out of 50
epoch:  76
epoch:  77 val_f1:  0.7308672563486676 val_auroc:  0.8183603338242513 val_auprc:  0.9225896111117149
EarlyStopping counter: 39 out of 50
epoch:  77
epoch:  78 val_f1:  0.7845295119922345 val_auroc:  0.8102601865488464 val_auprc:  0.9143062941171475
EarlyStopping counter: 40 out of 50
epoch:  78
epoch:  79 val_f1:  0.7510724063582411 val_auroc:  0.824251350024546 val_auprc:  0.9266895580755389
EarlyStopping counter: 41 out of 50
epoch:  79
epoch:  80 val_f1:  0.7622262794246104 val_auroc:  0.8163966617574865 val_auprc:  0.9194461813956242
EarlyStopping counter: 42 out of 50
epoch:  80
epoch:  81 val_f1:  0.7633714058926586 val_auroc:  0.8127147766323023 val_auprc:  0.917156021086589
EarlyStopping counter: 43 out of 50
epoch:  81
epoch:  82 val_f1:  0.7553956834532374 val_auroc:  0.81173294059892 val_auprc:  0.9174170095367048
EarlyStopping counter: 44 out of 50
epoch:  82
epoch:  83 val_f1:  0.7454557504588546 val_auroc:  0.812960235640648 val_auprc:  0.9170044691543191
EarlyStopping counter: 45 out of 50
epoch:  83
epoch:  84 val_f1:  0.7644702419882276 val_auroc:  0.8107511045655376 val_auprc:  0.9160929203361589
EarlyStopping counter: 46 out of 50
epoch:  84
epoch:  85 val_f1:  0.7691994463100789 val_auroc:  0.8132056946489936 val_auprc:  0.9176107132008615
EarlyStopping counter: 47 out of 50
epoch:  85
epoch:  86 val_f1:  0.743396428458658 val_auroc:  0.8097692685321551 val_auprc:  0.9152916463030931
EarlyStopping counter: 48 out of 50
epoch:  86
epoch:  87 val_f1:  0.7473302173830908 val_auroc:  0.810505645557192 val_auprc:  0.9150251910147587
EarlyStopping counter: 49 out of 50
epoch:  87
epoch:  88 val_f1:  0.7712620601193464 val_auroc:  0.81173294059892 val_auprc:  0.9177552122276238
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  2682.8373131752014
{'time_elapsed': [2682.8373131752014], 'epoch': [87], 'fold': [0], 'f1_train': [0.9928161714345926], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7712620601193464], 'auroc_test': [0.81173294059892], 'auprc_test': [0.9177552122276238]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1276]          8,192
│    └─BatchNorm1d: 2-2                  [64, 1024, 1276]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1276]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1270]          --
│    └─Dropout: 2-5                      [64, 1024, 1270]          --
│    └─Flatten: 2-6                      [64, 1300480]             --
│    └─Linear: 2-7                       [64, 1]                   1,300,481
==========================================================================================
Total params: 1,310,721
Trainable params: 1,310,721
Non-trainable params: 0
Total mult-adds (M): 752.35
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1337.98
Params size (MB): 5.24
Estimated Total Size (MB): 1343.55
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.515218853479726 val_auroc:  0.6458026509572902 val_auprc:  0.8172746083877606
epoch:  1
epoch:  2 val_f1:  0.6008917165333154 val_auroc:  0.46269023073146787 val_auprc:  0.7912180590805391
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.5655617966311501 val_auroc:  0.5486008836524301 val_auprc:  0.7990859117083022
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6022355762448864 val_auroc:  0.6154884634266078 val_auprc:  0.8218763479825492
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6020377956008398 val_auroc:  0.6326705940108002 val_auprc:  0.8417928738073299
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.5947833148425616 val_auroc:  0.6712076583210604 val_auprc:  0.8581186088287878
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.6787370103916865 val_auroc:  0.7391998036327934 val_auprc:  0.8838178389627314
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.69663104467882 val_auroc:  0.7554000981836034 val_auprc:  0.8884007410815539
Validation loss improved to 1.072421
epoch:  8
epoch:  9 val_f1:  0.7150229029574715 val_auroc:  0.7632547864506627 val_auprc:  0.8879438760740294
Validation loss improved to 0.621648
epoch:  9
epoch:  10 val_f1:  0.6729375272402062 val_auroc:  0.7778595974472263 val_auprc:  0.9013149100604854
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.7157412825720284 val_auroc:  0.7857142857142857 val_auprc:  0.9131043009071615
Validation loss improved to 0.485265
epoch:  11
epoch:  12 val_f1:  0.7375047745919104 val_auroc:  0.7913598429062347 val_auprc:  0.9172516460675074
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7094198370570532 val_auroc:  0.7916053019145803 val_auprc:  0.9186030524143887
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.7249644134959412 val_auroc:  0.7920962199312716 val_auprc:  0.9169716994353017
Validation loss improved to 0.482356
epoch:  14
epoch:  15 val_f1:  0.7455074238481555 val_auroc:  0.8006872852233676 val_auprc:  0.9162860464047864
Validation loss improved to 0.385201
epoch:  15
epoch:  16 val_f1:  0.6933991976925371 val_auroc:  0.8026509572901326 val_auprc:  0.9146579513149785
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.6705167975711175 val_auroc:  0.8097692685321551 val_auprc:  0.9190910338339606
EarlyStopping counter: 2 out of 50
epoch:  17
epoch:  18 val_f1:  0.6951318622544138 val_auroc:  0.8136966126656849 val_auprc:  0.9199940170961811
Validation loss improved to 0.329826
epoch:  18
epoch:  19 val_f1:  0.7235008927723722 val_auroc:  0.810505645557192 val_auprc:  0.9184900512404244
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7542604103291037 val_auroc:  0.8127147766323024 val_auprc:  0.9216963522734145
EarlyStopping counter: 2 out of 50
epoch:  20
epoch:  21 val_f1:  0.799854302604428 val_auroc:  0.8213058419243986 val_auprc:  0.9221577964247051
Validation loss improved to 0.231211
epoch:  21
epoch:  22 val_f1:  0.7762067639678805 val_auroc:  0.8269513991163475 val_auprc:  0.9238969361760344
Validation loss improved to 0.205362
epoch:  22
epoch:  23 val_f1:  0.7772753225990636 val_auroc:  0.8286696121747668 val_auprc:  0.925311741447081
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7748426784519089 val_auroc:  0.8301423662248404 val_auprc:  0.926386361206904
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.7483101088021195 val_auroc:  0.8308787432498773 val_auprc:  0.9273970526985815
EarlyStopping counter: 3 out of 50
epoch:  25
epoch:  26 val_f1:  0.5824847418202775 val_auroc:  0.8328424153166422 val_auprc:  0.9282538062488043
EarlyStopping counter: 4 out of 50
epoch:  26
epoch:  27 val_f1:  0.60431654676259 val_auroc:  0.8254786450662739 val_auprc:  0.927918286908253
EarlyStopping counter: 5 out of 50
epoch:  27
epoch:  28 val_f1:  0.6759950757759244 val_auroc:  0.8328424153166422 val_auprc:  0.9271896018140191
EarlyStopping counter: 6 out of 50
epoch:  28
epoch:  29 val_f1:  0.7839141001375581 val_auroc:  0.8232695139911634 val_auprc:  0.9239748753439936
EarlyStopping counter: 7 out of 50
epoch:  29
epoch:  30 val_f1:  0.7697841726618705 val_auroc:  0.8362788414334806 val_auprc:  0.9287429169388501
EarlyStopping counter: 8 out of 50
epoch:  30
epoch:  31 val_f1:  0.7536606851900262 val_auroc:  0.8384879725085911 val_auprc:  0.9301532962396926
Validation loss improved to 0.202723
epoch:  31
epoch:  32 val_f1:  0.7727225509205256 val_auroc:  0.8360333824251349 val_auprc:  0.9283746110252125
Validation loss improved to 0.190695
epoch:  32
epoch:  33 val_f1:  0.7560320485424044 val_auroc:  0.8372606774668631 val_auprc:  0.9260390821158613
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.7584532667010088 val_auroc:  0.8389788905252823 val_auprc:  0.9242351657493679
EarlyStopping counter: 2 out of 50
epoch:  34
epoch:  35 val_f1:  0.7515743249556199 val_auroc:  0.8372606774668631 val_auprc:  0.9246462122466228
EarlyStopping counter: 3 out of 50
epoch:  35
epoch:  36 val_f1:  0.748164418722312 val_auroc:  0.8343151693667158 val_auprc:  0.9240289533182764
EarlyStopping counter: 4 out of 50
epoch:  36
epoch:  37 val_f1:  0.7324246948924567 val_auroc:  0.8222876779577811 val_auprc:  0.9194562850642969
EarlyStopping counter: 5 out of 50
epoch:  37
epoch:  38 val_f1:  0.7681512331200245 val_auroc:  0.832842415316642 val_auprc:  0.9225803080910547
EarlyStopping counter: 6 out of 50
epoch:  38
epoch:  39 val_f1:  0.7185321510233673 val_auroc:  0.830387825233186 val_auprc:  0.918353194648622
EarlyStopping counter: 7 out of 50
epoch:  39
epoch:  40 val_f1:  0.7905466835322951 val_auroc:  0.8276877761413843 val_auprc:  0.9188851504224986
EarlyStopping counter: 8 out of 50
epoch:  40
epoch:  41 val_f1:  0.7681512331200245 val_auroc:  0.8316151202749141 val_auprc:  0.9196744499171069
Validation loss improved to 0.188307
epoch:  41
epoch:  42 val_f1:  0.7514700844366524 val_auroc:  0.8321060382916052 val_auprc:  0.9232143581840941
EarlyStopping counter: 1 out of 50
epoch:  42
epoch:  43 val_f1:  0.7963871971298289 val_auroc:  0.833578792341679 val_auprc:  0.9240983017365147
EarlyStopping counter: 2 out of 50
epoch:  43
epoch:  44 val_f1:  0.6982612029498659 val_auroc:  0.8378743249877272 val_auprc:  0.9216698443543747
Validation loss improved to 0.186899
epoch:  44
epoch:  45 val_f1:  0.7199392779354498 val_auroc:  0.8387334315169367 val_auprc:  0.9207070450326238
Validation loss improved to 0.185426
epoch:  45
epoch:  46 val_f1:  0.7442757932382417 val_auroc:  0.8257241040746195 val_auprc:  0.92089257505758
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.7809570525397864 val_auroc:  0.8340697103583702 val_auprc:  0.918899615269378
Validation loss improved to 0.184937
epoch:  47
epoch:  48 val_f1:  0.748164418722312 val_auroc:  0.8345606283750613 val_auprc:  0.9206050145628104
Validation loss improved to 0.174011
epoch:  48
epoch:  49 val_f1:  0.7513203127712835 val_auroc:  0.8397152675503191 val_auprc:  0.9232533155060607
EarlyStopping counter: 1 out of 50
epoch:  49
epoch:  50 val_f1:  0.7039462975939799 val_auroc:  0.8350515463917526 val_auprc:  0.9189902523180109
EarlyStopping counter: 2 out of 50
epoch:  50
epoch:  51 val_f1:  0.7911956149366222 val_auroc:  0.8303878252331861 val_auprc:  0.9174341166838832
EarlyStopping counter: 3 out of 50
epoch:  51
epoch:  52 val_f1:  0.773303179625077 val_auroc:  0.832351497299951 val_auprc:  0.9194074556516031
EarlyStopping counter: 4 out of 50
epoch:  52
epoch:  53 val_f1:  0.778324933635979 val_auroc:  0.8362788414334807 val_auprc:  0.9211360833942506
EarlyStopping counter: 5 out of 50
epoch:  53
epoch:  54 val_f1:  0.7510724063582411 val_auroc:  0.8343151693667158 val_auprc:  0.920232194352719
EarlyStopping counter: 6 out of 50
epoch:  54
epoch:  55 val_f1:  0.7889150110486646 val_auroc:  0.8377515954835543 val_auprc:  0.9211813968493022
EarlyStopping counter: 7 out of 50
epoch:  55
epoch:  56 val_f1:  0.799854302604428 val_auroc:  0.833578792341679 val_auprc:  0.9178379062499206
EarlyStopping counter: 8 out of 50
epoch:  56
epoch:  57 val_f1:  0.7724732835091151 val_auroc:  0.8389788905252823 val_auprc:  0.917226328326794
Validation loss improved to 0.155510
epoch:  57
epoch:  58 val_f1:  0.7868059619290214 val_auroc:  0.8350515463917526 val_auprc:  0.9203684855396919
EarlyStopping counter: 1 out of 50
epoch:  58
epoch:  59 val_f1:  0.7661589271850144 val_auroc:  0.8352970054000982 val_auprc:  0.9199559536580797
EarlyStopping counter: 2 out of 50
epoch:  59
epoch:  60 val_f1:  0.7938350857775318 val_auroc:  0.8379970544919 val_auprc:  0.9189216471093743
EarlyStopping counter: 3 out of 50
epoch:  60
epoch:  61 val_f1:  0.7791090204759269 val_auroc:  0.8333333333333334 val_auprc:  0.9177157504292014
EarlyStopping counter: 4 out of 50
epoch:  61
epoch:  62 val_f1:  0.7834737923946559 val_auroc:  0.8379970544918999 val_auprc:  0.9164329350332256
Validation loss improved to 0.138369
epoch:  62
epoch:  63 val_f1:  0.7855164986057286 val_auroc:  0.834806087383407 val_auprc:  0.9166440644254044
EarlyStopping counter: 1 out of 50
epoch:  63
epoch:  64 val_f1:  0.7661589271850144 val_auroc:  0.833578792341679 val_auprc:  0.9165765457247079
EarlyStopping counter: 2 out of 50
epoch:  64
epoch:  65 val_f1:  0.787641731275174 val_auroc:  0.8330878743249878 val_auprc:  0.9166814586174308
EarlyStopping counter: 3 out of 50
epoch:  65
epoch:  66 val_f1:  0.7483101088021195 val_auroc:  0.8313696612665685 val_auprc:  0.9145527036444543
EarlyStopping counter: 4 out of 50
epoch:  66
epoch:  67 val_f1:  0.7727225509205256 val_auroc:  0.8338242513500246 val_auprc:  0.9170130133080283
EarlyStopping counter: 5 out of 50
epoch:  67
epoch:  68 val_f1:  0.7855164986057286 val_auroc:  0.8343151693667158 val_auprc:  0.9173596101864274
EarlyStopping counter: 6 out of 50
epoch:  68
epoch:  69 val_f1:  0.7635640416019908 val_auroc:  0.8321060382916053 val_auprc:  0.9142165719002147
EarlyStopping counter: 7 out of 50
epoch:  69
epoch:  70 val_f1:  0.7777125328082551 val_auroc:  0.8323514972999508 val_auprc:  0.9140868756873239
EarlyStopping counter: 8 out of 50
epoch:  70
epoch:  71 val_f1:  0.7855164986057286 val_auroc:  0.833578792341679 val_auprc:  0.914182550980871
EarlyStopping counter: 9 out of 50
epoch:  71
epoch:  72 val_f1:  0.7777125328082551 val_auroc:  0.8330878743249878 val_auprc:  0.915397231870845
EarlyStopping counter: 10 out of 50
epoch:  72
epoch:  73 val_f1:  0.7514700844366524 val_auroc:  0.8333333333333334 val_auprc:  0.9142653392828173
Validation loss improved to 0.133446
epoch:  73
epoch:  74 val_f1:  0.757304835743056 val_auroc:  0.8294059891998037 val_auprc:  0.9144766312282925
EarlyStopping counter: 1 out of 50
epoch:  74
epoch:  75 val_f1:  0.7889150110486646 val_auroc:  0.8350515463917526 val_auprc:  0.9173407768217381
EarlyStopping counter: 2 out of 50
epoch:  75
epoch:  76 val_f1:  0.7898876447331801 val_auroc:  0.8294059891998036 val_auprc:  0.9139621760237104
EarlyStopping counter: 3 out of 50
epoch:  76
epoch:  77 val_f1:  0.7453039856444363 val_auroc:  0.8313696612665685 val_auprc:  0.9110928121096844
EarlyStopping counter: 4 out of 50
epoch:  77
epoch:  78 val_f1:  0.7920536597238516 val_auroc:  0.8338242513500246 val_auprc:  0.9118873612711031
EarlyStopping counter: 5 out of 50
epoch:  78
epoch:  79 val_f1:  0.8003084642191267 val_auroc:  0.8303878252331861 val_auprc:  0.9136142151560713
EarlyStopping counter: 6 out of 50
epoch:  79
epoch:  80 val_f1:  0.7737843767539161 val_auroc:  0.8345606283750613 val_auprc:  0.9138629974377899
EarlyStopping counter: 7 out of 50
epoch:  80
epoch:  81 val_f1:  0.7762067639678805 val_auroc:  0.8325969563082966 val_auprc:  0.9123633719660451
EarlyStopping counter: 8 out of 50
epoch:  81
epoch:  82 val_f1:  0.7514700844366524 val_auroc:  0.8252331860579283 val_auprc:  0.9090532482812596
EarlyStopping counter: 9 out of 50
epoch:  82
epoch:  83 val_f1:  0.7635640416019908 val_auroc:  0.8323514972999508 val_auprc:  0.9122535779534424
EarlyStopping counter: 10 out of 50
epoch:  83
epoch:  84 val_f1:  0.7633714058926586 val_auroc:  0.8284241531664212 val_auprc:  0.9107373883758068
EarlyStopping counter: 11 out of 50
epoch:  84
epoch:  85 val_f1:  0.7855164986057286 val_auroc:  0.8274423171330388 val_auprc:  0.9111275412271579
EarlyStopping counter: 12 out of 50
epoch:  85
epoch:  86 val_f1:  0.7855164986057286 val_auroc:  0.8338242513500246 val_auprc:  0.9127578012136375
EarlyStopping counter: 13 out of 50
epoch:  86
epoch:  87 val_f1:  0.7855581813618873 val_auroc:  0.8298969072164949 val_auprc:  0.9118388800062341
EarlyStopping counter: 14 out of 50
epoch:  87
epoch:  88 val_f1:  0.7791090204759269 val_auroc:  0.8313696612665685 val_auprc:  0.9118498855130044
EarlyStopping counter: 15 out of 50
epoch:  88
epoch:  89 val_f1:  0.7791090204759269 val_auroc:  0.8323514972999508 val_auprc:  0.9116778410592556
EarlyStopping counter: 16 out of 50
epoch:  89
epoch:  90 val_f1:  0.7697841726618705 val_auroc:  0.8311242022582229 val_auprc:  0.9121618527151163
EarlyStopping counter: 17 out of 50
epoch:  90
epoch:  91 val_f1:  0.7855581813618873 val_auroc:  0.8298969072164948 val_auprc:  0.9118950791140417
EarlyStopping counter: 18 out of 50
epoch:  91
epoch:  92 val_f1:  0.7809570525397864 val_auroc:  0.8317378497790869 val_auprc:  0.9129403727259113
EarlyStopping counter: 19 out of 50
epoch:  92
epoch:  93 val_f1:  0.7812454480117876 val_auroc:  0.8333333333333334 val_auprc:  0.9127543262651495
Validation loss improved to 0.117912
epoch:  93
epoch:  94 val_f1:  0.7635640416019908 val_auroc:  0.8296514482081492 val_auprc:  0.9109143508886457
EarlyStopping counter: 1 out of 50
epoch:  94
epoch:  95 val_f1:  0.7812454480117876 val_auroc:  0.833578792341679 val_auprc:  0.9123526105724222
EarlyStopping counter: 2 out of 50
epoch:  95
epoch:  96 val_f1:  0.7855164986057286 val_auroc:  0.8313696612665684 val_auprc:  0.9132711030381879
EarlyStopping counter: 3 out of 50
epoch:  96
epoch:  97 val_f1:  0.7745465218349855 val_auroc:  0.8289150711831124 val_auprc:  0.9119598007866192
EarlyStopping counter: 4 out of 50
epoch:  97
epoch:  98 val_f1:  0.7809570525397864 val_auroc:  0.8289150711831125 val_auprc:  0.90937104751758
EarlyStopping counter: 5 out of 50
epoch:  98
epoch:  99 val_f1:  0.7791090204759269 val_auroc:  0.8279332351497299 val_auprc:  0.9090792091936997
EarlyStopping counter: 6 out of 50
epoch:  99
epoch:  100 val_f1:  0.7898876447331801 val_auroc:  0.8259695630829651 val_auprc:  0.907155102700482
EarlyStopping counter: 7 out of 50
epoch:  100
epoch:  101 val_f1:  0.7855164986057286 val_auroc:  0.8243740795287187 val_auprc:  0.9060456893895326
EarlyStopping counter: 8 out of 50
epoch:  101
epoch:  102 val_f1:  0.7635640416019908 val_auroc:  0.8287923416789396 val_auprc:  0.9073536747699552
EarlyStopping counter: 9 out of 50
epoch:  102
epoch:  103 val_f1:  0.7919479944965341 val_auroc:  0.825478645066274 val_auprc:  0.9068327157615361
EarlyStopping counter: 10 out of 50
epoch:  103
epoch:  104 val_f1:  0.7919479944965341 val_auroc:  0.8254786450662739 val_auprc:  0.9066180078300586
EarlyStopping counter: 11 out of 50
epoch:  104
epoch:  105 val_f1:  0.7855164986057286 val_auroc:  0.829160530191458 val_auprc:  0.9087917801519851
EarlyStopping counter: 12 out of 50
epoch:  105
epoch:  106 val_f1:  0.7855164986057286 val_auroc:  0.8240058910162003 val_auprc:  0.9058701272965357
EarlyStopping counter: 13 out of 50
epoch:  106
epoch:  107 val_f1:  0.7855164986057286 val_auroc:  0.8260922925871379 val_auprc:  0.9067028239561106
EarlyStopping counter: 14 out of 50
epoch:  107
epoch:  108 val_f1:  0.7826417810500232 val_auroc:  0.8279332351497299 val_auprc:  0.9074526816644439
EarlyStopping counter: 15 out of 50
epoch:  108
epoch:  109 val_f1:  0.7855164986057286 val_auroc:  0.8274423171330388 val_auprc:  0.9074500986004091
EarlyStopping counter: 16 out of 50
epoch:  109
epoch:  110 val_f1:  0.7855164986057286 val_auroc:  0.8258468335787922 val_auprc:  0.9070881963472981
EarlyStopping counter: 17 out of 50
epoch:  110
epoch:  111 val_f1:  0.7855164986057286 val_auroc:  0.8259695630829651 val_auprc:  0.906943774019624
EarlyStopping counter: 18 out of 50
epoch:  111
epoch:  112 val_f1:  0.7855581813618873 val_auroc:  0.8251104565537555 val_auprc:  0.906577572811977
EarlyStopping counter: 19 out of 50
epoch:  112
epoch:  113 val_f1:  0.7841726618705036 val_auroc:  0.8249877270495828 val_auprc:  0.9058590784780376
EarlyStopping counter: 20 out of 50
epoch:  113
epoch:  114 val_f1:  0.7919479944965341 val_auroc:  0.8249877270495828 val_auprc:  0.90579390410057
EarlyStopping counter: 21 out of 50
epoch:  114
epoch:  115 val_f1:  0.7724732835091151 val_auroc:  0.8253559155621011 val_auprc:  0.9045158340680318
EarlyStopping counter: 22 out of 50
epoch:  115
epoch:  116 val_f1:  0.7919479944965341 val_auroc:  0.8260922925871379 val_auprc:  0.9067265942857279
EarlyStopping counter: 23 out of 50
epoch:  116
epoch:  117 val_f1:  0.7748796193569787 val_auroc:  0.8254786450662739 val_auprc:  0.9056844591728301
EarlyStopping counter: 24 out of 50
epoch:  117
epoch:  118 val_f1:  0.7984066342984726 val_auroc:  0.8264604810996563 val_auprc:  0.9051801810387348
EarlyStopping counter: 25 out of 50
epoch:  118
epoch:  119 val_f1:  0.7791090204759269 val_auroc:  0.8258468335787924 val_auprc:  0.906311315490771
EarlyStopping counter: 26 out of 50
epoch:  119
epoch:  120 val_f1:  0.7834737923946559 val_auroc:  0.8259695630829652 val_auprc:  0.9065625940197846
EarlyStopping counter: 27 out of 50
epoch:  120
epoch:  121 val_f1:  0.7919479944965341 val_auroc:  0.8248649975454099 val_auprc:  0.9060726350117246
EarlyStopping counter: 28 out of 50
epoch:  121
epoch:  122 val_f1:  0.7919479944965341 val_auroc:  0.8251104565537555 val_auprc:  0.9049455053498389
EarlyStopping counter: 29 out of 50
epoch:  122
epoch:  123 val_f1:  0.7855164986057286 val_auroc:  0.8258468335787923 val_auprc:  0.9064956298311111
EarlyStopping counter: 30 out of 50
epoch:  123
epoch:  124 val_f1:  0.7812454480117876 val_auroc:  0.8244968090328915 val_auprc:  0.9033174335595058
EarlyStopping counter: 31 out of 50
epoch:  124
epoch:  125 val_f1:  0.7898876447331801 val_auroc:  0.8243740795287188 val_auprc:  0.9055559004444105
EarlyStopping counter: 32 out of 50
epoch:  125
epoch:  126 val_f1:  0.7898876447331801 val_auroc:  0.8246195385370644 val_auprc:  0.9058462042770966
Validation loss improved to 0.115924
epoch:  126
epoch:  127 val_f1:  0.7855164986057286 val_auroc:  0.8203240058910162 val_auprc:  0.902798569222228
EarlyStopping counter: 1 out of 50
epoch:  127
epoch:  128 val_f1:  0.7812454480117876 val_auroc:  0.8243740795287187 val_auprc:  0.9029330871403337
EarlyStopping counter: 2 out of 50
epoch:  128
epoch:  129 val_f1:  0.7919479944965341 val_auroc:  0.8243740795287187 val_auprc:  0.9054242320171875
EarlyStopping counter: 3 out of 50
epoch:  129
epoch:  130 val_f1:  0.7898876447331801 val_auroc:  0.8229013254786451 val_auprc:  0.9030797514376178
EarlyStopping counter: 4 out of 50
epoch:  130
epoch:  131 val_f1:  0.7984066342984726 val_auroc:  0.82486499754541 val_auprc:  0.9039110186424089
Validation loss improved to 0.111376
epoch:  131
epoch:  132 val_f1:  0.7898876447331801 val_auroc:  0.82486499754541 val_auprc:  0.9037215616497929
EarlyStopping counter: 1 out of 50
epoch:  132
epoch:  133 val_f1:  0.7855164986057286 val_auroc:  0.8241286205203731 val_auprc:  0.9046662540485833
EarlyStopping counter: 2 out of 50
epoch:  133
epoch:  134 val_f1:  0.7855164986057286 val_auroc:  0.8232695139911634 val_auprc:  0.9047012869514133
EarlyStopping counter: 3 out of 50
epoch:  134
epoch:  135 val_f1:  0.7855164986057286 val_auroc:  0.8231467844869906 val_auprc:  0.9031324476107473
EarlyStopping counter: 4 out of 50
epoch:  135
epoch:  136 val_f1:  0.7809570525397864 val_auroc:  0.8252331860579283 val_auprc:  0.9051905535485971
EarlyStopping counter: 5 out of 50
epoch:  136
epoch:  137 val_f1:  0.7938350857775318 val_auroc:  0.8249877270495827 val_auprc:  0.9037435067771902
EarlyStopping counter: 6 out of 50
epoch:  137
epoch:  138 val_f1:  0.7919479944965341 val_auroc:  0.8240058910162003 val_auprc:  0.9036442081826473
EarlyStopping counter: 7 out of 50
epoch:  138
epoch:  139 val_f1:  0.7812454480117876 val_auroc:  0.822901325478645 val_auprc:  0.898894954576415
EarlyStopping counter: 8 out of 50
epoch:  139
epoch:  140 val_f1:  0.7919479944965341 val_auroc:  0.8240058910162003 val_auprc:  0.9030551286025593
EarlyStopping counter: 9 out of 50
epoch:  140
epoch:  141 val_f1:  0.7919479944965341 val_auroc:  0.8237604320078546 val_auprc:  0.9030180016695561
EarlyStopping counter: 10 out of 50
epoch:  141
epoch:  142 val_f1:  0.7938350857775318 val_auroc:  0.8227785959744722 val_auprc:  0.9028234948063486
EarlyStopping counter: 11 out of 50
epoch:  142
epoch:  143 val_f1:  0.7826417810500232 val_auroc:  0.8237604320078546 val_auprc:  0.9046168442745411
EarlyStopping counter: 12 out of 50
epoch:  143
epoch:  144 val_f1:  0.7873856121514594 val_auroc:  0.8242513500245459 val_auprc:  0.9059826472398348
EarlyStopping counter: 13 out of 50
epoch:  144
epoch:  145 val_f1:  0.7890919075230509 val_auroc:  0.8237604320078546 val_auprc:  0.9053430983546349
EarlyStopping counter: 14 out of 50
epoch:  145
epoch:  146 val_f1:  0.7955599157038007 val_auroc:  0.8233922434953362 val_auprc:  0.903186300706024
EarlyStopping counter: 15 out of 50
epoch:  146
epoch:  147 val_f1:  0.7873856121514594 val_auroc:  0.8252331860579284 val_auprc:  0.9042866944890642
EarlyStopping counter: 16 out of 50
epoch:  147
epoch:  148 val_f1:  0.7873856121514594 val_auroc:  0.8248649975454099 val_auprc:  0.9040317735071152
EarlyStopping counter: 17 out of 50
epoch:  148
epoch:  149 val_f1:  0.7938350857775318 val_auroc:  0.8233922434953364 val_auprc:  0.9038597467759146
EarlyStopping counter: 18 out of 50
epoch:  149
epoch:  150 val_f1:  0.7919479944965341 val_auroc:  0.8230240549828178 val_auprc:  0.8992311535752447
EarlyStopping counter: 19 out of 50
epoch:  150
epoch:  151 val_f1:  0.7873856121514594 val_auroc:  0.8241286205203732 val_auprc:  0.9043048154099508
EarlyStopping counter: 20 out of 50
epoch:  151
epoch:  152 val_f1:  0.7898876447331801 val_auroc:  0.8206921944035346 val_auprc:  0.8988206725363956
EarlyStopping counter: 21 out of 50
epoch:  152
epoch:  153 val_f1:  0.7855164986057286 val_auroc:  0.8217967599410898 val_auprc:  0.8984993559943275
EarlyStopping counter: 22 out of 50
epoch:  153
epoch:  154 val_f1:  0.7873856121514594 val_auroc:  0.8232695139911635 val_auprc:  0.9034809951016183
EarlyStopping counter: 23 out of 50
epoch:  154
epoch:  155 val_f1:  0.7873856121514594 val_auroc:  0.8233922434953364 val_auprc:  0.9036913795263614
EarlyStopping counter: 24 out of 50
epoch:  155
epoch:  156 val_f1:  0.7938350857775318 val_auroc:  0.822901325478645 val_auprc:  0.9033647514032875
EarlyStopping counter: 25 out of 50
epoch:  156
epoch:  157 val_f1:  0.7873856121514594 val_auroc:  0.8224104074619538 val_auprc:  0.9036852710347808
EarlyStopping counter: 26 out of 50
epoch:  157
epoch:  158 val_f1:  0.7898876447331801 val_auroc:  0.823514972999509 val_auprc:  0.9004877988273233
EarlyStopping counter: 27 out of 50
epoch:  158
epoch:  159 val_f1:  0.7898876447331801 val_auroc:  0.8235149729995092 val_auprc:  0.9005066439064098
EarlyStopping counter: 28 out of 50
epoch:  159
epoch:  160 val_f1:  0.7938350857775318 val_auroc:  0.8227785959744722 val_auprc:  0.9051084784096723
EarlyStopping counter: 29 out of 50
epoch:  160
epoch:  161 val_f1:  0.7906450372602754 val_auroc:  0.8224104074619538 val_auprc:  0.9035066710619511
EarlyStopping counter: 30 out of 50
epoch:  161
epoch:  162 val_f1:  0.7873856121514594 val_auroc:  0.8230240549828178 val_auprc:  0.9052731387101012
EarlyStopping counter: 31 out of 50
epoch:  162
epoch:  163 val_f1:  0.7938350857775318 val_auroc:  0.8199558173784978 val_auprc:  0.8987296132460135
EarlyStopping counter: 32 out of 50
epoch:  163
epoch:  164 val_f1:  0.7898876447331801 val_auroc:  0.8237604320078546 val_auprc:  0.9010699657763329
EarlyStopping counter: 33 out of 50
epoch:  164
epoch:  165 val_f1:  0.7955599157038007 val_auroc:  0.8225331369661266 val_auprc:  0.9044835239732862
EarlyStopping counter: 34 out of 50
epoch:  165
epoch:  166 val_f1:  0.7762067639678805 val_auroc:  0.8209376534118803 val_auprc:  0.9023090955019861
EarlyStopping counter: 35 out of 50
epoch:  166
epoch:  167 val_f1:  0.8003084642191267 val_auroc:  0.8208149239077075 val_auprc:  0.8986353032467177
EarlyStopping counter: 36 out of 50
epoch:  167
epoch:  168 val_f1:  0.7938350857775318 val_auroc:  0.8217967599410898 val_auprc:  0.8991570551561534
EarlyStopping counter: 37 out of 50
epoch:  168
epoch:  169 val_f1:  0.7873856121514594 val_auroc:  0.8206921944035345 val_auprc:  0.8985358995879984
EarlyStopping counter: 38 out of 50
epoch:  169
epoch:  170 val_f1:  0.7826417810500232 val_auroc:  0.823514972999509 val_auprc:  0.9051152114616958
EarlyStopping counter: 39 out of 50
epoch:  170
epoch:  171 val_f1:  0.7938350857775318 val_auroc:  0.819833087874325 val_auprc:  0.899176810656143
EarlyStopping counter: 40 out of 50
epoch:  171
epoch:  172 val_f1:  0.7919479944965341 val_auroc:  0.8182376043200785 val_auprc:  0.8957259650228718
EarlyStopping counter: 41 out of 50
epoch:  172
epoch:  173 val_f1:  0.7873856121514594 val_auroc:  0.8200785468826706 val_auprc:  0.8982782447183345
EarlyStopping counter: 42 out of 50
epoch:  173
epoch:  174 val_f1:  0.7873856121514594 val_auroc:  0.8213058419243986 val_auprc:  0.8987151400101396
EarlyStopping counter: 43 out of 50
epoch:  174
epoch:  175 val_f1:  0.7938350857775318 val_auroc:  0.8215513009327442 val_auprc:  0.8999860886048009
EarlyStopping counter: 44 out of 50
epoch:  175
epoch:  176 val_f1:  0.7873856121514594 val_auroc:  0.8203240058910163 val_auprc:  0.8993477253140627
EarlyStopping counter: 45 out of 50
epoch:  176
epoch:  177 val_f1:  0.7873856121514594 val_auroc:  0.8203240058910162 val_auprc:  0.8991734425608463
EarlyStopping counter: 46 out of 50
epoch:  177
epoch:  178 val_f1:  0.7826417810500232 val_auroc:  0.820446735395189 val_auprc:  0.8985035547181532
EarlyStopping counter: 47 out of 50
epoch:  178
epoch:  179 val_f1:  0.8020486733823933 val_auroc:  0.8203240058910163 val_auprc:  0.8994293504823705
EarlyStopping counter: 48 out of 50
epoch:  179
epoch:  180 val_f1:  0.7834737923946559 val_auroc:  0.8215513009327442 val_auprc:  0.8993922156470795
EarlyStopping counter: 49 out of 50
epoch:  180
epoch:  181 val_f1:  0.7873856121514594 val_auroc:  0.822287677957781 val_auprc:  0.899938583938704
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  5310.773774623871
{'time_elapsed': [5310.773774623871], 'epoch': [180], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7873856121514594], 'auroc_test': [0.822287677957781], 'auprc_test': [0.899938583938704]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1276]          8,192
│    └─BatchNorm1d: 2-2                  [64, 1024, 1276]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1276]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1270]          --
│    └─Dropout: 2-5                      [64, 1024, 1270]          --
│    └─Flatten: 2-6                      [64, 1300480]             --
│    └─Linear: 2-7                       [64, 1]                   1,300,481
==========================================================================================
Total params: 1,310,721
Trainable params: 1,310,721
Non-trainable params: 0
Total mult-adds (M): 752.35
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1337.98
Params size (MB): 5.24
Estimated Total Size (MB): 1343.55
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.5672557682866961 val_auprc:  0.7820660875650627
epoch:  1
epoch:  2 val_f1:  0.5833669847381143 val_auroc:  0.4855179185076093 val_auprc:  0.8156400465790492
Validation loss improved to 10.653990
epoch:  2
epoch:  3 val_f1:  0.3955779898225941 val_auroc:  0.5202503681885126 val_auprc:  0.7362321680782632
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.575283462550348 val_auroc:  0.4888316151202749 val_auprc:  0.8038148238618085
Validation loss improved to 9.974977
epoch:  4
epoch:  5 val_f1:  0.4124348406400523 val_auroc:  0.5515463917525775 val_auprc:  0.7627728368936612
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.5839205229810392 val_auroc:  0.5612420225822288 val_auprc:  0.8072243678745912
Validation loss improved to 6.671797
epoch:  6
epoch:  7 val_f1:  0.5950569214957703 val_auroc:  0.5533873343151693 val_auprc:  0.7837560798628788
Validation loss improved to 5.381690
epoch:  7
epoch:  8 val_f1:  0.5253339252373057 val_auroc:  0.6033382425135002 val_auprc:  0.8071742420777039
Validation loss improved to 4.943410
epoch:  8
epoch:  9 val_f1:  0.5238035658429778 val_auroc:  0.6303387334315169 val_auprc:  0.8232433048830129
Validation loss improved to 4.693055
epoch:  9
epoch:  10 val_f1:  0.5985139007438117 val_auroc:  0.6593028964162985 val_auprc:  0.8363090953506659
Validation loss improved to 3.232341
epoch:  10
epoch:  11 val_f1:  0.5912428769525999 val_auroc:  0.6723122238586157 val_auprc:  0.8392337423688644
Validation loss improved to 3.071503
epoch:  11
epoch:  12 val_f1:  0.619566649594801 val_auroc:  0.6842169857633775 val_auprc:  0.8428185878805384
Validation loss improved to 2.690229
epoch:  12
epoch:  13 val_f1:  0.6237171971681137 val_auroc:  0.6961217476681394 val_auprc:  0.8532927770068797
Validation loss improved to 2.469138
epoch:  13
epoch:  14 val_f1:  0.6472345296242701 val_auroc:  0.7056946489936181 val_auprc:  0.8596118465357105
Validation loss improved to 1.911850
epoch:  14
epoch:  15 val_f1:  0.6685291048291022 val_auroc:  0.7172312223858616 val_auprc:  0.8652930285540059
Validation loss improved to 1.611291
epoch:  15
epoch:  16 val_f1:  0.6848314670997702 val_auroc:  0.7174766813942072 val_auprc:  0.8625294465399719
Validation loss improved to 1.202426
epoch:  16
epoch:  17 val_f1:  0.6610684696390046 val_auroc:  0.7248404516445753 val_auprc:  0.8691440436036926
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.702782849280763 val_auroc:  0.7322042218949435 val_auprc:  0.8724455775230234
Validation loss improved to 1.004901
epoch:  18
epoch:  19 val_f1:  0.48132637341270434 val_auroc:  0.735640648011782 val_auprc:  0.8721442667880444
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.5995286180919475 val_auroc:  0.7464408443789887 val_auprc:  0.8782666960782685
EarlyStopping counter: 2 out of 50
epoch:  20
epoch:  21 val_f1:  0.7166849710626011 val_auroc:  0.7471772214040255 val_auprc:  0.8749876029491062
Validation loss improved to 0.956781
epoch:  21
epoch:  22 val_f1:  0.713247796930704 val_auroc:  0.7552773686794305 val_auprc:  0.8798897531239969
Validation loss improved to 0.855394
epoch:  22
epoch:  23 val_f1:  0.7028070029525513 val_auroc:  0.7579774177712322 val_auprc:  0.8825653225072171
Validation loss improved to 0.853975
epoch:  23
epoch:  24 val_f1:  0.703263898025454 val_auroc:  0.7641138929798723 val_auprc:  0.8865624235716307
Validation loss improved to 0.795770
epoch:  24
epoch:  25 val_f1:  0.6967556353929608 val_auroc:  0.7601865488463427 val_auprc:  0.8838241257272572
Validation loss improved to 0.678863
epoch:  25
epoch:  26 val_f1:  0.7084342413709481 val_auroc:  0.7557682866961217 val_auprc:  0.8808624901207333
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.6385973188662184 val_auroc:  0.7619047619047619 val_auprc:  0.8854273820218262
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.6301488691399822 val_auroc:  0.7660775650466372 val_auprc:  0.8885034856031598
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.44829341232896036 val_auroc:  0.7690230731467845 val_auprc:  0.8894064659098274
EarlyStopping counter: 4 out of 50
epoch:  29
epoch:  30 val_f1:  0.448701316374391 val_auroc:  0.7692685321551301 val_auprc:  0.8905580296989762
EarlyStopping counter: 5 out of 50
epoch:  30
epoch:  31 val_f1:  0.7121336235283787 val_auroc:  0.7719685812469318 val_auprc:  0.893754677693904
Validation loss improved to 0.578506
epoch:  31
epoch:  32 val_f1:  0.5266574619092604 val_auroc:  0.7717231222385861 val_auprc:  0.8922826173265032
EarlyStopping counter: 1 out of 50
epoch:  32
epoch:  33 val_f1:  0.6406602727799046 val_auroc:  0.7554000981836033 val_auprc:  0.8795722774343246
EarlyStopping counter: 2 out of 50
epoch:  33
epoch:  34 val_f1:  0.6945501576267077 val_auroc:  0.7619047619047619 val_auprc:  0.8836760251233848
EarlyStopping counter: 3 out of 50
epoch:  34
epoch:  35 val_f1:  0.7030919944895149 val_auroc:  0.7729504172803142 val_auprc:  0.8934974196538776
EarlyStopping counter: 4 out of 50
epoch:  35
epoch:  36 val_f1:  0.6956980834430598 val_auroc:  0.7685321551300932 val_auprc:  0.8903750877711463
EarlyStopping counter: 5 out of 50
epoch:  36
epoch:  37 val_f1:  0.6289646282660997 val_auroc:  0.770495827196858 val_auprc:  0.8916801327677459
EarlyStopping counter: 6 out of 50
epoch:  37
epoch:  38 val_f1:  0.6823403921278894 val_auroc:  0.7736867943053509 val_auprc:  0.8924875226948621
EarlyStopping counter: 7 out of 50
epoch:  38
epoch:  39 val_f1:  0.6824751963135375 val_auroc:  0.7596956308296515 val_auprc:  0.8835365175770971
EarlyStopping counter: 8 out of 50
epoch:  39
epoch:  40 val_f1:  0.7117994924448791 val_auroc:  0.7560137457044673 val_auprc:  0.8823869141042204
EarlyStopping counter: 9 out of 50
epoch:  40
epoch:  41 val_f1:  0.6677356419948787 val_auroc:  0.7675503190967109 val_auprc:  0.8885291055047719
EarlyStopping counter: 10 out of 50
epoch:  41
epoch:  42 val_f1:  0.6276318729626881 val_auroc:  0.7719685812469318 val_auprc:  0.8900814220041109
EarlyStopping counter: 11 out of 50
epoch:  42
epoch:  43 val_f1:  0.4070174368979393 val_auroc:  0.7785959744722631 val_auprc:  0.8946510769481849
EarlyStopping counter: 12 out of 50
epoch:  43
epoch:  44 val_f1:  0.4624280575539569 val_auroc:  0.7788414334806087 val_auprc:  0.893130871864114
EarlyStopping counter: 13 out of 50
epoch:  44
epoch:  45 val_f1:  0.7122302158273381 val_auroc:  0.7763868433971527 val_auprc:  0.8914654032235907
EarlyStopping counter: 14 out of 50
epoch:  45
epoch:  46 val_f1:  0.7002679453520968 val_auroc:  0.7722140402552773 val_auprc:  0.8875472612242731
EarlyStopping counter: 15 out of 50
epoch:  46
epoch:  47 val_f1:  0.6892815309975336 val_auroc:  0.7768777614138438 val_auprc:  0.8891496064370544
EarlyStopping counter: 16 out of 50
epoch:  47
epoch:  48 val_f1:  0.6945501576267077 val_auroc:  0.7722140402552774 val_auprc:  0.8862722869070556
EarlyStopping counter: 17 out of 50
epoch:  48
epoch:  49 val_f1:  0.7226305629385982 val_auroc:  0.7744231713303877 val_auprc:  0.8902541334171175
EarlyStopping counter: 18 out of 50
epoch:  49
epoch:  50 val_f1:  0.7115566705387387 val_auroc:  0.7682866961217477 val_auprc:  0.8859900793126374
EarlyStopping counter: 19 out of 50
epoch:  50
epoch:  51 val_f1:  0.6663975251072785 val_auroc:  0.7754050073637703 val_auprc:  0.8888526246683126
EarlyStopping counter: 20 out of 50
epoch:  51
epoch:  52 val_f1:  0.5979348628901833 val_auroc:  0.7822778595974471 val_auprc:  0.8894090695226962
EarlyStopping counter: 21 out of 50
epoch:  52
epoch:  53 val_f1:  0.7223183251151889 val_auroc:  0.7876779577810505 val_auprc:  0.8981806223913029
Validation loss improved to 0.544604
epoch:  53
epoch:  54 val_f1:  0.7473654218886486 val_auroc:  0.781786941580756 val_auprc:  0.8926996434983687
EarlyStopping counter: 1 out of 50
epoch:  54
epoch:  55 val_f1:  0.6864080164439876 val_auroc:  0.7744231713303878 val_auprc:  0.886808934558537
EarlyStopping counter: 2 out of 50
epoch:  55
epoch:  56 val_f1:  0.7092263500553166 val_auroc:  0.7908689248895434 val_auprc:  0.9001211520601746
EarlyStopping counter: 3 out of 50
epoch:  56
epoch:  57 val_f1:  0.7386752666832053 val_auroc:  0.7751595483554247 val_auprc:  0.8886376849392108
EarlyStopping counter: 4 out of 50
epoch:  57
epoch:  58 val_f1:  0.7233618940391454 val_auroc:  0.7729504172803142 val_auprc:  0.8897937468474202
EarlyStopping counter: 5 out of 50
epoch:  58
epoch:  59 val_f1:  0.7197172881491292 val_auroc:  0.7700049091801668 val_auprc:  0.8881409136820503
EarlyStopping counter: 6 out of 50
epoch:  59
epoch:  60 val_f1:  0.7144317414801258 val_auroc:  0.771232204221895 val_auprc:  0.8875362549103424
EarlyStopping counter: 7 out of 50
epoch:  60
epoch:  61 val_f1:  0.7299542184434271 val_auroc:  0.7702503681885126 val_auprc:  0.8816078704850292
EarlyStopping counter: 8 out of 50
epoch:  61
epoch:  62 val_f1:  0.7166849710626011 val_auroc:  0.7771232204221895 val_auprc:  0.8903140870899028
EarlyStopping counter: 9 out of 50
epoch:  62
epoch:  63 val_f1:  0.7287333672277241 val_auroc:  0.7685321551300933 val_auprc:  0.8848392821177512
EarlyStopping counter: 10 out of 50
epoch:  63
epoch:  64 val_f1:  0.6937535685737124 val_auroc:  0.7488954344624449 val_auprc:  0.86731206683501
EarlyStopping counter: 11 out of 50
epoch:  64
epoch:  65 val_f1:  0.6743799189283424 val_auroc:  0.7714776632302406 val_auprc:  0.8879805955980105
Validation loss improved to 0.526269
epoch:  65
epoch:  66 val_f1:  0.7249644134959412 val_auroc:  0.7636229749631812 val_auprc:  0.8801425139631757
EarlyStopping counter: 1 out of 50
epoch:  66
epoch:  67 val_f1:  0.6618558114706329 val_auroc:  0.7740549828178694 val_auprc:  0.888537479532952
EarlyStopping counter: 2 out of 50
epoch:  67
epoch:  68 val_f1:  0.6810035515891084 val_auroc:  0.7663230240549829 val_auprc:  0.8884163701136337
EarlyStopping counter: 3 out of 50
epoch:  68
epoch:  69 val_f1:  0.7203480251458693 val_auroc:  0.7704958271968582 val_auprc:  0.8895852350637985
EarlyStopping counter: 4 out of 50
epoch:  69
epoch:  70 val_f1:  0.7121336235283787 val_auroc:  0.7714776632302406 val_auprc:  0.8818393541262439
EarlyStopping counter: 5 out of 50
epoch:  70
epoch:  71 val_f1:  0.7325045643526866 val_auroc:  0.7653411880216004 val_auprc:  0.8774711950083374
EarlyStopping counter: 6 out of 50
epoch:  71
epoch:  72 val_f1:  0.7235944791518311 val_auroc:  0.7628865979381444 val_auprc:  0.8767745739974437
EarlyStopping counter: 7 out of 50
epoch:  72
epoch:  73 val_f1:  0.7536606851900262 val_auroc:  0.7650957290132547 val_auprc:  0.8787091007894846
EarlyStopping counter: 8 out of 50
epoch:  73
epoch:  74 val_f1:  0.6752910608296504 val_auroc:  0.7697594501718213 val_auprc:  0.8838831057385618
Validation loss improved to 0.493970
epoch:  74
epoch:  75 val_f1:  0.7082463061808618 val_auroc:  0.7660775650466373 val_auprc:  0.8801276483670213
EarlyStopping counter: 1 out of 50
epoch:  75
epoch:  76 val_f1:  0.6893510131556864 val_auroc:  0.7625184094256259 val_auprc:  0.879784032082704
Validation loss improved to 0.489305
epoch:  76
epoch:  77 val_f1:  0.7473302173830908 val_auroc:  0.7565046637211587 val_auprc:  0.8688059387172475
EarlyStopping counter: 1 out of 50
epoch:  77
epoch:  78 val_f1:  0.7235944791518311 val_auroc:  0.7636229749631812 val_auprc:  0.8785640922640446
EarlyStopping counter: 2 out of 50
epoch:  78
epoch:  79 val_f1:  0.7363119073255568 val_auroc:  0.7680412371134021 val_auprc:  0.8827834986359768
EarlyStopping counter: 3 out of 50
epoch:  79
epoch:  80 val_f1:  0.7426698176342648 val_auroc:  0.7717231222385861 val_auprc:  0.8841070337192647
EarlyStopping counter: 4 out of 50
epoch:  80
epoch:  81 val_f1:  0.7536606851900262 val_auroc:  0.7614138438880708 val_auprc:  0.8731422595227746
EarlyStopping counter: 5 out of 50
epoch:  81
epoch:  82 val_f1:  0.7681512331200245 val_auroc:  0.768041237113402 val_auprc:  0.8821148023946135
EarlyStopping counter: 6 out of 50
epoch:  82
epoch:  83 val_f1:  0.7235944791518311 val_auroc:  0.7604320078546883 val_auprc:  0.8758503689653376
Validation loss improved to 0.479275
epoch:  83
epoch:  84 val_f1:  0.7237424247793883 val_auroc:  0.7589592538046146 val_auprc:  0.8743997256002102
EarlyStopping counter: 1 out of 50
epoch:  84
epoch:  85 val_f1:  0.7235944791518311 val_auroc:  0.7626411389297987 val_auprc:  0.877532732199742
EarlyStopping counter: 2 out of 50
epoch:  85
epoch:  86 val_f1:  0.7553956834532374 val_auroc:  0.7552773686794305 val_auprc:  0.8689714072794199
EarlyStopping counter: 3 out of 50
epoch:  86
epoch:  87 val_f1:  0.7536606851900262 val_auroc:  0.7555228276877761 val_auprc:  0.8715665689409784
EarlyStopping counter: 4 out of 50
epoch:  87
epoch:  88 val_f1:  0.6687180376180983 val_auroc:  0.750613647520864 val_auprc:  0.8691011366977806
Validation loss improved to 0.474092
epoch:  88
epoch:  89 val_f1:  0.7617684906754855 val_auroc:  0.7616593028964163 val_auprc:  0.878092016331435
EarlyStopping counter: 1 out of 50
epoch:  89
epoch:  90 val_f1:  0.7313689473952751 val_auroc:  0.7503681885125185 val_auprc:  0.8641012844096245
EarlyStopping counter: 2 out of 50
epoch:  90
epoch:  91 val_f1:  0.675081516585215 val_auroc:  0.7669366715758469 val_auprc:  0.8816754918865557
EarlyStopping counter: 3 out of 50
epoch:  91
epoch:  92 val_f1:  0.6872202593435662 val_auroc:  0.7528227785959745 val_auprc:  0.863735803865512
EarlyStopping counter: 4 out of 50
epoch:  92
epoch:  93 val_f1:  0.6909311987030095 val_auroc:  0.7685321551300932 val_auprc:  0.8805289129375771
EarlyStopping counter: 5 out of 50
epoch:  93
epoch:  94 val_f1:  0.6825214527173443 val_auroc:  0.7550319096710849 val_auprc:  0.8604981775054537
EarlyStopping counter: 6 out of 50
epoch:  94
epoch:  95 val_f1:  0.6909311987030095 val_auroc:  0.7744231713303877 val_auprc:  0.8838548174573333
EarlyStopping counter: 7 out of 50
epoch:  95
epoch:  96 val_f1:  0.6962806225607748 val_auroc:  0.7601865488463426 val_auprc:  0.8633366527967918
EarlyStopping counter: 8 out of 50
epoch:  96
epoch:  97 val_f1:  0.6926107129156205 val_auroc:  0.758100147275405 val_auprc:  0.8698057762921231
EarlyStopping counter: 9 out of 50
epoch:  97
epoch:  98 val_f1:  0.6825671929988476 val_auroc:  0.7687776141384389 val_auprc:  0.8772201328726548
Validation loss improved to 0.470329
epoch:  98
epoch:  99 val_f1:  0.7559325673789327 val_auroc:  0.7577319587628866 val_auprc:  0.856538223641968
EarlyStopping counter: 1 out of 50
epoch:  99
epoch:  100 val_f1:  0.6677356419948787 val_auroc:  0.766813942071674 val_auprc:  0.8766590743821387
EarlyStopping counter: 2 out of 50
epoch:  100
epoch:  101 val_f1:  0.66505973282868 val_auroc:  0.7793323514973 val_auprc:  0.8858709907800864
EarlyStopping counter: 3 out of 50
epoch:  101
epoch:  102 val_f1:  0.6289646282660997 val_auroc:  0.7650957290132548 val_auprc:  0.8811869860623094
EarlyStopping counter: 4 out of 50
epoch:  102
epoch:  103 val_f1:  0.6951318622544138 val_auroc:  0.7741777123220422 val_auprc:  0.8910526637134413
EarlyStopping counter: 5 out of 50
epoch:  103
epoch:  104 val_f1:  0.7633714058926586 val_auroc:  0.770004909180167 val_auprc:  0.873566449663912
EarlyStopping counter: 6 out of 50
epoch:  104
epoch:  105 val_f1:  0.7490302789770621 val_auroc:  0.7702503681885124 val_auprc:  0.8703357051328471
EarlyStopping counter: 7 out of 50
epoch:  105
epoch:  106 val_f1:  0.7633714058926586 val_auroc:  0.7788414334806087 val_auprc:  0.881518105825335
EarlyStopping counter: 8 out of 50
epoch:  106
epoch:  107 val_f1:  0.7553956834532374 val_auroc:  0.768041237113402 val_auprc:  0.8690961216365718
EarlyStopping counter: 9 out of 50
epoch:  107
epoch:  108 val_f1:  0.7617684906754855 val_auroc:  0.7603092783505155 val_auprc:  0.8672541494562259
EarlyStopping counter: 10 out of 50
epoch:  108
epoch:  109 val_f1:  0.76000113614692 val_auroc:  0.7600638193421699 val_auprc:  0.8625678723154853
EarlyStopping counter: 11 out of 50
epoch:  109
epoch:  110 val_f1:  0.7519437633413868 val_auroc:  0.7682866961217477 val_auprc:  0.8727559001484927
EarlyStopping counter: 12 out of 50
epoch:  110
epoch:  111 val_f1:  0.7490302789770621 val_auroc:  0.7574864997545411 val_auprc:  0.8630330358329175
EarlyStopping counter: 13 out of 50
epoch:  111
epoch:  112 val_f1:  0.7553956834532374 val_auroc:  0.7557682866961217 val_auprc:  0.8631709321676254
EarlyStopping counter: 14 out of 50
epoch:  112
epoch:  113 val_f1:  0.7617684906754855 val_auroc:  0.7609229258713794 val_auprc:  0.8678705021445441
EarlyStopping counter: 15 out of 50
epoch:  113
epoch:  114 val_f1:  0.766354189375772 val_auroc:  0.7535591556210114 val_auprc:  0.8576543473016182
EarlyStopping counter: 16 out of 50
epoch:  114
epoch:  115 val_f1:  0.7681512331200245 val_auroc:  0.7573637702503682 val_auprc:  0.8629948232373721
EarlyStopping counter: 17 out of 50
epoch:  115
epoch:  116 val_f1:  0.7553956834532374 val_auroc:  0.7584683357879235 val_auprc:  0.8653978227171053
EarlyStopping counter: 18 out of 50
epoch:  116
epoch:  117 val_f1:  0.7553956834532374 val_auroc:  0.7601865488463426 val_auprc:  0.8697542762703119
EarlyStopping counter: 19 out of 50
epoch:  117
epoch:  118 val_f1:  0.766354189375772 val_auroc:  0.752577319587629 val_auprc:  0.8578466301426815
EarlyStopping counter: 20 out of 50
epoch:  118
epoch:  119 val_f1:  0.766354189375772 val_auroc:  0.751840942562592 val_auprc:  0.8574184091735806
EarlyStopping counter: 21 out of 50
epoch:  119
epoch:  120 val_f1:  0.7496568898727172 val_auroc:  0.7545409916543937 val_auprc:  0.8601350600578705
EarlyStopping counter: 22 out of 50
epoch:  120
epoch:  121 val_f1:  0.7681512331200245 val_auroc:  0.7527000490918018 val_auprc:  0.858930896013675
EarlyStopping counter: 23 out of 50
epoch:  121
epoch:  122 val_f1:  0.7745465218349855 val_auroc:  0.7542955326460481 val_auprc:  0.8599804219309971
EarlyStopping counter: 24 out of 50
epoch:  122
epoch:  123 val_f1:  0.7411406017655346 val_auroc:  0.7540500736377025 val_auprc:  0.8584245559190136
EarlyStopping counter: 25 out of 50
epoch:  123
epoch:  124 val_f1:  0.7745465218349855 val_auroc:  0.7538046146293569 val_auprc:  0.8582923723780522
EarlyStopping counter: 26 out of 50
epoch:  124
epoch:  125 val_f1:  0.7745465218349855 val_auroc:  0.7566273932253313 val_auprc:  0.8619600597070044
EarlyStopping counter: 27 out of 50
epoch:  125
epoch:  126 val_f1:  0.7681512331200245 val_auroc:  0.7540500736377025 val_auprc:  0.8586996409549164
EarlyStopping counter: 28 out of 50
epoch:  126
epoch:  127 val_f1:  0.7681512331200245 val_auroc:  0.7533136966126657 val_auprc:  0.8597553438713204
EarlyStopping counter: 29 out of 50
epoch:  127
epoch:  128 val_f1:  0.7681512331200245 val_auroc:  0.7486499754540992 val_auprc:  0.8543338119446282
EarlyStopping counter: 30 out of 50
epoch:  128
epoch:  129 val_f1:  0.7411406017655346 val_auroc:  0.748159057437408 val_auprc:  0.8557714881852772
EarlyStopping counter: 31 out of 50
epoch:  129
epoch:  130 val_f1:  0.7411406017655346 val_auroc:  0.7492636229749632 val_auprc:  0.8562181788368728
EarlyStopping counter: 32 out of 50
epoch:  130
epoch:  131 val_f1:  0.7580594896895918 val_auroc:  0.7552773686794305 val_auprc:  0.8641460411658918
EarlyStopping counter: 33 out of 50
epoch:  131
epoch:  132 val_f1:  0.7745465218349855 val_auroc:  0.7530682376043201 val_auprc:  0.8592971599850703
EarlyStopping counter: 34 out of 50
epoch:  132
epoch:  133 val_f1:  0.7580594896895918 val_auroc:  0.751840942562592 val_auprc:  0.8574336078463156
EarlyStopping counter: 35 out of 50
epoch:  133
epoch:  134 val_f1:  0.766354189375772 val_auroc:  0.7523318605792833 val_auprc:  0.8577918486781465
EarlyStopping counter: 36 out of 50
epoch:  134
epoch:  135 val_f1:  0.7580594896895918 val_auroc:  0.7582228767795778 val_auprc:  0.8632975788485311
EarlyStopping counter: 37 out of 50
epoch:  135
epoch:  136 val_f1:  0.7617684906754855 val_auroc:  0.7542955326460481 val_auprc:  0.8589338515056377
EarlyStopping counter: 38 out of 50
epoch:  136
epoch:  137 val_f1:  0.7745465218349855 val_auroc:  0.7535591556210113 val_auprc:  0.8585399889012899
EarlyStopping counter: 39 out of 50
epoch:  137
epoch:  138 val_f1:  0.7496568898727172 val_auroc:  0.7541728031418753 val_auprc:  0.8587278383605071
EarlyStopping counter: 40 out of 50
epoch:  138
epoch:  139 val_f1:  0.7386752666832053 val_auroc:  0.7496318114874816 val_auprc:  0.8539951774647532
EarlyStopping counter: 41 out of 50
epoch:  139
epoch:  140 val_f1:  0.7580594896895918 val_auroc:  0.7525773195876289 val_auprc:  0.8582853168473222
EarlyStopping counter: 42 out of 50
epoch:  140
epoch:  141 val_f1:  0.7580594896895918 val_auroc:  0.7508591065292096 val_auprc:  0.8575288152721596
EarlyStopping counter: 43 out of 50
epoch:  141
epoch:  142 val_f1:  0.7580594896895918 val_auroc:  0.7531909671084929 val_auprc:  0.8580828673159602
EarlyStopping counter: 44 out of 50
epoch:  142
epoch:  143 val_f1:  0.7681512331200245 val_auroc:  0.7535591556210113 val_auprc:  0.8585088101797586
EarlyStopping counter: 45 out of 50
epoch:  143
epoch:  144 val_f1:  0.7745465218349855 val_auroc:  0.7533136966126657 val_auprc:  0.858202581418298
EarlyStopping counter: 46 out of 50
epoch:  144
epoch:  145 val_f1:  0.7580594896895918 val_auroc:  0.7525773195876289 val_auprc:  0.8579321562214839
EarlyStopping counter: 47 out of 50
epoch:  145
epoch:  146 val_f1:  0.7681512331200245 val_auroc:  0.7530682376043201 val_auprc:  0.8581485408645078
EarlyStopping counter: 48 out of 50
epoch:  146
epoch:  147 val_f1:  0.7580594896895918 val_auroc:  0.7533136966126657 val_auprc:  0.8585716500050751
EarlyStopping counter: 49 out of 50
epoch:  147
epoch:  148 val_f1:  0.7325045643526866 val_auroc:  0.7520864015709378 val_auprc:  0.8568012854202158
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  4291.955718755722
{'time_elapsed': [4291.955718755722], 'epoch': [147], 'fold': [2], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7325045643526866], 'auroc_test': [0.7520864015709378], 'auprc_test': [0.8568012854202158]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1276]          8,192
│    └─BatchNorm1d: 2-2                  [64, 1024, 1276]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1276]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1270]          --
│    └─Dropout: 2-5                      [64, 1024, 1270]          --
│    └─Flatten: 2-6                      [64, 1300480]             --
│    └─Linear: 2-7                       [64, 1]                   1,300,481
==========================================================================================
Total params: 1,310,721
Trainable params: 1,310,721
Non-trainable params: 0
Total mult-adds (M): 752.35
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1337.98
Params size (MB): 5.24
Estimated Total Size (MB): 1343.55
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1461775634437505 val_auroc:  0.6615794573643411 val_auprc:  0.8324093375160608
epoch:  1
epoch:  2 val_f1:  0.5900817381154188 val_auroc:  0.5191375968992249 val_auprc:  0.8276157454849546
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.3008745763337981 val_auroc:  0.5849079457364341 val_auprc:  0.7340330436270962
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6233740548062287 val_auroc:  0.5694040697674418 val_auprc:  0.8076980534416125
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.5757046833975679 val_auroc:  0.6263323643410852 val_auprc:  0.8124953821552405
Validation loss improved to 5.691922
epoch:  5
epoch:  6 val_f1:  0.5927742805755396 val_auroc:  0.6541908914728684 val_auprc:  0.8224868650690237
Validation loss improved to 4.335346
epoch:  6
epoch:  7 val_f1:  0.6643077374834826 val_auroc:  0.6762354651162792 val_auprc:  0.840820089686007
Validation loss improved to 2.148734
epoch:  7
epoch:  8 val_f1:  0.6728982771229824 val_auroc:  0.7288032945736433 val_auprc:  0.8684957994044356
Validation loss improved to 1.486821
epoch:  8
epoch:  9 val_f1:  0.6823179642859383 val_auroc:  0.7623546511627907 val_auprc:  0.8880742274014729
Validation loss improved to 1.103895
epoch:  9
epoch:  10 val_f1:  0.6823179642859383 val_auroc:  0.7747093023255814 val_auprc:  0.8992801447062693
Validation loss improved to 0.901124
epoch:  10
epoch:  11 val_f1:  0.6934061097831205 val_auroc:  0.781734496124031 val_auprc:  0.9012325141601726
Validation loss improved to 0.764306
epoch:  11
epoch:  12 val_f1:  0.7153390575965436 val_auroc:  0.7899709302325582 val_auprc:  0.905185201357222
Validation loss improved to 0.744322
epoch:  12
epoch:  13 val_f1:  0.6476914102813383 val_auroc:  0.7919089147286821 val_auprc:  0.9056020594743472
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7540304643278981 val_auroc:  0.7969961240310077 val_auprc:  0.9091376744782625
Validation loss improved to 0.555501
epoch:  14
epoch:  15 val_f1:  0.6976939932092291 val_auroc:  0.8035368217054263 val_auprc:  0.9129643072138867
Validation loss improved to 0.482553
epoch:  15
epoch:  16 val_f1:  0.7052780852241284 val_auroc:  0.8040213178294574 val_auprc:  0.9136043795706907
Validation loss improved to 0.427681
epoch:  16
epoch:  17 val_f1:  0.7062692702980472 val_auroc:  0.8083817829457364 val_auprc:  0.9136759512728461
Validation loss improved to 0.411273
epoch:  17
epoch:  18 val_f1:  0.7127977403917272 val_auroc:  0.8086240310077519 val_auprc:  0.91469160337769
Validation loss improved to 0.400490
epoch:  18
epoch:  19 val_f1:  0.723068298607867 val_auroc:  0.8117732558139535 val_auprc:  0.9160073148644561
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7161416160715836 val_auroc:  0.8156492248062016 val_auprc:  0.9178893319657113
EarlyStopping counter: 2 out of 50
epoch:  20
epoch:  21 val_f1:  0.7303789068797073 val_auroc:  0.815406976744186 val_auprc:  0.9177165791647592
Validation loss improved to 0.400090
epoch:  21
epoch:  22 val_f1:  0.721504530365855 val_auroc:  0.8197674418604651 val_auprc:  0.9204749327497671
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.709329623679697 val_auroc:  0.8214631782945737 val_auprc:  0.922768127018465
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.6945997783626993 val_auroc:  0.8253391472868216 val_auprc:  0.9243392419142966
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.7247733477430133 val_auroc:  0.8250968992248061 val_auprc:  0.921589986863673
Validation loss improved to 0.249069
epoch:  25
epoch:  26 val_f1:  0.7289507977529213 val_auroc:  0.8195251937984496 val_auprc:  0.9172541527045052
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7224728691622972 val_auroc:  0.8287306201550388 val_auprc:  0.9257543728240828
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7504468335444003 val_auroc:  0.8323643410852714 val_auprc:  0.9276984877889453
Validation loss improved to 0.211933
epoch:  28
epoch:  29 val_f1:  0.7410071942446043 val_auroc:  0.8364825581395349 val_auprc:  0.928257805079205
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.7659382513381667 val_auroc:  0.8359980620155038 val_auprc:  0.9305169479395232
Validation loss improved to 0.194029
epoch:  30
epoch:  31 val_f1:  0.7504468335444003 val_auroc:  0.8384205426356589 val_auprc:  0.9322870439923349
Validation loss improved to 0.190875
epoch:  31
epoch:  32 val_f1:  0.7504468335444003 val_auroc:  0.8376937984496123 val_auprc:  0.929379988228701
Validation loss improved to 0.187285
epoch:  32
epoch:  33 val_f1:  0.7052680436296125 val_auroc:  0.8410852713178295 val_auprc:  0.9316340857579204
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.7582291613517698 val_auroc:  0.8384205426356589 val_auprc:  0.9325856866449356
Validation loss improved to 0.175748
epoch:  34
epoch:  35 val_f1:  0.7548273393587915 val_auroc:  0.8398740310077519 val_auprc:  0.9326488109122331
EarlyStopping counter: 1 out of 50
epoch:  35
epoch:  36 val_f1:  0.7414744243025527 val_auroc:  0.841812015503876 val_auprc:  0.9351282992304184
EarlyStopping counter: 2 out of 50
epoch:  36
epoch:  37 val_f1:  0.6772983895802233 val_auroc:  0.8410852713178295 val_auprc:  0.9331204140987718
EarlyStopping counter: 3 out of 50
epoch:  37
epoch:  38 val_f1:  0.5807465915379585 val_auroc:  0.8424176356589147 val_auprc:  0.9318624838971812
EarlyStopping counter: 4 out of 50
epoch:  38
epoch:  39 val_f1:  0.7784546388862936 val_auroc:  0.8418120155038761 val_auprc:  0.936866422611105
Validation loss improved to 0.173961
epoch:  39
epoch:  40 val_f1:  0.7569846453580755 val_auroc:  0.8420542635658915 val_auprc:  0.9356734740078406
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.7477439586792105 val_auroc:  0.844718992248062 val_auprc:  0.9322355355257705
EarlyStopping counter: 2 out of 50
epoch:  41
epoch:  42 val_f1:  0.7688372056811462 val_auroc:  0.8471414728682172 val_auprc:  0.9331496062451474
EarlyStopping counter: 3 out of 50
epoch:  42
epoch:  43 val_f1:  0.7735780520043992 val_auroc:  0.8473837209302326 val_auprc:  0.9359692157530408
Validation loss improved to 0.164614
epoch:  43
epoch:  44 val_f1:  0.6922739095276795 val_auroc:  0.845203488372093 val_auprc:  0.935838352631283
EarlyStopping counter: 1 out of 50
epoch:  44
epoch:  45 val_f1:  0.7695564219015847 val_auroc:  0.841327519379845 val_auprc:  0.931588204030319
Validation loss improved to 0.161619
epoch:  45
epoch:  46 val_f1:  0.7571561248111338 val_auroc:  0.844718992248062 val_auprc:  0.9326715458473732
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.7777989809743717 val_auroc:  0.8498062015503876 val_auprc:  0.9374352454712492
Validation loss improved to 0.152239
epoch:  47
epoch:  48 val_f1:  0.7781180058147428 val_auroc:  0.8517441860465116 val_auprc:  0.9391970034062351
Validation loss improved to 0.147544
epoch:  48
epoch:  49 val_f1:  0.7746634573712671 val_auroc:  0.8502906976744187 val_auprc:  0.9381783580944716
EarlyStopping counter: 1 out of 50
epoch:  49
epoch:  50 val_f1:  0.7724509753899008 val_auroc:  0.851017441860465 val_auprc:  0.9383282172291632
Validation loss improved to 0.127021
epoch:  50
epoch:  51 val_f1:  0.7714826564458221 val_auroc:  0.8544089147286822 val_auprc:  0.9401083026313537
EarlyStopping counter: 1 out of 50
epoch:  51
epoch:  52 val_f1:  0.7208199087985581 val_auroc:  0.8561046511627907 val_auprc:  0.940041507008402
EarlyStopping counter: 2 out of 50
epoch:  52
epoch:  53 val_f1:  0.6598550592872624 val_auroc:  0.8493217054263567 val_auprc:  0.9390576638511624
EarlyStopping counter: 3 out of 50
epoch:  53
epoch:  54 val_f1:  0.7529139722223964 val_auroc:  0.8507751937984496 val_auprc:  0.9387953360523751
Validation loss improved to 0.098994
epoch:  54
epoch:  55 val_f1:  0.7529139722223964 val_auroc:  0.8495639534883721 val_auprc:  0.9367491715387161
EarlyStopping counter: 1 out of 50
epoch:  55
epoch:  56 val_f1:  0.7578890782445586 val_auroc:  0.8580426356589147 val_auprc:  0.9393372390556914
EarlyStopping counter: 2 out of 50
epoch:  56
epoch:  57 val_f1:  0.7746634573712671 val_auroc:  0.8551356589147288 val_auprc:  0.9381371616105088
EarlyStopping counter: 3 out of 50
epoch:  57
epoch:  58 val_f1:  0.7784546388862936 val_auroc:  0.8561046511627907 val_auprc:  0.9398615432462134
EarlyStopping counter: 4 out of 50
epoch:  58
epoch:  59 val_f1:  0.7274233868573957 val_auroc:  0.8582848837209303 val_auprc:  0.9406070526468733
EarlyStopping counter: 5 out of 50
epoch:  59
epoch:  60 val_f1:  0.7679977157187104 val_auroc:  0.8585271317829457 val_auprc:  0.9419008181574042
EarlyStopping counter: 6 out of 50
epoch:  60
epoch:  61 val_f1:  0.7811523753969797 val_auroc:  0.8604651162790699 val_auprc:  0.9420818125829865
EarlyStopping counter: 7 out of 50
epoch:  61
epoch:  62 val_f1:  0.7552249462565869 val_auroc:  0.8624031007751939 val_auprc:  0.9430766176247863
EarlyStopping counter: 8 out of 50
epoch:  62
epoch:  63 val_f1:  0.7646314961799923 val_auroc:  0.8575581395348837 val_auprc:  0.9418760301571164
EarlyStopping counter: 9 out of 50
epoch:  63
epoch:  64 val_f1:  0.7789671954250403 val_auroc:  0.8534399224806201 val_auprc:  0.9412487834114691
EarlyStopping counter: 10 out of 50
epoch:  64
epoch:  65 val_f1:  0.7603368061152953 val_auroc:  0.8568313953488372 val_auprc:  0.9409399217024885
EarlyStopping counter: 11 out of 50
epoch:  65
epoch:  66 val_f1:  0.7735780520043992 val_auroc:  0.8597383720930233 val_auprc:  0.9430262227427622
EarlyStopping counter: 12 out of 50
epoch:  66
epoch:  67 val_f1:  0.7789671954250403 val_auroc:  0.8611918604651163 val_auprc:  0.943489113949195
EarlyStopping counter: 13 out of 50
epoch:  67
epoch:  68 val_f1:  0.7603368061152953 val_auroc:  0.8640988372093023 val_auprc:  0.9442280954278653
EarlyStopping counter: 14 out of 50
epoch:  68
epoch:  69 val_f1:  0.7724509753899008 val_auroc:  0.8645833333333334 val_auprc:  0.9440782608108758
EarlyStopping counter: 15 out of 50
epoch:  69
epoch:  70 val_f1:  0.7801238118631262 val_auroc:  0.8619186046511628 val_auprc:  0.9433832448593962
Validation loss improved to 0.091965
epoch:  70
epoch:  71 val_f1:  0.7628987147360764 val_auroc:  0.8660368217054263 val_auprc:  0.9448488176303336
EarlyStopping counter: 1 out of 50
epoch:  71
epoch:  72 val_f1:  0.7622179807174668 val_auroc:  0.8599806201550387 val_auprc:  0.9431247418701392
Validation loss improved to 0.086350
epoch:  72
epoch:  73 val_f1:  0.7932273763653603 val_auroc:  0.8624031007751938 val_auprc:  0.9436355400032996
EarlyStopping counter: 1 out of 50
epoch:  73
epoch:  74 val_f1:  0.7853321924188026 val_auroc:  0.8682170542635659 val_auprc:  0.9450096649884335
EarlyStopping counter: 2 out of 50
epoch:  74
epoch:  75 val_f1:  0.7827158008497472 val_auroc:  0.8665213178294574 val_auprc:  0.9442387938916434
EarlyStopping counter: 3 out of 50
epoch:  75
epoch:  76 val_f1:  0.7827158008497472 val_auroc:  0.8657945736434108 val_auprc:  0.9449762833574458
EarlyStopping counter: 4 out of 50
epoch:  76
epoch:  77 val_f1:  0.7866727894280321 val_auroc:  0.8614341085271318 val_auprc:  0.9428037705374293
EarlyStopping counter: 5 out of 50
epoch:  77
epoch:  78 val_f1:  0.7894843465886632 val_auroc:  0.8604651162790697 val_auprc:  0.9432447966218935
EarlyStopping counter: 6 out of 50
epoch:  78
epoch:  79 val_f1:  0.7729252582141845 val_auroc:  0.8611918604651162 val_auprc:  0.9433166656470147
EarlyStopping counter: 7 out of 50
epoch:  79
epoch:  80 val_f1:  0.7776763243674784 val_auroc:  0.8648255813953488 val_auprc:  0.9445173214624514
EarlyStopping counter: 8 out of 50
epoch:  80
epoch:  81 val_f1:  0.7841726618705036 val_auroc:  0.8616763565891472 val_auprc:  0.9430483268791537
EarlyStopping counter: 9 out of 50
epoch:  81
epoch:  82 val_f1:  0.7841726618705036 val_auroc:  0.8609496124031008 val_auprc:  0.9430529027979061
EarlyStopping counter: 10 out of 50
epoch:  82
epoch:  83 val_f1:  0.776244301724119 val_auroc:  0.8670058139534883 val_auprc:  0.9447327282268434
EarlyStopping counter: 11 out of 50
epoch:  83
epoch:  84 val_f1:  0.7724509753899008 val_auroc:  0.8643410852713178 val_auprc:  0.9440818245749799
EarlyStopping counter: 12 out of 50
epoch:  84
epoch:  85 val_f1:  0.7828470720035011 val_auroc:  0.8614341085271318 val_auprc:  0.9432473994705075
Validation loss improved to 0.084279
epoch:  85
epoch:  86 val_f1:  0.7666659578740948 val_auroc:  0.8611918604651163 val_auprc:  0.9420850943404466
EarlyStopping counter: 1 out of 50
epoch:  86
epoch:  87 val_f1:  0.7906801532257888 val_auroc:  0.8553779069767442 val_auprc:  0.9410316469984371
EarlyStopping counter: 2 out of 50
epoch:  87
epoch:  88 val_f1:  0.7811523753969797 val_auroc:  0.8575581395348838 val_auprc:  0.9407431536114645
EarlyStopping counter: 3 out of 50
epoch:  88
epoch:  89 val_f1:  0.7906801532257888 val_auroc:  0.8590116279069767 val_auprc:  0.9408272896452845
EarlyStopping counter: 4 out of 50
epoch:  89
epoch:  90 val_f1:  0.7724509753899008 val_auroc:  0.8587693798449613 val_auprc:  0.942205265934747
EarlyStopping counter: 5 out of 50
epoch:  90
epoch:  91 val_f1:  0.7724509753899008 val_auroc:  0.8638565891472869 val_auprc:  0.9432428957845573
EarlyStopping counter: 6 out of 50
epoch:  91
epoch:  92 val_f1:  0.7906801532257888 val_auroc:  0.8638565891472868 val_auprc:  0.9433082936354541
EarlyStopping counter: 7 out of 50
epoch:  92
epoch:  93 val_f1:  0.7776763243674784 val_auroc:  0.8643410852713179 val_auprc:  0.9435570158165925
EarlyStopping counter: 8 out of 50
epoch:  93
epoch:  94 val_f1:  0.7695564219015847 val_auroc:  0.866279069767442 val_auprc:  0.9447125758586215
Validation loss improved to 0.070889
epoch:  94
epoch:  95 val_f1:  0.7820584602206068 val_auroc:  0.8655523255813954 val_auprc:  0.943926050668715
EarlyStopping counter: 1 out of 50
epoch:  95
epoch:  96 val_f1:  0.7827158008497472 val_auroc:  0.8648255813953488 val_auprc:  0.9437887780000032
EarlyStopping counter: 2 out of 50
epoch:  96
epoch:  97 val_f1:  0.792019787311512 val_auroc:  0.8631298449612402 val_auprc:  0.9436043664923245
EarlyStopping counter: 3 out of 50
epoch:  97
epoch:  98 val_f1:  0.7801238118631262 val_auroc:  0.8648255813953488 val_auprc:  0.9430824873396362
EarlyStopping counter: 4 out of 50
epoch:  98
epoch:  99 val_f1:  0.792019787311512 val_auroc:  0.8645833333333333 val_auprc:  0.9438351207275573
EarlyStopping counter: 5 out of 50
epoch:  99
epoch:  100 val_f1:  0.7801238118631262 val_auroc:  0.8667635658914729 val_auprc:  0.9446700500504187
EarlyStopping counter: 6 out of 50
epoch:  100
epoch:  101 val_f1:  0.7827158008497472 val_auroc:  0.8670058139534884 val_auprc:  0.9442722054454478
EarlyStopping counter: 7 out of 50
epoch:  101
epoch:  102 val_f1:  0.7906801532257888 val_auroc:  0.8665213178294573 val_auprc:  0.9443583294954199
EarlyStopping counter: 8 out of 50
epoch:  102
epoch:  103 val_f1:  0.7892012988311853 val_auroc:  0.8645833333333333 val_auprc:  0.9440637767194031
EarlyStopping counter: 9 out of 50
epoch:  103
epoch:  104 val_f1:  0.7841726618705036 val_auroc:  0.8667635658914729 val_auprc:  0.9444869980884456
EarlyStopping counter: 10 out of 50
epoch:  104
epoch:  105 val_f1:  0.7789671954250403 val_auroc:  0.8665213178294573 val_auprc:  0.9432645295304695
EarlyStopping counter: 11 out of 50
epoch:  105
epoch:  106 val_f1:  0.7820584602206068 val_auroc:  0.8657945736434108 val_auprc:  0.9439545090275774
EarlyStopping counter: 12 out of 50
epoch:  106
epoch:  107 val_f1:  0.7745758989478168 val_auroc:  0.8699127906976745 val_auprc:  0.9453435791335427
EarlyStopping counter: 13 out of 50
epoch:  107
epoch:  108 val_f1:  0.7877294237541244 val_auroc:  0.8687015503875969 val_auprc:  0.9452175374171975
EarlyStopping counter: 14 out of 50
epoch:  108
epoch:  109 val_f1:  0.7985611510791367 val_auroc:  0.8660368217054264 val_auprc:  0.94451901185258
EarlyStopping counter: 15 out of 50
epoch:  109
epoch:  110 val_f1:  0.7745758989478168 val_auroc:  0.8665213178294573 val_auprc:  0.9446091872746365
EarlyStopping counter: 16 out of 50
epoch:  110
epoch:  111 val_f1:  0.7886649052635782 val_auroc:  0.8640988372093024 val_auprc:  0.9434242076054786
EarlyStopping counter: 17 out of 50
epoch:  111
epoch:  112 val_f1:  0.7820584602206068 val_auroc:  0.8682170542635659 val_auprc:  0.9448612143609936
EarlyStopping counter: 18 out of 50
epoch:  112
epoch:  113 val_f1:  0.7886649052635782 val_auroc:  0.870639534883721 val_auprc:  0.9458045381705665
EarlyStopping counter: 19 out of 50
epoch:  113
epoch:  114 val_f1:  0.7801238118631262 val_auroc:  0.8672480620155039 val_auprc:  0.9449784197136666
EarlyStopping counter: 20 out of 50
epoch:  114
epoch:  115 val_f1:  0.7866727894280321 val_auroc:  0.8682170542635659 val_auprc:  0.9450428408145418
EarlyStopping counter: 21 out of 50
epoch:  115
epoch:  116 val_f1:  0.792019787311512 val_auroc:  0.8667635658914729 val_auprc:  0.9442116239532403
EarlyStopping counter: 22 out of 50
epoch:  116
epoch:  117 val_f1:  0.792019787311512 val_auroc:  0.8674903100775193 val_auprc:  0.9443569566999941
EarlyStopping counter: 23 out of 50
epoch:  117
epoch:  118 val_f1:  0.7985611510791367 val_auroc:  0.8667635658914729 val_auprc:  0.9442634795620137
EarlyStopping counter: 24 out of 50
epoch:  118
epoch:  119 val_f1:  0.7985611510791367 val_auroc:  0.8670058139534884 val_auprc:  0.9446034688486766
EarlyStopping counter: 25 out of 50
epoch:  119
epoch:  120 val_f1:  0.8063632502555458 val_auroc:  0.8682170542635659 val_auprc:  0.944694054929839
EarlyStopping counter: 26 out of 50
epoch:  120
epoch:  121 val_f1:  0.7866727894280321 val_auroc:  0.8662790697674418 val_auprc:  0.944032121665403
EarlyStopping counter: 27 out of 50
epoch:  121
epoch:  122 val_f1:  0.7932273763653603 val_auroc:  0.8674903100775193 val_auprc:  0.9444799073151433
EarlyStopping counter: 28 out of 50
epoch:  122
epoch:  123 val_f1:  0.7841726618705036 val_auroc:  0.865794573643411 val_auprc:  0.9433796169665909
EarlyStopping counter: 29 out of 50
epoch:  123
epoch:  124 val_f1:  0.7932273763653603 val_auroc:  0.8643410852713178 val_auprc:  0.9432284367403874
EarlyStopping counter: 30 out of 50
epoch:  124
epoch:  125 val_f1:  0.7906801532257888 val_auroc:  0.8655523255813954 val_auprc:  0.9434074869425946
EarlyStopping counter: 31 out of 50
epoch:  125
epoch:  126 val_f1:  0.7906801532257888 val_auroc:  0.8660368217054263 val_auprc:  0.9443188087885608
EarlyStopping counter: 32 out of 50
epoch:  126
epoch:  127 val_f1:  0.7932273763653603 val_auroc:  0.8643410852713178 val_auprc:  0.9436283617555982
EarlyStopping counter: 33 out of 50
epoch:  127
epoch:  128 val_f1:  0.7866727894280321 val_auroc:  0.8631298449612403 val_auprc:  0.9427058917723478
EarlyStopping counter: 34 out of 50
epoch:  128
epoch:  129 val_f1:  0.7997900244397783 val_auroc:  0.8643410852713178 val_auprc:  0.9426907270189075
EarlyStopping counter: 35 out of 50
epoch:  129
epoch:  130 val_f1:  0.8063632502555458 val_auroc:  0.8640988372093024 val_auprc:  0.9426480778192333
EarlyStopping counter: 36 out of 50
epoch:  130
epoch:  131 val_f1:  0.7811523753969797 val_auroc:  0.8648255813953488 val_auprc:  0.9436384138264939
EarlyStopping counter: 37 out of 50
epoch:  131
epoch:  132 val_f1:  0.792019787311512 val_auroc:  0.865794573643411 val_auprc:  0.9439847796363413
EarlyStopping counter: 38 out of 50
epoch:  132
epoch:  133 val_f1:  0.7877294237541244 val_auroc:  0.8650678294573644 val_auprc:  0.9435598384420083
EarlyStopping counter: 39 out of 50
epoch:  133
epoch:  134 val_f1:  0.7866727894280321 val_auroc:  0.8626453488372092 val_auprc:  0.9424088510251665
EarlyStopping counter: 40 out of 50
epoch:  134
epoch:  135 val_f1:  0.7997900244397783 val_auroc:  0.8638565891472868 val_auprc:  0.9425441942823635
EarlyStopping counter: 41 out of 50
epoch:  135
epoch:  136 val_f1:  0.7985611510791367 val_auroc:  0.8653100775193798 val_auprc:  0.943285187479245
EarlyStopping counter: 42 out of 50
epoch:  136
epoch:  137 val_f1:  0.8063632502555458 val_auroc:  0.8640988372093024 val_auprc:  0.9432198615130065
EarlyStopping counter: 43 out of 50
epoch:  137
epoch:  138 val_f1:  0.8063632502555458 val_auroc:  0.8643410852713178 val_auprc:  0.942622731872576
EarlyStopping counter: 44 out of 50
epoch:  138
epoch:  139 val_f1:  0.7827158008497472 val_auroc:  0.8643410852713178 val_auprc:  0.9427870756679606
EarlyStopping counter: 45 out of 50
epoch:  139
epoch:  140 val_f1:  0.8063632502555458 val_auroc:  0.8638565891472868 val_auprc:  0.9428420112465524
EarlyStopping counter: 46 out of 50
epoch:  140
epoch:  141 val_f1:  0.7932273763653603 val_auroc:  0.8638565891472867 val_auprc:  0.9425288592035056
EarlyStopping counter: 47 out of 50
epoch:  141
epoch:  142 val_f1:  0.8063632502555458 val_auroc:  0.8633720930232558 val_auprc:  0.9422335289884065
EarlyStopping counter: 48 out of 50
epoch:  142
epoch:  143 val_f1:  0.8063632502555458 val_auroc:  0.8619186046511629 val_auprc:  0.9419975147790163
EarlyStopping counter: 49 out of 50
epoch:  143
epoch:  144 val_f1:  0.8063632502555458 val_auroc:  0.8628875968992249 val_auprc:  0.9427391174423622
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  4164.7294907569885
{'time_elapsed': [4164.7294907569885], 'epoch': [143], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8063632502555458], 'auroc_test': [0.8628875968992249], 'auprc_test': [0.9427391174423622]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1276]          8,192
│    └─BatchNorm1d: 2-2                  [64, 1024, 1276]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1276]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1270]          --
│    └─Dropout: 2-5                      [64, 1024, 1270]          --
│    └─Flatten: 2-6                      [64, 1300480]             --
│    └─Linear: 2-7                       [64, 1]                   1,300,481
==========================================================================================
Total params: 1,310,721
Trainable params: 1,310,721
Non-trainable params: 0
Total mult-adds (M): 752.35
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1337.98
Params size (MB): 5.24
Estimated Total Size (MB): 1343.55
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.14202898550724638 val_auroc:  0.6882440476190477 val_auprc:  0.826524867235388
epoch:  1
epoch:  2 val_f1:  0.661734693877551 val_auroc:  0.7088293650793651 val_auprc:  0.8463049757058665
Validation loss improved to 1.601613
epoch:  2
epoch:  3 val_f1:  0.700415050690617 val_auroc:  0.7442956349206349 val_auprc:  0.8839831330701021
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.7095159592428545 val_auroc:  0.8317212301587302 val_auprc:  0.9240237944052088
Validation loss improved to 0.790332
epoch:  4
epoch:  5 val_f1:  0.7929485957015485 val_auroc:  0.8777281746031746 val_auprc:  0.9376805086860354
Validation loss improved to 0.263138
epoch:  5
epoch:  6 val_f1:  0.7786691885085516 val_auroc:  0.8554067460317459 val_auprc:  0.9257732544537257
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.7493220093615789 val_auroc:  0.8417658730158731 val_auprc:  0.9224976335420662
EarlyStopping counter: 2 out of 50
epoch:  7
epoch:  8 val_f1:  0.7697938448700337 val_auroc:  0.8663194444444444 val_auprc:  0.9339451781176284
EarlyStopping counter: 3 out of 50
epoch:  8
epoch:  9 val_f1:  0.7949078298424175 val_auroc:  0.8616071428571428 val_auprc:  0.931885049059553
EarlyStopping counter: 4 out of 50
epoch:  9
epoch:  10 val_f1:  0.807228002894545 val_auroc:  0.8516865079365079 val_auprc:  0.9250073461377728
EarlyStopping counter: 5 out of 50
epoch:  10
epoch:  11 val_f1:  0.8049865427618805 val_auroc:  0.8606150793650794 val_auprc:  0.9277600569755226
EarlyStopping counter: 6 out of 50
epoch:  11
epoch:  12 val_f1:  0.8023197893688181 val_auroc:  0.8603670634920635 val_auprc:  0.9274493009695394
EarlyStopping counter: 7 out of 50
epoch:  12
epoch:  13 val_f1:  0.800639197204071 val_auroc:  0.8578869047619048 val_auprc:  0.927520486905186
EarlyStopping counter: 8 out of 50
epoch:  13
epoch:  14 val_f1:  0.7807080066524115 val_auroc:  0.8556547619047619 val_auprc:  0.9200743496196513
EarlyStopping counter: 9 out of 50
epoch:  14
epoch:  15 val_f1:  0.7815416513900654 val_auroc:  0.8529265873015873 val_auprc:  0.9182700054153471
EarlyStopping counter: 10 out of 50
epoch:  15
epoch:  16 val_f1:  0.7963059879954627 val_auroc:  0.8516865079365079 val_auprc:  0.9176563548624833
EarlyStopping counter: 11 out of 50
epoch:  16
epoch:  17 val_f1:  0.7285152146767162 val_auroc:  0.8556547619047619 val_auprc:  0.9185782312297507
EarlyStopping counter: 12 out of 50
epoch:  17
epoch:  18 val_f1:  0.7425559947299077 val_auroc:  0.863343253968254 val_auprc:  0.9254475753934149
EarlyStopping counter: 13 out of 50
epoch:  18
epoch:  19 val_f1:  0.7881997743237336 val_auroc:  0.8660714285714286 val_auprc:  0.9185088774832034
EarlyStopping counter: 14 out of 50
epoch:  19
epoch:  20 val_f1:  0.7988956640912072 val_auroc:  0.8680555555555556 val_auprc:  0.9227432581316597
EarlyStopping counter: 15 out of 50
epoch:  20
epoch:  21 val_f1:  0.7746271791640412 val_auroc:  0.857390873015873 val_auprc:  0.9040790768594498
EarlyStopping counter: 16 out of 50
epoch:  21
epoch:  22 val_f1:  0.8115942028985508 val_auroc:  0.8628472222222222 val_auprc:  0.9198294907491587
EarlyStopping counter: 17 out of 50
epoch:  22
epoch:  23 val_f1:  0.8168793096329329 val_auroc:  0.861111111111111 val_auprc:  0.9155314225231582
EarlyStopping counter: 18 out of 50
epoch:  23
epoch:  24 val_f1:  0.7588956111566858 val_auroc:  0.8559027777777778 val_auprc:  0.8958202610675838
EarlyStopping counter: 19 out of 50
epoch:  24
epoch:  25 val_f1:  0.6898325099232261 val_auroc:  0.8593749999999999 val_auprc:  0.8975275439092011
EarlyStopping counter: 20 out of 50
epoch:  25
epoch:  26 val_f1:  0.6848492575892805 val_auroc:  0.8745039682539683 val_auprc:  0.9369287989193852
EarlyStopping counter: 21 out of 50
epoch:  26
epoch:  27 val_f1:  0.5707915273132664 val_auroc:  0.8758680555555556 val_auprc:  0.9372284613722195
EarlyStopping counter: 22 out of 50
epoch:  27
epoch:  28 val_f1:  0.8115942028985508 val_auroc:  0.8618551587301587 val_auprc:  0.9021734733711437
EarlyStopping counter: 23 out of 50
epoch:  28
epoch:  29 val_f1:  0.8120268224096906 val_auroc:  0.8701636904761905 val_auprc:  0.9080602163136137
EarlyStopping counter: 24 out of 50
epoch:  29
epoch:  30 val_f1:  0.7991557619248628 val_auroc:  0.8798363095238095 val_auprc:  0.9354415279869247
EarlyStopping counter: 25 out of 50
epoch:  30
epoch:  31 val_f1:  0.7810348219555381 val_auroc:  0.8757440476190477 val_auprc:  0.9342899717475993
EarlyStopping counter: 26 out of 50
epoch:  31
epoch:  32 val_f1:  0.7929485957015485 val_auroc:  0.855654761904762 val_auprc:  0.896770239324507
EarlyStopping counter: 27 out of 50
epoch:  32
epoch:  33 val_f1:  0.7929485957015485 val_auroc:  0.865327380952381 val_auprc:  0.9155655528217711
EarlyStopping counter: 28 out of 50
epoch:  33
epoch:  34 val_f1:  0.8137922815659323 val_auroc:  0.8591269841269842 val_auprc:  0.8980011471650958
EarlyStopping counter: 29 out of 50
epoch:  34
epoch:  35 val_f1:  0.7884143290944841 val_auroc:  0.8623511904761906 val_auprc:  0.9013740033539306
EarlyStopping counter: 30 out of 50
epoch:  35
epoch:  36 val_f1:  0.8154066640778435 val_auroc:  0.8668154761904763 val_auprc:  0.9027420153755734
EarlyStopping counter: 31 out of 50
epoch:  36
epoch:  37 val_f1:  0.8168793096329329 val_auroc:  0.8628472222222222 val_auprc:  0.9004012461864884
EarlyStopping counter: 32 out of 50
epoch:  37
epoch:  38 val_f1:  0.7839923367569581 val_auroc:  0.8640873015873015 val_auprc:  0.9000632331918952
EarlyStopping counter: 33 out of 50
epoch:  38
epoch:  39 val_f1:  0.7971014492753623 val_auroc:  0.8665674603174602 val_auprc:  0.9018747490449853
EarlyStopping counter: 34 out of 50
epoch:  39
epoch:  40 val_f1:  0.7797158172381521 val_auroc:  0.8665674603174603 val_auprc:  0.9014984497993088
EarlyStopping counter: 35 out of 50
epoch:  40
epoch:  41 val_f1:  0.8036760694501368 val_auroc:  0.8665674603174603 val_auprc:  0.9014411134883973
EarlyStopping counter: 36 out of 50
epoch:  41
epoch:  42 val_f1:  0.807228002894545 val_auroc:  0.867063492063492 val_auprc:  0.9019900351610569
EarlyStopping counter: 37 out of 50
epoch:  42
epoch:  43 val_f1:  0.8022296544035674 val_auroc:  0.8663194444444444 val_auprc:  0.90230347490772
EarlyStopping counter: 38 out of 50
epoch:  43
epoch:  44 val_f1:  0.7708866155157714 val_auroc:  0.8658234126984127 val_auprc:  0.9017594586233789
EarlyStopping counter: 39 out of 50
epoch:  44
epoch:  45 val_f1:  0.8102677351291666 val_auroc:  0.8705357142857143 val_auprc:  0.918734218968247
EarlyStopping counter: 40 out of 50
epoch:  45
epoch:  46 val_f1:  0.7839923367569581 val_auroc:  0.8692956349206349 val_auprc:  0.9007587533629212
EarlyStopping counter: 41 out of 50
epoch:  46
epoch:  47 val_f1:  0.7797158172381521 val_auroc:  0.8643353174603174 val_auprc:  0.9018319350051873
EarlyStopping counter: 42 out of 50
epoch:  47
epoch:  48 val_f1:  0.8137922815659323 val_auroc:  0.8692956349206349 val_auprc:  0.9036385896522365
EarlyStopping counter: 43 out of 50
epoch:  48
epoch:  49 val_f1:  0.8088065661047027 val_auroc:  0.86359126984127 val_auprc:  0.9013540728239585
EarlyStopping counter: 44 out of 50
epoch:  49
epoch:  50 val_f1:  0.7956729455237178 val_auroc:  0.8660714285714286 val_auprc:  0.9010329826849288
EarlyStopping counter: 45 out of 50
epoch:  50
epoch:  51 val_f1:  0.8022296544035674 val_auroc:  0.8690476190476191 val_auprc:  0.9037552262891533
EarlyStopping counter: 46 out of 50
epoch:  51
epoch:  52 val_f1:  0.7940993788819876 val_auroc:  0.8658234126984127 val_auprc:  0.9031050741021673
EarlyStopping counter: 47 out of 50
epoch:  52
epoch:  53 val_f1:  0.782608695652174 val_auroc:  0.8660714285714285 val_auprc:  0.8997455125876455
EarlyStopping counter: 48 out of 50
epoch:  53
epoch:  54 val_f1:  0.7904805491990847 val_auroc:  0.8645833333333334 val_auprc:  0.9015542319669178
EarlyStopping counter: 49 out of 50
epoch:  54
epoch:  55 val_f1:  0.7969889682024659 val_auroc:  0.8660714285714286 val_auprc:  0.902523575444387
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1601.1248965263367
{'time_elapsed': [1601.1248965263367], 'epoch': [54], 'fold': [4], 'f1_train': [0.9982029282297181], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7969889682024659], 'auroc_test': [0.8660714285714286], 'auprc_test': [0.902523575444387]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1276]          8,192
│    └─BatchNorm1d: 2-2                  [64, 1024, 1276]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1276]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1270]          --
│    └─Dropout: 2-5                      [64, 1024, 1270]          --
│    └─Flatten: 2-6                      [64, 1300480]             --
│    └─Linear: 2-7                       [64, 1]                   1,300,481
==========================================================================================
Total params: 1,310,721
Trainable params: 1,310,721
Non-trainable params: 0
Total mult-adds (M): 752.35
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1337.98
Params size (MB): 5.24
Estimated Total Size (MB): 1343.55
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_20', 'config': {'hidden_channels': [1024], 'epochs': 500, 'kernel_size': 7, 'pool_kernel_size': 7, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.4538355329722237 val_auroc:  0.6759941089837997 val_auprc:  0.7923840498203863
epoch:  1
epoch:  2 val_f1:  0.6152937189172818 val_auroc:  0.5488463426607757 val_auprc:  0.7137616017140942
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.44277396843202566 val_auroc:  0.5596465390279823 val_auprc:  0.7216646539205511
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5935900678162374 val_auroc:  0.5621011291114384 val_auprc:  0.7260703431136111
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.5829969063840983 val_auroc:  0.5952380952380952 val_auprc:  0.7504380162020381
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.619566649594801 val_auroc:  0.635247913598429 val_auprc:  0.7756427135395871
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.6241521068859198 val_auroc:  0.6669121256750123 val_auprc:  0.8068380148594312
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.608607850561656 val_auroc:  0.703240058910162 val_auprc:  0.8418464685685801
Validation loss improved to 1.213623
epoch:  8
epoch:  9 val_f1:  0.6731024749578328 val_auroc:  0.711340206185567 val_auprc:  0.8458867234557766
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.6328113979404711 val_auroc:  0.7457044673539519 val_auprc:  0.8694478663824723
Validation loss improved to 1.171823
epoch:  10
epoch:  11 val_f1:  0.6937535685737124 val_auroc:  0.7484045164457536 val_auprc:  0.8713041082432383
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.640046945494452 val_auroc:  0.7650957290132548 val_auprc:  0.8815024300861986
Validation loss improved to 1.142620
epoch:  12
epoch:  13 val_f1:  0.6894399143298684 val_auroc:  0.7621502209131075 val_auprc:  0.8808818111904106
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7496568898727172 val_auroc:  0.758713794796269 val_auprc:  0.8799163884354081
EarlyStopping counter: 2 out of 50
epoch:  14
epoch:  15 val_f1:  0.5917124096980212 val_auroc:  0.7754050073637703 val_auprc:  0.887942040179011
Validation loss improved to 1.112560
epoch:  15
epoch:  16 val_f1:  0.6617377698806362 val_auroc:  0.773686794305351 val_auprc:  0.8877817053649115
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7536606851900262 val_auroc:  0.7697594501718212 val_auprc:  0.8861942244897736
EarlyStopping counter: 2 out of 50
epoch:  17
epoch:  18 val_f1:  0.5900086904324611 val_auroc:  0.7800687285223369 val_auprc:  0.8921080409519835
Validation loss improved to 1.108330
epoch:  18
epoch:  19 val_f1:  0.6960581600537912 val_auroc:  0.7761413843888071 val_auprc:  0.8898646452857566
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7791090204759269 val_auroc:  0.7756504663721159 val_auprc:  0.8917817229231644
EarlyStopping counter: 2 out of 50
epoch:  20
epoch:  21 val_f1:  0.6459565936764723 val_auroc:  0.7881688757977418 val_auprc:  0.898968471900073
Validation loss improved to 1.080017
epoch:  21
epoch:  22 val_f1:  0.7617684906754855 val_auroc:  0.7766323024054983 val_auprc:  0.89257189863351
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7169009504644194 val_auroc:  0.7864506627393226 val_auprc:  0.898587388386089
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.7441671543148256 val_auroc:  0.7803141875306823 val_auprc:  0.894176759495725
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.7162290583621869 val_auroc:  0.7866961217476681 val_auprc:  0.8992289654573424
EarlyStopping counter: 4 out of 50
epoch:  25
epoch:  26 val_f1:  0.7032425848040964 val_auroc:  0.7935689739813452 val_auprc:  0.9041816579447006
Validation loss improved to 1.078916
epoch:  26
epoch:  27 val_f1:  0.726175885795287 val_auroc:  0.7893961708394699 val_auprc:  0.9024359704938998
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7233618940391454 val_auroc:  0.791114383897889 val_auprc:  0.9034923021407812
EarlyStopping counter: 2 out of 50
epoch:  28
epoch:  29 val_f1:  0.7281499969472504 val_auroc:  0.793078055964654 val_auprc:  0.905063689026143
EarlyStopping counter: 3 out of 50
epoch:  29
epoch:  30 val_f1:  0.7643829551743221 val_auroc:  0.7847324496809033 val_auprc:  0.8993790835995061
EarlyStopping counter: 4 out of 50
epoch:  30
epoch:  31 val_f1:  0.6749024096537389 val_auroc:  0.8026509572901325 val_auprc:  0.9091785388745426
Validation loss improved to 1.076894
epoch:  31
epoch:  32 val_f1:  0.7166299330477814 val_auroc:  0.799214531173294 val_auprc:  0.9070448665456642
EarlyStopping counter: 1 out of 50
epoch:  32
epoch:  33 val_f1:  0.7166299330477814 val_auroc:  0.800441826215022 val_auprc:  0.9080543847498952
EarlyStopping counter: 2 out of 50
epoch:  33
epoch:  34 val_f1:  0.7519437633413868 val_auroc:  0.7957781050564556 val_auprc:  0.9060364830030927
EarlyStopping counter: 3 out of 50
epoch:  34
epoch:  35 val_f1:  0.735514445586388 val_auroc:  0.7992145311732941 val_auprc:  0.9084613511470007
EarlyStopping counter: 4 out of 50
epoch:  35
epoch:  36 val_f1:  0.7295632867761842 val_auroc:  0.8031418753068238 val_auprc:  0.9109161215570437
EarlyStopping counter: 5 out of 50
epoch:  36
epoch:  37 val_f1:  0.7337314237416728 val_auroc:  0.8006872852233677 val_auprc:  0.909055179829936
EarlyStopping counter: 6 out of 50
epoch:  37
epoch:  38 val_f1:  0.7402181480621955 val_auroc:  0.8004418262150221 val_auprc:  0.9086093800390246
EarlyStopping counter: 7 out of 50
epoch:  38
epoch:  39 val_f1:  0.7531731915989216 val_auroc:  0.8043691703485518 val_auprc:  0.9112399677990608
EarlyStopping counter: 8 out of 50
epoch:  39
epoch:  40 val_f1:  0.6876087591262989 val_auroc:  0.8117329405989199 val_auprc:  0.9160884135486209
EarlyStopping counter: 9 out of 50
epoch:  40
epoch:  41 val_f1:  0.7777125328082551 val_auroc:  0.7987236131566029 val_auprc:  0.9072520309675924
EarlyStopping counter: 10 out of 50
epoch:  41
epoch:  42 val_f1:  0.7648187281552264 val_auroc:  0.7943053510063819 val_auprc:  0.9027649954076283
EarlyStopping counter: 11 out of 50
epoch:  42
epoch:  43 val_f1:  0.7162290583621869 val_auroc:  0.8053510063819342 val_auprc:  0.9107469137955609
EarlyStopping counter: 12 out of 50
epoch:  43
epoch:  44 val_f1:  0.7162290583621869 val_auroc:  0.8134511536573392 val_auprc:  0.9176827722483586
EarlyStopping counter: 13 out of 50
epoch:  44
epoch:  45 val_f1:  0.7583800901862243 val_auroc:  0.803632793323515 val_auprc:  0.9108268081418525
EarlyStopping counter: 14 out of 50
epoch:  45
epoch:  46 val_f1:  0.735514445586388 val_auroc:  0.8080510554737359 val_auprc:  0.9128369802865657
EarlyStopping counter: 15 out of 50
epoch:  46
epoch:  47 val_f1:  0.7295632867761842 val_auroc:  0.8073146784486991 val_auprc:  0.9129747330459005
EarlyStopping counter: 16 out of 50
epoch:  47
epoch:  48 val_f1:  0.7466980132583976 val_auroc:  0.8033873343151693 val_auprc:  0.9095869736912736
EarlyStopping counter: 17 out of 50
epoch:  48
epoch:  49 val_f1:  0.7712620601193464 val_auroc:  0.7999509081983309 val_auprc:  0.9071415568129937
EarlyStopping counter: 18 out of 50
epoch:  49
epoch:  50 val_f1:  0.7402181480621955 val_auroc:  0.8078055964653903 val_auprc:  0.9136066833997608
EarlyStopping counter: 19 out of 50
epoch:  50
epoch:  51 val_f1:  0.7362024088594293 val_auroc:  0.8161512027491409 val_auprc:  0.9188813511618322
EarlyStopping counter: 20 out of 50
epoch:  51
epoch:  52 val_f1:  0.7777125328082551 val_auroc:  0.8001963672066765 val_auprc:  0.9076031692349376
EarlyStopping counter: 21 out of 50
epoch:  52
epoch:  53 val_f1:  0.7367608586927249 val_auroc:  0.8119783996072655 val_auprc:  0.9157507754932733
EarlyStopping counter: 22 out of 50
epoch:  53
epoch:  54 val_f1:  0.7510257046352308 val_auroc:  0.8168875797741777 val_auprc:  0.9192394866459508
EarlyStopping counter: 23 out of 50
epoch:  54
epoch:  55 val_f1:  0.7402181480621955 val_auroc:  0.8102601865488464 val_auprc:  0.9145162865907203
EarlyStopping counter: 24 out of 50
epoch:  55
epoch:  56 val_f1:  0.743914028278071 val_auroc:  0.8146784486990672 val_auprc:  0.9176641477915712
EarlyStopping counter: 25 out of 50
epoch:  56
epoch:  57 val_f1:  0.7295632867761842 val_auroc:  0.8139420716740304 val_auprc:  0.916134874991653
EarlyStopping counter: 26 out of 50
epoch:  57
epoch:  58 val_f1:  0.7402181480621955 val_auroc:  0.8073146784486991 val_auprc:  0.9121326227227594
EarlyStopping counter: 27 out of 50
epoch:  58
epoch:  59 val_f1:  0.7519437633413868 val_auroc:  0.804860088365243 val_auprc:  0.910418492001228
EarlyStopping counter: 28 out of 50
epoch:  59
epoch:  60 val_f1:  0.7402181480621955 val_auroc:  0.8090328915071183 val_auprc:  0.9141869686754146
EarlyStopping counter: 29 out of 50
epoch:  60
epoch:  61 val_f1:  0.7583800901862243 val_auroc:  0.8041237113402061 val_auprc:  0.9099134769295383
EarlyStopping counter: 30 out of 50
epoch:  61
epoch:  62 val_f1:  0.7466980132583976 val_auroc:  0.8068237604320079 val_auprc:  0.9119985119431198
EarlyStopping counter: 31 out of 50
epoch:  62
epoch:  63 val_f1:  0.7477455593342162 val_auroc:  0.8087874324987727 val_auprc:  0.913560435708262
EarlyStopping counter: 32 out of 50
epoch:  63
epoch:  64 val_f1:  0.72389147505525 val_auroc:  0.8171330387825233 val_auprc:  0.9202544715437098
EarlyStopping counter: 33 out of 50
epoch:  64
epoch:  65 val_f1:  0.7494347379239465 val_auroc:  0.8166421207658321 val_auprc:  0.9191680171956168
EarlyStopping counter: 34 out of 50
epoch:  65
epoch:  66 val_f1:  0.7626195746699344 val_auroc:  0.8144329896907216 val_auprc:  0.9187800665758462
EarlyStopping counter: 35 out of 50
epoch:  66
epoch:  67 val_f1:  0.7542604103291037 val_auroc:  0.8100147275405007 val_auprc:  0.9149591587460071
EarlyStopping counter: 36 out of 50
epoch:  67
epoch:  68 val_f1:  0.7697841726618705 val_auroc:  0.801178203240059 val_auprc:  0.9084236788630117
EarlyStopping counter: 37 out of 50
epoch:  68
epoch:  69 val_f1:  0.7712620601193464 val_auroc:  0.7997054491899853 val_auprc:  0.9071224261529902
EarlyStopping counter: 38 out of 50
epoch:  69
epoch:  70 val_f1:  0.7442757932382417 val_auroc:  0.8139420716740304 val_auprc:  0.9178449617891233
EarlyStopping counter: 39 out of 50
epoch:  70
epoch:  71 val_f1:  0.7617596949267598 val_auroc:  0.8112420225822288 val_auprc:  0.9169663634271265
EarlyStopping counter: 40 out of 50
epoch:  71
epoch:  72 val_f1:  0.7531731915989216 val_auroc:  0.8041237113402062 val_auprc:  0.9109283555585954
EarlyStopping counter: 41 out of 50
epoch:  72
epoch:  73 val_f1:  0.7607703458551531 val_auroc:  0.8070692194403534 val_auprc:  0.912679597369451
EarlyStopping counter: 42 out of 50
epoch:  73
epoch:  74 val_f1:  0.7583800901862243 val_auroc:  0.8038782523318606 val_auprc:  0.9109157549595598
EarlyStopping counter: 43 out of 50
epoch:  74
epoch:  75 val_f1:  0.7519437633413868 val_auroc:  0.8033873343151695 val_auprc:  0.910637680060242
EarlyStopping counter: 44 out of 50
epoch:  75
epoch:  76 val_f1:  0.7626195746699344 val_auroc:  0.8109965635738831 val_auprc:  0.9159442104454991
EarlyStopping counter: 45 out of 50
epoch:  76
epoch:  77 val_f1:  0.7683026725960121 val_auroc:  0.8092783505154638 val_auprc:  0.9149183576825716
EarlyStopping counter: 46 out of 50
epoch:  77
epoch:  78 val_f1:  0.7519437633413868 val_auroc:  0.8033873343151694 val_auprc:  0.910328293735372
EarlyStopping counter: 47 out of 50
epoch:  78
epoch:  79 val_f1:  0.7648187281552264 val_auroc:  0.8028964162984781 val_auprc:  0.9100842716901474
EarlyStopping counter: 48 out of 50
epoch:  79
epoch:  80 val_f1:  0.7648187281552264 val_auroc:  0.8038782523318605 val_auprc:  0.9106750897444453
EarlyStopping counter: 49 out of 50
epoch:  80
epoch:  81 val_f1:  0.7607703458551531 val_auroc:  0.8075601374570447 val_auprc:  0.9139482334567645
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  226.2379081249237
{'time_elapsed': [226.2379081249237], 'epoch': [80], 'fold': [0], 'f1_train': [0.987438205840143], 'auroc_train': [0.999831376276175], 'auprc_train': [0.9999257377764708], 'f1_test': [0.7607703458551531], 'auroc_test': [0.8075601374570447], 'auprc_test': [0.9139482334567645]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 183]           8,192
│    └─BatchNorm1d: 2-2                  [64, 1024, 183]           2,048
│    └─Tanh: 2-3                         [64, 1024, 183]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 26]            --
│    └─Dropout: 2-5                      [64, 1024, 26]            --
│    └─Flatten: 2-6                      [64, 26624]               --
│    └─Linear: 2-7                       [64, 1]                   26,625
==========================================================================================
Total params: 36,865
Trainable params: 36,865
Non-trainable params: 0
Total mult-adds (M): 97.78
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 191.89
Params size (MB): 0.15
Estimated Total Size (MB): 192.37
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.4070174368979393 val_auroc:  0.6475208640157094 val_auprc:  0.8493006713689675
epoch:  1
epoch:  2 val_f1:  0.5987568465290299 val_auroc:  0.6735395189003437 val_auprc:  0.8618415684474932
Validation loss improved to 1.172848
epoch:  2
epoch:  3 val_f1:  0.6200214541623571 val_auroc:  0.6686303387334315 val_auprc:  0.8588744194375281
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6228048768583505 val_auroc:  0.6902307314678449 val_auprc:  0.8712694817443017
Validation loss improved to 1.155350
epoch:  4
epoch:  5 val_f1:  0.6684270836950449 val_auroc:  0.70446735395189 val_auprc:  0.8798696977157017
Validation loss improved to 1.136663
epoch:  5
epoch:  6 val_f1:  0.6700068367276537 val_auroc:  0.7152675503190967 val_auprc:  0.8878786559091669
Validation loss improved to 1.101476
epoch:  6
epoch:  7 val_f1:  0.6891084624964738 val_auroc:  0.7304860088365244 val_auprc:  0.8947257801717319
Validation loss improved to 1.093357
epoch:  7
epoch:  8 val_f1:  0.6951967837494709 val_auroc:  0.7422680412371134 val_auprc:  0.8981742308946741
Validation loss improved to 1.062427
epoch:  8
epoch:  9 val_f1:  0.7229061670449737 val_auroc:  0.749386352479136 val_auprc:  0.8993967785661691
Validation loss improved to 1.046207
epoch:  9
epoch:  10 val_f1:  0.7307106601978622 val_auroc:  0.7582228767795778 val_auprc:  0.9014661895326348
Validation loss improved to 1.034484
epoch:  10
epoch:  11 val_f1:  0.7207289113763933 val_auroc:  0.7638684339715267 val_auprc:  0.9013388880758288
Validation loss improved to 1.018855
epoch:  11
epoch:  12 val_f1:  0.7428255465713769 val_auroc:  0.7719685812469317 val_auprc:  0.9026382825557127
Validation loss improved to 1.008809
epoch:  12
epoch:  13 val_f1:  0.7577565132360132 val_auroc:  0.7763868433971527 val_auprc:  0.9036124141410503
Validation loss improved to 0.998834
epoch:  13
epoch:  14 val_f1:  0.7577565132360132 val_auroc:  0.7847324496809033 val_auprc:  0.9072606233432993
Validation loss improved to 0.988476
epoch:  14
epoch:  15 val_f1:  0.6493555155875299 val_auroc:  0.7825233186057928 val_auprc:  0.9075166090547913
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7040153975059064 val_auroc:  0.7903780068728523 val_auprc:  0.9059602568343924
Validation loss improved to 0.985891
epoch:  16
epoch:  17 val_f1:  0.7691994463100789 val_auroc:  0.793078055964654 val_auprc:  0.9096698981209168
Validation loss improved to 0.969760
epoch:  17
epoch:  18 val_f1:  0.7307708780682615 val_auroc:  0.7955326460481099 val_auprc:  0.9113271506972993
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7040153975059064 val_auroc:  0.799214531173294 val_auprc:  0.9082184617996265
Validation loss improved to 0.968095
epoch:  19
epoch:  20 val_f1:  0.7911956149366222 val_auroc:  0.8014236622484044 val_auprc:  0.9112753737203223
Validation loss improved to 0.950251
epoch:  20
epoch:  21 val_f1:  0.7845295119922345 val_auroc:  0.8033873343151694 val_auprc:  0.9138872175222192
Validation loss improved to 0.949413
epoch:  21
epoch:  22 val_f1:  0.7596459003010357 val_auroc:  0.804860088365243 val_auprc:  0.9127992857180083
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7596459003010357 val_auroc:  0.8051055473735886 val_auprc:  0.9098791020274721
Validation loss improved to 0.944502
epoch:  23
epoch:  24 val_f1:  0.7765831291011147 val_auroc:  0.8097692685321551 val_auprc:  0.9119757378205213
Validation loss improved to 0.937394
epoch:  24
epoch:  25 val_f1:  0.7772753225990636 val_auroc:  0.8102601865488465 val_auprc:  0.9137321720349099
Validation loss improved to 0.936407
epoch:  25
epoch:  26 val_f1:  0.7092686867455189 val_auroc:  0.8055964653902798 val_auprc:  0.9148811188112077
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7711689349644636 val_auroc:  0.8060873834069711 val_auprc:  0.9125252624660402
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7691994463100789 val_auroc:  0.8082965144820815 val_auprc:  0.9108229306854008
Validation loss improved to 0.933969
epoch:  28
epoch:  29 val_f1:  0.7505653177403916 val_auroc:  0.8100147275405007 val_auprc:  0.8993276894481158
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.7757738305193033 val_auroc:  0.8114874815905744 val_auprc:  0.9081983301818244
Validation loss improved to 0.933679
epoch:  30
epoch:  31 val_f1:  0.7633550302615051 val_auroc:  0.8112420225822288 val_auprc:  0.9110339898920238
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.7757738305193033 val_auroc:  0.8124693176239568 val_auprc:  0.9085446230469925
EarlyStopping counter: 2 out of 50
epoch:  32
epoch:  33 val_f1:  0.7765831291011147 val_auroc:  0.8129602356406479 val_auprc:  0.9114689765775299
EarlyStopping counter: 3 out of 50
epoch:  33
epoch:  34 val_f1:  0.7661184054361647 val_auroc:  0.8112420225822288 val_auprc:  0.9040294103449182
EarlyStopping counter: 4 out of 50
epoch:  34
epoch:  35 val_f1:  0.7633550302615051 val_auroc:  0.8112420225822288 val_auprc:  0.9109983321856673
EarlyStopping counter: 5 out of 50
epoch:  35
epoch:  36 val_f1:  0.7831873586549224 val_auroc:  0.8112420225822288 val_auprc:  0.9092389214663084
EarlyStopping counter: 6 out of 50
epoch:  36
epoch:  37 val_f1:  0.7831873586549224 val_auroc:  0.8102601865488464 val_auprc:  0.9064782477039692
EarlyStopping counter: 7 out of 50
epoch:  37
epoch:  38 val_f1:  0.7607703458551531 val_auroc:  0.8097692685321551 val_auprc:  0.9056882590881273
EarlyStopping counter: 8 out of 50
epoch:  38
epoch:  39 val_f1:  0.7672775806504117 val_auroc:  0.8102601865488464 val_auprc:  0.905250234137627
EarlyStopping counter: 9 out of 50
epoch:  39
epoch:  40 val_f1:  0.7683026725960121 val_auroc:  0.8102601865488464 val_auprc:  0.9054563256408845
EarlyStopping counter: 10 out of 50
epoch:  40
epoch:  41 val_f1:  0.7031576347932113 val_auroc:  0.8090328915071183 val_auprc:  0.9115328441514234
EarlyStopping counter: 11 out of 50
epoch:  41
epoch:  42 val_f1:  0.7371937993371881 val_auroc:  0.8129602356406479 val_auprc:  0.9114272350952739
EarlyStopping counter: 12 out of 50
epoch:  42
epoch:  43 val_f1:  0.7639705763479104 val_auroc:  0.8132056946489936 val_auprc:  0.9076607736692377
EarlyStopping counter: 13 out of 50
epoch:  43
epoch:  44 val_f1:  0.7737843767539161 val_auroc:  0.8141875306823759 val_auprc:  0.8970704347930727
EarlyStopping counter: 14 out of 50
epoch:  44
epoch:  45 val_f1:  0.766354189375772 val_auroc:  0.8122238586156112 val_auprc:  0.8879847596242669
EarlyStopping counter: 15 out of 50
epoch:  45
epoch:  46 val_f1:  0.76000113614692 val_auroc:  0.8132056946489936 val_auprc:  0.888228790129249
EarlyStopping counter: 16 out of 50
epoch:  46
epoch:  47 val_f1:  0.7762067639678805 val_auroc:  0.8132056946489936 val_auprc:  0.8929738585108982
EarlyStopping counter: 17 out of 50
epoch:  47
epoch:  48 val_f1:  0.7583800901862243 val_auroc:  0.81173294059892 val_auprc:  0.9022055037713964
EarlyStopping counter: 18 out of 50
epoch:  48
epoch:  49 val_f1:  0.7648187281552264 val_auroc:  0.8114874815905744 val_auprc:  0.8933957948939208
EarlyStopping counter: 19 out of 50
epoch:  49
epoch:  50 val_f1:  0.7681512331200245 val_auroc:  0.8090328915071183 val_auprc:  0.8842251504834258
EarlyStopping counter: 20 out of 50
epoch:  50
epoch:  51 val_f1:  0.7569659388768054 val_auroc:  0.8078055964653903 val_auprc:  0.8911368381854989
EarlyStopping counter: 21 out of 50
epoch:  51
epoch:  52 val_f1:  0.7812454480117876 val_auroc:  0.8092783505154639 val_auprc:  0.8842691225597933
EarlyStopping counter: 22 out of 50
epoch:  52
epoch:  53 val_f1:  0.766354189375772 val_auroc:  0.8100147275405007 val_auprc:  0.8845370480624928
EarlyStopping counter: 23 out of 50
epoch:  53
epoch:  54 val_f1:  0.7648187281552264 val_auroc:  0.8095238095238095 val_auprc:  0.8915091222395044
EarlyStopping counter: 24 out of 50
epoch:  54
epoch:  55 val_f1:  0.7748426784519089 val_auroc:  0.8100147275405007 val_auprc:  0.8957322433670678
EarlyStopping counter: 25 out of 50
epoch:  55
epoch:  56 val_f1:  0.7633550302615051 val_auroc:  0.8082965144820815 val_auprc:  0.8996826927285959
EarlyStopping counter: 26 out of 50
epoch:  56
epoch:  57 val_f1:  0.7762067639678805 val_auroc:  0.8080510554737359 val_auprc:  0.8836053077829704
EarlyStopping counter: 27 out of 50
epoch:  57
epoch:  58 val_f1:  0.7685409504908388 val_auroc:  0.810505645557192 val_auprc:  0.8841764011788207
EarlyStopping counter: 28 out of 50
epoch:  58
epoch:  59 val_f1:  0.7633714058926586 val_auroc:  0.8090328915071183 val_auprc:  0.887948263949295
EarlyStopping counter: 29 out of 50
epoch:  59
epoch:  60 val_f1:  0.7770871369605723 val_auroc:  0.8097692685321551 val_auprc:  0.8837711623507347
EarlyStopping counter: 30 out of 50
epoch:  60
epoch:  61 val_f1:  0.7748796193569787 val_auroc:  0.8090328915071183 val_auprc:  0.8826088697881349
EarlyStopping counter: 31 out of 50
epoch:  61
epoch:  62 val_f1:  0.7724732835091151 val_auroc:  0.812960235640648 val_auprc:  0.8836764891268145
EarlyStopping counter: 32 out of 50
epoch:  62
epoch:  63 val_f1:  0.7685409504908388 val_auroc:  0.8100147275405007 val_auprc:  0.8837695480385102
EarlyStopping counter: 33 out of 50
epoch:  63
epoch:  64 val_f1:  0.7770871369605723 val_auroc:  0.8090328915071183 val_auprc:  0.8821067716422868
EarlyStopping counter: 34 out of 50
epoch:  64
epoch:  65 val_f1:  0.7569659388768054 val_auroc:  0.8060873834069711 val_auprc:  0.8806818389011453
EarlyStopping counter: 35 out of 50
epoch:  65
epoch:  66 val_f1:  0.7633714058926586 val_auroc:  0.8043691703485518 val_auprc:  0.8793008071905302
EarlyStopping counter: 36 out of 50
epoch:  66
epoch:  67 val_f1:  0.7813819697019021 val_auroc:  0.8063328424153168 val_auprc:  0.885074158586742
EarlyStopping counter: 37 out of 50
epoch:  67
epoch:  68 val_f1:  0.766354189375772 val_auroc:  0.8060873834069711 val_auprc:  0.8798569230247271
EarlyStopping counter: 38 out of 50
epoch:  68
epoch:  69 val_f1:  0.7812454480117876 val_auroc:  0.8065783014236623 val_auprc:  0.8711875440724777
EarlyStopping counter: 39 out of 50
epoch:  69
epoch:  70 val_f1:  0.7697841726618705 val_auroc:  0.8073146784486991 val_auprc:  0.8726752384371745
EarlyStopping counter: 40 out of 50
epoch:  70
epoch:  71 val_f1:  0.7748796193569787 val_auroc:  0.8073146784486991 val_auprc:  0.8720102162441152
EarlyStopping counter: 41 out of 50
epoch:  71
epoch:  72 val_f1:  0.7841726618705036 val_auroc:  0.8085419734904271 val_auprc:  0.8730197448965897
EarlyStopping counter: 42 out of 50
epoch:  72
epoch:  73 val_f1:  0.7813819697019021 val_auroc:  0.8055964653902798 val_auprc:  0.8924155897601451
EarlyStopping counter: 43 out of 50
epoch:  73
epoch:  74 val_f1:  0.7697841726618705 val_auroc:  0.8055964653902798 val_auprc:  0.8830693514611627
EarlyStopping counter: 44 out of 50
epoch:  74
epoch:  75 val_f1:  0.7812454480117876 val_auroc:  0.804860088365243 val_auprc:  0.8692398309317686
EarlyStopping counter: 45 out of 50
epoch:  75
epoch:  76 val_f1:  0.7812454480117876 val_auroc:  0.804860088365243 val_auprc:  0.8691475411202016
EarlyStopping counter: 46 out of 50
epoch:  76
epoch:  77 val_f1:  0.7748796193569787 val_auroc:  0.8046146293568974 val_auprc:  0.8682447523545267
EarlyStopping counter: 47 out of 50
epoch:  77
epoch:  78 val_f1:  0.7697841726618705 val_auroc:  0.8063328424153166 val_auprc:  0.871667094490127
EarlyStopping counter: 48 out of 50
epoch:  78
epoch:  79 val_f1:  0.7617684906754855 val_auroc:  0.8041237113402062 val_auprc:  0.8694149656063561
EarlyStopping counter: 49 out of 50
epoch:  79
epoch:  80 val_f1:  0.7622262794246104 val_auroc:  0.8028964162984782 val_auprc:  0.8672714976567693
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  218.29893612861633
{'time_elapsed': [218.29893612861633], 'epoch': [79], 'fold': [1], 'f1_train': [0.9964023152258445], 'auroc_train': [0.9999846705705613], 'auprc_train': [0.9999932970817315], 'f1_test': [0.7622262794246104], 'auroc_test': [0.8028964162984782], 'auprc_test': [0.8672714976567693]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 183]           8,192
│    └─BatchNorm1d: 2-2                  [64, 1024, 183]           2,048
│    └─Tanh: 2-3                         [64, 1024, 183]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 26]            --
│    └─Dropout: 2-5                      [64, 1024, 26]            --
│    └─Flatten: 2-6                      [64, 26624]               --
│    └─Linear: 2-7                       [64, 1]                   26,625
==========================================================================================
Total params: 36,865
Trainable params: 36,865
Non-trainable params: 0
Total mult-adds (M): 97.78
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 191.89
Params size (MB): 0.15
Estimated Total Size (MB): 192.37
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.6143838978890526 val_auprc:  0.7607830231033466
epoch:  1
epoch:  2 val_f1:  0.5093733708685226 val_auroc:  0.6264113892979872 val_auprc:  0.7787578341633458
Validation loss improved to 1.201059
epoch:  2
epoch:  3 val_f1:  0.5206306146261745 val_auroc:  0.6293568973981345 val_auprc:  0.780002422780724
Validation loss improved to 1.183050
epoch:  3
epoch:  4 val_f1:  0.5179856115107913 val_auroc:  0.6492390770741285 val_auprc:  0.7956357517793632
Validation loss improved to 1.174325
epoch:  4
epoch:  5 val_f1:  0.5349401485179306 val_auroc:  0.6745213549337261 val_auprc:  0.8186799936604846
Validation loss improved to 1.139198
epoch:  5
epoch:  6 val_f1:  0.523079159050382 val_auroc:  0.7093765341188022 val_auprc:  0.8545631256076427
Validation loss improved to 1.121704
epoch:  6
epoch:  7 val_f1:  0.6659129838985954 val_auroc:  0.7317133038782523 val_auprc:  0.8693547433935382
Validation loss improved to 1.081448
epoch:  7
epoch:  8 val_f1:  0.5611510791366906 val_auroc:  0.7552773686794305 val_auprc:  0.8832800052492843
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.717230470942395 val_auroc:  0.7601865488463426 val_auprc:  0.8865986760457878
Validation loss improved to 1.062288
epoch:  9
epoch:  10 val_f1:  0.6353297362110312 val_auroc:  0.7589592538046146 val_auprc:  0.8842664824824251
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.7215941532488295 val_auroc:  0.7616593028964164 val_auprc:  0.8863642812018052
Validation loss improved to 1.048242
epoch:  11
epoch:  12 val_f1:  0.7030919944895149 val_auroc:  0.7584683357879235 val_auprc:  0.885054938968607
Validation loss improved to 1.041524
epoch:  12
epoch:  13 val_f1:  0.6729375272402062 val_auroc:  0.757486499754541 val_auprc:  0.884293439903961
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.6997814539066421 val_auroc:  0.761904761904762 val_auprc:  0.8868597746791484
Validation loss improved to 1.030627
epoch:  14
epoch:  15 val_f1:  0.6876087591262989 val_auroc:  0.7589592538046147 val_auprc:  0.8825644968825257
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.696151679426677 val_auroc:  0.7604320078546883 val_auprc:  0.8837821547368963
Validation loss improved to 1.028740
epoch:  16
epoch:  17 val_f1:  0.6998394924759714 val_auroc:  0.7707412862052038 val_auprc:  0.8880285324002958
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.6120424115607032 val_auroc:  0.7582228767795778 val_auprc:  0.8791805280085512
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7477455593342162 val_auroc:  0.7631320569464899 val_auprc:  0.8840619714280463
Validation loss improved to 1.008563
epoch:  19
epoch:  20 val_f1:  0.7371937993371881 val_auroc:  0.7604320078546882 val_auprc:  0.8800822620286197
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.6963686193902022 val_auroc:  0.7592047128129602 val_auprc:  0.8784713500354863
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7402181480621955 val_auroc:  0.7623956799214531 val_auprc:  0.8796455366166736
Validation loss improved to 1.007461
epoch:  22
epoch:  23 val_f1:  0.7157412825720284 val_auroc:  0.7636229749631811 val_auprc:  0.8795391702023972
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7233618940391454 val_auroc:  0.7589592538046146 val_auprc:  0.8770170071124604
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.7166299330477814 val_auroc:  0.757486499754541 val_auprc:  0.8762900510889353
EarlyStopping counter: 3 out of 50
epoch:  25
epoch:  26 val_f1:  0.6752910608296504 val_auroc:  0.7542955326460481 val_auprc:  0.8745742822165837
EarlyStopping counter: 4 out of 50
epoch:  26
epoch:  27 val_f1:  0.7362024088594293 val_auroc:  0.7567501227295043 val_auprc:  0.8746041848688048
EarlyStopping counter: 5 out of 50
epoch:  27
epoch:  28 val_f1:  0.7466980132583976 val_auroc:  0.7594501718213058 val_auprc:  0.8761089560674467
EarlyStopping counter: 6 out of 50
epoch:  28
epoch:  29 val_f1:  0.7500864926036699 val_auroc:  0.7594501718213058 val_auprc:  0.8757928536595649
EarlyStopping counter: 7 out of 50
epoch:  29
epoch:  30 val_f1:  0.7326256806616418 val_auroc:  0.7641138929798724 val_auprc:  0.8775478129603858
EarlyStopping counter: 8 out of 50
epoch:  30
epoch:  31 val_f1:  0.675544391518161 val_auroc:  0.7604320078546883 val_auprc:  0.8767478424174127
EarlyStopping counter: 9 out of 50
epoch:  31
epoch:  32 val_f1:  0.7362024088594293 val_auroc:  0.7604320078546882 val_auprc:  0.8759349339652484
EarlyStopping counter: 10 out of 50
epoch:  32
epoch:  33 val_f1:  0.7326256806616418 val_auroc:  0.7646048109965635 val_auprc:  0.878543847004823
EarlyStopping counter: 11 out of 50
epoch:  33
epoch:  34 val_f1:  0.7326256806616418 val_auroc:  0.7638684339715267 val_auprc:  0.8780603383087975
EarlyStopping counter: 12 out of 50
epoch:  34
epoch:  35 val_f1:  0.7326256806616418 val_auroc:  0.7658321060382917 val_auprc:  0.878848255652137
EarlyStopping counter: 13 out of 50
epoch:  35
epoch:  36 val_f1:  0.7313689473952751 val_auroc:  0.76926853215513 val_auprc:  0.8800542448430508
EarlyStopping counter: 14 out of 50
epoch:  36
epoch:  37 val_f1:  0.7223183251151889 val_auroc:  0.761904761904762 val_auprc:  0.8767238322659344
EarlyStopping counter: 15 out of 50
epoch:  37
epoch:  38 val_f1:  0.713247796930704 val_auroc:  0.7614138438880708 val_auprc:  0.8752221756986642
EarlyStopping counter: 16 out of 50
epoch:  38
epoch:  39 val_f1:  0.7176437068167247 val_auroc:  0.7658321060382917 val_auprc:  0.8767571323305402
EarlyStopping counter: 17 out of 50
epoch:  39
epoch:  40 val_f1:  0.6893376055458154 val_auroc:  0.7697594501718212 val_auprc:  0.8781707464869166
EarlyStopping counter: 18 out of 50
epoch:  40
epoch:  41 val_f1:  0.7058128438779214 val_auroc:  0.7677957781050565 val_auprc:  0.877286455197358
EarlyStopping counter: 19 out of 50
epoch:  41
epoch:  42 val_f1:  0.7156947373800909 val_auroc:  0.7577319587628867 val_auprc:  0.8694914487391412
EarlyStopping counter: 20 out of 50
epoch:  42
epoch:  43 val_f1:  0.7235944791518311 val_auroc:  0.7626411389297988 val_auprc:  0.8713335773143679
EarlyStopping counter: 21 out of 50
epoch:  43
epoch:  44 val_f1:  0.7473302173830908 val_auroc:  0.7685321551300933 val_auprc:  0.8778482818812305
EarlyStopping counter: 22 out of 50
epoch:  44
epoch:  45 val_f1:  0.717230470942395 val_auroc:  0.7650957290132547 val_auprc:  0.871678635913963
EarlyStopping counter: 23 out of 50
epoch:  45
epoch:  46 val_f1:  0.7237424247793883 val_auroc:  0.7677957781050564 val_auprc:  0.8710427873025062
EarlyStopping counter: 24 out of 50
epoch:  46
epoch:  47 val_f1:  0.7185533480648861 val_auroc:  0.7609229258713794 val_auprc:  0.8673804169207513
EarlyStopping counter: 25 out of 50
epoch:  47
epoch:  48 val_f1:  0.7313689473952751 val_auroc:  0.7623956799214531 val_auprc:  0.8687102016029349
EarlyStopping counter: 26 out of 50
epoch:  48
epoch:  49 val_f1:  0.7287333672277241 val_auroc:  0.7638684339715267 val_auprc:  0.8720736154785962
EarlyStopping counter: 27 out of 50
epoch:  49
epoch:  50 val_f1:  0.7142089711496735 val_auroc:  0.7604320078546882 val_auprc:  0.8706906978121938
EarlyStopping counter: 28 out of 50
epoch:  50
epoch:  51 val_f1:  0.7166299330477814 val_auroc:  0.751840942562592 val_auprc:  0.8649014757569927
EarlyStopping counter: 29 out of 50
epoch:  51
epoch:  52 val_f1:  0.7150229029574715 val_auroc:  0.7538046146293569 val_auprc:  0.865300607531054
EarlyStopping counter: 30 out of 50
epoch:  52
epoch:  53 val_f1:  0.7263486361521366 val_auroc:  0.7621502209131075 val_auprc:  0.8691608665014262
EarlyStopping counter: 31 out of 50
epoch:  53
epoch:  54 val_f1:  0.7238240177089098 val_auroc:  0.7658321060382915 val_auprc:  0.8697313661585377
EarlyStopping counter: 32 out of 50
epoch:  54
epoch:  55 val_f1:  0.7238240177089098 val_auroc:  0.756259204712813 val_auprc:  0.8636078377634268
EarlyStopping counter: 33 out of 50
epoch:  55
epoch:  56 val_f1:  0.7202047592695074 val_auroc:  0.7557682866961217 val_auprc:  0.8656542231015446
EarlyStopping counter: 34 out of 50
epoch:  56
epoch:  57 val_f1:  0.7142089711496735 val_auroc:  0.7540500736377026 val_auprc:  0.8656685495428821
EarlyStopping counter: 35 out of 50
epoch:  57
epoch:  58 val_f1:  0.7156947373800909 val_auroc:  0.7508591065292096 val_auprc:  0.8662217841105804
EarlyStopping counter: 36 out of 50
epoch:  58
epoch:  59 val_f1:  0.7202047592695074 val_auroc:  0.7547864506627393 val_auprc:  0.8650723255368125
EarlyStopping counter: 37 out of 50
epoch:  59
epoch:  60 val_f1:  0.7238240177089098 val_auroc:  0.7616593028964163 val_auprc:  0.870636582893736
EarlyStopping counter: 38 out of 50
epoch:  60
epoch:  61 val_f1:  0.726967940210938 val_auroc:  0.761168384879725 val_auprc:  0.8710631767605125
EarlyStopping counter: 39 out of 50
epoch:  61
epoch:  62 val_f1:  0.7044810154681304 val_auroc:  0.7533136966126658 val_auprc:  0.8669065599028667
EarlyStopping counter: 40 out of 50
epoch:  62
epoch:  63 val_f1:  0.6773246443990799 val_auroc:  0.750613647520864 val_auprc:  0.8629408918946184
EarlyStopping counter: 41 out of 50
epoch:  63
epoch:  64 val_f1:  0.7060068982302729 val_auroc:  0.7540500736377025 val_auprc:  0.8642489685016898
EarlyStopping counter: 42 out of 50
epoch:  64
epoch:  65 val_f1:  0.7386752666832053 val_auroc:  0.7545409916543938 val_auprc:  0.8646805319698685
EarlyStopping counter: 43 out of 50
epoch:  65
epoch:  66 val_f1:  0.7178022432023763 val_auroc:  0.7577319587628866 val_auprc:  0.8656352361844845
EarlyStopping counter: 44 out of 50
epoch:  66
epoch:  67 val_f1:  0.7078050864958872 val_auroc:  0.753804614629357 val_auprc:  0.8639652286341599
EarlyStopping counter: 45 out of 50
epoch:  67
epoch:  68 val_f1:  0.7015283467006299 val_auroc:  0.7515954835542464 val_auprc:  0.8635494600481171
EarlyStopping counter: 46 out of 50
epoch:  68
epoch:  69 val_f1:  0.7044810154681304 val_auroc:  0.7533136966126657 val_auprc:  0.8645577079233693
EarlyStopping counter: 47 out of 50
epoch:  69
epoch:  70 val_f1:  0.7015283467006299 val_auroc:  0.7525773195876289 val_auprc:  0.863613248314264
EarlyStopping counter: 48 out of 50
epoch:  70
epoch:  71 val_f1:  0.7178022432023763 val_auroc:  0.7582228767795778 val_auprc:  0.8659211441587464
EarlyStopping counter: 49 out of 50
epoch:  71
epoch:  72 val_f1:  0.7202047592695074 val_auroc:  0.7582228767795778 val_auprc:  0.8685843456764787
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  196.29983711242676
{'time_elapsed': [196.29983711242676], 'epoch': [71], 'fold': [2], 'f1_train': [0.9838741042833115], 'auroc_train': [0.9989422693687341], 'auprc_train': [0.9995539108833806], 'f1_test': [0.7202047592695074], 'auroc_test': [0.7582228767795778], 'auprc_test': [0.8685843456764787]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 183]           8,192
│    └─BatchNorm1d: 2-2                  [64, 1024, 183]           2,048
│    └─Tanh: 2-3                         [64, 1024, 183]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 26]            --
│    └─Dropout: 2-5                      [64, 1024, 26]            --
│    └─Flatten: 2-6                      [64, 26624]               --
│    └─Linear: 2-7                       [64, 1]                   26,625
==========================================================================================
Total params: 36,865
Trainable params: 36,865
Non-trainable params: 0
Total mult-adds (M): 97.78
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 191.89
Params size (MB): 0.15
Estimated Total Size (MB): 192.37
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1461775634437505 val_auroc:  0.7122093023255814 val_auprc:  0.8681661908580657
epoch:  1
epoch:  2 val_f1:  0.6615835381856937 val_auroc:  0.7061531007751938 val_auprc:  0.8667257502666186
Validation loss improved to 1.195416
epoch:  2
epoch:  3 val_f1:  0.6673557705559691 val_auroc:  0.7095445736434108 val_auprc:  0.8629486130028504
Validation loss improved to 1.133406
epoch:  3
epoch:  4 val_f1:  0.6643077374834826 val_auroc:  0.7286821705426356 val_auprc:  0.8754118435682512
Validation loss improved to 1.109966
epoch:  4
epoch:  5 val_f1:  0.7071101770269177 val_auroc:  0.7533914728682171 val_auprc:  0.8893345645003047
Validation loss improved to 1.084700
epoch:  5
epoch:  6 val_f1:  0.7105563674605215 val_auroc:  0.7739825581395349 val_auprc:  0.9024879773011427
Validation loss improved to 1.063883
epoch:  6
epoch:  7 val_f1:  0.7435892899059994 val_auroc:  0.7948158914728684 val_auprc:  0.9128479857000816
Validation loss improved to 1.036640
epoch:  7
epoch:  8 val_f1:  0.7247733477430133 val_auroc:  0.8103197674418605 val_auprc:  0.9207098941225405
Validation loss improved to 1.030809
epoch:  8
epoch:  9 val_f1:  0.7473812159063956 val_auroc:  0.8163759689922482 val_auprc:  0.9231274425278698
Validation loss improved to 0.998171
epoch:  9
epoch:  10 val_f1:  0.7489515803087866 val_auroc:  0.8209786821705426 val_auprc:  0.9241573031860495
Validation loss improved to 0.982069
epoch:  10
epoch:  11 val_f1:  0.7124932804154134 val_auroc:  0.8246124031007752 val_auprc:  0.923427343457532
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7639114172852699 val_auroc:  0.8231589147286821 val_auprc:  0.9233372999697139
Validation loss improved to 0.951382
epoch:  12
epoch:  13 val_f1:  0.7745758989478168 val_auroc:  0.8258236434108527 val_auprc:  0.9242353673798053
Validation loss improved to 0.943154
epoch:  13
epoch:  14 val_f1:  0.7568878868197308 val_auroc:  0.8263081395348837 val_auprc:  0.923240071030788
Validation loss improved to 0.937762
epoch:  14
epoch:  15 val_f1:  0.7713093666729185 val_auroc:  0.8306686046511628 val_auprc:  0.9258123496461647
Validation loss improved to 0.917593
epoch:  15
epoch:  16 val_f1:  0.7310499329915123 val_auroc:  0.8309108527131782 val_auprc:  0.925332409082634
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7644817479349855 val_auroc:  0.8352713178294574 val_auprc:  0.9284339893562688
Validation loss improved to 0.902327
epoch:  17
epoch:  18 val_f1:  0.7310499329915123 val_auroc:  0.8321220930232559 val_auprc:  0.9247520000706477
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7713093666729185 val_auroc:  0.8357558139534883 val_auprc:  0.9283898385430651
Validation loss improved to 0.876079
epoch:  19
epoch:  20 val_f1:  0.7754499696945739 val_auroc:  0.8369670542635659 val_auprc:  0.9283076832657958
Validation loss improved to 0.864487
epoch:  20
epoch:  21 val_f1:  0.7877294237541244 val_auroc:  0.8398740310077519 val_auprc:  0.9294647329957576
Validation loss improved to 0.859624
epoch:  21
epoch:  22 val_f1:  0.7735780520043992 val_auroc:  0.840843023255814 val_auprc:  0.9296599351916849
Validation loss improved to 0.857094
epoch:  22
epoch:  23 val_f1:  0.7489893984794112 val_auroc:  0.8415697674418605 val_auprc:  0.9305066494653398
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7644817479349855 val_auroc:  0.8410852713178295 val_auprc:  0.9316928433935614
Validation loss improved to 0.836689
epoch:  24
epoch:  25 val_f1:  0.7646314961799923 val_auroc:  0.8415697674418605 val_auprc:  0.9326531766126505
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.7540304643278981 val_auroc:  0.8427810077519379 val_auprc:  0.9303642698914398
EarlyStopping counter: 2 out of 50
epoch:  26
epoch:  27 val_f1:  0.7647070144847204 val_auroc:  0.8493217054263565 val_auprc:  0.9338587344631538
Validation loss improved to 0.826657
epoch:  27
epoch:  28 val_f1:  0.7701596400342386 val_auroc:  0.8471414728682171 val_auprc:  0.9338303614969956
Validation loss improved to 0.801401
epoch:  28
epoch:  29 val_f1:  0.7634619577065621 val_auroc:  0.8483527131782945 val_auprc:  0.9348552643459055
Validation loss improved to 0.791453
epoch:  29
epoch:  30 val_f1:  0.7697841726618705 val_auroc:  0.8512596899224807 val_auprc:  0.9348082520808895
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7659382513381667 val_auroc:  0.8527131782945735 val_auprc:  0.9362227507566422
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.7710202043822609 val_auroc:  0.8522286821705426 val_auprc:  0.9358481065288129
EarlyStopping counter: 3 out of 50
epoch:  32
epoch:  33 val_f1:  0.7701596400342386 val_auroc:  0.8541666666666666 val_auprc:  0.9387815021422515
Validation loss improved to 0.771115
epoch:  33
epoch:  34 val_f1:  0.7644817479349855 val_auroc:  0.8515019379844961 val_auprc:  0.9382513974783547
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.7701596400342386 val_auroc:  0.8546511627906976 val_auprc:  0.9393335505478313
Validation loss improved to 0.759084
epoch:  35
epoch:  36 val_f1:  0.7666659578740948 val_auroc:  0.8568313953488373 val_auprc:  0.9385573572401676
EarlyStopping counter: 1 out of 50
epoch:  36
epoch:  37 val_f1:  0.7735780520043992 val_auroc:  0.8590116279069767 val_auprc:  0.9407653796850637
EarlyStopping counter: 2 out of 50
epoch:  37
epoch:  38 val_f1:  0.7701596400342386 val_auroc:  0.8609496124031008 val_auprc:  0.9422884108462579
Validation loss improved to 0.747226
epoch:  38
epoch:  39 val_f1:  0.7841726618705036 val_auroc:  0.8616763565891473 val_auprc:  0.941578732101325
EarlyStopping counter: 1 out of 50
epoch:  39
epoch:  40 val_f1:  0.792019787311512 val_auroc:  0.8626453488372093 val_auprc:  0.9426548397142706
EarlyStopping counter: 2 out of 50
epoch:  40
epoch:  41 val_f1:  0.7706506750217025 val_auroc:  0.8590116279069767 val_auprc:  0.9419770825413676
EarlyStopping counter: 3 out of 50
epoch:  41
epoch:  42 val_f1:  0.7695564219015847 val_auroc:  0.8599806201550387 val_auprc:  0.9423834482011345
Validation loss improved to 0.743135
epoch:  42
epoch:  43 val_f1:  0.768937708914086 val_auroc:  0.8638565891472867 val_auprc:  0.9420074083790038
EarlyStopping counter: 1 out of 50
epoch:  43
epoch:  44 val_f1:  0.768937708914086 val_auroc:  0.8665213178294574 val_auprc:  0.9435793221121451
EarlyStopping counter: 2 out of 50
epoch:  44
epoch:  45 val_f1:  0.7972014141264308 val_auroc:  0.8645833333333334 val_auprc:  0.9437294353084975
EarlyStopping counter: 3 out of 50
epoch:  45
epoch:  46 val_f1:  0.8037391402911035 val_auroc:  0.8684593023255814 val_auprc:  0.9459286319280735
EarlyStopping counter: 4 out of 50
epoch:  46
epoch:  47 val_f1:  0.792019787311512 val_auroc:  0.8670058139534883 val_auprc:  0.9454798832411229
EarlyStopping counter: 5 out of 50
epoch:  47
epoch:  48 val_f1:  0.767033173809688 val_auroc:  0.8653100775193799 val_auprc:  0.9450475908001622
Validation loss improved to 0.734769
epoch:  48
epoch:  49 val_f1:  0.8037391402911035 val_auroc:  0.8696705426356589 val_auprc:  0.9464343236306951
EarlyStopping counter: 1 out of 50
epoch:  49
epoch:  50 val_f1:  0.7774211400110681 val_auroc:  0.8711240310077519 val_auprc:  0.9467854507483763
EarlyStopping counter: 2 out of 50
epoch:  50
epoch:  51 val_f1:  0.792019787311512 val_auroc:  0.8708817829457364 val_auprc:  0.9474400170279509
EarlyStopping counter: 3 out of 50
epoch:  51
epoch:  52 val_f1:  0.8051160047274586 val_auroc:  0.872093023255814 val_auprc:  0.9477542828083323
EarlyStopping counter: 4 out of 50
epoch:  52
epoch:  53 val_f1:  0.7985611510791367 val_auroc:  0.8733042635658915 val_auprc:  0.9484276966441262
EarlyStopping counter: 5 out of 50
epoch:  53
epoch:  54 val_f1:  0.7957035068809065 val_auroc:  0.8737887596899224 val_auprc:  0.9484139783705217
EarlyStopping counter: 6 out of 50
epoch:  54
epoch:  55 val_f1:  0.7957035068809065 val_auroc:  0.8737887596899223 val_auprc:  0.9490163709785415
EarlyStopping counter: 7 out of 50
epoch:  55
epoch:  56 val_f1:  0.7854893118997625 val_auroc:  0.8742732558139534 val_auprc:  0.9490939941245622
EarlyStopping counter: 8 out of 50
epoch:  56
epoch:  57 val_f1:  0.7854893118997625 val_auroc:  0.8752422480620156 val_auprc:  0.9492905211021061
Validation loss improved to 0.733667
epoch:  57
epoch:  58 val_f1:  0.7985611510791367 val_auroc:  0.8752422480620156 val_auprc:  0.9493255589240079
EarlyStopping counter: 1 out of 50
epoch:  58
epoch:  59 val_f1:  0.7906801532257888 val_auroc:  0.8737887596899224 val_auprc:  0.948880082636812
EarlyStopping counter: 2 out of 50
epoch:  59
epoch:  60 val_f1:  0.7957035068809065 val_auroc:  0.8805717054263565 val_auprc:  0.9515592063051693
EarlyStopping counter: 3 out of 50
epoch:  60
epoch:  61 val_f1:  0.7972014141264308 val_auroc:  0.8800872093023256 val_auprc:  0.9514369203882046
EarlyStopping counter: 4 out of 50
epoch:  61
epoch:  62 val_f1:  0.7952715769842713 val_auroc:  0.8720930232558138 val_auprc:  0.9486791193527488
Validation loss improved to 0.725043
epoch:  62
epoch:  63 val_f1:  0.792019787311512 val_auroc:  0.874515503875969 val_auprc:  0.9495874748982635
EarlyStopping counter: 1 out of 50
epoch:  63
epoch:  64 val_f1:  0.792019787311512 val_auroc:  0.8747577519379844 val_auprc:  0.9497911191524833
EarlyStopping counter: 2 out of 50
epoch:  64
epoch:  65 val_f1:  0.7985611510791367 val_auroc:  0.8798449612403101 val_auprc:  0.9515169505261276
EarlyStopping counter: 3 out of 50
epoch:  65
epoch:  66 val_f1:  0.7932273763653603 val_auroc:  0.8771802325581395 val_auprc:  0.9506180558729322
EarlyStopping counter: 4 out of 50
epoch:  66
epoch:  67 val_f1:  0.7892012988311853 val_auroc:  0.8820251937984496 val_auprc:  0.9523756132751483
EarlyStopping counter: 5 out of 50
epoch:  67
epoch:  68 val_f1:  0.7875752415552048 val_auroc:  0.8832364341085271 val_auprc:  0.9530106771674884
EarlyStopping counter: 6 out of 50
epoch:  68
epoch:  69 val_f1:  0.7841726618705036 val_auroc:  0.8786337209302325 val_auprc:  0.9513450915056801
EarlyStopping counter: 7 out of 50
epoch:  69
epoch:  70 val_f1:  0.7987865034149394 val_auroc:  0.8769379844961241 val_auprc:  0.9500199729749523
EarlyStopping counter: 8 out of 50
epoch:  70
epoch:  71 val_f1:  0.8027539115793398 val_auroc:  0.8791182170542636 val_auprc:  0.9513007691679719
Validation loss improved to 0.724460
epoch:  71
epoch:  72 val_f1:  0.8093907785715628 val_auroc:  0.8786337209302326 val_auprc:  0.9508108056049005
EarlyStopping counter: 1 out of 50
epoch:  72
epoch:  73 val_f1:  0.7827158008497472 val_auroc:  0.8810562015503876 val_auprc:  0.9520690369683087
EarlyStopping counter: 2 out of 50
epoch:  73
epoch:  74 val_f1:  0.7892012988311853 val_auroc:  0.883720930232558 val_auprc:  0.9532162265187415
EarlyStopping counter: 3 out of 50
epoch:  74
epoch:  75 val_f1:  0.794309372388086 val_auroc:  0.8808139534883721 val_auprc:  0.9516921223309761
EarlyStopping counter: 4 out of 50
epoch:  75
epoch:  76 val_f1:  0.8063632502555458 val_auroc:  0.8820251937984496 val_auprc:  0.9524410808598766
EarlyStopping counter: 5 out of 50
epoch:  76
epoch:  77 val_f1:  0.7729252582141845 val_auroc:  0.8846899224806201 val_auprc:  0.95357434791694
EarlyStopping counter: 6 out of 50
epoch:  77
epoch:  78 val_f1:  0.783844953500274 val_auroc:  0.8866279069767441 val_auprc:  0.9542343372966086
EarlyStopping counter: 7 out of 50
epoch:  78
epoch:  79 val_f1:  0.7729252582141845 val_auroc:  0.8878391472868218 val_auprc:  0.9548799290011991
EarlyStopping counter: 8 out of 50
epoch:  79
epoch:  80 val_f1:  0.7932273763653603 val_auroc:  0.8825096899224806 val_auprc:  0.9524347509243529
EarlyStopping counter: 9 out of 50
epoch:  80
epoch:  81 val_f1:  0.776244301724119 val_auroc:  0.8834786821705426 val_auprc:  0.9530454382888388
EarlyStopping counter: 10 out of 50
epoch:  81
epoch:  82 val_f1:  0.776244301724119 val_auroc:  0.8829941860465116 val_auprc:  0.9527424773131693
EarlyStopping counter: 11 out of 50
epoch:  82
epoch:  83 val_f1:  0.7729252582141845 val_auroc:  0.8851744186046512 val_auprc:  0.9536491497107666
EarlyStopping counter: 12 out of 50
epoch:  83
epoch:  84 val_f1:  0.7729252582141845 val_auroc:  0.8871124031007752 val_auprc:  0.9545420785115868
EarlyStopping counter: 13 out of 50
epoch:  84
epoch:  85 val_f1:  0.7892012988311853 val_auroc:  0.8859011627906975 val_auprc:  0.9539668172163882
EarlyStopping counter: 14 out of 50
epoch:  85
epoch:  86 val_f1:  0.776244301724119 val_auroc:  0.8851744186046512 val_auprc:  0.9535981965210347
EarlyStopping counter: 15 out of 50
epoch:  86
epoch:  87 val_f1:  0.776244301724119 val_auroc:  0.8839631782945737 val_auprc:  0.9531689869721427
EarlyStopping counter: 16 out of 50
epoch:  87
epoch:  88 val_f1:  0.794309372388086 val_auroc:  0.8800872093023255 val_auprc:  0.9512662202559657
EarlyStopping counter: 17 out of 50
epoch:  88
epoch:  89 val_f1:  0.7841726618705036 val_auroc:  0.8842054263565892 val_auprc:  0.9533161553250042
EarlyStopping counter: 18 out of 50
epoch:  89
epoch:  90 val_f1:  0.7729252582141845 val_auroc:  0.8839631782945736 val_auprc:  0.9529233714899763
EarlyStopping counter: 19 out of 50
epoch:  90
epoch:  91 val_f1:  0.7793492478744277 val_auroc:  0.8844476744186046 val_auprc:  0.9533242204015997
EarlyStopping counter: 20 out of 50
epoch:  91
epoch:  92 val_f1:  0.792019787311512 val_auroc:  0.8796027131782945 val_auprc:  0.9510809979564069
EarlyStopping counter: 21 out of 50
epoch:  92
epoch:  93 val_f1:  0.792019787311512 val_auroc:  0.8815406976744186 val_auprc:  0.9516158060684069
EarlyStopping counter: 22 out of 50
epoch:  93
epoch:  94 val_f1:  0.7729252582141845 val_auroc:  0.8834786821705426 val_auprc:  0.953042390948554
EarlyStopping counter: 23 out of 50
epoch:  94
epoch:  95 val_f1:  0.7827158008497472 val_auroc:  0.8837209302325582 val_auprc:  0.9530790159900958
EarlyStopping counter: 24 out of 50
epoch:  95
epoch:  96 val_f1:  0.8084949329130455 val_auroc:  0.880813953488372 val_auprc:  0.9516746982219872
EarlyStopping counter: 25 out of 50
epoch:  96
epoch:  97 val_f1:  0.7665182935781787 val_auroc:  0.8844476744186046 val_auprc:  0.9534318108116009
EarlyStopping counter: 26 out of 50
epoch:  97
epoch:  98 val_f1:  0.7746634573712671 val_auroc:  0.8842054263565892 val_auprc:  0.9532625701065841
EarlyStopping counter: 27 out of 50
epoch:  98
epoch:  99 val_f1:  0.7729252582141845 val_auroc:  0.8846899224806201 val_auprc:  0.95356905153105
EarlyStopping counter: 28 out of 50
epoch:  99
epoch:  100 val_f1:  0.7811109002295425 val_auroc:  0.8834786821705426 val_auprc:  0.9529616629132555
EarlyStopping counter: 29 out of 50
epoch:  100
epoch:  101 val_f1:  0.7746634573712671 val_auroc:  0.882751937984496 val_auprc:  0.9525696985172213
EarlyStopping counter: 30 out of 50
epoch:  101
epoch:  102 val_f1:  0.792019787311512 val_auroc:  0.8820251937984497 val_auprc:  0.9521873416810667
EarlyStopping counter: 31 out of 50
epoch:  102
epoch:  103 val_f1:  0.7811109002295425 val_auroc:  0.8834786821705426 val_auprc:  0.9530050720791221
EarlyStopping counter: 32 out of 50
epoch:  103
epoch:  104 val_f1:  0.7746634573712671 val_auroc:  0.8844476744186046 val_auprc:  0.9532791190832182
EarlyStopping counter: 33 out of 50
epoch:  104
epoch:  105 val_f1:  0.7729252582141845 val_auroc:  0.8854166666666666 val_auprc:  0.9540216862077782
EarlyStopping counter: 34 out of 50
epoch:  105
epoch:  106 val_f1:  0.792019787311512 val_auroc:  0.8832364341085271 val_auprc:  0.9526511840517986
EarlyStopping counter: 35 out of 50
epoch:  106
epoch:  107 val_f1:  0.7729252582141845 val_auroc:  0.8846899224806202 val_auprc:  0.9535875931650555
EarlyStopping counter: 36 out of 50
epoch:  107
epoch:  108 val_f1:  0.792019787311512 val_auroc:  0.8817829457364341 val_auprc:  0.9518034432188476
EarlyStopping counter: 37 out of 50
epoch:  108
epoch:  109 val_f1:  0.8084949329130455 val_auroc:  0.8815406976744186 val_auprc:  0.9518099053770596
EarlyStopping counter: 38 out of 50
epoch:  109
epoch:  110 val_f1:  0.7793492478744277 val_auroc:  0.8871124031007752 val_auprc:  0.9545351195640347
EarlyStopping counter: 39 out of 50
epoch:  110
epoch:  111 val_f1:  0.7729252582141845 val_auroc:  0.8856589147286822 val_auprc:  0.9541180614282252
EarlyStopping counter: 40 out of 50
epoch:  111
epoch:  112 val_f1:  0.8084949329130455 val_auroc:  0.881782945736434 val_auprc:  0.9520104037619488
EarlyStopping counter: 41 out of 50
epoch:  112
epoch:  113 val_f1:  0.7892012988311853 val_auroc:  0.8854166666666666 val_auprc:  0.9536569037947608
EarlyStopping counter: 42 out of 50
epoch:  113
epoch:  114 val_f1:  0.7811109002295425 val_auroc:  0.8861434108527131 val_auprc:  0.9541126175725789
EarlyStopping counter: 43 out of 50
epoch:  114
epoch:  115 val_f1:  0.7729252582141845 val_auroc:  0.8868701550387597 val_auprc:  0.9545221860896038
EarlyStopping counter: 44 out of 50
epoch:  115
epoch:  116 val_f1:  0.8008946034661633 val_auroc:  0.8834786821705427 val_auprc:  0.9527632226888301
EarlyStopping counter: 45 out of 50
epoch:  116
epoch:  117 val_f1:  0.7811109002295425 val_auroc:  0.8856589147286821 val_auprc:  0.9540683239365759
EarlyStopping counter: 46 out of 50
epoch:  117
epoch:  118 val_f1:  0.7841726618705036 val_auroc:  0.8820251937984497 val_auprc:  0.9519509664124406
EarlyStopping counter: 47 out of 50
epoch:  118
epoch:  119 val_f1:  0.7811109002295425 val_auroc:  0.8866279069767442 val_auprc:  0.9545249642876339
EarlyStopping counter: 48 out of 50
epoch:  119
epoch:  120 val_f1:  0.7811109002295425 val_auroc:  0.8856589147286821 val_auprc:  0.9541460082201068
EarlyStopping counter: 49 out of 50
epoch:  120
epoch:  121 val_f1:  0.7811109002295425 val_auroc:  0.8851744186046512 val_auprc:  0.9535149550191367
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  332.574964761734
{'time_elapsed': [332.574964761734], 'epoch': [120], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7811109002295425], 'auroc_test': [0.8851744186046512], 'auprc_test': [0.9535149550191367]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 183]           8,192
│    └─BatchNorm1d: 2-2                  [64, 1024, 183]           2,048
│    └─Tanh: 2-3                         [64, 1024, 183]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 26]            --
│    └─Dropout: 2-5                      [64, 1024, 26]            --
│    └─Flatten: 2-6                      [64, 26624]               --
│    └─Linear: 2-7                       [64, 1]                   26,625
==========================================================================================
Total params: 36,865
Trainable params: 36,865
Non-trainable params: 0
Total mult-adds (M): 97.78
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 191.89
Params size (MB): 0.15
Estimated Total Size (MB): 192.37
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6625083044216431 val_auroc:  0.8020833333333334 val_auprc:  0.9032336847179017
epoch:  1
epoch:  2 val_f1:  0.6855174958489638 val_auroc:  0.7507440476190476 val_auprc:  0.8849522455855785
Validation loss improved to 1.132158
epoch:  2
epoch:  3 val_f1:  0.6956521739130435 val_auroc:  0.7544642857142857 val_auprc:  0.88577408678101
Validation loss improved to 1.114948
epoch:  3
epoch:  4 val_f1:  0.7151316814710924 val_auroc:  0.7648809523809523 val_auprc:  0.8889007152148178
Validation loss improved to 1.094576
epoch:  4
epoch:  5 val_f1:  0.7422840803969388 val_auroc:  0.7829861111111112 val_auprc:  0.8973574935047406
Validation loss improved to 1.072219
epoch:  5
epoch:  6 val_f1:  0.7391304347826086 val_auroc:  0.7996031746031745 val_auprc:  0.9030247158720911
Validation loss improved to 1.051920
epoch:  6
epoch:  7 val_f1:  0.7608091787439614 val_auroc:  0.8154761904761904 val_auprc:  0.9081980611380727
Validation loss improved to 1.033606
epoch:  7
epoch:  8 val_f1:  0.7605491990846683 val_auroc:  0.8348214285714286 val_auprc:  0.9117377446483476
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7494824016563146 val_auroc:  0.8405257936507937 val_auprc:  0.9129472772580873
Validation loss improved to 1.006415
epoch:  9
epoch:  10 val_f1:  0.7425627404942808 val_auroc:  0.853422619047619 val_auprc:  0.9175619511034587
Validation loss improved to 0.996208
epoch:  10
epoch:  11 val_f1:  0.8167092924126172 val_auroc:  0.8660714285714285 val_auprc:  0.9226436008537096
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.6046527563641347 val_auroc:  0.8578869047619048 val_auprc:  0.9207920218093503
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.8372994888066281 val_auroc:  0.871031746031746 val_auprc:  0.9266545434502866
Validation loss improved to 0.966687
epoch:  13
epoch:  14 val_f1:  0.7819511139952413 val_auroc:  0.871031746031746 val_auprc:  0.9258702554614762
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.7424375113599616 val_auroc:  0.8707837301587302 val_auprc:  0.9258140774748123
Validation loss improved to 0.954937
epoch:  15
epoch:  16 val_f1:  0.7828617791771808 val_auroc:  0.8712797619047619 val_auprc:  0.9256456976823711
Validation loss improved to 0.936942
epoch:  16
epoch:  17 val_f1:  0.8030193236714975 val_auroc:  0.8705357142857143 val_auprc:  0.9251102149865946
Validation loss improved to 0.930334
epoch:  17
epoch:  18 val_f1:  0.7134735367423068 val_auroc:  0.871279761904762 val_auprc:  0.9272973565295077
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.8154066640778435 val_auroc:  0.8715277777777778 val_auprc:  0.9261176231187069
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7973334973248877 val_auroc:  0.8722718253968254 val_auprc:  0.9277744146935114
Validation loss improved to 0.898123
epoch:  20
epoch:  21 val_f1:  0.6525109538254129 val_auroc:  0.871279761904762 val_auprc:  0.9283281504363221
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7884143290944841 val_auroc:  0.8720238095238095 val_auprc:  0.9277003864830503
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.8036760694501368 val_auroc:  0.8717757936507937 val_auprc:  0.9280479386632023
EarlyStopping counter: 3 out of 50
epoch:  23
epoch:  24 val_f1:  0.7842196249660383 val_auroc:  0.8740079365079365 val_auprc:  0.9293903640836483
Validation loss improved to 0.877739
epoch:  24
epoch:  25 val_f1:  0.8036150464093796 val_auroc:  0.8752480158730158 val_auprc:  0.930235259963307
Validation loss improved to 0.864254
epoch:  25
epoch:  26 val_f1:  0.8036150464093796 val_auroc:  0.8757440476190477 val_auprc:  0.9309272476603625
Validation loss improved to 0.858862
epoch:  26
epoch:  27 val_f1:  0.807228002894545 val_auroc:  0.8772321428571428 val_auprc:  0.9315990611952123
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.8138718358422335 val_auroc:  0.8764880952380952 val_auprc:  0.9323043013802974
EarlyStopping counter: 2 out of 50
epoch:  28
epoch:  29 val_f1:  0.804509509950907 val_auroc:  0.8754960317460317 val_auprc:  0.9320945979403181
Validation loss improved to 0.844958
epoch:  29
epoch:  30 val_f1:  0.7979659293160437 val_auroc:  0.8759920634920635 val_auprc:  0.9334198991554506
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7949078298424175 val_auroc:  0.8737599206349207 val_auprc:  0.9299955173412937
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.8164398044139025 val_auroc:  0.8740079365079365 val_auprc:  0.9319540937728205
EarlyStopping counter: 3 out of 50
epoch:  32
epoch:  33 val_f1:  0.8097298254042504 val_auroc:  0.8757440476190477 val_auprc:  0.9329101198734752
Validation loss improved to 0.839846
epoch:  33
epoch:  34 val_f1:  0.8164398044139025 val_auroc:  0.8764880952380952 val_auprc:  0.9335653364736769
Validation loss improved to 0.838050
epoch:  34
epoch:  35 val_f1:  0.8298676748582231 val_auroc:  0.8757440476190476 val_auprc:  0.9325303518178283
EarlyStopping counter: 1 out of 50
epoch:  35
epoch:  36 val_f1:  0.8298676748582231 val_auroc:  0.8750000000000001 val_auprc:  0.9321558131512704
EarlyStopping counter: 2 out of 50
epoch:  36
epoch:  37 val_f1:  0.8103538508923273 val_auroc:  0.8777281746031746 val_auprc:  0.9339286582884286
Validation loss improved to 0.827778
epoch:  37
epoch:  38 val_f1:  0.8041106719367591 val_auroc:  0.8787202380952381 val_auprc:  0.9352907188297408
Validation loss improved to 0.821530
epoch:  38
epoch:  39 val_f1:  0.7769308547872755 val_auroc:  0.8792162698412699 val_auprc:  0.9357024195635364
EarlyStopping counter: 1 out of 50
epoch:  39
epoch:  40 val_f1:  0.8036150464093796 val_auroc:  0.8774801587301587 val_auprc:  0.9347231279683463
Validation loss improved to 0.821281
epoch:  40
epoch:  41 val_f1:  0.7905411014849827 val_auroc:  0.875 val_auprc:  0.9316715424375159
EarlyStopping counter: 1 out of 50
epoch:  41
epoch:  42 val_f1:  0.8298676748582231 val_auroc:  0.8782242063492065 val_auprc:  0.9350448197925301
EarlyStopping counter: 2 out of 50
epoch:  42
epoch:  43 val_f1:  0.8231516182680737 val_auroc:  0.8762400793650794 val_auprc:  0.9337387532379128
EarlyStopping counter: 3 out of 50
epoch:  43
epoch:  44 val_f1:  0.8170893719806764 val_auroc:  0.8782242063492063 val_auprc:  0.935186266275475
EarlyStopping counter: 4 out of 50
epoch:  44
epoch:  45 val_f1:  0.8231516182680737 val_auroc:  0.875 val_auprc:  0.9328105760369709
EarlyStopping counter: 5 out of 50
epoch:  45
epoch:  46 val_f1:  0.8170893719806764 val_auroc:  0.8757440476190476 val_auprc:  0.933473289579586
EarlyStopping counter: 6 out of 50
epoch:  46
epoch:  47 val_f1:  0.8164398044139025 val_auroc:  0.876984126984127 val_auprc:  0.9336641651707098
EarlyStopping counter: 7 out of 50
epoch:  47
epoch:  48 val_f1:  0.8164398044139025 val_auroc:  0.8764880952380953 val_auprc:  0.9342614788359864
EarlyStopping counter: 8 out of 50
epoch:  48
epoch:  49 val_f1:  0.8156899810964081 val_auroc:  0.8779761904761905 val_auprc:  0.9339766280863795
EarlyStopping counter: 9 out of 50
epoch:  49
epoch:  50 val_f1:  0.7765822970867508 val_auroc:  0.8814484126984127 val_auprc:  0.9385038627297393
EarlyStopping counter: 10 out of 50
epoch:  50
epoch:  51 val_f1:  0.7765822970867508 val_auroc:  0.8809523809523809 val_auprc:  0.9382364922370383
EarlyStopping counter: 11 out of 50
epoch:  51
epoch:  52 val_f1:  0.8170893719806764 val_auroc:  0.8782242063492063 val_auprc:  0.9358404480211773
EarlyStopping counter: 12 out of 50
epoch:  52
epoch:  53 val_f1:  0.81483559295621 val_auroc:  0.8772321428571429 val_auprc:  0.9336615814056823
EarlyStopping counter: 13 out of 50
epoch:  53
epoch:  54 val_f1:  0.8088065661047027 val_auroc:  0.8762400793650794 val_auprc:  0.9324150012975088
EarlyStopping counter: 14 out of 50
epoch:  54
epoch:  55 val_f1:  0.8194319840387783 val_auroc:  0.8762400793650794 val_auprc:  0.9323198657035797
EarlyStopping counter: 15 out of 50
epoch:  55
epoch:  56 val_f1:  0.8061683443992288 val_auroc:  0.8792162698412699 val_auprc:  0.9347157242635078
EarlyStopping counter: 16 out of 50
epoch:  56
epoch:  57 val_f1:  0.8170893719806764 val_auroc:  0.8794642857142858 val_auprc:  0.9353563490125896
EarlyStopping counter: 17 out of 50
epoch:  57
epoch:  58 val_f1:  0.8170893719806764 val_auroc:  0.8804563492063493 val_auprc:  0.9369314903720227
EarlyStopping counter: 18 out of 50
epoch:  58
epoch:  59 val_f1:  0.8231516182680737 val_auroc:  0.8804563492063492 val_auprc:  0.9366842636332039
EarlyStopping counter: 19 out of 50
epoch:  59
epoch:  60 val_f1:  0.818640853509558 val_auroc:  0.8740079365079366 val_auprc:  0.9311656936445545
EarlyStopping counter: 20 out of 50
epoch:  60
epoch:  61 val_f1:  0.8154066640778435 val_auroc:  0.8759920634920635 val_auprc:  0.9317393369142286
EarlyStopping counter: 21 out of 50
epoch:  61
epoch:  62 val_f1:  0.8127933585226971 val_auroc:  0.8794642857142857 val_auprc:  0.9345162561685305
EarlyStopping counter: 22 out of 50
epoch:  62
epoch:  63 val_f1:  0.8090037477295196 val_auroc:  0.8799603174603176 val_auprc:  0.9360297526374306
EarlyStopping counter: 23 out of 50
epoch:  63
epoch:  64 val_f1:  0.8090037477295196 val_auroc:  0.880952380952381 val_auprc:  0.937308628875342
EarlyStopping counter: 24 out of 50
epoch:  64
epoch:  65 val_f1:  0.8156899810964081 val_auroc:  0.8807043650793651 val_auprc:  0.9373588612517487
EarlyStopping counter: 25 out of 50
epoch:  65
epoch:  66 val_f1:  0.8164398044139025 val_auroc:  0.8814484126984128 val_auprc:  0.9377739861280372
EarlyStopping counter: 26 out of 50
epoch:  66
epoch:  67 val_f1:  0.8156899810964081 val_auroc:  0.8807043650793651 val_auprc:  0.9367149624313686
EarlyStopping counter: 27 out of 50
epoch:  67
epoch:  68 val_f1:  0.8049865427618805 val_auroc:  0.8772321428571429 val_auprc:  0.9343590927685954
EarlyStopping counter: 28 out of 50
epoch:  68
epoch:  69 val_f1:  0.8127933585226971 val_auroc:  0.8787202380952381 val_auprc:  0.9351940666012506
EarlyStopping counter: 29 out of 50
epoch:  69
epoch:  70 val_f1:  0.8220330394243437 val_auroc:  0.876984126984127 val_auprc:  0.9336640550430728
EarlyStopping counter: 30 out of 50
epoch:  70
epoch:  71 val_f1:  0.8127933585226971 val_auroc:  0.8764880952380953 val_auprc:  0.9335768765510187
EarlyStopping counter: 31 out of 50
epoch:  71
epoch:  72 val_f1:  0.8138718358422335 val_auroc:  0.8797123015873016 val_auprc:  0.9352468044446688
EarlyStopping counter: 32 out of 50
epoch:  72
epoch:  73 val_f1:  0.8090037477295196 val_auroc:  0.8804563492063493 val_auprc:  0.9364825037077271
EarlyStopping counter: 33 out of 50
epoch:  73
epoch:  74 val_f1:  0.8090037477295196 val_auroc:  0.8802083333333333 val_auprc:  0.9371858434581236
EarlyStopping counter: 34 out of 50
epoch:  74
epoch:  75 val_f1:  0.8015122873345937 val_auroc:  0.8784722222222222 val_auprc:  0.9353485836470964
EarlyStopping counter: 35 out of 50
epoch:  75
epoch:  76 val_f1:  0.8205262448141007 val_auroc:  0.8792162698412699 val_auprc:  0.9350678902511866
EarlyStopping counter: 36 out of 50
epoch:  76
epoch:  77 val_f1:  0.8127933585226971 val_auroc:  0.8784722222222222 val_auprc:  0.9343650727112947
EarlyStopping counter: 37 out of 50
epoch:  77
epoch:  78 val_f1:  0.8138718358422335 val_auroc:  0.8784722222222222 val_auprc:  0.9346260550144141
EarlyStopping counter: 38 out of 50
epoch:  78
epoch:  79 val_f1:  0.8138718358422335 val_auroc:  0.8794642857142857 val_auprc:  0.9349202793485074
EarlyStopping counter: 39 out of 50
epoch:  79
epoch:  80 val_f1:  0.8127933585226971 val_auroc:  0.8797123015873016 val_auprc:  0.9350796304886702
EarlyStopping counter: 40 out of 50
epoch:  80
epoch:  81 val_f1:  0.8127933585226971 val_auroc:  0.8784722222222222 val_auprc:  0.9342730430224144
EarlyStopping counter: 41 out of 50
epoch:  81
epoch:  82 val_f1:  0.8127933585226971 val_auroc:  0.8777281746031746 val_auprc:  0.9340069349867696
EarlyStopping counter: 42 out of 50
epoch:  82
epoch:  83 val_f1:  0.8205262448141007 val_auroc:  0.8807043650793651 val_auprc:  0.9357866913638959
EarlyStopping counter: 43 out of 50
epoch:  83
epoch:  84 val_f1:  0.8127933585226971 val_auroc:  0.8797123015873016 val_auprc:  0.9352901371914629
EarlyStopping counter: 44 out of 50
epoch:  84
epoch:  85 val_f1:  0.8138718358422335 val_auroc:  0.8809523809523809 val_auprc:  0.935899525165392
EarlyStopping counter: 45 out of 50
epoch:  85
epoch:  86 val_f1:  0.807228002894545 val_auroc:  0.8802083333333334 val_auprc:  0.9358074289446452
EarlyStopping counter: 46 out of 50
epoch:  86
epoch:  87 val_f1:  0.8061683443992288 val_auroc:  0.8797123015873015 val_auprc:  0.9353353222199233
EarlyStopping counter: 47 out of 50
epoch:  87
epoch:  88 val_f1:  0.8127933585226971 val_auroc:  0.878720238095238 val_auprc:  0.9346476661280921
EarlyStopping counter: 48 out of 50
epoch:  88
epoch:  89 val_f1:  0.8138718358422335 val_auroc:  0.8814484126984127 val_auprc:  0.9363975519662304
EarlyStopping counter: 49 out of 50
epoch:  89
epoch:  90 val_f1:  0.81483559295621 val_auroc:  0.880952380952381 val_auprc:  0.9363334866084199
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  247.22217416763306
{'time_elapsed': [247.22217416763306], 'epoch': [89], 'fold': [4], 'f1_train': [0.9910435040867359], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.81483559295621], 'auroc_test': [0.880952380952381], 'auprc_test': [0.9363334866084199]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 183]           8,192
│    └─BatchNorm1d: 2-2                  [64, 1024, 183]           2,048
│    └─Tanh: 2-3                         [64, 1024, 183]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 26]            --
│    └─Dropout: 2-5                      [64, 1024, 26]            --
│    └─Flatten: 2-6                      [64, 26624]               --
│    └─Linear: 2-7                       [64, 1]                   26,625
==========================================================================================
Total params: 36,865
Trainable params: 36,865
Non-trainable params: 0
Total mult-adds (M): 97.78
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 191.89
Params size (MB): 0.15
Estimated Total Size (MB): 192.37
==========================================================================================
