config:  {'project': 'MHCCBM', 'name': 'CNN_28', 'config': {'hidden_channels': [512], 'epochs': 500, 'kernel_size': 3, 'pool_kernel_size': 3, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5927046616930108 val_auroc:  0.6512027491408935 val_auprc:  0.817259264443551
epoch:  1
epoch:  2 val_f1:  0.5353968800011966 val_auroc:  0.5493372606774669 val_auprc:  0.7409670645720596
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.5154478112425315 val_auroc:  0.5254050073637703 val_auprc:  0.7345965230027304
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5980249120325295 val_auroc:  0.5028227785959745 val_auprc:  0.7293873097074524
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.4967815221507004 val_auroc:  0.538046146293569 val_auprc:  0.7331688083746168
Validation loss improved to 4.848835
epoch:  5
epoch:  6 val_f1:  0.30761741725380454 val_auroc:  0.625920471281296 val_auprc:  0.7948116847785478
Validation loss improved to 3.204915
epoch:  6
epoch:  7 val_f1:  0.6262616863622784 val_auroc:  0.7117083946980854 val_auprc:  0.8672227689993173
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.693339873555701 val_auroc:  0.7472999509081983 val_auprc:  0.8771577203106977
Validation loss improved to 2.217338
epoch:  8
epoch:  9 val_f1:  0.6276318729626881 val_auroc:  0.7594501718213058 val_auprc:  0.8866718523233308
Validation loss improved to 1.973631
epoch:  9
epoch:  10 val_f1:  0.6590199752078746 val_auroc:  0.7781050564555719 val_auprc:  0.9018113651236175
Validation loss improved to 1.754772
epoch:  10
epoch:  11 val_f1:  0.6945501576267077 val_auroc:  0.7761413843888071 val_auprc:  0.9004981961930336
Validation loss improved to 1.611717
epoch:  11
epoch:  12 val_f1:  0.7473302173830908 val_auroc:  0.7740549828178694 val_auprc:  0.8991033645238233
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.6963686193902022 val_auroc:  0.7778595974472263 val_auprc:  0.8981831818062949
Validation loss improved to 1.515781
epoch:  13
epoch:  14 val_f1:  0.5881399358125439 val_auroc:  0.7800687285223368 val_auprc:  0.898291938585073
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.7185321510233673 val_auroc:  0.7853460972017674 val_auprc:  0.9027448259342274
EarlyStopping counter: 2 out of 50
epoch:  15
epoch:  16 val_f1:  0.6802976282278086 val_auroc:  0.7849779086892489 val_auprc:  0.898989548709406
Validation loss improved to 1.491776
epoch:  16
epoch:  17 val_f1:  0.6353297362110312 val_auroc:  0.7879234167893961 val_auprc:  0.901733442342796
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.7496568898727172 val_auroc:  0.7957781050564556 val_auprc:  0.9076142822292569
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7496568898727172 val_auroc:  0.7950417280314187 val_auprc:  0.9074375617257652
Validation loss improved to 1.449642
epoch:  19
epoch:  20 val_f1:  0.6954243384953055 val_auroc:  0.7918507609229258 val_auprc:  0.9039684846532823
Validation loss improved to 1.353138
epoch:  20
epoch:  21 val_f1:  0.7455074238481555 val_auroc:  0.7901325478645066 val_auprc:  0.9006676529204348
Validation loss improved to 1.338937
epoch:  21
epoch:  22 val_f1:  0.7552115339652351 val_auroc:  0.7997054491899853 val_auprc:  0.9092800519291226
Validation loss improved to 1.158298
epoch:  22
epoch:  23 val_f1:  0.7304528631430115 val_auroc:  0.7979872361315661 val_auprc:  0.9078591114884651
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.642965963048511 val_auroc:  0.7923416789396172 val_auprc:  0.9042773748551107
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.667134140788635 val_auroc:  0.7763868433971528 val_auprc:  0.8911852147882877
EarlyStopping counter: 3 out of 50
epoch:  25
epoch:  26 val_f1:  0.7308479257525525 val_auroc:  0.79553264604811 val_auprc:  0.9062086435940143
Validation loss improved to 1.018050
epoch:  26
epoch:  27 val_f1:  0.7536606851900262 val_auroc:  0.8068237604320079 val_auprc:  0.9159916407242992
Validation loss improved to 0.838268
epoch:  27
epoch:  28 val_f1:  0.758098723333472 val_auroc:  0.7972508591065292 val_auprc:  0.9047905516722906
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.7513203127712835 val_auroc:  0.7955326460481099 val_auprc:  0.9030596369482805
EarlyStopping counter: 2 out of 50
epoch:  29
epoch:  30 val_f1:  0.7170655771870609 val_auroc:  0.8026509572901326 val_auprc:  0.9130801178798001
EarlyStopping counter: 3 out of 50
epoch:  30
epoch:  31 val_f1:  0.7598715939807772 val_auroc:  0.7992145311732941 val_auprc:  0.9079770802954656
EarlyStopping counter: 4 out of 50
epoch:  31
epoch:  32 val_f1:  0.6759950757759244 val_auroc:  0.7952871870397644 val_auprc:  0.9044793438113495
EarlyStopping counter: 5 out of 50
epoch:  32
epoch:  33 val_f1:  0.6882360925909661 val_auroc:  0.8019145802650958 val_auprc:  0.9062294757255611
EarlyStopping counter: 6 out of 50
epoch:  33
epoch:  34 val_f1:  0.5109648663605497 val_auroc:  0.822287677957781 val_auprc:  0.9199292226461098
EarlyStopping counter: 7 out of 50
epoch:  34
epoch:  35 val_f1:  0.6794627975876525 val_auroc:  0.8242513500245459 val_auprc:  0.9219385618376913
EarlyStopping counter: 8 out of 50
epoch:  35
epoch:  36 val_f1:  0.7648187281552264 val_auroc:  0.819833087874325 val_auprc:  0.9173253413979285
EarlyStopping counter: 9 out of 50
epoch:  36
epoch:  37 val_f1:  0.7697841726618705 val_auroc:  0.8097692685321551 val_auprc:  0.9090180153958963
EarlyStopping counter: 10 out of 50
epoch:  37
epoch:  38 val_f1:  0.7873856121514594 val_auroc:  0.8041237113402062 val_auprc:  0.9085089477758805
EarlyStopping counter: 11 out of 50
epoch:  38
epoch:  39 val_f1:  0.7841726618705036 val_auroc:  0.8085419734904271 val_auprc:  0.9115095774055452
EarlyStopping counter: 12 out of 50
epoch:  39
epoch:  40 val_f1:  0.7777125328082551 val_auroc:  0.8075601374570447 val_auprc:  0.9097152151915747
EarlyStopping counter: 13 out of 50
epoch:  40
epoch:  41 val_f1:  0.6358450082039632 val_auroc:  0.8152920962199313 val_auprc:  0.9199417217304564
EarlyStopping counter: 14 out of 50
epoch:  41
epoch:  42 val_f1:  0.7024482739389885 val_auroc:  0.8080510554737359 val_auprc:  0.9039525024293688
EarlyStopping counter: 15 out of 50
epoch:  42
epoch:  43 val_f1:  0.7377728985642654 val_auroc:  0.8102601865488464 val_auprc:  0.9079237054588142
EarlyStopping counter: 16 out of 50
epoch:  43
epoch:  44 val_f1:  0.7542604103291037 val_auroc:  0.8154148257241041 val_auprc:  0.9146531532537385
EarlyStopping counter: 17 out of 50
epoch:  44
epoch:  45 val_f1:  0.7661184054361647 val_auroc:  0.8122238586156111 val_auprc:  0.9135222173428135
EarlyStopping counter: 18 out of 50
epoch:  45
epoch:  46 val_f1:  0.7737843767539161 val_auroc:  0.806087383406971 val_auprc:  0.9087139659702139
EarlyStopping counter: 19 out of 50
epoch:  46
epoch:  47 val_f1:  0.7985611510791367 val_auroc:  0.803632793323515 val_auprc:  0.9062128603968372
EarlyStopping counter: 20 out of 50
epoch:  47
epoch:  48 val_f1:  0.7428255465713769 val_auroc:  0.8048600883652431 val_auprc:  0.9068313500382715
EarlyStopping counter: 21 out of 50
epoch:  48
epoch:  49 val_f1:  0.7826417810500232 val_auroc:  0.8114874815905744 val_auprc:  0.9118026028651861
EarlyStopping counter: 22 out of 50
epoch:  49
epoch:  50 val_f1:  0.766354189375772 val_auroc:  0.8122238586156112 val_auprc:  0.9107197471536984
EarlyStopping counter: 23 out of 50
epoch:  50
epoch:  51 val_f1:  0.7577565132360132 val_auroc:  0.8109965635738832 val_auprc:  0.910042115446894
EarlyStopping counter: 24 out of 50
epoch:  51
epoch:  52 val_f1:  0.6276318729626881 val_auroc:  0.8154148257241041 val_auprc:  0.9158316398238843
EarlyStopping counter: 25 out of 50
epoch:  52
epoch:  53 val_f1:  0.7648576099332736 val_auroc:  0.8176239567992145 val_auprc:  0.9133260145795142
EarlyStopping counter: 26 out of 50
epoch:  53
epoch:  54 val_f1:  0.7727225509205256 val_auroc:  0.8124693176239568 val_auprc:  0.9107482533090564
EarlyStopping counter: 27 out of 50
epoch:  54
epoch:  55 val_f1:  0.7762067639678805 val_auroc:  0.8156602847324496 val_auprc:  0.9121336825298414
EarlyStopping counter: 28 out of 50
epoch:  55
epoch:  56 val_f1:  0.7515743249556199 val_auroc:  0.8144329896907218 val_auprc:  0.9119085327411828
EarlyStopping counter: 29 out of 50
epoch:  56
epoch:  57 val_f1:  0.7583800901862243 val_auroc:  0.8139420716740304 val_auprc:  0.9113079516397825
EarlyStopping counter: 30 out of 50
epoch:  57
epoch:  58 val_f1:  0.7536081085870222 val_auroc:  0.8166421207658321 val_auprc:  0.9133370886240739
EarlyStopping counter: 31 out of 50
epoch:  58
epoch:  59 val_f1:  0.7762067639678805 val_auroc:  0.8154148257241041 val_auprc:  0.913614516308636
EarlyStopping counter: 32 out of 50
epoch:  59
epoch:  60 val_f1:  0.76000113614692 val_auroc:  0.8156602847324497 val_auprc:  0.9119945472253941
EarlyStopping counter: 33 out of 50
epoch:  60
epoch:  61 val_f1:  0.7725930260576229 val_auroc:  0.8181148748159058 val_auprc:  0.9161907533799228
EarlyStopping counter: 34 out of 50
epoch:  61
epoch:  62 val_f1:  0.7911956149366222 val_auroc:  0.816151202749141 val_auprc:  0.9128248668804857
EarlyStopping counter: 35 out of 50
epoch:  62
epoch:  63 val_f1:  0.7762067639678805 val_auroc:  0.8159057437407953 val_auprc:  0.9122860731497895
EarlyStopping counter: 36 out of 50
epoch:  63
epoch:  64 val_f1:  0.7841726618705036 val_auroc:  0.8190967108492883 val_auprc:  0.9141796470954227
EarlyStopping counter: 37 out of 50
epoch:  64
epoch:  65 val_f1:  0.7681512331200245 val_auroc:  0.8183603338242513 val_auprc:  0.913993020419639
EarlyStopping counter: 38 out of 50
epoch:  65
epoch:  66 val_f1:  0.76000113614692 val_auroc:  0.817378497790869 val_auprc:  0.9130157473856084
EarlyStopping counter: 39 out of 50
epoch:  66
epoch:  67 val_f1:  0.7944676896257205 val_auroc:  0.8195876288659794 val_auprc:  0.9153117948578016
EarlyStopping counter: 40 out of 50
epoch:  67
epoch:  68 val_f1:  0.7445203699313053 val_auroc:  0.8195876288659794 val_auprc:  0.9171176706575334
EarlyStopping counter: 41 out of 50
epoch:  68
epoch:  69 val_f1:  0.7238240177089098 val_auroc:  0.8117329405989201 val_auprc:  0.9113642776537207
EarlyStopping counter: 42 out of 50
epoch:  69
epoch:  70 val_f1:  0.7772753225990636 val_auroc:  0.8173784977908689 val_auprc:  0.9156841994661018
EarlyStopping counter: 43 out of 50
epoch:  70
epoch:  71 val_f1:  0.7944676896257205 val_auroc:  0.821060382916053 val_auprc:  0.9188340882602608
EarlyStopping counter: 44 out of 50
epoch:  71
epoch:  72 val_f1:  0.7707245329923307 val_auroc:  0.8200785468826706 val_auprc:  0.9147213116832509
EarlyStopping counter: 45 out of 50
epoch:  72
epoch:  73 val_f1:  0.7813819697019021 val_auroc:  0.8190967108492881 val_auprc:  0.9147856916978411
EarlyStopping counter: 46 out of 50
epoch:  73
epoch:  74 val_f1:  0.766354189375772 val_auroc:  0.8232695139911635 val_auprc:  0.9169852245630885
EarlyStopping counter: 47 out of 50
epoch:  74
epoch:  75 val_f1:  0.7648576099332736 val_auroc:  0.8257241040746196 val_auprc:  0.9202848937914889
EarlyStopping counter: 48 out of 50
epoch:  75
epoch:  76 val_f1:  0.7681512331200245 val_auroc:  0.8183603338242513 val_auprc:  0.9158839613078148
EarlyStopping counter: 49 out of 50
epoch:  76
epoch:  77 val_f1:  0.7841726618705036 val_auroc:  0.8181148748159057 val_auprc:  0.9132472693684468
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1054.9249670505524
{'time_elapsed': [1054.9249670505524], 'epoch': [76], 'fold': [0], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7841726618705036], 'auroc_test': [0.8181148748159057], 'auprc_test': [0.9132472693684468]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1280]           2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 1280]           1,024
│    └─Tanh: 2-3                         [64, 512, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1278]           --
│    └─Dropout: 2-5                      [64, 512, 1278]           --
│    └─Flatten: 2-6                      [64, 654336]              --
│    └─Linear: 2-7                       [64, 1]                   654,337
==========================================================================================
Total params: 657,409
Trainable params: 657,409
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 671.09
Params size (MB): 2.63
Estimated Total Size (MB): 674.05
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.6958762886597938 val_auprc:  0.8529557284414568
epoch:  1
epoch:  2 val_f1:  0.7272357092755477 val_auroc:  0.7336769759450172 val_auprc:  0.8577003990477593
Validation loss improved to 1.050666
epoch:  2
epoch:  3 val_f1:  0.5585611957708255 val_auroc:  0.792341678939617 val_auprc:  0.901801225396361
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.7513203127712835 val_auroc:  0.8252331860579283 val_auprc:  0.9270232559869307
EarlyStopping counter: 2 out of 50
epoch:  4
epoch:  5 val_f1:  0.7560320485424044 val_auroc:  0.8176239567992145 val_auprc:  0.9240448752828421
Validation loss improved to 0.691265
epoch:  5
epoch:  6 val_f1:  0.7237424247793883 val_auroc:  0.8089101620029455 val_auprc:  0.9153876838511311
Validation loss improved to 0.385221
epoch:  6
epoch:  7 val_f1:  0.7375047745919104 val_auroc:  0.8053510063819341 val_auprc:  0.9113161213280043
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.681579990245092 val_auroc:  0.8053510063819342 val_auprc:  0.9074861680256922
EarlyStopping counter: 2 out of 50
epoch:  8
epoch:  9 val_f1:  0.687028943170779 val_auroc:  0.8025282277859598 val_auprc:  0.9063553616689969
EarlyStopping counter: 3 out of 50
epoch:  9
epoch:  10 val_f1:  0.6176372586141613 val_auroc:  0.807437407952872 val_auprc:  0.9074310485715649
EarlyStopping counter: 4 out of 50
epoch:  10
epoch:  11 val_f1:  0.6963686193902022 val_auroc:  0.8046146293568974 val_auprc:  0.9031454536930541
EarlyStopping counter: 5 out of 50
epoch:  11
epoch:  12 val_f1:  0.681579990245092 val_auroc:  0.8163966617574865 val_auprc:  0.9076821443425904
EarlyStopping counter: 6 out of 50
epoch:  12
epoch:  13 val_f1:  0.8020613296596766 val_auroc:  0.819833087874325 val_auprc:  0.9164018059387637
Validation loss improved to 0.354517
epoch:  13
epoch:  14 val_f1:  0.7737843767539161 val_auroc:  0.8230240549828178 val_auprc:  0.9201139899215591
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.7841726618705036 val_auroc:  0.8267059401080019 val_auprc:  0.9178943346234756
Validation loss improved to 0.293336
epoch:  15
epoch:  16 val_f1:  0.7954863587533922 val_auroc:  0.8249877270495827 val_auprc:  0.9160652835509936
Validation loss improved to 0.270404
epoch:  16
epoch:  17 val_f1:  0.743431836172277 val_auroc:  0.8190967108492883 val_auprc:  0.9111123031145886
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.7140753816830194 val_auroc:  0.8171330387825233 val_auprc:  0.9085801818756609
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7920536597238516 val_auroc:  0.8136966126656848 val_auprc:  0.9069399604753987
EarlyStopping counter: 3 out of 50
epoch:  19
epoch:  20 val_f1:  0.7583300796647482 val_auroc:  0.8330878743249878 val_auprc:  0.9181727982400847
EarlyStopping counter: 4 out of 50
epoch:  20
epoch:  21 val_f1:  0.7483101088021195 val_auroc:  0.8291605301914581 val_auprc:  0.9163134813773719
EarlyStopping counter: 5 out of 50
epoch:  21
epoch:  22 val_f1:  0.7879228532067962 val_auroc:  0.8159057437407953 val_auprc:  0.9074204923837129
EarlyStopping counter: 6 out of 50
epoch:  22
epoch:  23 val_f1:  0.8036372932111164 val_auroc:  0.8186057928325969 val_auprc:  0.899440025222894
Validation loss improved to 0.221698
epoch:  23
epoch:  24 val_f1:  0.7082463061808618 val_auroc:  0.8187285223367697 val_auprc:  0.8964960259474317
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.770628190185282 val_auroc:  0.8127147766323024 val_auprc:  0.8980497217329959
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.7661589271850144 val_auroc:  0.8279332351497299 val_auprc:  0.9026703692403605
Validation loss improved to 0.174877
epoch:  26
epoch:  27 val_f1:  0.8101627788678148 val_auroc:  0.8235149729995092 val_auprc:  0.9042225906887629
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7770871369605723 val_auroc:  0.829160530191458 val_auprc:  0.9063141762766705
Validation loss improved to 0.158583
epoch:  28
epoch:  29 val_f1:  0.7971323289800215 val_auroc:  0.8264604810996564 val_auprc:  0.8960740649787109
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.7770871369605723 val_auroc:  0.8215513009327442 val_auprc:  0.8966932492747889
EarlyStopping counter: 2 out of 50
epoch:  30
epoch:  31 val_f1:  0.7826417810500232 val_auroc:  0.8249877270495828 val_auprc:  0.8971812595134453
EarlyStopping counter: 3 out of 50
epoch:  31
epoch:  32 val_f1:  0.7855164986057286 val_auroc:  0.821674030436917 val_auprc:  0.895335962447694
EarlyStopping counter: 4 out of 50
epoch:  32
epoch:  33 val_f1:  0.7938350857775318 val_auroc:  0.8225331369661267 val_auprc:  0.8940246543923563
Validation loss improved to 0.158360
epoch:  33
epoch:  34 val_f1:  0.7770871369605723 val_auroc:  0.8289150711831125 val_auprc:  0.897362441893979
Validation loss improved to 0.150889
epoch:  34
epoch:  35 val_f1:  0.7841726618705036 val_auroc:  0.8269513991163475 val_auprc:  0.897323291652949
EarlyStopping counter: 1 out of 50
epoch:  35
epoch:  36 val_f1:  0.7698533480907581 val_auroc:  0.8251104565537556 val_auprc:  0.8928913060706163
Validation loss improved to 0.122743
epoch:  36
epoch:  37 val_f1:  0.7770871369605723 val_auroc:  0.8257241040746196 val_auprc:  0.8957582144821037
EarlyStopping counter: 1 out of 50
epoch:  37
epoch:  38 val_f1:  0.7938350857775318 val_auroc:  0.8262150220913107 val_auprc:  0.8986655107873197
EarlyStopping counter: 2 out of 50
epoch:  38
epoch:  39 val_f1:  0.7510724063582411 val_auroc:  0.8252331860579284 val_auprc:  0.8976654456281199
EarlyStopping counter: 3 out of 50
epoch:  39
epoch:  40 val_f1:  0.7938350857775318 val_auroc:  0.8259695630829652 val_auprc:  0.8920982426575101
EarlyStopping counter: 4 out of 50
epoch:  40
epoch:  41 val_f1:  0.7770871369605723 val_auroc:  0.8195876288659794 val_auprc:  0.8944202150446566
EarlyStopping counter: 5 out of 50
epoch:  41
epoch:  42 val_f1:  0.7745465218349855 val_auroc:  0.8294059891998036 val_auprc:  0.9006709334082613
EarlyStopping counter: 6 out of 50
epoch:  42
epoch:  43 val_f1:  0.7598715939807772 val_auroc:  0.8257241040746195 val_auprc:  0.8963157236226109
EarlyStopping counter: 7 out of 50
epoch:  43
epoch:  44 val_f1:  0.7770871369605723 val_auroc:  0.8241286205203732 val_auprc:  0.8938353910701702
EarlyStopping counter: 8 out of 50
epoch:  44
epoch:  45 val_f1:  0.7938350857775318 val_auroc:  0.823514972999509 val_auprc:  0.8953236776101374
EarlyStopping counter: 9 out of 50
epoch:  45
epoch:  46 val_f1:  0.7745465218349855 val_auroc:  0.8284241531664213 val_auprc:  0.8951987592596506
EarlyStopping counter: 10 out of 50
epoch:  46
epoch:  47 val_f1:  0.7873856121514594 val_auroc:  0.8284241531664212 val_auprc:  0.8955702562642305
EarlyStopping counter: 11 out of 50
epoch:  47
epoch:  48 val_f1:  0.7855164986057286 val_auroc:  0.8246195385370643 val_auprc:  0.8941790435350331
Validation loss improved to 0.113975
epoch:  48
epoch:  49 val_f1:  0.7938350857775318 val_auroc:  0.8271968581246932 val_auprc:  0.8934525581455136
EarlyStopping counter: 1 out of 50
epoch:  49
epoch:  50 val_f1:  0.7770871369605723 val_auroc:  0.8232695139911635 val_auprc:  0.8904987452643335
EarlyStopping counter: 2 out of 50
epoch:  50
epoch:  51 val_f1:  0.7938350857775318 val_auroc:  0.8262150220913107 val_auprc:  0.8924724391723984
EarlyStopping counter: 3 out of 50
epoch:  51
epoch:  52 val_f1:  0.7681512331200245 val_auroc:  0.8264604810996563 val_auprc:  0.8936245271147392
EarlyStopping counter: 4 out of 50
epoch:  52
epoch:  53 val_f1:  0.7697841726618705 val_auroc:  0.8294059891998036 val_auprc:  0.8985362746988121
EarlyStopping counter: 5 out of 50
epoch:  53
epoch:  54 val_f1:  0.7809570525397864 val_auroc:  0.8294059891998036 val_auprc:  0.9008146874984553
EarlyStopping counter: 6 out of 50
epoch:  54
epoch:  55 val_f1:  0.7685409504908388 val_auroc:  0.8249877270495828 val_auprc:  0.8963663471436052
EarlyStopping counter: 7 out of 50
epoch:  55
epoch:  56 val_f1:  0.7685409504908388 val_auroc:  0.8275650466372115 val_auprc:  0.8977551229893026
Validation loss improved to 0.097527
epoch:  56
epoch:  57 val_f1:  0.7938350857775318 val_auroc:  0.8247422680412371 val_auprc:  0.896150663579463
EarlyStopping counter: 1 out of 50
epoch:  57
epoch:  58 val_f1:  0.7873856121514594 val_auroc:  0.825478645066274 val_auprc:  0.8933887379202027
EarlyStopping counter: 2 out of 50
epoch:  58
epoch:  59 val_f1:  0.7873856121514594 val_auroc:  0.8301423662248405 val_auprc:  0.8963738862071062
EarlyStopping counter: 3 out of 50
epoch:  59
epoch:  60 val_f1:  0.7938350857775318 val_auroc:  0.8264604810996564 val_auprc:  0.8902111140194807
EarlyStopping counter: 4 out of 50
epoch:  60
epoch:  61 val_f1:  0.7598715939807772 val_auroc:  0.823514972999509 val_auprc:  0.8914051576730566
EarlyStopping counter: 5 out of 50
epoch:  61
epoch:  62 val_f1:  0.7938350857775318 val_auroc:  0.8226558664702994 val_auprc:  0.8894018297482553
EarlyStopping counter: 6 out of 50
epoch:  62
epoch:  63 val_f1:  0.7855164986057286 val_auroc:  0.8260922925871379 val_auprc:  0.892017333650387
EarlyStopping counter: 7 out of 50
epoch:  63
epoch:  64 val_f1:  0.7685409504908388 val_auroc:  0.823514972999509 val_auprc:  0.8929589723472954
EarlyStopping counter: 8 out of 50
epoch:  64
epoch:  65 val_f1:  0.7855164986057286 val_auroc:  0.8258468335787923 val_auprc:  0.8914132964485139
EarlyStopping counter: 9 out of 50
epoch:  65
epoch:  66 val_f1:  0.7938350857775318 val_auroc:  0.8248649975454099 val_auprc:  0.8909369395005093
EarlyStopping counter: 10 out of 50
epoch:  66
epoch:  67 val_f1:  0.7938350857775318 val_auroc:  0.8257241040746196 val_auprc:  0.891825441762423
EarlyStopping counter: 11 out of 50
epoch:  67
epoch:  68 val_f1:  0.7873856121514594 val_auroc:  0.826092292587138 val_auprc:  0.8920217186725157
EarlyStopping counter: 12 out of 50
epoch:  68
epoch:  69 val_f1:  0.7855164986057286 val_auroc:  0.8290378006872853 val_auprc:  0.8925730079723376
EarlyStopping counter: 13 out of 50
epoch:  69
epoch:  70 val_f1:  0.7938350857775318 val_auroc:  0.825478645066274 val_auprc:  0.8931005729946806
EarlyStopping counter: 14 out of 50
epoch:  70
epoch:  71 val_f1:  0.7770871369605723 val_auroc:  0.8273195876288659 val_auprc:  0.8956955366108446
Validation loss improved to 0.095288
epoch:  71
epoch:  72 val_f1:  0.7938350857775318 val_auroc:  0.8260922925871379 val_auprc:  0.8957081390949867
EarlyStopping counter: 1 out of 50
epoch:  72
epoch:  73 val_f1:  0.7938350857775318 val_auroc:  0.8269513991163476 val_auprc:  0.8937178441175953
EarlyStopping counter: 2 out of 50
epoch:  73
epoch:  74 val_f1:  0.7938350857775318 val_auroc:  0.8262150220913108 val_auprc:  0.8934802378670759
EarlyStopping counter: 3 out of 50
epoch:  74
epoch:  75 val_f1:  0.7938350857775318 val_auroc:  0.8271968581246932 val_auprc:  0.8946934621549315
EarlyStopping counter: 4 out of 50
epoch:  75
epoch:  76 val_f1:  0.7873856121514594 val_auroc:  0.8268286696121748 val_auprc:  0.8918638677831936
EarlyStopping counter: 5 out of 50
epoch:  76
epoch:  77 val_f1:  0.7873856121514594 val_auroc:  0.8252331860579283 val_auprc:  0.8939801849856694
EarlyStopping counter: 6 out of 50
epoch:  77
epoch:  78 val_f1:  0.7938350857775318 val_auroc:  0.8241286205203732 val_auprc:  0.8945112806039286
EarlyStopping counter: 7 out of 50
epoch:  78
epoch:  79 val_f1:  0.7938350857775318 val_auroc:  0.8265832106038292 val_auprc:  0.8958494777897199
EarlyStopping counter: 8 out of 50
epoch:  79
epoch:  80 val_f1:  0.7873856121514594 val_auroc:  0.8267059401080019 val_auprc:  0.897304518855793
EarlyStopping counter: 9 out of 50
epoch:  80
epoch:  81 val_f1:  0.7873856121514594 val_auroc:  0.8259695630829652 val_auprc:  0.8978005573777286
EarlyStopping counter: 10 out of 50
epoch:  81
epoch:  82 val_f1:  0.7938350857775318 val_auroc:  0.8259695630829651 val_auprc:  0.8972138762909098
EarlyStopping counter: 11 out of 50
epoch:  82
epoch:  83 val_f1:  0.7748796193569787 val_auroc:  0.825478645066274 val_auprc:  0.8986899748261448
Validation loss improved to 0.088032
epoch:  83
epoch:  84 val_f1:  0.757304835743056 val_auroc:  0.8249877270495827 val_auprc:  0.9004265532720711
Validation loss improved to 0.078805
epoch:  84
epoch:  85 val_f1:  0.7851964582180411 val_auroc:  0.8268286696121747 val_auprc:  0.899209135289885
Validation loss improved to 0.072998
epoch:  85
epoch:  86 val_f1:  0.7855164986057286 val_auroc:  0.8265832106038291 val_auprc:  0.8986688903479823
EarlyStopping counter: 1 out of 50
epoch:  86
epoch:  87 val_f1:  0.7809570525397864 val_auroc:  0.8301423662248405 val_auprc:  0.8996389186616488
EarlyStopping counter: 2 out of 50
epoch:  87
epoch:  88 val_f1:  0.7873856121514594 val_auroc:  0.825478645066274 val_auprc:  0.8972748035673475
EarlyStopping counter: 3 out of 50
epoch:  88
epoch:  89 val_f1:  0.7938350857775318 val_auroc:  0.8262150220913107 val_auprc:  0.8994765401880034
EarlyStopping counter: 4 out of 50
epoch:  89
epoch:  90 val_f1:  0.7938350857775318 val_auroc:  0.8253559155621011 val_auprc:  0.8984506369063668
EarlyStopping counter: 5 out of 50
epoch:  90
epoch:  91 val_f1:  0.7938350857775318 val_auroc:  0.8276877761413844 val_auprc:  0.9001373188482422
EarlyStopping counter: 6 out of 50
epoch:  91
epoch:  92 val_f1:  0.7938350857775318 val_auroc:  0.827319587628866 val_auprc:  0.8997490376494788
EarlyStopping counter: 7 out of 50
epoch:  92
epoch:  93 val_f1:  0.7855164986057286 val_auroc:  0.8264604810996563 val_auprc:  0.9006820738740972
EarlyStopping counter: 8 out of 50
epoch:  93
epoch:  94 val_f1:  0.7938350857775318 val_auroc:  0.8268286696121747 val_auprc:  0.9006139813134962
EarlyStopping counter: 9 out of 50
epoch:  94
epoch:  95 val_f1:  0.7938350857775318 val_auroc:  0.8270741286205203 val_auprc:  0.9000462996232677
EarlyStopping counter: 10 out of 50
epoch:  95
epoch:  96 val_f1:  0.7938350857775318 val_auroc:  0.8258468335787924 val_auprc:  0.9000616564405803
EarlyStopping counter: 11 out of 50
epoch:  96
epoch:  97 val_f1:  0.7770871369605723 val_auroc:  0.8267059401080019 val_auprc:  0.9016454486970371
EarlyStopping counter: 12 out of 50
epoch:  97
epoch:  98 val_f1:  0.7873856121514594 val_auroc:  0.8283014236622485 val_auprc:  0.9018964469136922
EarlyStopping counter: 13 out of 50
epoch:  98
epoch:  99 val_f1:  0.7938350857775318 val_auroc:  0.82793323514973 val_auprc:  0.900853713115208
EarlyStopping counter: 14 out of 50
epoch:  99
epoch:  100 val_f1:  0.7685409504908388 val_auroc:  0.8273195876288659 val_auprc:  0.9025247561794736
EarlyStopping counter: 15 out of 50
epoch:  100
epoch:  101 val_f1:  0.7770871369605723 val_auroc:  0.8264604810996564 val_auprc:  0.9018563015717621
EarlyStopping counter: 16 out of 50
epoch:  101
epoch:  102 val_f1:  0.7873856121514594 val_auroc:  0.8267059401080019 val_auprc:  0.9006070020843125
EarlyStopping counter: 17 out of 50
epoch:  102
epoch:  103 val_f1:  0.7938350857775318 val_auroc:  0.8268286696121748 val_auprc:  0.9015636267591027
EarlyStopping counter: 18 out of 50
epoch:  103
epoch:  104 val_f1:  0.7873856121514594 val_auroc:  0.8276877761413844 val_auprc:  0.9015909278074313
EarlyStopping counter: 19 out of 50
epoch:  104
epoch:  105 val_f1:  0.7834737923946559 val_auroc:  0.8280559646539029 val_auprc:  0.9045591237343497
EarlyStopping counter: 20 out of 50
epoch:  105
epoch:  106 val_f1:  0.7919479944965341 val_auroc:  0.827319587628866 val_auprc:  0.9039132075805986
EarlyStopping counter: 21 out of 50
epoch:  106
epoch:  107 val_f1:  0.7873856121514594 val_auroc:  0.8273195876288659 val_auprc:  0.9015020516283629
EarlyStopping counter: 22 out of 50
epoch:  107
epoch:  108 val_f1:  0.7748796193569787 val_auroc:  0.8284241531664212 val_auprc:  0.905022384317889
EarlyStopping counter: 23 out of 50
epoch:  108
epoch:  109 val_f1:  0.8003084642191267 val_auroc:  0.8289150711831125 val_auprc:  0.9038157952569932
EarlyStopping counter: 24 out of 50
epoch:  109
epoch:  110 val_f1:  0.7938350857775318 val_auroc:  0.8283014236622483 val_auprc:  0.9034529204239798
EarlyStopping counter: 25 out of 50
epoch:  110
epoch:  111 val_f1:  0.7748796193569787 val_auroc:  0.8264604810996564 val_auprc:  0.9040847751203285
EarlyStopping counter: 26 out of 50
epoch:  111
epoch:  112 val_f1:  0.7873856121514594 val_auroc:  0.8305105547373588 val_auprc:  0.905274960366663
EarlyStopping counter: 27 out of 50
epoch:  112
epoch:  113 val_f1:  0.7873856121514594 val_auroc:  0.8300196367206677 val_auprc:  0.9058191404363712
EarlyStopping counter: 28 out of 50
epoch:  113
epoch:  114 val_f1:  0.7748796193569787 val_auroc:  0.8258468335787923 val_auprc:  0.9042570005454332
EarlyStopping counter: 29 out of 50
epoch:  114
epoch:  115 val_f1:  0.7707245329923307 val_auroc:  0.8273195876288659 val_auprc:  0.905753154588783
EarlyStopping counter: 30 out of 50
epoch:  115
epoch:  116 val_f1:  0.7938350857775318 val_auroc:  0.8280559646539027 val_auprc:  0.9055895792909436
EarlyStopping counter: 31 out of 50
epoch:  116
epoch:  117 val_f1:  0.7873856121514594 val_auroc:  0.8281786941580757 val_auprc:  0.9054131965328577
EarlyStopping counter: 32 out of 50
epoch:  117
epoch:  118 val_f1:  0.7834737923946559 val_auroc:  0.8283014236622485 val_auprc:  0.9052363397671526
EarlyStopping counter: 33 out of 50
epoch:  118
epoch:  119 val_f1:  0.7938350857775318 val_auroc:  0.8284241531664213 val_auprc:  0.9063977628322294
EarlyStopping counter: 34 out of 50
epoch:  119
epoch:  120 val_f1:  0.7748796193569787 val_auroc:  0.8281786941580757 val_auprc:  0.9059228763281222
EarlyStopping counter: 35 out of 50
epoch:  120
epoch:  121 val_f1:  0.7834737923946559 val_auroc:  0.8290378006872853 val_auprc:  0.9059550483381122
EarlyStopping counter: 36 out of 50
epoch:  121
epoch:  122 val_f1:  0.7873856121514594 val_auroc:  0.8279332351497299 val_auprc:  0.9054310351105029
EarlyStopping counter: 37 out of 50
epoch:  122
epoch:  123 val_f1:  0.7938350857775318 val_auroc:  0.8280559646539029 val_auprc:  0.905442562543672
EarlyStopping counter: 38 out of 50
epoch:  123
epoch:  124 val_f1:  0.7748796193569787 val_auroc:  0.8273195876288659 val_auprc:  0.9046842474387581
EarlyStopping counter: 39 out of 50
epoch:  124
epoch:  125 val_f1:  0.7873856121514594 val_auroc:  0.8280559646539027 val_auprc:  0.905783204887089
EarlyStopping counter: 40 out of 50
epoch:  125
epoch:  126 val_f1:  0.7855164986057286 val_auroc:  0.8286696121747668 val_auprc:  0.9069377042905277
EarlyStopping counter: 41 out of 50
epoch:  126
epoch:  127 val_f1:  0.7748796193569787 val_auroc:  0.8274423171330388 val_auprc:  0.9061321630747587
EarlyStopping counter: 42 out of 50
epoch:  127
epoch:  128 val_f1:  0.7873856121514594 val_auroc:  0.8290378006872853 val_auprc:  0.9067770830020734
EarlyStopping counter: 43 out of 50
epoch:  128
epoch:  129 val_f1:  0.7919479944965341 val_auroc:  0.8276877761413844 val_auprc:  0.904825667083611
EarlyStopping counter: 44 out of 50
epoch:  129
epoch:  130 val_f1:  0.7748796193569787 val_auroc:  0.8276877761413844 val_auprc:  0.9050539297387973
EarlyStopping counter: 45 out of 50
epoch:  130
epoch:  131 val_f1:  0.7873856121514594 val_auroc:  0.8274423171330388 val_auprc:  0.9054513849979219
EarlyStopping counter: 46 out of 50
epoch:  131
epoch:  132 val_f1:  0.7873856121514594 val_auroc:  0.8278105056455571 val_auprc:  0.9053525510306034
EarlyStopping counter: 47 out of 50
epoch:  132
epoch:  133 val_f1:  0.7748796193569787 val_auroc:  0.8280559646539029 val_auprc:  0.9065011497543746
EarlyStopping counter: 48 out of 50
epoch:  133
epoch:  134 val_f1:  0.8003084642191267 val_auroc:  0.8285468826705941 val_auprc:  0.9059040530687773
EarlyStopping counter: 49 out of 50
epoch:  134
epoch:  135 val_f1:  0.7938350857775318 val_auroc:  0.828546882670594 val_auprc:  0.9059842049254825
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1825.0049104690552
{'time_elapsed': [1825.0049104690552], 'epoch': [134], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7938350857775318], 'auroc_test': [0.828546882670594], 'auprc_test': [0.9059842049254825]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1280]           2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 1280]           1,024
│    └─Tanh: 2-3                         [64, 512, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1278]           --
│    └─Dropout: 2-5                      [64, 512, 1278]           --
│    └─Flatten: 2-6                      [64, 654336]              --
│    └─Linear: 2-7                       [64, 1]                   654,337
==========================================================================================
Total params: 657,409
Trainable params: 657,409
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 671.09
Params size (MB): 2.63
Estimated Total Size (MB): 674.05
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.5868924889543446 val_auprc:  0.8547837494261481
epoch:  1
epoch:  2 val_f1:  0.5936560505671176 val_auroc:  0.6689985272459499 val_auprc:  0.8427871645848397
Validation loss improved to 1.376454
epoch:  2
epoch:  3 val_f1:  0.6584354138310973 val_auroc:  0.7275405007363771 val_auprc:  0.8636212393404232
Validation loss improved to 1.142422
epoch:  3
epoch:  4 val_f1:  0.6690647482014388 val_auroc:  0.6880216003927344 val_auprc:  0.7930661197965075
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.6549643402161387 val_auroc:  0.7015218458517427 val_auprc:  0.8136167815130779
EarlyStopping counter: 2 out of 50
epoch:  5
epoch:  6 val_f1:  0.6998394924759714 val_auroc:  0.7577319587628867 val_auprc:  0.8742039765414931
Validation loss improved to 1.122617
epoch:  6
epoch:  7 val_f1:  0.7326256806616418 val_auroc:  0.7560137457044673 val_auprc:  0.8683880531239463
Validation loss improved to 0.970462
epoch:  7
epoch:  8 val_f1:  0.7203480251458693 val_auroc:  0.7415316642120766 val_auprc:  0.8529437973061079
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7313689473952751 val_auroc:  0.7596956308296514 val_auprc:  0.8655738131559769
Validation loss improved to 0.797055
epoch:  9
epoch:  10 val_f1:  0.7412236216203913 val_auroc:  0.7628865979381443 val_auprc:  0.8685217115410525
Validation loss improved to 0.640453
epoch:  10
epoch:  11 val_f1:  0.331036839334694 val_auroc:  0.7660775650466373 val_auprc:  0.8710883997124219
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7030912407309765 val_auroc:  0.7633775159548355 val_auprc:  0.8769795117228074
Validation loss improved to 0.628432
epoch:  12
epoch:  13 val_f1:  0.726967940210938 val_auroc:  0.7852233676975945 val_auprc:  0.8932722818449176
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.6962806225607748 val_auroc:  0.7697594501718213 val_auprc:  0.8825597564570425
Validation loss improved to 0.497944
epoch:  14
epoch:  15 val_f1:  0.6958509820496094 val_auroc:  0.7871870397643594 val_auprc:  0.8938283501610638
Validation loss improved to 0.418667
epoch:  15
epoch:  16 val_f1:  0.39723613514251893 val_auroc:  0.7790868924889544 val_auprc:  0.8850897264104679
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.5861044387356725 val_auroc:  0.7695139911634757 val_auprc:  0.8812302973133703
EarlyStopping counter: 2 out of 50
epoch:  17
epoch:  18 val_f1:  0.6982612029498659 val_auroc:  0.7839960726558666 val_auprc:  0.8869242103465493
EarlyStopping counter: 3 out of 50
epoch:  18
epoch:  19 val_f1:  0.7346924658075737 val_auroc:  0.7746686303387333 val_auprc:  0.8811357668507234
EarlyStopping counter: 4 out of 50
epoch:  19
epoch:  20 val_f1:  0.7185321510233673 val_auroc:  0.7810505645557192 val_auprc:  0.8853415571153882
EarlyStopping counter: 5 out of 50
epoch:  20
epoch:  21 val_f1:  0.7229061670449737 val_auroc:  0.7773686794305351 val_auprc:  0.8815809539451791
EarlyStopping counter: 6 out of 50
epoch:  21
epoch:  22 val_f1:  0.7298678635622811 val_auroc:  0.7756504663721159 val_auprc:  0.8780585879327716
EarlyStopping counter: 7 out of 50
epoch:  22
epoch:  23 val_f1:  0.7197172881491292 val_auroc:  0.7722140402552774 val_auprc:  0.8749947472466673
EarlyStopping counter: 8 out of 50
epoch:  23
epoch:  24 val_f1:  0.7208993647046947 val_auroc:  0.7768777614138438 val_auprc:  0.8810606331980558
EarlyStopping counter: 9 out of 50
epoch:  24
epoch:  25 val_f1:  0.7367608586927249 val_auroc:  0.7761413843888071 val_auprc:  0.8800820916887315
Validation loss improved to 0.399473
epoch:  25
epoch:  26 val_f1:  0.7176437068167247 val_auroc:  0.7739322533136966 val_auprc:  0.8804879257948703
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7295632867761842 val_auroc:  0.7655866470299459 val_auprc:  0.8740511213715787
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7082463061808618 val_auroc:  0.7707412862052038 val_auprc:  0.8773108468466305
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.6952451949622753 val_auroc:  0.770495827196858 val_auprc:  0.8771247703030007
EarlyStopping counter: 4 out of 50
epoch:  29
epoch:  30 val_f1:  0.7235944791518311 val_auroc:  0.772459499263623 val_auprc:  0.874510259011083
EarlyStopping counter: 5 out of 50
epoch:  30
epoch:  31 val_f1:  0.7238240177089098 val_auroc:  0.7685321551300932 val_auprc:  0.8714015624315645
EarlyStopping counter: 6 out of 50
epoch:  31
epoch:  32 val_f1:  0.7100860488080124 val_auroc:  0.765586647029946 val_auprc:  0.8715510501253634
EarlyStopping counter: 7 out of 50
epoch:  32
epoch:  33 val_f1:  0.7067808808208037 val_auroc:  0.7673048600883652 val_auprc:  0.8663438145980206
EarlyStopping counter: 8 out of 50
epoch:  33
epoch:  34 val_f1:  0.7289242247644242 val_auroc:  0.7731958762886597 val_auprc:  0.8709859509643864
Validation loss improved to 0.393050
epoch:  34
epoch:  35 val_f1:  0.7289242247644242 val_auroc:  0.770004909180167 val_auprc:  0.87488933241834
Validation loss improved to 0.364341
epoch:  35
epoch:  36 val_f1:  0.7144317414801258 val_auroc:  0.7643593519882179 val_auprc:  0.8692648654630519
EarlyStopping counter: 1 out of 50
epoch:  36
epoch:  37 val_f1:  0.7362024088594293 val_auroc:  0.770004909180167 val_auprc:  0.8740184978407624
Validation loss improved to 0.349867
epoch:  37
epoch:  38 val_f1:  0.7058128438779214 val_auroc:  0.7700049091801668 val_auprc:  0.8743145776394845
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.7162290583621869 val_auroc:  0.7685321551300932 val_auprc:  0.8680975139523001
EarlyStopping counter: 2 out of 50
epoch:  39
epoch:  40 val_f1:  0.7157412825720284 val_auroc:  0.7781050564555719 val_auprc:  0.880304354834527
EarlyStopping counter: 3 out of 50
epoch:  40
epoch:  41 val_f1:  0.7448635686045757 val_auroc:  0.766813942071674 val_auprc:  0.8585743724326597
EarlyStopping counter: 4 out of 50
epoch:  41
epoch:  42 val_f1:  0.7169009504644194 val_auroc:  0.7653411880216003 val_auprc:  0.8618427751511066
EarlyStopping counter: 5 out of 50
epoch:  42
epoch:  43 val_f1:  0.7185533480648861 val_auroc:  0.764359351988218 val_auprc:  0.8659318766079542
EarlyStopping counter: 6 out of 50
epoch:  43
epoch:  44 val_f1:  0.6966777045653197 val_auroc:  0.7727049582719686 val_auprc:  0.8689002684556397
EarlyStopping counter: 7 out of 50
epoch:  44
epoch:  45 val_f1:  0.7391701372600277 val_auroc:  0.7676730486008837 val_auprc:  0.8714988284352336
EarlyStopping counter: 8 out of 50
epoch:  45
epoch:  46 val_f1:  0.7442757932382417 val_auroc:  0.7756504663721159 val_auprc:  0.8772302059938812
Validation loss improved to 0.335086
epoch:  46
epoch:  47 val_f1:  0.7391701372600277 val_auroc:  0.7596956308296514 val_auprc:  0.8621937109310907
EarlyStopping counter: 1 out of 50
epoch:  47
epoch:  48 val_f1:  0.7580594896895918 val_auroc:  0.7663230240549828 val_auprc:  0.865443181109342
EarlyStopping counter: 2 out of 50
epoch:  48
epoch:  49 val_f1:  0.7580594896895918 val_auroc:  0.7633775159548355 val_auprc:  0.8562549812577811
EarlyStopping counter: 3 out of 50
epoch:  49
epoch:  50 val_f1:  0.7283736963917239 val_auroc:  0.7744231713303878 val_auprc:  0.8691100894965851
EarlyStopping counter: 4 out of 50
epoch:  50
epoch:  51 val_f1:  0.7157412825720284 val_auroc:  0.7648502700049092 val_auprc:  0.8601976993501055
EarlyStopping counter: 5 out of 50
epoch:  51
epoch:  52 val_f1:  0.7057031525565856 val_auroc:  0.7673048600883652 val_auprc:  0.8565617496956804
EarlyStopping counter: 6 out of 50
epoch:  52
epoch:  53 val_f1:  0.7441671543148256 val_auroc:  0.7792096219931272 val_auprc:  0.8697527099721245
EarlyStopping counter: 7 out of 50
epoch:  53
epoch:  54 val_f1:  0.6928018025140328 val_auroc:  0.7594501718213058 val_auprc:  0.8575470419440769
EarlyStopping counter: 8 out of 50
epoch:  54
epoch:  55 val_f1:  0.7283736963917239 val_auroc:  0.7685321551300933 val_auprc:  0.8597511771572282
EarlyStopping counter: 9 out of 50
epoch:  55
epoch:  56 val_f1:  0.7727225509205256 val_auroc:  0.7604320078546882 val_auprc:  0.8536831473634319
EarlyStopping counter: 10 out of 50
epoch:  56
epoch:  57 val_f1:  0.7359858855314679 val_auroc:  0.7666912125675013 val_auprc:  0.8570083774572899
EarlyStopping counter: 11 out of 50
epoch:  57
epoch:  58 val_f1:  0.7298678635622811 val_auroc:  0.7695139911634757 val_auprc:  0.8645740382693313
EarlyStopping counter: 12 out of 50
epoch:  58
epoch:  59 val_f1:  0.7359858855314679 val_auroc:  0.7633775159548355 val_auprc:  0.8575752125747571
EarlyStopping counter: 13 out of 50
epoch:  59
epoch:  60 val_f1:  0.7622262794246104 val_auroc:  0.759941089837997 val_auprc:  0.8553502829385597
EarlyStopping counter: 14 out of 50
epoch:  60
epoch:  61 val_f1:  0.7622262794246104 val_auroc:  0.7646048109965636 val_auprc:  0.8556241820346474
EarlyStopping counter: 15 out of 50
epoch:  61
epoch:  62 val_f1:  0.7622262794246104 val_auroc:  0.76620029455081 val_auprc:  0.8578050460836236
EarlyStopping counter: 16 out of 50
epoch:  62
epoch:  63 val_f1:  0.7377691212466089 val_auroc:  0.7670594010800196 val_auprc:  0.8624556316025671
EarlyStopping counter: 17 out of 50
epoch:  63
epoch:  64 val_f1:  0.7346891520614657 val_auroc:  0.7673048600883652 val_auprc:  0.8570739551498261
EarlyStopping counter: 18 out of 50
epoch:  64
epoch:  65 val_f1:  0.7580594896895918 val_auroc:  0.7655866470299459 val_auprc:  0.8551269956461078
EarlyStopping counter: 19 out of 50
epoch:  65
epoch:  66 val_f1:  0.7473302173830908 val_auroc:  0.7653411880216003 val_auprc:  0.8606069938317819
EarlyStopping counter: 20 out of 50
epoch:  66
epoch:  67 val_f1:  0.7346891520614657 val_auroc:  0.7636229749631811 val_auprc:  0.8534420261799688
EarlyStopping counter: 21 out of 50
epoch:  67
epoch:  68 val_f1:  0.7536606851900262 val_auroc:  0.76620029455081 val_auprc:  0.8598301443497673
EarlyStopping counter: 22 out of 50
epoch:  68
epoch:  69 val_f1:  0.7473302173830908 val_auroc:  0.7658321060382917 val_auprc:  0.855712285966989
EarlyStopping counter: 23 out of 50
epoch:  69
epoch:  70 val_f1:  0.7346891520614657 val_auroc:  0.7641138929798723 val_auprc:  0.8571494589902231
EarlyStopping counter: 24 out of 50
epoch:  70
epoch:  71 val_f1:  0.7410071942446043 val_auroc:  0.763745704467354 val_auprc:  0.8562610333761305
EarlyStopping counter: 25 out of 50
epoch:  71
epoch:  72 val_f1:  0.7643829551743221 val_auroc:  0.7654639175257733 val_auprc:  0.859622588338106
EarlyStopping counter: 26 out of 50
epoch:  72
epoch:  73 val_f1:  0.7346891520614657 val_auroc:  0.7633775159548355 val_auprc:  0.8562888725390632
EarlyStopping counter: 27 out of 50
epoch:  73
epoch:  74 val_f1:  0.7299542184434271 val_auroc:  0.7628865979381444 val_auprc:  0.854172882564628
EarlyStopping counter: 28 out of 50
epoch:  74
epoch:  75 val_f1:  0.7536606851900262 val_auroc:  0.7636229749631811 val_auprc:  0.8540489473124857
EarlyStopping counter: 29 out of 50
epoch:  75
epoch:  76 val_f1:  0.7536606851900262 val_auroc:  0.7633775159548356 val_auprc:  0.8565958951679371
EarlyStopping counter: 30 out of 50
epoch:  76
epoch:  77 val_f1:  0.7299542184434271 val_auroc:  0.7635002454590083 val_auprc:  0.8558562508207368
EarlyStopping counter: 31 out of 50
epoch:  77
epoch:  78 val_f1:  0.76000113614692 val_auroc:  0.7609229258713796 val_auprc:  0.853867351163713
EarlyStopping counter: 32 out of 50
epoch:  78
epoch:  79 val_f1:  0.751751326211758 val_auroc:  0.7636229749631811 val_auprc:  0.8544020686063076
EarlyStopping counter: 33 out of 50
epoch:  79
epoch:  80 val_f1:  0.751751326211758 val_auroc:  0.7637457044673539 val_auprc:  0.8559429235559195
EarlyStopping counter: 34 out of 50
epoch:  80
epoch:  81 val_f1:  0.7346891520614657 val_auroc:  0.761904761904762 val_auprc:  0.8528211447832492
EarlyStopping counter: 35 out of 50
epoch:  81
epoch:  82 val_f1:  0.7473302173830908 val_auroc:  0.7635002454590084 val_auprc:  0.855421723574807
EarlyStopping counter: 36 out of 50
epoch:  82
epoch:  83 val_f1:  0.7426698176342648 val_auroc:  0.7652184585174275 val_auprc:  0.8595449124878254
EarlyStopping counter: 37 out of 50
epoch:  83
epoch:  84 val_f1:  0.7643829551743221 val_auroc:  0.7626411389297988 val_auprc:  0.8528848352686874
EarlyStopping counter: 38 out of 50
epoch:  84
epoch:  85 val_f1:  0.7410071942446043 val_auroc:  0.7637457044673539 val_auprc:  0.8561024089874804
EarlyStopping counter: 39 out of 50
epoch:  85
epoch:  86 val_f1:  0.7346891520614657 val_auroc:  0.7617820324005892 val_auprc:  0.8545875607401895
EarlyStopping counter: 40 out of 50
epoch:  86
epoch:  87 val_f1:  0.7313689473952751 val_auroc:  0.7644820814923907 val_auprc:  0.8563574473577942
EarlyStopping counter: 41 out of 50
epoch:  87
epoch:  88 val_f1:  0.7580594896895918 val_auroc:  0.7630093274423172 val_auprc:  0.8549654361748565
EarlyStopping counter: 42 out of 50
epoch:  88
epoch:  89 val_f1:  0.7346891520614657 val_auroc:  0.762518409425626 val_auprc:  0.8550816367564338
EarlyStopping counter: 43 out of 50
epoch:  89
epoch:  90 val_f1:  0.7299542184434271 val_auroc:  0.761904761904762 val_auprc:  0.8547580091231585
EarlyStopping counter: 44 out of 50
epoch:  90
epoch:  91 val_f1:  0.76000113614692 val_auroc:  0.7606774668630338 val_auprc:  0.8552811914366129
EarlyStopping counter: 45 out of 50
epoch:  91
epoch:  92 val_f1:  0.7536606851900262 val_auroc:  0.7622729504172803 val_auprc:  0.8550410801231922
EarlyStopping counter: 46 out of 50
epoch:  92
epoch:  93 val_f1:  0.722058496910722 val_auroc:  0.7610456553755522 val_auprc:  0.8546999757441989
EarlyStopping counter: 47 out of 50
epoch:  93
epoch:  94 val_f1:  0.7346891520614657 val_auroc:  0.7612911143838978 val_auprc:  0.8545207218367015
EarlyStopping counter: 48 out of 50
epoch:  94
epoch:  95 val_f1:  0.7473302173830908 val_auroc:  0.7627638684339715 val_auprc:  0.8550254661489187
EarlyStopping counter: 49 out of 50
epoch:  95
epoch:  96 val_f1:  0.7536606851900262 val_auroc:  0.7623956799214532 val_auprc:  0.8562918835715767
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1295.8757424354553
{'time_elapsed': [1295.8757424354553], 'epoch': [95], 'fold': [2], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7536606851900262], 'auroc_test': [0.7623956799214532], 'auprc_test': [0.8562918835715767]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1280]           2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 1280]           1,024
│    └─Tanh: 2-3                         [64, 512, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1278]           --
│    └─Dropout: 2-5                      [64, 512, 1278]           --
│    └─Flatten: 2-6                      [64, 654336]              --
│    └─Linear: 2-7                       [64, 1]                   654,337
==========================================================================================
Total params: 657,409
Trainable params: 657,409
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 671.09
Params size (MB): 2.63
Estimated Total Size (MB): 674.05
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6284923709384141 val_auroc:  0.6739341085271318 val_auprc:  0.8420693161620616
epoch:  1
epoch:  2 val_f1:  0.6850253581680624 val_auroc:  0.7504844961240311 val_auprc:  0.8917798161133133
Validation loss improved to 0.879184
epoch:  2
epoch:  3 val_f1:  0.6257752418754651 val_auroc:  0.7182655038759689 val_auprc:  0.8613757881534303
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6931630425996281 val_auroc:  0.7676841085271318 val_auprc:  0.8918221522567599
Validation loss improved to 0.775780
epoch:  4
epoch:  5 val_f1:  0.6780271080940892 val_auroc:  0.7931201550387597 val_auprc:  0.905215905460172
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.5352769038858335 val_auroc:  0.8224321705426356 val_auprc:  0.9118833573776779
EarlyStopping counter: 2 out of 50
epoch:  6
epoch:  7 val_f1:  0.7553972101373864 val_auroc:  0.8307897286821705 val_auprc:  0.9199087628542404
Validation loss improved to 0.458070
epoch:  7
epoch:  8 val_f1:  0.7440073473136385 val_auroc:  0.8334544573643411 val_auprc:  0.923024985017811
Validation loss improved to 0.201183
epoch:  8
epoch:  9 val_f1:  0.7227964754633075 val_auroc:  0.8309108527131782 val_auprc:  0.9257027505731246
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7548273393587915 val_auroc:  0.8328488372093024 val_auprc:  0.9265261426389149
Validation loss improved to 0.172438
epoch:  10
epoch:  11 val_f1:  0.7576331204728416 val_auroc:  0.8379360465116279 val_auprc:  0.9274856066693626
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7429991933226874 val_auroc:  0.8436288759689923 val_auprc:  0.9262404080461545
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.767033173809688 val_auroc:  0.846656976744186 val_auprc:  0.9305765819958334
Validation loss improved to 0.157451
epoch:  13
epoch:  14 val_f1:  0.7335046248715313 val_auroc:  0.8444767441860465 val_auprc:  0.9315266889850459
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.654592927974223 val_auroc:  0.8507751937984497 val_auprc:  0.9330988751637523
EarlyStopping counter: 2 out of 50
epoch:  15
epoch:  16 val_f1:  0.7745758989478168 val_auroc:  0.852470930232558 val_auprc:  0.9332366446843838
Validation loss improved to 0.125902
epoch:  16
epoch:  17 val_f1:  0.7645539537561222 val_auroc:  0.8519864341085271 val_auprc:  0.935668767862418
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.7853321924188026 val_auroc:  0.8609496124031008 val_auprc:  0.9386994496595099
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7697841726618705 val_auroc:  0.8636143410852714 val_auprc:  0.9392465417175304
EarlyStopping counter: 3 out of 50
epoch:  19
epoch:  20 val_f1:  0.767033173809688 val_auroc:  0.8578003875968992 val_auprc:  0.9400102314982612
Validation loss improved to 0.116530
epoch:  20
epoch:  21 val_f1:  0.81194879639165 val_auroc:  0.8621608527131782 val_auprc:  0.9409838040275185
Validation loss improved to 0.114156
epoch:  21
epoch:  22 val_f1:  0.752328247292276 val_auroc:  0.8687015503875969 val_auprc:  0.94164727767429
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.576462710428672 val_auroc:  0.8529554263565892 val_auprc:  0.941340457594479
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.7835226993620948 val_auroc:  0.8592538759689923 val_auprc:  0.9392750841358545
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.7974889768226049 val_auroc:  0.8662790697674417 val_auprc:  0.9416653818928489
EarlyStopping counter: 4 out of 50
epoch:  25
epoch:  26 val_f1:  0.81194879639165 val_auroc:  0.8626453488372093 val_auprc:  0.944031216853567
EarlyStopping counter: 5 out of 50
epoch:  26
epoch:  27 val_f1:  0.7793492478744277 val_auroc:  0.8633720930232559 val_auprc:  0.9438892700768414
EarlyStopping counter: 6 out of 50
epoch:  27
epoch:  28 val_f1:  0.7789671954250403 val_auroc:  0.8689437984496123 val_auprc:  0.9439418018252078
Validation loss improved to 0.094240
epoch:  28
epoch:  29 val_f1:  0.8108668046482106 val_auroc:  0.87015503875969 val_auprc:  0.9434247048240338
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.7715286178137136 val_auroc:  0.8703972868217055 val_auprc:  0.9452983314456814
EarlyStopping counter: 2 out of 50
epoch:  30
epoch:  31 val_f1:  0.721483846970343 val_auroc:  0.8716085271317829 val_auprc:  0.9450616889277192
EarlyStopping counter: 3 out of 50
epoch:  31
epoch:  32 val_f1:  0.7857930944221151 val_auroc:  0.8708817829457365 val_auprc:  0.9415498539785621
EarlyStopping counter: 4 out of 50
epoch:  32
epoch:  33 val_f1:  0.7774211400110681 val_auroc:  0.8638565891472868 val_auprc:  0.9416832438262944
EarlyStopping counter: 5 out of 50
epoch:  33
epoch:  34 val_f1:  0.7068609042384861 val_auroc:  0.8682170542635659 val_auprc:  0.9445225328571931
EarlyStopping counter: 6 out of 50
epoch:  34
epoch:  35 val_f1:  0.7811109002295425 val_auroc:  0.8621608527131782 val_auprc:  0.943739743914171
EarlyStopping counter: 7 out of 50
epoch:  35
epoch:  36 val_f1:  0.7729252582141845 val_auroc:  0.8643410852713178 val_auprc:  0.9430417291159781
EarlyStopping counter: 8 out of 50
epoch:  36
epoch:  37 val_f1:  0.7854002281262867 val_auroc:  0.874031007751938 val_auprc:  0.9462087461660023
EarlyStopping counter: 9 out of 50
epoch:  37
epoch:  38 val_f1:  0.8047401180179452 val_auroc:  0.8687015503875969 val_auprc:  0.9450708125520999
EarlyStopping counter: 10 out of 50
epoch:  38
epoch:  39 val_f1:  0.7335046248715313 val_auroc:  0.8730620155038759 val_auprc:  0.9462126871773391
EarlyStopping counter: 11 out of 50
epoch:  39
epoch:  40 val_f1:  0.7697841726618705 val_auroc:  0.873062015503876 val_auprc:  0.9467907102431028
EarlyStopping counter: 12 out of 50
epoch:  40
epoch:  41 val_f1:  0.7776763243674784 val_auroc:  0.8749999999999999 val_auprc:  0.9471031201641416
EarlyStopping counter: 13 out of 50
epoch:  41
epoch:  42 val_f1:  0.7985611510791367 val_auroc:  0.8791182170542635 val_auprc:  0.9480550519775613
EarlyStopping counter: 14 out of 50
epoch:  42
epoch:  43 val_f1:  0.7603368061152953 val_auroc:  0.877422480620155 val_auprc:  0.9487989530141463
EarlyStopping counter: 15 out of 50
epoch:  43
epoch:  44 val_f1:  0.8060437924170468 val_auroc:  0.8713662790697675 val_auprc:  0.9467760717480058
EarlyStopping counter: 16 out of 50
epoch:  44
epoch:  45 val_f1:  0.7489783115038208 val_auroc:  0.8747577519379844 val_auprc:  0.9458536697232648
EarlyStopping counter: 17 out of 50
epoch:  45
epoch:  46 val_f1:  0.8101799492243995 val_auroc:  0.8718507751937985 val_auprc:  0.947387080680761
EarlyStopping counter: 18 out of 50
epoch:  46
epoch:  47 val_f1:  0.8160321672535743 val_auroc:  0.8711240310077519 val_auprc:  0.9464544941433987
EarlyStopping counter: 19 out of 50
epoch:  47
epoch:  48 val_f1:  0.8175531003768415 val_auroc:  0.872577519379845 val_auprc:  0.9462936822855015
EarlyStopping counter: 20 out of 50
epoch:  48
epoch:  49 val_f1:  0.7682301875730638 val_auroc:  0.8771802325581396 val_auprc:  0.9465009358763817
EarlyStopping counter: 21 out of 50
epoch:  49
epoch:  50 val_f1:  0.7892012988311853 val_auroc:  0.874031007751938 val_auprc:  0.9470407368234031
EarlyStopping counter: 22 out of 50
epoch:  50
epoch:  51 val_f1:  0.7997900244397783 val_auroc:  0.877422480620155 val_auprc:  0.9480377909816962
EarlyStopping counter: 23 out of 50
epoch:  51
epoch:  52 val_f1:  0.768937708914086 val_auroc:  0.876937984496124 val_auprc:  0.948368349566794
EarlyStopping counter: 24 out of 50
epoch:  52
epoch:  53 val_f1:  0.7854893118997625 val_auroc:  0.875968992248062 val_auprc:  0.9468637709307482
EarlyStopping counter: 25 out of 50
epoch:  53
epoch:  54 val_f1:  0.776244301724119 val_auroc:  0.875484496124031 val_auprc:  0.9477496988026859
EarlyStopping counter: 26 out of 50
epoch:  54
epoch:  55 val_f1:  0.7854893118997625 val_auroc:  0.875968992248062 val_auprc:  0.9479981063417999
EarlyStopping counter: 27 out of 50
epoch:  55
epoch:  56 val_f1:  0.8093907785715628 val_auroc:  0.8781492248062016 val_auprc:  0.9470589670209411
EarlyStopping counter: 28 out of 50
epoch:  56
epoch:  57 val_f1:  0.7666659578740948 val_auroc:  0.877422480620155 val_auprc:  0.9468294438463385
EarlyStopping counter: 29 out of 50
epoch:  57
epoch:  58 val_f1:  0.7906801532257888 val_auroc:  0.8730620155038761 val_auprc:  0.9470097466109838
EarlyStopping counter: 30 out of 50
epoch:  58
epoch:  59 val_f1:  0.8175531003768415 val_auroc:  0.8747577519379846 val_auprc:  0.9462024683463985
EarlyStopping counter: 31 out of 50
epoch:  59
epoch:  60 val_f1:  0.7776763243674784 val_auroc:  0.8786337209302326 val_auprc:  0.9479873085309746
EarlyStopping counter: 32 out of 50
epoch:  60
epoch:  61 val_f1:  0.8160321672535743 val_auroc:  0.8798449612403101 val_auprc:  0.9492158054626781
EarlyStopping counter: 33 out of 50
epoch:  61
epoch:  62 val_f1:  0.7753157557330894 val_auroc:  0.8779069767441862 val_auprc:  0.9477604491423186
EarlyStopping counter: 34 out of 50
epoch:  62
epoch:  63 val_f1:  0.768937708914086 val_auroc:  0.8762112403100776 val_auprc:  0.9465186607290499
EarlyStopping counter: 35 out of 50
epoch:  63
epoch:  64 val_f1:  0.8027539115793398 val_auroc:  0.8796027131782945 val_auprc:  0.9454228246670442
EarlyStopping counter: 36 out of 50
epoch:  64
epoch:  65 val_f1:  0.7857930944221151 val_auroc:  0.875968992248062 val_auprc:  0.9459727573664054
EarlyStopping counter: 37 out of 50
epoch:  65
epoch:  66 val_f1:  0.7857930944221151 val_auroc:  0.875968992248062 val_auprc:  0.9463897849043534
EarlyStopping counter: 38 out of 50
epoch:  66
epoch:  67 val_f1:  0.764639197732723 val_auroc:  0.8776647286821705 val_auprc:  0.9464720378661031
EarlyStopping counter: 39 out of 50
epoch:  67
epoch:  68 val_f1:  0.8074875573056803 val_auroc:  0.876453488372093 val_auprc:  0.9471985688460386
EarlyStopping counter: 40 out of 50
epoch:  68
epoch:  69 val_f1:  0.7774211400110681 val_auroc:  0.8759689922480619 val_auprc:  0.9460452045698639
EarlyStopping counter: 41 out of 50
epoch:  69
epoch:  70 val_f1:  0.7578890782445586 val_auroc:  0.8728197674418605 val_auprc:  0.9447291747724536
EarlyStopping counter: 42 out of 50
epoch:  70
epoch:  71 val_f1:  0.792019787311512 val_auroc:  0.8742732558139535 val_auprc:  0.9450646055446765
EarlyStopping counter: 43 out of 50
epoch:  71
epoch:  72 val_f1:  0.81194879639165 val_auroc:  0.8713662790697675 val_auprc:  0.9451427560636452
EarlyStopping counter: 44 out of 50
epoch:  72
epoch:  73 val_f1:  0.7932273763653603 val_auroc:  0.8691860465116279 val_auprc:  0.9446447859893652
EarlyStopping counter: 45 out of 50
epoch:  73
epoch:  74 val_f1:  0.7906801532257888 val_auroc:  0.8691860465116279 val_auprc:  0.9447786527149826
EarlyStopping counter: 46 out of 50
epoch:  74
epoch:  75 val_f1:  0.8008946034661633 val_auroc:  0.872577519379845 val_auprc:  0.9444604728736107
EarlyStopping counter: 47 out of 50
epoch:  75
epoch:  76 val_f1:  0.8160321672535743 val_auroc:  0.873546511627907 val_auprc:  0.9447451726986535
EarlyStopping counter: 48 out of 50
epoch:  76
epoch:  77 val_f1:  0.8027539115793398 val_auroc:  0.8723352713178294 val_auprc:  0.9443524309863078
EarlyStopping counter: 49 out of 50
epoch:  77
epoch:  78 val_f1:  0.8093907785715628 val_auroc:  0.8757267441860466 val_auprc:  0.9456452051445174
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1049.9048748016357
{'time_elapsed': [1049.9048748016357], 'epoch': [77], 'fold': [3], 'f1_train': [0.9981997060342249], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8093907785715628], 'auroc_test': [0.8757267441860466], 'auprc_test': [0.9456452051445174]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1280]           2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 1280]           1,024
│    └─Tanh: 2-3                         [64, 512, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1278]           --
│    └─Dropout: 2-5                      [64, 512, 1278]           --
│    └─Flatten: 2-6                      [64, 654336]              --
│    └─Linear: 2-7                       [64, 1]                   654,337
==========================================================================================
Total params: 657,409
Trainable params: 657,409
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 671.09
Params size (MB): 2.63
Estimated Total Size (MB): 674.05
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.7158394694785896 val_auroc:  0.7146577380952381 val_auprc:  0.8505505205992165
epoch:  1
epoch:  2 val_f1:  0.6708425579265818 val_auroc:  0.8268849206349206 val_auprc:  0.9115172806343722
Validation loss improved to 1.121099
epoch:  2
epoch:  3 val_f1:  0.7797523275784146 val_auroc:  0.8142361111111112 val_auprc:  0.9068128996291673
Validation loss improved to 0.623993
epoch:  3
epoch:  4 val_f1:  0.7956729455237178 val_auroc:  0.8671875 val_auprc:  0.9298618655847888
Validation loss improved to 0.355276
epoch:  4
epoch:  5 val_f1:  0.7274504373890237 val_auroc:  0.8783482142857143 val_auprc:  0.9365523430679839
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.7810348219555381 val_auroc:  0.8735119047619049 val_auprc:  0.9355824831705888
EarlyStopping counter: 2 out of 50
epoch:  6
epoch:  7 val_f1:  0.667933432744601 val_auroc:  0.8670634920634921 val_auprc:  0.9349893863235673
EarlyStopping counter: 3 out of 50
epoch:  7
epoch:  8 val_f1:  0.7828617791771808 val_auroc:  0.8727678571428571 val_auprc:  0.9370449945060094
EarlyStopping counter: 4 out of 50
epoch:  8
epoch:  9 val_f1:  0.7781291172595521 val_auroc:  0.867311507936508 val_auprc:  0.934202627682952
EarlyStopping counter: 5 out of 50
epoch:  9
epoch:  10 val_f1:  0.7686030845313764 val_auroc:  0.8645833333333333 val_auprc:  0.9339007390510261
EarlyStopping counter: 6 out of 50
epoch:  10
epoch:  11 val_f1:  0.8072024593763724 val_auroc:  0.8705357142857142 val_auprc:  0.9366517104530818
EarlyStopping counter: 7 out of 50
epoch:  11
epoch:  12 val_f1:  0.7279190593382555 val_auroc:  0.8757440476190476 val_auprc:  0.9384634010068207
EarlyStopping counter: 8 out of 50
epoch:  12
epoch:  13 val_f1:  0.6431708388230127 val_auroc:  0.8779761904761905 val_auprc:  0.9389117201564192
EarlyStopping counter: 9 out of 50
epoch:  13
epoch:  14 val_f1:  0.792371879328401 val_auroc:  0.8767361111111112 val_auprc:  0.9394047607089014
EarlyStopping counter: 10 out of 50
epoch:  14
epoch:  15 val_f1:  0.7634000460087416 val_auroc:  0.8816964285714286 val_auprc:  0.9408998983421957
EarlyStopping counter: 11 out of 50
epoch:  15
epoch:  16 val_f1:  0.8041106719367591 val_auroc:  0.8807043650793651 val_auprc:  0.9409253094517074
EarlyStopping counter: 12 out of 50
epoch:  16
epoch:  17 val_f1:  0.8127933585226971 val_auroc:  0.875 val_auprc:  0.9385901146846983
Validation loss improved to 0.348964
epoch:  17
epoch:  18 val_f1:  0.7130929947870102 val_auroc:  0.8671875 val_auprc:  0.9340291063617313
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7949078298424175 val_auroc:  0.8725198412698413 val_auprc:  0.9371493813350489
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7884143290944841 val_auroc:  0.8747519841269842 val_auprc:  0.938115045026193
EarlyStopping counter: 3 out of 50
epoch:  20
epoch:  21 val_f1:  0.8097298254042504 val_auroc:  0.8727678571428571 val_auprc:  0.9358263618490961
Validation loss improved to 0.326364
epoch:  21
epoch:  22 val_f1:  0.8248625247346153 val_auroc:  0.8759920634920635 val_auprc:  0.9395598495244832
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.8194319840387783 val_auroc:  0.8683035714285714 val_auprc:  0.9329112661154106
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.8081713820844254 val_auroc:  0.8640873015873016 val_auprc:  0.9319928484563156
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.7969889682024659 val_auroc:  0.8680555555555555 val_auprc:  0.9332452854703827
EarlyStopping counter: 4 out of 50
epoch:  25
epoch:  26 val_f1:  0.7969889682024659 val_auroc:  0.8680555555555556 val_auprc:  0.9325222505479518
EarlyStopping counter: 5 out of 50
epoch:  26
epoch:  27 val_f1:  0.8035275913020209 val_auroc:  0.8697916666666666 val_auprc:  0.9325740305692236
EarlyStopping counter: 6 out of 50
epoch:  27
epoch:  28 val_f1:  0.7995542847531747 val_auroc:  0.8725198412698413 val_auprc:  0.933205135752871
EarlyStopping counter: 7 out of 50
epoch:  28
epoch:  29 val_f1:  0.8072024593763724 val_auroc:  0.8670634920634921 val_auprc:  0.9281240502147822
EarlyStopping counter: 8 out of 50
epoch:  29
epoch:  30 val_f1:  0.807228002894545 val_auroc:  0.871279761904762 val_auprc:  0.9306907005356531
EarlyStopping counter: 9 out of 50
epoch:  30
epoch:  31 val_f1:  0.8154066640778435 val_auroc:  0.8673115079365079 val_auprc:  0.9246439394897847
EarlyStopping counter: 10 out of 50
epoch:  31
epoch:  32 val_f1:  0.8290790088826556 val_auroc:  0.876984126984127 val_auprc:  0.936734966680071
Validation loss improved to 0.283693
epoch:  32
epoch:  33 val_f1:  0.8035275913020209 val_auroc:  0.876736111111111 val_auprc:  0.9351789242050577
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.8115942028985508 val_auroc:  0.8697916666666666 val_auprc:  0.927533978965797
EarlyStopping counter: 2 out of 50
epoch:  34
epoch:  35 val_f1:  0.8137922815659323 val_auroc:  0.871279761904762 val_auprc:  0.9302780039252468
EarlyStopping counter: 3 out of 50
epoch:  35
epoch:  36 val_f1:  0.8035275913020209 val_auroc:  0.8740079365079366 val_auprc:  0.9314702447450866
EarlyStopping counter: 4 out of 50
epoch:  36
epoch:  37 val_f1:  0.8115942028985508 val_auroc:  0.867311507936508 val_auprc:  0.9236504205931293
EarlyStopping counter: 5 out of 50
epoch:  37
epoch:  38 val_f1:  0.8088065661047027 val_auroc:  0.873263888888889 val_auprc:  0.9306647000549149
EarlyStopping counter: 6 out of 50
epoch:  38
epoch:  39 val_f1:  0.7995542847531747 val_auroc:  0.8735119047619048 val_auprc:  0.9275624164247751
EarlyStopping counter: 7 out of 50
epoch:  39
epoch:  40 val_f1:  0.7949078298424175 val_auroc:  0.8707837301587302 val_auprc:  0.9278138893889353
EarlyStopping counter: 8 out of 50
epoch:  40
epoch:  41 val_f1:  0.8127933585226971 val_auroc:  0.8715277777777779 val_auprc:  0.9271162160763606
EarlyStopping counter: 9 out of 50
epoch:  41
epoch:  42 val_f1:  0.8088065661047027 val_auroc:  0.8742559523809523 val_auprc:  0.9290183601856294
EarlyStopping counter: 10 out of 50
epoch:  42
epoch:  43 val_f1:  0.800639197204071 val_auroc:  0.8680555555555556 val_auprc:  0.923750614635471
EarlyStopping counter: 11 out of 50
epoch:  43
epoch:  44 val_f1:  0.8088065661047027 val_auroc:  0.8742559523809524 val_auprc:  0.9277741304244952
EarlyStopping counter: 12 out of 50
epoch:  44
epoch:  45 val_f1:  0.8088065661047027 val_auroc:  0.8745039682539684 val_auprc:  0.9299867166195557
EarlyStopping counter: 13 out of 50
epoch:  45
epoch:  46 val_f1:  0.8115942028985508 val_auroc:  0.873015873015873 val_auprc:  0.9276000936148225
EarlyStopping counter: 14 out of 50
epoch:  46
epoch:  47 val_f1:  0.8061683443992288 val_auroc:  0.8695436507936508 val_auprc:  0.9273016003960826
EarlyStopping counter: 15 out of 50
epoch:  47
epoch:  48 val_f1:  0.800639197204071 val_auroc:  0.8725198412698413 val_auprc:  0.9262421278023278
EarlyStopping counter: 16 out of 50
epoch:  48
epoch:  49 val_f1:  0.7988956640912072 val_auroc:  0.875 val_auprc:  0.9291171798840366
EarlyStopping counter: 17 out of 50
epoch:  49
epoch:  50 val_f1:  0.7983928476398275 val_auroc:  0.8683035714285714 val_auprc:  0.8984531478120741
EarlyStopping counter: 18 out of 50
epoch:  50
epoch:  51 val_f1:  0.7839990466164816 val_auroc:  0.8601190476190476 val_auprc:  0.8850117571622074
EarlyStopping counter: 19 out of 50
epoch:  51
epoch:  52 val_f1:  0.8164398044139025 val_auroc:  0.881076388888889 val_auprc:  0.9318741848981849
EarlyStopping counter: 20 out of 50
epoch:  52
epoch:  53 val_f1:  0.7497540822349006 val_auroc:  0.8671874999999999 val_auprc:  0.9194341659894625
EarlyStopping counter: 21 out of 50
epoch:  53
epoch:  54 val_f1:  0.800639197204071 val_auroc:  0.8747519841269841 val_auprc:  0.9235683274357873
EarlyStopping counter: 22 out of 50
epoch:  54
epoch:  55 val_f1:  0.8182185828242006 val_auroc:  0.878968253968254 val_auprc:  0.9337836366153794
EarlyStopping counter: 23 out of 50
epoch:  55
epoch:  56 val_f1:  0.807228002894545 val_auroc:  0.876736111111111 val_auprc:  0.9311482520360067
EarlyStopping counter: 24 out of 50
epoch:  56
epoch:  57 val_f1:  0.8154066640778435 val_auroc:  0.8727678571428571 val_auprc:  0.9172481973985835
EarlyStopping counter: 25 out of 50
epoch:  57
epoch:  58 val_f1:  0.8137922815659323 val_auroc:  0.8730158730158729 val_auprc:  0.925987518517399
EarlyStopping counter: 26 out of 50
epoch:  58
epoch:  59 val_f1:  0.820411899313501 val_auroc:  0.876984126984127 val_auprc:  0.9297248243998002
EarlyStopping counter: 27 out of 50
epoch:  59
epoch:  60 val_f1:  0.8061683443992288 val_auroc:  0.8714037698412698 val_auprc:  0.915631545380993
EarlyStopping counter: 28 out of 50
epoch:  60
epoch:  61 val_f1:  0.8022296544035674 val_auroc:  0.8674355158730159 val_auprc:  0.9149931449134188
EarlyStopping counter: 29 out of 50
epoch:  61
epoch:  62 val_f1:  0.8137922815659323 val_auroc:  0.870907738095238 val_auprc:  0.9222304002588949
EarlyStopping counter: 30 out of 50
epoch:  62
epoch:  63 val_f1:  0.8154066640778435 val_auroc:  0.872891865079365 val_auprc:  0.92303765731829
EarlyStopping counter: 31 out of 50
epoch:  63
epoch:  64 val_f1:  0.8088065661047027 val_auroc:  0.8702876984126985 val_auprc:  0.9182760789592714
EarlyStopping counter: 32 out of 50
epoch:  64
epoch:  65 val_f1:  0.8182185828242006 val_auroc:  0.8776041666666667 val_auprc:  0.9293479986180019
EarlyStopping counter: 33 out of 50
epoch:  65
epoch:  66 val_f1:  0.8115942028985508 val_auroc:  0.875 val_auprc:  0.925265494302874
EarlyStopping counter: 34 out of 50
epoch:  66
epoch:  67 val_f1:  0.8088065661047027 val_auroc:  0.8736359126984127 val_auprc:  0.9238902731617248
EarlyStopping counter: 35 out of 50
epoch:  67
epoch:  68 val_f1:  0.8337541157170946 val_auroc:  0.8766121031746033 val_auprc:  0.9265581305563544
EarlyStopping counter: 36 out of 50
epoch:  68
epoch:  69 val_f1:  0.8167092924126172 val_auroc:  0.8753720238095238 val_auprc:  0.9267382117946534
EarlyStopping counter: 37 out of 50
epoch:  69
epoch:  70 val_f1:  0.8137922815659323 val_auroc:  0.8776041666666666 val_auprc:  0.9280771843647158
EarlyStopping counter: 38 out of 50
epoch:  70
epoch:  71 val_f1:  0.8022296544035674 val_auroc:  0.8759920634920634 val_auprc:  0.9246298475608172
EarlyStopping counter: 39 out of 50
epoch:  71
epoch:  72 val_f1:  0.8022296544035674 val_auroc:  0.875124007936508 val_auprc:  0.9243593457575011
EarlyStopping counter: 40 out of 50
epoch:  72
epoch:  73 val_f1:  0.8088065661047027 val_auroc:  0.8753720238095238 val_auprc:  0.9268485116245166
EarlyStopping counter: 41 out of 50
epoch:  73
epoch:  74 val_f1:  0.8022296544035674 val_auroc:  0.8773561507936509 val_auprc:  0.9273915973419664
EarlyStopping counter: 42 out of 50
epoch:  74
epoch:  75 val_f1:  0.8102677351291666 val_auroc:  0.8756200396825398 val_auprc:  0.9246702235425787
EarlyStopping counter: 43 out of 50
epoch:  75
epoch:  76 val_f1:  0.8049865427618805 val_auroc:  0.8761160714285713 val_auprc:  0.9246850065782493
EarlyStopping counter: 44 out of 50
epoch:  76
epoch:  77 val_f1:  0.8115942028985508 val_auroc:  0.873263888888889 val_auprc:  0.9227154735220693
EarlyStopping counter: 45 out of 50
epoch:  77
epoch:  78 val_f1:  0.8088065661047027 val_auroc:  0.8738839285714287 val_auprc:  0.9262115843560328
EarlyStopping counter: 46 out of 50
epoch:  78
epoch:  79 val_f1:  0.8102677351291666 val_auroc:  0.8766121031746031 val_auprc:  0.9270751638765409
EarlyStopping counter: 47 out of 50
epoch:  79
epoch:  80 val_f1:  0.8102677351291666 val_auroc:  0.874503968253968 val_auprc:  0.9256781389348976
EarlyStopping counter: 48 out of 50
epoch:  80
epoch:  81 val_f1:  0.8022296544035674 val_auroc:  0.8742559523809524 val_auprc:  0.9263861151664661
EarlyStopping counter: 49 out of 50
epoch:  81
epoch:  82 val_f1:  0.8072024593763724 val_auroc:  0.8756200396825397 val_auprc:  0.9267126902733558
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1098.9942305088043
{'time_elapsed': [1098.9942305088043], 'epoch': [81], 'fold': [4], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8072024593763724], 'auroc_test': [0.8756200396825397], 'auprc_test': [0.9267126902733558]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1280]           2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 1280]           1,024
│    └─Tanh: 2-3                         [64, 512, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1278]           --
│    └─Dropout: 2-5                      [64, 512, 1278]           --
│    └─Flatten: 2-6                      [64, 654336]              --
│    └─Linear: 2-7                       [64, 1]                   654,337
==========================================================================================
Total params: 657,409
Trainable params: 657,409
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 671.09
Params size (MB): 2.63
Estimated Total Size (MB): 674.05
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_28', 'config': {'hidden_channels': [512], 'epochs': 500, 'kernel_size': 3, 'pool_kernel_size': 3, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.2126277587555624 val_auroc:  0.7020127638684339 val_auprc:  0.8487406571907772
epoch:  1
epoch:  2 val_f1:  0.5455337222759107 val_auroc:  0.7096219931271478 val_auprc:  0.8524160161890266
Validation loss improved to 1.333172
epoch:  2
epoch:  3 val_f1:  0.6813982824467933 val_auroc:  0.7314678448699068 val_auprc:  0.8654814463550387
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6813982824467933 val_auroc:  0.753804614629357 val_auprc:  0.8790486687646869
EarlyStopping counter: 2 out of 50
epoch:  4
epoch:  5 val_f1:  0.646667571603095 val_auroc:  0.7677957781050564 val_auprc:  0.8904058078096606
Validation loss improved to 1.188650
epoch:  5
epoch:  6 val_f1:  0.7032425848040964 val_auroc:  0.7815414825724104 val_auprc:  0.8994414125588404
Validation loss improved to 1.164146
epoch:  6
epoch:  7 val_f1:  0.7101700457815566 val_auroc:  0.7935689739813452 val_auprc:  0.9071536019909999
Validation loss improved to 1.147574
epoch:  7
epoch:  8 val_f1:  0.6301488691399822 val_auroc:  0.8009327442317135 val_auprc:  0.9114233956483881
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.6339490569706397 val_auroc:  0.8080510554737359 val_auprc:  0.9167482546639235
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.6365644326643948 val_auroc:  0.8134511536573392 val_auprc:  0.9189757426073619
Validation loss improved to 1.129800
epoch:  10
epoch:  11 val_f1:  0.6493555155875299 val_auroc:  0.8186057928325969 val_auprc:  0.9220087705434526
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.6557351278334286 val_auroc:  0.8200785468826706 val_auprc:  0.9235397377613186
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.6663975251072785 val_auroc:  0.821060382916053 val_auprc:  0.9229338863316987
Validation loss improved to 1.123617
epoch:  13
epoch:  14 val_f1:  0.710128282915836 val_auroc:  0.8203240058910162 val_auprc:  0.9229456005623486
Validation loss improved to 1.087470
epoch:  14
epoch:  15 val_f1:  0.7802930475309426 val_auroc:  0.8240058910162003 val_auprc:  0.9263758317504657
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.702570289683208 val_auroc:  0.821060382916053 val_auprc:  0.9232302475861073
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.6557351278334286 val_auroc:  0.8186057928325969 val_auprc:  0.9221190616618735
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.702570289683208 val_auroc:  0.8183603338242514 val_auprc:  0.9216425036218785
EarlyStopping counter: 4 out of 50
epoch:  18
epoch:  19 val_f1:  0.7868059619290214 val_auroc:  0.821060382916053 val_auprc:  0.9242955367991491
EarlyStopping counter: 5 out of 50
epoch:  19
epoch:  20 val_f1:  0.748656020238754 val_auroc:  0.8247422680412371 val_auprc:  0.9257945541575319
EarlyStopping counter: 6 out of 50
epoch:  20
epoch:  21 val_f1:  0.7868059619290214 val_auroc:  0.8181148748159057 val_auprc:  0.9219050927109006
EarlyStopping counter: 7 out of 50
epoch:  21
epoch:  22 val_f1:  0.7559325673789327 val_auroc:  0.8186057928325969 val_auprc:  0.9221496044109596
EarlyStopping counter: 8 out of 50
epoch:  22
epoch:  23 val_f1:  0.748656020238754 val_auroc:  0.8127147766323024 val_auprc:  0.918672619391177
EarlyStopping counter: 9 out of 50
epoch:  23
epoch:  24 val_f1:  0.7101700457815566 val_auroc:  0.8100147275405007 val_auprc:  0.9151656823245263
EarlyStopping counter: 10 out of 50
epoch:  24
epoch:  25 val_f1:  0.7626195746699344 val_auroc:  0.8237604320078546 val_auprc:  0.9261079096760552
EarlyStopping counter: 11 out of 50
epoch:  25
epoch:  26 val_f1:  0.7375047745919104 val_auroc:  0.8247422680412372 val_auprc:  0.9262046148614649
EarlyStopping counter: 12 out of 50
epoch:  26
epoch:  27 val_f1:  0.7236892364125374 val_auroc:  0.8178694158075601 val_auprc:  0.9208808533263051
EarlyStopping counter: 13 out of 50
epoch:  27
epoch:  28 val_f1:  0.7420910227448273 val_auroc:  0.8154148257241042 val_auprc:  0.9208119006679873
EarlyStopping counter: 14 out of 50
epoch:  28
epoch:  29 val_f1:  0.7454557504588546 val_auroc:  0.8102601865488464 val_auprc:  0.9169025882843251
EarlyStopping counter: 15 out of 50
epoch:  29
epoch:  30 val_f1:  0.7598715939807772 val_auroc:  0.8109965635738832 val_auprc:  0.9154339454776639
EarlyStopping counter: 16 out of 50
epoch:  30
epoch:  31 val_f1:  0.7519437633413868 val_auroc:  0.8178694158075602 val_auprc:  0.9236091709170975
EarlyStopping counter: 17 out of 50
epoch:  31
epoch:  32 val_f1:  0.7441671543148256 val_auroc:  0.8095238095238095 val_auprc:  0.9150562670854647
EarlyStopping counter: 18 out of 50
epoch:  32
epoch:  33 val_f1:  0.7426698176342648 val_auroc:  0.8122238586156112 val_auprc:  0.9175282933874384
EarlyStopping counter: 19 out of 50
epoch:  33
epoch:  34 val_f1:  0.7473302173830908 val_auroc:  0.8112420225822288 val_auprc:  0.9173811437055375
EarlyStopping counter: 20 out of 50
epoch:  34
epoch:  35 val_f1:  0.7583800901862243 val_auroc:  0.8107511045655376 val_auprc:  0.915687509329923
EarlyStopping counter: 21 out of 50
epoch:  35
epoch:  36 val_f1:  0.7442757932382417 val_auroc:  0.8144329896907216 val_auprc:  0.9191093325162667
EarlyStopping counter: 22 out of 50
epoch:  36
epoch:  37 val_f1:  0.7442757932382417 val_auroc:  0.821060382916053 val_auprc:  0.9225298800663917
EarlyStopping counter: 23 out of 50
epoch:  37
epoch:  38 val_f1:  0.7346924658075737 val_auroc:  0.8146784486990672 val_auprc:  0.9193055952762023
EarlyStopping counter: 24 out of 50
epoch:  38
epoch:  39 val_f1:  0.7295632867761842 val_auroc:  0.8090328915071183 val_auprc:  0.9145810866041154
EarlyStopping counter: 25 out of 50
epoch:  39
epoch:  40 val_f1:  0.7272357092755477 val_auroc:  0.8183603338242513 val_auprc:  0.9231738298461406
EarlyStopping counter: 26 out of 50
epoch:  40
epoch:  41 val_f1:  0.7402181480621955 val_auroc:  0.8230240549828179 val_auprc:  0.9235921082472749
EarlyStopping counter: 27 out of 50
epoch:  41
epoch:  42 val_f1:  0.7426698176342648 val_auroc:  0.8132056946489936 val_auprc:  0.9165120237242042
EarlyStopping counter: 28 out of 50
epoch:  42
epoch:  43 val_f1:  0.7617684906754855 val_auroc:  0.8043691703485518 val_auprc:  0.9140614287235937
EarlyStopping counter: 29 out of 50
epoch:  43
epoch:  44 val_f1:  0.7426698176342648 val_auroc:  0.8220422189494354 val_auprc:  0.9248414646532002
EarlyStopping counter: 30 out of 50
epoch:  44
epoch:  45 val_f1:  0.7426698176342648 val_auroc:  0.8161512027491409 val_auprc:  0.9197292843561138
EarlyStopping counter: 31 out of 50
epoch:  45
epoch:  46 val_f1:  0.735514445586388 val_auroc:  0.8132056946489935 val_auprc:  0.9183762196845524
EarlyStopping counter: 32 out of 50
epoch:  46
epoch:  47 val_f1:  0.7363119073255568 val_auroc:  0.8026509572901326 val_auprc:  0.91238572968694
EarlyStopping counter: 33 out of 50
epoch:  47
epoch:  48 val_f1:  0.7426698176342648 val_auroc:  0.8156602847324497 val_auprc:  0.9190550744419228
EarlyStopping counter: 34 out of 50
epoch:  48
epoch:  49 val_f1:  0.7363119073255568 val_auroc:  0.8205694648993619 val_auprc:  0.923183255447542
EarlyStopping counter: 35 out of 50
epoch:  49
epoch:  50 val_f1:  0.7490302789770621 val_auroc:  0.8087874324987726 val_auprc:  0.9128517773762905
EarlyStopping counter: 36 out of 50
epoch:  50
epoch:  51 val_f1:  0.7363119073255568 val_auroc:  0.8043691703485518 val_auprc:  0.9140584408008051
EarlyStopping counter: 37 out of 50
epoch:  51
epoch:  52 val_f1:  0.7490302789770621 val_auroc:  0.8114874815905744 val_auprc:  0.9176242005196765
EarlyStopping counter: 38 out of 50
epoch:  52
epoch:  53 val_f1:  0.7426698176342648 val_auroc:  0.81173294059892 val_auprc:  0.9156049413247751
EarlyStopping counter: 39 out of 50
epoch:  53
epoch:  54 val_f1:  0.7299542184434271 val_auroc:  0.8139420716740304 val_auprc:  0.9195414270583384
EarlyStopping counter: 40 out of 50
epoch:  54
epoch:  55 val_f1:  0.7505653177403916 val_auroc:  0.8139420716740305 val_auprc:  0.9169344115513665
EarlyStopping counter: 41 out of 50
epoch:  55
epoch:  56 val_f1:  0.7363119073255568 val_auroc:  0.8146784486990672 val_auprc:  0.9188835499421727
EarlyStopping counter: 42 out of 50
epoch:  56
epoch:  57 val_f1:  0.7505653177403916 val_auroc:  0.8136966126656848 val_auprc:  0.9184040010289438
EarlyStopping counter: 43 out of 50
epoch:  57
epoch:  58 val_f1:  0.7473302173830908 val_auroc:  0.81173294059892 val_auprc:  0.9156099051793349
EarlyStopping counter: 44 out of 50
epoch:  58
epoch:  59 val_f1:  0.7490302789770621 val_auroc:  0.8132056946489937 val_auprc:  0.9179180113453276
EarlyStopping counter: 45 out of 50
epoch:  59
epoch:  60 val_f1:  0.7569659388768054 val_auroc:  0.8163966617574865 val_auprc:  0.9190773912481718
EarlyStopping counter: 46 out of 50
epoch:  60
epoch:  61 val_f1:  0.7553956834532374 val_auroc:  0.8109965635738832 val_auprc:  0.9166138374424025
EarlyStopping counter: 47 out of 50
epoch:  61
epoch:  62 val_f1:  0.7490302789770621 val_auroc:  0.8183603338242514 val_auprc:  0.9200963308330826
EarlyStopping counter: 48 out of 50
epoch:  62
epoch:  63 val_f1:  0.7553956834532374 val_auroc:  0.8146784486990672 val_auprc:  0.9178829879295249
EarlyStopping counter: 49 out of 50
epoch:  63
epoch:  64 val_f1:  0.7569659388768054 val_auroc:  0.8161512027491409 val_auprc:  0.9191623629592172
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  175.1784007549286
{'time_elapsed': [175.1784007549286], 'epoch': [63], 'fold': [0], 'f1_train': [0.9946078283340751], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7569659388768054], 'auroc_test': [0.8161512027491409], 'auprc_test': [0.9191623629592172]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 427]            2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 427]            1,024
│    └─Tanh: 2-3                         [64, 512, 427]            --
│    └─MaxPool1d: 2-4                    [64, 512, 142]            --
│    └─Dropout: 2-5                      [64, 512, 142]            --
│    └─Flatten: 2-6                      [64, 72704]               --
│    └─Linear: 2-7                       [64, 1]                   72,705
==========================================================================================
Total params: 75,777
Trainable params: 75,777
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 223.87
Params size (MB): 0.30
Estimated Total Size (MB): 224.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6454957772912105 val_auroc:  0.6919489445262641 val_auprc:  0.7679636987492631
epoch:  1
epoch:  2 val_f1:  0.5476795589492214 val_auroc:  0.6651939126165931 val_auprc:  0.7549598408480407
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.4404173555565485 val_auroc:  0.6713303878252332 val_auprc:  0.7585876434272383
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5626522627768186 val_auroc:  0.6971035837015219 val_auprc:  0.7812117068601042
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.640046945494452 val_auroc:  0.7454590083456063 val_auprc:  0.8214251036915547
Validation loss improved to 1.139758
epoch:  5
epoch:  6 val_f1:  0.6891084624964738 val_auroc:  0.7876779577810507 val_auprc:  0.8711288993608246
Validation loss improved to 1.043391
epoch:  6
epoch:  7 val_f1:  0.7362024088594293 val_auroc:  0.7871870397643594 val_auprc:  0.8936164887120163
Validation loss improved to 0.998760
epoch:  7
epoch:  8 val_f1:  0.7328919440906961 val_auroc:  0.7906234658811978 val_auprc:  0.9008337619995394
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.702782849280763 val_auroc:  0.7943053510063819 val_auprc:  0.9041270354927426
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.7391701372600277 val_auroc:  0.7989690721649485 val_auprc:  0.9092788810976445
Validation loss improved to 0.995189
epoch:  10
epoch:  11 val_f1:  0.7377691212466089 val_auroc:  0.8087874324987726 val_auprc:  0.9162126117544442
Validation loss improved to 0.960944
epoch:  11
epoch:  12 val_f1:  0.7237742540242516 val_auroc:  0.81173294059892 val_auprc:  0.9180374936103634
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7411406017655346 val_auroc:  0.8100147275405007 val_auprc:  0.9157617166538494
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.7490302789770621 val_auroc:  0.8065783014236623 val_auprc:  0.9153884487504481
EarlyStopping counter: 3 out of 50
epoch:  14
epoch:  15 val_f1:  0.7029258641632973 val_auroc:  0.8058419243986255 val_auprc:  0.9157321368153548
EarlyStopping counter: 4 out of 50
epoch:  15
epoch:  16 val_f1:  0.7238240177089098 val_auroc:  0.8053510063819341 val_auprc:  0.9138056336361386
EarlyStopping counter: 5 out of 50
epoch:  16
epoch:  17 val_f1:  0.7569659388768054 val_auroc:  0.806087383406971 val_auprc:  0.9148901546941596
EarlyStopping counter: 6 out of 50
epoch:  17
epoch:  18 val_f1:  0.7100860488080124 val_auroc:  0.8080510554737359 val_auprc:  0.9168837134075772
EarlyStopping counter: 7 out of 50
epoch:  18
epoch:  19 val_f1:  0.7420910227448273 val_auroc:  0.8102601865488464 val_auprc:  0.9173170540197727
Validation loss improved to 0.950464
epoch:  19
epoch:  20 val_f1:  0.7034651178140057 val_auroc:  0.8063328424153167 val_auprc:  0.9143412116704621
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.743431836172277 val_auroc:  0.8087874324987727 val_auprc:  0.9173859098473605
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.6954243384953055 val_auroc:  0.8109965635738832 val_auprc:  0.9175038163685088
EarlyStopping counter: 3 out of 50
epoch:  22
epoch:  23 val_f1:  0.7531731915989216 val_auroc:  0.810505645557192 val_auprc:  0.9168546062483239
EarlyStopping counter: 4 out of 50
epoch:  23
epoch:  24 val_f1:  0.7531731915989216 val_auroc:  0.8156602847324498 val_auprc:  0.9197196153316105
EarlyStopping counter: 5 out of 50
epoch:  24
epoch:  25 val_f1:  0.7477455593342162 val_auroc:  0.8146784486990671 val_auprc:  0.9194294250859294
EarlyStopping counter: 6 out of 50
epoch:  25
epoch:  26 val_f1:  0.7420910227448273 val_auroc:  0.8090328915071183 val_auprc:  0.9162768285408257
EarlyStopping counter: 7 out of 50
epoch:  26
epoch:  27 val_f1:  0.7420910227448273 val_auroc:  0.8102601865488464 val_auprc:  0.9165602509863316
EarlyStopping counter: 8 out of 50
epoch:  27
epoch:  28 val_f1:  0.7770871369605723 val_auroc:  0.8109965635738832 val_auprc:  0.9164480993185666
EarlyStopping counter: 9 out of 50
epoch:  28
epoch:  29 val_f1:  0.7238240177089098 val_auroc:  0.8127147766323024 val_auprc:  0.9162769270741227
EarlyStopping counter: 10 out of 50
epoch:  29
epoch:  30 val_f1:  0.7095299887411026 val_auroc:  0.815414825724104 val_auprc:  0.9194936315374443
EarlyStopping counter: 11 out of 50
epoch:  30
epoch:  31 val_f1:  0.7167432658301206 val_auroc:  0.8161512027491409 val_auprc:  0.9198259867296547
EarlyStopping counter: 12 out of 50
epoch:  31
epoch:  32 val_f1:  0.7162290583621869 val_auroc:  0.8124693176239568 val_auprc:  0.9180674308113346
EarlyStopping counter: 13 out of 50
epoch:  32
epoch:  33 val_f1:  0.7697841726618705 val_auroc:  0.8095238095238094 val_auprc:  0.9163994266426925
EarlyStopping counter: 14 out of 50
epoch:  33
epoch:  34 val_f1:  0.7330561760022478 val_auroc:  0.807314678448699 val_auprc:  0.9146352697012724
EarlyStopping counter: 15 out of 50
epoch:  34
epoch:  35 val_f1:  0.7473654218886486 val_auroc:  0.8090328915071183 val_auprc:  0.9149960742069952
EarlyStopping counter: 16 out of 50
epoch:  35
epoch:  36 val_f1:  0.7622262794246104 val_auroc:  0.8100147275405007 val_auprc:  0.9148989095688256
EarlyStopping counter: 17 out of 50
epoch:  36
epoch:  37 val_f1:  0.7477455593342162 val_auroc:  0.8107511045655376 val_auprc:  0.9163195041521683
EarlyStopping counter: 18 out of 50
epoch:  37
epoch:  38 val_f1:  0.7367608586927249 val_auroc:  0.8041237113402062 val_auprc:  0.9141720105260986
EarlyStopping counter: 19 out of 50
epoch:  38
epoch:  39 val_f1:  0.7346924658075737 val_auroc:  0.8087874324987727 val_auprc:  0.9157259721333226
EarlyStopping counter: 20 out of 50
epoch:  39
epoch:  40 val_f1:  0.7223183251151889 val_auroc:  0.8053510063819342 val_auprc:  0.9135892607229092
EarlyStopping counter: 21 out of 50
epoch:  40
epoch:  41 val_f1:  0.7596459003010357 val_auroc:  0.8090328915071183 val_auprc:  0.9144466440906956
EarlyStopping counter: 22 out of 50
epoch:  41
epoch:  42 val_f1:  0.7490302789770621 val_auroc:  0.804860088365243 val_auprc:  0.9116151826341108
EarlyStopping counter: 23 out of 50
epoch:  42
epoch:  43 val_f1:  0.7505653177403916 val_auroc:  0.8058419243986255 val_auprc:  0.9115218409347039
EarlyStopping counter: 24 out of 50
epoch:  43
epoch:  44 val_f1:  0.7412236216203913 val_auroc:  0.8043691703485518 val_auprc:  0.911285912973222
EarlyStopping counter: 25 out of 50
epoch:  44
epoch:  45 val_f1:  0.7377691212466089 val_auroc:  0.8055964653902798 val_auprc:  0.9127843333537009
EarlyStopping counter: 26 out of 50
epoch:  45
epoch:  46 val_f1:  0.7412236216203913 val_auroc:  0.8063328424153168 val_auprc:  0.9129092714283684
EarlyStopping counter: 27 out of 50
epoch:  46
epoch:  47 val_f1:  0.7426698176342648 val_auroc:  0.8075601374570447 val_auprc:  0.9129020184556426
EarlyStopping counter: 28 out of 50
epoch:  47
epoch:  48 val_f1:  0.7441671543148256 val_auroc:  0.8053510063819342 val_auprc:  0.9119487310213942
EarlyStopping counter: 29 out of 50
epoch:  48
epoch:  49 val_f1:  0.7536606851900262 val_auroc:  0.804860088365243 val_auprc:  0.9117005680625533
EarlyStopping counter: 30 out of 50
epoch:  49
epoch:  50 val_f1:  0.7426698176342648 val_auroc:  0.8048600883652429 val_auprc:  0.9112827495941818
EarlyStopping counter: 31 out of 50
epoch:  50
epoch:  51 val_f1:  0.7363119073255568 val_auroc:  0.8043691703485518 val_auprc:  0.9111934689582365
EarlyStopping counter: 32 out of 50
epoch:  51
epoch:  52 val_f1:  0.7346891520614657 val_auroc:  0.802405498281787 val_auprc:  0.9093311360034556
EarlyStopping counter: 33 out of 50
epoch:  52
epoch:  53 val_f1:  0.7473302173830908 val_auroc:  0.8006872852233676 val_auprc:  0.9082243163392164
EarlyStopping counter: 34 out of 50
epoch:  53
epoch:  54 val_f1:  0.7707245329923307 val_auroc:  0.8016691212567502 val_auprc:  0.9076018341568288
EarlyStopping counter: 35 out of 50
epoch:  54
epoch:  55 val_f1:  0.7559325673789327 val_auroc:  0.8021600392734414 val_auprc:  0.9088022490257842
EarlyStopping counter: 36 out of 50
epoch:  55
epoch:  56 val_f1:  0.7685409504908388 val_auroc:  0.8014236622484046 val_auprc:  0.9062364663094861
EarlyStopping counter: 37 out of 50
epoch:  56
epoch:  57 val_f1:  0.7483101088021195 val_auroc:  0.7970054000981837 val_auprc:  0.9032982798960696
EarlyStopping counter: 38 out of 50
epoch:  57
epoch:  58 val_f1:  0.7510724063582411 val_auroc:  0.797987236131566 val_auprc:  0.9042070964021012
EarlyStopping counter: 39 out of 50
epoch:  58
epoch:  59 val_f1:  0.7330561760022478 val_auroc:  0.7984781541482573 val_auprc:  0.9049415997327366
EarlyStopping counter: 40 out of 50
epoch:  59
epoch:  60 val_f1:  0.7685409504908388 val_auroc:  0.800441826215022 val_auprc:  0.906874404962272
EarlyStopping counter: 41 out of 50
epoch:  60
epoch:  61 val_f1:  0.76000113614692 val_auroc:  0.8028964162984781 val_auprc:  0.9089946748896487
EarlyStopping counter: 42 out of 50
epoch:  61
epoch:  62 val_f1:  0.766354189375772 val_auroc:  0.7982326951399116 val_auprc:  0.9041090446919717
EarlyStopping counter: 43 out of 50
epoch:  62
epoch:  63 val_f1:  0.766354189375772 val_auroc:  0.7982326951399116 val_auprc:  0.904435423445555
EarlyStopping counter: 44 out of 50
epoch:  63
epoch:  64 val_f1:  0.766354189375772 val_auroc:  0.7972508591065293 val_auprc:  0.9047680393963345
EarlyStopping counter: 45 out of 50
epoch:  64
epoch:  65 val_f1:  0.76000113614692 val_auroc:  0.7960235640648012 val_auprc:  0.9038416349579611
EarlyStopping counter: 46 out of 50
epoch:  65
epoch:  66 val_f1:  0.7727225509205256 val_auroc:  0.7994599901816396 val_auprc:  0.9046132307444562
EarlyStopping counter: 47 out of 50
epoch:  66
epoch:  67 val_f1:  0.7685409504908388 val_auroc:  0.7962690230731467 val_auprc:  0.9023095319105428
EarlyStopping counter: 48 out of 50
epoch:  67
epoch:  68 val_f1:  0.76000113614692 val_auroc:  0.792341678939617 val_auprc:  0.9014383758925908
EarlyStopping counter: 49 out of 50
epoch:  68
epoch:  69 val_f1:  0.7536606851900262 val_auroc:  0.7965144820814923 val_auprc:  0.9043068900111702
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  185.05737853050232
{'time_elapsed': [185.05737853050232], 'epoch': [68], 'fold': [1], 'f1_train': [0.9928161714345926], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7536606851900262], 'auroc_test': [0.7965144820814923], 'auprc_test': [0.9043068900111702]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 427]            2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 427]            1,024
│    └─Tanh: 2-3                         [64, 512, 427]            --
│    └─MaxPool1d: 2-4                    [64, 512, 142]            --
│    └─Dropout: 2-5                      [64, 512, 142]            --
│    └─Flatten: 2-6                      [64, 72704]               --
│    └─Linear: 2-7                       [64, 1]                   72,705
==========================================================================================
Total params: 75,777
Trainable params: 75,777
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 223.87
Params size (MB): 0.30
Estimated Total Size (MB): 224.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.7083946980854197 val_auprc:  0.8114430568909022
epoch:  1
epoch:  2 val_f1:  0.7117994924448791 val_auroc:  0.7027491408934708 val_auprc:  0.8406454160917628
Validation loss improved to 1.141006
epoch:  2
epoch:  3 val_f1:  0.6617377698806362 val_auroc:  0.7265586647029946 val_auprc:  0.8650958479948677
Validation loss improved to 1.047579
epoch:  3
epoch:  4 val_f1:  0.7313689473952751 val_auroc:  0.742513500245459 val_auprc:  0.8627749019797737
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.7030912407309765 val_auroc:  0.7268041237113403 val_auprc:  0.8488708548902462
EarlyStopping counter: 2 out of 50
epoch:  5
epoch:  6 val_f1:  0.6823403921278894 val_auroc:  0.729504172803142 val_auprc:  0.8516243850237246
EarlyStopping counter: 3 out of 50
epoch:  6
epoch:  7 val_f1:  0.7307106601978622 val_auroc:  0.7454590083456063 val_auprc:  0.8637876610514708
EarlyStopping counter: 4 out of 50
epoch:  7
epoch:  8 val_f1:  0.6393953191876878 val_auroc:  0.7577319587628866 val_auprc:  0.8714446376266021
EarlyStopping counter: 5 out of 50
epoch:  8
epoch:  9 val_f1:  0.5739378646336663 val_auroc:  0.7577319587628866 val_auprc:  0.8690829505522528
EarlyStopping counter: 6 out of 50
epoch:  9
epoch:  10 val_f1:  0.608607850561656 val_auroc:  0.7540500736377025 val_auprc:  0.8633726057234827
EarlyStopping counter: 7 out of 50
epoch:  10
epoch:  11 val_f1:  0.743431836172277 val_auroc:  0.7569955817378499 val_auprc:  0.8656566671937194
EarlyStopping counter: 8 out of 50
epoch:  11
epoch:  12 val_f1:  0.6532647299881614 val_auroc:  0.7552773686794305 val_auprc:  0.8630499909651724
EarlyStopping counter: 9 out of 50
epoch:  12
epoch:  13 val_f1:  0.42800045677743515 val_auroc:  0.7545409916543937 val_auprc:  0.864930771553863
EarlyStopping counter: 10 out of 50
epoch:  13
epoch:  14 val_f1:  0.42800045677743515 val_auroc:  0.7582228767795779 val_auprc:  0.8687107322076747
EarlyStopping counter: 11 out of 50
epoch:  14
epoch:  15 val_f1:  0.49417614987605457 val_auroc:  0.757486499754541 val_auprc:  0.8681396691124779
EarlyStopping counter: 12 out of 50
epoch:  15
epoch:  16 val_f1:  0.6598406488264144 val_auroc:  0.7709867452135494 val_auprc:  0.8787630686291268
EarlyStopping counter: 13 out of 50
epoch:  16
epoch:  17 val_f1:  0.667134140788635 val_auroc:  0.7717231222385862 val_auprc:  0.8779694710323294
EarlyStopping counter: 14 out of 50
epoch:  17
epoch:  18 val_f1:  0.6825214527173443 val_auroc:  0.770004909180167 val_auprc:  0.8755594818864494
EarlyStopping counter: 15 out of 50
epoch:  18
epoch:  19 val_f1:  0.7295632867761842 val_auroc:  0.771232204221895 val_auprc:  0.8762977316804319
EarlyStopping counter: 16 out of 50
epoch:  19
epoch:  20 val_f1:  0.7371937993371881 val_auroc:  0.7744231713303878 val_auprc:  0.8792942086904283
EarlyStopping counter: 17 out of 50
epoch:  20
epoch:  21 val_f1:  0.7402181480621955 val_auroc:  0.7744231713303878 val_auprc:  0.8771036586110469
EarlyStopping counter: 18 out of 50
epoch:  21
epoch:  22 val_f1:  0.7428255465713769 val_auroc:  0.7778595974472263 val_auprc:  0.8797010762944373
EarlyStopping counter: 19 out of 50
epoch:  22
epoch:  23 val_f1:  0.7596459003010357 val_auroc:  0.7827687776141385 val_auprc:  0.8852727575955474
EarlyStopping counter: 20 out of 50
epoch:  23
epoch:  24 val_f1:  0.7420910227448273 val_auroc:  0.7754050073637703 val_auprc:  0.8797535500965401
EarlyStopping counter: 21 out of 50
epoch:  24
epoch:  25 val_f1:  0.7030912407309765 val_auroc:  0.772459499263623 val_auprc:  0.8773204994204139
EarlyStopping counter: 22 out of 50
epoch:  25
epoch:  26 val_f1:  0.7307106601978622 val_auroc:  0.7803141875306825 val_auprc:  0.8854545804421279
EarlyStopping counter: 23 out of 50
epoch:  26
epoch:  27 val_f1:  0.7367608586927249 val_auroc:  0.7844869906725577 val_auprc:  0.8886482576939584
EarlyStopping counter: 24 out of 50
epoch:  27
epoch:  28 val_f1:  0.6963686193902022 val_auroc:  0.7670594010800197 val_auprc:  0.8729753053322279
EarlyStopping counter: 25 out of 50
epoch:  28
epoch:  29 val_f1:  0.7346891520614657 val_auroc:  0.7827687776141384 val_auprc:  0.8880052602836617
EarlyStopping counter: 26 out of 50
epoch:  29
epoch:  30 val_f1:  0.7249644134959412 val_auroc:  0.7788414334806089 val_auprc:  0.8849811186548969
EarlyStopping counter: 27 out of 50
epoch:  30
epoch:  31 val_f1:  0.7326256806616418 val_auroc:  0.7785959744722631 val_auprc:  0.8857772509300914
EarlyStopping counter: 28 out of 50
epoch:  31
epoch:  32 val_f1:  0.7185533480648861 val_auroc:  0.7798232695139912 val_auprc:  0.8865921599535994
EarlyStopping counter: 29 out of 50
epoch:  32
epoch:  33 val_f1:  0.722058496910722 val_auroc:  0.7749140893470791 val_auprc:  0.8823298206158923
EarlyStopping counter: 30 out of 50
epoch:  33
epoch:  34 val_f1:  0.7346924658075737 val_auroc:  0.7785959744722631 val_auprc:  0.8836371061278921
EarlyStopping counter: 31 out of 50
epoch:  34
epoch:  35 val_f1:  0.7249644134959412 val_auroc:  0.7812960235640648 val_auprc:  0.8879711084178995
EarlyStopping counter: 32 out of 50
epoch:  35
epoch:  36 val_f1:  0.7490302789770621 val_auroc:  0.7727049582719686 val_auprc:  0.877905088464669
EarlyStopping counter: 33 out of 50
epoch:  36
epoch:  37 val_f1:  0.7263486361521366 val_auroc:  0.7825233186057928 val_auprc:  0.8880044977062989
EarlyStopping counter: 34 out of 50
epoch:  37
epoch:  38 val_f1:  0.726967940210938 val_auroc:  0.7869415807560138 val_auprc:  0.8904538417413248
EarlyStopping counter: 35 out of 50
epoch:  38
epoch:  39 val_f1:  0.7445706985813217 val_auroc:  0.7798232695139912 val_auprc:  0.8830052924509302
EarlyStopping counter: 36 out of 50
epoch:  39
epoch:  40 val_f1:  0.7225455998837295 val_auroc:  0.7763868433971527 val_auprc:  0.8813508667826089
EarlyStopping counter: 37 out of 50
epoch:  40
epoch:  41 val_f1:  0.730071543320129 val_auroc:  0.7793323514973 val_auprc:  0.8851036505153141
EarlyStopping counter: 38 out of 50
epoch:  41
epoch:  42 val_f1:  0.7233618940391454 val_auroc:  0.7741777123220422 val_auprc:  0.8808871605304249
EarlyStopping counter: 39 out of 50
epoch:  42
epoch:  43 val_f1:  0.7207289113763933 val_auroc:  0.7756504663721159 val_auprc:  0.8841106388615746
EarlyStopping counter: 40 out of 50
epoch:  43
epoch:  44 val_f1:  0.7185533480648861 val_auroc:  0.7771232204221895 val_auprc:  0.8873279405897697
EarlyStopping counter: 41 out of 50
epoch:  44
epoch:  45 val_f1:  0.7079427367197151 val_auroc:  0.7702503681885124 val_auprc:  0.8766392279368616
EarlyStopping counter: 42 out of 50
epoch:  45
epoch:  46 val_f1:  0.7225455998837295 val_auroc:  0.7788414334806086 val_auprc:  0.8843888066210066
EarlyStopping counter: 43 out of 50
epoch:  46
epoch:  47 val_f1:  0.7325045643526866 val_auroc:  0.7793323514973001 val_auprc:  0.8843557755585555
EarlyStopping counter: 44 out of 50
epoch:  47
epoch:  48 val_f1:  0.7101890414000308 val_auroc:  0.7700049091801668 val_auprc:  0.8785231110681806
EarlyStopping counter: 45 out of 50
epoch:  48
epoch:  49 val_f1:  0.726175885795287 val_auroc:  0.7736867943053509 val_auprc:  0.883280612380358
EarlyStopping counter: 46 out of 50
epoch:  49
epoch:  50 val_f1:  0.7185533480648861 val_auroc:  0.7714776632302405 val_auprc:  0.879200269592894
EarlyStopping counter: 47 out of 50
epoch:  50
epoch:  51 val_f1:  0.7157412825720284 val_auroc:  0.7761413843888071 val_auprc:  0.8824885847637647
EarlyStopping counter: 48 out of 50
epoch:  51
epoch:  52 val_f1:  0.722058496910722 val_auroc:  0.7754050073637704 val_auprc:  0.8805347392235796
EarlyStopping counter: 49 out of 50
epoch:  52
epoch:  53 val_f1:  0.7246795893300292 val_auroc:  0.7756504663721159 val_auprc:  0.8818638311838071
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  142.36441230773926
{'time_elapsed': [142.36441230773926], 'epoch': [52], 'fold': [2], 'f1_train': [0.9820685492098449], 'auroc_train': [0.9984517276266978], 'auprc_train': [0.9993588273939376], 'f1_test': [0.7246795893300292], 'auroc_test': [0.7756504663721159], 'auprc_test': [0.8818638311838071]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 427]            2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 427]            1,024
│    └─Tanh: 2-3                         [64, 512, 427]            --
│    └─MaxPool1d: 2-4                    [64, 512, 142]            --
│    └─Dropout: 2-5                      [64, 512, 142]            --
│    └─Flatten: 2-6                      [64, 72704]               --
│    └─Linear: 2-7                       [64, 1]                   72,705
==========================================================================================
Total params: 75,777
Trainable params: 75,777
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 223.87
Params size (MB): 0.30
Estimated Total Size (MB): 224.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5719129283253884 val_auroc:  0.6405038759689923 val_auprc:  0.7658613603248693
epoch:  1
epoch:  2 val_f1:  0.567270858637765 val_auroc:  0.6046511627906976 val_auprc:  0.7410239546122812
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.4077685876247027 val_auroc:  0.591327519379845 val_auprc:  0.732838581831108
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5707986106811626 val_auroc:  0.5925387596899225 val_auprc:  0.7341889956665246
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6179129627574238 val_auroc:  0.6138565891472869 val_auprc:  0.7491418162362236
Validation loss improved to 1.465945
epoch:  5
epoch:  6 val_f1:  0.6648857479024806 val_auroc:  0.6477713178294574 val_auprc:  0.7782982807643257
Validation loss improved to 1.224801
epoch:  6
epoch:  7 val_f1:  0.6396354181022997 val_auroc:  0.7078488372093023 val_auprc:  0.8283481062763546
Validation loss improved to 1.085382
epoch:  7
epoch:  8 val_f1:  0.5295340315543332 val_auroc:  0.7550872093023255 val_auprc:  0.8711754495144671
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.6869952582441076 val_auroc:  0.777374031007752 val_auprc:  0.8918695010836332
Validation loss improved to 0.968517
epoch:  9
epoch:  10 val_f1:  0.7289753081911234 val_auroc:  0.7914244186046513 val_auprc:  0.9004459124516005
Validation loss improved to 0.951829
epoch:  10
epoch:  11 val_f1:  0.742587174279715 val_auroc:  0.8020833333333334 val_auprc:  0.9049490160128421
Validation loss improved to 0.921014
epoch:  11
epoch:  12 val_f1:  0.7289753081911234 val_auroc:  0.8081395348837209 val_auprc:  0.9072529386046299
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.724215975155522 val_auroc:  0.8127422480620156 val_auprc:  0.9086386013980896
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.7489893984794112 val_auroc:  0.813953488372093 val_auprc:  0.9082875103174618
Validation loss improved to 0.887345
epoch:  14
epoch:  15 val_f1:  0.7980190776058461 val_auroc:  0.81734496124031 val_auprc:  0.9117048319176317
Validation loss improved to 0.860798
epoch:  15
epoch:  16 val_f1:  0.7835226993620948 val_auroc:  0.8212209302325582 val_auprc:  0.9130269594567091
Validation loss improved to 0.852250
epoch:  16
epoch:  17 val_f1:  0.7916865446634734 val_auroc:  0.8207364341085271 val_auprc:  0.9148895667962399
Validation loss improved to 0.851965
epoch:  17
epoch:  18 val_f1:  0.7646314961799923 val_auroc:  0.8231589147286822 val_auprc:  0.9175001495311117
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7679977157187104 val_auroc:  0.8219476744186047 val_auprc:  0.9166146852970913
Validation loss improved to 0.835414
epoch:  19
epoch:  20 val_f1:  0.7919856304513213 val_auroc:  0.8231589147286822 val_auprc:  0.9179156908330601
Validation loss improved to 0.832403
epoch:  20
epoch:  21 val_f1:  0.7715550815537892 val_auroc:  0.8253391472868218 val_auprc:  0.9188197558026429
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7682301875730638 val_auroc:  0.8265503875968992 val_auprc:  0.9195451127187044
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.7777989809743717 val_auroc:  0.8246124031007752 val_auprc:  0.9202594088414144
Validation loss improved to 0.806131
epoch:  23
epoch:  24 val_f1:  0.7477439586792105 val_auroc:  0.8270348837209303 val_auprc:  0.9209608338406962
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7213692782038106 val_auroc:  0.8294573643410852 val_auprc:  0.9226550142544385
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.7841726618705036 val_auroc:  0.8282461240310077 val_auprc:  0.9217767973174094
EarlyStopping counter: 3 out of 50
epoch:  26
epoch:  27 val_f1:  0.757681867378181 val_auroc:  0.8267926356589147 val_auprc:  0.9228812027136817
EarlyStopping counter: 4 out of 50
epoch:  27
epoch:  28 val_f1:  0.7711885993597467 val_auroc:  0.8321220930232558 val_auprc:  0.92355585289368
EarlyStopping counter: 5 out of 50
epoch:  28
epoch:  29 val_f1:  0.758275274873164 val_auroc:  0.8321220930232558 val_auprc:  0.922471845330765
EarlyStopping counter: 6 out of 50
epoch:  29
epoch:  30 val_f1:  0.7906801532257888 val_auroc:  0.8345445736434108 val_auprc:  0.9253267810584449
EarlyStopping counter: 7 out of 50
epoch:  30
epoch:  31 val_f1:  0.7849097105470042 val_auroc:  0.8340600775193798 val_auprc:  0.9267165219535243
Validation loss improved to 0.797541
epoch:  31
epoch:  32 val_f1:  0.758275274873164 val_auroc:  0.835029069767442 val_auprc:  0.9275467951247014
EarlyStopping counter: 1 out of 50
epoch:  32
epoch:  33 val_f1:  0.7811523753969797 val_auroc:  0.8410852713178295 val_auprc:  0.9308480276984128
Validation loss improved to 0.781595
epoch:  33
epoch:  34 val_f1:  0.7646080538166868 val_auroc:  0.843265503875969 val_auprc:  0.9322395339467878
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.7827158008497472 val_auroc:  0.845203488372093 val_auprc:  0.933168080446718
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.7841726618705036 val_auroc:  0.8430232558139534 val_auprc:  0.9327593757358357
EarlyStopping counter: 3 out of 50
epoch:  36
epoch:  37 val_f1:  0.7901923359271766 val_auroc:  0.8468992248062015 val_auprc:  0.9339416641900645
Validation loss improved to 0.770367
epoch:  37
epoch:  38 val_f1:  0.7516121487046815 val_auroc:  0.8444767441860467 val_auprc:  0.9332709610754059
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.7746634573712671 val_auroc:  0.84859496124031 val_auprc:  0.935515268359109
EarlyStopping counter: 2 out of 50
epoch:  39
epoch:  40 val_f1:  0.7789671954250403 val_auroc:  0.8495639534883721 val_auprc:  0.9351506875621524
Validation loss improved to 0.756483
epoch:  40
epoch:  41 val_f1:  0.7811523753969797 val_auroc:  0.8500484496124032 val_auprc:  0.9369400470720142
Validation loss improved to 0.755499
epoch:  41
epoch:  42 val_f1:  0.7789671954250403 val_auroc:  0.8539244186046512 val_auprc:  0.9395832548512536
Validation loss improved to 0.743827
epoch:  42
epoch:  43 val_f1:  0.7841726618705036 val_auroc:  0.8563468992248062 val_auprc:  0.9396260938015313
EarlyStopping counter: 1 out of 50
epoch:  43
epoch:  44 val_f1:  0.7841726618705036 val_auroc:  0.8573158914728682 val_auprc:  0.9390112493390084
EarlyStopping counter: 2 out of 50
epoch:  44
epoch:  45 val_f1:  0.7866727894280321 val_auroc:  0.8587693798449613 val_auprc:  0.9401357054208527
Validation loss improved to 0.742050
epoch:  45
epoch:  46 val_f1:  0.8041795135320315 val_auroc:  0.8565891472868217 val_auprc:  0.9403428428764651
Validation loss improved to 0.734666
epoch:  46
epoch:  47 val_f1:  0.7940592980161325 val_auroc:  0.8582848837209304 val_auprc:  0.94083070816643
EarlyStopping counter: 1 out of 50
epoch:  47
epoch:  48 val_f1:  0.7827158008497472 val_auroc:  0.8609496124031008 val_auprc:  0.9418696184147931
EarlyStopping counter: 2 out of 50
epoch:  48
epoch:  49 val_f1:  0.7789671954250403 val_auroc:  0.8614341085271318 val_auprc:  0.9417225656818773
EarlyStopping counter: 3 out of 50
epoch:  49
epoch:  50 val_f1:  0.8168429178951009 val_auroc:  0.8643410852713178 val_auprc:  0.9440807046016586
EarlyStopping counter: 4 out of 50
epoch:  50
epoch:  51 val_f1:  0.8022252248962252 val_auroc:  0.8655523255813954 val_auprc:  0.9440542110844587
EarlyStopping counter: 5 out of 50
epoch:  51
epoch:  52 val_f1:  0.7841726618705036 val_auroc:  0.8662790697674418 val_auprc:  0.9447860340006201
EarlyStopping counter: 6 out of 50
epoch:  52
epoch:  53 val_f1:  0.8041795135320315 val_auroc:  0.8670058139534884 val_auprc:  0.9448312267431613
Validation loss improved to 0.711968
epoch:  53
epoch:  54 val_f1:  0.7827158008497472 val_auroc:  0.8684593023255814 val_auprc:  0.9451632189936132
EarlyStopping counter: 1 out of 50
epoch:  54
epoch:  55 val_f1:  0.7892012988311853 val_auroc:  0.8689437984496124 val_auprc:  0.9445517508423238
EarlyStopping counter: 2 out of 50
epoch:  55
epoch:  56 val_f1:  0.7789671954250403 val_auroc:  0.8687015503875969 val_auprc:  0.9454704549407442
EarlyStopping counter: 3 out of 50
epoch:  56
epoch:  57 val_f1:  0.8114552542831148 val_auroc:  0.8696705426356589 val_auprc:  0.9462979924688375
EarlyStopping counter: 4 out of 50
epoch:  57
epoch:  58 val_f1:  0.7932273763653603 val_auroc:  0.8699127906976744 val_auprc:  0.946273483287289
EarlyStopping counter: 5 out of 50
epoch:  58
epoch:  59 val_f1:  0.7817197670435081 val_auroc:  0.8713662790697675 val_auprc:  0.9457474704801383
EarlyStopping counter: 6 out of 50
epoch:  59
epoch:  60 val_f1:  0.7857930944221151 val_auroc:  0.8706395348837209 val_auprc:  0.9462949170936601
EarlyStopping counter: 7 out of 50
epoch:  60
epoch:  61 val_f1:  0.7875752415552048 val_auroc:  0.8701550387596899 val_auprc:  0.9467170161918399
EarlyStopping counter: 8 out of 50
epoch:  61
epoch:  62 val_f1:  0.7854893118997625 val_auroc:  0.8706395348837209 val_auprc:  0.946870090040451
EarlyStopping counter: 9 out of 50
epoch:  62
epoch:  63 val_f1:  0.8181666911368864 val_auroc:  0.8694282945736435 val_auprc:  0.9466029759169697
EarlyStopping counter: 10 out of 50
epoch:  63
epoch:  64 val_f1:  0.7854893118997625 val_auroc:  0.8754844961240309 val_auprc:  0.9483043466042301
EarlyStopping counter: 11 out of 50
epoch:  64
epoch:  65 val_f1:  0.7906801532257888 val_auroc:  0.8737887596899225 val_auprc:  0.9475780740280202
EarlyStopping counter: 12 out of 50
epoch:  65
epoch:  66 val_f1:  0.7875752415552048 val_auroc:  0.8766957364341085 val_auprc:  0.9487933296602368
EarlyStopping counter: 13 out of 50
epoch:  66
epoch:  67 val_f1:  0.8027539115793398 val_auroc:  0.8749999999999999 val_auprc:  0.9487613846931713
EarlyStopping counter: 14 out of 50
epoch:  67
epoch:  68 val_f1:  0.776244301724119 val_auroc:  0.8771802325581395 val_auprc:  0.9492224267817858
EarlyStopping counter: 15 out of 50
epoch:  68
epoch:  69 val_f1:  0.7972014141264308 val_auroc:  0.8762112403100775 val_auprc:  0.9475238980541166
EarlyStopping counter: 16 out of 50
epoch:  69
epoch:  70 val_f1:  0.8084949329130455 val_auroc:  0.876453488372093 val_auprc:  0.948869078534444
EarlyStopping counter: 17 out of 50
epoch:  70
epoch:  71 val_f1:  0.8084949329130455 val_auroc:  0.8776647286821706 val_auprc:  0.9496711609116868
EarlyStopping counter: 18 out of 50
epoch:  71
epoch:  72 val_f1:  0.7906801532257888 val_auroc:  0.8791182170542636 val_auprc:  0.9490267038256763
EarlyStopping counter: 19 out of 50
epoch:  72
epoch:  73 val_f1:  0.8037391402911035 val_auroc:  0.8800872093023256 val_auprc:  0.9501689092847335
EarlyStopping counter: 20 out of 50
epoch:  73
epoch:  74 val_f1:  0.7985611510791367 val_auroc:  0.8810562015503876 val_auprc:  0.9507753140390494
EarlyStopping counter: 21 out of 50
epoch:  74
epoch:  75 val_f1:  0.8008946034661633 val_auroc:  0.8781492248062016 val_auprc:  0.9491600209729611
EarlyStopping counter: 22 out of 50
epoch:  75
epoch:  76 val_f1:  0.7892012988311853 val_auroc:  0.8779069767441862 val_auprc:  0.9491034922786031
EarlyStopping counter: 23 out of 50
epoch:  76
epoch:  77 val_f1:  0.8102961135322703 val_auroc:  0.8815406976744187 val_auprc:  0.9507178783825343
EarlyStopping counter: 24 out of 50
epoch:  77
epoch:  78 val_f1:  0.8063632502555458 val_auroc:  0.8812984496124031 val_auprc:  0.9496476837119863
EarlyStopping counter: 25 out of 50
epoch:  78
epoch:  79 val_f1:  0.8151164175042944 val_auroc:  0.8798449612403101 val_auprc:  0.9500790925840956
EarlyStopping counter: 26 out of 50
epoch:  79
epoch:  80 val_f1:  0.8093907785715628 val_auroc:  0.8796027131782946 val_auprc:  0.9500230382017689
EarlyStopping counter: 27 out of 50
epoch:  80
epoch:  81 val_f1:  0.8093907785715628 val_auroc:  0.8812984496124031 val_auprc:  0.9507618879739672
EarlyStopping counter: 28 out of 50
epoch:  81
epoch:  82 val_f1:  0.8063632502555458 val_auroc:  0.8803294573643411 val_auprc:  0.9500410464623946
EarlyStopping counter: 29 out of 50
epoch:  82
epoch:  83 val_f1:  0.8160321672535743 val_auroc:  0.879360465116279 val_auprc:  0.9499114042814931
EarlyStopping counter: 30 out of 50
epoch:  83
epoch:  84 val_f1:  0.8084949329130455 val_auroc:  0.882267441860465 val_auprc:  0.9505261138069381
EarlyStopping counter: 31 out of 50
epoch:  84
epoch:  85 val_f1:  0.8226804934380051 val_auroc:  0.8820251937984496 val_auprc:  0.9512400898761865
EarlyStopping counter: 32 out of 50
epoch:  85
epoch:  86 val_f1:  0.768937708914086 val_auroc:  0.8822674418604651 val_auprc:  0.9509063703386492
EarlyStopping counter: 33 out of 50
epoch:  86
epoch:  87 val_f1:  0.7940592980161325 val_auroc:  0.8810562015503876 val_auprc:  0.9500505310934806
EarlyStopping counter: 34 out of 50
epoch:  87
epoch:  88 val_f1:  0.7940592980161325 val_auroc:  0.8805717054263567 val_auprc:  0.9499897396951338
EarlyStopping counter: 35 out of 50
epoch:  88
epoch:  89 val_f1:  0.7892012988311853 val_auroc:  0.8825096899224805 val_auprc:  0.9503396708342643
EarlyStopping counter: 36 out of 50
epoch:  89
epoch:  90 val_f1:  0.8074875573056803 val_auroc:  0.881782945736434 val_auprc:  0.9505806653068861
EarlyStopping counter: 37 out of 50
epoch:  90
epoch:  91 val_f1:  0.8226804934380051 val_auroc:  0.8839631782945736 val_auprc:  0.9519463367274824
EarlyStopping counter: 38 out of 50
epoch:  91
epoch:  92 val_f1:  0.7985611510791367 val_auroc:  0.883720930232558 val_auprc:  0.950912363223577
EarlyStopping counter: 39 out of 50
epoch:  92
epoch:  93 val_f1:  0.7972014141264308 val_auroc:  0.8812984496124032 val_auprc:  0.9511196787768469
EarlyStopping counter: 40 out of 50
epoch:  93
epoch:  94 val_f1:  0.7940592980161325 val_auroc:  0.8839631782945737 val_auprc:  0.9503798296663089
EarlyStopping counter: 41 out of 50
epoch:  94
epoch:  95 val_f1:  0.7957035068809065 val_auroc:  0.8815406976744187 val_auprc:  0.9502533131159556
EarlyStopping counter: 42 out of 50
epoch:  95
epoch:  96 val_f1:  0.8140907369797942 val_auroc:  0.8825096899224806 val_auprc:  0.9509790728370247
EarlyStopping counter: 43 out of 50
epoch:  96
epoch:  97 val_f1:  0.8301835390032996 val_auroc:  0.8839631782945735 val_auprc:  0.9515885233607826
EarlyStopping counter: 44 out of 50
epoch:  97
epoch:  98 val_f1:  0.8301835390032996 val_auroc:  0.8849321705426357 val_auprc:  0.9529250220253611
EarlyStopping counter: 45 out of 50
epoch:  98
epoch:  99 val_f1:  0.7957035068809065 val_auroc:  0.8873546511627907 val_auprc:  0.952155021567364
EarlyStopping counter: 46 out of 50
epoch:  99
epoch:  100 val_f1:  0.7972014141264308 val_auroc:  0.8854166666666666 val_auprc:  0.9518904056819226
EarlyStopping counter: 47 out of 50
epoch:  100
epoch:  101 val_f1:  0.7906801532257888 val_auroc:  0.8844476744186046 val_auprc:  0.9518597616279649
EarlyStopping counter: 48 out of 50
epoch:  101
epoch:  102 val_f1:  0.7957035068809065 val_auroc:  0.8851744186046512 val_auprc:  0.9516953831363404
EarlyStopping counter: 49 out of 50
epoch:  102
epoch:  103 val_f1:  0.7957035068809065 val_auroc:  0.8851744186046511 val_auprc:  0.952023707781223
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  267.0358843803406
{'time_elapsed': [267.0358843803406], 'epoch': [102], 'fold': [3], 'f1_train': [0.9981997060342249], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7957035068809065], 'auroc_test': [0.8851744186046511], 'auprc_test': [0.952023707781223]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 427]            2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 427]            1,024
│    └─Tanh: 2-3                         [64, 512, 427]            --
│    └─MaxPool1d: 2-4                    [64, 512, 142]            --
│    └─Dropout: 2-5                      [64, 512, 142]            --
│    └─Flatten: 2-6                      [64, 72704]               --
│    └─Linear: 2-7                       [64, 1]                   72,705
==========================================================================================
Total params: 75,777
Trainable params: 75,777
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 223.87
Params size (MB): 0.30
Estimated Total Size (MB): 224.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.40555768028879785 val_auroc:  0.7810019841269842 val_auprc:  0.8907224123338124
epoch:  1
epoch:  2 val_f1:  0.6138384657503865 val_auroc:  0.7353670634920635 val_auprc:  0.8391916946465641
Validation loss improved to 1.214375
epoch:  2
epoch:  3 val_f1:  0.609961274701994 val_auroc:  0.7589285714285714 val_auprc:  0.836194321138451
Validation loss improved to 1.164735
epoch:  3
epoch:  4 val_f1:  0.6003513394817742 val_auroc:  0.8045634920634921 val_auprc:  0.8647261644884326
Validation loss improved to 1.098835
epoch:  4
epoch:  5 val_f1:  0.6868924260228607 val_auroc:  0.808531746031746 val_auprc:  0.8849530818331621
Validation loss improved to 0.948037
epoch:  5
epoch:  6 val_f1:  0.7146130523744377 val_auroc:  0.8373015873015873 val_auprc:  0.913785369847864
Validation loss improved to 0.887110
epoch:  6
epoch:  7 val_f1:  0.7145929179934707 val_auroc:  0.8566468253968255 val_auprc:  0.9261939918270116
Validation loss improved to 0.861927
epoch:  7
epoch:  8 val_f1:  0.7075175862361216 val_auroc:  0.8650793650793651 val_auprc:  0.9296586404957412
Validation loss improved to 0.857734
epoch:  8
epoch:  9 val_f1:  0.8090037477295196 val_auroc:  0.8687996031746031 val_auprc:  0.9314994919192342
Validation loss improved to 0.808334
epoch:  9
epoch:  10 val_f1:  0.7715326840649617 val_auroc:  0.8747519841269841 val_auprc:  0.9334891708544145
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.8146053186998734 val_auroc:  0.8754960317460317 val_auprc:  0.933890962215252
EarlyStopping counter: 2 out of 50
epoch:  11
epoch:  12 val_f1:  0.8057130854862423 val_auroc:  0.8782242063492063 val_auprc:  0.936864635441083
EarlyStopping counter: 3 out of 50
epoch:  12
epoch:  13 val_f1:  0.7075175862361216 val_auroc:  0.8814484126984127 val_auprc:  0.9374718047191268
Validation loss improved to 0.797009
epoch:  13
epoch:  14 val_f1:  0.7286401025531458 val_auroc:  0.8824404761904763 val_auprc:  0.9373882738387543
Validation loss improved to 0.785269
epoch:  14
epoch:  15 val_f1:  0.7356159817134149 val_auroc:  0.880704365079365 val_auprc:  0.9375191635280455
Validation loss improved to 0.783973
epoch:  15
epoch:  16 val_f1:  0.8127933585226971 val_auroc:  0.8749999999999999 val_auprc:  0.9364479174561013
Validation loss improved to 0.781861
epoch:  16
epoch:  17 val_f1:  0.8057130854862423 val_auroc:  0.8732638888888888 val_auprc:  0.9327652774607553
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.8138718358422335 val_auroc:  0.8735119047619048 val_auprc:  0.9337668487485331
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7632485643970468 val_auroc:  0.8759920634920635 val_auprc:  0.934989384115462
Validation loss improved to 0.770010
epoch:  19
epoch:  20 val_f1:  0.770099160945843 val_auroc:  0.8735119047619048 val_auprc:  0.9341340766960284
Validation loss improved to 0.768805
epoch:  20
epoch:  21 val_f1:  0.7889492753623188 val_auroc:  0.8715277777777778 val_auprc:  0.9318411463152906
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7769308547872755 val_auroc:  0.8740079365079365 val_auprc:  0.9353769418380549
Validation loss improved to 0.766550
epoch:  22
epoch:  23 val_f1:  0.8049865427618805 val_auroc:  0.8725198412698413 val_auprc:  0.9354951167815422
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.8235137533274179 val_auroc:  0.8692956349206349 val_auprc:  0.9324171320921864
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.8005921770297647 val_auroc:  0.871031746031746 val_auprc:  0.9330050904615984
EarlyStopping counter: 3 out of 50
epoch:  25
epoch:  26 val_f1:  0.7564782680351303 val_auroc:  0.8707837301587302 val_auprc:  0.9332461155913638
EarlyStopping counter: 4 out of 50
epoch:  26
epoch:  27 val_f1:  0.7895875497243353 val_auroc:  0.8670634920634921 val_auprc:  0.9306440992896441
EarlyStopping counter: 5 out of 50
epoch:  27
epoch:  28 val_f1:  0.8220330394243437 val_auroc:  0.8668154761904762 val_auprc:  0.9329695454909288
EarlyStopping counter: 6 out of 50
epoch:  28
epoch:  29 val_f1:  0.795635738397158 val_auroc:  0.8697916666666667 val_auprc:  0.9333949695919304
EarlyStopping counter: 7 out of 50
epoch:  29
epoch:  30 val_f1:  0.7995542847531747 val_auroc:  0.8653273809523809 val_auprc:  0.9310828102115435
EarlyStopping counter: 8 out of 50
epoch:  30
epoch:  31 val_f1:  0.8156899810964081 val_auroc:  0.8678075396825397 val_auprc:  0.9311755965052129
EarlyStopping counter: 9 out of 50
epoch:  31
epoch:  32 val_f1:  0.8090037477295196 val_auroc:  0.8712797619047619 val_auprc:  0.9344150309206841
EarlyStopping counter: 10 out of 50
epoch:  32
epoch:  33 val_f1:  0.7895875497243353 val_auroc:  0.8727678571428572 val_auprc:  0.9355890827852238
EarlyStopping counter: 11 out of 50
epoch:  33
epoch:  34 val_f1:  0.7697938448700337 val_auroc:  0.875 val_auprc:  0.9355421818103009
EarlyStopping counter: 12 out of 50
epoch:  34
epoch:  35 val_f1:  0.7765822970867508 val_auroc:  0.8762400793650794 val_auprc:  0.9378360281683576
EarlyStopping counter: 13 out of 50
epoch:  35
epoch:  36 val_f1:  0.8164398044139025 val_auroc:  0.8794642857142858 val_auprc:  0.937934512276208
EarlyStopping counter: 14 out of 50
epoch:  36
epoch:  37 val_f1:  0.8194319840387783 val_auroc:  0.8745039682539683 val_auprc:  0.9359306766088343
EarlyStopping counter: 15 out of 50
epoch:  37
epoch:  38 val_f1:  0.8115942028985508 val_auroc:  0.8767361111111112 val_auprc:  0.9365498245638139
EarlyStopping counter: 16 out of 50
epoch:  38
epoch:  39 val_f1:  0.8115942028985508 val_auroc:  0.8774801587301588 val_auprc:  0.9373691329789895
EarlyStopping counter: 17 out of 50
epoch:  39
epoch:  40 val_f1:  0.8260869565217391 val_auroc:  0.8757440476190477 val_auprc:  0.9369260039068136
EarlyStopping counter: 18 out of 50
epoch:  40
epoch:  41 val_f1:  0.8168793096329329 val_auroc:  0.8727678571428572 val_auprc:  0.9343854353629619
EarlyStopping counter: 19 out of 50
epoch:  41
epoch:  42 val_f1:  0.8154066640778435 val_auroc:  0.8784722222222223 val_auprc:  0.9375259471622654
EarlyStopping counter: 20 out of 50
epoch:  42
epoch:  43 val_f1:  0.822380909337431 val_auroc:  0.884920634920635 val_auprc:  0.940344753963982
EarlyStopping counter: 21 out of 50
epoch:  43
epoch:  44 val_f1:  0.8156899810964081 val_auroc:  0.8814484126984127 val_auprc:  0.9395431880126676
EarlyStopping counter: 22 out of 50
epoch:  44
epoch:  45 val_f1:  0.8260869565217391 val_auroc:  0.8747519841269841 val_auprc:  0.9337995864436335
EarlyStopping counter: 23 out of 50
epoch:  45
epoch:  46 val_f1:  0.8035275913020209 val_auroc:  0.8715277777777778 val_auprc:  0.9321423559130637
EarlyStopping counter: 24 out of 50
epoch:  46
epoch:  47 val_f1:  0.8168793096329329 val_auroc:  0.8804563492063492 val_auprc:  0.9381892429558872
EarlyStopping counter: 25 out of 50
epoch:  47
epoch:  48 val_f1:  0.8137922815659323 val_auroc:  0.8742559523809523 val_auprc:  0.9331700886698173
EarlyStopping counter: 26 out of 50
epoch:  48
epoch:  49 val_f1:  0.820411899313501 val_auroc:  0.8750000000000001 val_auprc:  0.9340951522790004
EarlyStopping counter: 27 out of 50
epoch:  49
epoch:  50 val_f1:  0.8100998424466828 val_auroc:  0.873263888888889 val_auprc:  0.9324538956940255
EarlyStopping counter: 28 out of 50
epoch:  50
epoch:  51 val_f1:  0.8182185828242006 val_auroc:  0.8792162698412699 val_auprc:  0.9393601873395008
EarlyStopping counter: 29 out of 50
epoch:  51
epoch:  52 val_f1:  0.8154066640778435 val_auroc:  0.8819444444444445 val_auprc:  0.9376582787981139
EarlyStopping counter: 30 out of 50
epoch:  52
epoch:  53 val_f1:  0.8182185828242006 val_auroc:  0.8804563492063492 val_auprc:  0.9383415892087937
EarlyStopping counter: 31 out of 50
epoch:  53
epoch:  54 val_f1:  0.8248625247346153 val_auroc:  0.8846726190476191 val_auprc:  0.9405361183484539
EarlyStopping counter: 32 out of 50
epoch:  54
epoch:  55 val_f1:  0.8088065661047027 val_auroc:  0.8826884920634921 val_auprc:  0.9390111910367268
EarlyStopping counter: 33 out of 50
epoch:  55
epoch:  56 val_f1:  0.8072024593763724 val_auroc:  0.8784722222222222 val_auprc:  0.9359384370224114
EarlyStopping counter: 34 out of 50
epoch:  56
epoch:  57 val_f1:  0.8235137533274179 val_auroc:  0.8804563492063492 val_auprc:  0.9375397468990563
EarlyStopping counter: 35 out of 50
epoch:  57
epoch:  58 val_f1:  0.81483559295621 val_auroc:  0.8846726190476191 val_auprc:  0.9402383212024518
EarlyStopping counter: 36 out of 50
epoch:  58
epoch:  59 val_f1:  0.8194319840387783 val_auroc:  0.8856646825396826 val_auprc:  0.9401528921822924
EarlyStopping counter: 37 out of 50
epoch:  59
epoch:  60 val_f1:  0.8270646766169155 val_auroc:  0.8797123015873016 val_auprc:  0.9378868500114803
EarlyStopping counter: 38 out of 50
epoch:  60
epoch:  61 val_f1:  0.8088065661047027 val_auroc:  0.8874007936507936 val_auprc:  0.941608398913744
EarlyStopping counter: 39 out of 50
epoch:  61
epoch:  62 val_f1:  0.8102677351291666 val_auroc:  0.884920634920635 val_auprc:  0.9414838193409896
EarlyStopping counter: 40 out of 50
epoch:  62
epoch:  63 val_f1:  0.800639197204071 val_auroc:  0.8844246031746031 val_auprc:  0.9406216501412831
EarlyStopping counter: 41 out of 50
epoch:  63
epoch:  64 val_f1:  0.8022296544035674 val_auroc:  0.8836805555555556 val_auprc:  0.9406968265827504
EarlyStopping counter: 42 out of 50
epoch:  64
epoch:  65 val_f1:  0.8022296544035674 val_auroc:  0.8861607142857143 val_auprc:  0.9406841860349786
EarlyStopping counter: 43 out of 50
epoch:  65
epoch:  66 val_f1:  0.8022296544035674 val_auroc:  0.8834325396825397 val_auprc:  0.9399401845414191
EarlyStopping counter: 44 out of 50
epoch:  66
epoch:  67 val_f1:  0.8022296544035674 val_auroc:  0.8836805555555556 val_auprc:  0.9409517765953057
EarlyStopping counter: 45 out of 50
epoch:  67
epoch:  68 val_f1:  0.8102677351291666 val_auroc:  0.886656746031746 val_auprc:  0.9423830842340635
EarlyStopping counter: 46 out of 50
epoch:  68
epoch:  69 val_f1:  0.800639197204071 val_auroc:  0.8844246031746033 val_auprc:  0.941330836348908
EarlyStopping counter: 47 out of 50
epoch:  69
epoch:  70 val_f1:  0.8022296544035674 val_auroc:  0.8856646825396826 val_auprc:  0.9421707711091903
EarlyStopping counter: 48 out of 50
epoch:  70
epoch:  71 val_f1:  0.8022296544035674 val_auroc:  0.8846726190476191 val_auprc:  0.9414733586406407
EarlyStopping counter: 49 out of 50
epoch:  71
epoch:  72 val_f1:  0.8194319840387783 val_auroc:  0.8851686507936508 val_auprc:  0.9415304812869643
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  191.15242791175842
{'time_elapsed': [191.15242791175842], 'epoch': [71], 'fold': [4], 'f1_train': [0.9964087979844714], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8194319840387783], 'auroc_test': [0.8851686507936508], 'auprc_test': [0.9415304812869643]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 427]            2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 427]            1,024
│    └─Tanh: 2-3                         [64, 512, 427]            --
│    └─MaxPool1d: 2-4                    [64, 512, 142]            --
│    └─Dropout: 2-5                      [64, 512, 142]            --
│    └─Flatten: 2-6                      [64, 72704]               --
│    └─Linear: 2-7                       [64, 1]                   72,705
==========================================================================================
Total params: 75,777
Trainable params: 75,777
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 223.87
Params size (MB): 0.30
Estimated Total Size (MB): 224.50
==========================================================================================
