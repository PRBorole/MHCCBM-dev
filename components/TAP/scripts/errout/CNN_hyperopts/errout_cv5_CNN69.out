config:  {'project': 'MHCCBM', 'name': 'CNN_69', 'config': {'hidden_channels': [256], 'epochs': 500, 'kernel_size': 7, 'pool_kernel_size': 7, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5743222833497907 val_auroc:  0.677712322042219 val_auprc:  0.7724883325433436
epoch:  1
epoch:  2 val_f1:  0.6584354138310973 val_auroc:  0.7039764359351988 val_auprc:  0.8595112636052062
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.499774526580479 val_auroc:  0.710112911143839 val_auprc:  0.8618910036310813
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.726967940210938 val_auroc:  0.7167403043691704 val_auprc:  0.8652448862642319
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6393953191876878 val_auroc:  0.740058910162003 val_auprc:  0.8753675854326869
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6376535972729985 val_auroc:  0.7650957290132547 val_auprc:  0.8924730423538932
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.6894399143298684 val_auroc:  0.7633775159548355 val_auprc:  0.8947725391652441
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.7596459003010357 val_auroc:  0.7847324496809033 val_auprc:  0.9067467408561414
EarlyStopping counter: 7 out of 50
epoch:  8
epoch:  9 val_f1:  0.7170452552783244 val_auroc:  0.7987236131566028 val_auprc:  0.9144851941783101
Validation loss improved to 0.674401
epoch:  9
epoch:  10 val_f1:  0.7577565132360132 val_auroc:  0.7938144329896908 val_auprc:  0.9114189574150542
Validation loss improved to 0.612090
epoch:  10
epoch:  11 val_f1:  0.7699730743399811 val_auroc:  0.8004418262150221 val_auprc:  0.9149370151510016
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7839141001375581 val_auroc:  0.8014236622484046 val_auprc:  0.9148673557493796
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.7831873586549224 val_auroc:  0.803632793323515 val_auprc:  0.9162661785665872
EarlyStopping counter: 3 out of 50
epoch:  13
epoch:  14 val_f1:  0.7445203699313053 val_auroc:  0.8161512027491409 val_auprc:  0.9234752764934088
Validation loss improved to 0.583729
epoch:  14
epoch:  15 val_f1:  0.7699730743399811 val_auroc:  0.8009327442317133 val_auprc:  0.9108017578558572
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7839141001375581 val_auroc:  0.8232695139911634 val_auprc:  0.9274945048403745
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.7510257046352308 val_auroc:  0.8136966126656848 val_auprc:  0.9199030517298425
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.7239714721729109 val_auroc:  0.8159057437407953 val_auprc:  0.9210969249921154
Validation loss improved to 0.583304
epoch:  18
epoch:  19 val_f1:  0.7101700457815566 val_auroc:  0.8230240549828178 val_auprc:  0.9260302130210465
Validation loss improved to 0.568800
epoch:  19
epoch:  20 val_f1:  0.7920536597238516 val_auroc:  0.818605792832597 val_auprc:  0.9204429218008452
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7483101088021195 val_auroc:  0.8208149239077075 val_auprc:  0.9220809722980106
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7536081085870222 val_auroc:  0.8281786941580755 val_auprc:  0.9264843684116071
EarlyStopping counter: 3 out of 50
epoch:  22
epoch:  23 val_f1:  0.7831873586549224 val_auroc:  0.8350515463917526 val_auprc:  0.9304534124802253
EarlyStopping counter: 4 out of 50
epoch:  23
epoch:  24 val_f1:  0.7823449348629204 val_auroc:  0.82793323514973 val_auprc:  0.9253767978907371
EarlyStopping counter: 5 out of 50
epoch:  24
epoch:  25 val_f1:  0.7510257046352308 val_auroc:  0.8404516445753559 val_auprc:  0.9342128832091359
EarlyStopping counter: 6 out of 50
epoch:  25
epoch:  26 val_f1:  0.7308672563486676 val_auroc:  0.8424153166421208 val_auprc:  0.9354390811039083
EarlyStopping counter: 7 out of 50
epoch:  26
epoch:  27 val_f1:  0.7954863587533922 val_auroc:  0.8294059891998037 val_auprc:  0.925957738677984
EarlyStopping counter: 8 out of 50
epoch:  27
epoch:  28 val_f1:  0.7963871971298289 val_auroc:  0.8399607265586647 val_auprc:  0.9336211269990503
EarlyStopping counter: 9 out of 50
epoch:  28
epoch:  29 val_f1:  0.7377728985642654 val_auroc:  0.8414334806087383 val_auprc:  0.934382314049481
EarlyStopping counter: 10 out of 50
epoch:  29
epoch:  30 val_f1:  0.7513203127712835 val_auroc:  0.8316151202749141 val_auprc:  0.929195967479999
EarlyStopping counter: 11 out of 50
epoch:  30
epoch:  31 val_f1:  0.7237742540242516 val_auroc:  0.8384879725085911 val_auprc:  0.9349400773176726
EarlyStopping counter: 12 out of 50
epoch:  31
epoch:  32 val_f1:  0.7911956149366222 val_auroc:  0.8294059891998037 val_auprc:  0.9262899206637314
EarlyStopping counter: 13 out of 50
epoch:  32
epoch:  33 val_f1:  0.7897879661118469 val_auroc:  0.836033382425135 val_auprc:  0.9319687493938056
EarlyStopping counter: 14 out of 50
epoch:  33
epoch:  34 val_f1:  0.777854660092151 val_auroc:  0.838487972508591 val_auprc:  0.9333672900901573
EarlyStopping counter: 15 out of 50
epoch:  34
epoch:  35 val_f1:  0.7917387438363913 val_auroc:  0.8313696612665685 val_auprc:  0.9292137716875422
EarlyStopping counter: 16 out of 50
epoch:  35
epoch:  36 val_f1:  0.7831873586549224 val_auroc:  0.8323514972999508 val_auprc:  0.9294108352948799
EarlyStopping counter: 17 out of 50
epoch:  36
epoch:  37 val_f1:  0.7889150110486646 val_auroc:  0.8365243004418262 val_auprc:  0.9321088580080312
EarlyStopping counter: 18 out of 50
epoch:  37
epoch:  38 val_f1:  0.7897879661118469 val_auroc:  0.8328424153166422 val_auprc:  0.930134880698226
EarlyStopping counter: 19 out of 50
epoch:  38
epoch:  39 val_f1:  0.7831873586549224 val_auroc:  0.834806087383407 val_auprc:  0.9311079088599564
EarlyStopping counter: 20 out of 50
epoch:  39
epoch:  40 val_f1:  0.7854414831518974 val_auroc:  0.8397152675503191 val_auprc:  0.9352084887008416
EarlyStopping counter: 21 out of 50
epoch:  40
epoch:  41 val_f1:  0.7963871971298289 val_auroc:  0.8318605792832596 val_auprc:  0.9298962125384337
EarlyStopping counter: 22 out of 50
epoch:  41
epoch:  42 val_f1:  0.7826417810500232 val_auroc:  0.8252331860579284 val_auprc:  0.9253280541044813
EarlyStopping counter: 23 out of 50
epoch:  42
epoch:  43 val_f1:  0.7944676896257205 val_auroc:  0.8316151202749141 val_auprc:  0.9292457233494901
EarlyStopping counter: 24 out of 50
epoch:  43
epoch:  44 val_f1:  0.7644702419882276 val_auroc:  0.8397152675503191 val_auprc:  0.935631360551946
EarlyStopping counter: 25 out of 50
epoch:  44
epoch:  45 val_f1:  0.7831873586549224 val_auroc:  0.8387334315169367 val_auprc:  0.9349553715553055
EarlyStopping counter: 26 out of 50
epoch:  45
epoch:  46 val_f1:  0.8038021017043906 val_auroc:  0.8419243986254296 val_auprc:  0.9367767479903191
EarlyStopping counter: 27 out of 50
epoch:  46
epoch:  47 val_f1:  0.798430833799187 val_auroc:  0.8333333333333334 val_auprc:  0.9308356669378192
EarlyStopping counter: 28 out of 50
epoch:  47
epoch:  48 val_f1:  0.7911956149366222 val_auroc:  0.8365243004418262 val_auprc:  0.9338270034258318
EarlyStopping counter: 29 out of 50
epoch:  48
epoch:  49 val_f1:  0.7954863587533922 val_auroc:  0.8318605792832597 val_auprc:  0.9298327911699447
EarlyStopping counter: 30 out of 50
epoch:  49
epoch:  50 val_f1:  0.7954863587533922 val_auroc:  0.8357879234167894 val_auprc:  0.9321313323819528
EarlyStopping counter: 31 out of 50
epoch:  50
epoch:  51 val_f1:  0.8029873436454202 val_auroc:  0.8365243004418262 val_auprc:  0.93280541804407
EarlyStopping counter: 32 out of 50
epoch:  51
epoch:  52 val_f1:  0.7897879661118469 val_auroc:  0.8377515954835543 val_auprc:  0.934555800835575
EarlyStopping counter: 33 out of 50
epoch:  52
epoch:  53 val_f1:  0.7802930475309426 val_auroc:  0.8323514972999508 val_auprc:  0.9304754304309464
EarlyStopping counter: 34 out of 50
epoch:  53
epoch:  54 val_f1:  0.7879228532067962 val_auroc:  0.8345606283750614 val_auprc:  0.9316985201640942
EarlyStopping counter: 35 out of 50
epoch:  54
epoch:  55 val_f1:  0.7933255489848959 val_auroc:  0.8321060382916053 val_auprc:  0.92917800365345
EarlyStopping counter: 36 out of 50
epoch:  55
epoch:  56 val_f1:  0.7855581813618873 val_auroc:  0.8274423171330388 val_auprc:  0.9261398722926071
EarlyStopping counter: 37 out of 50
epoch:  56
epoch:  57 val_f1:  0.7802930475309426 val_auroc:  0.8355424644084438 val_auprc:  0.9317864595202983
EarlyStopping counter: 38 out of 50
epoch:  57
epoch:  58 val_f1:  0.7802930475309426 val_auroc:  0.8318605792832596 val_auprc:  0.9298773902060318
EarlyStopping counter: 39 out of 50
epoch:  58
epoch:  59 val_f1:  0.8104294593967373 val_auroc:  0.8355424644084438 val_auprc:  0.932563855973203
EarlyStopping counter: 40 out of 50
epoch:  59
epoch:  60 val_f1:  0.7954863587533922 val_auroc:  0.836033382425135 val_auprc:  0.9328469738252991
EarlyStopping counter: 41 out of 50
epoch:  60
epoch:  61 val_f1:  0.7802930475309426 val_auroc:  0.8352970054000982 val_auprc:  0.9319314783107231
EarlyStopping counter: 42 out of 50
epoch:  61
epoch:  62 val_f1:  0.7933255489848959 val_auroc:  0.8306332842415316 val_auprc:  0.928628110301525
EarlyStopping counter: 43 out of 50
epoch:  62
epoch:  63 val_f1:  0.7868059619290214 val_auroc:  0.8330878743249878 val_auprc:  0.9303822003178676
EarlyStopping counter: 44 out of 50
epoch:  63
epoch:  64 val_f1:  0.7802930475309426 val_auroc:  0.8352970054000982 val_auprc:  0.9318046714686284
EarlyStopping counter: 45 out of 50
epoch:  64
epoch:  65 val_f1:  0.7868059619290214 val_auroc:  0.833578792341679 val_auprc:  0.9309064317383916
EarlyStopping counter: 46 out of 50
epoch:  65
epoch:  66 val_f1:  0.7868059619290214 val_auroc:  0.8306332842415317 val_auprc:  0.9286225601813078
EarlyStopping counter: 47 out of 50
epoch:  66
epoch:  67 val_f1:  0.7802930475309426 val_auroc:  0.8303878252331861 val_auprc:  0.9292124856917735
EarlyStopping counter: 48 out of 50
epoch:  67
epoch:  68 val_f1:  0.7802930475309426 val_auroc:  0.8330878743249878 val_auprc:  0.9306813349252834
EarlyStopping counter: 49 out of 50
epoch:  68
epoch:  69 val_f1:  0.7868059619290214 val_auroc:  0.8325969563082966 val_auprc:  0.9306156009372497
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  531.6130352020264
{'time_elapsed': [531.6130352020264], 'epoch': [68], 'fold': [0], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7868059619290214], 'auroc_test': [0.8325969563082966], 'auprc_test': [0.9306156009372497]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1276]           2,048
│    └─BatchNorm1d: 2-2                  [64, 256, 1276]           512
│    └─Tanh: 2-3                         [64, 256, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1270]           --
│    └─Dropout: 2-5                      [64, 256, 1270]           --
│    └─Flatten: 2-6                      [64, 325120]              --
│    └─Linear: 2-7                       [64, 1]                   325,121
==========================================================================================
Total params: 327,681
Trainable params: 327,681
Non-trainable params: 0
Total mult-adds (M): 188.09
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 334.50
Params size (MB): 1.31
Estimated Total Size (MB): 336.13
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.2660670936703906 val_auroc:  0.6467844869906725 val_auprc:  0.8504241357025298
epoch:  1
epoch:  2 val_f1:  0.6072007259057618 val_auroc:  0.6135247913598428 val_auprc:  0.8278329058706286
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.499774526580479 val_auroc:  0.6097201767304861 val_auprc:  0.8248274994511038
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5750274565939015 val_auroc:  0.6595483554246441 val_auprc:  0.8578661561982397
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6548643438190624 val_auroc:  0.6919489445262641 val_auprc:  0.8746544098780984
Validation loss improved to 1.156891
epoch:  5
epoch:  6 val_f1:  0.7099629667254643 val_auroc:  0.7638684339715267 val_auprc:  0.9036470831248069
Validation loss improved to 0.706861
epoch:  6
epoch:  7 val_f1:  0.7455074238481555 val_auroc:  0.7908689248895434 val_auprc:  0.8999390796876297
Validation loss improved to 0.345283
epoch:  7
epoch:  8 val_f1:  0.7622262794246104 val_auroc:  0.7862052037309769 val_auprc:  0.8661935490132875
Validation loss improved to 0.266477
epoch:  8
epoch:  9 val_f1:  0.7648187281552264 val_auroc:  0.8031418753068238 val_auprc:  0.9103498121165592
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7506155503404762 val_auroc:  0.8109965635738832 val_auprc:  0.9251994834324773
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.7506155503404762 val_auroc:  0.806823760432008 val_auprc:  0.9223199807440442
EarlyStopping counter: 3 out of 50
epoch:  11
epoch:  12 val_f1:  0.7757738305193033 val_auroc:  0.8156602847324498 val_auprc:  0.9235306903075045
EarlyStopping counter: 4 out of 50
epoch:  12
epoch:  13 val_f1:  0.7911956149366222 val_auroc:  0.8195876288659795 val_auprc:  0.9254057019953815
EarlyStopping counter: 5 out of 50
epoch:  13
epoch:  14 val_f1:  0.7765831291011147 val_auroc:  0.8220422189494354 val_auprc:  0.9233542289759669
EarlyStopping counter: 6 out of 50
epoch:  14
epoch:  15 val_f1:  0.797855125935135 val_auroc:  0.8215513009327443 val_auprc:  0.924534143243364
EarlyStopping counter: 7 out of 50
epoch:  15
epoch:  16 val_f1:  0.8051159072741806 val_auroc:  0.8259695630829651 val_auprc:  0.92529044075612
EarlyStopping counter: 8 out of 50
epoch:  16
epoch:  17 val_f1:  0.6887363496684735 val_auroc:  0.8242513500245459 val_auprc:  0.927499729800924
EarlyStopping counter: 9 out of 50
epoch:  17
epoch:  18 val_f1:  0.778324933635979 val_auroc:  0.8252331860579284 val_auprc:  0.9257205424735362
EarlyStopping counter: 10 out of 50
epoch:  18
epoch:  19 val_f1:  0.7889150110486646 val_auroc:  0.8237604320078546 val_auprc:  0.922828824067915
EarlyStopping counter: 11 out of 50
epoch:  19
epoch:  20 val_f1:  0.7067808808208037 val_auroc:  0.8306332842415317 val_auprc:  0.9233629147029079
Validation loss improved to 0.239124
epoch:  20
epoch:  21 val_f1:  0.7226305629385982 val_auroc:  0.8274423171330388 val_auprc:  0.9235087421188883
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7386752666832053 val_auroc:  0.8195876288659794 val_auprc:  0.9171873811397246
Validation loss improved to 0.221277
epoch:  22
epoch:  23 val_f1:  0.8038021017043906 val_auroc:  0.8249877270495827 val_auprc:  0.9246395360254094
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7510257046352308 val_auroc:  0.82793323514973 val_auprc:  0.9249424622082376
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.7911956149366222 val_auroc:  0.822287677957781 val_auprc:  0.9212432832965838
EarlyStopping counter: 3 out of 50
epoch:  25
epoch:  26 val_f1:  0.7868059619290214 val_auroc:  0.8240058910162004 val_auprc:  0.9219603997947028
EarlyStopping counter: 4 out of 50
epoch:  26
epoch:  27 val_f1:  0.7868059619290214 val_auroc:  0.8333333333333333 val_auprc:  0.9262233865763981
EarlyStopping counter: 5 out of 50
epoch:  27
epoch:  28 val_f1:  0.7963871971298289 val_auroc:  0.8345606283750614 val_auprc:  0.9273585330320957
EarlyStopping counter: 6 out of 50
epoch:  28
epoch:  29 val_f1:  0.7809570525397864 val_auroc:  0.8311242022582228 val_auprc:  0.9218839449189171
Validation loss improved to 0.208410
epoch:  29
epoch:  30 val_f1:  0.7707245329923307 val_auroc:  0.8343151693667158 val_auprc:  0.9243516113691912
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7536081085870222 val_auroc:  0.8330878743249878 val_auprc:  0.9229686596318177
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.7330561760022478 val_auroc:  0.8294059891998036 val_auprc:  0.9216125523010924
EarlyStopping counter: 3 out of 50
epoch:  32
epoch:  33 val_f1:  0.8029873436454202 val_auroc:  0.8384879725085911 val_auprc:  0.9278743960538196
EarlyStopping counter: 4 out of 50
epoch:  33
epoch:  34 val_f1:  0.8029873436454202 val_auroc:  0.8357879234167894 val_auprc:  0.92683032989334
EarlyStopping counter: 5 out of 50
epoch:  34
epoch:  35 val_f1:  0.7777125328082551 val_auroc:  0.832351497299951 val_auprc:  0.9237388884890966
EarlyStopping counter: 6 out of 50
epoch:  35
epoch:  36 val_f1:  0.8020613296596766 val_auroc:  0.8338242513500246 val_auprc:  0.9245258956144218
EarlyStopping counter: 7 out of 50
epoch:  36
epoch:  37 val_f1:  0.7536081085870222 val_auroc:  0.8328424153166422 val_auprc:  0.921514423292783
Validation loss improved to 0.202294
epoch:  37
epoch:  38 val_f1:  0.7963871971298289 val_auroc:  0.8306332842415316 val_auprc:  0.9226792234438752
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.7905466835322951 val_auroc:  0.8298969072164949 val_auprc:  0.9248303646556417
EarlyStopping counter: 2 out of 50
epoch:  39
epoch:  40 val_f1:  0.7868059619290214 val_auroc:  0.8325969563082964 val_auprc:  0.92270331250236
EarlyStopping counter: 3 out of 50
epoch:  40
epoch:  41 val_f1:  0.7384802450563926 val_auroc:  0.8409425625920471 val_auprc:  0.924095717570625
Validation loss improved to 0.178907
epoch:  41
epoch:  42 val_f1:  0.7324246948924567 val_auroc:  0.8340697103583702 val_auprc:  0.9212793937773944
Validation loss improved to 0.178494
epoch:  42
epoch:  43 val_f1:  0.7831873586549224 val_auroc:  0.8298969072164949 val_auprc:  0.9247826841542517
EarlyStopping counter: 1 out of 50
epoch:  43
epoch:  44 val_f1:  0.7911956149366222 val_auroc:  0.8330878743249878 val_auprc:  0.9259434565168365
EarlyStopping counter: 2 out of 50
epoch:  44
epoch:  45 val_f1:  0.7791090204759269 val_auroc:  0.8298969072164949 val_auprc:  0.9206890575302226
EarlyStopping counter: 3 out of 50
epoch:  45
epoch:  46 val_f1:  0.7727225509205256 val_auroc:  0.8367697594501718 val_auprc:  0.9223246893915975
EarlyStopping counter: 4 out of 50
epoch:  46
epoch:  47 val_f1:  0.7748796193569787 val_auroc:  0.8365243004418262 val_auprc:  0.9219596399041365
EarlyStopping counter: 5 out of 50
epoch:  47
epoch:  48 val_f1:  0.8020613296596766 val_auroc:  0.8303878252331861 val_auprc:  0.9224347071490004
EarlyStopping counter: 6 out of 50
epoch:  48
epoch:  49 val_f1:  0.797175270999766 val_auroc:  0.8269513991163475 val_auprc:  0.9215502088360903
EarlyStopping counter: 7 out of 50
epoch:  49
epoch:  50 val_f1:  0.7712620601193464 val_auroc:  0.8259695630829651 val_auprc:  0.917680955913842
EarlyStopping counter: 8 out of 50
epoch:  50
epoch:  51 val_f1:  0.7391671278361928 val_auroc:  0.832351497299951 val_auprc:  0.9168856216557214
Validation loss improved to 0.165503
epoch:  51
epoch:  52 val_f1:  0.7727225509205256 val_auroc:  0.8291605301914581 val_auprc:  0.9193564633804672
EarlyStopping counter: 1 out of 50
epoch:  52
epoch:  53 val_f1:  0.7725930260576229 val_auroc:  0.8267059401080019 val_auprc:  0.9193597078657871
EarlyStopping counter: 2 out of 50
epoch:  53
epoch:  54 val_f1:  0.7712620601193464 val_auroc:  0.8321060382916052 val_auprc:  0.9212417743682931
EarlyStopping counter: 3 out of 50
epoch:  54
epoch:  55 val_f1:  0.7536081085870222 val_auroc:  0.8301423662248404 val_auprc:  0.9178633228648961
EarlyStopping counter: 4 out of 50
epoch:  55
epoch:  56 val_f1:  0.7536081085870222 val_auroc:  0.8274423171330387 val_auprc:  0.9166204335155365
EarlyStopping counter: 5 out of 50
epoch:  56
epoch:  57 val_f1:  0.7868059619290214 val_auroc:  0.8284241531664213 val_auprc:  0.9183918997076317
EarlyStopping counter: 6 out of 50
epoch:  57
epoch:  58 val_f1:  0.7790721385700611 val_auroc:  0.8276877761413844 val_auprc:  0.917709613176112
EarlyStopping counter: 7 out of 50
epoch:  58
epoch:  59 val_f1:  0.757304835743056 val_auroc:  0.8313696612665684 val_auprc:  0.9179579495155116
Validation loss improved to 0.159380
epoch:  59
epoch:  60 val_f1:  0.7727225509205256 val_auroc:  0.8254786450662739 val_auprc:  0.9156240009607133
EarlyStopping counter: 1 out of 50
epoch:  60
epoch:  61 val_f1:  0.7681512331200245 val_auroc:  0.823514972999509 val_auprc:  0.9158577359358975
EarlyStopping counter: 2 out of 50
epoch:  61
epoch:  62 val_f1:  0.7580594896895918 val_auroc:  0.8313696612665684 val_auprc:  0.917933207917609
EarlyStopping counter: 3 out of 50
epoch:  62
epoch:  63 val_f1:  0.7745465218349855 val_auroc:  0.8328424153166422 val_auprc:  0.9175599188570502
EarlyStopping counter: 4 out of 50
epoch:  63
epoch:  64 val_f1:  0.7790721385700611 val_auroc:  0.8249877270495826 val_auprc:  0.9176534378993454
EarlyStopping counter: 5 out of 50
epoch:  64
epoch:  65 val_f1:  0.7725930260576229 val_auroc:  0.8237604320078548 val_auprc:  0.9162143227395344
EarlyStopping counter: 6 out of 50
epoch:  65
epoch:  66 val_f1:  0.7841726618705036 val_auroc:  0.829160530191458 val_auprc:  0.9173196201978289
EarlyStopping counter: 7 out of 50
epoch:  66
epoch:  67 val_f1:  0.7762067639678805 val_auroc:  0.8271968581246931 val_auprc:  0.9170679163761201
EarlyStopping counter: 8 out of 50
epoch:  67
epoch:  68 val_f1:  0.7622262794246104 val_auroc:  0.8291605301914581 val_auprc:  0.9172242143826355
EarlyStopping counter: 9 out of 50
epoch:  68
epoch:  69 val_f1:  0.766354189375772 val_auroc:  0.8279332351497299 val_auprc:  0.9166949917928376
EarlyStopping counter: 10 out of 50
epoch:  69
epoch:  70 val_f1:  0.7559325673789327 val_auroc:  0.8271968581246932 val_auprc:  0.9150734000726071
EarlyStopping counter: 11 out of 50
epoch:  70
epoch:  71 val_f1:  0.7536081085870222 val_auroc:  0.8286696121747669 val_auprc:  0.9151497630323105
EarlyStopping counter: 12 out of 50
epoch:  71
epoch:  72 val_f1:  0.757304835743056 val_auroc:  0.8296514482081492 val_auprc:  0.9166224215993712
EarlyStopping counter: 13 out of 50
epoch:  72
epoch:  73 val_f1:  0.757304835743056 val_auroc:  0.8281786941580755 val_auprc:  0.9158006604175983
Validation loss improved to 0.154308
epoch:  73
epoch:  74 val_f1:  0.7559325673789327 val_auroc:  0.8276877761413844 val_auprc:  0.9155150127036824
EarlyStopping counter: 1 out of 50
epoch:  74
epoch:  75 val_f1:  0.76000113614692 val_auroc:  0.825478645066274 val_auprc:  0.9145586035105284
EarlyStopping counter: 2 out of 50
epoch:  75
epoch:  76 val_f1:  0.7712620601193464 val_auroc:  0.8257241040746195 val_auprc:  0.9167622064729901
EarlyStopping counter: 3 out of 50
epoch:  76
epoch:  77 val_f1:  0.7790721385700611 val_auroc:  0.8227785959744723 val_auprc:  0.9148408285891078
EarlyStopping counter: 4 out of 50
epoch:  77
epoch:  78 val_f1:  0.7685409504908388 val_auroc:  0.8208149239077075 val_auprc:  0.9093369391222018
EarlyStopping counter: 5 out of 50
epoch:  78
epoch:  79 val_f1:  0.7724732835091151 val_auroc:  0.8200785468826706 val_auprc:  0.9087555339914527
Validation loss improved to 0.150679
epoch:  79
epoch:  80 val_f1:  0.7536081085870222 val_auroc:  0.822287677957781 val_auprc:  0.9114711844335346
EarlyStopping counter: 1 out of 50
epoch:  80
epoch:  81 val_f1:  0.7473654218886486 val_auroc:  0.8271968581246932 val_auprc:  0.9143327887235922
EarlyStopping counter: 2 out of 50
epoch:  81
epoch:  82 val_f1:  0.7411406017655346 val_auroc:  0.8274423171330388 val_auprc:  0.9141365854135337
EarlyStopping counter: 3 out of 50
epoch:  82
epoch:  83 val_f1:  0.7473654218886486 val_auroc:  0.82486499754541 val_auprc:  0.9129069423992145
EarlyStopping counter: 4 out of 50
epoch:  83
epoch:  84 val_f1:  0.7473654218886486 val_auroc:  0.823514972999509 val_auprc:  0.911400286907246
EarlyStopping counter: 5 out of 50
epoch:  84
epoch:  85 val_f1:  0.7559325673789327 val_auroc:  0.825478645066274 val_auprc:  0.9123716406850751
EarlyStopping counter: 6 out of 50
epoch:  85
epoch:  86 val_f1:  0.766354189375772 val_auroc:  0.8240058910162003 val_auprc:  0.9133668142469002
EarlyStopping counter: 7 out of 50
epoch:  86
epoch:  87 val_f1:  0.7855581813618873 val_auroc:  0.8203240058910162 val_auprc:  0.9118338729557909
EarlyStopping counter: 8 out of 50
epoch:  87
epoch:  88 val_f1:  0.7933255489848959 val_auroc:  0.822287677957781 val_auprc:  0.9120434198600511
EarlyStopping counter: 9 out of 50
epoch:  88
epoch:  89 val_f1:  0.7580594896895918 val_auroc:  0.8217967599410898 val_auprc:  0.9111678914074215
EarlyStopping counter: 10 out of 50
epoch:  89
epoch:  90 val_f1:  0.766354189375772 val_auroc:  0.8225331369661266 val_auprc:  0.9119497209543332
EarlyStopping counter: 11 out of 50
epoch:  90
epoch:  91 val_f1:  0.7559325673789327 val_auroc:  0.822287677957781 val_auprc:  0.9111900527606565
EarlyStopping counter: 12 out of 50
epoch:  91
epoch:  92 val_f1:  0.7559325673789327 val_auroc:  0.8227785959744722 val_auprc:  0.9115742162747524
EarlyStopping counter: 13 out of 50
epoch:  92
epoch:  93 val_f1:  0.766354189375772 val_auroc:  0.8220422189494355 val_auprc:  0.9122021414489887
EarlyStopping counter: 14 out of 50
epoch:  93
epoch:  94 val_f1:  0.7580594896895918 val_auroc:  0.8217967599410899 val_auprc:  0.9115966697017437
EarlyStopping counter: 15 out of 50
epoch:  94
epoch:  95 val_f1:  0.7841726618705036 val_auroc:  0.8225331369661267 val_auprc:  0.9124019476268754
EarlyStopping counter: 16 out of 50
epoch:  95
epoch:  96 val_f1:  0.7559325673789327 val_auroc:  0.8217967599410899 val_auprc:  0.9107636278963873
EarlyStopping counter: 17 out of 50
epoch:  96
epoch:  97 val_f1:  0.7536081085870222 val_auroc:  0.8233922434953364 val_auprc:  0.9098328557544876
EarlyStopping counter: 18 out of 50
epoch:  97
epoch:  98 val_f1:  0.7473654218886486 val_auroc:  0.8227785959744723 val_auprc:  0.9095813231077723
EarlyStopping counter: 19 out of 50
epoch:  98
epoch:  99 val_f1:  0.7473654218886486 val_auroc:  0.8217967599410898 val_auprc:  0.9093657913966247
EarlyStopping counter: 20 out of 50
epoch:  99
epoch:  100 val_f1:  0.7559325673789327 val_auroc:  0.8203240058910163 val_auprc:  0.9091682611162827
EarlyStopping counter: 21 out of 50
epoch:  100
epoch:  101 val_f1:  0.7473654218886486 val_auroc:  0.821674030436917 val_auprc:  0.9094880374840055
EarlyStopping counter: 22 out of 50
epoch:  101
epoch:  102 val_f1:  0.7559325673789327 val_auroc:  0.8230240549828179 val_auprc:  0.9105517286242347
EarlyStopping counter: 23 out of 50
epoch:  102
epoch:  103 val_f1:  0.7559325673789327 val_auroc:  0.8203240058910162 val_auprc:  0.9083580771764945
EarlyStopping counter: 24 out of 50
epoch:  103
epoch:  104 val_f1:  0.7473654218886486 val_auroc:  0.8232695139911634 val_auprc:  0.9105291884942375
EarlyStopping counter: 25 out of 50
epoch:  104
epoch:  105 val_f1:  0.7473654218886486 val_auroc:  0.8217967599410899 val_auprc:  0.909551307010627
EarlyStopping counter: 26 out of 50
epoch:  105
epoch:  106 val_f1:  0.7473654218886486 val_auroc:  0.8215513009327442 val_auprc:  0.908571340885295
EarlyStopping counter: 27 out of 50
epoch:  106
epoch:  107 val_f1:  0.7496568898727172 val_auroc:  0.823514972999509 val_auprc:  0.9122963772486751
EarlyStopping counter: 28 out of 50
epoch:  107
epoch:  108 val_f1:  0.7496568898727172 val_auroc:  0.823514972999509 val_auprc:  0.9112287573955873
EarlyStopping counter: 29 out of 50
epoch:  108
epoch:  109 val_f1:  0.7777125328082551 val_auroc:  0.8215513009327443 val_auprc:  0.9116102817395679
EarlyStopping counter: 30 out of 50
epoch:  109
epoch:  110 val_f1:  0.7841726618705036 val_auroc:  0.8200785468826706 val_auprc:  0.9096709024247689
EarlyStopping counter: 31 out of 50
epoch:  110
epoch:  111 val_f1:  0.7712620601193464 val_auroc:  0.8176239567992145 val_auprc:  0.9085567527476075
EarlyStopping counter: 32 out of 50
epoch:  111
epoch:  112 val_f1:  0.751751326211758 val_auroc:  0.8230240549828178 val_auprc:  0.9122434968019206
EarlyStopping counter: 33 out of 50
epoch:  112
epoch:  113 val_f1:  0.7745465218349855 val_auroc:  0.8225331369661267 val_auprc:  0.9120242804235112
EarlyStopping counter: 34 out of 50
epoch:  113
epoch:  114 val_f1:  0.7473654218886486 val_auroc:  0.8222876779577811 val_auprc:  0.9098493536381028
EarlyStopping counter: 35 out of 50
epoch:  114
epoch:  115 val_f1:  0.7598715939807772 val_auroc:  0.8211831124202258 val_auprc:  0.9075775283407423
EarlyStopping counter: 36 out of 50
epoch:  115
epoch:  116 val_f1:  0.7536081085870222 val_auroc:  0.8230240549828178 val_auprc:  0.9102747639254055
EarlyStopping counter: 37 out of 50
epoch:  116
epoch:  117 val_f1:  0.7598715939807772 val_auroc:  0.8230240549828179 val_auprc:  0.9097809708298796
Validation loss improved to 0.149789
epoch:  117
epoch:  118 val_f1:  0.7643829551743221 val_auroc:  0.8233922434953362 val_auprc:  0.9110838714544857
EarlyStopping counter: 1 out of 50
epoch:  118
epoch:  119 val_f1:  0.7559325673789327 val_auroc:  0.8220422189494355 val_auprc:  0.9098687540625624
EarlyStopping counter: 2 out of 50
epoch:  119
epoch:  120 val_f1:  0.7536081085870222 val_auroc:  0.820446735395189 val_auprc:  0.9067113558753525
EarlyStopping counter: 3 out of 50
epoch:  120
epoch:  121 val_f1:  0.7559325673789327 val_auroc:  0.8213058419243986 val_auprc:  0.9095102291423685
EarlyStopping counter: 4 out of 50
epoch:  121
epoch:  122 val_f1:  0.766354189375772 val_auroc:  0.8205694648993619 val_auprc:  0.9092130441768613
EarlyStopping counter: 5 out of 50
epoch:  122
epoch:  123 val_f1:  0.7826417810500232 val_auroc:  0.8203240058910162 val_auprc:  0.9092151990410847
EarlyStopping counter: 6 out of 50
epoch:  123
epoch:  124 val_f1:  0.7496568898727172 val_auroc:  0.8230240549828178 val_auprc:  0.9107442089839709
EarlyStopping counter: 7 out of 50
epoch:  124
epoch:  125 val_f1:  0.7496568898727172 val_auroc:  0.8222876779577811 val_auprc:  0.9101157479807328
EarlyStopping counter: 8 out of 50
epoch:  125
epoch:  126 val_f1:  0.7559325673789327 val_auroc:  0.822287677957781 val_auprc:  0.9099785848601516
EarlyStopping counter: 9 out of 50
epoch:  126
epoch:  127 val_f1:  0.7559325673789327 val_auroc:  0.8225331369661266 val_auprc:  0.9100070364117974
EarlyStopping counter: 10 out of 50
epoch:  127
epoch:  128 val_f1:  0.7580594896895918 val_auroc:  0.8205694648993619 val_auprc:  0.9092251710713586
EarlyStopping counter: 11 out of 50
epoch:  128
epoch:  129 val_f1:  0.7559325673789327 val_auroc:  0.8217967599410898 val_auprc:  0.9094228055202618
EarlyStopping counter: 12 out of 50
epoch:  129
epoch:  130 val_f1:  0.7559325673789327 val_auroc:  0.8220422189494355 val_auprc:  0.9098865795874045
EarlyStopping counter: 13 out of 50
epoch:  130
epoch:  131 val_f1:  0.7473654218886486 val_auroc:  0.8215513009327442 val_auprc:  0.9088871939602532
EarlyStopping counter: 14 out of 50
epoch:  131
epoch:  132 val_f1:  0.7496568898727172 val_auroc:  0.8217967599410898 val_auprc:  0.9094604218744408
EarlyStopping counter: 15 out of 50
epoch:  132
epoch:  133 val_f1:  0.7496568898727172 val_auroc:  0.8213058419243986 val_auprc:  0.9094347751274505
EarlyStopping counter: 16 out of 50
epoch:  133
epoch:  134 val_f1:  0.7841726618705036 val_auroc:  0.8193421698576338 val_auprc:  0.909083047169202
EarlyStopping counter: 17 out of 50
epoch:  134
epoch:  135 val_f1:  0.7559325673789327 val_auroc:  0.8205694648993618 val_auprc:  0.9083831126799273
EarlyStopping counter: 18 out of 50
epoch:  135
epoch:  136 val_f1:  0.7536081085870222 val_auroc:  0.8200785468826706 val_auprc:  0.9070117856317479
EarlyStopping counter: 19 out of 50
epoch:  136
epoch:  137 val_f1:  0.7559325673789327 val_auroc:  0.8200785468826706 val_auprc:  0.9078641603358507
EarlyStopping counter: 20 out of 50
epoch:  137
epoch:  138 val_f1:  0.7496568898727172 val_auroc:  0.8208149239077074 val_auprc:  0.9087901387160607
EarlyStopping counter: 21 out of 50
epoch:  138
epoch:  139 val_f1:  0.7559325673789327 val_auroc:  0.8208149239077074 val_auprc:  0.9087632731572499
EarlyStopping counter: 22 out of 50
epoch:  139
epoch:  140 val_f1:  0.7496568898727172 val_auroc:  0.8200785468826706 val_auprc:  0.9084772124276401
EarlyStopping counter: 23 out of 50
epoch:  140
epoch:  141 val_f1:  0.7580594896895918 val_auroc:  0.822287677957781 val_auprc:  0.9100128041442344
EarlyStopping counter: 24 out of 50
epoch:  141
epoch:  142 val_f1:  0.766354189375772 val_auroc:  0.8215513009327442 val_auprc:  0.9097162754981326
EarlyStopping counter: 25 out of 50
epoch:  142
epoch:  143 val_f1:  0.7826417810500232 val_auroc:  0.8205694648993618 val_auprc:  0.9090474592343953
EarlyStopping counter: 26 out of 50
epoch:  143
epoch:  144 val_f1:  0.7496568898727172 val_auroc:  0.8222876779577811 val_auprc:  0.9096714125018253
EarlyStopping counter: 27 out of 50
epoch:  144
epoch:  145 val_f1:  0.7536081085870222 val_auroc:  0.8211831124202258 val_auprc:  0.9081631717525228
EarlyStopping counter: 28 out of 50
epoch:  145
epoch:  146 val_f1:  0.7580594896895918 val_auroc:  0.8217967599410897 val_auprc:  0.9095178963261219
EarlyStopping counter: 29 out of 50
epoch:  146
epoch:  147 val_f1:  0.7622262794246104 val_auroc:  0.8200785468826706 val_auprc:  0.9062236507823295
EarlyStopping counter: 30 out of 50
epoch:  147
epoch:  148 val_f1:  0.7496568898727172 val_auroc:  0.8203240058910162 val_auprc:  0.9084657829020397
EarlyStopping counter: 31 out of 50
epoch:  148
epoch:  149 val_f1:  0.7496568898727172 val_auroc:  0.8220422189494354 val_auprc:  0.9096247748470531
EarlyStopping counter: 32 out of 50
epoch:  149
epoch:  150 val_f1:  0.7559325673789327 val_auroc:  0.8206921944035347 val_auprc:  0.90797024657215
EarlyStopping counter: 33 out of 50
epoch:  150
epoch:  151 val_f1:  0.766354189375772 val_auroc:  0.8203240058910162 val_auprc:  0.9087818952210216
EarlyStopping counter: 34 out of 50
epoch:  151
epoch:  152 val_f1:  0.7559325673789327 val_auroc:  0.8202012763868435 val_auprc:  0.9071886850723558
EarlyStopping counter: 35 out of 50
epoch:  152
epoch:  153 val_f1:  0.7559325673789327 val_auroc:  0.8199558173784978 val_auprc:  0.9074709218107357
EarlyStopping counter: 36 out of 50
epoch:  153
epoch:  154 val_f1:  0.7826417810500232 val_auroc:  0.8200785468826706 val_auprc:  0.90865057499024
EarlyStopping counter: 37 out of 50
epoch:  154
epoch:  155 val_f1:  0.7559325673789327 val_auroc:  0.8208149239077074 val_auprc:  0.9073555335101151
EarlyStopping counter: 38 out of 50
epoch:  155
epoch:  156 val_f1:  0.7559325673789327 val_auroc:  0.8209376534118802 val_auprc:  0.9081602589795702
EarlyStopping counter: 39 out of 50
epoch:  156
epoch:  157 val_f1:  0.766354189375772 val_auroc:  0.8203240058910163 val_auprc:  0.908781861708327
EarlyStopping counter: 40 out of 50
epoch:  157
epoch:  158 val_f1:  0.7559325673789327 val_auroc:  0.8214285714285714 val_auprc:  0.9085019358542428
EarlyStopping counter: 41 out of 50
epoch:  158
epoch:  159 val_f1:  0.7496568898727172 val_auroc:  0.820446735395189 val_auprc:  0.9081098875856953
EarlyStopping counter: 42 out of 50
epoch:  159
epoch:  160 val_f1:  0.7559325673789327 val_auroc:  0.8214285714285714 val_auprc:  0.9089416200021774
EarlyStopping counter: 43 out of 50
epoch:  160
epoch:  161 val_f1:  0.7559325673789327 val_auroc:  0.8217967599410898 val_auprc:  0.9087961220109971
EarlyStopping counter: 44 out of 50
epoch:  161
epoch:  162 val_f1:  0.7580594896895918 val_auroc:  0.8203240058910162 val_auprc:  0.9086695831997211
EarlyStopping counter: 45 out of 50
epoch:  162
epoch:  163 val_f1:  0.7496568898727172 val_auroc:  0.8211831124202258 val_auprc:  0.908409708935418
EarlyStopping counter: 46 out of 50
epoch:  163
epoch:  164 val_f1:  0.7559325673789327 val_auroc:  0.8204467353951891 val_auprc:  0.9069360960276379
EarlyStopping counter: 47 out of 50
epoch:  164
epoch:  165 val_f1:  0.7496568898727172 val_auroc:  0.8211831124202259 val_auprc:  0.9087426310020359
EarlyStopping counter: 48 out of 50
epoch:  165
epoch:  166 val_f1:  0.7559325673789327 val_auroc:  0.8208149239077074 val_auprc:  0.9078566714717645
EarlyStopping counter: 49 out of 50
epoch:  166
epoch:  167 val_f1:  0.7643829551743221 val_auroc:  0.8216740304369171 val_auprc:  0.9087610397303153
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1263.6901364326477
{'time_elapsed': [1263.6901364326477], 'epoch': [166], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7643829551743221], 'auroc_test': [0.8216740304369171], 'auprc_test': [0.9087610397303153]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1276]           2,048
│    └─BatchNorm1d: 2-2                  [64, 256, 1276]           512
│    └─Tanh: 2-3                         [64, 256, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1270]           --
│    └─Dropout: 2-5                      [64, 256, 1270]           --
│    └─Flatten: 2-6                      [64, 325120]              --
│    └─Linear: 2-7                       [64, 1]                   325,121
==========================================================================================
Total params: 327,681
Trainable params: 327,681
Non-trainable params: 0
Total mult-adds (M): 188.09
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 334.50
Params size (MB): 1.31
Estimated Total Size (MB): 336.13
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.5466372115856651 val_auprc:  0.7713667031162356
epoch:  1
epoch:  2 val_f1:  0.570151538343793 val_auroc:  0.6056701030927835 val_auprc:  0.79791298354608
Validation loss improved to 0.984639
epoch:  2
epoch:  3 val_f1:  0.4593489387594402 val_auroc:  0.6158566519391262 val_auprc:  0.8170437317755722
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6409065302315272 val_auroc:  0.7010309278350515 val_auprc:  0.8597387034426115
Validation loss improved to 0.545479
epoch:  4
epoch:  5 val_f1:  0.6340426920637616 val_auroc:  0.7098674521354933 val_auprc:  0.8476743800174604
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.6885440884463027 val_auroc:  0.7479135984290624 val_auprc:  0.8669193401031796
Validation loss improved to 0.533489
epoch:  6
epoch:  7 val_f1:  0.6301488691399822 val_auroc:  0.7790868924889542 val_auprc:  0.8888837445395898
Validation loss improved to 0.447476
epoch:  7
epoch:  8 val_f1:  0.6072781774580336 val_auroc:  0.7685321551300932 val_auprc:  0.8829934849990216
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.6451024231755431 val_auroc:  0.7633775159548356 val_auprc:  0.8791096026214273
Validation loss improved to 0.420823
epoch:  9
epoch:  10 val_f1:  0.7428255465713769 val_auroc:  0.7778595974472263 val_auprc:  0.8892769137144936
Validation loss improved to 0.343127
epoch:  10
epoch:  11 val_f1:  0.7337314237416728 val_auroc:  0.7938144329896908 val_auprc:  0.8976099202041541
Validation loss improved to 0.313579
epoch:  11
epoch:  12 val_f1:  0.7299542184434271 val_auroc:  0.780559646539028 val_auprc:  0.888893716811192
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7346891520614657 val_auroc:  0.7920962199312714 val_auprc:  0.8954626698278935
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.7229061670449737 val_auroc:  0.7876779577810507 val_auprc:  0.8937975470290447
EarlyStopping counter: 3 out of 50
epoch:  14
epoch:  15 val_f1:  0.7272357092755477 val_auroc:  0.7859597447226314 val_auprc:  0.8933061174851915
EarlyStopping counter: 4 out of 50
epoch:  15
epoch:  16 val_f1:  0.7156947373800909 val_auroc:  0.7837506136475209 val_auprc:  0.8934197625727565
EarlyStopping counter: 5 out of 50
epoch:  16
epoch:  17 val_f1:  0.7156947373800909 val_auroc:  0.7788414334806087 val_auprc:  0.8880623218476573
EarlyStopping counter: 6 out of 50
epoch:  17
epoch:  18 val_f1:  0.6823403921278894 val_auroc:  0.771232204221895 val_auprc:  0.8861705207896766
EarlyStopping counter: 7 out of 50
epoch:  18
epoch:  19 val_f1:  0.7454557504588546 val_auroc:  0.7928325969563084 val_auprc:  0.8966835310245383
EarlyStopping counter: 8 out of 50
epoch:  19
epoch:  20 val_f1:  0.7207289113763933 val_auroc:  0.7901325478645067 val_auprc:  0.8973198349379192
EarlyStopping counter: 9 out of 50
epoch:  20
epoch:  21 val_f1:  0.7203480251458693 val_auroc:  0.7820324005891016 val_auprc:  0.891949607080362
EarlyStopping counter: 10 out of 50
epoch:  21
epoch:  22 val_f1:  0.7420346526768117 val_auroc:  0.7803141875306824 val_auprc:  0.8871294181809667
EarlyStopping counter: 11 out of 50
epoch:  22
epoch:  23 val_f1:  0.6276318729626881 val_auroc:  0.7727049582719685 val_auprc:  0.8881759228482117
EarlyStopping counter: 12 out of 50
epoch:  23
epoch:  24 val_f1:  0.6956980834430598 val_auroc:  0.7658321060382915 val_auprc:  0.8784980773920033
EarlyStopping counter: 13 out of 50
epoch:  24
epoch:  25 val_f1:  0.7359858855314679 val_auroc:  0.7704958271968582 val_auprc:  0.8825523695196289
EarlyStopping counter: 14 out of 50
epoch:  25
epoch:  26 val_f1:  0.7237424247793883 val_auroc:  0.7744231713303878 val_auprc:  0.8880868417601822
EarlyStopping counter: 15 out of 50
epoch:  26
epoch:  27 val_f1:  0.7266187050359713 val_auroc:  0.7717231222385862 val_auprc:  0.8791744692207571
EarlyStopping counter: 16 out of 50
epoch:  27
epoch:  28 val_f1:  0.7024482739389885 val_auroc:  0.7847324496809033 val_auprc:  0.8903032000055314
EarlyStopping counter: 17 out of 50
epoch:  28
epoch:  29 val_f1:  0.6966777045653197 val_auroc:  0.7820324005891016 val_auprc:  0.8907688640125758
EarlyStopping counter: 18 out of 50
epoch:  29
epoch:  30 val_f1:  0.7108600244444511 val_auroc:  0.766813942071674 val_auprc:  0.872855771248884
EarlyStopping counter: 19 out of 50
epoch:  30
epoch:  31 val_f1:  0.7030919944895149 val_auroc:  0.7712322042218949 val_auprc:  0.8779953523448589
EarlyStopping counter: 20 out of 50
epoch:  31
epoch:  32 val_f1:  0.7349308245711123 val_auroc:  0.7744231713303878 val_auprc:  0.8855007160002479
EarlyStopping counter: 21 out of 50
epoch:  32
epoch:  33 val_f1:  0.7325045643526866 val_auroc:  0.780559646539028 val_auprc:  0.8841774497342891
EarlyStopping counter: 22 out of 50
epoch:  33
epoch:  34 val_f1:  0.708480907581627 val_auroc:  0.7800687285223368 val_auprc:  0.8857477636030868
EarlyStopping counter: 23 out of 50
epoch:  34
epoch:  35 val_f1:  0.7115566705387387 val_auroc:  0.7658321060382917 val_auprc:  0.8768649189205278
EarlyStopping counter: 24 out of 50
epoch:  35
epoch:  36 val_f1:  0.7094198370570532 val_auroc:  0.7709867452135493 val_auprc:  0.8797225464876783
EarlyStopping counter: 25 out of 50
epoch:  36
epoch:  37 val_f1:  0.7328919440906961 val_auroc:  0.7697594501718212 val_auprc:  0.8775151433896595
EarlyStopping counter: 26 out of 50
epoch:  37
epoch:  38 val_f1:  0.7371484630477437 val_auroc:  0.7724594992636231 val_auprc:  0.88020910465658
EarlyStopping counter: 27 out of 50
epoch:  38
epoch:  39 val_f1:  0.7208993647046947 val_auroc:  0.7729504172803142 val_auprc:  0.8783745911961001
EarlyStopping counter: 28 out of 50
epoch:  39
epoch:  40 val_f1:  0.7473654218886486 val_auroc:  0.764359351988218 val_auprc:  0.8743057382230699
EarlyStopping counter: 29 out of 50
epoch:  40
epoch:  41 val_f1:  0.713247796930704 val_auroc:  0.7594501718213059 val_auprc:  0.87007013830881
EarlyStopping counter: 30 out of 50
epoch:  41
epoch:  42 val_f1:  0.713247796930704 val_auroc:  0.7567501227295043 val_auprc:  0.8681427237593602
EarlyStopping counter: 31 out of 50
epoch:  42
epoch:  43 val_f1:  0.7309103647707891 val_auroc:  0.7641138929798724 val_auprc:  0.8744807586358581
EarlyStopping counter: 32 out of 50
epoch:  43
epoch:  44 val_f1:  0.7078050864958872 val_auroc:  0.7653411880216004 val_auprc:  0.8736949910950791
EarlyStopping counter: 33 out of 50
epoch:  44
epoch:  45 val_f1:  0.7411406017655346 val_auroc:  0.7619047619047619 val_auprc:  0.867223789148668
EarlyStopping counter: 34 out of 50
epoch:  45
epoch:  46 val_f1:  0.7325045643526866 val_auroc:  0.7569955817378499 val_auprc:  0.8709173173755271
EarlyStopping counter: 35 out of 50
epoch:  46
epoch:  47 val_f1:  0.706765356945213 val_auroc:  0.7535591556210113 val_auprc:  0.863278175046353
EarlyStopping counter: 36 out of 50
epoch:  47
epoch:  48 val_f1:  0.6879576385879046 val_auroc:  0.7528227785959745 val_auprc:  0.860881304472933
EarlyStopping counter: 37 out of 50
epoch:  48
epoch:  49 val_f1:  0.743396428458658 val_auroc:  0.7633775159548355 val_auprc:  0.8683294084146964
EarlyStopping counter: 38 out of 50
epoch:  49
epoch:  50 val_f1:  0.7412236216203913 val_auroc:  0.7633775159548355 val_auprc:  0.8737345556828267
EarlyStopping counter: 39 out of 50
epoch:  50
epoch:  51 val_f1:  0.7454557504588546 val_auroc:  0.7565046637211585 val_auprc:  0.8624159994267553
EarlyStopping counter: 40 out of 50
epoch:  51
epoch:  52 val_f1:  0.7117994924448791 val_auroc:  0.7675503190967109 val_auprc:  0.87356291337926
EarlyStopping counter: 41 out of 50
epoch:  52
epoch:  53 val_f1:  0.7325045643526866 val_auroc:  0.7604320078546882 val_auprc:  0.8663157377598789
EarlyStopping counter: 42 out of 50
epoch:  53
epoch:  54 val_f1:  0.7309103647707891 val_auroc:  0.7643593519882179 val_auprc:  0.8726708879517774
EarlyStopping counter: 43 out of 50
epoch:  54
epoch:  55 val_f1:  0.7328919440906961 val_auroc:  0.7567501227295041 val_auprc:  0.8652091440102454
EarlyStopping counter: 44 out of 50
epoch:  55
epoch:  56 val_f1:  0.7349308245711123 val_auroc:  0.7592047128129602 val_auprc:  0.8654510655766008
EarlyStopping counter: 45 out of 50
epoch:  56
epoch:  57 val_f1:  0.7325045643526866 val_auroc:  0.7606774668630338 val_auprc:  0.8666088437321839
EarlyStopping counter: 46 out of 50
epoch:  57
epoch:  58 val_f1:  0.7410071942446043 val_auroc:  0.7569955817378499 val_auprc:  0.8631767529335956
EarlyStopping counter: 47 out of 50
epoch:  58
epoch:  59 val_f1:  0.726175885795287 val_auroc:  0.7557682866961217 val_auprc:  0.8616419950407964
EarlyStopping counter: 48 out of 50
epoch:  59
epoch:  60 val_f1:  0.7325045643526866 val_auroc:  0.7594501718213058 val_auprc:  0.8651696503895083
EarlyStopping counter: 49 out of 50
epoch:  60
epoch:  61 val_f1:  0.7325045643526866 val_auroc:  0.7596956308296515 val_auprc:  0.865690043273192
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  455.8412833213806
{'time_elapsed': [455.8412833213806], 'epoch': [60], 'fold': [2], 'f1_train': [0.9981996872393208], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7325045643526866], 'auroc_test': [0.7596956308296515], 'auprc_test': [0.865690043273192]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1276]           2,048
│    └─BatchNorm1d: 2-2                  [64, 256, 1276]           512
│    └─Tanh: 2-3                         [64, 256, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1270]           --
│    └─Dropout: 2-5                      [64, 256, 1270]           --
│    └─Flatten: 2-6                      [64, 325120]              --
│    └─Linear: 2-7                       [64, 1]                   325,121
==========================================================================================
Total params: 327,681
Trainable params: 327,681
Non-trainable params: 0
Total mult-adds (M): 188.09
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 334.50
Params size (MB): 1.31
Estimated Total Size (MB): 336.13
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5642736874330323 val_auroc:  0.5 val_auprc:  0.8453237410071943
epoch:  1
epoch:  2 val_f1:  0.1461775634437505 val_auroc:  0.6923449612403099 val_auprc:  0.8438094078306789
Validation loss improved to 1.496835
epoch:  2
epoch:  3 val_f1:  0.5817463529824313 val_auroc:  0.7143895348837208 val_auprc:  0.858390129813058
Validation loss improved to 0.209611
epoch:  3
epoch:  4 val_f1:  0.5731127242134327 val_auroc:  0.7575096899224806 val_auprc:  0.8669580553547758
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.7455877744514305 val_auroc:  0.8088662790697675 val_auprc:  0.9116324616475737
EarlyStopping counter: 2 out of 50
epoch:  5
epoch:  6 val_f1:  0.6649838905582698 val_auroc:  0.8030523255813953 val_auprc:  0.9088434989836711
EarlyStopping counter: 3 out of 50
epoch:  6
epoch:  7 val_f1:  0.7768458491633659 val_auroc:  0.8304263565891472 val_auprc:  0.9212246522767902
Validation loss improved to 0.206196
epoch:  7
epoch:  8 val_f1:  0.7789671954250403 val_auroc:  0.8316375968992248 val_auprc:  0.9222263393837377
Validation loss improved to 0.171812
epoch:  8
epoch:  9 val_f1:  0.7745758989478168 val_auroc:  0.8270348837209304 val_auprc:  0.9184789133514293
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7679977157187104 val_auroc:  0.8282461240310078 val_auprc:  0.9211638745230802
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.7618084502224494 val_auroc:  0.8311531007751939 val_auprc:  0.9235703641396276
EarlyStopping counter: 3 out of 50
epoch:  11
epoch:  12 val_f1:  0.776244301724119 val_auroc:  0.8345445736434108 val_auprc:  0.923949006246878
EarlyStopping counter: 4 out of 50
epoch:  12
epoch:  13 val_f1:  0.7877294237541244 val_auroc:  0.8425387596899225 val_auprc:  0.929295626969147
Validation loss improved to 0.162947
epoch:  13
epoch:  14 val_f1:  0.7841726618705036 val_auroc:  0.845687984496124 val_auprc:  0.9293059051328807
Validation loss improved to 0.158020
epoch:  14
epoch:  15 val_f1:  0.7866727894280321 val_auroc:  0.8442344961240309 val_auprc:  0.9327552899970166
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7578890782445586 val_auroc:  0.849079457364341 val_auprc:  0.9327270062537658
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.7562473143424068 val_auroc:  0.8466569767441859 val_auprc:  0.9307017653083951
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.7940592980161325 val_auroc:  0.8471414728682171 val_auprc:  0.930151813354508
Validation loss improved to 0.157643
epoch:  18
epoch:  19 val_f1:  0.7828470720035011 val_auroc:  0.8493217054263567 val_auprc:  0.9372835595049961
Validation loss improved to 0.152436
epoch:  19
epoch:  20 val_f1:  0.7503827565415855 val_auroc:  0.8529554263565892 val_auprc:  0.9399990792441236
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7495479552187128 val_auroc:  0.8500484496124031 val_auprc:  0.9356895044079283
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7622179807174668 val_auroc:  0.8483527131782945 val_auprc:  0.9369203106692725
Validation loss improved to 0.142163
epoch:  22
epoch:  23 val_f1:  0.7866727894280321 val_auroc:  0.8517441860465116 val_auprc:  0.9390436213453615
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.8008946034661633 val_auroc:  0.8536821705426355 val_auprc:  0.9382501576478479
Validation loss improved to 0.138630
epoch:  24
epoch:  25 val_f1:  0.792019787311512 val_auroc:  0.8556201550387598 val_auprc:  0.9384747721146713
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.7540304643278981 val_auroc:  0.8536821705426357 val_auprc:  0.9369514340628249
EarlyStopping counter: 2 out of 50
epoch:  26
epoch:  27 val_f1:  0.8018807955038493 val_auroc:  0.8561046511627907 val_auprc:  0.9411204472957174
Validation loss improved to 0.132224
epoch:  27
epoch:  28 val_f1:  0.7886649052635782 val_auroc:  0.8587693798449613 val_auprc:  0.9421793151669575
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.7894843465886632 val_auroc:  0.8570736434108527 val_auprc:  0.9414781439490111
EarlyStopping counter: 2 out of 50
epoch:  29
epoch:  30 val_f1:  0.7894843465886632 val_auroc:  0.8594961240310078 val_auprc:  0.9429621019719185
Validation loss improved to 0.130582
epoch:  30
epoch:  31 val_f1:  0.8151164175042944 val_auroc:  0.8602228682170543 val_auprc:  0.9422271546653881
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.7961192047225032 val_auroc:  0.8578003875968992 val_auprc:  0.9419872144585006
Validation loss improved to 0.129434
epoch:  32
epoch:  33 val_f1:  0.7894843465886632 val_auroc:  0.8626453488372093 val_auprc:  0.9432879961488588
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.7841726618705036 val_auroc:  0.8597383720930233 val_auprc:  0.9413840085082689
EarlyStopping counter: 2 out of 50
epoch:  34
epoch:  35 val_f1:  0.8074875573056803 val_auroc:  0.8592538759689923 val_auprc:  0.94213858941377
EarlyStopping counter: 3 out of 50
epoch:  35
epoch:  36 val_f1:  0.7746634573712671 val_auroc:  0.8619186046511628 val_auprc:  0.941727433149004
EarlyStopping counter: 4 out of 50
epoch:  36
epoch:  37 val_f1:  0.7477439586792105 val_auroc:  0.8631298449612403 val_auprc:  0.941979628917092
EarlyStopping counter: 5 out of 50
epoch:  37
epoch:  38 val_f1:  0.7603368061152953 val_auroc:  0.8638565891472868 val_auprc:  0.9410685191507762
EarlyStopping counter: 6 out of 50
epoch:  38
epoch:  39 val_f1:  0.7697841726618705 val_auroc:  0.8614341085271319 val_auprc:  0.9424193151926354
EarlyStopping counter: 7 out of 50
epoch:  39
epoch:  40 val_f1:  0.8035187234827523 val_auroc:  0.8599806201550387 val_auprc:  0.9422342512881288
Validation loss improved to 0.128639
epoch:  40
epoch:  41 val_f1:  0.7901923359271766 val_auroc:  0.8597383720930233 val_auprc:  0.9425480041168897
Validation loss improved to 0.113115
epoch:  41
epoch:  42 val_f1:  0.7854893118997625 val_auroc:  0.8633720930232558 val_auprc:  0.9432325409758329
EarlyStopping counter: 1 out of 50
epoch:  42
epoch:  43 val_f1:  0.7820584602206068 val_auroc:  0.8580426356589147 val_auprc:  0.9419901010323845
EarlyStopping counter: 2 out of 50
epoch:  43
epoch:  44 val_f1:  0.8093907785715628 val_auroc:  0.8665213178294574 val_auprc:  0.9446502475288492
EarlyStopping counter: 3 out of 50
epoch:  44
epoch:  45 val_f1:  0.8168429178951009 val_auroc:  0.8648255813953488 val_auprc:  0.9441821399610424
EarlyStopping counter: 4 out of 50
epoch:  45
epoch:  46 val_f1:  0.7793492478744277 val_auroc:  0.8665213178294574 val_auprc:  0.9436386465672347
EarlyStopping counter: 5 out of 50
epoch:  46
epoch:  47 val_f1:  0.7746634573712671 val_auroc:  0.8682170542635659 val_auprc:  0.9449744480874659
EarlyStopping counter: 6 out of 50
epoch:  47
epoch:  48 val_f1:  0.7793492478744277 val_auroc:  0.8655523255813953 val_auprc:  0.9429125097375255
EarlyStopping counter: 7 out of 50
epoch:  48
epoch:  49 val_f1:  0.7641917471702557 val_auroc:  0.8694282945736435 val_auprc:  0.943010823338921
EarlyStopping counter: 8 out of 50
epoch:  49
epoch:  50 val_f1:  0.768937708914086 val_auroc:  0.8716085271317828 val_auprc:  0.9454286803602168
EarlyStopping counter: 9 out of 50
epoch:  50
epoch:  51 val_f1:  0.7682301875730638 val_auroc:  0.8674903100775193 val_auprc:  0.9443705885410091
EarlyStopping counter: 10 out of 50
epoch:  51
epoch:  52 val_f1:  0.7601256159113488 val_auroc:  0.8694282945736433 val_auprc:  0.9449680660595814
EarlyStopping counter: 11 out of 50
epoch:  52
epoch:  53 val_f1:  0.7729252582141845 val_auroc:  0.8691860465116278 val_auprc:  0.9450878017189843
EarlyStopping counter: 12 out of 50
epoch:  53
epoch:  54 val_f1:  0.7776763243674784 val_auroc:  0.8648255813953488 val_auprc:  0.9436439070813047
EarlyStopping counter: 13 out of 50
epoch:  54
epoch:  55 val_f1:  0.7776763243674784 val_auroc:  0.8653100775193798 val_auprc:  0.94367055055811
EarlyStopping counter: 14 out of 50
epoch:  55
epoch:  56 val_f1:  0.7932273763653603 val_auroc:  0.8670058139534884 val_auprc:  0.9437801978386304
EarlyStopping counter: 15 out of 50
epoch:  56
epoch:  57 val_f1:  0.776244301724119 val_auroc:  0.8687015503875968 val_auprc:  0.9444140126835179
EarlyStopping counter: 16 out of 50
epoch:  57
epoch:  58 val_f1:  0.7854893118997625 val_auroc:  0.867248062015504 val_auprc:  0.9443246131694304
EarlyStopping counter: 17 out of 50
epoch:  58
epoch:  59 val_f1:  0.7811109002295425 val_auroc:  0.8667635658914729 val_auprc:  0.943824548131671
EarlyStopping counter: 18 out of 50
epoch:  59
epoch:  60 val_f1:  0.7776763243674784 val_auroc:  0.8670058139534883 val_auprc:  0.9442538557435388
EarlyStopping counter: 19 out of 50
epoch:  60
epoch:  61 val_f1:  0.7776763243674784 val_auroc:  0.8667635658914729 val_auprc:  0.9442616792620042
EarlyStopping counter: 20 out of 50
epoch:  61
epoch:  62 val_f1:  0.7854893118997625 val_auroc:  0.8670058139534883 val_auprc:  0.9440542505707324
EarlyStopping counter: 21 out of 50
epoch:  62
epoch:  63 val_f1:  0.7841726618705036 val_auroc:  0.8674903100775193 val_auprc:  0.9440620319577474
EarlyStopping counter: 22 out of 50
epoch:  63
epoch:  64 val_f1:  0.7854893118997625 val_auroc:  0.8653100775193798 val_auprc:  0.9427403829907904
EarlyStopping counter: 23 out of 50
epoch:  64
epoch:  65 val_f1:  0.8018807955038493 val_auroc:  0.8636143410852712 val_auprc:  0.9431777851961507
EarlyStopping counter: 24 out of 50
epoch:  65
epoch:  66 val_f1:  0.7793492478744277 val_auroc:  0.8711240310077519 val_auprc:  0.9452774008251953
EarlyStopping counter: 25 out of 50
epoch:  66
epoch:  67 val_f1:  0.7746634573712671 val_auroc:  0.8716085271317829 val_auprc:  0.9456825797027348
EarlyStopping counter: 26 out of 50
epoch:  67
epoch:  68 val_f1:  0.7811109002295425 val_auroc:  0.8679748062015504 val_auprc:  0.9440805567907095
EarlyStopping counter: 27 out of 50
epoch:  68
epoch:  69 val_f1:  0.792259730676997 val_auroc:  0.8684593023255814 val_auprc:  0.9440611300653168
EarlyStopping counter: 28 out of 50
epoch:  69
epoch:  70 val_f1:  0.7793492478744277 val_auroc:  0.8679748062015503 val_auprc:  0.9432952675583155
EarlyStopping counter: 29 out of 50
epoch:  70
epoch:  71 val_f1:  0.7793492478744277 val_auroc:  0.8703972868217054 val_auprc:  0.9448552601386286
EarlyStopping counter: 30 out of 50
epoch:  71
epoch:  72 val_f1:  0.792019787311512 val_auroc:  0.8677325581395348 val_auprc:  0.9445561059725733
EarlyStopping counter: 31 out of 50
epoch:  72
epoch:  73 val_f1:  0.7827158008497472 val_auroc:  0.8689437984496124 val_auprc:  0.9445317368878385
EarlyStopping counter: 32 out of 50
epoch:  73
epoch:  74 val_f1:  0.7997900244397783 val_auroc:  0.866279069767442 val_auprc:  0.9435556750262974
EarlyStopping counter: 33 out of 50
epoch:  74
epoch:  75 val_f1:  0.7811109002295425 val_auroc:  0.8691860465116279 val_auprc:  0.944410707837411
EarlyStopping counter: 34 out of 50
epoch:  75
epoch:  76 val_f1:  0.792019787311512 val_auroc:  0.8667635658914727 val_auprc:  0.9441015899917019
EarlyStopping counter: 35 out of 50
epoch:  76
epoch:  77 val_f1:  0.7854893118997625 val_auroc:  0.8653100775193798 val_auprc:  0.9433828404345055
EarlyStopping counter: 36 out of 50
epoch:  77
epoch:  78 val_f1:  0.7827158008497472 val_auroc:  0.8682170542635659 val_auprc:  0.9444626131429799
EarlyStopping counter: 37 out of 50
epoch:  78
epoch:  79 val_f1:  0.792019787311512 val_auroc:  0.8672480620155039 val_auprc:  0.9438455901694117
EarlyStopping counter: 38 out of 50
epoch:  79
epoch:  80 val_f1:  0.7906801532257888 val_auroc:  0.8679748062015504 val_auprc:  0.943753667145899
EarlyStopping counter: 39 out of 50
epoch:  80
epoch:  81 val_f1:  0.7827158008497472 val_auroc:  0.8670058139534883 val_auprc:  0.9436352303812127
EarlyStopping counter: 40 out of 50
epoch:  81
epoch:  82 val_f1:  0.7906801532257888 val_auroc:  0.8670058139534883 val_auprc:  0.9440866123258305
EarlyStopping counter: 41 out of 50
epoch:  82
epoch:  83 val_f1:  0.7841726618705036 val_auroc:  0.8660368217054264 val_auprc:  0.9434533961470417
EarlyStopping counter: 42 out of 50
epoch:  83
epoch:  84 val_f1:  0.792019787311512 val_auroc:  0.8650678294573644 val_auprc:  0.942754486996159
EarlyStopping counter: 43 out of 50
epoch:  84
epoch:  85 val_f1:  0.7892012988311853 val_auroc:  0.8667635658914727 val_auprc:  0.9434245801540512
EarlyStopping counter: 44 out of 50
epoch:  85
epoch:  86 val_f1:  0.7841726618705036 val_auroc:  0.8660368217054263 val_auprc:  0.9433816894824323
EarlyStopping counter: 45 out of 50
epoch:  86
epoch:  87 val_f1:  0.7729252582141845 val_auroc:  0.8677325581395349 val_auprc:  0.944038704615697
EarlyStopping counter: 46 out of 50
epoch:  87
epoch:  88 val_f1:  0.7811109002295425 val_auroc:  0.8677325581395349 val_auprc:  0.9441312072586697
EarlyStopping counter: 47 out of 50
epoch:  88
epoch:  89 val_f1:  0.7892012988311853 val_auroc:  0.8665213178294573 val_auprc:  0.9434253198766613
EarlyStopping counter: 48 out of 50
epoch:  89
epoch:  90 val_f1:  0.7875752415552048 val_auroc:  0.8667635658914729 val_auprc:  0.9435979723729618
EarlyStopping counter: 49 out of 50
epoch:  90
epoch:  91 val_f1:  0.792019787311512 val_auroc:  0.8665213178294574 val_auprc:  0.9436197493856779
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  679.4848186969757
{'time_elapsed': [679.4848186969757], 'epoch': [90], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.792019787311512], 'auroc_test': [0.8665213178294574], 'auprc_test': [0.9436197493856779]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1276]           2,048
│    └─BatchNorm1d: 2-2                  [64, 256, 1276]           512
│    └─Tanh: 2-3                         [64, 256, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1270]           --
│    └─Dropout: 2-5                      [64, 256, 1270]           --
│    └─Flatten: 2-6                      [64, 325120]              --
│    └─Linear: 2-7                       [64, 1]                   325,121
==========================================================================================
Total params: 327,681
Trainable params: 327,681
Non-trainable params: 0
Total mult-adds (M): 188.09
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 334.50
Params size (MB): 1.31
Estimated Total Size (MB): 336.13
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6025585117434455 val_auroc:  0.7854662698412699 val_auprc:  0.9021039581367798
epoch:  1
epoch:  2 val_f1:  0.7455835240274601 val_auroc:  0.8591269841269841 val_auprc:  0.9326397457904272
Validation loss improved to 0.301530
epoch:  2
epoch:  3 val_f1:  0.7211394302848576 val_auroc:  0.8643353174603173 val_auprc:  0.9326913724559514
Validation loss improved to 0.292238
epoch:  3
epoch:  4 val_f1:  0.8014350667803353 val_auroc:  0.873263888888889 val_auprc:  0.936045221145526
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.7929485957015485 val_auroc:  0.8735119047619048 val_auprc:  0.9386047870917777
Validation loss improved to 0.223060
epoch:  5
epoch:  6 val_f1:  0.7282743721307049 val_auroc:  0.8824404761904763 val_auprc:  0.9427621240726529
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.7564782680351303 val_auroc:  0.8754960317460317 val_auprc:  0.9390078747822322
EarlyStopping counter: 2 out of 50
epoch:  7
epoch:  8 val_f1:  0.735373054213634 val_auroc:  0.8752480158730158 val_auprc:  0.9396680385775047
EarlyStopping counter: 3 out of 50
epoch:  8
epoch:  9 val_f1:  0.7769308547872755 val_auroc:  0.8869047619047619 val_auprc:  0.946265080460012
EarlyStopping counter: 4 out of 50
epoch:  9
epoch:  10 val_f1:  0.7771751194325146 val_auroc:  0.8881448412698414 val_auprc:  0.9469197668520499
EarlyStopping counter: 5 out of 50
epoch:  10
epoch:  11 val_f1:  0.792371879328401 val_auroc:  0.8549107142857143 val_auprc:  0.9229363477050618
EarlyStopping counter: 6 out of 50
epoch:  11
epoch:  12 val_f1:  0.7819511139952413 val_auroc:  0.8648313492063493 val_auprc:  0.9289734987742478
EarlyStopping counter: 7 out of 50
epoch:  12
epoch:  13 val_f1:  0.8182185828242006 val_auroc:  0.8737599206349206 val_auprc:  0.9395315666447832
EarlyStopping counter: 8 out of 50
epoch:  13
epoch:  14 val_f1:  0.7949078298424175 val_auroc:  0.8578869047619048 val_auprc:  0.9194829935132229
EarlyStopping counter: 9 out of 50
epoch:  14
epoch:  15 val_f1:  0.8415943802884359 val_auroc:  0.8759920634920634 val_auprc:  0.939284809160972
EarlyStopping counter: 10 out of 50
epoch:  15
epoch:  16 val_f1:  0.8440453686200378 val_auroc:  0.8757440476190476 val_auprc:  0.9377150960827063
EarlyStopping counter: 11 out of 50
epoch:  16
epoch:  17 val_f1:  0.800639197204071 val_auroc:  0.8591269841269841 val_auprc:  0.9213667443241248
EarlyStopping counter: 12 out of 50
epoch:  17
epoch:  18 val_f1:  0.7973334973248877 val_auroc:  0.8754960317460317 val_auprc:  0.9359388679239432
EarlyStopping counter: 13 out of 50
epoch:  18
epoch:  19 val_f1:  0.8014350667803353 val_auroc:  0.8625992063492064 val_auprc:  0.9232703534191996
EarlyStopping counter: 14 out of 50
epoch:  19
epoch:  20 val_f1:  0.8231516182680737 val_auroc:  0.8683035714285714 val_auprc:  0.9294678879108194
EarlyStopping counter: 15 out of 50
epoch:  20
epoch:  21 val_f1:  0.792371879328401 val_auroc:  0.8655753968253969 val_auprc:  0.9243424395854569
EarlyStopping counter: 16 out of 50
epoch:  21
epoch:  22 val_f1:  0.8022296544035674 val_auroc:  0.8663194444444445 val_auprc:  0.9233684834219078
EarlyStopping counter: 17 out of 50
epoch:  22
epoch:  23 val_f1:  0.8102677351291666 val_auroc:  0.8660714285714285 val_auprc:  0.923624594114125
EarlyStopping counter: 18 out of 50
epoch:  23
epoch:  24 val_f1:  0.8182185828242006 val_auroc:  0.8690476190476191 val_auprc:  0.9256767984439502
EarlyStopping counter: 19 out of 50
epoch:  24
epoch:  25 val_f1:  0.7819511139952413 val_auroc:  0.8598710317460317 val_auprc:  0.8968207385787429
EarlyStopping counter: 20 out of 50
epoch:  25
epoch:  26 val_f1:  0.804509509950907 val_auroc:  0.8821924603174603 val_auprc:  0.9413604742638514
EarlyStopping counter: 21 out of 50
epoch:  26
epoch:  27 val_f1:  0.7861608411480533 val_auroc:  0.8511904761904763 val_auprc:  0.892504847373959
EarlyStopping counter: 22 out of 50
epoch:  27
epoch:  28 val_f1:  0.8248885315945005 val_auroc:  0.8735119047619048 val_auprc:  0.9322538019233368
EarlyStopping counter: 23 out of 50
epoch:  28
epoch:  29 val_f1:  0.7966751918158568 val_auroc:  0.8702876984126984 val_auprc:  0.9246718241399062
EarlyStopping counter: 24 out of 50
epoch:  29
epoch:  30 val_f1:  0.7940993788819876 val_auroc:  0.8720238095238095 val_auprc:  0.9278363022509672
EarlyStopping counter: 25 out of 50
epoch:  30
epoch:  31 val_f1:  0.7861608411480533 val_auroc:  0.8529265873015873 val_auprc:  0.8931166748137522
EarlyStopping counter: 26 out of 50
epoch:  31
epoch:  32 val_f1:  0.8022296544035674 val_auroc:  0.8720238095238095 val_auprc:  0.9309889497628492
EarlyStopping counter: 27 out of 50
epoch:  32
epoch:  33 val_f1:  0.7875799991742021 val_auroc:  0.8685515873015872 val_auprc:  0.9173003035388743
EarlyStopping counter: 28 out of 50
epoch:  33
epoch:  34 val_f1:  0.7645238046338866 val_auroc:  0.8541666666666666 val_auprc:  0.8950305317087642
EarlyStopping counter: 29 out of 50
epoch:  34
epoch:  35 val_f1:  0.7940993788819876 val_auroc:  0.8668154761904763 val_auprc:  0.9144142785144649
EarlyStopping counter: 30 out of 50
epoch:  35
epoch:  36 val_f1:  0.8102677351291666 val_auroc:  0.8707837301587302 val_auprc:  0.9269591430803034
EarlyStopping counter: 31 out of 50
epoch:  36
epoch:  37 val_f1:  0.8102677351291666 val_auroc:  0.8660714285714285 val_auprc:  0.9158891525590442
EarlyStopping counter: 32 out of 50
epoch:  37
epoch:  38 val_f1:  0.7904805491990847 val_auroc:  0.8598710317460317 val_auprc:  0.8972730464937054
EarlyStopping counter: 33 out of 50
epoch:  38
epoch:  39 val_f1:  0.7901701323251418 val_auroc:  0.8608630952380952 val_auprc:  0.9003739811594323
EarlyStopping counter: 34 out of 50
epoch:  39
epoch:  40 val_f1:  0.7966751918158568 val_auroc:  0.8603670634920635 val_auprc:  0.8986703270616706
EarlyStopping counter: 35 out of 50
epoch:  40
epoch:  41 val_f1:  0.8022296544035674 val_auroc:  0.8695436507936508 val_auprc:  0.9184555901153298
EarlyStopping counter: 36 out of 50
epoch:  41
epoch:  42 val_f1:  0.8348841452289729 val_auroc:  0.8727678571428572 val_auprc:  0.9265819155491475
EarlyStopping counter: 37 out of 50
epoch:  42
epoch:  43 val_f1:  0.8022296544035674 val_auroc:  0.8690476190476191 val_auprc:  0.9184069977612059
EarlyStopping counter: 38 out of 50
epoch:  43
epoch:  44 val_f1:  0.8115942028985508 val_auroc:  0.8683035714285715 val_auprc:  0.918153109545728
EarlyStopping counter: 39 out of 50
epoch:  44
epoch:  45 val_f1:  0.7858717303302986 val_auroc:  0.863343253968254 val_auprc:  0.9077490319801674
EarlyStopping counter: 40 out of 50
epoch:  45
epoch:  46 val_f1:  0.7991557619248628 val_auroc:  0.8617311507936508 val_auprc:  0.9039130825469068
EarlyStopping counter: 41 out of 50
epoch:  46
epoch:  47 val_f1:  0.7858717303302986 val_auroc:  0.8637152777777778 val_auprc:  0.9108061488111727
EarlyStopping counter: 42 out of 50
epoch:  47
epoch:  48 val_f1:  0.7875799991742021 val_auroc:  0.8638392857142857 val_auprc:  0.9157588467365653
EarlyStopping counter: 43 out of 50
epoch:  48
epoch:  49 val_f1:  0.8036760694501368 val_auroc:  0.8717757936507936 val_auprc:  0.9237411368600724
EarlyStopping counter: 44 out of 50
epoch:  49
epoch:  50 val_f1:  0.7733010668869473 val_auroc:  0.8597470238095238 val_auprc:  0.9039105589184995
EarlyStopping counter: 45 out of 50
epoch:  50
epoch:  51 val_f1:  0.8167092924126172 val_auroc:  0.861359126984127 val_auprc:  0.9064919298129803
EarlyStopping counter: 46 out of 50
epoch:  51
epoch:  52 val_f1:  0.7904805491990847 val_auroc:  0.8625992063492064 val_auprc:  0.9120466787088013
EarlyStopping counter: 47 out of 50
epoch:  52
epoch:  53 val_f1:  0.7949078298424175 val_auroc:  0.8618551587301587 val_auprc:  0.9065295148248625
EarlyStopping counter: 48 out of 50
epoch:  53
epoch:  54 val_f1:  0.7711042634565258 val_auroc:  0.8668154761904762 val_auprc:  0.9171998021946365
EarlyStopping counter: 49 out of 50
epoch:  54
epoch:  55 val_f1:  0.7956729455237178 val_auroc:  0.8692956349206349 val_auprc:  0.9228902932062476
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  407.39312267303467
{'time_elapsed': [407.39312267303467], 'epoch': [54], 'fold': [4], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7956729455237178], 'auroc_test': [0.8692956349206349], 'auprc_test': [0.9228902932062476]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1276]           2,048
│    └─BatchNorm1d: 2-2                  [64, 256, 1276]           512
│    └─Tanh: 2-3                         [64, 256, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1270]           --
│    └─Dropout: 2-5                      [64, 256, 1270]           --
│    └─Flatten: 2-6                      [64, 325120]              --
│    └─Linear: 2-7                       [64, 1]                   325,121
==========================================================================================
Total params: 327,681
Trainable params: 327,681
Non-trainable params: 0
Total mult-adds (M): 188.09
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 334.50
Params size (MB): 1.31
Estimated Total Size (MB): 336.13
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_69', 'config': {'hidden_channels': [256], 'epochs': 500, 'kernel_size': 7, 'pool_kernel_size': 7, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.6470299459990182 val_auprc:  0.8115174193860929
epoch:  1
epoch:  2 val_f1:  0.6989956193979703 val_auroc:  0.6492390770741286 val_auprc:  0.7851135789388928
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6262025972442385 val_auroc:  0.6791850760922926 val_auprc:  0.8264594276570587
Validation loss improved to 1.240503
epoch:  3
epoch:  4 val_f1:  0.6342555022174201 val_auroc:  0.6936671575846833 val_auprc:  0.8359162230038774
Validation loss improved to 1.234264
epoch:  4
epoch:  5 val_f1:  0.6338388558291804 val_auroc:  0.7093765341188022 val_auprc:  0.8456741807001562
Validation loss improved to 1.215036
epoch:  5
epoch:  6 val_f1:  0.6547178175303147 val_auroc:  0.718213058419244 val_auprc:  0.8522231309186741
Validation loss improved to 1.206276
epoch:  6
epoch:  7 val_f1:  0.6756605397022405 val_auroc:  0.7268041237113402 val_auprc:  0.8562754393348133
Validation loss improved to 1.197738
epoch:  7
epoch:  8 val_f1:  0.6687657666074932 val_auroc:  0.7322042218949436 val_auprc:  0.8610145083270972
Validation loss improved to 1.188626
epoch:  8
epoch:  9 val_f1:  0.6543761159654652 val_auroc:  0.7417771232204222 val_auprc:  0.8677914024984799
Validation loss improved to 1.165042
epoch:  9
epoch:  10 val_f1:  0.7166299330477814 val_auroc:  0.749386352479136 val_auprc:  0.8720612580172038
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.6685291048291022 val_auroc:  0.7542955326460481 val_auprc:  0.8765125426673595
Validation loss improved to 1.147491
epoch:  11
epoch:  12 val_f1:  0.7162290583621869 val_auroc:  0.7594501718213058 val_auprc:  0.8809528851758298
Validation loss improved to 1.145430
epoch:  12
epoch:  13 val_f1:  0.6543761159654652 val_auroc:  0.7682866961217477 val_auprc:  0.8871518049339764
Validation loss improved to 1.120389
epoch:  13
epoch:  14 val_f1:  0.7142089711496735 val_auroc:  0.7650957290132547 val_auprc:  0.8847988831915046
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.640046945494452 val_auroc:  0.7709867452135493 val_auprc:  0.8892969674431275
Validation loss improved to 1.103118
epoch:  15
epoch:  16 val_f1:  0.707673860911271 val_auroc:  0.7695139911634757 val_auprc:  0.8885870707726078
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.6962806225607748 val_auroc:  0.7739322533136966 val_auprc:  0.8927718386271
Validation loss improved to 1.095632
epoch:  17
epoch:  18 val_f1:  0.7229061670449737 val_auroc:  0.7756504663721159 val_auprc:  0.8927825627297254
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7215941532488295 val_auroc:  0.7778595974472263 val_auprc:  0.8947318456052481
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7095299887411026 val_auroc:  0.7835051546391752 val_auprc:  0.8987748416856176
Validation loss improved to 1.085129
epoch:  20
epoch:  21 val_f1:  0.6825214527173443 val_auroc:  0.7857142857142857 val_auprc:  0.8996852088274622
Validation loss improved to 1.073599
epoch:  21
epoch:  22 val_f1:  0.7455074238481555 val_auroc:  0.7808051055473736 val_auprc:  0.8982622367803437
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.6825214527173443 val_auroc:  0.7903780068728523 val_auprc:  0.9039951442937696
Validation loss improved to 1.064274
epoch:  23
epoch:  24 val_f1:  0.7466980132583976 val_auroc:  0.7827687776141384 val_auprc:  0.9002082174624065
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7346924658075737 val_auroc:  0.7898870888561611 val_auprc:  0.904973477742542
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.7095299887411026 val_auroc:  0.7928325969563084 val_auprc:  0.9062162300722184
EarlyStopping counter: 3 out of 50
epoch:  26
epoch:  27 val_f1:  0.6824751963135375 val_auroc:  0.7984781541482573 val_auprc:  0.9096646762865026
Validation loss improved to 1.047931
epoch:  27
epoch:  28 val_f1:  0.7542604103291037 val_auroc:  0.7970054000981837 val_auprc:  0.9089180255865135
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.6825214527173443 val_auroc:  0.8048600883652429 val_auprc:  0.912410777411136
Validation loss improved to 1.040854
epoch:  29
epoch:  30 val_f1:  0.6892815309975336 val_auroc:  0.8043691703485517 val_auprc:  0.9134325484836704
Validation loss improved to 1.040323
epoch:  30
epoch:  31 val_f1:  0.7346924658075737 val_auroc:  0.8009327442317132 val_auprc:  0.9109203754535463
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.7412236216203913 val_auroc:  0.8016691212567502 val_auprc:  0.9111287696643653
EarlyStopping counter: 2 out of 50
epoch:  32
epoch:  33 val_f1:  0.6894399143298684 val_auroc:  0.8100147275405009 val_auprc:  0.9161263295478859
Validation loss improved to 1.031996
epoch:  33
epoch:  34 val_f1:  0.7229061670449737 val_auroc:  0.8124693176239568 val_auprc:  0.9185567222066021
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.7542604103291037 val_auroc:  0.8053510063819341 val_auprc:  0.9143014751000902
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.7725930260576229 val_auroc:  0.802405498281787 val_auprc:  0.912950617731857
EarlyStopping counter: 3 out of 50
epoch:  36
epoch:  37 val_f1:  0.6737247039763566 val_auroc:  0.8173784977908689 val_auprc:  0.9209296462534177
EarlyStopping counter: 4 out of 50
epoch:  37
epoch:  38 val_f1:  0.7553956834532374 val_auroc:  0.8016691212567502 val_auprc:  0.9129357154844675
EarlyStopping counter: 5 out of 50
epoch:  38
epoch:  39 val_f1:  0.7531731915989216 val_auroc:  0.8087874324987727 val_auprc:  0.9162783989423937
EarlyStopping counter: 6 out of 50
epoch:  39
epoch:  40 val_f1:  0.7531731915989216 val_auroc:  0.81173294059892 val_auprc:  0.9183612603380402
EarlyStopping counter: 7 out of 50
epoch:  40
epoch:  41 val_f1:  0.7725930260576229 val_auroc:  0.8097692685321551 val_auprc:  0.916891700935849
EarlyStopping counter: 8 out of 50
epoch:  41
epoch:  42 val_f1:  0.7018261879839978 val_auroc:  0.8151693667157585 val_auprc:  0.919680104694149
EarlyStopping counter: 9 out of 50
epoch:  42
epoch:  43 val_f1:  0.7023865734042448 val_auroc:  0.8193421698576338 val_auprc:  0.9223118434868973
EarlyStopping counter: 10 out of 50
epoch:  43
epoch:  44 val_f1:  0.7790721385700611 val_auroc:  0.8087874324987727 val_auprc:  0.9159338058518038
EarlyStopping counter: 11 out of 50
epoch:  44
epoch:  45 val_f1:  0.7023865734042448 val_auroc:  0.8198330878743251 val_auprc:  0.9222313992833557
EarlyStopping counter: 12 out of 50
epoch:  45
epoch:  46 val_f1:  0.7090514753972222 val_auroc:  0.821060382916053 val_auprc:  0.922690598007119
EarlyStopping counter: 13 out of 50
epoch:  46
epoch:  47 val_f1:  0.7697841726618705 val_auroc:  0.8075601374570447 val_auprc:  0.9145042914622205
EarlyStopping counter: 14 out of 50
epoch:  47
epoch:  48 val_f1:  0.7156947373800909 val_auroc:  0.8210603829160531 val_auprc:  0.9226230899750569
EarlyStopping counter: 15 out of 50
epoch:  48
epoch:  49 val_f1:  0.7162290583621869 val_auroc:  0.8232695139911634 val_auprc:  0.9237159863478899
EarlyStopping counter: 16 out of 50
epoch:  49
epoch:  50 val_f1:  0.766354189375772 val_auroc:  0.8046146293568974 val_auprc:  0.9134258285241228
EarlyStopping counter: 17 out of 50
epoch:  50
epoch:  51 val_f1:  0.7725930260576229 val_auroc:  0.8161512027491409 val_auprc:  0.9198263206981467
EarlyStopping counter: 18 out of 50
epoch:  51
epoch:  52 val_f1:  0.7156947373800909 val_auroc:  0.8237604320078548 val_auprc:  0.9242382842599625
EarlyStopping counter: 19 out of 50
epoch:  52
epoch:  53 val_f1:  0.7229061670449737 val_auroc:  0.8247422680412371 val_auprc:  0.9244886311106172
EarlyStopping counter: 20 out of 50
epoch:  53
epoch:  54 val_f1:  0.7697841726618705 val_auroc:  0.8053510063819344 val_auprc:  0.9132876647613671
EarlyStopping counter: 21 out of 50
epoch:  54
epoch:  55 val_f1:  0.7712620601193464 val_auroc:  0.8100147275405007 val_auprc:  0.9160936243116291
EarlyStopping counter: 22 out of 50
epoch:  55
epoch:  56 val_f1:  0.7428255465713769 val_auroc:  0.826705940108002 val_auprc:  0.9262713809337713
EarlyStopping counter: 23 out of 50
epoch:  56
epoch:  57 val_f1:  0.7412236216203913 val_auroc:  0.8232695139911634 val_auprc:  0.9243749620220233
EarlyStopping counter: 24 out of 50
epoch:  57
epoch:  58 val_f1:  0.7712620601193464 val_auroc:  0.8095238095238095 val_auprc:  0.9164965770206732
EarlyStopping counter: 25 out of 50
epoch:  58
epoch:  59 val_f1:  0.7648187281552264 val_auroc:  0.8136966126656849 val_auprc:  0.9184120271344971
EarlyStopping counter: 26 out of 50
epoch:  59
epoch:  60 val_f1:  0.7412236216203913 val_auroc:  0.8205694648993618 val_auprc:  0.9224609565485424
EarlyStopping counter: 27 out of 50
epoch:  60
epoch:  61 val_f1:  0.7420910227448273 val_auroc:  0.8203240058910163 val_auprc:  0.9227495893136501
EarlyStopping counter: 28 out of 50
epoch:  61
epoch:  62 val_f1:  0.7648187281552264 val_auroc:  0.814187530682376 val_auprc:  0.9187147221308732
EarlyStopping counter: 29 out of 50
epoch:  62
epoch:  63 val_f1:  0.7428255465713769 val_auroc:  0.8249877270495827 val_auprc:  0.9255417762106201
EarlyStopping counter: 30 out of 50
epoch:  63
epoch:  64 val_f1:  0.7712620601193464 val_auroc:  0.8154148257241041 val_auprc:  0.9197642502443792
EarlyStopping counter: 31 out of 50
epoch:  64
epoch:  65 val_f1:  0.7712620601193464 val_auroc:  0.8112420225822288 val_auprc:  0.9172507821895401
EarlyStopping counter: 32 out of 50
epoch:  65
epoch:  66 val_f1:  0.7420910227448273 val_auroc:  0.8259695630829652 val_auprc:  0.9266172550393224
EarlyStopping counter: 33 out of 50
epoch:  66
epoch:  67 val_f1:  0.7236892364125374 val_auroc:  0.8303878252331861 val_auprc:  0.9284780862817323
EarlyStopping counter: 34 out of 50
epoch:  67
epoch:  68 val_f1:  0.7712620601193464 val_auroc:  0.8124693176239568 val_auprc:  0.9177457961036783
EarlyStopping counter: 35 out of 50
epoch:  68
epoch:  69 val_f1:  0.7712620601193464 val_auroc:  0.8119783996072656 val_auprc:  0.9174577475323533
EarlyStopping counter: 36 out of 50
epoch:  69
epoch:  70 val_f1:  0.7428255465713769 val_auroc:  0.826705940108002 val_auprc:  0.9267748198506766
EarlyStopping counter: 37 out of 50
epoch:  70
epoch:  71 val_f1:  0.7790721385700611 val_auroc:  0.8210603829160531 val_auprc:  0.9232493174559943
EarlyStopping counter: 38 out of 50
epoch:  71
epoch:  72 val_f1:  0.7712620601193464 val_auroc:  0.8171330387825233 val_auprc:  0.9208475615322866
EarlyStopping counter: 39 out of 50
epoch:  72
epoch:  73 val_f1:  0.7748426784519089 val_auroc:  0.8190967108492881 val_auprc:  0.9222537444778242
EarlyStopping counter: 40 out of 50
epoch:  73
epoch:  74 val_f1:  0.7683026725960121 val_auroc:  0.8171330387825232 val_auprc:  0.9212038534796095
EarlyStopping counter: 41 out of 50
epoch:  74
epoch:  75 val_f1:  0.7777125328082551 val_auroc:  0.8134511536573392 val_auprc:  0.9186491446905178
EarlyStopping counter: 42 out of 50
epoch:  75
epoch:  76 val_f1:  0.7777125328082551 val_auroc:  0.814187530682376 val_auprc:  0.9191084446260176
EarlyStopping counter: 43 out of 50
epoch:  76
epoch:  77 val_f1:  0.7737843767539161 val_auroc:  0.8186057928325969 val_auprc:  0.9222058747017653
EarlyStopping counter: 44 out of 50
epoch:  77
epoch:  78 val_f1:  0.7737843767539161 val_auroc:  0.8195876288659794 val_auprc:  0.9227852290725633
EarlyStopping counter: 45 out of 50
epoch:  78
epoch:  79 val_f1:  0.7496568898727172 val_auroc:  0.8080510554737359 val_auprc:  0.9158260200771842
EarlyStopping counter: 46 out of 50
epoch:  79
epoch:  80 val_f1:  0.7683026725960121 val_auroc:  0.8237604320078546 val_auprc:  0.925851058832968
EarlyStopping counter: 47 out of 50
epoch:  80
epoch:  81 val_f1:  0.7607703458551531 val_auroc:  0.8208149239077074 val_auprc:  0.9242703679198547
EarlyStopping counter: 48 out of 50
epoch:  81
epoch:  82 val_f1:  0.7580594896895918 val_auroc:  0.8058419243986255 val_auprc:  0.9143483391155296
EarlyStopping counter: 49 out of 50
epoch:  82
epoch:  83 val_f1:  0.7617596949267598 val_auroc:  0.8195876288659795 val_auprc:  0.923031780406967
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  46.135220527648926
{'time_elapsed': [46.135220527648926], 'epoch': [82], 'fold': [0], 'f1_train': [0.9803492824837834], 'auroc_train': [0.9998313762761749], 'auprc_train': [0.9999265056963137], 'f1_test': [0.7617596949267598], 'auroc_test': [0.8195876288659795], 'auprc_test': [0.923031780406967]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 183]            2,048
│    └─BatchNorm1d: 2-2                  [64, 256, 183]            512
│    └─Tanh: 2-3                         [64, 256, 183]            --
│    └─MaxPool1d: 2-4                    [64, 256, 26]             --
│    └─Dropout: 2-5                      [64, 256, 26]             --
│    └─Flatten: 2-6                      [64, 6656]                --
│    └─Linear: 2-7                       [64, 1]                   6,657
==========================================================================================
Total params: 9,217
Trainable params: 9,217
Non-trainable params: 0
Total mult-adds (M): 24.44
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 47.97
Params size (MB): 0.04
Estimated Total Size (MB): 48.34
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.6907216494845362 val_auprc:  0.8552102453671886
epoch:  1
epoch:  2 val_f1:  0.7078050864958872 val_auroc:  0.7297496318114876 val_auprc:  0.8868168375475358
Validation loss improved to 1.138847
epoch:  2
epoch:  3 val_f1:  0.6935516760810525 val_auroc:  0.7248404516445753 val_auprc:  0.8887896170888763
Validation loss improved to 1.118899
epoch:  3
epoch:  4 val_f1:  0.5875080026055255 val_auroc:  0.728767795778105 val_auprc:  0.8930107600508632
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.7078050864958872 val_auroc:  0.7349042709867453 val_auprc:  0.8944573832387566
Validation loss improved to 1.085965
epoch:  5
epoch:  6 val_f1:  0.6802976282278086 val_auroc:  0.7486499754540992 val_auprc:  0.9013402412335297
Validation loss improved to 1.082279
epoch:  6
epoch:  7 val_f1:  0.6963248678165901 val_auroc:  0.7565046637211585 val_auprc:  0.9035715859848042
Validation loss improved to 1.061025
epoch:  7
epoch:  8 val_f1:  0.7142089711496735 val_auroc:  0.7702503681885126 val_auprc:  0.9069889280527086
Validation loss improved to 1.044443
epoch:  8
epoch:  9 val_f1:  0.6729375272402062 val_auroc:  0.7763868433971526 val_auprc:  0.9113106144249836
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7337314237416728 val_auroc:  0.7916053019145803 val_auprc:  0.9149217438250591
Validation loss improved to 1.020949
epoch:  10
epoch:  11 val_f1:  0.72389147505525 val_auroc:  0.7928325969563084 val_auprc:  0.916118533172137
Validation loss improved to 1.015499
epoch:  11
epoch:  12 val_f1:  0.7371937993371881 val_auroc:  0.7965144820814924 val_auprc:  0.9169199464222664
Validation loss improved to 1.002515
epoch:  12
epoch:  13 val_f1:  0.7377728985642654 val_auroc:  0.7989690721649485 val_auprc:  0.9178907925618479
Validation loss improved to 1.001956
epoch:  13
epoch:  14 val_f1:  0.7428255465713769 val_auroc:  0.8024054982817869 val_auprc:  0.9171692891402486
Validation loss improved to 0.983297
epoch:  14
epoch:  15 val_f1:  0.7626195746699344 val_auroc:  0.8058419243986253 val_auprc:  0.9179759592736159
Validation loss improved to 0.974427
epoch:  15
epoch:  16 val_f1:  0.751502327549725 val_auroc:  0.8065783014236623 val_auprc:  0.9196412022776648
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7542604103291037 val_auroc:  0.8114874815905744 val_auprc:  0.9193257400518905
Validation loss improved to 0.964300
epoch:  17
epoch:  18 val_f1:  0.7644702419882276 val_auroc:  0.8112420225822289 val_auprc:  0.920151787785996
Validation loss improved to 0.960166
epoch:  18
epoch:  19 val_f1:  0.7786895152313162 val_auroc:  0.8100147275405007 val_auprc:  0.9191157555224068
Validation loss improved to 0.957268
epoch:  19
epoch:  20 val_f1:  0.7391701372600277 val_auroc:  0.8178694158075601 val_auprc:  0.9184569272154244
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7159484399162135 val_auroc:  0.8053510063819342 val_auprc:  0.9183729797373452
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7519437633413868 val_auroc:  0.8144329896907218 val_auprc:  0.918972993689972
Validation loss improved to 0.946439
epoch:  22
epoch:  23 val_f1:  0.7560320485424044 val_auroc:  0.8114874815905744 val_auprc:  0.9181997956654986
Validation loss improved to 0.938557
epoch:  23
epoch:  24 val_f1:  0.770628190185282 val_auroc:  0.8139420716740304 val_auprc:  0.9189907256423139
Validation loss improved to 0.938208
epoch:  24
epoch:  25 val_f1:  0.7466980132583976 val_auroc:  0.8159057437407953 val_auprc:  0.9191931635058725
Validation loss improved to 0.933140
epoch:  25
epoch:  26 val_f1:  0.7633550302615051 val_auroc:  0.8154148257241042 val_auprc:  0.9197939719639504
Validation loss improved to 0.931704
epoch:  26
epoch:  27 val_f1:  0.7699730743399811 val_auroc:  0.8163966617574865 val_auprc:  0.9192253406826726
Validation loss improved to 0.928474
epoch:  27
epoch:  28 val_f1:  0.7466980132583976 val_auroc:  0.8166421207658321 val_auprc:  0.9181387527637344
Validation loss improved to 0.925902
epoch:  28
epoch:  29 val_f1:  0.7560320485424044 val_auroc:  0.8149239077074127 val_auprc:  0.9177115383144596
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.7505653177403916 val_auroc:  0.817378497790869 val_auprc:  0.918444922805794
EarlyStopping counter: 2 out of 50
epoch:  30
epoch:  31 val_f1:  0.7653077537969624 val_auroc:  0.8171330387825233 val_auprc:  0.9216822430167808
EarlyStopping counter: 3 out of 50
epoch:  31
epoch:  32 val_f1:  0.7596459003010357 val_auroc:  0.8190967108492883 val_auprc:  0.9183833523852262
EarlyStopping counter: 4 out of 50
epoch:  32
epoch:  33 val_f1:  0.7596459003010357 val_auroc:  0.8190967108492881 val_auprc:  0.9183203852654914
Validation loss improved to 0.925315
epoch:  33
epoch:  34 val_f1:  0.7552115339652351 val_auroc:  0.8171330387825233 val_auprc:  0.9175993200365009
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.7596459003010357 val_auroc:  0.8159057437407954 val_auprc:  0.916415354221888
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.7683026725960121 val_auroc:  0.8188512518409427 val_auprc:  0.9172784262011928
Validation loss improved to 0.924767
epoch:  36
epoch:  37 val_f1:  0.7494347379239465 val_auroc:  0.8183603338242513 val_auprc:  0.9175003896039993
EarlyStopping counter: 1 out of 50
epoch:  37
epoch:  38 val_f1:  0.7617684906754855 val_auroc:  0.8225331369661266 val_auprc:  0.9177533739020403
EarlyStopping counter: 2 out of 50
epoch:  38
epoch:  39 val_f1:  0.7607703458551531 val_auroc:  0.8193421698576338 val_auprc:  0.9166879728044777
EarlyStopping counter: 3 out of 50
epoch:  39
epoch:  40 val_f1:  0.7560320485424044 val_auroc:  0.8181148748159058 val_auprc:  0.9159737980399842
EarlyStopping counter: 4 out of 50
epoch:  40
epoch:  41 val_f1:  0.7672775806504117 val_auroc:  0.818605792832597 val_auprc:  0.9157764162825572
EarlyStopping counter: 5 out of 50
epoch:  41
epoch:  42 val_f1:  0.7762067639678805 val_auroc:  0.8217967599410898 val_auprc:  0.916337043551472
EarlyStopping counter: 6 out of 50
epoch:  42
epoch:  43 val_f1:  0.7672775806504117 val_auroc:  0.8190967108492881 val_auprc:  0.915922550063007
EarlyStopping counter: 7 out of 50
epoch:  43
epoch:  44 val_f1:  0.7542604103291037 val_auroc:  0.817378497790869 val_auprc:  0.9149484545392763
EarlyStopping counter: 8 out of 50
epoch:  44
epoch:  45 val_f1:  0.7617596949267598 val_auroc:  0.8183603338242514 val_auprc:  0.9147882169049529
EarlyStopping counter: 9 out of 50
epoch:  45
epoch:  46 val_f1:  0.7762067639678805 val_auroc:  0.8217967599410899 val_auprc:  0.9161073025621929
EarlyStopping counter: 10 out of 50
epoch:  46
epoch:  47 val_f1:  0.7727225509205256 val_auroc:  0.8210603829160531 val_auprc:  0.9159326107810398
EarlyStopping counter: 11 out of 50
epoch:  47
epoch:  48 val_f1:  0.7494347379239465 val_auroc:  0.8173784977908689 val_auprc:  0.9155770192395776
EarlyStopping counter: 12 out of 50
epoch:  48
epoch:  49 val_f1:  0.7626195746699344 val_auroc:  0.817378497790869 val_auprc:  0.9148324911443964
EarlyStopping counter: 13 out of 50
epoch:  49
epoch:  50 val_f1:  0.7552115339652351 val_auroc:  0.8195876288659794 val_auprc:  0.9147758313069154
EarlyStopping counter: 14 out of 50
epoch:  50
epoch:  51 val_f1:  0.7622262794246104 val_auroc:  0.82793323514973 val_auprc:  0.9173855943128484
EarlyStopping counter: 15 out of 50
epoch:  51
epoch:  52 val_f1:  0.7748426784519089 val_auroc:  0.8217967599410899 val_auprc:  0.9154847757395097
EarlyStopping counter: 16 out of 50
epoch:  52
epoch:  53 val_f1:  0.7552115339652351 val_auroc:  0.819833087874325 val_auprc:  0.9151503175513259
EarlyStopping counter: 17 out of 50
epoch:  53
epoch:  54 val_f1:  0.7622262794246104 val_auroc:  0.8247422680412372 val_auprc:  0.915372180820948
EarlyStopping counter: 18 out of 50
epoch:  54
epoch:  55 val_f1:  0.7552115339652351 val_auroc:  0.821060382916053 val_auprc:  0.9159746385248668
EarlyStopping counter: 19 out of 50
epoch:  55
epoch:  56 val_f1:  0.7622262794246104 val_auroc:  0.8262150220913108 val_auprc:  0.9159162018678386
EarlyStopping counter: 20 out of 50
epoch:  56
epoch:  57 val_f1:  0.7777125328082551 val_auroc:  0.8225331369661266 val_auprc:  0.9162983145954655
EarlyStopping counter: 21 out of 50
epoch:  57
epoch:  58 val_f1:  0.7855581813618873 val_auroc:  0.8220422189494355 val_auprc:  0.9150408990487217
EarlyStopping counter: 22 out of 50
epoch:  58
epoch:  59 val_f1:  0.7868059619290214 val_auroc:  0.8230240549828179 val_auprc:  0.9146027389569984
EarlyStopping counter: 23 out of 50
epoch:  59
epoch:  60 val_f1:  0.7809570525397864 val_auroc:  0.8227785959744722 val_auprc:  0.9144154723978278
EarlyStopping counter: 24 out of 50
epoch:  60
epoch:  61 val_f1:  0.7697841726618705 val_auroc:  0.8220422189494354 val_auprc:  0.9143801982778496
EarlyStopping counter: 25 out of 50
epoch:  61
epoch:  62 val_f1:  0.7855581813618873 val_auroc:  0.8232695139911635 val_auprc:  0.914932376801691
EarlyStopping counter: 26 out of 50
epoch:  62
epoch:  63 val_f1:  0.7777125328082551 val_auroc:  0.8249877270495827 val_auprc:  0.9152359561447816
EarlyStopping counter: 27 out of 50
epoch:  63
epoch:  64 val_f1:  0.7777125328082551 val_auroc:  0.8215513009327442 val_auprc:  0.9131928083139575
EarlyStopping counter: 28 out of 50
epoch:  64
epoch:  65 val_f1:  0.7826417810500232 val_auroc:  0.822287677957781 val_auprc:  0.9133819524297703
EarlyStopping counter: 29 out of 50
epoch:  65
epoch:  66 val_f1:  0.7672775806504117 val_auroc:  0.8244968090328915 val_auprc:  0.9157013086663914
EarlyStopping counter: 30 out of 50
epoch:  66
epoch:  67 val_f1:  0.7777125328082551 val_auroc:  0.8252331860579283 val_auprc:  0.9147607888901397
EarlyStopping counter: 31 out of 50
epoch:  67
epoch:  68 val_f1:  0.7745465218349855 val_auroc:  0.8220422189494354 val_auprc:  0.9123202046876532
EarlyStopping counter: 32 out of 50
epoch:  68
epoch:  69 val_f1:  0.7777125328082551 val_auroc:  0.8225331369661266 val_auprc:  0.9124140158062606
EarlyStopping counter: 33 out of 50
epoch:  69
epoch:  70 val_f1:  0.7777125328082551 val_auroc:  0.8227785959744722 val_auprc:  0.9131309175799573
EarlyStopping counter: 34 out of 50
epoch:  70
epoch:  71 val_f1:  0.7919479944965341 val_auroc:  0.8220422189494354 val_auprc:  0.9114831282805297
EarlyStopping counter: 35 out of 50
epoch:  71
epoch:  72 val_f1:  0.7777125328082551 val_auroc:  0.8257241040746196 val_auprc:  0.9141117051773385
EarlyStopping counter: 36 out of 50
epoch:  72
epoch:  73 val_f1:  0.7873856121514594 val_auroc:  0.8237604320078548 val_auprc:  0.9118671384537272
EarlyStopping counter: 37 out of 50
epoch:  73
epoch:  74 val_f1:  0.7790721385700611 val_auroc:  0.8193421698576339 val_auprc:  0.9112107112139882
EarlyStopping counter: 38 out of 50
epoch:  74
epoch:  75 val_f1:  0.7919479944965341 val_auroc:  0.8225331369661266 val_auprc:  0.9100548720718596
EarlyStopping counter: 39 out of 50
epoch:  75
epoch:  76 val_f1:  0.7724732835091151 val_auroc:  0.8217967599410898 val_auprc:  0.9093330577710914
EarlyStopping counter: 40 out of 50
epoch:  76
epoch:  77 val_f1:  0.7984066342984726 val_auroc:  0.8232695139911634 val_auprc:  0.9109274751104524
EarlyStopping counter: 41 out of 50
epoch:  77
epoch:  78 val_f1:  0.7402181480621955 val_auroc:  0.8213058419243986 val_auprc:  0.9129424526061197
EarlyStopping counter: 42 out of 50
epoch:  78
epoch:  79 val_f1:  0.7890919075230509 val_auroc:  0.8213058419243987 val_auprc:  0.9110935919581549
EarlyStopping counter: 43 out of 50
epoch:  79
epoch:  80 val_f1:  0.7834737923946559 val_auroc:  0.8225331369661267 val_auprc:  0.9104008646681836
EarlyStopping counter: 44 out of 50
epoch:  80
epoch:  81 val_f1:  0.7873856121514594 val_auroc:  0.821060382916053 val_auprc:  0.9094200597507421
EarlyStopping counter: 45 out of 50
epoch:  81
epoch:  82 val_f1:  0.7971323289800215 val_auroc:  0.819833087874325 val_auprc:  0.9103062192663368
EarlyStopping counter: 46 out of 50
epoch:  82
epoch:  83 val_f1:  0.7788179744018625 val_auroc:  0.8200785468826706 val_auprc:  0.9073658904865588
EarlyStopping counter: 47 out of 50
epoch:  83
epoch:  84 val_f1:  0.7955599157038007 val_auroc:  0.8181148748159058 val_auprc:  0.9077171482365383
EarlyStopping counter: 48 out of 50
epoch:  84
epoch:  85 val_f1:  0.7289242247644242 val_auroc:  0.8159057437407954 val_auprc:  0.9084704483864381
EarlyStopping counter: 49 out of 50
epoch:  85
epoch:  86 val_f1:  0.7984066342984726 val_auroc:  0.8181148748159057 val_auprc:  0.9063640412254181
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  41.480685234069824
{'time_elapsed': [41.480685234069824], 'epoch': [85], 'fold': [1], 'f1_train': [0.9909984361966043], 'auroc_train': [0.9998620351350523], 'auprc_train': [0.9999397419393243], 'f1_test': [0.7984066342984726], 'auroc_test': [0.8181148748159057], 'auprc_test': [0.9063640412254181]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 183]            2,048
│    └─BatchNorm1d: 2-2                  [64, 256, 183]            512
│    └─Tanh: 2-3                         [64, 256, 183]            --
│    └─MaxPool1d: 2-4                    [64, 256, 26]             --
│    └─Dropout: 2-5                      [64, 256, 26]             --
│    └─Flatten: 2-6                      [64, 6656]                --
│    └─Linear: 2-7                       [64, 1]                   6,657
==========================================================================================
Total params: 9,217
Trainable params: 9,217
Non-trainable params: 0
Total mult-adds (M): 24.44
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 47.97
Params size (MB): 0.04
Estimated Total Size (MB): 48.34
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.6303387334315169 val_auprc:  0.7696430755292967
epoch:  1
epoch:  2 val_f1:  0.3354312205907036 val_auroc:  0.6423662248404516 val_auprc:  0.7973600564185288
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.5990762945199395 val_auroc:  0.6698576337751595 val_auprc:  0.8180439189424606
Validation loss improved to 1.148509
epoch:  3
epoch:  4 val_f1:  0.5755146630138848 val_auroc:  0.68826705940108 val_auprc:  0.8359803181986152
Validation loss improved to 1.138968
epoch:  4
epoch:  5 val_f1:  0.5729592891364544 val_auroc:  0.7042218949435444 val_auprc:  0.8482146602198195
Validation loss improved to 1.130959
epoch:  5
epoch:  6 val_f1:  0.6342292324329559 val_auroc:  0.7206676485027 val_auprc:  0.8590586816374743
Validation loss improved to 1.114814
epoch:  6
epoch:  7 val_f1:  0.6161922226924342 val_auroc:  0.7201767304860088 val_auprc:  0.8611472472024078
Validation loss improved to 1.110285
epoch:  7
epoch:  8 val_f1:  0.6237171971681137 val_auroc:  0.7270495827196859 val_auprc:  0.8659520801974936
Validation loss improved to 1.103433
epoch:  8
epoch:  9 val_f1:  0.6311848711432113 val_auroc:  0.73073146784487 val_auprc:  0.870735320062997
Validation loss improved to 1.095462
epoch:  9
epoch:  10 val_f1:  0.6057912921222274 val_auroc:  0.7302405498281787 val_auprc:  0.8695838323801675
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.6684270836950449 val_auroc:  0.7376043200785469 val_auprc:  0.874868092141632
Validation loss improved to 1.073460
epoch:  11
epoch:  12 val_f1:  0.6590199752078746 val_auroc:  0.7385861561119293 val_auprc:  0.8739285535850614
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.6743799189283424 val_auroc:  0.7417771232204222 val_auprc:  0.8764527246296652
Validation loss improved to 1.065668
epoch:  13
epoch:  14 val_f1:  0.681579990245092 val_auroc:  0.7449680903289151 val_auprc:  0.8769214269099108
Validation loss improved to 1.061823
epoch:  14
epoch:  15 val_f1:  0.6752910608296504 val_auroc:  0.7461953853706431 val_auprc:  0.8758697666672535
Validation loss improved to 1.055620
epoch:  15
epoch:  16 val_f1:  0.7084342413709481 val_auroc:  0.7503681885125184 val_auprc:  0.8771612650476663
Validation loss improved to 1.044848
epoch:  16
epoch:  17 val_f1:  0.6894622188638474 val_auroc:  0.7491408934707904 val_auprc:  0.8760197831178342
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.6894399143298684 val_auroc:  0.7486499754540992 val_auprc:  0.8763135386938657
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.6441055155875299 val_auroc:  0.7464408443789887 val_auprc:  0.8743168767379457
EarlyStopping counter: 3 out of 50
epoch:  19
epoch:  20 val_f1:  0.7163649790827238 val_auroc:  0.7596956308296514 val_auprc:  0.8805284616126119
Validation loss improved to 1.040128
epoch:  20
epoch:  21 val_f1:  0.6614736591628271 val_auroc:  0.7528227785959745 val_auprc:  0.8777322315453723
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7184536707983012 val_auroc:  0.7609229258713796 val_auprc:  0.8814615551438881
Validation loss improved to 1.031673
epoch:  22
epoch:  23 val_f1:  0.6524974219867484 val_auroc:  0.751840942562592 val_auprc:  0.8767903806252213
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7054786939679025 val_auroc:  0.7636229749631811 val_auprc:  0.8823744751338016
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.7362024088594293 val_auroc:  0.7606774668630338 val_auprc:  0.8806548954318356
Validation loss improved to 1.025470
epoch:  25
epoch:  26 val_f1:  0.7095299887411026 val_auroc:  0.761168384879725 val_auprc:  0.8805018115162716
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7229061670449737 val_auroc:  0.7584683357879234 val_auprc:  0.8777326276153599
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.6945501576267077 val_auroc:  0.7542955326460481 val_auprc:  0.8747175758852789
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.713247796930704 val_auroc:  0.7567501227295043 val_auprc:  0.8764250720524345
EarlyStopping counter: 4 out of 50
epoch:  29
epoch:  30 val_f1:  0.7197172881491292 val_auroc:  0.758713794796269 val_auprc:  0.877571984192226
EarlyStopping counter: 5 out of 50
epoch:  30
epoch:  31 val_f1:  0.6824751963135375 val_auroc:  0.7540500736377025 val_auprc:  0.875334929675136
EarlyStopping counter: 6 out of 50
epoch:  31
epoch:  32 val_f1:  0.706765356945213 val_auroc:  0.7601865488463426 val_auprc:  0.8780197990072676
EarlyStopping counter: 7 out of 50
epoch:  32
epoch:  33 val_f1:  0.7326256806616418 val_auroc:  0.7589592538046146 val_auprc:  0.8765433270707986
EarlyStopping counter: 8 out of 50
epoch:  33
epoch:  34 val_f1:  0.675161142762091 val_auroc:  0.7555228276877761 val_auprc:  0.8748597158935553
EarlyStopping counter: 9 out of 50
epoch:  34
epoch:  35 val_f1:  0.7163649790827238 val_auroc:  0.758713794796269 val_auprc:  0.874527901626524
EarlyStopping counter: 10 out of 50
epoch:  35
epoch:  36 val_f1:  0.7002679453520968 val_auroc:  0.7572410407461954 val_auprc:  0.8754178337645735
EarlyStopping counter: 11 out of 50
epoch:  36
epoch:  37 val_f1:  0.6879576385879046 val_auroc:  0.7550319096710849 val_auprc:  0.8728121579299484
EarlyStopping counter: 12 out of 50
epoch:  37
epoch:  38 val_f1:  0.7266187050359713 val_auroc:  0.7584683357879234 val_auprc:  0.87417576980819
EarlyStopping counter: 13 out of 50
epoch:  38
epoch:  39 val_f1:  0.6684270836950449 val_auroc:  0.7496318114874816 val_auprc:  0.8713348015111223
EarlyStopping counter: 14 out of 50
epoch:  39
epoch:  40 val_f1:  0.675161142762091 val_auroc:  0.751840942562592 val_auprc:  0.8727671009392922
EarlyStopping counter: 15 out of 50
epoch:  40
epoch:  41 val_f1:  0.7115566705387387 val_auroc:  0.7604320078546882 val_auprc:  0.8739365056069373
EarlyStopping counter: 16 out of 50
epoch:  41
epoch:  42 val_f1:  0.6747016034883605 val_auroc:  0.7535591556210113 val_auprc:  0.8722140391580333
EarlyStopping counter: 17 out of 50
epoch:  42
epoch:  43 val_f1:  0.7197172881491292 val_auroc:  0.7518409425625922 val_auprc:  0.864469101472894
EarlyStopping counter: 18 out of 50
epoch:  43
epoch:  44 val_f1:  0.7237424247793883 val_auroc:  0.7628865979381443 val_auprc:  0.8692651050669187
EarlyStopping counter: 19 out of 50
epoch:  44
epoch:  45 val_f1:  0.682242621874418 val_auroc:  0.7513500245459008 val_auprc:  0.8655668273336872
EarlyStopping counter: 20 out of 50
epoch:  45
epoch:  46 val_f1:  0.6885440884463027 val_auroc:  0.7528227785959746 val_auprc:  0.8659306735008134
EarlyStopping counter: 21 out of 50
epoch:  46
epoch:  47 val_f1:  0.7426698176342648 val_auroc:  0.7552773686794305 val_auprc:  0.866486683802174
EarlyStopping counter: 22 out of 50
epoch:  47
epoch:  48 val_f1:  0.7197172881491292 val_auroc:  0.7528227785959745 val_auprc:  0.8626746570956231
EarlyStopping counter: 23 out of 50
epoch:  48
epoch:  49 val_f1:  0.7441671543148256 val_auroc:  0.7565046637211587 val_auprc:  0.8669103680990986
EarlyStopping counter: 24 out of 50
epoch:  49
epoch:  50 val_f1:  0.7272357092755477 val_auroc:  0.7550319096710849 val_auprc:  0.866951128930128
EarlyStopping counter: 25 out of 50
epoch:  50
epoch:  51 val_f1:  0.7377691212466089 val_auroc:  0.7565046637211585 val_auprc:  0.8672781356134667
EarlyStopping counter: 26 out of 50
epoch:  51
epoch:  52 val_f1:  0.7249644134959412 val_auroc:  0.7579774177712322 val_auprc:  0.8675542442125017
EarlyStopping counter: 27 out of 50
epoch:  52
epoch:  53 val_f1:  0.7313689473952751 val_auroc:  0.7567501227295043 val_auprc:  0.8652604708489507
EarlyStopping counter: 28 out of 50
epoch:  53
epoch:  54 val_f1:  0.7197172881491292 val_auroc:  0.7533136966126657 val_auprc:  0.8605995362158181
EarlyStopping counter: 29 out of 50
epoch:  54
epoch:  55 val_f1:  0.7298555432283743 val_auroc:  0.7604320078546882 val_auprc:  0.8656558211973797
EarlyStopping counter: 30 out of 50
epoch:  55
epoch:  56 val_f1:  0.7249644134959412 val_auroc:  0.7550319096710849 val_auprc:  0.8670300424897085
EarlyStopping counter: 31 out of 50
epoch:  56
epoch:  57 val_f1:  0.7246795893300292 val_auroc:  0.7555228276877761 val_auprc:  0.8663056299672135
EarlyStopping counter: 32 out of 50
epoch:  57
epoch:  58 val_f1:  0.7326256806616418 val_auroc:  0.7535591556210113 val_auprc:  0.860890709944462
EarlyStopping counter: 33 out of 50
epoch:  58
epoch:  59 val_f1:  0.7299542184434271 val_auroc:  0.7540500736377025 val_auprc:  0.8629753218583038
EarlyStopping counter: 34 out of 50
epoch:  59
epoch:  60 val_f1:  0.7184536707983012 val_auroc:  0.7555228276877761 val_auprc:  0.8654904544671008
EarlyStopping counter: 35 out of 50
epoch:  60
epoch:  61 val_f1:  0.7410071942446043 val_auroc:  0.7552773686794305 val_auprc:  0.8628488151089997
EarlyStopping counter: 36 out of 50
epoch:  61
epoch:  62 val_f1:  0.7272357092755477 val_auroc:  0.7523318605792833 val_auprc:  0.8628491581059491
EarlyStopping counter: 37 out of 50
epoch:  62
epoch:  63 val_f1:  0.7263486361521366 val_auroc:  0.7579774177712322 val_auprc:  0.8638020155578369
EarlyStopping counter: 38 out of 50
epoch:  63
epoch:  64 val_f1:  0.7185533480648861 val_auroc:  0.7523318605792833 val_auprc:  0.862479015945702
EarlyStopping counter: 39 out of 50
epoch:  64
epoch:  65 val_f1:  0.7142089711496735 val_auroc:  0.7488954344624448 val_auprc:  0.8581177319441522
EarlyStopping counter: 40 out of 50
epoch:  65
epoch:  66 val_f1:  0.7263486361521366 val_auroc:  0.7574864997545411 val_auprc:  0.8640881931111151
EarlyStopping counter: 41 out of 50
epoch:  66
epoch:  67 val_f1:  0.7391701372600277 val_auroc:  0.757486499754541 val_auprc:  0.8664297027376725
EarlyStopping counter: 42 out of 50
epoch:  67
epoch:  68 val_f1:  0.6951967837494709 val_auroc:  0.7484045164457536 val_auprc:  0.8574987133849139
EarlyStopping counter: 43 out of 50
epoch:  68
epoch:  69 val_f1:  0.7330561760022478 val_auroc:  0.7584683357879234 val_auprc:  0.8630613638040078
EarlyStopping counter: 44 out of 50
epoch:  69
epoch:  70 val_f1:  0.7249644134959412 val_auroc:  0.7498772704958272 val_auprc:  0.8563553597810785
EarlyStopping counter: 45 out of 50
epoch:  70
epoch:  71 val_f1:  0.7326256806616418 val_auroc:  0.7457044673539519 val_auprc:  0.8537770915670608
EarlyStopping counter: 46 out of 50
epoch:  71
epoch:  72 val_f1:  0.7140703059967902 val_auroc:  0.7484045164457536 val_auprc:  0.8584546541831252
EarlyStopping counter: 47 out of 50
epoch:  72
epoch:  73 val_f1:  0.726967940210938 val_auroc:  0.7547864506627393 val_auprc:  0.8611129529355273
EarlyStopping counter: 48 out of 50
epoch:  73
epoch:  74 val_f1:  0.7197172881491292 val_auroc:  0.7444771723122239 val_auprc:  0.8533805320803833
EarlyStopping counter: 49 out of 50
epoch:  74
epoch:  75 val_f1:  0.702782849280763 val_auroc:  0.7496318114874817 val_auprc:  0.8580823594850894
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  35.97433376312256
{'time_elapsed': [35.97433376312256], 'epoch': [74], 'fold': [2], 'f1_train': [0.9838741042833115], 'auroc_train': [0.9981298096084864], 'auprc_train': [0.9992314835690725], 'f1_test': [0.702782849280763], 'auroc_test': [0.7496318114874817], 'auprc_test': [0.8580823594850894]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 183]            2,048
│    └─BatchNorm1d: 2-2                  [64, 256, 183]            512
│    └─Tanh: 2-3                         [64, 256, 183]            --
│    └─MaxPool1d: 2-4                    [64, 256, 26]             --
│    └─Dropout: 2-5                      [64, 256, 26]             --
│    └─Flatten: 2-6                      [64, 6656]                --
│    └─Linear: 2-7                       [64, 1]                   6,657
==========================================================================================
Total params: 9,217
Trainable params: 9,217
Non-trainable params: 0
Total mult-adds (M): 24.44
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 47.97
Params size (MB): 0.04
Estimated Total Size (MB): 48.34
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1461775634437505 val_auroc:  0.6361434108527133 val_auprc:  0.814871472587965
epoch:  1
epoch:  2 val_f1:  0.5631373487488595 val_auroc:  0.689922480620155 val_auprc:  0.8477405649291827
Validation loss improved to 1.191336
epoch:  2
epoch:  3 val_f1:  0.6399214323016126 val_auroc:  0.7233527131782945 val_auprc:  0.8690069517485196
Validation loss improved to 1.174441
epoch:  3
epoch:  4 val_f1:  0.6746390555463059 val_auroc:  0.7335271317829457 val_auprc:  0.8768368291412311
Validation loss improved to 1.140984
epoch:  4
epoch:  5 val_f1:  0.6792159081723385 val_auroc:  0.7502422480620154 val_auprc:  0.8869711097400099
Validation loss improved to 1.114491
epoch:  5
epoch:  6 val_f1:  0.7022349765809198 val_auroc:  0.7638081395348837 val_auprc:  0.8939763587593562
Validation loss improved to 1.094829
epoch:  6
epoch:  7 val_f1:  0.7193124621182175 val_auroc:  0.7742248062015503 val_auprc:  0.8985524866475963
Validation loss improved to 1.075527
epoch:  7
epoch:  8 val_f1:  0.726807606714082 val_auroc:  0.7848837209302325 val_auprc:  0.9035903879519007
Validation loss improved to 1.054252
epoch:  8
epoch:  9 val_f1:  0.7311239367552241 val_auroc:  0.7921511627906977 val_auprc:  0.9051213666888702
Validation loss improved to 1.038004
epoch:  9
epoch:  10 val_f1:  0.7695564219015847 val_auroc:  0.7991763565891473 val_auprc:  0.9099979703454946
Validation loss improved to 1.021216
epoch:  10
epoch:  11 val_f1:  0.7102877344663298 val_auroc:  0.803779069767442 val_auprc:  0.9105555873560504
Validation loss improved to 1.015802
epoch:  11
epoch:  12 val_f1:  0.7695564219015847 val_auroc:  0.804748062015504 val_auprc:  0.9124200908236967
Validation loss improved to 0.990658
epoch:  12
epoch:  13 val_f1:  0.7504468335444003 val_auroc:  0.8049903100775194 val_auprc:  0.9109458559289667
Validation loss improved to 0.983635
epoch:  13
epoch:  14 val_f1:  0.7622179807174668 val_auroc:  0.8054748062015503 val_auprc:  0.912250924486876
Validation loss improved to 0.965814
epoch:  14
epoch:  15 val_f1:  0.7754499696945739 val_auroc:  0.8086240310077518 val_auprc:  0.913345240090186
Validation loss improved to 0.953604
epoch:  15
epoch:  16 val_f1:  0.7555901444410748 val_auroc:  0.810077519379845 val_auprc:  0.913828696509493
Validation loss improved to 0.943414
epoch:  16
epoch:  17 val_f1:  0.7594266802546743 val_auroc:  0.8137112403100775 val_auprc:  0.9152033876523683
Validation loss improved to 0.934764
epoch:  17
epoch:  18 val_f1:  0.7644817479349855 val_auroc:  0.8171027131782946 val_auprc:  0.9181495070933252
Validation loss improved to 0.926836
epoch:  18
epoch:  19 val_f1:  0.7102877344663298 val_auroc:  0.8156492248062015 val_auprc:  0.9147060756525902
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7614155928004849 val_auroc:  0.8180717054263567 val_auprc:  0.9165289220827921
Validation loss improved to 0.900015
epoch:  20
epoch:  21 val_f1:  0.7840893588200424 val_auroc:  0.8180717054263567 val_auprc:  0.9168417199182017
Validation loss improved to 0.891140
epoch:  21
epoch:  22 val_f1:  0.7840893588200424 val_auroc:  0.8195251937984496 val_auprc:  0.9167330666187807
Validation loss improved to 0.878432
epoch:  22
epoch:  23 val_f1:  0.7452753085049493 val_auroc:  0.8192829457364341 val_auprc:  0.9171463152857251
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7539369712168144 val_auroc:  0.8226744186046511 val_auprc:  0.9184550407125054
Validation loss improved to 0.869422
epoch:  24
epoch:  25 val_f1:  0.7840893588200424 val_auroc:  0.8248546511627908 val_auprc:  0.9205724247403322
Validation loss improved to 0.855295
epoch:  25
epoch:  26 val_f1:  0.7688372056811462 val_auroc:  0.8263081395348837 val_auprc:  0.9220065677100575
Validation loss improved to 0.853360
epoch:  26
epoch:  27 val_f1:  0.7768458491633659 val_auroc:  0.8255813953488372 val_auprc:  0.9229242940219342
Validation loss improved to 0.844438
epoch:  27
epoch:  28 val_f1:  0.7517526908132072 val_auroc:  0.8289728682170543 val_auprc:  0.9220233513017806
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.7695564219015847 val_auroc:  0.8301841085271318 val_auprc:  0.9238340272107959
Validation loss improved to 0.831128
epoch:  29
epoch:  30 val_f1:  0.7266187050359713 val_auroc:  0.8309108527131783 val_auprc:  0.9222301067052157
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7773759601944114 val_auroc:  0.8316375968992249 val_auprc:  0.925507107965258
Validation loss improved to 0.818079
epoch:  31
epoch:  32 val_f1:  0.7594266802546743 val_auroc:  0.8352713178294574 val_auprc:  0.9258861844523587
EarlyStopping counter: 1 out of 50
epoch:  32
epoch:  33 val_f1:  0.7548273393587915 val_auroc:  0.8369670542635659 val_auprc:  0.9271480212854099
Validation loss improved to 0.814479
epoch:  33
epoch:  34 val_f1:  0.7773759601944114 val_auroc:  0.8401162790697674 val_auprc:  0.9290017294665083
Validation loss improved to 0.803953
epoch:  34
epoch:  35 val_f1:  0.7659382513381667 val_auroc:  0.8398740310077519 val_auprc:  0.9282106272415918
EarlyStopping counter: 1 out of 50
epoch:  35
epoch:  36 val_f1:  0.7659382513381667 val_auroc:  0.8413275193798451 val_auprc:  0.9288063393450717
EarlyStopping counter: 2 out of 50
epoch:  36
epoch:  37 val_f1:  0.7659382513381667 val_auroc:  0.8430232558139534 val_auprc:  0.9302516521042311
EarlyStopping counter: 3 out of 50
epoch:  37
epoch:  38 val_f1:  0.767033173809688 val_auroc:  0.8435077519379846 val_auprc:  0.9304564377954881
EarlyStopping counter: 4 out of 50
epoch:  38
epoch:  39 val_f1:  0.7762051583223217 val_auroc:  0.8452034883720929 val_auprc:  0.9318245192337649
Validation loss improved to 0.789418
epoch:  39
epoch:  40 val_f1:  0.7811523753969797 val_auroc:  0.8452034883720931 val_auprc:  0.9319339666491852
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.7735780520043992 val_auroc:  0.8468992248062015 val_auprc:  0.9327532278326132
EarlyStopping counter: 2 out of 50
epoch:  41
epoch:  42 val_f1:  0.7537445742963803 val_auroc:  0.8512596899224805 val_auprc:  0.9345231425935789
EarlyStopping counter: 3 out of 50
epoch:  42
epoch:  43 val_f1:  0.7768458491633659 val_auroc:  0.8505329457364341 val_auprc:  0.935217875164676
Validation loss improved to 0.767073
epoch:  43
epoch:  44 val_f1:  0.7695564219015847 val_auroc:  0.8515019379844961 val_auprc:  0.9358975481469666
Validation loss improved to 0.762808
epoch:  44
epoch:  45 val_f1:  0.7618084502224494 val_auroc:  0.8544089147286822 val_auprc:  0.9367128055617417
EarlyStopping counter: 1 out of 50
epoch:  45
epoch:  46 val_f1:  0.7894843465886632 val_auroc:  0.8536821705426356 val_auprc:  0.9373564705973632
EarlyStopping counter: 2 out of 50
epoch:  46
epoch:  47 val_f1:  0.7961192047225032 val_auroc:  0.8541666666666667 val_auprc:  0.9375691477885066
EarlyStopping counter: 3 out of 50
epoch:  47
epoch:  48 val_f1:  0.7601256159113488 val_auroc:  0.8580426356589148 val_auprc:  0.9386689655737335
EarlyStopping counter: 4 out of 50
epoch:  48
epoch:  49 val_f1:  0.7961192047225032 val_auroc:  0.8563468992248062 val_auprc:  0.9388777074504452
Validation loss improved to 0.752401
epoch:  49
epoch:  50 val_f1:  0.7537445742963803 val_auroc:  0.8582848837209301 val_auprc:  0.9395742267999078
EarlyStopping counter: 1 out of 50
epoch:  50
epoch:  51 val_f1:  0.7801238118631262 val_auroc:  0.8580426356589147 val_auprc:  0.9399326777093581
EarlyStopping counter: 2 out of 50
epoch:  51
epoch:  52 val_f1:  0.7618084502224494 val_auroc:  0.8597383720930233 val_auprc:  0.9402428962348246
EarlyStopping counter: 3 out of 50
epoch:  52
epoch:  53 val_f1:  0.7811523753969797 val_auroc:  0.8570736434108527 val_auprc:  0.9397782682818523
EarlyStopping counter: 4 out of 50
epoch:  53
epoch:  54 val_f1:  0.7682301875730638 val_auroc:  0.8602228682170543 val_auprc:  0.9407724030805934
EarlyStopping counter: 5 out of 50
epoch:  54
epoch:  55 val_f1:  0.7768458491633659 val_auroc:  0.8599806201550387 val_auprc:  0.9421131995169516
Validation loss improved to 0.735536
epoch:  55
epoch:  56 val_f1:  0.7811523753969797 val_auroc:  0.8648255813953488 val_auprc:  0.9439418219260385
EarlyStopping counter: 1 out of 50
epoch:  56
epoch:  57 val_f1:  0.7735780520043992 val_auroc:  0.8650678294573644 val_auprc:  0.9436966858520021
EarlyStopping counter: 2 out of 50
epoch:  57
epoch:  58 val_f1:  0.7776763243674784 val_auroc:  0.8648255813953489 val_auprc:  0.9431041270012221
EarlyStopping counter: 3 out of 50
epoch:  58
epoch:  59 val_f1:  0.7697841726618705 val_auroc:  0.8640988372093023 val_auprc:  0.9430521946843047
EarlyStopping counter: 4 out of 50
epoch:  59
epoch:  60 val_f1:  0.7866727894280321 val_auroc:  0.8653100775193798 val_auprc:  0.944102988814242
EarlyStopping counter: 5 out of 50
epoch:  60
epoch:  61 val_f1:  0.7968569383258559 val_auroc:  0.8621608527131782 val_auprc:  0.943349332903515
Validation loss improved to 0.728020
epoch:  61
epoch:  62 val_f1:  0.792019787311512 val_auroc:  0.8636143410852714 val_auprc:  0.9435393933906493
EarlyStopping counter: 1 out of 50
epoch:  62
epoch:  63 val_f1:  0.7729252582141845 val_auroc:  0.8655523255813953 val_auprc:  0.9440810202702273
EarlyStopping counter: 2 out of 50
epoch:  63
epoch:  64 val_f1:  0.7901923359271766 val_auroc:  0.8570736434108528 val_auprc:  0.9416501888484149
EarlyStopping counter: 3 out of 50
epoch:  64
epoch:  65 val_f1:  0.7820584602206068 val_auroc:  0.8575581395348837 val_auprc:  0.9419945649128076
EarlyStopping counter: 4 out of 50
epoch:  65
epoch:  66 val_f1:  0.7665182935781787 val_auroc:  0.8672480620155039 val_auprc:  0.9458752876272356
EarlyStopping counter: 5 out of 50
epoch:  66
epoch:  67 val_f1:  0.7746634573712671 val_auroc:  0.8672480620155039 val_auprc:  0.9458163697606321
EarlyStopping counter: 6 out of 50
epoch:  67
epoch:  68 val_f1:  0.767033173809688 val_auroc:  0.8674903100775193 val_auprc:  0.9459446590878869
EarlyStopping counter: 7 out of 50
epoch:  68
epoch:  69 val_f1:  0.7735780520043992 val_auroc:  0.8694282945736433 val_auprc:  0.9466216291105838
EarlyStopping counter: 8 out of 50
epoch:  69
epoch:  70 val_f1:  0.7811109002295425 val_auroc:  0.8703972868217054 val_auprc:  0.9469849652625685
EarlyStopping counter: 9 out of 50
epoch:  70
epoch:  71 val_f1:  0.7776763243674784 val_auroc:  0.8684593023255814 val_auprc:  0.9462147015995646
EarlyStopping counter: 10 out of 50
epoch:  71
epoch:  72 val_f1:  0.7820584602206068 val_auroc:  0.8633720930232558 val_auprc:  0.944469632268736
EarlyStopping counter: 11 out of 50
epoch:  72
epoch:  73 val_f1:  0.7854893118997625 val_auroc:  0.8657945736434108 val_auprc:  0.9452170429215813
EarlyStopping counter: 12 out of 50
epoch:  73
epoch:  74 val_f1:  0.792019787311512 val_auroc:  0.8679748062015504 val_auprc:  0.9463331612070138
EarlyStopping counter: 13 out of 50
epoch:  74
epoch:  75 val_f1:  0.7841726618705036 val_auroc:  0.8696705426356589 val_auprc:  0.9469490768800133
EarlyStopping counter: 14 out of 50
epoch:  75
epoch:  76 val_f1:  0.792019787311512 val_auroc:  0.8708817829457365 val_auprc:  0.9473319248517593
EarlyStopping counter: 15 out of 50
epoch:  76
epoch:  77 val_f1:  0.7746634573712671 val_auroc:  0.8711240310077519 val_auprc:  0.9473530814208242
EarlyStopping counter: 16 out of 50
epoch:  77
epoch:  78 val_f1:  0.7789671954250403 val_auroc:  0.866763565891473 val_auprc:  0.9459219217064727
EarlyStopping counter: 17 out of 50
epoch:  78
epoch:  79 val_f1:  0.7854893118997625 val_auroc:  0.8679748062015504 val_auprc:  0.9459406940262529
EarlyStopping counter: 18 out of 50
epoch:  79
epoch:  80 val_f1:  0.7827158008497472 val_auroc:  0.874031007751938 val_auprc:  0.9482067267198803
EarlyStopping counter: 19 out of 50
epoch:  80
epoch:  81 val_f1:  0.7854893118997625 val_auroc:  0.8677325581395349 val_auprc:  0.9460740858035066
EarlyStopping counter: 20 out of 50
epoch:  81
epoch:  82 val_f1:  0.792019787311512 val_auroc:  0.8665213178294573 val_auprc:  0.9458998701376573
EarlyStopping counter: 21 out of 50
epoch:  82
epoch:  83 val_f1:  0.7729252582141845 val_auroc:  0.8728197674418605 val_auprc:  0.9482216119209843
EarlyStopping counter: 22 out of 50
epoch:  83
epoch:  84 val_f1:  0.7932273763653603 val_auroc:  0.8679748062015504 val_auprc:  0.945911061296458
EarlyStopping counter: 23 out of 50
epoch:  84
epoch:  85 val_f1:  0.7746634573712671 val_auroc:  0.874031007751938 val_auprc:  0.9484072725437501
EarlyStopping counter: 24 out of 50
epoch:  85
epoch:  86 val_f1:  0.792019787311512 val_auroc:  0.8703972868217054 val_auprc:  0.9468622435664833
EarlyStopping counter: 25 out of 50
epoch:  86
epoch:  87 val_f1:  0.792019787311512 val_auroc:  0.8713662790697674 val_auprc:  0.9476651229765463
EarlyStopping counter: 26 out of 50
epoch:  87
epoch:  88 val_f1:  0.7801238118631262 val_auroc:  0.8687015503875969 val_auprc:  0.9462249289058344
EarlyStopping counter: 27 out of 50
epoch:  88
epoch:  89 val_f1:  0.7453578564975014 val_auroc:  0.8742732558139534 val_auprc:  0.9486595365503163
EarlyStopping counter: 28 out of 50
epoch:  89
epoch:  90 val_f1:  0.7801238118631262 val_auroc:  0.8701550387596899 val_auprc:  0.9470417738476733
EarlyStopping counter: 29 out of 50
epoch:  90
epoch:  91 val_f1:  0.7866727894280321 val_auroc:  0.8703972868217054 val_auprc:  0.9471180523040744
EarlyStopping counter: 30 out of 50
epoch:  91
epoch:  92 val_f1:  0.7540304643278981 val_auroc:  0.874515503875969 val_auprc:  0.9489096282730454
EarlyStopping counter: 31 out of 50
epoch:  92
epoch:  93 val_f1:  0.794309372388086 val_auroc:  0.8718507751937985 val_auprc:  0.9474978977545494
EarlyStopping counter: 32 out of 50
epoch:  93
epoch:  94 val_f1:  0.7827158008497472 val_auroc:  0.8728197674418605 val_auprc:  0.9480041591261432
EarlyStopping counter: 33 out of 50
epoch:  94
epoch:  95 val_f1:  0.7827158008497472 val_auroc:  0.8725775193798448 val_auprc:  0.9479491728060467
EarlyStopping counter: 34 out of 50
epoch:  95
epoch:  96 val_f1:  0.792019787311512 val_auroc:  0.8711240310077519 val_auprc:  0.9473888785360012
EarlyStopping counter: 35 out of 50
epoch:  96
epoch:  97 val_f1:  0.7827158008497472 val_auroc:  0.8733042635658915 val_auprc:  0.9483345935375229
EarlyStopping counter: 36 out of 50
epoch:  97
epoch:  98 val_f1:  0.7827158008497472 val_auroc:  0.874515503875969 val_auprc:  0.9487718075317095
EarlyStopping counter: 37 out of 50
epoch:  98
epoch:  99 val_f1:  0.7866727894280321 val_auroc:  0.8716085271317828 val_auprc:  0.947442100553124
EarlyStopping counter: 38 out of 50
epoch:  99
epoch:  100 val_f1:  0.7827158008497472 val_auroc:  0.8733042635658914 val_auprc:  0.9483988444331173
EarlyStopping counter: 39 out of 50
epoch:  100
epoch:  101 val_f1:  0.7827158008497472 val_auroc:  0.8742732558139534 val_auprc:  0.9488620101848768
EarlyStopping counter: 40 out of 50
epoch:  101
epoch:  102 val_f1:  0.7827158008497472 val_auroc:  0.874031007751938 val_auprc:  0.9486414406601686
EarlyStopping counter: 41 out of 50
epoch:  102
epoch:  103 val_f1:  0.7854893118997625 val_auroc:  0.8730620155038761 val_auprc:  0.9481210346218477
EarlyStopping counter: 42 out of 50
epoch:  103
epoch:  104 val_f1:  0.7827158008497472 val_auroc:  0.8735465116279071 val_auprc:  0.9485179209306969
EarlyStopping counter: 43 out of 50
epoch:  104
epoch:  105 val_f1:  0.7827158008497472 val_auroc:  0.8735465116279069 val_auprc:  0.9484150936128561
EarlyStopping counter: 44 out of 50
epoch:  105
epoch:  106 val_f1:  0.7854893118997625 val_auroc:  0.8735465116279071 val_auprc:  0.9485638274933568
EarlyStopping counter: 45 out of 50
epoch:  106
epoch:  107 val_f1:  0.7827158008497472 val_auroc:  0.874031007751938 val_auprc:  0.9486869892444404
EarlyStopping counter: 46 out of 50
epoch:  107
epoch:  108 val_f1:  0.7746634573712671 val_auroc:  0.8733042635658914 val_auprc:  0.9483606030860449
EarlyStopping counter: 47 out of 50
epoch:  108
epoch:  109 val_f1:  0.7776763243674784 val_auroc:  0.8728197674418603 val_auprc:  0.9479765776150706
EarlyStopping counter: 48 out of 50
epoch:  109
epoch:  110 val_f1:  0.7854893118997625 val_auroc:  0.8737887596899225 val_auprc:  0.9485440095790818
EarlyStopping counter: 49 out of 50
epoch:  110
epoch:  111 val_f1:  0.7746634573712671 val_auroc:  0.8733042635658914 val_auprc:  0.9482996790813654
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  51.852030515670776
{'time_elapsed': [51.852030515670776], 'epoch': [110], 'fold': [3], 'f1_train': [0.9964023900652038], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7746634573712671], 'auroc_test': [0.8733042635658914], 'auprc_test': [0.9482996790813654]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 183]            2,048
│    └─BatchNorm1d: 2-2                  [64, 256, 183]            512
│    └─Tanh: 2-3                         [64, 256, 183]            --
│    └─MaxPool1d: 2-4                    [64, 256, 26]             --
│    └─Dropout: 2-5                      [64, 256, 26]             --
│    └─Flatten: 2-6                      [64, 6656]                --
│    └─Linear: 2-7                       [64, 1]                   6,657
==========================================================================================
Total params: 9,217
Trainable params: 9,217
Non-trainable params: 0
Total mult-adds (M): 24.44
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 47.97
Params size (MB): 0.04
Estimated Total Size (MB): 48.34
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5841277385272047 val_auroc:  0.7661210317460317 val_auprc:  0.8604253404761751
epoch:  1
epoch:  2 val_f1:  0.7268018628352084 val_auroc:  0.7889384920634921 val_auprc:  0.8805403297979785
Validation loss improved to 1.162972
epoch:  2
epoch:  3 val_f1:  0.7000133218344866 val_auroc:  0.8013392857142858 val_auprc:  0.8874854078109047
Validation loss improved to 1.138312
epoch:  3
epoch:  4 val_f1:  0.7260666735111393 val_auroc:  0.8080357142857144 val_auprc:  0.8908054454116325
Validation loss improved to 1.122717
epoch:  4
epoch:  5 val_f1:  0.7077147401908801 val_auroc:  0.8187003968253969 val_auprc:  0.8955800517208179
Validation loss improved to 1.103291
epoch:  5
epoch:  6 val_f1:  0.7414254965869257 val_auroc:  0.8306051587301588 val_auprc:  0.9038374531020945
Validation loss improved to 1.088460
epoch:  6
epoch:  7 val_f1:  0.7481422924901185 val_auroc:  0.8365575396825397 val_auprc:  0.9063501489099537
Validation loss improved to 1.077352
epoch:  7
epoch:  8 val_f1:  0.7353954543261111 val_auroc:  0.8422619047619049 val_auprc:  0.9113264185828602
Validation loss improved to 1.062193
epoch:  8
epoch:  9 val_f1:  0.773156899810964 val_auroc:  0.8452380952380952 val_auprc:  0.9114862914100745
Validation loss improved to 1.056576
epoch:  9
epoch:  10 val_f1:  0.7211394302848576 val_auroc:  0.8482142857142857 val_auprc:  0.9129900865708125
Validation loss improved to 1.040198
epoch:  10
epoch:  11 val_f1:  0.7688528617047408 val_auroc:  0.8501984126984127 val_auprc:  0.9139541529628539
Validation loss improved to 1.022734
epoch:  11
epoch:  12 val_f1:  0.7693794969559068 val_auroc:  0.8524305555555557 val_auprc:  0.914565977112303
Validation loss improved to 1.011101
epoch:  12
epoch:  13 val_f1:  0.7688528617047408 val_auroc:  0.8551587301587302 val_auprc:  0.9174432282549101
Validation loss improved to 0.999630
epoch:  13
epoch:  14 val_f1:  0.7632485643970468 val_auroc:  0.8539186507936509 val_auprc:  0.9186432134072304
Validation loss improved to 0.986210
epoch:  14
epoch:  15 val_f1:  0.8090037477295196 val_auroc:  0.857390873015873 val_auprc:  0.9209072956121678
Validation loss improved to 0.980864
epoch:  15
epoch:  16 val_f1:  0.7629890332114801 val_auroc:  0.8581349206349207 val_auprc:  0.9216144979712056
Validation loss improved to 0.964169
epoch:  16
epoch:  17 val_f1:  0.8156899810964081 val_auroc:  0.8608630952380952 val_auprc:  0.9222416935496376
Validation loss improved to 0.961457
epoch:  17
epoch:  18 val_f1:  0.7773176903611687 val_auroc:  0.861359126984127 val_auprc:  0.9231635928832407
Validation loss improved to 0.947915
epoch:  18
epoch:  19 val_f1:  0.8023197893688181 val_auroc:  0.8603670634920635 val_auprc:  0.9241954021333959
Validation loss improved to 0.939429
epoch:  19
epoch:  20 val_f1:  0.7891335560760728 val_auroc:  0.8618551587301587 val_auprc:  0.9242600564479285
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7765822970867508 val_auroc:  0.8643353174603174 val_auprc:  0.9284089608904496
Validation loss improved to 0.916324
epoch:  21
epoch:  22 val_f1:  0.81483559295621 val_auroc:  0.8648313492063492 val_auprc:  0.927602791721019
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7840325451309432 val_auroc:  0.8650793650793651 val_auprc:  0.9280949336882394
Validation loss improved to 0.908072
epoch:  23
epoch:  24 val_f1:  0.81483559295621 val_auroc:  0.8640873015873016 val_auprc:  0.9278496375596459
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.81483559295621 val_auroc:  0.8638392857142858 val_auprc:  0.9282704380501159
Validation loss improved to 0.904560
epoch:  25
epoch:  26 val_f1:  0.7748792270531402 val_auroc:  0.8660714285714286 val_auprc:  0.9293676200735865
Validation loss improved to 0.884674
epoch:  26
epoch:  27 val_f1:  0.81483559295621 val_auroc:  0.867311507936508 val_auprc:  0.9308394787906029
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7905459035188288 val_auroc:  0.8705357142857143 val_auprc:  0.9314319927346653
Validation loss improved to 0.867461
epoch:  28
epoch:  29 val_f1:  0.81483559295621 val_auroc:  0.8687996031746031 val_auprc:  0.9311401316123833
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.8081713820844254 val_auroc:  0.8697916666666666 val_auprc:  0.9325949624259009
EarlyStopping counter: 2 out of 50
epoch:  30
epoch:  31 val_f1:  0.7061872909698997 val_auroc:  0.869047619047619 val_auprc:  0.9320644267724267
EarlyStopping counter: 3 out of 50
epoch:  31
epoch:  32 val_f1:  0.7940993788819876 val_auroc:  0.8655753968253969 val_auprc:  0.929344606801471
EarlyStopping counter: 4 out of 50
epoch:  32
epoch:  33 val_f1:  0.8164398044139025 val_auroc:  0.871279761904762 val_auprc:  0.9324953556381902
Validation loss improved to 0.852275
epoch:  33
epoch:  34 val_f1:  0.7973334973248877 val_auroc:  0.8717757936507936 val_auprc:  0.9329181429956589
Validation loss improved to 0.836452
epoch:  34
epoch:  35 val_f1:  0.7971014492753623 val_auroc:  0.8692956349206349 val_auprc:  0.931331428556047
EarlyStopping counter: 1 out of 50
epoch:  35
epoch:  36 val_f1:  0.7905459035188288 val_auroc:  0.8737599206349206 val_auprc:  0.9341453183250059
Validation loss improved to 0.831623
epoch:  36
epoch:  37 val_f1:  0.8103538508923273 val_auroc:  0.8722718253968255 val_auprc:  0.9326748148836826
EarlyStopping counter: 1 out of 50
epoch:  37
epoch:  38 val_f1:  0.8015122873345937 val_auroc:  0.8705357142857143 val_auprc:  0.9322692193758523
EarlyStopping counter: 2 out of 50
epoch:  38
epoch:  39 val_f1:  0.8103538508923273 val_auroc:  0.8725198412698412 val_auprc:  0.9338297034635789
Validation loss improved to 0.823100
epoch:  39
epoch:  40 val_f1:  0.7968706966496207 val_auroc:  0.873263888888889 val_auprc:  0.9340067542699559
Validation loss improved to 0.818018
epoch:  40
epoch:  41 val_f1:  0.8205262448141007 val_auroc:  0.8700396825396826 val_auprc:  0.9319902173494508
EarlyStopping counter: 1 out of 50
epoch:  41
epoch:  42 val_f1:  0.7968706966496207 val_auroc:  0.8747519841269842 val_auprc:  0.9346760499753869
Validation loss improved to 0.815117
epoch:  42
epoch:  43 val_f1:  0.8164398044139025 val_auroc:  0.8702876984126984 val_auprc:  0.9321658667764112
EarlyStopping counter: 1 out of 50
epoch:  43
epoch:  44 val_f1:  0.8231516182680737 val_auroc:  0.8712797619047619 val_auprc:  0.9330462994706122
EarlyStopping counter: 2 out of 50
epoch:  44
epoch:  45 val_f1:  0.8103538508923273 val_auroc:  0.8747519841269842 val_auprc:  0.9357532773960219
Validation loss improved to 0.814682
epoch:  45
epoch:  46 val_f1:  0.8156899810964081 val_auroc:  0.869295634920635 val_auprc:  0.9323010565247003
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.8103538508923273 val_auroc:  0.8735119047619048 val_auprc:  0.9347854010949035
EarlyStopping counter: 2 out of 50
epoch:  47
epoch:  48 val_f1:  0.8081713820844254 val_auroc:  0.8668154761904762 val_auprc:  0.931030836690421
EarlyStopping counter: 3 out of 50
epoch:  48
epoch:  49 val_f1:  0.8036150464093796 val_auroc:  0.8757440476190476 val_auprc:  0.9364116643585333
EarlyStopping counter: 4 out of 50
epoch:  49
epoch:  50 val_f1:  0.8036150464093796 val_auroc:  0.876736111111111 val_auprc:  0.9370107130422773
Validation loss improved to 0.809778
epoch:  50
epoch:  51 val_f1:  0.8154066640778435 val_auroc:  0.8668154761904762 val_auprc:  0.930949091705869
EarlyStopping counter: 1 out of 50
epoch:  51
epoch:  52 val_f1:  0.8156899810964081 val_auroc:  0.8695436507936508 val_auprc:  0.9335446629750725
EarlyStopping counter: 2 out of 50
epoch:  52
epoch:  53 val_f1:  0.8097298254042504 val_auroc:  0.8742559523809523 val_auprc:  0.9360576728402208
EarlyStopping counter: 3 out of 50
epoch:  53
epoch:  54 val_f1:  0.8156899810964081 val_auroc:  0.8747519841269842 val_auprc:  0.9365069299265246
EarlyStopping counter: 4 out of 50
epoch:  54
epoch:  55 val_f1:  0.8090037477295196 val_auroc:  0.8762400793650794 val_auprc:  0.9374025919332224
EarlyStopping counter: 5 out of 50
epoch:  55
epoch:  56 val_f1:  0.8156899810964081 val_auroc:  0.8752480158730158 val_auprc:  0.9367320132728599
EarlyStopping counter: 6 out of 50
epoch:  56
epoch:  57 val_f1:  0.8156899810964081 val_auroc:  0.8752480158730158 val_auprc:  0.9365752772310699
EarlyStopping counter: 7 out of 50
epoch:  57
epoch:  58 val_f1:  0.8156899810964081 val_auroc:  0.8762400793650794 val_auprc:  0.9372338747977159
EarlyStopping counter: 8 out of 50
epoch:  58
epoch:  59 val_f1:  0.8156899810964081 val_auroc:  0.8740079365079365 val_auprc:  0.9362581619374799
EarlyStopping counter: 9 out of 50
epoch:  59
epoch:  60 val_f1:  0.8156899810964081 val_auroc:  0.8759920634920635 val_auprc:  0.936997955698983
EarlyStopping counter: 10 out of 50
epoch:  60
epoch:  61 val_f1:  0.8168793096329329 val_auroc:  0.873015873015873 val_auprc:  0.935470765984906
EarlyStopping counter: 11 out of 50
epoch:  61
epoch:  62 val_f1:  0.8090037477295196 val_auroc:  0.8787202380952381 val_auprc:  0.9386578766283451
EarlyStopping counter: 12 out of 50
epoch:  62
epoch:  63 val_f1:  0.8156899810964081 val_auroc:  0.8767361111111112 val_auprc:  0.9376781863236306
EarlyStopping counter: 13 out of 50
epoch:  63
epoch:  64 val_f1:  0.8156899810964081 val_auroc:  0.8767361111111112 val_auprc:  0.9378377251046736
EarlyStopping counter: 14 out of 50
epoch:  64
epoch:  65 val_f1:  0.8248625247346153 val_auroc:  0.8730158730158731 val_auprc:  0.9358285445841124
EarlyStopping counter: 15 out of 50
epoch:  65
epoch:  66 val_f1:  0.8156899810964081 val_auroc:  0.878968253968254 val_auprc:  0.9390200928141754
EarlyStopping counter: 16 out of 50
epoch:  66
epoch:  67 val_f1:  0.8156899810964081 val_auroc:  0.8794642857142857 val_auprc:  0.9394981234995052
EarlyStopping counter: 17 out of 50
epoch:  67
epoch:  68 val_f1:  0.8156899810964081 val_auroc:  0.8784722222222222 val_auprc:  0.9382655346028392
EarlyStopping counter: 18 out of 50
epoch:  68
epoch:  69 val_f1:  0.8023197893688181 val_auroc:  0.8809523809523809 val_auprc:  0.9402109259126117
EarlyStopping counter: 19 out of 50
epoch:  69
epoch:  70 val_f1:  0.8072024593763724 val_auroc:  0.8725198412698413 val_auprc:  0.934696446195513
EarlyStopping counter: 20 out of 50
epoch:  70
epoch:  71 val_f1:  0.8156899810964081 val_auroc:  0.8782242063492064 val_auprc:  0.938538494667732
EarlyStopping counter: 21 out of 50
epoch:  71
epoch:  72 val_f1:  0.8081713820844254 val_auroc:  0.8784722222222222 val_auprc:  0.9386125225443189
EarlyStopping counter: 22 out of 50
epoch:  72
epoch:  73 val_f1:  0.8327610961982647 val_auroc:  0.8754960317460319 val_auprc:  0.936730411609777
EarlyStopping counter: 23 out of 50
epoch:  73
epoch:  74 val_f1:  0.8260869565217391 val_auroc:  0.8752480158730159 val_auprc:  0.9369600798718114
EarlyStopping counter: 24 out of 50
epoch:  74
epoch:  75 val_f1:  0.7948558771909655 val_auroc:  0.8772321428571429 val_auprc:  0.9379164106227591
EarlyStopping counter: 25 out of 50
epoch:  75
epoch:  76 val_f1:  0.8260869565217391 val_auroc:  0.8759920634920635 val_auprc:  0.9370514465226809
EarlyStopping counter: 26 out of 50
epoch:  76
epoch:  77 val_f1:  0.7948558771909655 val_auroc:  0.8779761904761905 val_auprc:  0.9384971232401496
EarlyStopping counter: 27 out of 50
epoch:  77
epoch:  78 val_f1:  0.81483559295621 val_auroc:  0.8779761904761905 val_auprc:  0.9381883969188103
EarlyStopping counter: 28 out of 50
epoch:  78
epoch:  79 val_f1:  0.8138718358422335 val_auroc:  0.876736111111111 val_auprc:  0.9375128277211545
EarlyStopping counter: 29 out of 50
epoch:  79
epoch:  80 val_f1:  0.8138718358422335 val_auroc:  0.8772321428571429 val_auprc:  0.9374668120262671
EarlyStopping counter: 30 out of 50
epoch:  80
epoch:  81 val_f1:  0.8194319840387783 val_auroc:  0.8764880952380952 val_auprc:  0.9368295272430897
EarlyStopping counter: 31 out of 50
epoch:  81
epoch:  82 val_f1:  0.8102677351291666 val_auroc:  0.875 val_auprc:  0.9365962598326603
EarlyStopping counter: 32 out of 50
epoch:  82
epoch:  83 val_f1:  0.8081713820844254 val_auroc:  0.8772321428571428 val_auprc:  0.9375137550957202
EarlyStopping counter: 33 out of 50
epoch:  83
epoch:  84 val_f1:  0.8182185828242006 val_auroc:  0.8777281746031746 val_auprc:  0.9376002972580251
EarlyStopping counter: 34 out of 50
epoch:  84
epoch:  85 val_f1:  0.81483559295621 val_auroc:  0.8789682539682541 val_auprc:  0.937941423945464
EarlyStopping counter: 35 out of 50
epoch:  85
epoch:  86 val_f1:  0.8138718358422335 val_auroc:  0.8779761904761905 val_auprc:  0.9373351077080838
EarlyStopping counter: 36 out of 50
epoch:  86
epoch:  87 val_f1:  0.8081713820844254 val_auroc:  0.8779761904761906 val_auprc:  0.9375300292421593
EarlyStopping counter: 37 out of 50
epoch:  87
epoch:  88 val_f1:  0.8194319840387783 val_auroc:  0.8779761904761905 val_auprc:  0.9374055888834871
EarlyStopping counter: 38 out of 50
epoch:  88
epoch:  89 val_f1:  0.8127933585226971 val_auroc:  0.878720238095238 val_auprc:  0.9378188277191082
EarlyStopping counter: 39 out of 50
epoch:  89
epoch:  90 val_f1:  0.8127933585226971 val_auroc:  0.8782242063492064 val_auprc:  0.9377399777325517
EarlyStopping counter: 40 out of 50
epoch:  90
epoch:  91 val_f1:  0.8115942028985508 val_auroc:  0.878720238095238 val_auprc:  0.9379146384327721
EarlyStopping counter: 41 out of 50
epoch:  91
epoch:  92 val_f1:  0.8127933585226971 val_auroc:  0.8797123015873016 val_auprc:  0.9382297000270156
EarlyStopping counter: 42 out of 50
epoch:  92
epoch:  93 val_f1:  0.8127933585226971 val_auroc:  0.8797123015873016 val_auprc:  0.9382313970614771
EarlyStopping counter: 43 out of 50
epoch:  93
epoch:  94 val_f1:  0.8127933585226971 val_auroc:  0.8792162698412699 val_auprc:  0.9379445687319674
EarlyStopping counter: 44 out of 50
epoch:  94
epoch:  95 val_f1:  0.8049865427618805 val_auroc:  0.8794642857142857 val_auprc:  0.9384625098304122
EarlyStopping counter: 45 out of 50
epoch:  95
epoch:  96 val_f1:  0.8081713820844254 val_auroc:  0.8804563492063492 val_auprc:  0.9385613524890443
EarlyStopping counter: 46 out of 50
epoch:  96
epoch:  97 val_f1:  0.8182185828242006 val_auroc:  0.8804563492063492 val_auprc:  0.9385226223305642
EarlyStopping counter: 47 out of 50
epoch:  97
epoch:  98 val_f1:  0.807228002894545 val_auroc:  0.8794642857142857 val_auprc:  0.9381689456064007
EarlyStopping counter: 48 out of 50
epoch:  98
epoch:  99 val_f1:  0.807228002894545 val_auroc:  0.8789682539682541 val_auprc:  0.9377667116345723
EarlyStopping counter: 49 out of 50
epoch:  99
epoch:  100 val_f1:  0.8102677351291666 val_auroc:  0.8804563492063493 val_auprc:  0.9383598834349888
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  47.96961331367493
{'time_elapsed': [47.96961331367493], 'epoch': [99], 'fold': [4], 'f1_train': [0.9982029282297181], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8102677351291666], 'auroc_test': [0.8804563492063493], 'auprc_test': [0.9383598834349888]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 183]            2,048
│    └─BatchNorm1d: 2-2                  [64, 256, 183]            512
│    └─Tanh: 2-3                         [64, 256, 183]            --
│    └─MaxPool1d: 2-4                    [64, 256, 26]             --
│    └─Dropout: 2-5                      [64, 256, 26]             --
│    └─Flatten: 2-6                      [64, 6656]                --
│    └─Linear: 2-7                       [64, 1]                   6,657
==========================================================================================
Total params: 9,217
Trainable params: 9,217
Non-trainable params: 0
Total mult-adds (M): 24.44
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 47.97
Params size (MB): 0.04
Estimated Total Size (MB): 48.34
==========================================================================================
