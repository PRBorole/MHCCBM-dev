config:  {'project': 'MHCCBM', 'name': 'CNN_44', 'config': {'hidden_channels': [512], 'epochs': 500, 'kernel_size': 7, 'pool_kernel_size': 7, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.5 val_auprc:  0.8489208633093526
epoch:  1
epoch:  2 val_f1:  0.546916661578751 val_auroc:  0.4418262150220913 val_auprc:  0.7143513855476182
Validation loss improved to 14.691649
epoch:  2
epoch:  3 val_f1:  0.28024894082212165 val_auroc:  0.4420716740304369 val_auprc:  0.6630439627254692
Validation loss improved to 11.816236
epoch:  3
epoch:  4 val_f1:  0.5736119238580427 val_auroc:  0.46195385370643105 val_auprc:  0.7358854763814744
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.4129117758424839 val_auroc:  0.4696858124693176 val_auprc:  0.694773777043617
Validation loss improved to 10.078767
epoch:  5
epoch:  6 val_f1:  0.5770092434191596 val_auroc:  0.49607265586647026 val_auprc:  0.7145646432242386
Validation loss improved to 8.133122
epoch:  6
epoch:  7 val_f1:  0.6020377956008398 val_auroc:  0.5325233186057928 val_auprc:  0.7183043932480648
Validation loss improved to 5.104360
epoch:  7
epoch:  8 val_f1:  0.4969956521171447 val_auroc:  0.6216249386352479 val_auprc:  0.7757297397366437
Validation loss improved to 1.793375
epoch:  8
epoch:  9 val_f1:  0.6472345296242701 val_auroc:  0.7282768777614138 val_auprc:  0.8711304955675601
Validation loss improved to 0.718837
epoch:  9
epoch:  10 val_f1:  0.7162290583621869 val_auroc:  0.7623956799214531 val_auprc:  0.89178881490987
Validation loss improved to 0.359599
epoch:  10
epoch:  11 val_f1:  0.713247796930704 val_auroc:  0.7709867452135494 val_auprc:  0.8943724173312853
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7054786939679025 val_auroc:  0.757486499754541 val_auprc:  0.8804454336116815
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.7237424247793883 val_auroc:  0.7658321060382915 val_auprc:  0.886571088198719
EarlyStopping counter: 3 out of 50
epoch:  13
epoch:  14 val_f1:  0.707673860911271 val_auroc:  0.7808051055473736 val_auprc:  0.9013073463286202
EarlyStopping counter: 4 out of 50
epoch:  14
epoch:  15 val_f1:  0.7156947373800909 val_auroc:  0.7800687285223368 val_auprc:  0.8991311758210159
EarlyStopping counter: 5 out of 50
epoch:  15
epoch:  16 val_f1:  0.6958509820496094 val_auroc:  0.7803141875306824 val_auprc:  0.8984500135867934
EarlyStopping counter: 6 out of 50
epoch:  16
epoch:  17 val_f1:  0.703263898025454 val_auroc:  0.7876779577810505 val_auprc:  0.9064939965648922
EarlyStopping counter: 7 out of 50
epoch:  17
epoch:  18 val_f1:  0.7169642564307364 val_auroc:  0.7844869906725577 val_auprc:  0.9027067730003185
EarlyStopping counter: 8 out of 50
epoch:  18
epoch:  19 val_f1:  0.726967940210938 val_auroc:  0.7879234167893961 val_auprc:  0.9063414136541643
EarlyStopping counter: 9 out of 50
epoch:  19
epoch:  20 val_f1:  0.7215941532488295 val_auroc:  0.7903780068728523 val_auprc:  0.9060947664347161
EarlyStopping counter: 10 out of 50
epoch:  20
epoch:  21 val_f1:  0.7307106601978622 val_auroc:  0.7933235149729995 val_auprc:  0.908075248358378
EarlyStopping counter: 11 out of 50
epoch:  21
epoch:  22 val_f1:  0.7308479257525525 val_auroc:  0.8055964653902798 val_auprc:  0.9162948517022629
EarlyStopping counter: 12 out of 50
epoch:  22
epoch:  23 val_f1:  0.7691994463100789 val_auroc:  0.8031418753068238 val_auprc:  0.9131831430314683
EarlyStopping counter: 13 out of 50
epoch:  23
epoch:  24 val_f1:  0.6505427237157642 val_auroc:  0.8043691703485518 val_auprc:  0.9127146261240006
EarlyStopping counter: 14 out of 50
epoch:  24
epoch:  25 val_f1:  0.7699730743399811 val_auroc:  0.814187530682376 val_auprc:  0.921416956973231
EarlyStopping counter: 15 out of 50
epoch:  25
epoch:  26 val_f1:  0.7237742540242516 val_auroc:  0.8097692685321551 val_auprc:  0.9165523488358442
EarlyStopping counter: 16 out of 50
epoch:  26
epoch:  27 val_f1:  0.7536606851900262 val_auroc:  0.8060873834069711 val_auprc:  0.9135563922624416
EarlyStopping counter: 17 out of 50
epoch:  27
epoch:  28 val_f1:  0.7691994463100789 val_auroc:  0.8176239567992146 val_auprc:  0.923228655666158
EarlyStopping counter: 18 out of 50
epoch:  28
epoch:  29 val_f1:  0.7096759374109908 val_auroc:  0.8156602847324497 val_auprc:  0.9211304778425017
EarlyStopping counter: 19 out of 50
epoch:  29
epoch:  30 val_f1:  0.7850374843605565 val_auroc:  0.8181148748159057 val_auprc:  0.922237996632852
EarlyStopping counter: 20 out of 50
epoch:  30
epoch:  31 val_f1:  0.7238240177089098 val_auroc:  0.8095238095238095 val_auprc:  0.9163139286110082
EarlyStopping counter: 21 out of 50
epoch:  31
epoch:  32 val_f1:  0.5730345991881756 val_auroc:  0.82793323514973 val_auprc:  0.9289577188433715
EarlyStopping counter: 22 out of 50
epoch:  32
epoch:  33 val_f1:  0.76000113614692 val_auroc:  0.8176239567992145 val_auprc:  0.9222257744895817
EarlyStopping counter: 23 out of 50
epoch:  33
epoch:  34 val_f1:  0.7711689349644636 val_auroc:  0.8144329896907216 val_auprc:  0.9208039502129155
EarlyStopping counter: 24 out of 50
epoch:  34
epoch:  35 val_f1:  0.7707245329923307 val_auroc:  0.8146784486990672 val_auprc:  0.9201757213085993
EarlyStopping counter: 25 out of 50
epoch:  35
epoch:  36 val_f1:  0.7446689355102744 val_auroc:  0.8227785959744722 val_auprc:  0.9257640181307589
EarlyStopping counter: 26 out of 50
epoch:  36
epoch:  37 val_f1:  0.6758292290898464 val_auroc:  0.8171330387825233 val_auprc:  0.9203298605165813
EarlyStopping counter: 27 out of 50
epoch:  37
epoch:  38 val_f1:  0.7711689349644636 val_auroc:  0.8132056946489937 val_auprc:  0.9181179946194883
EarlyStopping counter: 28 out of 50
epoch:  38
epoch:  39 val_f1:  0.7681512331200245 val_auroc:  0.8107511045655376 val_auprc:  0.9159599234200262
EarlyStopping counter: 29 out of 50
epoch:  39
epoch:  40 val_f1:  0.7653077537969624 val_auroc:  0.817378497790869 val_auprc:  0.9228878112103917
EarlyStopping counter: 30 out of 50
epoch:  40
epoch:  41 val_f1:  0.7025483104025048 val_auroc:  0.8181148748159057 val_auprc:  0.9229412410279328
EarlyStopping counter: 31 out of 50
epoch:  41
epoch:  42 val_f1:  0.7699730743399811 val_auroc:  0.8222876779577811 val_auprc:  0.9261310739981862
EarlyStopping counter: 32 out of 50
epoch:  42
epoch:  43 val_f1:  0.7845295119922345 val_auroc:  0.8173784977908689 val_auprc:  0.920479559121513
EarlyStopping counter: 33 out of 50
epoch:  43
epoch:  44 val_f1:  0.7377728985642654 val_auroc:  0.8166421207658321 val_auprc:  0.920406773807126
EarlyStopping counter: 34 out of 50
epoch:  44
epoch:  45 val_f1:  0.7745465218349855 val_auroc:  0.819833087874325 val_auprc:  0.9251888510293952
EarlyStopping counter: 35 out of 50
epoch:  45
epoch:  46 val_f1:  0.7772753225990636 val_auroc:  0.8205694648993619 val_auprc:  0.9243013454884685
EarlyStopping counter: 36 out of 50
epoch:  46
epoch:  47 val_f1:  0.766354189375772 val_auroc:  0.8149239077074129 val_auprc:  0.9172709934834831
EarlyStopping counter: 37 out of 50
epoch:  47
epoch:  48 val_f1:  0.7583800901862243 val_auroc:  0.8259695630829652 val_auprc:  0.9292189189581783
EarlyStopping counter: 38 out of 50
epoch:  48
epoch:  49 val_f1:  0.7845295119922345 val_auroc:  0.8183603338242514 val_auprc:  0.9212276648891614
EarlyStopping counter: 39 out of 50
epoch:  49
epoch:  50 val_f1:  0.7643829551743221 val_auroc:  0.8171330387825233 val_auprc:  0.9201439887948318
EarlyStopping counter: 40 out of 50
epoch:  50
epoch:  51 val_f1:  0.7653077537969624 val_auroc:  0.8240058910162003 val_auprc:  0.9261465314588746
EarlyStopping counter: 41 out of 50
epoch:  51
epoch:  52 val_f1:  0.6807133732266524 val_auroc:  0.8163966617574866 val_auprc:  0.9206488228024261
EarlyStopping counter: 42 out of 50
epoch:  52
epoch:  53 val_f1:  0.7515743249556199 val_auroc:  0.8284241531664213 val_auprc:  0.929199630641557
EarlyStopping counter: 43 out of 50
epoch:  53
epoch:  54 val_f1:  0.7536081085870222 val_auroc:  0.8205694648993618 val_auprc:  0.9221190320646406
EarlyStopping counter: 44 out of 50
epoch:  54
epoch:  55 val_f1:  0.7577565132360132 val_auroc:  0.826705940108002 val_auprc:  0.9278049086993172
EarlyStopping counter: 45 out of 50
epoch:  55
epoch:  56 val_f1:  0.7697841726618705 val_auroc:  0.8232695139911634 val_auprc:  0.9267761172850181
EarlyStopping counter: 46 out of 50
epoch:  56
epoch:  57 val_f1:  0.702570289683208 val_auroc:  0.8237604320078546 val_auprc:  0.9264726696385821
EarlyStopping counter: 47 out of 50
epoch:  57
epoch:  58 val_f1:  0.7745465218349855 val_auroc:  0.8144329896907216 val_auprc:  0.9188687124611684
EarlyStopping counter: 48 out of 50
epoch:  58
epoch:  59 val_f1:  0.7802930475309426 val_auroc:  0.8171330387825234 val_auprc:  0.9213684759176902
EarlyStopping counter: 49 out of 50
epoch:  59
epoch:  60 val_f1:  0.7762067639678805 val_auroc:  0.8183603338242513 val_auprc:  0.921400569607525
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  885.2058482170105
{'time_elapsed': [885.2058482170105], 'epoch': [59], 'fold': [0], 'f1_train': [0.989206945677534], 'auroc_train': [0.9996934114112273], 'auprc_train': [0.9998648933700901], 'f1_test': [0.7762067639678805], 'auroc_test': [0.8183603338242513], 'auprc_test': [0.921400569607525]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1276]           4,096
│    └─BatchNorm1d: 2-2                  [64, 512, 1276]           1,024
│    └─Tanh: 2-3                         [64, 512, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1270]           --
│    └─Dropout: 2-5                      [64, 512, 1270]           --
│    └─Flatten: 2-6                      [64, 650240]              --
│    └─Linear: 2-7                       [64, 1]                   650,241
==========================================================================================
Total params: 655,361
Trainable params: 655,361
Non-trainable params: 0
Total mult-adds (M): 376.18
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 668.99
Params size (MB): 2.62
Estimated Total Size (MB): 671.94
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.630338733431517 val_auprc:  0.7602481397327294
epoch:  1
epoch:  2 val_f1:  0.4376605009698535 val_auroc:  0.5987972508591065 val_auprc:  0.7685111107520626
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.4376605009698535 val_auroc:  0.5995336278841433 val_auprc:  0.7655173244516514
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5856613810363777 val_auroc:  0.6088610702012764 val_auprc:  0.7756440077984701
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.5714263837971769 val_auroc:  0.6313205694648993 val_auprc:  0.7834989766384983
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.5487682076268764 val_auroc:  0.6545164457535592 val_auprc:  0.7850950277032944
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.4114994430358578 val_auroc:  0.6859351988217967 val_auprc:  0.7775524238345344
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.6885440884463027 val_auroc:  0.7329405989199804 val_auprc:  0.8380462411023133
Validation loss improved to 1.016019
epoch:  8
epoch:  9 val_f1:  0.7108600244444511 val_auroc:  0.7432498772704959 val_auprc:  0.8651198794984156
Validation loss improved to 0.768920
epoch:  9
epoch:  10 val_f1:  0.7500864926036699 val_auroc:  0.7749140893470791 val_auprc:  0.8887346288111148
Validation loss improved to 0.696569
epoch:  10
epoch:  11 val_f1:  0.7100860488080124 val_auroc:  0.80166912125675 val_auprc:  0.903852368219418
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7644702419882276 val_auroc:  0.8200785468826706 val_auprc:  0.9074335753455908
Validation loss improved to 0.482967
epoch:  12
epoch:  13 val_f1:  0.7715989981939552 val_auroc:  0.8257241040746196 val_auprc:  0.9118995563569146
Validation loss improved to 0.471438
epoch:  13
epoch:  14 val_f1:  0.7897879661118469 val_auroc:  0.8254786450662739 val_auprc:  0.914149994494383
Validation loss improved to 0.369404
epoch:  14
epoch:  15 val_f1:  0.751502327549725 val_auroc:  0.8286696121747669 val_auprc:  0.9169736163497719
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.681579990245092 val_auroc:  0.8262150220913107 val_auprc:  0.9146125844857582
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.743914028278071 val_auroc:  0.8274423171330388 val_auprc:  0.9142201485762809
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.777854660092151 val_auroc:  0.82793323514973 val_auprc:  0.9163369988657895
Validation loss improved to 0.368171
epoch:  18
epoch:  19 val_f1:  0.8086423317204984 val_auroc:  0.833578792341679 val_auprc:  0.9198231879068228
Validation loss improved to 0.287133
epoch:  19
epoch:  20 val_f1:  0.7513203127712835 val_auroc:  0.8301423662248405 val_auprc:  0.9183259648740463
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7855164986057286 val_auroc:  0.8330878743249878 val_auprc:  0.9208607119613098
Validation loss improved to 0.240748
epoch:  21
epoch:  22 val_f1:  0.798430833799187 val_auroc:  0.8404516445753559 val_auprc:  0.9265980578361092
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7170655771870609 val_auroc:  0.8316151202749141 val_auprc:  0.9219600397128123
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.806394786639448 val_auroc:  0.837260677466863 val_auprc:  0.9231692676436544
Validation loss improved to 0.224416
epoch:  24
epoch:  25 val_f1:  0.797175270999766 val_auroc:  0.8406971035837015 val_auprc:  0.926559743976443
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.7971323289800215 val_auroc:  0.8362788414334806 val_auprc:  0.9231301020409215
Validation loss improved to 0.213408
epoch:  26
epoch:  27 val_f1:  0.7377728985642654 val_auroc:  0.8370152184585175 val_auprc:  0.924384238492427
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7024482739389885 val_auroc:  0.8306332842415317 val_auprc:  0.9206899838332905
EarlyStopping counter: 2 out of 50
epoch:  28
epoch:  29 val_f1:  0.7307106601978622 val_auroc:  0.8298969072164949 val_auprc:  0.9208968873334931
EarlyStopping counter: 3 out of 50
epoch:  29
epoch:  30 val_f1:  0.8056228275806321 val_auroc:  0.8377515954835542 val_auprc:  0.9251755419888305
EarlyStopping counter: 4 out of 50
epoch:  30
epoch:  31 val_f1:  0.7845295119922345 val_auroc:  0.8370152184585175 val_auprc:  0.9240675122209385
EarlyStopping counter: 5 out of 50
epoch:  31
epoch:  32 val_f1:  0.8251510956894536 val_auroc:  0.8365243004418262 val_auprc:  0.9243687205724515
EarlyStopping counter: 6 out of 50
epoch:  32
epoch:  33 val_f1:  0.7377728985642654 val_auroc:  0.8311242022582228 val_auprc:  0.9211181115001736
EarlyStopping counter: 7 out of 50
epoch:  33
epoch:  34 val_f1:  0.7082463061808618 val_auroc:  0.8394698085419735 val_auprc:  0.925031022638541
EarlyStopping counter: 8 out of 50
epoch:  34
epoch:  35 val_f1:  0.7963871971298289 val_auroc:  0.8333333333333334 val_auprc:  0.9221835999377087
EarlyStopping counter: 9 out of 50
epoch:  35
epoch:  36 val_f1:  0.7933255489848959 val_auroc:  0.8438880706921945 val_auprc:  0.9289678981510618
Validation loss improved to 0.174090
epoch:  36
epoch:  37 val_f1:  0.7985611510791367 val_auroc:  0.8394698085419735 val_auprc:  0.9264595328080258
EarlyStopping counter: 1 out of 50
epoch:  37
epoch:  38 val_f1:  0.7377351131143277 val_auroc:  0.8409425625920471 val_auprc:  0.9256298551274073
EarlyStopping counter: 2 out of 50
epoch:  38
epoch:  39 val_f1:  0.7919479944965341 val_auroc:  0.8406971035837015 val_auprc:  0.9210213987001039
Validation loss improved to 0.155544
epoch:  39
epoch:  40 val_f1:  0.7911956149366222 val_auroc:  0.8377515954835542 val_auprc:  0.9224993478870772
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.766354189375772 val_auroc:  0.8411880216003926 val_auprc:  0.9243770123098309
EarlyStopping counter: 2 out of 50
epoch:  41
epoch:  42 val_f1:  0.7762067639678805 val_auroc:  0.8406971035837014 val_auprc:  0.9242692078239849
EarlyStopping counter: 3 out of 50
epoch:  42
epoch:  43 val_f1:  0.7745465218349855 val_auroc:  0.8406971035837015 val_auprc:  0.924226805795457
EarlyStopping counter: 4 out of 50
epoch:  43
epoch:  44 val_f1:  0.7377728985642654 val_auroc:  0.8402061855670103 val_auprc:  0.9247166475527653
EarlyStopping counter: 5 out of 50
epoch:  44
epoch:  45 val_f1:  0.7384802450563926 val_auroc:  0.8387334315169367 val_auprc:  0.9184876923533065
EarlyStopping counter: 6 out of 50
epoch:  45
epoch:  46 val_f1:  0.7445203699313053 val_auroc:  0.8377515954835543 val_auprc:  0.9211537270494712
EarlyStopping counter: 7 out of 50
epoch:  46
epoch:  47 val_f1:  0.8029873436454202 val_auroc:  0.8384879725085911 val_auprc:  0.9207142661639742
EarlyStopping counter: 8 out of 50
epoch:  47
epoch:  48 val_f1:  0.7855581813618873 val_auroc:  0.8397152675503191 val_auprc:  0.9215499956717947
EarlyStopping counter: 9 out of 50
epoch:  48
epoch:  49 val_f1:  0.7445706985813217 val_auroc:  0.8409425625920471 val_auprc:  0.9218952554603268
EarlyStopping counter: 10 out of 50
epoch:  49
epoch:  50 val_f1:  0.7786895152313162 val_auroc:  0.8438880706921944 val_auprc:  0.924801018577655
EarlyStopping counter: 11 out of 50
epoch:  50
epoch:  51 val_f1:  0.7701796092919814 val_auroc:  0.8355424644084438 val_auprc:  0.919255385269941
EarlyStopping counter: 12 out of 50
epoch:  51
epoch:  52 val_f1:  0.7786895152313162 val_auroc:  0.8384879725085912 val_auprc:  0.919178300447915
EarlyStopping counter: 13 out of 50
epoch:  52
epoch:  53 val_f1:  0.7643829551743221 val_auroc:  0.8379970544918999 val_auprc:  0.9172850438088673
EarlyStopping counter: 14 out of 50
epoch:  53
epoch:  54 val_f1:  0.7890919075230509 val_auroc:  0.8424153166421208 val_auprc:  0.9205029698096929
EarlyStopping counter: 15 out of 50
epoch:  54
epoch:  55 val_f1:  0.8095907478048824 val_auroc:  0.8446244477172312 val_auprc:  0.923188464486587
EarlyStopping counter: 16 out of 50
epoch:  55
epoch:  56 val_f1:  0.7724732835091151 val_auroc:  0.8377515954835543 val_auprc:  0.9152341284352937
Validation loss improved to 0.127000
epoch:  56
epoch:  57 val_f1:  0.7879228532067962 val_auroc:  0.8433971526755032 val_auprc:  0.9199249054604756
EarlyStopping counter: 1 out of 50
epoch:  57
epoch:  58 val_f1:  0.7906450372602754 val_auroc:  0.8409425625920471 val_auprc:  0.9202675284739416
EarlyStopping counter: 2 out of 50
epoch:  58
epoch:  59 val_f1:  0.7791090204759269 val_auroc:  0.8397152675503191 val_auprc:  0.9170018539465539
EarlyStopping counter: 3 out of 50
epoch:  59
epoch:  60 val_f1:  0.7841726618705036 val_auroc:  0.8352970054000982 val_auprc:  0.9133581091651771
EarlyStopping counter: 4 out of 50
epoch:  60
epoch:  61 val_f1:  0.766354189375772 val_auroc:  0.8370152184585175 val_auprc:  0.9138794520755751
EarlyStopping counter: 5 out of 50
epoch:  61
epoch:  62 val_f1:  0.7879228532067962 val_auroc:  0.8379970544918998 val_auprc:  0.9159012345209496
EarlyStopping counter: 6 out of 50
epoch:  62
epoch:  63 val_f1:  0.7727225509205256 val_auroc:  0.8382425135002455 val_auprc:  0.9152167783900313
EarlyStopping counter: 7 out of 50
epoch:  63
epoch:  64 val_f1:  0.7707245329923307 val_auroc:  0.8379970544919 val_auprc:  0.914491574928756
EarlyStopping counter: 8 out of 50
epoch:  64
epoch:  65 val_f1:  0.7889150110486646 val_auroc:  0.8404516445753559 val_auprc:  0.9181824673349666
EarlyStopping counter: 9 out of 50
epoch:  65
epoch:  66 val_f1:  0.7724732835091151 val_auroc:  0.8330878743249878 val_auprc:  0.9113157682168114
EarlyStopping counter: 10 out of 50
epoch:  66
epoch:  67 val_f1:  0.7802930475309426 val_auroc:  0.8350515463917525 val_auprc:  0.9129147902660676
EarlyStopping counter: 11 out of 50
epoch:  67
epoch:  68 val_f1:  0.7826417810500232 val_auroc:  0.8343151693667158 val_auprc:  0.9117988235893821
EarlyStopping counter: 12 out of 50
epoch:  68
epoch:  69 val_f1:  0.7823449348629204 val_auroc:  0.8350515463917526 val_auprc:  0.9122202067437323
EarlyStopping counter: 13 out of 50
epoch:  69
epoch:  70 val_f1:  0.7791090204759269 val_auroc:  0.8321060382916053 val_auprc:  0.91024739797512
EarlyStopping counter: 14 out of 50
epoch:  70
epoch:  71 val_f1:  0.7809570525397864 val_auroc:  0.8345606283750614 val_auprc:  0.9124217439953892
EarlyStopping counter: 15 out of 50
epoch:  71
epoch:  72 val_f1:  0.7791090204759269 val_auroc:  0.8281786941580757 val_auprc:  0.9078259122776496
EarlyStopping counter: 16 out of 50
epoch:  72
epoch:  73 val_f1:  0.7823449348629204 val_auroc:  0.8350515463917526 val_auprc:  0.9126545913250567
EarlyStopping counter: 17 out of 50
epoch:  73
epoch:  74 val_f1:  0.7762067639678805 val_auroc:  0.8355424644084438 val_auprc:  0.9131128889752917
EarlyStopping counter: 18 out of 50
epoch:  74
epoch:  75 val_f1:  0.7873856121514594 val_auroc:  0.8350515463917525 val_auprc:  0.9123894198396294
EarlyStopping counter: 19 out of 50
epoch:  75
epoch:  76 val_f1:  0.7823449348629204 val_auroc:  0.8357879234167894 val_auprc:  0.9143207810426426
EarlyStopping counter: 20 out of 50
epoch:  76
epoch:  77 val_f1:  0.7384802450563926 val_auroc:  0.8328424153166422 val_auprc:  0.9054065259462777
Validation loss improved to 0.117756
epoch:  77
epoch:  78 val_f1:  0.7879228532067962 val_auroc:  0.8325969563082964 val_auprc:  0.9116903069337843
EarlyStopping counter: 1 out of 50
epoch:  78
epoch:  79 val_f1:  0.7802930475309426 val_auroc:  0.8269513991163475 val_auprc:  0.9060681109053743
EarlyStopping counter: 2 out of 50
epoch:  79
epoch:  80 val_f1:  0.7617684906754855 val_auroc:  0.8338242513500245 val_auprc:  0.9117966583692185
EarlyStopping counter: 3 out of 50
epoch:  80
epoch:  81 val_f1:  0.7855581813618873 val_auroc:  0.8325969563082966 val_auprc:  0.9119852380277313
EarlyStopping counter: 4 out of 50
epoch:  81
epoch:  82 val_f1:  0.7809570525397864 val_auroc:  0.8325969563082966 val_auprc:  0.9108741237737653
EarlyStopping counter: 5 out of 50
epoch:  82
epoch:  83 val_f1:  0.7919479944965341 val_auroc:  0.8355424644084438 val_auprc:  0.9075699275345569
Validation loss improved to 0.110253
epoch:  83
epoch:  84 val_f1:  0.7777125328082551 val_auroc:  0.8328424153166422 val_auprc:  0.9092995854899096
EarlyStopping counter: 1 out of 50
epoch:  84
epoch:  85 val_f1:  0.7841726618705036 val_auroc:  0.832351497299951 val_auprc:  0.909237765961055
EarlyStopping counter: 2 out of 50
epoch:  85
epoch:  86 val_f1:  0.7745465218349855 val_auroc:  0.830387825233186 val_auprc:  0.9041541638521812
EarlyStopping counter: 3 out of 50
epoch:  86
epoch:  87 val_f1:  0.7790721385700611 val_auroc:  0.832842415316642 val_auprc:  0.909121804247703
EarlyStopping counter: 4 out of 50
epoch:  87
epoch:  88 val_f1:  0.7823449348629204 val_auroc:  0.8301423662248404 val_auprc:  0.9075569704887576
EarlyStopping counter: 5 out of 50
epoch:  88
epoch:  89 val_f1:  0.7748796193569787 val_auroc:  0.8286696121747668 val_auprc:  0.9048302925055536
EarlyStopping counter: 6 out of 50
epoch:  89
epoch:  90 val_f1:  0.7727225509205256 val_auroc:  0.8375061364752087 val_auprc:  0.9137007603895196
EarlyStopping counter: 7 out of 50
epoch:  90
epoch:  91 val_f1:  0.7712620601193464 val_auroc:  0.831615120274914 val_auprc:  0.9106035236183732
EarlyStopping counter: 8 out of 50
epoch:  91
epoch:  92 val_f1:  0.7777125328082551 val_auroc:  0.8348060873834069 val_auprc:  0.9077834966075504
EarlyStopping counter: 9 out of 50
epoch:  92
epoch:  93 val_f1:  0.7745465218349855 val_auroc:  0.8301423662248405 val_auprc:  0.9052536133987197
EarlyStopping counter: 10 out of 50
epoch:  93
epoch:  94 val_f1:  0.7813819697019021 val_auroc:  0.8301423662248404 val_auprc:  0.9084591154740457
EarlyStopping counter: 11 out of 50
epoch:  94
epoch:  95 val_f1:  0.7790721385700611 val_auroc:  0.8306332842415316 val_auprc:  0.907114582713434
EarlyStopping counter: 12 out of 50
epoch:  95
epoch:  96 val_f1:  0.7841726618705036 val_auroc:  0.8295287187039765 val_auprc:  0.904182233351411
EarlyStopping counter: 13 out of 50
epoch:  96
epoch:  97 val_f1:  0.7809570525397864 val_auroc:  0.8311242022582229 val_auprc:  0.9032246768182977
EarlyStopping counter: 14 out of 50
epoch:  97
epoch:  98 val_f1:  0.7920536597238516 val_auroc:  0.8350515463917526 val_auprc:  0.9099038298542359
EarlyStopping counter: 15 out of 50
epoch:  98
epoch:  99 val_f1:  0.7984066342984726 val_auroc:  0.8313696612665684 val_auprc:  0.9046532291232211
EarlyStopping counter: 16 out of 50
epoch:  99
epoch:  100 val_f1:  0.7809570525397864 val_auroc:  0.8294059891998036 val_auprc:  0.9020817494794628
EarlyStopping counter: 17 out of 50
epoch:  100
epoch:  101 val_f1:  0.7920536597238516 val_auroc:  0.8296514482081493 val_auprc:  0.9024194070920109
EarlyStopping counter: 18 out of 50
epoch:  101
epoch:  102 val_f1:  0.7745465218349855 val_auroc:  0.8279332351497299 val_auprc:  0.9016660226344277
EarlyStopping counter: 19 out of 50
epoch:  102
epoch:  103 val_f1:  0.7855581813618873 val_auroc:  0.82793323514973 val_auprc:  0.9024950974507607
EarlyStopping counter: 20 out of 50
epoch:  103
epoch:  104 val_f1:  0.7920536597238516 val_auroc:  0.8287923416789397 val_auprc:  0.902635986909336
EarlyStopping counter: 21 out of 50
epoch:  104
epoch:  105 val_f1:  0.7809570525397864 val_auroc:  0.8306332842415316 val_auprc:  0.9028391764210142
EarlyStopping counter: 22 out of 50
epoch:  105
epoch:  106 val_f1:  0.7919479944965341 val_auroc:  0.828546882670594 val_auprc:  0.8990494019440135
EarlyStopping counter: 23 out of 50
epoch:  106
epoch:  107 val_f1:  0.7919479944965341 val_auroc:  0.8298969072164949 val_auprc:  0.9019078170815473
EarlyStopping counter: 24 out of 50
epoch:  107
epoch:  108 val_f1:  0.8003084642191267 val_auroc:  0.8302650957290133 val_auprc:  0.9006992038349622
EarlyStopping counter: 25 out of 50
epoch:  108
epoch:  109 val_f1:  0.7938350857775318 val_auroc:  0.8294059891998037 val_auprc:  0.9012483408211616
EarlyStopping counter: 26 out of 50
epoch:  109
epoch:  110 val_f1:  0.7890919075230509 val_auroc:  0.8292832596956308 val_auprc:  0.902471130084975
EarlyStopping counter: 27 out of 50
epoch:  110
epoch:  111 val_f1:  0.7841726618705036 val_auroc:  0.8268286696121747 val_auprc:  0.8986786060630356
EarlyStopping counter: 28 out of 50
epoch:  111
epoch:  112 val_f1:  0.7920536597238516 val_auroc:  0.8274423171330388 val_auprc:  0.8997900636502645
EarlyStopping counter: 29 out of 50
epoch:  112
epoch:  113 val_f1:  0.7985611510791367 val_auroc:  0.8265832106038291 val_auprc:  0.9000454772308778
EarlyStopping counter: 30 out of 50
epoch:  113
epoch:  114 val_f1:  0.7826417810500232 val_auroc:  0.82486499754541 val_auprc:  0.8979735844801322
EarlyStopping counter: 31 out of 50
epoch:  114
epoch:  115 val_f1:  0.7890919075230509 val_auroc:  0.8281786941580757 val_auprc:  0.9005012659033849
EarlyStopping counter: 32 out of 50
epoch:  115
epoch:  116 val_f1:  0.7920536597238516 val_auroc:  0.8275650466372115 val_auprc:  0.9013367666362151
EarlyStopping counter: 33 out of 50
epoch:  116
epoch:  117 val_f1:  0.7890919075230509 val_auroc:  0.8270741286205204 val_auprc:  0.9031003416315095
EarlyStopping counter: 34 out of 50
epoch:  117
epoch:  118 val_f1:  0.7607401077265918 val_auroc:  0.8276877761413844 val_auprc:  0.8961171948387774
Validation loss improved to 0.090278
epoch:  118
epoch:  119 val_f1:  0.7635640416019908 val_auroc:  0.8276877761413843 val_auprc:  0.9020192251588948
EarlyStopping counter: 1 out of 50
epoch:  119
epoch:  120 val_f1:  0.7813819697019021 val_auroc:  0.8287923416789396 val_auprc:  0.9061386339026676
EarlyStopping counter: 2 out of 50
epoch:  120
epoch:  121 val_f1:  0.7712620601193464 val_auroc:  0.8274423171330388 val_auprc:  0.9010544005517611
EarlyStopping counter: 3 out of 50
epoch:  121
epoch:  122 val_f1:  0.7868059619290214 val_auroc:  0.8259695630829651 val_auprc:  0.8998704924616517
EarlyStopping counter: 4 out of 50
epoch:  122
epoch:  123 val_f1:  0.7933255489848959 val_auroc:  0.8243740795287187 val_auprc:  0.8989523000629519
EarlyStopping counter: 5 out of 50
epoch:  123
epoch:  124 val_f1:  0.7971323289800215 val_auroc:  0.8238831615120276 val_auprc:  0.8982160782529646
EarlyStopping counter: 6 out of 50
epoch:  124
epoch:  125 val_f1:  0.7920536597238516 val_auroc:  0.8267059401080019 val_auprc:  0.9014800579085338
EarlyStopping counter: 7 out of 50
epoch:  125
epoch:  126 val_f1:  0.7971323289800215 val_auroc:  0.8295287187039764 val_auprc:  0.9015626869420791
EarlyStopping counter: 8 out of 50
epoch:  126
epoch:  127 val_f1:  0.7841726618705036 val_auroc:  0.8252331860579284 val_auprc:  0.8991484635320255
EarlyStopping counter: 9 out of 50
epoch:  127
epoch:  128 val_f1:  0.7971323289800215 val_auroc:  0.8252331860579284 val_auprc:  0.8975822066762259
EarlyStopping counter: 10 out of 50
epoch:  128
epoch:  129 val_f1:  0.7873856121514594 val_auroc:  0.8259695630829651 val_auprc:  0.89718945796997
EarlyStopping counter: 11 out of 50
epoch:  129
epoch:  130 val_f1:  0.7898876447331801 val_auroc:  0.8259695630829652 val_auprc:  0.8992620182488196
EarlyStopping counter: 12 out of 50
epoch:  130
epoch:  131 val_f1:  0.7834737923946559 val_auroc:  0.8257241040746196 val_auprc:  0.9009634654596654
EarlyStopping counter: 13 out of 50
epoch:  131
epoch:  132 val_f1:  0.7873856121514594 val_auroc:  0.8257241040746196 val_auprc:  0.9007680673022337
EarlyStopping counter: 14 out of 50
epoch:  132
epoch:  133 val_f1:  0.7873856121514594 val_auroc:  0.8274423171330387 val_auprc:  0.9000229495162764
EarlyStopping counter: 15 out of 50
epoch:  133
epoch:  134 val_f1:  0.7920536597238516 val_auroc:  0.8267059401080019 val_auprc:  0.9005274096590481
EarlyStopping counter: 16 out of 50
epoch:  134
epoch:  135 val_f1:  0.7841726618705036 val_auroc:  0.8244968090328915 val_auprc:  0.8985803057248776
EarlyStopping counter: 17 out of 50
epoch:  135
epoch:  136 val_f1:  0.7906450372602754 val_auroc:  0.824251350024546 val_auprc:  0.897844471035504
EarlyStopping counter: 18 out of 50
epoch:  136
epoch:  137 val_f1:  0.7809570525397864 val_auroc:  0.8268286696121747 val_auprc:  0.8996681730951784
EarlyStopping counter: 19 out of 50
epoch:  137
epoch:  138 val_f1:  0.7938350857775318 val_auroc:  0.8262150220913107 val_auprc:  0.8985305372626985
EarlyStopping counter: 20 out of 50
epoch:  138
epoch:  139 val_f1:  0.7984066342984726 val_auroc:  0.8276877761413844 val_auprc:  0.9001026039746737
EarlyStopping counter: 21 out of 50
epoch:  139
epoch:  140 val_f1:  0.7791090204759269 val_auroc:  0.8264604810996563 val_auprc:  0.899911151616441
EarlyStopping counter: 22 out of 50
epoch:  140
epoch:  141 val_f1:  0.7971323289800215 val_auroc:  0.8264604810996563 val_auprc:  0.9011563342699593
EarlyStopping counter: 23 out of 50
epoch:  141
epoch:  142 val_f1:  0.7809570525397864 val_auroc:  0.826705940108002 val_auprc:  0.8978922907045409
EarlyStopping counter: 24 out of 50
epoch:  142
epoch:  143 val_f1:  0.7971323289800215 val_auroc:  0.8264604810996563 val_auprc:  0.898130156892584
EarlyStopping counter: 25 out of 50
epoch:  143
epoch:  144 val_f1:  0.7855581813618873 val_auroc:  0.8270741286205204 val_auprc:  0.9024148466730632
EarlyStopping counter: 26 out of 50
epoch:  144
epoch:  145 val_f1:  0.7790721385700611 val_auroc:  0.8274423171330388 val_auprc:  0.9003802912776703
EarlyStopping counter: 27 out of 50
epoch:  145
epoch:  146 val_f1:  0.7971323289800215 val_auroc:  0.8237604320078546 val_auprc:  0.8957473771016373
EarlyStopping counter: 28 out of 50
epoch:  146
epoch:  147 val_f1:  0.7855581813618873 val_auroc:  0.8263377515954835 val_auprc:  0.89979216253279
EarlyStopping counter: 29 out of 50
epoch:  147
epoch:  148 val_f1:  0.7938350857775318 val_auroc:  0.8252331860579283 val_auprc:  0.895293114853342
EarlyStopping counter: 30 out of 50
epoch:  148
epoch:  149 val_f1:  0.7873856121514594 val_auroc:  0.8259695630829651 val_auprc:  0.8957014381503114
EarlyStopping counter: 31 out of 50
epoch:  149
epoch:  150 val_f1:  0.7955599157038007 val_auroc:  0.82486499754541 val_auprc:  0.8946280097654937
EarlyStopping counter: 32 out of 50
epoch:  150
epoch:  151 val_f1:  0.7971323289800215 val_auroc:  0.8243740795287187 val_auprc:  0.8937330931403233
EarlyStopping counter: 33 out of 50
epoch:  151
epoch:  152 val_f1:  0.7984066342984726 val_auroc:  0.8240058910162004 val_auprc:  0.8902701452628292
EarlyStopping counter: 34 out of 50
epoch:  152
epoch:  153 val_f1:  0.7873856121514594 val_auroc:  0.8237604320078546 val_auprc:  0.8885621714977809
EarlyStopping counter: 35 out of 50
epoch:  153
epoch:  154 val_f1:  0.7873856121514594 val_auroc:  0.8248649975454099 val_auprc:  0.894163731144747
EarlyStopping counter: 36 out of 50
epoch:  154
epoch:  155 val_f1:  0.7855581813618873 val_auroc:  0.8231467844869906 val_auprc:  0.897477121376599
EarlyStopping counter: 37 out of 50
epoch:  155
epoch:  156 val_f1:  0.7933255489848959 val_auroc:  0.8244968090328915 val_auprc:  0.8994747772274739
EarlyStopping counter: 38 out of 50
epoch:  156
epoch:  157 val_f1:  0.7855581813618873 val_auroc:  0.824251350024546 val_auprc:  0.8968173116267144
EarlyStopping counter: 39 out of 50
epoch:  157
epoch:  158 val_f1:  0.7791090204759269 val_auroc:  0.8230240549828178 val_auprc:  0.88931751629494
EarlyStopping counter: 40 out of 50
epoch:  158
epoch:  159 val_f1:  0.7890919075230509 val_auroc:  0.8230240549828178 val_auprc:  0.8955256118887179
EarlyStopping counter: 41 out of 50
epoch:  159
epoch:  160 val_f1:  0.7890919075230509 val_auroc:  0.8254786450662739 val_auprc:  0.8953549112580799
EarlyStopping counter: 42 out of 50
epoch:  160
epoch:  161 val_f1:  0.7890919075230509 val_auroc:  0.8263377515954835 val_auprc:  0.8957066887055674
EarlyStopping counter: 43 out of 50
epoch:  161
epoch:  162 val_f1:  0.7955599157038007 val_auroc:  0.8244968090328915 val_auprc:  0.891788659808424
EarlyStopping counter: 44 out of 50
epoch:  162
epoch:  163 val_f1:  0.7955599157038007 val_auroc:  0.8244968090328916 val_auprc:  0.890057162513049
EarlyStopping counter: 45 out of 50
epoch:  163
epoch:  164 val_f1:  0.7920536597238516 val_auroc:  0.8237604320078546 val_auprc:  0.8956469477324186
EarlyStopping counter: 46 out of 50
epoch:  164
epoch:  165 val_f1:  0.7985611510791367 val_auroc:  0.8265832106038292 val_auprc:  0.8953204747793404
EarlyStopping counter: 47 out of 50
epoch:  165
epoch:  166 val_f1:  0.7955599157038007 val_auroc:  0.8232695139911634 val_auprc:  0.8892769029143098
EarlyStopping counter: 48 out of 50
epoch:  166
epoch:  167 val_f1:  0.7955599157038007 val_auroc:  0.8249877270495827 val_auprc:  0.8919629528586681
EarlyStopping counter: 49 out of 50
epoch:  167
epoch:  168 val_f1:  0.7791090204759269 val_auroc:  0.8240058910162003 val_auprc:  0.8944838716397678
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  2476.6213018894196
{'time_elapsed': [2476.6213018894196], 'epoch': [167], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7791090204759269], 'auroc_test': [0.8240058910162003], 'auprc_test': [0.8944838716397678]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1276]           4,096
│    └─BatchNorm1d: 2-2                  [64, 512, 1276]           1,024
│    └─Tanh: 2-3                         [64, 512, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1270]           --
│    └─Dropout: 2-5                      [64, 512, 1270]           --
│    └─Flatten: 2-6                      [64, 650240]              --
│    └─Linear: 2-7                       [64, 1]                   650,241
==========================================================================================
Total params: 655,361
Trainable params: 655,361
Non-trainable params: 0
Total mult-adds (M): 376.18
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 668.99
Params size (MB): 2.62
Estimated Total Size (MB): 671.94
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.4717207752667256 val_auroc:  0.6330387825233186 val_auprc:  0.7934789282979979
epoch:  1
epoch:  2 val_f1:  0.5901224965973166 val_auroc:  0.4953362788414335 val_auprc:  0.8010092998234687
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.4247067613974088 val_auroc:  0.5552282768777614 val_auprc:  0.7707335005275864
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5963115222108029 val_auroc:  0.5914334806087383 val_auprc:  0.7988023559845774
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6554180610730549 val_auroc:  0.6406480117820323 val_auprc:  0.8294689540341799
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6773246443990799 val_auroc:  0.7103583701521845 val_auprc:  0.8647337047435905
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.6776748813714986 val_auroc:  0.73073146784487 val_auprc:  0.867445390051743
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.7011215811505187 val_auroc:  0.7498772704958272 val_auprc:  0.8758988793716334
EarlyStopping counter: 7 out of 50
epoch:  8
epoch:  9 val_f1:  0.7023865734042448 val_auroc:  0.7582228767795778 val_auprc:  0.88198096663979
EarlyStopping counter: 8 out of 50
epoch:  9
epoch:  10 val_f1:  0.7346891520614657 val_auroc:  0.770495827196858 val_auprc:  0.8875831556103375
Validation loss improved to 0.489293
epoch:  10
epoch:  11 val_f1:  0.7412236216203913 val_auroc:  0.7793323514973 val_auprc:  0.8902075232934443
Validation loss improved to 0.468577
epoch:  11
epoch:  12 val_f1:  0.6289646282660997 val_auroc:  0.7790868924889542 val_auprc:  0.8887542842304644
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7178022432023763 val_auroc:  0.7776141384388807 val_auprc:  0.8873703982427258
Validation loss improved to 0.428714
epoch:  13
epoch:  14 val_f1:  0.7745465218349855 val_auroc:  0.7876779577810505 val_auprc:  0.892210268205397
Validation loss improved to 0.376568
epoch:  14
epoch:  15 val_f1:  0.7441671543148256 val_auroc:  0.7864506627393225 val_auprc:  0.8908874234913692
Validation loss improved to 0.361538
epoch:  15
epoch:  16 val_f1:  0.7142089711496735 val_auroc:  0.7687776141384389 val_auprc:  0.8834534154213666
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7455074238481555 val_auroc:  0.7798232695139912 val_auprc:  0.889650224580675
Validation loss improved to 0.355285
epoch:  17
epoch:  18 val_f1:  0.7643829551743221 val_auroc:  0.7820324005891016 val_auprc:  0.8910982936994172
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7207289113763933 val_auroc:  0.7582228767795778 val_auprc:  0.8781110047954942
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7384802450563926 val_auroc:  0.7852233676975946 val_auprc:  0.8917170773883224
EarlyStopping counter: 3 out of 50
epoch:  20
epoch:  21 val_f1:  0.7328919440906961 val_auroc:  0.7695139911634757 val_auprc:  0.8832590945721182
EarlyStopping counter: 4 out of 50
epoch:  21
epoch:  22 val_f1:  0.7287333672277241 val_auroc:  0.7712322042218949 val_auprc:  0.886530637691625
EarlyStopping counter: 5 out of 50
epoch:  22
epoch:  23 val_f1:  0.6754718212640907 val_auroc:  0.7616593028964163 val_auprc:  0.882543017785275
EarlyStopping counter: 6 out of 50
epoch:  23
epoch:  24 val_f1:  0.7011215811505187 val_auroc:  0.7746686303387335 val_auprc:  0.8884609887370161
EarlyStopping counter: 7 out of 50
epoch:  24
epoch:  25 val_f1:  0.7107661257285465 val_auroc:  0.7682866961217476 val_auprc:  0.884811743657275
EarlyStopping counter: 8 out of 50
epoch:  25
epoch:  26 val_f1:  0.7090514753972222 val_auroc:  0.7685321551300932 val_auprc:  0.8812014745620713
EarlyStopping counter: 9 out of 50
epoch:  26
epoch:  27 val_f1:  0.7226305629385982 val_auroc:  0.7727049582719685 val_auprc:  0.8797363557794176
EarlyStopping counter: 10 out of 50
epoch:  27
epoch:  28 val_f1:  0.5323741007194245 val_auroc:  0.7528227785959745 val_auprc:  0.8753724770259628
EarlyStopping counter: 11 out of 50
epoch:  28
epoch:  29 val_f1:  0.7024482739389885 val_auroc:  0.7776141384388807 val_auprc:  0.8899084461385213
EarlyStopping counter: 12 out of 50
epoch:  29
epoch:  30 val_f1:  0.7225455998837295 val_auroc:  0.7638684339715268 val_auprc:  0.8795289772435659
EarlyStopping counter: 13 out of 50
epoch:  30
epoch:  31 val_f1:  0.722058496910722 val_auroc:  0.76926853215513 val_auprc:  0.8824626480579447
EarlyStopping counter: 14 out of 50
epoch:  31
epoch:  32 val_f1:  0.7044810154681304 val_auroc:  0.7663230240549829 val_auprc:  0.8816580566013787
EarlyStopping counter: 15 out of 50
epoch:  32
epoch:  33 val_f1:  0.7553956834532374 val_auroc:  0.7744231713303878 val_auprc:  0.8856066983476307
EarlyStopping counter: 16 out of 50
epoch:  33
epoch:  34 val_f1:  0.7411406017655346 val_auroc:  0.7626411389297987 val_auprc:  0.8761032083615509
EarlyStopping counter: 17 out of 50
epoch:  34
epoch:  35 val_f1:  0.7185533480648861 val_auroc:  0.7717231222385862 val_auprc:  0.8844050069718379
EarlyStopping counter: 18 out of 50
epoch:  35
epoch:  36 val_f1:  0.743396428458658 val_auroc:  0.761168384879725 val_auprc:  0.8737765696630924
EarlyStopping counter: 19 out of 50
epoch:  36
epoch:  37 val_f1:  0.7386752666832053 val_auroc:  0.7660775650466372 val_auprc:  0.8790064556477545
EarlyStopping counter: 20 out of 50
epoch:  37
epoch:  38 val_f1:  0.7044810154681304 val_auroc:  0.7594501718213058 val_auprc:  0.8732923694655772
EarlyStopping counter: 21 out of 50
epoch:  38
epoch:  39 val_f1:  0.7298678635622811 val_auroc:  0.7670594010800197 val_auprc:  0.8787468040047806
EarlyStopping counter: 22 out of 50
epoch:  39
epoch:  40 val_f1:  0.6872202593435662 val_auroc:  0.7525773195876289 val_auprc:  0.8685872518203441
EarlyStopping counter: 23 out of 50
epoch:  40
epoch:  41 val_f1:  0.7490302789770621 val_auroc:  0.7604320078546882 val_auprc:  0.8727834264377821
EarlyStopping counter: 24 out of 50
epoch:  41
epoch:  42 val_f1:  0.7386752666832053 val_auroc:  0.7582228767795778 val_auprc:  0.869374172724463
EarlyStopping counter: 25 out of 50
epoch:  42
epoch:  43 val_f1:  0.7536606851900262 val_auroc:  0.7609229258713794 val_auprc:  0.8700177623245473
EarlyStopping counter: 26 out of 50
epoch:  43
epoch:  44 val_f1:  0.76000113614692 val_auroc:  0.7619047619047619 val_auprc:  0.8726463000662972
EarlyStopping counter: 27 out of 50
epoch:  44
epoch:  45 val_f1:  0.7473654218886486 val_auroc:  0.7569955817378499 val_auprc:  0.8678724223792047
EarlyStopping counter: 28 out of 50
epoch:  45
epoch:  46 val_f1:  0.7346891520614657 val_auroc:  0.751840942562592 val_auprc:  0.8633680997520572
EarlyStopping counter: 29 out of 50
epoch:  46
epoch:  47 val_f1:  0.76000113614692 val_auroc:  0.7555228276877762 val_auprc:  0.8699891516984043
EarlyStopping counter: 30 out of 50
epoch:  47
epoch:  48 val_f1:  0.7044810154681304 val_auroc:  0.7488954344624448 val_auprc:  0.8642048442128463
EarlyStopping counter: 31 out of 50
epoch:  48
epoch:  49 val_f1:  0.7299542184434271 val_auroc:  0.7449680903289151 val_auprc:  0.860713630208304
EarlyStopping counter: 32 out of 50
epoch:  49
epoch:  50 val_f1:  0.6893376055458154 val_auroc:  0.7628865979381443 val_auprc:  0.8766899749736947
EarlyStopping counter: 33 out of 50
epoch:  50
epoch:  51 val_f1:  0.7580594896895918 val_auroc:  0.7486499754540992 val_auprc:  0.8636686426151738
EarlyStopping counter: 34 out of 50
epoch:  51
epoch:  52 val_f1:  0.7473302173830908 val_auroc:  0.7542955326460482 val_auprc:  0.8691955635057134
EarlyStopping counter: 35 out of 50
epoch:  52
epoch:  53 val_f1:  0.7411406017655346 val_auroc:  0.750613647520864 val_auprc:  0.8644733267519735
EarlyStopping counter: 36 out of 50
epoch:  53
epoch:  54 val_f1:  0.7410071942446043 val_auroc:  0.7540500736377026 val_auprc:  0.8689630743242815
EarlyStopping counter: 37 out of 50
epoch:  54
epoch:  55 val_f1:  0.76000113614692 val_auroc:  0.7484045164457536 val_auprc:  0.8583148810952792
EarlyStopping counter: 38 out of 50
epoch:  55
epoch:  56 val_f1:  0.76000113614692 val_auroc:  0.7550319096710849 val_auprc:  0.8670230008918083
EarlyStopping counter: 39 out of 50
epoch:  56
epoch:  57 val_f1:  0.76000113614692 val_auroc:  0.7503681885125184 val_auprc:  0.8618241601945482
EarlyStopping counter: 40 out of 50
epoch:  57
epoch:  58 val_f1:  0.766354189375772 val_auroc:  0.7525773195876289 val_auprc:  0.861813527837235
EarlyStopping counter: 41 out of 50
epoch:  58
epoch:  59 val_f1:  0.7473302173830908 val_auroc:  0.7508591065292096 val_auprc:  0.8620094596650527
EarlyStopping counter: 42 out of 50
epoch:  59
epoch:  60 val_f1:  0.6951967837494709 val_auroc:  0.7439862542955327 val_auprc:  0.8577894935271146
EarlyStopping counter: 43 out of 50
epoch:  60
epoch:  61 val_f1:  0.7386752666832053 val_auroc:  0.7459499263622975 val_auprc:  0.8580874278822035
EarlyStopping counter: 44 out of 50
epoch:  61
epoch:  62 val_f1:  0.7473654218886486 val_auroc:  0.7552773686794305 val_auprc:  0.8629581357991347
EarlyStopping counter: 45 out of 50
epoch:  62
epoch:  63 val_f1:  0.7411406017655346 val_auroc:  0.7550319096710849 val_auprc:  0.8602871662337785
EarlyStopping counter: 46 out of 50
epoch:  63
epoch:  64 val_f1:  0.766354189375772 val_auroc:  0.7557682866961217 val_auprc:  0.865102814583133
EarlyStopping counter: 47 out of 50
epoch:  64
epoch:  65 val_f1:  0.7094198370570532 val_auroc:  0.7501227295041728 val_auprc:  0.858774878287794
EarlyStopping counter: 48 out of 50
epoch:  65
epoch:  66 val_f1:  0.7410071942446043 val_auroc:  0.7479135984290622 val_auprc:  0.8584425894185963
EarlyStopping counter: 49 out of 50
epoch:  66
epoch:  67 val_f1:  0.7496568898727172 val_auroc:  0.7511045655375551 val_auprc:  0.8604185115577752
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  989.1183416843414
{'time_elapsed': [989.1183416843414], 'epoch': [66], 'fold': [2], 'f1_train': [0.9981996872393208], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7496568898727172], 'auroc_test': [0.7511045655375551], 'auprc_test': [0.8604185115577752]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1276]           4,096
│    └─BatchNorm1d: 2-2                  [64, 512, 1276]           1,024
│    └─Tanh: 2-3                         [64, 512, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1270]           --
│    └─Dropout: 2-5                      [64, 512, 1270]           --
│    └─Flatten: 2-6                      [64, 650240]              --
│    └─Linear: 2-7                       [64, 1]                   650,241
==========================================================================================
Total params: 655,361
Trainable params: 655,361
Non-trainable params: 0
Total mult-adds (M): 376.18
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 668.99
Params size (MB): 2.62
Estimated Total Size (MB): 671.94
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5642736874330323 val_auroc:  0.5511143410852714 val_auprc:  0.8344542132991799
epoch:  1
epoch:  2 val_f1:  0.49867092454661743 val_auroc:  0.559593023255814 val_auprc:  0.7651382327848918
Validation loss improved to 0.790215
epoch:  2
epoch:  3 val_f1:  0.49867092454661743 val_auroc:  0.5568071705426356 val_auprc:  0.7646023076395475
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.563739616851115 val_auroc:  0.559593023255814 val_auprc:  0.76929612023293
Validation loss improved to 0.673321
epoch:  4
epoch:  5 val_f1:  0.6133295261978511 val_auroc:  0.5735222868217056 val_auprc:  0.7767730127703416
Validation loss improved to 0.467214
epoch:  5
epoch:  6 val_f1:  0.530352044171619 val_auroc:  0.5962936046511629 val_auprc:  0.7649894965699855
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.6551236321866877 val_auroc:  0.6349321705426356 val_auprc:  0.8137877962996853
Validation loss improved to 0.099167
epoch:  7
epoch:  8 val_f1:  0.6823179642859383 val_auroc:  0.6810804263565892 val_auprc:  0.8113087395693647
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.646141781867652 val_auroc:  0.7061531007751938 val_auprc:  0.846345497058644
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.6759528547374866 val_auroc:  0.7449127906976745 val_auprc:  0.8741155175619404
EarlyStopping counter: 3 out of 50
epoch:  10
epoch:  11 val_f1:  0.7219264716637606 val_auroc:  0.7757994186046512 val_auprc:  0.888718588473729
EarlyStopping counter: 4 out of 50
epoch:  11
epoch:  12 val_f1:  0.6663129187901823 val_auroc:  0.7785852713178295 val_auprc:  0.8806463878364085
EarlyStopping counter: 5 out of 50
epoch:  12
epoch:  13 val_f1:  0.7267015342626987 val_auroc:  0.7781007751937985 val_auprc:  0.8762584923661865
EarlyStopping counter: 6 out of 50
epoch:  13
epoch:  14 val_f1:  0.757449328289459 val_auroc:  0.7865794573643412 val_auprc:  0.8865347124299248
EarlyStopping counter: 7 out of 50
epoch:  14
epoch:  15 val_f1:  0.7646080538166868 val_auroc:  0.7916666666666666 val_auprc:  0.8929844904239274
EarlyStopping counter: 8 out of 50
epoch:  15
epoch:  16 val_f1:  0.7289753081911234 val_auroc:  0.7945736434108527 val_auprc:  0.895513403658252
EarlyStopping counter: 9 out of 50
epoch:  16
epoch:  17 val_f1:  0.665120160996229 val_auroc:  0.7951792635658915 val_auprc:  0.8928673825424854
EarlyStopping counter: 10 out of 50
epoch:  17
epoch:  18 val_f1:  0.7628987147360764 val_auroc:  0.8006298449612403 val_auprc:  0.895932368073136
EarlyStopping counter: 11 out of 50
epoch:  18
epoch:  19 val_f1:  0.7352190974493134 val_auroc:  0.80765503875969 val_auprc:  0.8993242136601317
EarlyStopping counter: 12 out of 50
epoch:  19
epoch:  20 val_f1:  0.7368544189039011 val_auroc:  0.8112887596899224 val_auprc:  0.9047710124190959
EarlyStopping counter: 13 out of 50
epoch:  20
epoch:  21 val_f1:  0.7537445742963803 val_auroc:  0.8137112403100776 val_auprc:  0.9075137272837835
EarlyStopping counter: 14 out of 50
epoch:  21
epoch:  22 val_f1:  0.7153999572619133 val_auroc:  0.813953488372093 val_auprc:  0.9074966201691337
EarlyStopping counter: 15 out of 50
epoch:  22
epoch:  23 val_f1:  0.7679977157187104 val_auroc:  0.8185562015503876 val_auprc:  0.9098368053935713
EarlyStopping counter: 16 out of 50
epoch:  23
epoch:  24 val_f1:  0.767033173809688 val_auroc:  0.8197674418604652 val_auprc:  0.9108450977950013
EarlyStopping counter: 17 out of 50
epoch:  24
epoch:  25 val_f1:  0.7682301875730638 val_auroc:  0.8209786821705426 val_auprc:  0.9109058647411195
EarlyStopping counter: 18 out of 50
epoch:  25
epoch:  26 val_f1:  0.7811523753969797 val_auroc:  0.8275193798449612 val_auprc:  0.9163958645219894
EarlyStopping counter: 19 out of 50
epoch:  26
epoch:  27 val_f1:  0.7436252915321436 val_auroc:  0.8294573643410853 val_auprc:  0.9168983660492683
EarlyStopping counter: 20 out of 50
epoch:  27
epoch:  28 val_f1:  0.7436252915321436 val_auroc:  0.8301841085271316 val_auprc:  0.9191476855519591
EarlyStopping counter: 21 out of 50
epoch:  28
epoch:  29 val_f1:  0.7789671954250403 val_auroc:  0.8296996124031008 val_auprc:  0.9193660171196909
EarlyStopping counter: 22 out of 50
epoch:  29
epoch:  30 val_f1:  0.7762051583223217 val_auroc:  0.8316375968992248 val_auprc:  0.9198922704577533
EarlyStopping counter: 23 out of 50
epoch:  30
epoch:  31 val_f1:  0.7365583395352684 val_auroc:  0.8357558139534883 val_auprc:  0.9236769658093746
EarlyStopping counter: 24 out of 50
epoch:  31
epoch:  32 val_f1:  0.7645539537561222 val_auroc:  0.8372093023255814 val_auprc:  0.9245134185572949
EarlyStopping counter: 25 out of 50
epoch:  32
epoch:  33 val_f1:  0.6836886454139441 val_auroc:  0.838420542635659 val_auprc:  0.9233851273791049
EarlyStopping counter: 26 out of 50
epoch:  33
epoch:  34 val_f1:  0.7754499696945739 val_auroc:  0.8396317829457365 val_auprc:  0.9268899229796543
EarlyStopping counter: 27 out of 50
epoch:  34
epoch:  35 val_f1:  0.7601256159113488 val_auroc:  0.8406007751937984 val_auprc:  0.9267133840578481
EarlyStopping counter: 28 out of 50
epoch:  35
epoch:  36 val_f1:  0.7601256159113488 val_auroc:  0.8415697674418604 val_auprc:  0.9267377806974959
EarlyStopping counter: 29 out of 50
epoch:  36
epoch:  37 val_f1:  0.7075580393188603 val_auroc:  0.842296511627907 val_auprc:  0.9293139525018101
EarlyStopping counter: 30 out of 50
epoch:  37
epoch:  38 val_f1:  0.7537445742963803 val_auroc:  0.8437499999999999 val_auprc:  0.928064502717665
EarlyStopping counter: 31 out of 50
epoch:  38
epoch:  39 val_f1:  0.7877294237541244 val_auroc:  0.845687984496124 val_auprc:  0.9283587408761685
EarlyStopping counter: 32 out of 50
epoch:  39
epoch:  40 val_f1:  0.7886649052635782 val_auroc:  0.845687984496124 val_auprc:  0.9283788829672244
EarlyStopping counter: 33 out of 50
epoch:  40
epoch:  41 val_f1:  0.7841726618705036 val_auroc:  0.8444767441860465 val_auprc:  0.9275465821693727
EarlyStopping counter: 34 out of 50
epoch:  41
epoch:  42 val_f1:  0.7789671954250403 val_auroc:  0.845203488372093 val_auprc:  0.929147897461186
EarlyStopping counter: 35 out of 50
epoch:  42
epoch:  43 val_f1:  0.7628987147360764 val_auroc:  0.8459302325581396 val_auprc:  0.9300613678530665
EarlyStopping counter: 36 out of 50
epoch:  43
epoch:  44 val_f1:  0.7729252582141845 val_auroc:  0.8447189922480621 val_auprc:  0.9292652289608333
EarlyStopping counter: 37 out of 50
epoch:  44
epoch:  45 val_f1:  0.7625825493451395 val_auroc:  0.846172480620155 val_auprc:  0.9295826967406113
EarlyStopping counter: 38 out of 50
epoch:  45
epoch:  46 val_f1:  0.7715286178137136 val_auroc:  0.846656976744186 val_auprc:  0.9323201982492522
EarlyStopping counter: 39 out of 50
epoch:  46
epoch:  47 val_f1:  0.7021522277975939 val_auroc:  0.847141472868217 val_auprc:  0.9308806064498818
EarlyStopping counter: 40 out of 50
epoch:  47
epoch:  48 val_f1:  0.7359332786935009 val_auroc:  0.8430232558139534 val_auprc:  0.9291222782753407
EarlyStopping counter: 41 out of 50
epoch:  48
epoch:  49 val_f1:  0.7139825018201562 val_auroc:  0.845203488372093 val_auprc:  0.9278258998003699
EarlyStopping counter: 42 out of 50
epoch:  49
epoch:  50 val_f1:  0.7426405456673774 val_auroc:  0.8437500000000001 val_auprc:  0.9327875799240224
EarlyStopping counter: 43 out of 50
epoch:  50
epoch:  51 val_f1:  0.6447788128657477 val_auroc:  0.8498062015503876 val_auprc:  0.9325631602096931
EarlyStopping counter: 44 out of 50
epoch:  51
epoch:  52 val_f1:  0.7639114172852699 val_auroc:  0.8505329457364341 val_auprc:  0.9309829548183839
EarlyStopping counter: 45 out of 50
epoch:  52
epoch:  53 val_f1:  0.7997900244397783 val_auroc:  0.8505329457364341 val_auprc:  0.9348695002392794
EarlyStopping counter: 46 out of 50
epoch:  53
epoch:  54 val_f1:  0.7972014141264308 val_auroc:  0.8517441860465116 val_auprc:  0.9342613333522309
EarlyStopping counter: 47 out of 50
epoch:  54
epoch:  55 val_f1:  0.7866727894280321 val_auroc:  0.8544089147286822 val_auprc:  0.9334375052784404
EarlyStopping counter: 48 out of 50
epoch:  55
epoch:  56 val_f1:  0.7997900244397783 val_auroc:  0.8546511627906976 val_auprc:  0.9349458859505596
EarlyStopping counter: 49 out of 50
epoch:  56
epoch:  57 val_f1:  0.792019787311512 val_auroc:  0.8561046511627908 val_auprc:  0.9351187185099568
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  831.03755402565
{'time_elapsed': [831.03755402565], 'epoch': [56], 'fold': [3], 'f1_train': [0.9697211958081523], 'auroc_train': [0.9953549895410361], 'auprc_train': [0.9982476466533257], 'f1_test': [0.792019787311512], 'auroc_test': [0.8561046511627908], 'auprc_test': [0.9351187185099568]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1276]           4,096
│    └─BatchNorm1d: 2-2                  [64, 512, 1276]           1,024
│    └─Tanh: 2-3                         [64, 512, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1270]           --
│    └─Dropout: 2-5                      [64, 512, 1270]           --
│    └─Flatten: 2-6                      [64, 650240]              --
│    └─Linear: 2-7                       [64, 1]                   650,241
==========================================================================================
Total params: 655,361
Trainable params: 655,361
Non-trainable params: 0
Total mult-adds (M): 376.18
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 668.99
Params size (MB): 2.62
Estimated Total Size (MB): 671.94
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5707915273132664 val_auroc:  0.5 val_auprc:  0.8478260869565217
epoch:  1
epoch:  2 val_f1:  0.14202898550724638 val_auroc:  0.6731150793650794 val_auprc:  0.7688200683596879
Validation loss improved to 5.646134
epoch:  2
epoch:  3 val_f1:  0.6312385201674833 val_auroc:  0.6903521825396824 val_auprc:  0.7892806229881643
Validation loss improved to 0.749769
epoch:  3
epoch:  4 val_f1:  0.6787902634449949 val_auroc:  0.7894345238095237 val_auprc:  0.8960069637040222
Validation loss improved to 0.739309
epoch:  4
epoch:  5 val_f1:  0.6721086533474103 val_auroc:  0.816344246031746 val_auprc:  0.9087378294327635
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.8041106719367591 val_auroc:  0.8705357142857143 val_auprc:  0.9398966099055981
Validation loss improved to 0.275393
epoch:  6
epoch:  7 val_f1:  0.6602526439482962 val_auroc:  0.8839285714285715 val_auprc:  0.9420071968319078
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.7061872909698997 val_auroc:  0.888640873015873 val_auprc:  0.9458380633362125
EarlyStopping counter: 2 out of 50
epoch:  8
epoch:  9 val_f1:  0.7901185770750988 val_auroc:  0.8831845238095237 val_auprc:  0.944099777509382
Validation loss improved to 0.208719
epoch:  9
epoch:  10 val_f1:  0.7905459035188288 val_auroc:  0.8859126984126984 val_auprc:  0.9428796188482074
Validation loss improved to 0.196279
epoch:  10
epoch:  11 val_f1:  0.8215074100875418 val_auroc:  0.8792162698412698 val_auprc:  0.9382376066968483
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.8014350667803353 val_auroc:  0.8737599206349206 val_auprc:  0.9358068008727359
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.8113104975093783 val_auroc:  0.873263888888889 val_auprc:  0.9309582877470455
Validation loss improved to 0.191867
epoch:  13
epoch:  14 val_f1:  0.807228002894545 val_auroc:  0.8705357142857143 val_auprc:  0.9320971971578773
Validation loss improved to 0.185595
epoch:  14
epoch:  15 val_f1:  0.8120268224096906 val_auroc:  0.8648313492063493 val_auprc:  0.9263374452811086
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7988956640912072 val_auroc:  0.8561507936507937 val_auprc:  0.9136534561260319
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.807228002894545 val_auroc:  0.861359126984127 val_auprc:  0.9220684867478384
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.7971014492753623 val_auroc:  0.8625992063492064 val_auprc:  0.9252977095842565
EarlyStopping counter: 4 out of 50
epoch:  18
epoch:  19 val_f1:  0.7901701323251418 val_auroc:  0.8561507936507936 val_auprc:  0.9135341666769091
EarlyStopping counter: 5 out of 50
epoch:  19
epoch:  20 val_f1:  0.7733010668869473 val_auroc:  0.8596230158730158 val_auprc:  0.9132065054197501
EarlyStopping counter: 6 out of 50
epoch:  20
epoch:  21 val_f1:  0.8097298254042504 val_auroc:  0.8648313492063492 val_auprc:  0.9214614711381107
EarlyStopping counter: 7 out of 50
epoch:  21
epoch:  22 val_f1:  0.7733010668869473 val_auroc:  0.8578869047619048 val_auprc:  0.9109594762692045
EarlyStopping counter: 8 out of 50
epoch:  22
epoch:  23 val_f1:  0.8081713820844254 val_auroc:  0.863343253968254 val_auprc:  0.9223283043611081
EarlyStopping counter: 9 out of 50
epoch:  23
epoch:  24 val_f1:  0.8170893719806764 val_auroc:  0.8618551587301587 val_auprc:  0.9167440902861951
EarlyStopping counter: 10 out of 50
epoch:  24
epoch:  25 val_f1:  0.8090037477295196 val_auroc:  0.8670634920634921 val_auprc:  0.927467866796738
EarlyStopping counter: 11 out of 50
epoch:  25
epoch:  26 val_f1:  0.7969889682024659 val_auroc:  0.8601190476190477 val_auprc:  0.9041158680069793
EarlyStopping counter: 12 out of 50
epoch:  26
epoch:  27 val_f1:  0.792371879328401 val_auroc:  0.8643353174603174 val_auprc:  0.9196138861273171
EarlyStopping counter: 13 out of 50
epoch:  27
epoch:  28 val_f1:  0.807228002894545 val_auroc:  0.8593750000000001 val_auprc:  0.8973255349905576
EarlyStopping counter: 14 out of 50
epoch:  28
epoch:  29 val_f1:  0.8127933585226971 val_auroc:  0.8643353174603174 val_auprc:  0.9153616563810455
EarlyStopping counter: 15 out of 50
epoch:  29
epoch:  30 val_f1:  0.7875799991742021 val_auroc:  0.8611111111111112 val_auprc:  0.899410574607413
EarlyStopping counter: 16 out of 50
epoch:  30
epoch:  31 val_f1:  0.7839990466164816 val_auroc:  0.8596230158730159 val_auprc:  0.8983432062837182
EarlyStopping counter: 17 out of 50
epoch:  31
epoch:  32 val_f1:  0.7995542847531747 val_auroc:  0.8683035714285715 val_auprc:  0.922868456894689
EarlyStopping counter: 18 out of 50
epoch:  32
epoch:  33 val_f1:  0.8215074100875418 val_auroc:  0.8675595238095238 val_auprc:  0.9250943729636716
EarlyStopping counter: 19 out of 50
epoch:  33
epoch:  34 val_f1:  0.7839990466164816 val_auroc:  0.8658234126984126 val_auprc:  0.9089668098897322
EarlyStopping counter: 20 out of 50
epoch:  34
epoch:  35 val_f1:  0.7884143290944841 val_auroc:  0.8628472222222221 val_auprc:  0.9004355710430181
EarlyStopping counter: 21 out of 50
epoch:  35
epoch:  36 val_f1:  0.7839990466164816 val_auroc:  0.859375 val_auprc:  0.8983001421499732
EarlyStopping counter: 22 out of 50
epoch:  36
epoch:  37 val_f1:  0.792371879328401 val_auroc:  0.8648313492063492 val_auprc:  0.9090051523778406
EarlyStopping counter: 23 out of 50
epoch:  37
epoch:  38 val_f1:  0.8061683443992288 val_auroc:  0.8670634920634921 val_auprc:  0.9165198506283415
EarlyStopping counter: 24 out of 50
epoch:  38
epoch:  39 val_f1:  0.81483559295621 val_auroc:  0.8712797619047618 val_auprc:  0.9244840233767759
EarlyStopping counter: 25 out of 50
epoch:  39
epoch:  40 val_f1:  0.81483559295621 val_auroc:  0.8717757936507937 val_auprc:  0.9215950408905043
EarlyStopping counter: 26 out of 50
epoch:  40
epoch:  41 val_f1:  0.8036760694501368 val_auroc:  0.8737599206349206 val_auprc:  0.9194610969739558
EarlyStopping counter: 27 out of 50
epoch:  41
epoch:  42 val_f1:  0.7904805491990847 val_auroc:  0.8680555555555556 val_auprc:  0.9024210576790084
EarlyStopping counter: 28 out of 50
epoch:  42
epoch:  43 val_f1:  0.7839990466164816 val_auroc:  0.8643353174603176 val_auprc:  0.9005088191627795
EarlyStopping counter: 29 out of 50
epoch:  43
epoch:  44 val_f1:  0.7733010668869473 val_auroc:  0.8643353174603174 val_auprc:  0.901225816088179
EarlyStopping counter: 30 out of 50
epoch:  44
epoch:  45 val_f1:  0.7858717303302986 val_auroc:  0.865575396825397 val_auprc:  0.9013111541057663
EarlyStopping counter: 31 out of 50
epoch:  45
epoch:  46 val_f1:  0.7904805491990847 val_auroc:  0.8655753968253969 val_auprc:  0.9093119080664067
EarlyStopping counter: 32 out of 50
epoch:  46
epoch:  47 val_f1:  0.7891335560760728 val_auroc:  0.8665674603174602 val_auprc:  0.9019124708413296
EarlyStopping counter: 33 out of 50
epoch:  47
epoch:  48 val_f1:  0.792371879328401 val_auroc:  0.8663194444444444 val_auprc:  0.9020735377391711
EarlyStopping counter: 34 out of 50
epoch:  48
epoch:  49 val_f1:  0.7891335560760728 val_auroc:  0.8680555555555556 val_auprc:  0.914225882806066
EarlyStopping counter: 35 out of 50
epoch:  49
epoch:  50 val_f1:  0.7733010668869473 val_auroc:  0.8625992063492064 val_auprc:  0.8998640425619318
EarlyStopping counter: 36 out of 50
epoch:  50
epoch:  51 val_f1:  0.7891335560760728 val_auroc:  0.8670634920634921 val_auprc:  0.9134524143388238
EarlyStopping counter: 37 out of 50
epoch:  51
epoch:  52 val_f1:  0.7858717303302986 val_auroc:  0.8680555555555555 val_auprc:  0.9100247511489605
EarlyStopping counter: 38 out of 50
epoch:  52
epoch:  53 val_f1:  0.7793921916592724 val_auroc:  0.8653273809523809 val_auprc:  0.90899488625599
EarlyStopping counter: 39 out of 50
epoch:  53
epoch:  54 val_f1:  0.7971014492753623 val_auroc:  0.8685515873015872 val_auprc:  0.91055168153082
EarlyStopping counter: 40 out of 50
epoch:  54
epoch:  55 val_f1:  0.7940993788819876 val_auroc:  0.8675595238095237 val_auprc:  0.9101650843272033
EarlyStopping counter: 41 out of 50
epoch:  55
epoch:  56 val_f1:  0.792371879328401 val_auroc:  0.8635912698412698 val_auprc:  0.9003153431665993
EarlyStopping counter: 42 out of 50
epoch:  56
epoch:  57 val_f1:  0.7861608411480533 val_auroc:  0.8616071428571429 val_auprc:  0.8994047057616699
EarlyStopping counter: 43 out of 50
epoch:  57
epoch:  58 val_f1:  0.7669132597880164 val_auroc:  0.8643353174603176 val_auprc:  0.9011587437932216
EarlyStopping counter: 44 out of 50
epoch:  58
epoch:  59 val_f1:  0.7861608411480533 val_auroc:  0.8601190476190476 val_auprc:  0.8991361930977236
EarlyStopping counter: 45 out of 50
epoch:  59
epoch:  60 val_f1:  0.7861608411480533 val_auroc:  0.8598710317460317 val_auprc:  0.8986715856893683
EarlyStopping counter: 46 out of 50
epoch:  60
epoch:  61 val_f1:  0.7819511139952413 val_auroc:  0.865079365079365 val_auprc:  0.9094006272998525
EarlyStopping counter: 47 out of 50
epoch:  61
epoch:  62 val_f1:  0.7858717303302986 val_auroc:  0.8665674603174603 val_auprc:  0.9108407117564247
EarlyStopping counter: 48 out of 50
epoch:  62
epoch:  63 val_f1:  0.7729303439448368 val_auroc:  0.8663194444444444 val_auprc:  0.909780802545344
EarlyStopping counter: 49 out of 50
epoch:  63
epoch:  64 val_f1:  0.7669132597880164 val_auroc:  0.861111111111111 val_auprc:  0.8994346094944624
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  921.2639729976654
{'time_elapsed': [921.2639729976654], 'epoch': [63], 'fold': [4], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7669132597880164], 'auroc_test': [0.861111111111111], 'auprc_test': [0.8994346094944624]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1276]           4,096
│    └─BatchNorm1d: 2-2                  [64, 512, 1276]           1,024
│    └─Tanh: 2-3                         [64, 512, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1270]           --
│    └─Dropout: 2-5                      [64, 512, 1270]           --
│    └─Flatten: 2-6                      [64, 650240]              --
│    └─Linear: 2-7                       [64, 1]                   650,241
==========================================================================================
Total params: 655,361
Trainable params: 655,361
Non-trainable params: 0
Total mult-adds (M): 376.18
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 668.99
Params size (MB): 2.62
Estimated Total Size (MB): 671.94
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_44', 'config': {'hidden_channels': [512], 'epochs': 500, 'kernel_size': 7, 'pool_kernel_size': 7, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.4130352995337797 val_auroc:  0.6656848306332843 val_auprc:  0.8066663753341505
epoch:  1
epoch:  2 val_f1:  0.6310465491302215 val_auroc:  0.5665193912616593 val_auprc:  0.7207907470058901
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.34727525897170824 val_auroc:  0.600392734413353 val_auprc:  0.7426437647946073
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6059746872908405 val_auroc:  0.594747177221404 val_auprc:  0.742817732049215
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.5743222833497907 val_auroc:  0.6310751104565537 val_auprc:  0.7739182422381281
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6177136503088033 val_auroc:  0.6482572410407462 val_auprc:  0.7933946656326328
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.6033497670785479 val_auroc:  0.6863033873343152 val_auprc:  0.8260377831012624
Validation loss improved to 1.219152
epoch:  7
epoch:  8 val_f1:  0.6542023675489317 val_auroc:  0.7029945999018163 val_auprc:  0.8403904191475349
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.646667571603095 val_auroc:  0.734413352970054 val_auprc:  0.8620080668643133
Validation loss improved to 1.176737
epoch:  9
epoch:  10 val_f1:  0.6952451949622753 val_auroc:  0.7329405989199804 val_auprc:  0.8607951581592305
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.646667571603095 val_auroc:  0.7547864506627393 val_auprc:  0.874741289980866
Validation loss improved to 1.149620
epoch:  11
epoch:  12 val_f1:  0.7249644134959412 val_auroc:  0.757486499754541 val_auprc:  0.876715374076577
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.6618588605406337 val_auroc:  0.766813942071674 val_auprc:  0.8828420636685056
Validation loss improved to 1.139109
epoch:  13
epoch:  14 val_f1:  0.7466980132583976 val_auroc:  0.7653411880216003 val_auprc:  0.8823554705044601
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.646667571603095 val_auroc:  0.7761413843888071 val_auprc:  0.8889243791888938
Validation loss improved to 1.107590
epoch:  15
epoch:  16 val_f1:  0.7018261879839978 val_auroc:  0.7704958271968582 val_auprc:  0.8862008704630749
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.6682010713268466 val_auroc:  0.7800687285223368 val_auprc:  0.8921996467923067
Validation loss improved to 1.102080
epoch:  17
epoch:  18 val_f1:  0.7390688025474315 val_auroc:  0.775650466372116 val_auprc:  0.89004350376133
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.6376535972729985 val_auroc:  0.788659793814433 val_auprc:  0.8980033406406104
Validation loss improved to 1.079859
epoch:  19
epoch:  20 val_f1:  0.7346924658075737 val_auroc:  0.7815414825724104 val_auprc:  0.8942757863020243
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.735514445586388 val_auroc:  0.7876779577810507 val_auprc:  0.8996154019798305
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.6605237452657186 val_auroc:  0.7935689739813451 val_auprc:  0.9034580076923902
Validation loss improved to 1.063033
epoch:  22
epoch:  23 val_f1:  0.735514445586388 val_auroc:  0.7852233676975946 val_auprc:  0.8983197803041578
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.6892815309975336 val_auroc:  0.7881688757977418 val_auprc:  0.9008243641178156
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.7542604103291037 val_auroc:  0.787432498772705 val_auprc:  0.8998208360561597
EarlyStopping counter: 3 out of 50
epoch:  25
epoch:  26 val_f1:  0.7223183251151889 val_auroc:  0.7889052528227787 val_auprc:  0.9015974027115962
EarlyStopping counter: 4 out of 50
epoch:  26
epoch:  27 val_f1:  0.7095299887411026 val_auroc:  0.7935689739813451 val_auprc:  0.9046824489935308
EarlyStopping counter: 5 out of 50
epoch:  27
epoch:  28 val_f1:  0.7162290583621869 val_auroc:  0.7974963181148749 val_auprc:  0.9070273066984824
EarlyStopping counter: 6 out of 50
epoch:  28
epoch:  29 val_f1:  0.6825214527173443 val_auroc:  0.8026509572901325 val_auprc:  0.9103504582577385
Validation loss improved to 1.046914
epoch:  29
epoch:  30 val_f1:  0.7583800901862243 val_auroc:  0.7950417280314188 val_auprc:  0.9061274993244651
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7681512331200245 val_auroc:  0.7950417280314188 val_auprc:  0.9064825317918069
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.6590199752078746 val_auroc:  0.8090328915071183 val_auprc:  0.9155653214318055
EarlyStopping counter: 3 out of 50
epoch:  32
epoch:  33 val_f1:  0.7156947373800909 val_auroc:  0.8031418753068239 val_auprc:  0.9111496059560125
EarlyStopping counter: 4 out of 50
epoch:  33
epoch:  34 val_f1:  0.7681512331200245 val_auroc:  0.7952871870397644 val_auprc:  0.9062210692309296
EarlyStopping counter: 5 out of 50
epoch:  34
epoch:  35 val_f1:  0.675544391518161 val_auroc:  0.8080510554737359 val_auprc:  0.9134047971405539
Validation loss improved to 1.043194
epoch:  35
epoch:  36 val_f1:  0.7697841726618705 val_auroc:  0.7972508591065292 val_auprc:  0.9065212789902194
EarlyStopping counter: 1 out of 50
epoch:  36
epoch:  37 val_f1:  0.7223183251151889 val_auroc:  0.8058419243986255 val_auprc:  0.9122764956922005
EarlyStopping counter: 2 out of 50
epoch:  37
epoch:  38 val_f1:  0.7223183251151889 val_auroc:  0.8028964162984782 val_auprc:  0.9104631314089771
EarlyStopping counter: 3 out of 50
epoch:  38
epoch:  39 val_f1:  0.7223183251151889 val_auroc:  0.8068237604320079 val_auprc:  0.9135004576637064
EarlyStopping counter: 4 out of 50
epoch:  39
epoch:  40 val_f1:  0.7552115339652351 val_auroc:  0.8051055473735886 val_auprc:  0.9119141785813853
EarlyStopping counter: 5 out of 50
epoch:  40
epoch:  41 val_f1:  0.7289242247644242 val_auroc:  0.8092783505154639 val_auprc:  0.9150714037336019
EarlyStopping counter: 6 out of 50
epoch:  41
epoch:  42 val_f1:  0.7295632867761842 val_auroc:  0.8095238095238095 val_auprc:  0.9152192291355592
EarlyStopping counter: 7 out of 50
epoch:  42
epoch:  43 val_f1:  0.7420910227448273 val_auroc:  0.8102601865488464 val_auprc:  0.9156649343586777
EarlyStopping counter: 8 out of 50
epoch:  43
epoch:  44 val_f1:  0.7725930260576229 val_auroc:  0.8053510063819341 val_auprc:  0.9123878898567392
EarlyStopping counter: 9 out of 50
epoch:  44
epoch:  45 val_f1:  0.7295632867761842 val_auroc:  0.8127147766323024 val_auprc:  0.916888932940239
EarlyStopping counter: 10 out of 50
epoch:  45
epoch:  46 val_f1:  0.7362024088594293 val_auroc:  0.8114874815905744 val_auprc:  0.9164136971560803
EarlyStopping counter: 11 out of 50
epoch:  46
epoch:  47 val_f1:  0.6960581600537912 val_auroc:  0.8151693667157585 val_auprc:  0.918659210876642
EarlyStopping counter: 12 out of 50
epoch:  47
epoch:  48 val_f1:  0.7028070029525513 val_auroc:  0.816151202749141 val_auprc:  0.9184069997040348
EarlyStopping counter: 13 out of 50
epoch:  48
epoch:  49 val_f1:  0.7531731915989216 val_auroc:  0.8082965144820815 val_auprc:  0.9138853999921341
EarlyStopping counter: 14 out of 50
epoch:  49
epoch:  50 val_f1:  0.7633714058926586 val_auroc:  0.8073146784486992 val_auprc:  0.9134504691202667
EarlyStopping counter: 15 out of 50
epoch:  50
epoch:  51 val_f1:  0.7428255465713769 val_auroc:  0.8173784977908689 val_auprc:  0.9199458325108849
EarlyStopping counter: 16 out of 50
epoch:  51
epoch:  52 val_f1:  0.748656020238754 val_auroc:  0.8159057437407953 val_auprc:  0.9189003288241077
EarlyStopping counter: 17 out of 50
epoch:  52
epoch:  53 val_f1:  0.7402181480621955 val_auroc:  0.814187530682376 val_auprc:  0.9176575664374135
EarlyStopping counter: 18 out of 50
epoch:  53
epoch:  54 val_f1:  0.7633714058926586 val_auroc:  0.8080510554737359 val_auprc:  0.9135584521974206
EarlyStopping counter: 19 out of 50
epoch:  54
epoch:  55 val_f1:  0.7553956834532374 val_auroc:  0.8043691703485517 val_auprc:  0.9113560730770801
EarlyStopping counter: 20 out of 50
epoch:  55
epoch:  56 val_f1:  0.7402181480621955 val_auroc:  0.814187530682376 val_auprc:  0.9180008314621326
EarlyStopping counter: 21 out of 50
epoch:  56
epoch:  57 val_f1:  0.7552115339652351 val_auroc:  0.8159057437407953 val_auprc:  0.9195638853443562
EarlyStopping counter: 22 out of 50
epoch:  57
epoch:  58 val_f1:  0.7500864926036699 val_auroc:  0.819833087874325 val_auprc:  0.9217631568365229
EarlyStopping counter: 23 out of 50
epoch:  58
epoch:  59 val_f1:  0.7477455593342162 val_auroc:  0.8136966126656848 val_auprc:  0.9169064895088278
EarlyStopping counter: 24 out of 50
epoch:  59
epoch:  60 val_f1:  0.7596459003010357 val_auroc:  0.8124693176239568 val_auprc:  0.9163165260601254
EarlyStopping counter: 25 out of 50
epoch:  60
epoch:  61 val_f1:  0.7402181480621955 val_auroc:  0.8176239567992145 val_auprc:  0.920410123709174
EarlyStopping counter: 26 out of 50
epoch:  61
epoch:  62 val_f1:  0.7466980132583976 val_auroc:  0.8149239077074129 val_auprc:  0.9189848115597218
EarlyStopping counter: 27 out of 50
epoch:  62
epoch:  63 val_f1:  0.7386752666832053 val_auroc:  0.8055964653902798 val_auprc:  0.9104661933900684
EarlyStopping counter: 28 out of 50
epoch:  63
epoch:  64 val_f1:  0.7477455593342162 val_auroc:  0.8188512518409424 val_auprc:  0.9205600083355834
EarlyStopping counter: 29 out of 50
epoch:  64
epoch:  65 val_f1:  0.7573003855683703 val_auroc:  0.821060382916053 val_auprc:  0.9225821430204593
EarlyStopping counter: 30 out of 50
epoch:  65
epoch:  66 val_f1:  0.7466980132583976 val_auroc:  0.8149239077074129 val_auprc:  0.9189885548406665
EarlyStopping counter: 31 out of 50
epoch:  66
epoch:  67 val_f1:  0.7402181480621955 val_auroc:  0.8119783996072656 val_auprc:  0.9159007288958535
EarlyStopping counter: 32 out of 50
epoch:  67
epoch:  68 val_f1:  0.7633714058926586 val_auroc:  0.8087874324987727 val_auprc:  0.9126850324184808
EarlyStopping counter: 33 out of 50
epoch:  68
epoch:  69 val_f1:  0.7402181480621955 val_auroc:  0.8178694158075601 val_auprc:  0.9206394928090506
EarlyStopping counter: 34 out of 50
epoch:  69
epoch:  70 val_f1:  0.7477455593342162 val_auroc:  0.8188512518409425 val_auprc:  0.9212386628696646
EarlyStopping counter: 35 out of 50
epoch:  70
epoch:  71 val_f1:  0.7596459003010357 val_auroc:  0.8163966617574865 val_auprc:  0.9198145610542761
EarlyStopping counter: 36 out of 50
epoch:  71
epoch:  72 val_f1:  0.7531731915989216 val_auroc:  0.8173784977908689 val_auprc:  0.9197390579365549
EarlyStopping counter: 37 out of 50
epoch:  72
epoch:  73 val_f1:  0.7531731915989216 val_auroc:  0.8156602847324498 val_auprc:  0.9189859599481366
EarlyStopping counter: 38 out of 50
epoch:  73
epoch:  74 val_f1:  0.7466980132583976 val_auroc:  0.8171330387825234 val_auprc:  0.9203384946346385
EarlyStopping counter: 39 out of 50
epoch:  74
epoch:  75 val_f1:  0.7531731915989216 val_auroc:  0.8163966617574866 val_auprc:  0.919683691336216
EarlyStopping counter: 40 out of 50
epoch:  75
epoch:  76 val_f1:  0.7596459003010357 val_auroc:  0.8136966126656848 val_auprc:  0.9179684482919601
EarlyStopping counter: 41 out of 50
epoch:  76
epoch:  77 val_f1:  0.7410071942446043 val_auroc:  0.8095238095238095 val_auprc:  0.9157543865309219
EarlyStopping counter: 42 out of 50
epoch:  77
epoch:  78 val_f1:  0.7617596949267598 val_auroc:  0.8183603338242514 val_auprc:  0.9230491618222461
EarlyStopping counter: 43 out of 50
epoch:  78
epoch:  79 val_f1:  0.7772753225990636 val_auroc:  0.8203240058910163 val_auprc:  0.9234138815722404
EarlyStopping counter: 44 out of 50
epoch:  79
epoch:  80 val_f1:  0.7466980132583976 val_auroc:  0.8139420716740304 val_auprc:  0.9186832717242149
EarlyStopping counter: 45 out of 50
epoch:  80
epoch:  81 val_f1:  0.7661184054361647 val_auroc:  0.8144329896907216 val_auprc:  0.9195458572082037
EarlyStopping counter: 46 out of 50
epoch:  81
epoch:  82 val_f1:  0.7596459003010357 val_auroc:  0.8161512027491409 val_auprc:  0.919907040875141
EarlyStopping counter: 47 out of 50
epoch:  82
epoch:  83 val_f1:  0.7542604103291037 val_auroc:  0.8188512518409427 val_auprc:  0.9213976651543738
EarlyStopping counter: 48 out of 50
epoch:  83
epoch:  84 val_f1:  0.7596459003010357 val_auroc:  0.8154148257241042 val_auprc:  0.919174663528928
EarlyStopping counter: 49 out of 50
epoch:  84
epoch:  85 val_f1:  0.7505653177403916 val_auroc:  0.81173294059892 val_auprc:  0.9170116811389445
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  80.52996587753296
{'time_elapsed': [80.52996587753296], 'epoch': [84], 'fold': [0], 'f1_train': [0.9963963963963964], 'auroc_train': [0.9999693411411228], 'auprc_train': [0.9999866287592856], 'f1_test': [0.7505653177403916], 'auroc_test': [0.81173294059892], 'auprc_test': [0.9170116811389445]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 183]            4,096
│    └─BatchNorm1d: 2-2                  [64, 512, 183]            1,024
│    └─Tanh: 2-3                         [64, 512, 183]            --
│    └─MaxPool1d: 2-4                    [64, 512, 26]             --
│    └─Dropout: 2-5                      [64, 512, 26]             --
│    └─Flatten: 2-6                      [64, 13312]               --
│    └─Linear: 2-7                       [64, 1]                   13,313
==========================================================================================
Total params: 18,433
Trainable params: 18,433
Non-trainable params: 0
Total mult-adds (M): 48.89
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 95.95
Params size (MB): 0.07
Estimated Total Size (MB): 96.35
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.2126277587555624 val_auroc:  0.6701030927835051 val_auprc:  0.8560741766169967
epoch:  1
epoch:  2 val_f1:  0.5994295090243594 val_auroc:  0.7007854688267059 val_auprc:  0.8726789589682291
Validation loss improved to 1.145659
epoch:  2
epoch:  3 val_f1:  0.6135802455273177 val_auroc:  0.700785468826706 val_auprc:  0.8751877021294894
Validation loss improved to 1.141160
epoch:  3
epoch:  4 val_f1:  0.672385893756943 val_auroc:  0.7140402552773687 val_auprc:  0.877500207354601
Validation loss improved to 1.106593
epoch:  4
epoch:  5 val_f1:  0.6472345296242701 val_auroc:  0.7260677466863035 val_auprc:  0.8861610837579699
Validation loss improved to 1.103949
epoch:  5
epoch:  6 val_f1:  0.7015283467006299 val_auroc:  0.7380952380952381 val_auprc:  0.8890381945573254
Validation loss improved to 1.074980
epoch:  6
epoch:  7 val_f1:  0.642965963048511 val_auroc:  0.7501227295041728 val_auprc:  0.8984213080350362
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.693339873555701 val_auroc:  0.7616593028964164 val_auprc:  0.9000729208023788
Validation loss improved to 1.051710
epoch:  8
epoch:  9 val_f1:  0.72389147505525 val_auroc:  0.770004909180167 val_auprc:  0.9058455177307689
Validation loss improved to 1.044066
epoch:  9
epoch:  10 val_f1:  0.7377728985642654 val_auroc:  0.7719685812469318 val_auprc:  0.9062489427311173
Validation loss improved to 1.036673
epoch:  10
epoch:  11 val_f1:  0.7299542184434271 val_auroc:  0.784977908689249 val_auprc:  0.9088817023721473
Validation loss improved to 1.015808
epoch:  11
epoch:  12 val_f1:  0.6941977313483386 val_auroc:  0.783014236622484 val_auprc:  0.9103387132592524
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7412236216203913 val_auroc:  0.7938144329896907 val_auprc:  0.9112968938069022
Validation loss improved to 0.996384
epoch:  13
epoch:  14 val_f1:  0.7420910227448273 val_auroc:  0.8009327442317133 val_auprc:  0.9137384272255393
Validation loss improved to 0.986997
epoch:  14
epoch:  15 val_f1:  0.7092686867455189 val_auroc:  0.7928325969563084 val_auprc:  0.9122951044057735
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7346891520614657 val_auroc:  0.8070692194403535 val_auprc:  0.9147642010058522
Validation loss improved to 0.976283
epoch:  16
epoch:  17 val_f1:  0.7505653177403916 val_auroc:  0.8073146784486991 val_auprc:  0.9134121014283786
Validation loss improved to 0.971658
epoch:  17
epoch:  18 val_f1:  0.7446689355102744 val_auroc:  0.8038782523318606 val_auprc:  0.9148331388088253
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7441671543148256 val_auroc:  0.8075601374570447 val_auprc:  0.9145581930843352
Validation loss improved to 0.959536
epoch:  19
epoch:  20 val_f1:  0.7326256806616418 val_auroc:  0.8095238095238095 val_auprc:  0.9158912263766138
Validation loss improved to 0.953286
epoch:  20
epoch:  21 val_f1:  0.7786895152313162 val_auroc:  0.8092783505154639 val_auprc:  0.9163995910590303
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7426698176342648 val_auroc:  0.8095238095238095 val_auprc:  0.9150159022490205
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.7651358509506568 val_auroc:  0.8097692685321551 val_auprc:  0.9170555035884439
EarlyStopping counter: 3 out of 50
epoch:  23
epoch:  24 val_f1:  0.778324933635979 val_auroc:  0.810505645557192 val_auprc:  0.9157458155448601
Validation loss improved to 0.945820
epoch:  24
epoch:  25 val_f1:  0.7144317414801258 val_auroc:  0.8119783996072655 val_auprc:  0.906121721562088
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.7651358509506568 val_auroc:  0.8136966126656849 val_auprc:  0.9184383935953532
EarlyStopping counter: 2 out of 50
epoch:  26
epoch:  27 val_f1:  0.7402181480621955 val_auroc:  0.8156602847324497 val_auprc:  0.9173116067754272
Validation loss improved to 0.939015
epoch:  27
epoch:  28 val_f1:  0.7455074238481555 val_auroc:  0.8178694158075601 val_auprc:  0.9175585077767514
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.770628190185282 val_auroc:  0.8183603338242513 val_auprc:  0.9184356573544296
Validation loss improved to 0.931646
epoch:  29
epoch:  30 val_f1:  0.7633550302615051 val_auroc:  0.8195876288659794 val_auprc:  0.919407142762674
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7617596949267598 val_auroc:  0.8176239567992146 val_auprc:  0.9177159262225987
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.7633550302615051 val_auroc:  0.8171330387825233 val_auprc:  0.9165741115968697
EarlyStopping counter: 3 out of 50
epoch:  32
epoch:  33 val_f1:  0.7639705763479104 val_auroc:  0.8168875797741777 val_auprc:  0.9181132478021148
EarlyStopping counter: 4 out of 50
epoch:  33
epoch:  34 val_f1:  0.7672775806504117 val_auroc:  0.814187530682376 val_auprc:  0.91129330731109
EarlyStopping counter: 5 out of 50
epoch:  34
epoch:  35 val_f1:  0.7617596949267598 val_auroc:  0.8173784977908689 val_auprc:  0.9153007325117553
EarlyStopping counter: 6 out of 50
epoch:  35
epoch:  36 val_f1:  0.7813819697019021 val_auroc:  0.8156602847324497 val_auprc:  0.9118839992682028
EarlyStopping counter: 7 out of 50
epoch:  36
epoch:  37 val_f1:  0.7633550302615051 val_auroc:  0.8193421698576338 val_auprc:  0.917560550752565
EarlyStopping counter: 8 out of 50
epoch:  37
epoch:  38 val_f1:  0.7748426784519089 val_auroc:  0.8168875797741777 val_auprc:  0.9146419456382877
EarlyStopping counter: 9 out of 50
epoch:  38
epoch:  39 val_f1:  0.7691994463100789 val_auroc:  0.8195876288659794 val_auprc:  0.9169557984066703
EarlyStopping counter: 10 out of 50
epoch:  39
epoch:  40 val_f1:  0.7559325673789327 val_auroc:  0.8139420716740304 val_auprc:  0.907404498449295
EarlyStopping counter: 11 out of 50
epoch:  40
epoch:  41 val_f1:  0.7626195746699344 val_auroc:  0.8181148748159057 val_auprc:  0.9158695253234899
EarlyStopping counter: 12 out of 50
epoch:  41
epoch:  42 val_f1:  0.7691994463100789 val_auroc:  0.8166421207658321 val_auprc:  0.9133303277439132
EarlyStopping counter: 13 out of 50
epoch:  42
epoch:  43 val_f1:  0.7560320485424044 val_auroc:  0.8178694158075601 val_auprc:  0.91549220704971
EarlyStopping counter: 14 out of 50
epoch:  43
epoch:  44 val_f1:  0.7304528631430115 val_auroc:  0.8154148257241041 val_auprc:  0.9146750597199067
EarlyStopping counter: 15 out of 50
epoch:  44
epoch:  45 val_f1:  0.7748796193569787 val_auroc:  0.8109965635738832 val_auprc:  0.904946134217359
EarlyStopping counter: 16 out of 50
epoch:  45
epoch:  46 val_f1:  0.7553956834532374 val_auroc:  0.8134511536573392 val_auprc:  0.9080854986751342
EarlyStopping counter: 17 out of 50
epoch:  46
epoch:  47 val_f1:  0.7648187281552264 val_auroc:  0.8159057437407953 val_auprc:  0.9109110788829669
EarlyStopping counter: 18 out of 50
epoch:  47
epoch:  48 val_f1:  0.7745465218349855 val_auroc:  0.8136966126656848 val_auprc:  0.9055522876142923
EarlyStopping counter: 19 out of 50
epoch:  48
epoch:  49 val_f1:  0.7777125328082551 val_auroc:  0.8144329896907216 val_auprc:  0.9077861717776974
EarlyStopping counter: 20 out of 50
epoch:  49
epoch:  50 val_f1:  0.7617596949267598 val_auroc:  0.8154148257241042 val_auprc:  0.9112003063282115
EarlyStopping counter: 21 out of 50
epoch:  50
epoch:  51 val_f1:  0.7725930260576229 val_auroc:  0.8127147766323025 val_auprc:  0.9081229258881701
EarlyStopping counter: 22 out of 50
epoch:  51
epoch:  52 val_f1:  0.7725930260576229 val_auroc:  0.8136966126656848 val_auprc:  0.908167873836405
EarlyStopping counter: 23 out of 50
epoch:  52
epoch:  53 val_f1:  0.7420910227448273 val_auroc:  0.8132056946489936 val_auprc:  0.9096618209131107
EarlyStopping counter: 24 out of 50
epoch:  53
epoch:  54 val_f1:  0.7791090204759269 val_auroc:  0.8095238095238095 val_auprc:  0.9035009516657504
EarlyStopping counter: 25 out of 50
epoch:  54
epoch:  55 val_f1:  0.7873856121514594 val_auroc:  0.8109965635738832 val_auprc:  0.9046351144243084
EarlyStopping counter: 26 out of 50
epoch:  55
epoch:  56 val_f1:  0.7156947373800909 val_auroc:  0.8080510554737359 val_auprc:  0.9078750647262592
EarlyStopping counter: 27 out of 50
epoch:  56
epoch:  57 val_f1:  0.7633714058926586 val_auroc:  0.8090328915071183 val_auprc:  0.9069937277744597
EarlyStopping counter: 28 out of 50
epoch:  57
epoch:  58 val_f1:  0.7745465218349855 val_auroc:  0.8068237604320079 val_auprc:  0.9054925781200719
EarlyStopping counter: 29 out of 50
epoch:  58
epoch:  59 val_f1:  0.7809570525397864 val_auroc:  0.8065783014236623 val_auprc:  0.9038151657656857
EarlyStopping counter: 30 out of 50
epoch:  59
epoch:  60 val_f1:  0.7648187281552264 val_auroc:  0.8070692194403535 val_auprc:  0.9046139409414893
EarlyStopping counter: 31 out of 50
epoch:  60
epoch:  61 val_f1:  0.7855164986057286 val_auroc:  0.801178203240059 val_auprc:  0.8956776696959131
EarlyStopping counter: 32 out of 50
epoch:  61
epoch:  62 val_f1:  0.7791090204759269 val_auroc:  0.8014236622484046 val_auprc:  0.8979453380933482
EarlyStopping counter: 33 out of 50
epoch:  62
epoch:  63 val_f1:  0.7920536597238516 val_auroc:  0.8068237604320078 val_auprc:  0.9021382914229545
EarlyStopping counter: 34 out of 50
epoch:  63
epoch:  64 val_f1:  0.7855164986057286 val_auroc:  0.8078055964653903 val_auprc:  0.8981549229123882
EarlyStopping counter: 35 out of 50
epoch:  64
epoch:  65 val_f1:  0.7868059619290214 val_auroc:  0.8070692194403534 val_auprc:  0.9032378071474434
EarlyStopping counter: 36 out of 50
epoch:  65
epoch:  66 val_f1:  0.7809570525397864 val_auroc:  0.8028964162984781 val_auprc:  0.9011186423941349
EarlyStopping counter: 37 out of 50
epoch:  66
epoch:  67 val_f1:  0.7873856121514594 val_auroc:  0.8055964653902797 val_auprc:  0.8984065457106876
EarlyStopping counter: 38 out of 50
epoch:  67
epoch:  68 val_f1:  0.7683026725960121 val_auroc:  0.8048600883652431 val_auprc:  0.9018138069958586
EarlyStopping counter: 39 out of 50
epoch:  68
epoch:  69 val_f1:  0.7919479944965341 val_auroc:  0.8033873343151694 val_auprc:  0.8963156758954521
EarlyStopping counter: 40 out of 50
epoch:  69
epoch:  70 val_f1:  0.7359369647139431 val_auroc:  0.8001963672066764 val_auprc:  0.8778336007064087
EarlyStopping counter: 41 out of 50
epoch:  70
epoch:  71 val_f1:  0.7745465218349855 val_auroc:  0.8038782523318606 val_auprc:  0.8945500018109449
EarlyStopping counter: 42 out of 50
epoch:  71
epoch:  72 val_f1:  0.7672775806504117 val_auroc:  0.8026509572901326 val_auprc:  0.8992117479017421
EarlyStopping counter: 43 out of 50
epoch:  72
epoch:  73 val_f1:  0.7834737923946559 val_auroc:  0.8026509572901326 val_auprc:  0.8961008948104587
EarlyStopping counter: 44 out of 50
epoch:  73
epoch:  74 val_f1:  0.7545102379634754 val_auroc:  0.801178203240059 val_auprc:  0.8884147240932676
EarlyStopping counter: 45 out of 50
epoch:  74
epoch:  75 val_f1:  0.7906450372602754 val_auroc:  0.8031418753068238 val_auprc:  0.898230373035416
EarlyStopping counter: 46 out of 50
epoch:  75
epoch:  76 val_f1:  0.7971323289800215 val_auroc:  0.803632793323515 val_auprc:  0.897647393342806
EarlyStopping counter: 47 out of 50
epoch:  76
epoch:  77 val_f1:  0.7919479944965341 val_auroc:  0.801178203240059 val_auprc:  0.8935485623962964
EarlyStopping counter: 48 out of 50
epoch:  77
epoch:  78 val_f1:  0.7809570525397864 val_auroc:  0.8019145802650958 val_auprc:  0.8972642916223764
EarlyStopping counter: 49 out of 50
epoch:  78
epoch:  79 val_f1:  0.7834737923946559 val_auroc:  0.8001963672066765 val_auprc:  0.8933319059716172
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  70.96917271614075
{'time_elapsed': [70.96917271614075], 'epoch': [78], 'fold': [1], 'f1_train': [0.9964023152258445], 'auroc_train': [0.9998926939939295], 'auprc_train': [0.9999533379749308], 'f1_test': [0.7834737923946559], 'auroc_test': [0.8001963672066765], 'auprc_test': [0.8933319059716172]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 183]            4,096
│    └─BatchNorm1d: 2-2                  [64, 512, 183]            1,024
│    └─Tanh: 2-3                         [64, 512, 183]            --
│    └─MaxPool1d: 2-4                    [64, 512, 26]             --
│    └─Dropout: 2-5                      [64, 512, 26]             --
│    └─Flatten: 2-6                      [64, 13312]               --
│    └─Linear: 2-7                       [64, 1]                   13,313
==========================================================================================
Total params: 18,433
Trainable params: 18,433
Non-trainable params: 0
Total mult-adds (M): 48.89
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 95.95
Params size (MB): 0.07
Estimated Total Size (MB): 96.35
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5324523440071472 val_auroc:  0.6077565046637211 val_auprc:  0.8075280846351953
epoch:  1
epoch:  2 val_f1:  0.6496466101864115 val_auroc:  0.6494845360824743 val_auprc:  0.7931832162686547
Validation loss improved to 1.150370
epoch:  2
epoch:  3 val_f1:  0.43781013151620857 val_auroc:  0.6728031418753069 val_auprc:  0.818717489577574
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.7157412825720284 val_auroc:  0.6848306332842415 val_auprc:  0.8282178227662241
Validation loss improved to 1.122813
epoch:  4
epoch:  5 val_f1:  0.4581056958944123 val_auroc:  0.7140402552773686 val_auprc:  0.8591114372127517
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.6788382480828524 val_auroc:  0.7324496809032892 val_auprc:  0.8723422928064836
Validation loss improved to 1.096938
epoch:  6
epoch:  7 val_f1:  0.6754718212640907 val_auroc:  0.7434953362788415 val_auprc:  0.8804984887833549
Validation loss improved to 1.091145
epoch:  7
epoch:  8 val_f1:  0.6891084624964738 val_auroc:  0.7361315660284733 val_auprc:  0.8773296339097842
Validation loss improved to 1.088334
epoch:  8
epoch:  9 val_f1:  0.6825214527173443 val_auroc:  0.7366224840451645 val_auprc:  0.8781901962453205
Validation loss improved to 1.077673
epoch:  9
epoch:  10 val_f1:  0.6894622188638474 val_auroc:  0.7420225822287677 val_auprc:  0.8801862124030726
Validation loss improved to 1.070209
epoch:  10
epoch:  11 val_f1:  0.6967556353929608 val_auroc:  0.7486499754540992 val_auprc:  0.8826598057984314
Validation loss improved to 1.059864
epoch:  11
epoch:  12 val_f1:  0.6887363496684735 val_auroc:  0.7476681394207166 val_auprc:  0.8813260873870415
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7156947373800909 val_auroc:  0.751840942562592 val_auprc:  0.8839024844287375
Validation loss improved to 1.049331
epoch:  13
epoch:  14 val_f1:  0.7304528631430115 val_auroc:  0.7498772704958272 val_auprc:  0.8817055422033782
Validation loss improved to 1.048333
epoch:  14
epoch:  15 val_f1:  0.7236892364125374 val_auroc:  0.7479135984290624 val_auprc:  0.8791010822738261
Validation loss improved to 1.046361
epoch:  15
epoch:  16 val_f1:  0.6682010713268466 val_auroc:  0.7474226804123713 val_auprc:  0.8785200998792771
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7108600244444511 val_auroc:  0.7555228276877761 val_auprc:  0.8819954833421508
Validation loss improved to 1.033904
epoch:  17
epoch:  18 val_f1:  0.6610684696390046 val_auroc:  0.7515954835542464 val_auprc:  0.8786596251383334
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.6963248678165901 val_auroc:  0.7540500736377025 val_auprc:  0.8801785565723244
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7235944791518311 val_auroc:  0.7606774668630338 val_auprc:  0.8837487166766327
Validation loss improved to 1.023434
epoch:  20
epoch:  21 val_f1:  0.6682010713268466 val_auroc:  0.7538046146293569 val_auprc:  0.8778356543891691
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.642965963048511 val_auroc:  0.7547864506627393 val_auprc:  0.87716469902677
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.7337314237416728 val_auroc:  0.7614138438880707 val_auprc:  0.8802254428278727
EarlyStopping counter: 3 out of 50
epoch:  23
epoch:  24 val_f1:  0.735514445586388 val_auroc:  0.7582228767795778 val_auprc:  0.8784142591390589
EarlyStopping counter: 4 out of 50
epoch:  24
epoch:  25 val_f1:  0.7299542184434271 val_auroc:  0.759941089837997 val_auprc:  0.8795949678825572
EarlyStopping counter: 5 out of 50
epoch:  25
epoch:  26 val_f1:  0.6752910608296504 val_auroc:  0.7535591556210113 val_auprc:  0.875712944902633
EarlyStopping counter: 6 out of 50
epoch:  26
epoch:  27 val_f1:  0.6872943776026332 val_auroc:  0.7673048600883652 val_auprc:  0.8817208840771498
EarlyStopping counter: 7 out of 50
epoch:  27
epoch:  28 val_f1:  0.6963686193902022 val_auroc:  0.7550319096710849 val_auprc:  0.875546331195501
EarlyStopping counter: 8 out of 50
epoch:  28
epoch:  29 val_f1:  0.675544391518161 val_auroc:  0.7523318605792833 val_auprc:  0.8745066606230196
EarlyStopping counter: 9 out of 50
epoch:  29
epoch:  30 val_f1:  0.7140703059967902 val_auroc:  0.7628865979381443 val_auprc:  0.8792757102527273
EarlyStopping counter: 10 out of 50
epoch:  30
epoch:  31 val_f1:  0.7166299330477814 val_auroc:  0.7545409916543937 val_auprc:  0.8756358519616549
EarlyStopping counter: 11 out of 50
epoch:  31
epoch:  32 val_f1:  0.7272357092755477 val_auroc:  0.7589592538046146 val_auprc:  0.8782402959440472
EarlyStopping counter: 12 out of 50
epoch:  32
epoch:  33 val_f1:  0.7140703059967902 val_auroc:  0.758713794796269 val_auprc:  0.876669275703076
EarlyStopping counter: 13 out of 50
epoch:  33
epoch:  34 val_f1:  0.7090514753972222 val_auroc:  0.7540500736377025 val_auprc:  0.8736627399595579
EarlyStopping counter: 14 out of 50
epoch:  34
epoch:  35 val_f1:  0.7185533480648861 val_auroc:  0.7569955817378499 val_auprc:  0.8752645081054085
EarlyStopping counter: 15 out of 50
epoch:  35
epoch:  36 val_f1:  0.7090514753972222 val_auroc:  0.7542955326460481 val_auprc:  0.8724815148457759
EarlyStopping counter: 16 out of 50
epoch:  36
epoch:  37 val_f1:  0.7078050864958872 val_auroc:  0.7589592538046146 val_auprc:  0.8762465527594911
EarlyStopping counter: 17 out of 50
epoch:  37
epoch:  38 val_f1:  0.7184536707983012 val_auroc:  0.7582228767795778 val_auprc:  0.8749194640771655
EarlyStopping counter: 18 out of 50
epoch:  38
epoch:  39 val_f1:  0.7028070029525513 val_auroc:  0.7508591065292095 val_auprc:  0.8696125752557102
EarlyStopping counter: 19 out of 50
epoch:  39
epoch:  40 val_f1:  0.7140775751491829 val_auroc:  0.7569955817378498 val_auprc:  0.873218043655647
EarlyStopping counter: 20 out of 50
epoch:  40
epoch:  41 val_f1:  0.7309103647707891 val_auroc:  0.759941089837997 val_auprc:  0.8763970247924567
EarlyStopping counter: 21 out of 50
epoch:  41
epoch:  42 val_f1:  0.7185533480648861 val_auroc:  0.7560137457044673 val_auprc:  0.8722465532201543
EarlyStopping counter: 22 out of 50
epoch:  42
epoch:  43 val_f1:  0.7140775751491829 val_auroc:  0.7545409916543937 val_auprc:  0.8711527895022529
EarlyStopping counter: 23 out of 50
epoch:  43
epoch:  44 val_f1:  0.7150229029574715 val_auroc:  0.7530682376043201 val_auprc:  0.8695717344920386
EarlyStopping counter: 24 out of 50
epoch:  44
epoch:  45 val_f1:  0.7391701372600277 val_auroc:  0.7567501227295043 val_auprc:  0.8710010630409936
EarlyStopping counter: 25 out of 50
epoch:  45
epoch:  46 val_f1:  0.7391701372600277 val_auroc:  0.7579774177712323 val_auprc:  0.8713286678819204
EarlyStopping counter: 26 out of 50
epoch:  46
epoch:  47 val_f1:  0.7156947373800909 val_auroc:  0.7496318114874817 val_auprc:  0.8657652817485985
EarlyStopping counter: 27 out of 50
epoch:  47
epoch:  48 val_f1:  0.706765356945213 val_auroc:  0.7540500736377025 val_auprc:  0.8700486436098847
EarlyStopping counter: 28 out of 50
epoch:  48
epoch:  49 val_f1:  0.713247796930704 val_auroc:  0.7569955817378498 val_auprc:  0.873860474779194
EarlyStopping counter: 29 out of 50
epoch:  49
epoch:  50 val_f1:  0.7391701372600277 val_auroc:  0.7567501227295041 val_auprc:  0.8690728944061097
EarlyStopping counter: 30 out of 50
epoch:  50
epoch:  51 val_f1:  0.7237424247793883 val_auroc:  0.7569955817378498 val_auprc:  0.8670071353493825
EarlyStopping counter: 31 out of 50
epoch:  51
epoch:  52 val_f1:  0.7157412825720284 val_auroc:  0.7520864015709376 val_auprc:  0.8653531068612745
EarlyStopping counter: 32 out of 50
epoch:  52
epoch:  53 val_f1:  0.7157412825720284 val_auroc:  0.7535591556210113 val_auprc:  0.8664263007531947
EarlyStopping counter: 33 out of 50
epoch:  53
epoch:  54 val_f1:  0.7328919440906961 val_auroc:  0.7533136966126658 val_auprc:  0.8652145000664668
EarlyStopping counter: 34 out of 50
epoch:  54
epoch:  55 val_f1:  0.7176437068167247 val_auroc:  0.7528227785959745 val_auprc:  0.8645840355193192
EarlyStopping counter: 35 out of 50
epoch:  55
epoch:  56 val_f1:  0.7283736963917239 val_auroc:  0.7567501227295041 val_auprc:  0.8667457909303924
EarlyStopping counter: 36 out of 50
epoch:  56
epoch:  57 val_f1:  0.7391701372600277 val_auroc:  0.7538046146293569 val_auprc:  0.8653560647914367
EarlyStopping counter: 37 out of 50
epoch:  57
epoch:  58 val_f1:  0.7121336235283787 val_auroc:  0.7523318605792833 val_auprc:  0.8654316467108223
EarlyStopping counter: 38 out of 50
epoch:  58
epoch:  59 val_f1:  0.7208993647046947 val_auroc:  0.7542955326460481 val_auprc:  0.8653358829542812
EarlyStopping counter: 39 out of 50
epoch:  59
epoch:  60 val_f1:  0.7263486361521366 val_auroc:  0.7555228276877761 val_auprc:  0.8662593326322587
EarlyStopping counter: 40 out of 50
epoch:  60
epoch:  61 val_f1:  0.7079427367197151 val_auroc:  0.7515954835542464 val_auprc:  0.86450925576721
EarlyStopping counter: 41 out of 50
epoch:  61
epoch:  62 val_f1:  0.7121336235283787 val_auroc:  0.7486499754540992 val_auprc:  0.8629352460721629
EarlyStopping counter: 42 out of 50
epoch:  62
epoch:  63 val_f1:  0.7163649790827238 val_auroc:  0.7508591065292096 val_auprc:  0.8633853865869958
EarlyStopping counter: 43 out of 50
epoch:  63
epoch:  64 val_f1:  0.7117994924448791 val_auroc:  0.7550319096710849 val_auprc:  0.8652646091036198
EarlyStopping counter: 44 out of 50
epoch:  64
epoch:  65 val_f1:  0.717230470942395 val_auroc:  0.7515954835542464 val_auprc:  0.8642090936872708
EarlyStopping counter: 45 out of 50
epoch:  65
epoch:  66 val_f1:  0.7058128438779214 val_auroc:  0.7535591556210113 val_auprc:  0.8649228283452111
EarlyStopping counter: 46 out of 50
epoch:  66
epoch:  67 val_f1:  0.7225455998837295 val_auroc:  0.7552773686794305 val_auprc:  0.8661065470645223
EarlyStopping counter: 47 out of 50
epoch:  67
epoch:  68 val_f1:  0.7349308245711123 val_auroc:  0.7523318605792833 val_auprc:  0.8644473092720287
EarlyStopping counter: 48 out of 50
epoch:  68
epoch:  69 val_f1:  0.7176437068167247 val_auroc:  0.7533136966126657 val_auprc:  0.8648032584383892
EarlyStopping counter: 49 out of 50
epoch:  69
epoch:  70 val_f1:  0.7176437068167247 val_auroc:  0.7523318605792833 val_auprc:  0.864680606243666
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  61.22965931892395
{'time_elapsed': [61.22965931892395], 'epoch': [69], 'fold': [2], 'f1_train': [0.9820959475954482], 'auroc_train': [0.9989269399392955], 'auprc_train': [0.9995500286206457], 'f1_test': [0.7176437068167247], 'auroc_test': [0.7523318605792833], 'auprc_test': [0.864680606243666]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 183]            4,096
│    └─BatchNorm1d: 2-2                  [64, 512, 183]            1,024
│    └─Tanh: 2-3                         [64, 512, 183]            --
│    └─MaxPool1d: 2-4                    [64, 512, 26]             --
│    └─Dropout: 2-5                      [64, 512, 26]             --
│    └─Flatten: 2-6                      [64, 13312]               --
│    └─Linear: 2-7                       [64, 1]                   13,313
==========================================================================================
Total params: 18,433
Trainable params: 18,433
Non-trainable params: 0
Total mult-adds (M): 48.89
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 95.95
Params size (MB): 0.07
Estimated Total Size (MB): 96.35
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.17599145173656994 val_auroc:  0.7323158914728682 val_auprc:  0.8732453308395367
epoch:  1
epoch:  2 val_f1:  0.5769379346308361 val_auroc:  0.6831395348837208 val_auprc:  0.776910932459335
Validation loss improved to 1.189241
epoch:  2
epoch:  3 val_f1:  0.5431446061046772 val_auroc:  0.7124515503875969 val_auprc:  0.7999978490745708
Validation loss improved to 1.136082
epoch:  3
epoch:  4 val_f1:  0.7127977403917272 val_auroc:  0.7209302325581396 val_auprc:  0.8084132253311844
Validation loss improved to 1.101634
epoch:  4
epoch:  5 val_f1:  0.6673557705559691 val_auroc:  0.7562984496124031 val_auprc:  0.8558196597561801
Validation loss improved to 1.076981
epoch:  5
epoch:  6 val_f1:  0.6673557705559691 val_auroc:  0.7807655038759689 val_auprc:  0.885407876602031
Validation loss improved to 1.060935
epoch:  6
epoch:  7 val_f1:  0.7365151319050068 val_auroc:  0.7945736434108527 val_auprc:  0.8988824786683639
Validation loss improved to 1.047435
epoch:  7
epoch:  8 val_f1:  0.7369410839658738 val_auroc:  0.8003875968992249 val_auprc:  0.9042997629505718
Validation loss improved to 1.032536
epoch:  8
epoch:  9 val_f1:  0.757449328289459 val_auroc:  0.8018410852713178 val_auprc:  0.9065169976780499
Validation loss improved to 1.017895
epoch:  9
epoch:  10 val_f1:  0.7571561248111338 val_auroc:  0.8013565891472869 val_auprc:  0.9077107254065608
Validation loss improved to 1.004817
epoch:  10
epoch:  11 val_f1:  0.7695564219015847 val_auroc:  0.8042635658914727 val_auprc:  0.9097539540732709
Validation loss improved to 0.994601
epoch:  11
epoch:  12 val_f1:  0.7440073473136385 val_auroc:  0.8064437984496124 val_auprc:  0.910425409982158
Validation loss improved to 0.990285
epoch:  12
epoch:  13 val_f1:  0.7695564219015847 val_auroc:  0.8088662790697674 val_auprc:  0.9135121503347614
Validation loss improved to 0.965340
epoch:  13
epoch:  14 val_f1:  0.7529139722223964 val_auroc:  0.8093507751937984 val_auprc:  0.9118432952459181
Validation loss improved to 0.958467
epoch:  14
epoch:  15 val_f1:  0.7634619577065621 val_auroc:  0.8134689922480619 val_auprc:  0.9148149933255558
Validation loss improved to 0.939890
epoch:  15
epoch:  16 val_f1:  0.71850089571744 val_auroc:  0.8105620155038759 val_auprc:  0.9109847156689195
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7567507159321089 val_auroc:  0.8166182170542636 val_auprc:  0.9171040881399939
Validation loss improved to 0.918068
epoch:  17
epoch:  18 val_f1:  0.7695564219015847 val_auroc:  0.8156492248062016 val_auprc:  0.9158491511909133
Validation loss improved to 0.909829
epoch:  18
epoch:  19 val_f1:  0.7440073473136385 val_auroc:  0.8180717054263565 val_auprc:  0.9163036921469933
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7688372056811462 val_auroc:  0.8207364341085271 val_auprc:  0.9188653551579212
Validation loss improved to 0.892102
epoch:  20
epoch:  21 val_f1:  0.7440073473136385 val_auroc:  0.8209786821705426 val_auprc:  0.9179178437567015
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7517526908132072 val_auroc:  0.820736434108527 val_auprc:  0.9188123721773707
Validation loss improved to 0.885713
epoch:  22
epoch:  23 val_f1:  0.7517526908132072 val_auroc:  0.8217054263565892 val_auprc:  0.9196211842334805
Validation loss improved to 0.879119
epoch:  23
epoch:  24 val_f1:  0.764250381178164 val_auroc:  0.8241279069767442 val_auprc:  0.9217403510249536
Validation loss improved to 0.862221
epoch:  24
epoch:  25 val_f1:  0.7517526908132072 val_auroc:  0.8238856589147288 val_auprc:  0.9211031647858879
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.7440073473136385 val_auroc:  0.8250968992248061 val_auprc:  0.922147324587493
EarlyStopping counter: 2 out of 50
epoch:  26
epoch:  27 val_f1:  0.764250381178164 val_auroc:  0.8280038759689923 val_auprc:  0.9239877050053588
Validation loss improved to 0.845703
epoch:  27
epoch:  28 val_f1:  0.7266187050359713 val_auroc:  0.8265503875968992 val_auprc:  0.9219474517805752
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.7614155928004849 val_auroc:  0.8306686046511628 val_auprc:  0.924596986150509
Validation loss improved to 0.838872
epoch:  29
epoch:  30 val_f1:  0.7455877744514305 val_auroc:  0.8289728682170543 val_auprc:  0.9230368995345895
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.767033173809688 val_auroc:  0.8345445736434108 val_auprc:  0.9276621330009194
Validation loss improved to 0.836079
epoch:  31
epoch:  32 val_f1:  0.7539369712168144 val_auroc:  0.8347868217054264 val_auprc:  0.9277889375655322
Validation loss improved to 0.819508
epoch:  32
epoch:  33 val_f1:  0.7634619577065621 val_auroc:  0.8376937984496126 val_auprc:  0.9297916203493239
Validation loss improved to 0.815232
epoch:  33
epoch:  34 val_f1:  0.7724509753899008 val_auroc:  0.8369670542635659 val_auprc:  0.928678303663351
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.751925686926815 val_auroc:  0.8379360465116278 val_auprc:  0.9285432684534728
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.7628987147360764 val_auroc:  0.8418120155038761 val_auprc:  0.9315345365663181
Validation loss improved to 0.803813
epoch:  36
epoch:  37 val_f1:  0.7614155928004849 val_auroc:  0.8420542635658915 val_auprc:  0.9314905233299283
Validation loss improved to 0.796157
epoch:  37
epoch:  38 val_f1:  0.758275274873164 val_auroc:  0.8425387596899224 val_auprc:  0.9307665352055552
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.7866727894280321 val_auroc:  0.8459302325581396 val_auprc:  0.9326109069136267
EarlyStopping counter: 2 out of 50
epoch:  39
epoch:  40 val_f1:  0.7604868926320555 val_auroc:  0.8464147286821705 val_auprc:  0.933807480258279
Validation loss improved to 0.793868
epoch:  40
epoch:  41 val_f1:  0.7706506750217025 val_auroc:  0.8444767441860465 val_auprc:  0.9340739292939492
EarlyStopping counter: 1 out of 50
epoch:  41
epoch:  42 val_f1:  0.7539369712168144 val_auroc:  0.8490794573643411 val_auprc:  0.9352060431093769
Validation loss improved to 0.783074
epoch:  42
epoch:  43 val_f1:  0.7578890782445586 val_auroc:  0.8454457364341085 val_auprc:  0.9321116341797288
EarlyStopping counter: 1 out of 50
epoch:  43
epoch:  44 val_f1:  0.7773759601944114 val_auroc:  0.8468992248062015 val_auprc:  0.9352479472207337
Validation loss improved to 0.775556
epoch:  44
epoch:  45 val_f1:  0.7773759601944114 val_auroc:  0.8485949612403101 val_auprc:  0.9367070755573144
EarlyStopping counter: 1 out of 50
epoch:  45
epoch:  46 val_f1:  0.7540304643278981 val_auroc:  0.8522286821705426 val_auprc:  0.9363631214022874
EarlyStopping counter: 2 out of 50
epoch:  46
epoch:  47 val_f1:  0.7801238118631262 val_auroc:  0.8548934108527132 val_auprc:  0.9383527597354548
EarlyStopping counter: 3 out of 50
epoch:  47
epoch:  48 val_f1:  0.767033173809688 val_auroc:  0.8565891472868218 val_auprc:  0.9392349100152332
EarlyStopping counter: 4 out of 50
epoch:  48
epoch:  49 val_f1:  0.7773759601944114 val_auroc:  0.8536821705426356 val_auprc:  0.938947958935006
EarlyStopping counter: 5 out of 50
epoch:  49
epoch:  50 val_f1:  0.7625825493451395 val_auroc:  0.8582848837209304 val_auprc:  0.9392667709426381
EarlyStopping counter: 6 out of 50
epoch:  50
epoch:  51 val_f1:  0.7932273763653603 val_auroc:  0.8594961240310078 val_auprc:  0.9413091426125286
EarlyStopping counter: 7 out of 50
epoch:  51
epoch:  52 val_f1:  0.7735780520043992 val_auroc:  0.8594961240310078 val_auprc:  0.9414977784768024
Validation loss improved to 0.763186
epoch:  52
epoch:  53 val_f1:  0.7866727894280321 val_auroc:  0.8621608527131782 val_auprc:  0.9424838825599471
EarlyStopping counter: 1 out of 50
epoch:  53
epoch:  54 val_f1:  0.7997900244397783 val_auroc:  0.8628875968992248 val_auprc:  0.9427908292847529
EarlyStopping counter: 2 out of 50
epoch:  54
epoch:  55 val_f1:  0.7892012988311853 val_auroc:  0.8640988372093023 val_auprc:  0.9432976320561548
EarlyStopping counter: 3 out of 50
epoch:  55
epoch:  56 val_f1:  0.7932273763653603 val_auroc:  0.8621608527131783 val_auprc:  0.9426649719747496
EarlyStopping counter: 4 out of 50
epoch:  56
epoch:  57 val_f1:  0.8063632502555458 val_auroc:  0.8650678294573644 val_auprc:  0.9437280308142413
EarlyStopping counter: 5 out of 50
epoch:  57
epoch:  58 val_f1:  0.7877294237541244 val_auroc:  0.8665213178294574 val_auprc:  0.9444930845559338
Validation loss improved to 0.753654
epoch:  58
epoch:  59 val_f1:  0.7866727894280321 val_auroc:  0.8655523255813954 val_auprc:  0.9438432801468898
EarlyStopping counter: 1 out of 50
epoch:  59
epoch:  60 val_f1:  0.7906801532257888 val_auroc:  0.8667635658914729 val_auprc:  0.9446579836050158
EarlyStopping counter: 2 out of 50
epoch:  60
epoch:  61 val_f1:  0.794309372388086 val_auroc:  0.8640988372093024 val_auprc:  0.9435895276421654
EarlyStopping counter: 3 out of 50
epoch:  61
epoch:  62 val_f1:  0.794309372388086 val_auroc:  0.8660368217054265 val_auprc:  0.9445122311436766
EarlyStopping counter: 4 out of 50
epoch:  62
epoch:  63 val_f1:  0.7540304643278981 val_auroc:  0.8672480620155039 val_auprc:  0.9447310574191479
EarlyStopping counter: 5 out of 50
epoch:  63
epoch:  64 val_f1:  0.7827158008497472 val_auroc:  0.8653100775193799 val_auprc:  0.9438733773435095
EarlyStopping counter: 6 out of 50
epoch:  64
epoch:  65 val_f1:  0.7820584602206068 val_auroc:  0.8636143410852714 val_auprc:  0.9436159389357106
Validation loss improved to 0.747069
epoch:  65
epoch:  66 val_f1:  0.794309372388086 val_auroc:  0.868217054263566 val_auprc:  0.945713844424559
Validation loss improved to 0.745855
epoch:  66
epoch:  67 val_f1:  0.7453578564975014 val_auroc:  0.8708817829457364 val_auprc:  0.9465015034165198
EarlyStopping counter: 1 out of 50
epoch:  67
epoch:  68 val_f1:  0.7985611510791367 val_auroc:  0.8694282945736435 val_auprc:  0.9462462895193556
EarlyStopping counter: 2 out of 50
epoch:  68
epoch:  69 val_f1:  0.794309372388086 val_auroc:  0.8650678294573643 val_auprc:  0.9442163346371886
EarlyStopping counter: 3 out of 50
epoch:  69
epoch:  70 val_f1:  0.7827158008497472 val_auroc:  0.8672480620155038 val_auprc:  0.9450031128466166
EarlyStopping counter: 4 out of 50
epoch:  70
epoch:  71 val_f1:  0.7682301875730638 val_auroc:  0.8689437984496123 val_auprc:  0.9455269537856897
EarlyStopping counter: 5 out of 50
epoch:  71
epoch:  72 val_f1:  0.7682301875730638 val_auroc:  0.8696705426356589 val_auprc:  0.9457554483707912
EarlyStopping counter: 6 out of 50
epoch:  72
epoch:  73 val_f1:  0.792019787311512 val_auroc:  0.8674903100775194 val_auprc:  0.9453896059867397
EarlyStopping counter: 7 out of 50
epoch:  73
epoch:  74 val_f1:  0.792019787311512 val_auroc:  0.8667635658914729 val_auprc:  0.9449352815381656
EarlyStopping counter: 8 out of 50
epoch:  74
epoch:  75 val_f1:  0.792019787311512 val_auroc:  0.8687015503875969 val_auprc:  0.9455669415553661
EarlyStopping counter: 9 out of 50
epoch:  75
epoch:  76 val_f1:  0.73912321974171 val_auroc:  0.8706395348837209 val_auprc:  0.9468705925514911
EarlyStopping counter: 10 out of 50
epoch:  76
epoch:  77 val_f1:  0.7841726618705036 val_auroc:  0.8703972868217055 val_auprc:  0.9461854135210804
EarlyStopping counter: 11 out of 50
epoch:  77
epoch:  78 val_f1:  0.792019787311512 val_auroc:  0.8694282945736435 val_auprc:  0.9461739129752447
EarlyStopping counter: 12 out of 50
epoch:  78
epoch:  79 val_f1:  0.7746634573712671 val_auroc:  0.8720930232558138 val_auprc:  0.947439752868466
EarlyStopping counter: 13 out of 50
epoch:  79
epoch:  80 val_f1:  0.7746634573712671 val_auroc:  0.8720930232558141 val_auprc:  0.947501202733295
EarlyStopping counter: 14 out of 50
epoch:  80
epoch:  81 val_f1:  0.7682301875730638 val_auroc:  0.8713662790697675 val_auprc:  0.9471420054887294
EarlyStopping counter: 15 out of 50
epoch:  81
epoch:  82 val_f1:  0.792019787311512 val_auroc:  0.8694282945736435 val_auprc:  0.9459096198513218
EarlyStopping counter: 16 out of 50
epoch:  82
epoch:  83 val_f1:  0.7682301875730638 val_auroc:  0.8711240310077519 val_auprc:  0.9468746663266971
EarlyStopping counter: 17 out of 50
epoch:  83
epoch:  84 val_f1:  0.7682301875730638 val_auroc:  0.872577519379845 val_auprc:  0.9477942399574019
EarlyStopping counter: 18 out of 50
epoch:  84
epoch:  85 val_f1:  0.7601256159113488 val_auroc:  0.8718507751937984 val_auprc:  0.947696845736969
EarlyStopping counter: 19 out of 50
epoch:  85
epoch:  86 val_f1:  0.776244301724119 val_auroc:  0.8711240310077518 val_auprc:  0.9471919670780606
EarlyStopping counter: 20 out of 50
epoch:  86
epoch:  87 val_f1:  0.776244301724119 val_auroc:  0.8718507751937986 val_auprc:  0.9471266158463363
EarlyStopping counter: 21 out of 50
epoch:  87
epoch:  88 val_f1:  0.7682301875730638 val_auroc:  0.871124031007752 val_auprc:  0.9468695463121858
EarlyStopping counter: 22 out of 50
epoch:  88
epoch:  89 val_f1:  0.7854893118997625 val_auroc:  0.8713662790697674 val_auprc:  0.9469428214571843
EarlyStopping counter: 23 out of 50
epoch:  89
epoch:  90 val_f1:  0.776244301724119 val_auroc:  0.8713662790697674 val_auprc:  0.9471656576884206
EarlyStopping counter: 24 out of 50
epoch:  90
epoch:  91 val_f1:  0.7682301875730638 val_auroc:  0.8718507751937985 val_auprc:  0.947204917254716
EarlyStopping counter: 25 out of 50
epoch:  91
epoch:  92 val_f1:  0.776244301724119 val_auroc:  0.8713662790697675 val_auprc:  0.9473072597371213
EarlyStopping counter: 26 out of 50
epoch:  92
epoch:  93 val_f1:  0.8008946034661633 val_auroc:  0.8694282945736433 val_auprc:  0.9457976205092922
EarlyStopping counter: 27 out of 50
epoch:  93
epoch:  94 val_f1:  0.7414744243025527 val_auroc:  0.8718507751937984 val_auprc:  0.9471278673224588
EarlyStopping counter: 28 out of 50
epoch:  94
epoch:  95 val_f1:  0.749929147591018 val_auroc:  0.8718507751937984 val_auprc:  0.9472092336942122
EarlyStopping counter: 29 out of 50
epoch:  95
epoch:  96 val_f1:  0.7854893118997625 val_auroc:  0.8713662790697675 val_auprc:  0.9466649431199687
EarlyStopping counter: 30 out of 50
epoch:  96
epoch:  97 val_f1:  0.776244301724119 val_auroc:  0.87015503875969 val_auprc:  0.946121610061941
EarlyStopping counter: 31 out of 50
epoch:  97
epoch:  98 val_f1:  0.7453578564975014 val_auroc:  0.8752422480620154 val_auprc:  0.948974184355931
EarlyStopping counter: 32 out of 50
epoch:  98
epoch:  99 val_f1:  0.7697841726618705 val_auroc:  0.8703972868217055 val_auprc:  0.9463320548907821
EarlyStopping counter: 33 out of 50
epoch:  99
epoch:  100 val_f1:  0.7932273763653603 val_auroc:  0.8691860465116279 val_auprc:  0.9455539524045481
EarlyStopping counter: 34 out of 50
epoch:  100
epoch:  101 val_f1:  0.749929147591018 val_auroc:  0.8718507751937984 val_auprc:  0.9471226503222274
EarlyStopping counter: 35 out of 50
epoch:  101
epoch:  102 val_f1:  0.7601256159113488 val_auroc:  0.8720930232558138 val_auprc:  0.947195378754599
EarlyStopping counter: 36 out of 50
epoch:  102
epoch:  103 val_f1:  0.7601256159113488 val_auroc:  0.8728197674418605 val_auprc:  0.9474418063095361
EarlyStopping counter: 37 out of 50
epoch:  103
epoch:  104 val_f1:  0.7682301875730638 val_auroc:  0.8723352713178294 val_auprc:  0.9471366938227807
EarlyStopping counter: 38 out of 50
epoch:  104
epoch:  105 val_f1:  0.7697841726618705 val_auroc:  0.8723352713178295 val_auprc:  0.9473938513646702
EarlyStopping counter: 39 out of 50
epoch:  105
epoch:  106 val_f1:  0.776244301724119 val_auroc:  0.872577519379845 val_auprc:  0.9472954144156639
EarlyStopping counter: 40 out of 50
epoch:  106
epoch:  107 val_f1:  0.776244301724119 val_auroc:  0.872577519379845 val_auprc:  0.947293247979877
EarlyStopping counter: 41 out of 50
epoch:  107
epoch:  108 val_f1:  0.758275274873164 val_auroc:  0.8728197674418604 val_auprc:  0.9474387745723107
EarlyStopping counter: 42 out of 50
epoch:  108
epoch:  109 val_f1:  0.7697841726618705 val_auroc:  0.87015503875969 val_auprc:  0.9460700803728035
EarlyStopping counter: 43 out of 50
epoch:  109
epoch:  110 val_f1:  0.749929147591018 val_auroc:  0.8737887596899224 val_auprc:  0.9480775326280995
EarlyStopping counter: 44 out of 50
epoch:  110
epoch:  111 val_f1:  0.7665182935781787 val_auroc:  0.874515503875969 val_auprc:  0.9483355356100542
EarlyStopping counter: 45 out of 50
epoch:  111
epoch:  112 val_f1:  0.7665182935781787 val_auroc:  0.8747577519379844 val_auprc:  0.9484654444468498
EarlyStopping counter: 46 out of 50
epoch:  112
epoch:  113 val_f1:  0.7618084502224494 val_auroc:  0.872093023255814 val_auprc:  0.9470364468477834
EarlyStopping counter: 47 out of 50
epoch:  113
epoch:  114 val_f1:  0.749929147591018 val_auroc:  0.875 val_auprc:  0.9485992397909422
EarlyStopping counter: 48 out of 50
epoch:  114
epoch:  115 val_f1:  0.7682301875730638 val_auroc:  0.8737887596899225 val_auprc:  0.94811346065115
EarlyStopping counter: 49 out of 50
epoch:  115
epoch:  116 val_f1:  0.7618084502224494 val_auroc:  0.8718507751937985 val_auprc:  0.9467891939622809
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  103.77696323394775
{'time_elapsed': [103.77696323394775], 'epoch': [115], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7618084502224494], 'auroc_test': [0.8718507751937985], 'auprc_test': [0.9467891939622809]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 183]            4,096
│    └─BatchNorm1d: 2-2                  [64, 512, 183]            1,024
│    └─Tanh: 2-3                         [64, 512, 183]            --
│    └─MaxPool1d: 2-4                    [64, 512, 26]             --
│    └─Dropout: 2-5                      [64, 512, 26]             --
│    └─Flatten: 2-6                      [64, 13312]               --
│    └─Linear: 2-7                       [64, 1]                   13,313
==========================================================================================
Total params: 18,433
Trainable params: 18,433
Non-trainable params: 0
Total mult-adds (M): 48.89
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 95.95
Params size (MB): 0.07
Estimated Total Size (MB): 96.35
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.14202898550724638 val_auroc:  0.7398313492063492 val_auprc:  0.8809873449040659
epoch:  1
epoch:  2 val_f1:  0.641662685140946 val_auroc:  0.7740575396825398 val_auprc:  0.8978090776065737
Validation loss improved to 1.185468
epoch:  2
epoch:  3 val_f1:  0.6708425579265818 val_auroc:  0.7879464285714285 val_auprc:  0.9037019114422675
Validation loss improved to 1.130963
epoch:  3
epoch:  4 val_f1:  0.7475050596692022 val_auroc:  0.7998511904761906 val_auprc:  0.9046053480798038
Validation loss improved to 1.104781
epoch:  4
epoch:  5 val_f1:  0.7682102622017333 val_auroc:  0.816220238095238 val_auprc:  0.9092492840754832
Validation loss improved to 1.089793
epoch:  5
epoch:  6 val_f1:  0.7067526095351808 val_auroc:  0.8306051587301587 val_auprc:  0.9154136125745542
Validation loss improved to 1.079764
epoch:  6
epoch:  7 val_f1:  0.7286401025531458 val_auroc:  0.8454861111111112 val_auprc:  0.9180913118958629
Validation loss improved to 1.058845
epoch:  7
epoch:  8 val_f1:  0.7833564971403972 val_auroc:  0.8546626984126986 val_auprc:  0.9216209361180357
Validation loss improved to 1.043338
epoch:  8
epoch:  9 val_f1:  0.770099160945843 val_auroc:  0.861359126984127 val_auprc:  0.9255100846379822
Validation loss improved to 1.028295
epoch:  9
epoch:  10 val_f1:  0.7495309300442878 val_auroc:  0.8653273809523809 val_auprc:  0.9270207580177687
Validation loss improved to 1.013361
epoch:  10
epoch:  11 val_f1:  0.8379179994184355 val_auroc:  0.8702876984126984 val_auprc:  0.9277424833274139
Validation loss improved to 1.001998
epoch:  11
epoch:  12 val_f1:  0.74930078820239 val_auroc:  0.8715277777777779 val_auprc:  0.9288545953347107
Validation loss improved to 0.992264
epoch:  12
epoch:  13 val_f1:  0.8290790088826556 val_auroc:  0.8762400793650794 val_auprc:  0.9313942642424875
Validation loss improved to 0.984759
epoch:  13
epoch:  14 val_f1:  0.7564782680351303 val_auroc:  0.8740079365079365 val_auprc:  0.9309031994887305
Validation loss improved to 0.965707
epoch:  14
epoch:  15 val_f1:  0.8215074100875418 val_auroc:  0.8769841269841271 val_auprc:  0.9312589763426777
Validation loss improved to 0.962088
epoch:  15
epoch:  16 val_f1:  0.7773176903611687 val_auroc:  0.8782242063492064 val_auprc:  0.9344612211531251
Validation loss improved to 0.941649
epoch:  16
epoch:  17 val_f1:  0.7908726763630708 val_auroc:  0.8812003968253969 val_auprc:  0.9357639542816336
Validation loss improved to 0.928792
epoch:  17
epoch:  18 val_f1:  0.8357868172805383 val_auroc:  0.8784722222222222 val_auprc:  0.9315138290311005
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.804509509950907 val_auroc:  0.8816964285714286 val_auprc:  0.9349150061841602
Validation loss improved to 0.907355
epoch:  19
epoch:  20 val_f1:  0.8248885315945005 val_auroc:  0.8804563492063492 val_auprc:  0.9341593534507201
Validation loss improved to 0.901858
epoch:  20
epoch:  21 val_f1:  0.7911016744679825 val_auroc:  0.8816964285714286 val_auprc:  0.9356699190173678
Validation loss improved to 0.894185
epoch:  21
epoch:  22 val_f1:  0.8271938694055665 val_auroc:  0.8816964285714285 val_auprc:  0.9345716818618848
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.8316700397794683 val_auroc:  0.8831845238095238 val_auprc:  0.936161439441446
Validation loss improved to 0.876147
epoch:  23
epoch:  24 val_f1:  0.8248885315945005 val_auroc:  0.8829365079365079 val_auprc:  0.9367487108778518
Validation loss improved to 0.869872
epoch:  24
epoch:  25 val_f1:  0.7703877790834313 val_auroc:  0.8836805555555556 val_auprc:  0.9368372106374372
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.8281893869312926 val_auroc:  0.8846726190476191 val_auprc:  0.9372355668350618
Validation loss improved to 0.868985
epoch:  26
epoch:  27 val_f1:  0.8118993135011442 val_auroc:  0.8851686507936508 val_auprc:  0.9384717330560565
Validation loss improved to 0.848476
epoch:  27
epoch:  28 val_f1:  0.8305598194589869 val_auroc:  0.8859126984126984 val_auprc:  0.9385416172204682
Validation loss improved to 0.845821
epoch:  28
epoch:  29 val_f1:  0.8384495766860566 val_auroc:  0.8864087301587302 val_auprc:  0.9386969891192594
Validation loss improved to 0.838824
epoch:  29
epoch:  30 val_f1:  0.8305598194589869 val_auroc:  0.8856646825396824 val_auprc:  0.9384019762207474
Validation loss improved to 0.834799
epoch:  30
epoch:  31 val_f1:  0.8305598194589869 val_auroc:  0.884672619047619 val_auprc:  0.9380458734869669
Validation loss improved to 0.833519
epoch:  31
epoch:  32 val_f1:  0.8372994888066281 val_auroc:  0.8841765873015872 val_auprc:  0.937703939872777
Validation loss improved to 0.831579
epoch:  32
epoch:  33 val_f1:  0.8305598194589869 val_auroc:  0.8844246031746031 val_auprc:  0.9377407036700154
Validation loss improved to 0.825125
epoch:  33
epoch:  34 val_f1:  0.822380909337431 val_auroc:  0.8839285714285714 val_auprc:  0.9375049974654133
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.8113104975093783 val_auroc:  0.8846726190476191 val_auprc:  0.937905042073403
Validation loss improved to 0.818112
epoch:  35
epoch:  36 val_f1:  0.822380909337431 val_auroc:  0.882688492063492 val_auprc:  0.9368841484173203
EarlyStopping counter: 1 out of 50
epoch:  36
epoch:  37 val_f1:  0.8194319840387783 val_auroc:  0.8824404761904762 val_auprc:  0.9367489763671416
EarlyStopping counter: 2 out of 50
epoch:  37
epoch:  38 val_f1:  0.8298676748582231 val_auroc:  0.8836805555555555 val_auprc:  0.9377648732346655
EarlyStopping counter: 3 out of 50
epoch:  38
epoch:  39 val_f1:  0.8298676748582231 val_auroc:  0.8839285714285714 val_auprc:  0.9377363417139031
EarlyStopping counter: 4 out of 50
epoch:  39
epoch:  40 val_f1:  0.8372994888066281 val_auroc:  0.8821924603174603 val_auprc:  0.9368461214657493
EarlyStopping counter: 5 out of 50
epoch:  40
epoch:  41 val_f1:  0.8238239124113431 val_auroc:  0.8841765873015873 val_auprc:  0.93793174083621
Validation loss improved to 0.810280
epoch:  41
epoch:  42 val_f1:  0.8049865427618805 val_auroc:  0.8814484126984128 val_auprc:  0.9364318352932385
EarlyStopping counter: 1 out of 50
epoch:  42
epoch:  43 val_f1:  0.8238239124113431 val_auroc:  0.8836805555555556 val_auprc:  0.9380069484016861
Validation loss improved to 0.808653
epoch:  43
epoch:  44 val_f1:  0.8305598194589869 val_auroc:  0.8829365079365079 val_auprc:  0.9376344094679789
EarlyStopping counter: 1 out of 50
epoch:  44
epoch:  45 val_f1:  0.8182185828242006 val_auroc:  0.8782242063492064 val_auprc:  0.9347446175467473
EarlyStopping counter: 2 out of 50
epoch:  45
epoch:  46 val_f1:  0.8103538508923273 val_auroc:  0.8834325396825398 val_auprc:  0.9379542438290334
Validation loss improved to 0.803379
epoch:  46
epoch:  47 val_f1:  0.8108796141220607 val_auroc:  0.8839285714285715 val_auprc:  0.9384901807098369
Validation loss improved to 0.798372
epoch:  47
epoch:  48 val_f1:  0.8041106719367591 val_auroc:  0.883184523809524 val_auprc:  0.938228537108043
Validation loss improved to 0.797868
epoch:  48
epoch:  49 val_f1:  0.7929485957015485 val_auroc:  0.878720238095238 val_auprc:  0.9352958726660858
EarlyStopping counter: 1 out of 50
epoch:  49
epoch:  50 val_f1:  0.8081713820844254 val_auroc:  0.876984126984127 val_auprc:  0.9347770395883186
EarlyStopping counter: 2 out of 50
epoch:  50
epoch:  51 val_f1:  0.8305598194589869 val_auroc:  0.8809523809523809 val_auprc:  0.9368534136585143
EarlyStopping counter: 3 out of 50
epoch:  51
epoch:  52 val_f1:  0.8238239124113431 val_auroc:  0.8841765873015872 val_auprc:  0.9381722110777793
EarlyStopping counter: 4 out of 50
epoch:  52
epoch:  53 val_f1:  0.8231516182680737 val_auroc:  0.8797123015873016 val_auprc:  0.936183836952708
EarlyStopping counter: 5 out of 50
epoch:  53
epoch:  54 val_f1:  0.8305598194589869 val_auroc:  0.8797123015873016 val_auprc:  0.9359514497388265
EarlyStopping counter: 6 out of 50
epoch:  54
epoch:  55 val_f1:  0.8115942028985508 val_auroc:  0.8787202380952381 val_auprc:  0.9352349001869269
EarlyStopping counter: 7 out of 50
epoch:  55
epoch:  56 val_f1:  0.8231516182680737 val_auroc:  0.882688492063492 val_auprc:  0.9372334079354503
EarlyStopping counter: 8 out of 50
epoch:  56
epoch:  57 val_f1:  0.8231516182680737 val_auroc:  0.8824404761904762 val_auprc:  0.9371691817238225
EarlyStopping counter: 9 out of 50
epoch:  57
epoch:  58 val_f1:  0.8102677351291666 val_auroc:  0.8742559523809524 val_auprc:  0.9333801100984824
EarlyStopping counter: 10 out of 50
epoch:  58
epoch:  59 val_f1:  0.8156899810964081 val_auroc:  0.8809523809523809 val_auprc:  0.9366699884224624
EarlyStopping counter: 11 out of 50
epoch:  59
epoch:  60 val_f1:  0.8238239124113431 val_auroc:  0.8816964285714285 val_auprc:  0.9371993861372607
EarlyStopping counter: 12 out of 50
epoch:  60
epoch:  61 val_f1:  0.8170893719806764 val_auroc:  0.8851686507936509 val_auprc:  0.939665251489607
EarlyStopping counter: 13 out of 50
epoch:  61
epoch:  62 val_f1:  0.8238239124113431 val_auroc:  0.8814484126984128 val_auprc:  0.9369763614944402
EarlyStopping counter: 14 out of 50
epoch:  62
epoch:  63 val_f1:  0.8115942028985508 val_auroc:  0.8777281746031745 val_auprc:  0.9348087292008642
EarlyStopping counter: 15 out of 50
epoch:  63
epoch:  64 val_f1:  0.8168793096329329 val_auroc:  0.8774801587301587 val_auprc:  0.9343468027155422
EarlyStopping counter: 16 out of 50
epoch:  64
epoch:  65 val_f1:  0.8182185828242006 val_auroc:  0.8772321428571429 val_auprc:  0.9342659709123109
EarlyStopping counter: 17 out of 50
epoch:  65
epoch:  66 val_f1:  0.8238239124113431 val_auroc:  0.8859126984126984 val_auprc:  0.9392095453818543
EarlyStopping counter: 18 out of 50
epoch:  66
epoch:  67 val_f1:  0.8138718358422335 val_auroc:  0.8834325396825397 val_auprc:  0.9378688501002586
EarlyStopping counter: 19 out of 50
epoch:  67
epoch:  68 val_f1:  0.8156899810964081 val_auroc:  0.8836805555555555 val_auprc:  0.9379735431874134
EarlyStopping counter: 20 out of 50
epoch:  68
epoch:  69 val_f1:  0.8231516182680737 val_auroc:  0.882936507936508 val_auprc:  0.9378282774345263
EarlyStopping counter: 21 out of 50
epoch:  69
epoch:  70 val_f1:  0.8138718358422335 val_auroc:  0.8809523809523809 val_auprc:  0.9364698734082766
EarlyStopping counter: 22 out of 50
epoch:  70
epoch:  71 val_f1:  0.8138718358422335 val_auroc:  0.8807043650793651 val_auprc:  0.9366560204359631
EarlyStopping counter: 23 out of 50
epoch:  71
epoch:  72 val_f1:  0.8138718358422335 val_auroc:  0.8797123015873016 val_auprc:  0.9361543544908635
EarlyStopping counter: 24 out of 50
epoch:  72
epoch:  73 val_f1:  0.8315289648622983 val_auroc:  0.8782242063492064 val_auprc:  0.9349392577688567
EarlyStopping counter: 25 out of 50
epoch:  73
epoch:  74 val_f1:  0.8205262448141007 val_auroc:  0.8799603174603174 val_auprc:  0.9359764969001125
EarlyStopping counter: 26 out of 50
epoch:  74
epoch:  75 val_f1:  0.807228002894545 val_auroc:  0.8814484126984127 val_auprc:  0.9367601696142815
EarlyStopping counter: 27 out of 50
epoch:  75
epoch:  76 val_f1:  0.8231516182680737 val_auroc:  0.8836805555555556 val_auprc:  0.938144423172801
EarlyStopping counter: 28 out of 50
epoch:  76
epoch:  77 val_f1:  0.8164398044139025 val_auroc:  0.8851686507936508 val_auprc:  0.9396186092001055
EarlyStopping counter: 29 out of 50
epoch:  77
epoch:  78 val_f1:  0.822380909337431 val_auroc:  0.8834325396825398 val_auprc:  0.938697774033167
EarlyStopping counter: 30 out of 50
epoch:  78
epoch:  79 val_f1:  0.807228002894545 val_auroc:  0.8802083333333334 val_auprc:  0.9362998661270535
EarlyStopping counter: 31 out of 50
epoch:  79
epoch:  80 val_f1:  0.8182185828242006 val_auroc:  0.8784722222222223 val_auprc:  0.9353493338375438
EarlyStopping counter: 32 out of 50
epoch:  80
epoch:  81 val_f1:  0.8248625247346153 val_auroc:  0.8782242063492064 val_auprc:  0.9350125979492765
EarlyStopping counter: 33 out of 50
epoch:  81
epoch:  82 val_f1:  0.807228002894545 val_auroc:  0.8836805555555556 val_auprc:  0.9387555849991509
EarlyStopping counter: 34 out of 50
epoch:  82
epoch:  83 val_f1:  0.807228002894545 val_auroc:  0.8839285714285715 val_auprc:  0.939003859139693
EarlyStopping counter: 35 out of 50
epoch:  83
epoch:  84 val_f1:  0.8138718358422335 val_auroc:  0.878968253968254 val_auprc:  0.9363493986299758
EarlyStopping counter: 36 out of 50
epoch:  84
epoch:  85 val_f1:  0.8315289648622983 val_auroc:  0.8759920634920635 val_auprc:  0.9336554771136922
EarlyStopping counter: 37 out of 50
epoch:  85
epoch:  86 val_f1:  0.8315289648622983 val_auroc:  0.8784722222222222 val_auprc:  0.9356392857103062
EarlyStopping counter: 38 out of 50
epoch:  86
epoch:  87 val_f1:  0.8081713820844254 val_auroc:  0.8821924603174602 val_auprc:  0.9380459824978848
EarlyStopping counter: 39 out of 50
epoch:  87
epoch:  88 val_f1:  0.807228002894545 val_auroc:  0.8792162698412699 val_auprc:  0.9364921006287427
EarlyStopping counter: 40 out of 50
epoch:  88
epoch:  89 val_f1:  0.8156899810964081 val_auroc:  0.8819444444444444 val_auprc:  0.9392035292618477
EarlyStopping counter: 41 out of 50
epoch:  89
epoch:  90 val_f1:  0.8394573143400641 val_auroc:  0.8797123015873015 val_auprc:  0.9373973478631062
EarlyStopping counter: 42 out of 50
epoch:  90
epoch:  91 val_f1:  0.8315289648622983 val_auroc:  0.878720238095238 val_auprc:  0.9352439191789952
EarlyStopping counter: 43 out of 50
epoch:  91
epoch:  92 val_f1:  0.8061683443992288 val_auroc:  0.8799603174603174 val_auprc:  0.9363541314441324
EarlyStopping counter: 44 out of 50
epoch:  92
epoch:  93 val_f1:  0.807228002894545 val_auroc:  0.882936507936508 val_auprc:  0.938600311847952
EarlyStopping counter: 45 out of 50
epoch:  93
epoch:  94 val_f1:  0.807228002894545 val_auroc:  0.8814484126984127 val_auprc:  0.9382562671955919
EarlyStopping counter: 46 out of 50
epoch:  94
epoch:  95 val_f1:  0.807228002894545 val_auroc:  0.8802083333333334 val_auprc:  0.9377779183485921
EarlyStopping counter: 47 out of 50
epoch:  95
epoch:  96 val_f1:  0.8327610961982647 val_auroc:  0.8792162698412698 val_auprc:  0.9370042027358937
EarlyStopping counter: 48 out of 50
epoch:  96
epoch:  97 val_f1:  0.8005921770297647 val_auroc:  0.8826884920634921 val_auprc:  0.9385607572010907
EarlyStopping counter: 49 out of 50
epoch:  97
epoch:  98 val_f1:  0.8061683443992288 val_auroc:  0.8812003968253969 val_auprc:  0.9385014072752651
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  86.7594964504242
{'time_elapsed': [86.7594964504242], 'epoch': [97], 'fold': [4], 'f1_train': [0.9982029282297181], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8061683443992288], 'auroc_test': [0.8812003968253969], 'auprc_test': [0.9385014072752651]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 183]            4,096
│    └─BatchNorm1d: 2-2                  [64, 512, 183]            1,024
│    └─Tanh: 2-3                         [64, 512, 183]            --
│    └─MaxPool1d: 2-4                    [64, 512, 26]             --
│    └─Dropout: 2-5                      [64, 512, 26]             --
│    └─Flatten: 2-6                      [64, 13312]               --
│    └─Linear: 2-7                       [64, 1]                   13,313
==========================================================================================
Total params: 18,433
Trainable params: 18,433
Non-trainable params: 0
Total mult-adds (M): 48.89
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 95.95
Params size (MB): 0.07
Estimated Total Size (MB): 96.35
==========================================================================================
