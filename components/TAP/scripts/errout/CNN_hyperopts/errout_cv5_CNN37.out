config:  {'project': 'MHCCBM', 'name': 'CNN_37', 'config': {'hidden_channels': [512], 'epochs': 500, 'kernel_size': 5, 'pool_kernel_size': 5, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.603460972017673 val_auprc:  0.7869417645960328
epoch:  1
epoch:  2 val_f1:  0.31310251798561145 val_auroc:  0.46170839469808544 val_auprc:  0.6782557138451722
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.5652709823475395 val_auroc:  0.4959499263622975 val_auprc:  0.7735096815089872
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.3704069513452757 val_auroc:  0.46600392734413354 val_auprc:  0.6871540369333168
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.5849273851946482 val_auroc:  0.5227049582719685 val_auprc:  0.7930271906213463
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.5770092434191596 val_auroc:  0.5008591065292096 val_auprc:  0.7168161434848214
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.5306838866256393 val_auroc:  0.5365733922434954 val_auprc:  0.7256019210333955
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.5650914184179608 val_auroc:  0.610947471772214 val_auprc:  0.7762037652697611
Validation loss improved to 2.542268
epoch:  8
epoch:  9 val_f1:  0.6607005776287218 val_auroc:  0.7108492881688757 val_auprc:  0.8657846763729615
Validation loss improved to 1.114841
epoch:  9
epoch:  10 val_f1:  0.6834532374100719 val_auroc:  0.7592047128129602 val_auprc:  0.8900327632392006
Validation loss improved to 0.518815
epoch:  10
epoch:  11 val_f1:  0.6289646282660997 val_auroc:  0.7658321060382917 val_auprc:  0.8886798396538567
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7202047592695074 val_auroc:  0.7592047128129602 val_auprc:  0.8822575327181992
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.6937535685737124 val_auroc:  0.7621502209131075 val_auprc:  0.8847209407543921
EarlyStopping counter: 3 out of 50
epoch:  13
epoch:  14 val_f1:  0.7002679453520968 val_auroc:  0.7709867452135494 val_auprc:  0.8906234425131919
EarlyStopping counter: 4 out of 50
epoch:  14
epoch:  15 val_f1:  0.696151679426677 val_auroc:  0.7788414334806087 val_auprc:  0.8976120269499785
EarlyStopping counter: 5 out of 50
epoch:  15
epoch:  16 val_f1:  0.7448635686045757 val_auroc:  0.7709867452135493 val_auprc:  0.8887886956201315
EarlyStopping counter: 6 out of 50
epoch:  16
epoch:  17 val_f1:  0.6353297362110312 val_auroc:  0.774914089347079 val_auprc:  0.8923538281006681
EarlyStopping counter: 7 out of 50
epoch:  17
epoch:  18 val_f1:  0.7207289113763933 val_auroc:  0.7773686794305351 val_auprc:  0.8961828767936617
EarlyStopping counter: 8 out of 50
epoch:  18
epoch:  19 val_f1:  0.717230470942395 val_auroc:  0.7793323514973 val_auprc:  0.8966706183984107
EarlyStopping counter: 9 out of 50
epoch:  19
epoch:  20 val_f1:  0.7100860488080124 val_auroc:  0.7869415807560137 val_auprc:  0.9022468344559842
EarlyStopping counter: 10 out of 50
epoch:  20
epoch:  21 val_f1:  0.7505653177403916 val_auroc:  0.7891507118311242 val_auprc:  0.9023197824653179
EarlyStopping counter: 11 out of 50
epoch:  21
epoch:  22 val_f1:  0.7307106601978622 val_auroc:  0.7903780068728523 val_auprc:  0.903134658731728
EarlyStopping counter: 12 out of 50
epoch:  22
epoch:  23 val_f1:  0.6954243384953055 val_auroc:  0.7923416789396172 val_auprc:  0.9051666084239602
EarlyStopping counter: 13 out of 50
epoch:  23
epoch:  24 val_f1:  0.6655263974827678 val_auroc:  0.7967599410898379 val_auprc:  0.9104248859100328
EarlyStopping counter: 14 out of 50
epoch:  24
epoch:  25 val_f1:  0.7299542184434271 val_auroc:  0.7893961708394699 val_auprc:  0.9031157684557853
EarlyStopping counter: 15 out of 50
epoch:  25
epoch:  26 val_f1:  0.743431836172277 val_auroc:  0.794305351006382 val_auprc:  0.9071774854311313
EarlyStopping counter: 16 out of 50
epoch:  26
epoch:  27 val_f1:  0.751751326211758 val_auroc:  0.8026509572901326 val_auprc:  0.9138355055625296
EarlyStopping counter: 17 out of 50
epoch:  27
epoch:  28 val_f1:  0.7238240177089098 val_auroc:  0.7916053019145802 val_auprc:  0.9050739376665785
EarlyStopping counter: 18 out of 50
epoch:  28
epoch:  29 val_f1:  0.6464520026864771 val_auroc:  0.7822778595974472 val_auprc:  0.8946297131258584
EarlyStopping counter: 19 out of 50
epoch:  29
epoch:  30 val_f1:  0.7386752666832053 val_auroc:  0.796759941089838 val_auprc:  0.9070020438990749
EarlyStopping counter: 20 out of 50
epoch:  30
epoch:  31 val_f1:  0.7643829551743221 val_auroc:  0.8073146784486991 val_auprc:  0.9140438866698091
EarlyStopping counter: 21 out of 50
epoch:  31
epoch:  32 val_f1:  0.7510257046352308 val_auroc:  0.8053510063819344 val_auprc:  0.9121967401333826
EarlyStopping counter: 22 out of 50
epoch:  32
epoch:  33 val_f1:  0.7377691212466089 val_auroc:  0.8075601374570447 val_auprc:  0.913971899314963
EarlyStopping counter: 23 out of 50
epoch:  33
epoch:  34 val_f1:  0.7583300796647482 val_auroc:  0.8073146784486992 val_auprc:  0.9132328619122881
EarlyStopping counter: 24 out of 50
epoch:  34
epoch:  35 val_f1:  0.7099629667254643 val_auroc:  0.8097692685321551 val_auprc:  0.9151961089488849
EarlyStopping counter: 25 out of 50
epoch:  35
epoch:  36 val_f1:  0.7308672563486676 val_auroc:  0.8127147766323024 val_auprc:  0.9193438759661843
EarlyStopping counter: 26 out of 50
epoch:  36
epoch:  37 val_f1:  0.7617596949267598 val_auroc:  0.8063328424153166 val_auprc:  0.9147972600633767
EarlyStopping counter: 27 out of 50
epoch:  37
epoch:  38 val_f1:  0.76000113614692 val_auroc:  0.8237604320078548 val_auprc:  0.9288277491835343
EarlyStopping counter: 28 out of 50
epoch:  38
epoch:  39 val_f1:  0.7536081085870222 val_auroc:  0.8055964653902798 val_auprc:  0.9147216759648051
EarlyStopping counter: 29 out of 50
epoch:  39
epoch:  40 val_f1:  0.7455074238481555 val_auroc:  0.8122238586156113 val_auprc:  0.9180061512900526
EarlyStopping counter: 30 out of 50
epoch:  40
epoch:  41 val_f1:  0.7346924658075737 val_auroc:  0.8080510554737359 val_auprc:  0.9155425331226718
EarlyStopping counter: 31 out of 50
epoch:  41
epoch:  42 val_f1:  0.7711689349644636 val_auroc:  0.8095238095238095 val_auprc:  0.9130369848014723
EarlyStopping counter: 32 out of 50
epoch:  42
epoch:  43 val_f1:  0.723931698015082 val_auroc:  0.8139420716740305 val_auprc:  0.9177255775864475
EarlyStopping counter: 33 out of 50
epoch:  43
epoch:  44 val_f1:  0.7455074238481555 val_auroc:  0.8136966126656848 val_auprc:  0.9162601469647493
EarlyStopping counter: 34 out of 50
epoch:  44
epoch:  45 val_f1:  0.7681512331200245 val_auroc:  0.8107511045655376 val_auprc:  0.912911329681918
EarlyStopping counter: 35 out of 50
epoch:  45
epoch:  46 val_f1:  0.7412236216203913 val_auroc:  0.8127147766323024 val_auprc:  0.9152065008113639
EarlyStopping counter: 36 out of 50
epoch:  46
epoch:  47 val_f1:  0.6663975251072785 val_auroc:  0.8097692685321553 val_auprc:  0.9094322731069713
EarlyStopping counter: 37 out of 50
epoch:  47
epoch:  48 val_f1:  0.6941977313483386 val_auroc:  0.8274423171330388 val_auprc:  0.9286428531070796
EarlyStopping counter: 38 out of 50
epoch:  48
epoch:  49 val_f1:  0.7569659388768054 val_auroc:  0.8159057437407954 val_auprc:  0.9186405029990767
EarlyStopping counter: 39 out of 50
epoch:  49
epoch:  50 val_f1:  0.7648576099332736 val_auroc:  0.8065783014236624 val_auprc:  0.9075523814130145
EarlyStopping counter: 40 out of 50
epoch:  50
epoch:  51 val_f1:  0.6339490569706397 val_auroc:  0.8144329896907218 val_auprc:  0.9154877611499654
EarlyStopping counter: 41 out of 50
epoch:  51
epoch:  52 val_f1:  0.6569672978309223 val_auroc:  0.8276877761413844 val_auprc:  0.9280537558945686
EarlyStopping counter: 42 out of 50
epoch:  52
epoch:  53 val_f1:  0.751751326211758 val_auroc:  0.8009327442317133 val_auprc:  0.9083921052699443
EarlyStopping counter: 43 out of 50
epoch:  53
epoch:  54 val_f1:  0.7536606851900262 val_auroc:  0.8151693667157585 val_auprc:  0.9178817174518707
EarlyStopping counter: 44 out of 50
epoch:  54
epoch:  55 val_f1:  0.7719216534287021 val_auroc:  0.8252331860579283 val_auprc:  0.9243591062568135
EarlyStopping counter: 45 out of 50
epoch:  55
epoch:  56 val_f1:  0.7791090204759269 val_auroc:  0.8259695630829651 val_auprc:  0.924571009544997
EarlyStopping counter: 46 out of 50
epoch:  56
epoch:  57 val_f1:  0.6958509820496094 val_auroc:  0.8247422680412371 val_auprc:  0.9238887578429132
EarlyStopping counter: 47 out of 50
epoch:  57
epoch:  58 val_f1:  0.7672775806504117 val_auroc:  0.8154148257241041 val_auprc:  0.9152223056990467
EarlyStopping counter: 48 out of 50
epoch:  58
epoch:  59 val_f1:  0.7107661257285465 val_auroc:  0.8193421698576338 val_auprc:  0.920976865865601
EarlyStopping counter: 49 out of 50
epoch:  59
epoch:  60 val_f1:  0.7651358509506568 val_auroc:  0.8286696121747669 val_auprc:  0.9262766080397455
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  836.5586092472076
{'time_elapsed': [836.5586092472076], 'epoch': [59], 'fold': [0], 'f1_train': [0.890294158248855], 'auroc_train': [0.9954624888861636], 'auprc_train': [0.9980335658749706], 'f1_test': [0.7651358509506568], 'auroc_test': [0.8286696121747669], 'auprc_test': [0.9262766080397455]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1278]           3,072
│    └─BatchNorm1d: 2-2                  [64, 512, 1278]           1,024
│    └─Tanh: 2-3                         [64, 512, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1274]           --
│    └─Dropout: 2-5                      [64, 512, 1274]           --
│    └─Flatten: 2-6                      [64, 652288]              --
│    └─Linear: 2-7                       [64, 1]                   652,289
==========================================================================================
Total params: 656,385
Trainable params: 656,385
Non-trainable params: 0
Total mult-adds (M): 293.08
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 670.04
Params size (MB): 2.63
Estimated Total Size (MB): 672.99
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5234992716223703 val_auroc:  0.6759941089837997 val_auprc:  0.8532697287159003
epoch:  1
epoch:  2 val_f1:  0.6010791366906474 val_auroc:  0.7199312714776632 val_auprc:  0.8892296695507047
Validation loss improved to 1.036941
epoch:  2
epoch:  3 val_f1:  0.6727288220185274 val_auroc:  0.7459499263622975 val_auprc:  0.8950725072451047
Validation loss improved to 0.928151
epoch:  3
epoch:  4 val_f1:  0.6709686326133335 val_auroc:  0.7977417771232205 val_auprc:  0.9165777466295741
Validation loss improved to 0.913088
epoch:  4
epoch:  5 val_f1:  0.7681512331200245 val_auroc:  0.7884143348060874 val_auprc:  0.9017185605945274
Validation loss improved to 0.367309
epoch:  5
epoch:  6 val_f1:  0.6543650575722627 val_auroc:  0.8112420225822288 val_auprc:  0.9250430453937358
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.664749041887985 val_auroc:  0.8124693176239568 val_auprc:  0.9238985080661511
EarlyStopping counter: 2 out of 50
epoch:  7
epoch:  8 val_f1:  0.743914028278071 val_auroc:  0.7972508591065293 val_auprc:  0.9122279727740548
EarlyStopping counter: 3 out of 50
epoch:  8
epoch:  9 val_f1:  0.7839141001375581 val_auroc:  0.817378497790869 val_auprc:  0.9215777955302511
Validation loss improved to 0.344956
epoch:  9
epoch:  10 val_f1:  0.694872962389582 val_auroc:  0.8124693176239568 val_auprc:  0.9205744501847015
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.7790721385700611 val_auroc:  0.8208149239077074 val_auprc:  0.9216824980469744
Validation loss improved to 0.275083
epoch:  11
epoch:  12 val_f1:  0.7963871971298289 val_auroc:  0.8171330387825234 val_auprc:  0.917755242409759
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7559325673789327 val_auroc:  0.8225331369661266 val_auprc:  0.9198569297449877
Validation loss improved to 0.243761
epoch:  13
epoch:  14 val_f1:  0.7545102379634754 val_auroc:  0.8308787432498772 val_auprc:  0.9240859511542988
Validation loss improved to 0.216574
epoch:  14
epoch:  15 val_f1:  0.7841726618705036 val_auroc:  0.8264604810996564 val_auprc:  0.922717084501642
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7772753225990636 val_auroc:  0.8296514482081492 val_auprc:  0.9236950624001117
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.777854660092151 val_auroc:  0.8321060382916053 val_auprc:  0.9256581824306559
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.7169642564307364 val_auroc:  0.8343151693667157 val_auprc:  0.9261417890901658
EarlyStopping counter: 4 out of 50
epoch:  18
epoch:  19 val_f1:  0.6876087591262989 val_auroc:  0.825478645066274 val_auprc:  0.9200307064427831
EarlyStopping counter: 5 out of 50
epoch:  19
epoch:  20 val_f1:  0.7661184054361647 val_auroc:  0.8097692685321551 val_auprc:  0.9121192351525305
EarlyStopping counter: 6 out of 50
epoch:  20
epoch:  21 val_f1:  0.7855164986057286 val_auroc:  0.8240058910162004 val_auprc:  0.9202120158597538
EarlyStopping counter: 7 out of 50
epoch:  21
epoch:  22 val_f1:  0.65669788697344 val_auroc:  0.832228767795778 val_auprc:  0.91541557513492
EarlyStopping counter: 8 out of 50
epoch:  22
epoch:  23 val_f1:  0.7889150110486646 val_auroc:  0.8289150711831125 val_auprc:  0.9198358065610989
EarlyStopping counter: 9 out of 50
epoch:  23
epoch:  24 val_f1:  0.8036372932111164 val_auroc:  0.8269513991163475 val_auprc:  0.9164222976301348
Validation loss improved to 0.204897
epoch:  24
epoch:  25 val_f1:  0.7791090204759269 val_auroc:  0.8249877270495828 val_auprc:  0.9143555903939957
Validation loss improved to 0.193481
epoch:  25
epoch:  26 val_f1:  0.7573003855683703 val_auroc:  0.8247422680412372 val_auprc:  0.9158237104271549
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7286063672426545 val_auroc:  0.8252331860579283 val_auprc:  0.9131029842622478
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7598715939807772 val_auroc:  0.8306332842415316 val_auprc:  0.918570175974901
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.7809570525397864 val_auroc:  0.825478645066274 val_auprc:  0.9163279117182137
EarlyStopping counter: 4 out of 50
epoch:  29
epoch:  30 val_f1:  0.7777125328082551 val_auroc:  0.8294059891998037 val_auprc:  0.9174937047949694
EarlyStopping counter: 5 out of 50
epoch:  30
epoch:  31 val_f1:  0.7809570525397864 val_auroc:  0.8311242022582228 val_auprc:  0.917513543884962
Validation loss improved to 0.183656
epoch:  31
epoch:  32 val_f1:  0.7598715939807772 val_auroc:  0.8232695139911634 val_auprc:  0.9123112777433209
Validation loss improved to 0.181619
epoch:  32
epoch:  33 val_f1:  0.7633550302615051 val_auroc:  0.8230240549828179 val_auprc:  0.9151159948944421
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.757304835743056 val_auroc:  0.8249877270495828 val_auprc:  0.9105714989447318
Validation loss improved to 0.171827
epoch:  34
epoch:  35 val_f1:  0.7841726618705036 val_auroc:  0.8227785959744723 val_auprc:  0.9128793824144669
EarlyStopping counter: 1 out of 50
epoch:  35
epoch:  36 val_f1:  0.7809570525397864 val_auroc:  0.823514972999509 val_auprc:  0.9125970806438031
EarlyStopping counter: 2 out of 50
epoch:  36
epoch:  37 val_f1:  0.7944676896257205 val_auroc:  0.8220422189494354 val_auprc:  0.9147734895971498
EarlyStopping counter: 3 out of 50
epoch:  37
epoch:  38 val_f1:  0.7791090204759269 val_auroc:  0.8232695139911635 val_auprc:  0.9106308748422038
EarlyStopping counter: 4 out of 50
epoch:  38
epoch:  39 val_f1:  0.7727225509205256 val_auroc:  0.8149239077074129 val_auprc:  0.9073366020537218
EarlyStopping counter: 5 out of 50
epoch:  39
epoch:  40 val_f1:  0.7933255489848959 val_auroc:  0.8210603829160531 val_auprc:  0.9108749347252595
EarlyStopping counter: 6 out of 50
epoch:  40
epoch:  41 val_f1:  0.7707245329923307 val_auroc:  0.8220422189494354 val_auprc:  0.9104909696846655
EarlyStopping counter: 7 out of 50
epoch:  41
epoch:  42 val_f1:  0.7791090204759269 val_auroc:  0.8232695139911635 val_auprc:  0.9092729643593342
EarlyStopping counter: 8 out of 50
epoch:  42
epoch:  43 val_f1:  0.7777125328082551 val_auroc:  0.8240058910162003 val_auprc:  0.9088743820810794
EarlyStopping counter: 9 out of 50
epoch:  43
epoch:  44 val_f1:  0.7777125328082551 val_auroc:  0.8215513009327442 val_auprc:  0.908394908184439
EarlyStopping counter: 10 out of 50
epoch:  44
epoch:  45 val_f1:  0.7727225509205256 val_auroc:  0.8154148257241041 val_auprc:  0.9033703550021456
EarlyStopping counter: 11 out of 50
epoch:  45
epoch:  46 val_f1:  0.7873856121514594 val_auroc:  0.8186057928325969 val_auprc:  0.9033570721895784
EarlyStopping counter: 12 out of 50
epoch:  46
epoch:  47 val_f1:  0.7745465218349855 val_auroc:  0.8146784486990672 val_auprc:  0.9026651589135773
EarlyStopping counter: 13 out of 50
epoch:  47
epoch:  48 val_f1:  0.7622262794246104 val_auroc:  0.8183603338242513 val_auprc:  0.9024255533962708
Validation loss improved to 0.168634
epoch:  48
epoch:  49 val_f1:  0.7809570525397864 val_auroc:  0.8176239567992145 val_auprc:  0.9043973321314784
EarlyStopping counter: 1 out of 50
epoch:  49
epoch:  50 val_f1:  0.7802930475309426 val_auroc:  0.8139420716740304 val_auprc:  0.9067744256338528
EarlyStopping counter: 2 out of 50
epoch:  50
epoch:  51 val_f1:  0.7536081085870222 val_auroc:  0.8190967108492881 val_auprc:  0.9062323219165559
EarlyStopping counter: 3 out of 50
epoch:  51
epoch:  52 val_f1:  0.7791090204759269 val_auroc:  0.819833087874325 val_auprc:  0.9057442965876288
EarlyStopping counter: 4 out of 50
epoch:  52
epoch:  53 val_f1:  0.7791090204759269 val_auroc:  0.819833087874325 val_auprc:  0.9044450488436386
EarlyStopping counter: 5 out of 50
epoch:  53
epoch:  54 val_f1:  0.7809570525397864 val_auroc:  0.8178694158075601 val_auprc:  0.9048312773749575
EarlyStopping counter: 6 out of 50
epoch:  54
epoch:  55 val_f1:  0.7809570525397864 val_auroc:  0.8215513009327442 val_auprc:  0.9037428834015881
EarlyStopping counter: 7 out of 50
epoch:  55
epoch:  56 val_f1:  0.7622262794246104 val_auroc:  0.8168875797741777 val_auprc:  0.8979906704865519
EarlyStopping counter: 8 out of 50
epoch:  56
epoch:  57 val_f1:  0.7809570525397864 val_auroc:  0.8181148748159057 val_auprc:  0.900203586191777
EarlyStopping counter: 9 out of 50
epoch:  57
epoch:  58 val_f1:  0.7809570525397864 val_auroc:  0.8168875797741777 val_auprc:  0.900881250260262
EarlyStopping counter: 10 out of 50
epoch:  58
epoch:  59 val_f1:  0.7727225509205256 val_auroc:  0.8183603338242513 val_auprc:  0.9024258478688545
EarlyStopping counter: 11 out of 50
epoch:  59
epoch:  60 val_f1:  0.7622262794246104 val_auroc:  0.8210603829160531 val_auprc:  0.9019044642553196
Validation loss improved to 0.149359
epoch:  60
epoch:  61 val_f1:  0.7510724063582411 val_auroc:  0.8178694158075601 val_auprc:  0.8985012157315294
EarlyStopping counter: 1 out of 50
epoch:  61
epoch:  62 val_f1:  0.7622262794246104 val_auroc:  0.8190967108492881 val_auprc:  0.8989194969059107
EarlyStopping counter: 2 out of 50
epoch:  62
epoch:  63 val_f1:  0.7809570525397864 val_auroc:  0.8149239077074129 val_auprc:  0.8931468759429784
EarlyStopping counter: 3 out of 50
epoch:  63
epoch:  64 val_f1:  0.7809570525397864 val_auroc:  0.814187530682376 val_auprc:  0.8928923463088502
EarlyStopping counter: 4 out of 50
epoch:  64
epoch:  65 val_f1:  0.7809570525397864 val_auroc:  0.8166421207658321 val_auprc:  0.8949804343636767
EarlyStopping counter: 5 out of 50
epoch:  65
epoch:  66 val_f1:  0.7707245329923307 val_auroc:  0.8151693667157585 val_auprc:  0.896059880899096
EarlyStopping counter: 6 out of 50
epoch:  66
epoch:  67 val_f1:  0.7809570525397864 val_auroc:  0.8151693667157585 val_auprc:  0.8940109727418796
EarlyStopping counter: 7 out of 50
epoch:  67
epoch:  68 val_f1:  0.7809570525397864 val_auroc:  0.8154148257241041 val_auprc:  0.89735150377326
EarlyStopping counter: 8 out of 50
epoch:  68
epoch:  69 val_f1:  0.7809570525397864 val_auroc:  0.8149239077074129 val_auprc:  0.8939071892010862
EarlyStopping counter: 9 out of 50
epoch:  69
epoch:  70 val_f1:  0.7809570525397864 val_auroc:  0.8160284732449681 val_auprc:  0.8943207157445583
EarlyStopping counter: 10 out of 50
epoch:  70
epoch:  71 val_f1:  0.7727225509205256 val_auroc:  0.8152920962199313 val_auprc:  0.8922978145337589
EarlyStopping counter: 11 out of 50
epoch:  71
epoch:  72 val_f1:  0.7745465218349855 val_auroc:  0.8148011782032402 val_auprc:  0.8950092458323724
EarlyStopping counter: 12 out of 50
epoch:  72
epoch:  73 val_f1:  0.7809570525397864 val_auroc:  0.8171330387825234 val_auprc:  0.8972964995441518
EarlyStopping counter: 13 out of 50
epoch:  73
epoch:  74 val_f1:  0.7809570525397864 val_auroc:  0.8154148257241041 val_auprc:  0.8933580969811121
EarlyStopping counter: 14 out of 50
epoch:  74
epoch:  75 val_f1:  0.7727225509205256 val_auroc:  0.8149239077074129 val_auprc:  0.8948985420635803
EarlyStopping counter: 15 out of 50
epoch:  75
epoch:  76 val_f1:  0.7727225509205256 val_auroc:  0.8149239077074129 val_auprc:  0.8936272482327762
EarlyStopping counter: 16 out of 50
epoch:  76
epoch:  77 val_f1:  0.7727225509205256 val_auroc:  0.8150466372115857 val_auprc:  0.8922633456445163
EarlyStopping counter: 17 out of 50
epoch:  77
epoch:  78 val_f1:  0.7727225509205256 val_auroc:  0.8166421207658322 val_auprc:  0.8938244743714077
EarlyStopping counter: 18 out of 50
epoch:  78
epoch:  79 val_f1:  0.7643829551743221 val_auroc:  0.8134511536573392 val_auprc:  0.888019890259043
EarlyStopping counter: 19 out of 50
epoch:  79
epoch:  80 val_f1:  0.7622262794246104 val_auroc:  0.8130829651448208 val_auprc:  0.8873495064787378
EarlyStopping counter: 20 out of 50
epoch:  80
epoch:  81 val_f1:  0.7622262794246104 val_auroc:  0.8132056946489936 val_auprc:  0.8900588809683498
EarlyStopping counter: 21 out of 50
epoch:  81
epoch:  82 val_f1:  0.7727225509205256 val_auroc:  0.812960235640648 val_auprc:  0.892280927017784
EarlyStopping counter: 22 out of 50
epoch:  82
epoch:  83 val_f1:  0.7809570525397864 val_auroc:  0.8151693667157586 val_auprc:  0.8932179820284655
EarlyStopping counter: 23 out of 50
epoch:  83
epoch:  84 val_f1:  0.7727225509205256 val_auroc:  0.8143102601865488 val_auprc:  0.8919070748056606
EarlyStopping counter: 24 out of 50
epoch:  84
epoch:  85 val_f1:  0.7707245329923307 val_auroc:  0.8162739322533137 val_auprc:  0.8939674767131244
EarlyStopping counter: 25 out of 50
epoch:  85
epoch:  86 val_f1:  0.7727225509205256 val_auroc:  0.8143102601865488 val_auprc:  0.8897027082529394
EarlyStopping counter: 26 out of 50
epoch:  86
epoch:  87 val_f1:  0.7809570525397864 val_auroc:  0.8145557191948944 val_auprc:  0.8947339436148622
EarlyStopping counter: 27 out of 50
epoch:  87
epoch:  88 val_f1:  0.7809570525397864 val_auroc:  0.8144329896907216 val_auprc:  0.8932557826371001
EarlyStopping counter: 28 out of 50
epoch:  88
epoch:  89 val_f1:  0.7809570525397864 val_auroc:  0.8152920962199313 val_auprc:  0.8926281918420956
EarlyStopping counter: 29 out of 50
epoch:  89
epoch:  90 val_f1:  0.7809570525397864 val_auroc:  0.8134511536573392 val_auprc:  0.8928866058793209
EarlyStopping counter: 30 out of 50
epoch:  90
epoch:  91 val_f1:  0.7727225509205256 val_auroc:  0.8127147766323023 val_auprc:  0.8902442548237349
EarlyStopping counter: 31 out of 50
epoch:  91
epoch:  92 val_f1:  0.7727225509205256 val_auroc:  0.8127147766323025 val_auprc:  0.8900204540162986
EarlyStopping counter: 32 out of 50
epoch:  92
epoch:  93 val_f1:  0.7809570525397864 val_auroc:  0.8140648011782032 val_auprc:  0.889929559224373
EarlyStopping counter: 33 out of 50
epoch:  93
epoch:  94 val_f1:  0.7622262794246104 val_auroc:  0.81480117820324 val_auprc:  0.8854814077324424
EarlyStopping counter: 34 out of 50
epoch:  94
epoch:  95 val_f1:  0.7791090204759269 val_auroc:  0.8124693176239569 val_auprc:  0.884720967437669
EarlyStopping counter: 35 out of 50
epoch:  95
epoch:  96 val_f1:  0.7643829551743221 val_auroc:  0.8129602356406481 val_auprc:  0.8844905728518127
EarlyStopping counter: 36 out of 50
epoch:  96
epoch:  97 val_f1:  0.7809570525397864 val_auroc:  0.8127147766323024 val_auprc:  0.8902523740435409
EarlyStopping counter: 37 out of 50
epoch:  97
epoch:  98 val_f1:  0.7809570525397864 val_auroc:  0.8122238586156112 val_auprc:  0.8904604134257234
EarlyStopping counter: 38 out of 50
epoch:  98
epoch:  99 val_f1:  0.7809570525397864 val_auroc:  0.81173294059892 val_auprc:  0.8900959855723729
EarlyStopping counter: 39 out of 50
epoch:  99
epoch:  100 val_f1:  0.7745465218349855 val_auroc:  0.8109965635738832 val_auprc:  0.8902601070777187
EarlyStopping counter: 40 out of 50
epoch:  100
epoch:  101 val_f1:  0.7809570525397864 val_auroc:  0.8121011291114384 val_auprc:  0.8914317460951329
EarlyStopping counter: 41 out of 50
epoch:  101
epoch:  102 val_f1:  0.7727225509205256 val_auroc:  0.8116102110947472 val_auprc:  0.8834188419619695
EarlyStopping counter: 42 out of 50
epoch:  102
epoch:  103 val_f1:  0.7809570525397864 val_auroc:  0.810505645557192 val_auprc:  0.8812140537262207
EarlyStopping counter: 43 out of 50
epoch:  103
epoch:  104 val_f1:  0.7809570525397864 val_auroc:  0.8118556701030928 val_auprc:  0.8850165922021745
EarlyStopping counter: 44 out of 50
epoch:  104
epoch:  105 val_f1:  0.7727225509205256 val_auroc:  0.8108738340697104 val_auprc:  0.8865933329377765
EarlyStopping counter: 45 out of 50
epoch:  105
epoch:  106 val_f1:  0.7809570525397864 val_auroc:  0.8118556701030929 val_auprc:  0.884808360714272
EarlyStopping counter: 46 out of 50
epoch:  106
epoch:  107 val_f1:  0.7727225509205256 val_auroc:  0.8121011291114385 val_auprc:  0.888053196284831
EarlyStopping counter: 47 out of 50
epoch:  107
epoch:  108 val_f1:  0.7727225509205256 val_auroc:  0.8114874815905744 val_auprc:  0.8890139411620623
EarlyStopping counter: 48 out of 50
epoch:  108
epoch:  109 val_f1:  0.7643829551743221 val_auroc:  0.812346588119784 val_auprc:  0.8890337620167412
EarlyStopping counter: 49 out of 50
epoch:  109
epoch:  110 val_f1:  0.7727225509205256 val_auroc:  0.8118556701030929 val_auprc:  0.8884720294912194
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1530.3755779266357
{'time_elapsed': [1530.3755779266357], 'epoch': [109], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7727225509205256], 'auroc_test': [0.8118556701030929], 'auprc_test': [0.8884720294912194]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1278]           3,072
│    └─BatchNorm1d: 2-2                  [64, 512, 1278]           1,024
│    └─Tanh: 2-3                         [64, 512, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1274]           --
│    └─Dropout: 2-5                      [64, 512, 1274]           --
│    └─Flatten: 2-6                      [64, 652288]              --
│    └─Linear: 2-7                       [64, 1]                   652,289
==========================================================================================
Total params: 656,385
Trainable params: 656,385
Non-trainable params: 0
Total mult-adds (M): 293.08
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 670.04
Params size (MB): 2.63
Estimated Total Size (MB): 672.99
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.4660827859451569 val_auroc:  0.6291114383897889 val_auprc:  0.7850120535367394
epoch:  1
epoch:  2 val_f1:  0.36157545511729794 val_auroc:  0.6219931271477663 val_auprc:  0.7750176460411587
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6324834410035322 val_auroc:  0.617820324005891 val_auprc:  0.8047150016474736
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.3828425981019695 val_auroc:  0.6269023073146786 val_auprc:  0.7792913059403596
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6690647482014388 val_auroc:  0.6421207658321061 val_auprc:  0.82534067671049
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6066521438942065 val_auroc:  0.6455571919489446 val_auprc:  0.7861941927783787
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.5846695524935984 val_auroc:  0.6729258713794796 val_auprc:  0.7992750397058472
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.7009452472327455 val_auroc:  0.6909671084928817 val_auprc:  0.8212368186008715
EarlyStopping counter: 7 out of 50
epoch:  8
epoch:  9 val_f1:  0.7018195933946583 val_auroc:  0.6983308787432498 val_auprc:  0.8038431978996271
Validation loss improved to 0.993682
epoch:  9
epoch:  10 val_f1:  0.7030919944895149 val_auroc:  0.7076583210603828 val_auprc:  0.8299477107917187
Validation loss improved to 0.889936
epoch:  10
epoch:  11 val_f1:  0.6172673191108796 val_auroc:  0.7236131566028473 val_auprc:  0.8396555780191619
Validation loss improved to 0.877600
epoch:  11
epoch:  12 val_f1:  0.6740890891918117 val_auroc:  0.7314678448699067 val_auprc:  0.8382432809029121
Validation loss improved to 0.840802
epoch:  12
epoch:  13 val_f1:  0.6740890891918117 val_auroc:  0.7307314678448699 val_auprc:  0.8399047895595443
Validation loss improved to 0.837116
epoch:  13
epoch:  14 val_f1:  0.6267262052427024 val_auroc:  0.7361315660284732 val_auprc:  0.8470808339501404
Validation loss improved to 0.756012
epoch:  14
epoch:  15 val_f1:  0.7002679453520968 val_auroc:  0.7469317623956799 val_auprc:  0.8589219615971034
Validation loss improved to 0.646794
epoch:  15
epoch:  16 val_f1:  0.6872202593435662 val_auroc:  0.750613647520864 val_auprc:  0.8637260106517759
Validation loss improved to 0.582332
epoch:  16
epoch:  17 val_f1:  0.679833276236154 val_auroc:  0.7457044673539519 val_auprc:  0.8608232846583403
Validation loss improved to 0.581650
epoch:  17
epoch:  18 val_f1:  0.7154369777720424 val_auroc:  0.7560137457044674 val_auprc:  0.8687398336431651
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.667134140788635 val_auroc:  0.759941089837997 val_auprc:  0.8747089380813038
Validation loss improved to 0.563497
epoch:  19
epoch:  20 val_f1:  0.6743799189283424 val_auroc:  0.7695139911634756 val_auprc:  0.8835155256928232
Validation loss improved to 0.531782
epoch:  20
epoch:  21 val_f1:  0.7208636520171812 val_auroc:  0.7628865979381443 val_auprc:  0.8774782507607022
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.6935516760810525 val_auroc:  0.7636229749631811 val_auprc:  0.876522801628454
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.6569672978309223 val_auroc:  0.7729504172803141 val_auprc:  0.8849990004943873
EarlyStopping counter: 3 out of 50
epoch:  23
epoch:  24 val_f1:  0.7044810154681304 val_auroc:  0.7729504172803142 val_auprc:  0.8847652958563341
Validation loss improved to 0.527873
epoch:  24
epoch:  25 val_f1:  0.6788382480828524 val_auroc:  0.7702503681885126 val_auprc:  0.8824202082784978
Validation loss improved to 0.509942
epoch:  25
epoch:  26 val_f1:  0.6937535685737124 val_auroc:  0.7641138929798724 val_auprc:  0.8807334573489294
Validation loss improved to 0.482877
epoch:  26
epoch:  27 val_f1:  0.7108600244444511 val_auroc:  0.7695139911634756 val_auprc:  0.8854872222774652
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7011215811505187 val_auroc:  0.7731958762886598 val_auprc:  0.890297582746655
Validation loss improved to 0.406678
epoch:  28
epoch:  29 val_f1:  0.7094198370570532 val_auroc:  0.7739322533136966 val_auprc:  0.8905407067090791
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.6737247039763566 val_auroc:  0.7744231713303878 val_auprc:  0.8900385728320859
EarlyStopping counter: 2 out of 50
epoch:  30
epoch:  31 val_f1:  0.6868550792725379 val_auroc:  0.7815414825724104 val_auprc:  0.8950278528138473
EarlyStopping counter: 3 out of 50
epoch:  31
epoch:  32 val_f1:  0.6810035515891084 val_auroc:  0.7731958762886597 val_auprc:  0.8892755469991462
EarlyStopping counter: 4 out of 50
epoch:  32
epoch:  33 val_f1:  0.7140775751491829 val_auroc:  0.7741777123220421 val_auprc:  0.8921271950849277
EarlyStopping counter: 5 out of 50
epoch:  33
epoch:  34 val_f1:  0.652687253151504 val_auroc:  0.7852233676975946 val_auprc:  0.8970490364453522
EarlyStopping counter: 6 out of 50
epoch:  34
epoch:  35 val_f1:  0.6720188084826255 val_auroc:  0.7825233186057928 val_auprc:  0.8921320412792816
EarlyStopping counter: 7 out of 50
epoch:  35
epoch:  36 val_f1:  0.6835594973158149 val_auroc:  0.7798232695139912 val_auprc:  0.8868644034525649
EarlyStopping counter: 8 out of 50
epoch:  36
epoch:  37 val_f1:  0.6926107129156205 val_auroc:  0.7938144329896908 val_auprc:  0.8979419152872519
EarlyStopping counter: 9 out of 50
epoch:  37
epoch:  38 val_f1:  0.7560320485424044 val_auroc:  0.7886597938144329 val_auprc:  0.893683104924352
EarlyStopping counter: 10 out of 50
epoch:  38
epoch:  39 val_f1:  0.7169009504644194 val_auroc:  0.7849779086892489 val_auprc:  0.8920022217686367
EarlyStopping counter: 11 out of 50
epoch:  39
epoch:  40 val_f1:  0.687028943170779 val_auroc:  0.7842415316642121 val_auprc:  0.8949302102898216
EarlyStopping counter: 12 out of 50
epoch:  40
epoch:  41 val_f1:  0.7375047745919104 val_auroc:  0.7825233186057928 val_auprc:  0.8943455014570394
EarlyStopping counter: 13 out of 50
epoch:  41
epoch:  42 val_f1:  0.7170452552783244 val_auroc:  0.7776141384388807 val_auprc:  0.8889455103005357
EarlyStopping counter: 14 out of 50
epoch:  42
epoch:  43 val_f1:  0.7157412825720284 val_auroc:  0.7641138929798723 val_auprc:  0.8776048566442595
EarlyStopping counter: 15 out of 50
epoch:  43
epoch:  44 val_f1:  0.7494347379239465 val_auroc:  0.7837506136475209 val_auprc:  0.8946521997562054
EarlyStopping counter: 16 out of 50
epoch:  44
epoch:  45 val_f1:  0.6997814539066421 val_auroc:  0.7555228276877761 val_auprc:  0.8707957379107507
EarlyStopping counter: 17 out of 50
epoch:  45
epoch:  46 val_f1:  0.7542604103291037 val_auroc:  0.7751595483554247 val_auprc:  0.8848712646735689
EarlyStopping counter: 18 out of 50
epoch:  46
epoch:  47 val_f1:  0.6967647049253406 val_auroc:  0.7646048109965635 val_auprc:  0.8799956739711805
EarlyStopping counter: 19 out of 50
epoch:  47
epoch:  48 val_f1:  0.7166299330477814 val_auroc:  0.7631320569464899 val_auprc:  0.8806478978957979
EarlyStopping counter: 20 out of 50
epoch:  48
epoch:  49 val_f1:  0.687028943170779 val_auroc:  0.7690230731467844 val_auprc:  0.8812244712632846
EarlyStopping counter: 21 out of 50
epoch:  49
epoch:  50 val_f1:  0.6813982824467933 val_auroc:  0.7643593519882179 val_auprc:  0.8781038901230894
EarlyStopping counter: 22 out of 50
epoch:  50
epoch:  51 val_f1:  0.748656020238754 val_auroc:  0.7741777123220421 val_auprc:  0.8845091442155011
EarlyStopping counter: 23 out of 50
epoch:  51
epoch:  52 val_f1:  0.7326256806616418 val_auroc:  0.7731958762886598 val_auprc:  0.8850547736623172
EarlyStopping counter: 24 out of 50
epoch:  52
epoch:  53 val_f1:  0.7144317414801258 val_auroc:  0.7793323514973 val_auprc:  0.8871040261173009
EarlyStopping counter: 25 out of 50
epoch:  53
epoch:  54 val_f1:  0.7362024088594293 val_auroc:  0.7771232204221895 val_auprc:  0.8888868454472558
EarlyStopping counter: 26 out of 50
epoch:  54
epoch:  55 val_f1:  0.748656020238754 val_auroc:  0.7697594501718212 val_auprc:  0.8833217241272373
EarlyStopping counter: 27 out of 50
epoch:  55
epoch:  56 val_f1:  0.7117994924448791 val_auroc:  0.7690230731467844 val_auprc:  0.8807029710580537
EarlyStopping counter: 28 out of 50
epoch:  56
epoch:  57 val_f1:  0.748656020238754 val_auroc:  0.7695139911634756 val_auprc:  0.8809324914721941
EarlyStopping counter: 29 out of 50
epoch:  57
epoch:  58 val_f1:  0.7015283467006299 val_auroc:  0.7621502209131075 val_auprc:  0.8747035140177264
EarlyStopping counter: 30 out of 50
epoch:  58
epoch:  59 val_f1:  0.7229061670449737 val_auroc:  0.7756504663721158 val_auprc:  0.8860638342924461
EarlyStopping counter: 31 out of 50
epoch:  59
epoch:  60 val_f1:  0.6966777045653197 val_auroc:  0.761168384879725 val_auprc:  0.8732806360491812
EarlyStopping counter: 32 out of 50
epoch:  60
epoch:  61 val_f1:  0.722058496910722 val_auroc:  0.7785959744722631 val_auprc:  0.887784766889872
EarlyStopping counter: 33 out of 50
epoch:  61
epoch:  62 val_f1:  0.6920377676353541 val_auroc:  0.7758959253804615 val_auprc:  0.8858107554027029
EarlyStopping counter: 34 out of 50
epoch:  62
epoch:  63 val_f1:  0.703263898025454 val_auroc:  0.7741777123220422 val_auprc:  0.8856983651394459
EarlyStopping counter: 35 out of 50
epoch:  63
epoch:  64 val_f1:  0.6977368320649064 val_auroc:  0.766813942071674 val_auprc:  0.879161014340487
EarlyStopping counter: 36 out of 50
epoch:  64
epoch:  65 val_f1:  0.7223183251151889 val_auroc:  0.7668139420716741 val_auprc:  0.8787862895855398
EarlyStopping counter: 37 out of 50
epoch:  65
epoch:  66 val_f1:  0.6835594973158149 val_auroc:  0.7675503190967108 val_auprc:  0.8793517667778297
EarlyStopping counter: 38 out of 50
epoch:  66
epoch:  67 val_f1:  0.7078050864958872 val_auroc:  0.7594501718213058 val_auprc:  0.8740894389069028
EarlyStopping counter: 39 out of 50
epoch:  67
epoch:  68 val_f1:  0.7079427367197151 val_auroc:  0.76313205694649 val_auprc:  0.8763759363935797
EarlyStopping counter: 40 out of 50
epoch:  68
epoch:  69 val_f1:  0.7162290583621869 val_auroc:  0.7643593519882179 val_auprc:  0.8764236707713108
EarlyStopping counter: 41 out of 50
epoch:  69
epoch:  70 val_f1:  0.6738044858231063 val_auroc:  0.7695139911634756 val_auprc:  0.8797506474681913
EarlyStopping counter: 42 out of 50
epoch:  70
epoch:  71 val_f1:  0.6682010713268466 val_auroc:  0.7729504172803142 val_auprc:  0.8798696999750923
EarlyStopping counter: 43 out of 50
epoch:  71
epoch:  72 val_f1:  0.69663104467882 val_auroc:  0.7709867452135493 val_auprc:  0.8756662591235267
EarlyStopping counter: 44 out of 50
epoch:  72
epoch:  73 val_f1:  0.7148475178521729 val_auroc:  0.7709867452135494 val_auprc:  0.8727838234130451
EarlyStopping counter: 45 out of 50
epoch:  73
epoch:  74 val_f1:  0.7229061670449737 val_auroc:  0.7776141384388807 val_auprc:  0.8818409363028645
EarlyStopping counter: 46 out of 50
epoch:  74
epoch:  75 val_f1:  0.7088095828755714 val_auroc:  0.7636229749631811 val_auprc:  0.8717338427472234
EarlyStopping counter: 47 out of 50
epoch:  75
epoch:  76 val_f1:  0.6638633353061484 val_auroc:  0.7714776632302406 val_auprc:  0.8805962131038649
EarlyStopping counter: 48 out of 50
epoch:  76
epoch:  77 val_f1:  0.7313689473952751 val_auroc:  0.7614138438880707 val_auprc:  0.8733791668755162
EarlyStopping counter: 49 out of 50
epoch:  77
epoch:  78 val_f1:  0.69663104467882 val_auroc:  0.7542955326460481 val_auprc:  0.8660775507971283
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1077.691554069519
{'time_elapsed': [1077.691554069519], 'epoch': [77], 'fold': [2], 'f1_train': [0.9963903272042809], 'auroc_train': [0.9999540117116842], 'auprc_train': [0.9999799084533625], 'f1_test': [0.69663104467882], 'auroc_test': [0.7542955326460481], 'auprc_test': [0.8660775507971283]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1278]           3,072
│    └─BatchNorm1d: 2-2                  [64, 512, 1278]           1,024
│    └─Tanh: 2-3                         [64, 512, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1274]           --
│    └─Dropout: 2-5                      [64, 512, 1274]           --
│    └─Flatten: 2-6                      [64, 652288]              --
│    └─Linear: 2-7                       [64, 1]                   652,289
==========================================================================================
Total params: 656,385
Trainable params: 656,385
Non-trainable params: 0
Total mult-adds (M): 293.08
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 670.04
Params size (MB): 2.63
Estimated Total Size (MB): 672.99
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.2721788877733486 val_auroc:  0.7364341085271318 val_auprc:  0.8837598409636606
epoch:  1
epoch:  2 val_f1:  0.6413017237216938 val_auroc:  0.7478197674418605 val_auprc:  0.8913690201330235
Validation loss improved to 0.456925
epoch:  2
epoch:  3 val_f1:  0.7093087305693341 val_auroc:  0.7950581395348837 val_auprc:  0.9118008055130689
Validation loss improved to 0.293086
epoch:  3
epoch:  4 val_f1:  0.672520725003466 val_auroc:  0.8104408914728684 val_auprc:  0.9051431927010886
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.7410071942446043 val_auroc:  0.8219476744186046 val_auprc:  0.8967814821574173
Validation loss improved to 0.260126
epoch:  5
epoch:  6 val_f1:  0.7081367817138694 val_auroc:  0.8296996124031008 val_auprc:  0.9194305828717462
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.7009065800999249 val_auroc:  0.8316375968992248 val_auprc:  0.9242437210888683
EarlyStopping counter: 2 out of 50
epoch:  7
epoch:  8 val_f1:  0.7628987147360764 val_auroc:  0.8301841085271318 val_auprc:  0.9233039894911159
Validation loss improved to 0.166719
epoch:  8
epoch:  9 val_f1:  0.73912321974171 val_auroc:  0.8234011627906976 val_auprc:  0.9217477674358512
Validation loss improved to 0.150954
epoch:  9
epoch:  10 val_f1:  0.7697841726618705 val_auroc:  0.8241279069767442 val_auprc:  0.9228639514994014
Validation loss improved to 0.143107
epoch:  10
epoch:  11 val_f1:  0.7562299212484351 val_auroc:  0.8301841085271318 val_auprc:  0.9260053636943009
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7002533928797167 val_auroc:  0.8347868217054264 val_auprc:  0.9275256239217423
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.7507862900729332 val_auroc:  0.8323643410852714 val_auprc:  0.9296054378861065
EarlyStopping counter: 3 out of 50
epoch:  13
epoch:  14 val_f1:  0.7714826564458221 val_auroc:  0.844718992248062 val_auprc:  0.9308409651044365
EarlyStopping counter: 4 out of 50
epoch:  14
epoch:  15 val_f1:  0.7438351169426486 val_auroc:  0.8393895348837209 val_auprc:  0.9320615963851315
EarlyStopping counter: 5 out of 50
epoch:  15
epoch:  16 val_f1:  0.7562299212484351 val_auroc:  0.8435077519379844 val_auprc:  0.9334547947294081
Validation loss improved to 0.126942
epoch:  16
epoch:  17 val_f1:  0.7548273393587915 val_auroc:  0.8468992248062015 val_auprc:  0.9322089754286071
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.7811523753969797 val_auroc:  0.8488372093023255 val_auprc:  0.934521017500602
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7932273763653603 val_auroc:  0.8570736434108527 val_auprc:  0.9387184428791304
EarlyStopping counter: 3 out of 50
epoch:  19
epoch:  20 val_f1:  0.7932273763653603 val_auroc:  0.8587693798449612 val_auprc:  0.9388035313723523
EarlyStopping counter: 4 out of 50
epoch:  20
epoch:  21 val_f1:  0.7972014141264308 val_auroc:  0.8565891472868218 val_auprc:  0.9363143568909467
EarlyStopping counter: 5 out of 50
epoch:  21
epoch:  22 val_f1:  0.7562473143424068 val_auroc:  0.8575581395348838 val_auprc:  0.939686641603447
EarlyStopping counter: 6 out of 50
epoch:  22
epoch:  23 val_f1:  0.7562473143424068 val_auroc:  0.8602228682170543 val_auprc:  0.9391175811018356
EarlyStopping counter: 7 out of 50
epoch:  23
epoch:  24 val_f1:  0.764639197732723 val_auroc:  0.8655523255813954 val_auprc:  0.942870016781219
EarlyStopping counter: 8 out of 50
epoch:  24
epoch:  25 val_f1:  0.7892012988311853 val_auroc:  0.8621608527131782 val_auprc:  0.9407456087657875
EarlyStopping counter: 9 out of 50
epoch:  25
epoch:  26 val_f1:  0.7746634573712671 val_auroc:  0.8679748062015504 val_auprc:  0.9439058901723546
EarlyStopping counter: 10 out of 50
epoch:  26
epoch:  27 val_f1:  0.7665182935781787 val_auroc:  0.8638565891472868 val_auprc:  0.9423336515880454
EarlyStopping counter: 11 out of 50
epoch:  27
epoch:  28 val_f1:  0.758275274873164 val_auroc:  0.8655523255813955 val_auprc:  0.9416513241805434
EarlyStopping counter: 12 out of 50
epoch:  28
epoch:  29 val_f1:  0.7746634573712671 val_auroc:  0.8633720930232557 val_auprc:  0.9433118704065513
EarlyStopping counter: 13 out of 50
epoch:  29
epoch:  30 val_f1:  0.7932273763653603 val_auroc:  0.8643410852713178 val_auprc:  0.9422314953654511
Validation loss improved to 0.115202
epoch:  30
epoch:  31 val_f1:  0.8008946034661633 val_auroc:  0.8653100775193798 val_auprc:  0.9441708474241717
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.8084949329130455 val_auroc:  0.8643410852713178 val_auprc:  0.9430072616903928
EarlyStopping counter: 2 out of 50
epoch:  32
epoch:  33 val_f1:  0.7968569383258559 val_auroc:  0.8638565891472869 val_auprc:  0.9423918964534992
Validation loss improved to 0.108656
epoch:  33
epoch:  34 val_f1:  0.7827158008497472 val_auroc:  0.8684593023255813 val_auprc:  0.9447985304743518
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.7682301875730638 val_auroc:  0.8679748062015504 val_auprc:  0.9445198118592387
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.764639197732723 val_auroc:  0.8689437984496123 val_auprc:  0.9446993446326887
EarlyStopping counter: 3 out of 50
epoch:  36
epoch:  37 val_f1:  0.7997900244397783 val_auroc:  0.8672480620155039 val_auprc:  0.944292058450107
EarlyStopping counter: 4 out of 50
epoch:  37
epoch:  38 val_f1:  0.7841726618705036 val_auroc:  0.8672480620155039 val_auprc:  0.9449846697258941
EarlyStopping counter: 5 out of 50
epoch:  38
epoch:  39 val_f1:  0.8018807955038493 val_auroc:  0.8670058139534884 val_auprc:  0.9455166526380145
EarlyStopping counter: 6 out of 50
epoch:  39
epoch:  40 val_f1:  0.7841726618705036 val_auroc:  0.8684593023255813 val_auprc:  0.944188492864968
EarlyStopping counter: 7 out of 50
epoch:  40
epoch:  41 val_f1:  0.7601256159113488 val_auroc:  0.8657945736434107 val_auprc:  0.9438760474747065
EarlyStopping counter: 8 out of 50
epoch:  41
epoch:  42 val_f1:  0.8018807955038493 val_auroc:  0.8633720930232558 val_auprc:  0.9441963107060644
EarlyStopping counter: 9 out of 50
epoch:  42
epoch:  43 val_f1:  0.8008946034661633 val_auroc:  0.8679748062015503 val_auprc:  0.9449341903232402
EarlyStopping counter: 10 out of 50
epoch:  43
epoch:  44 val_f1:  0.8008946034661633 val_auroc:  0.8687015503875969 val_auprc:  0.9462189180532794
EarlyStopping counter: 11 out of 50
epoch:  44
epoch:  45 val_f1:  0.792019787311512 val_auroc:  0.8674903100775193 val_auprc:  0.9454965829505286
EarlyStopping counter: 12 out of 50
epoch:  45
epoch:  46 val_f1:  0.7710202043822609 val_auroc:  0.8716085271317829 val_auprc:  0.945660677643093
EarlyStopping counter: 13 out of 50
epoch:  46
epoch:  47 val_f1:  0.768937708914086 val_auroc:  0.8708817829457364 val_auprc:  0.9454759388575241
EarlyStopping counter: 14 out of 50
epoch:  47
epoch:  48 val_f1:  0.7857930944221151 val_auroc:  0.8694282945736433 val_auprc:  0.9444460074704585
EarlyStopping counter: 15 out of 50
epoch:  48
epoch:  49 val_f1:  0.776244301724119 val_auroc:  0.8665213178294574 val_auprc:  0.9444766491961234
EarlyStopping counter: 16 out of 50
epoch:  49
epoch:  50 val_f1:  0.7866727894280321 val_auroc:  0.866763565891473 val_auprc:  0.9447168502718091
EarlyStopping counter: 17 out of 50
epoch:  50
epoch:  51 val_f1:  0.7854893118997625 val_auroc:  0.8679748062015504 val_auprc:  0.9451880670656632
EarlyStopping counter: 18 out of 50
epoch:  51
epoch:  52 val_f1:  0.8018807955038493 val_auroc:  0.8645833333333333 val_auprc:  0.9443179079146811
EarlyStopping counter: 19 out of 50
epoch:  52
epoch:  53 val_f1:  0.7906801532257888 val_auroc:  0.8677325581395349 val_auprc:  0.944585582693037
EarlyStopping counter: 20 out of 50
epoch:  53
epoch:  54 val_f1:  0.7841726618705036 val_auroc:  0.8665213178294573 val_auprc:  0.9444533819943071
EarlyStopping counter: 21 out of 50
epoch:  54
epoch:  55 val_f1:  0.7789671954250403 val_auroc:  0.8665213178294574 val_auprc:  0.9448352684416172
EarlyStopping counter: 22 out of 50
epoch:  55
epoch:  56 val_f1:  0.7801238118631262 val_auroc:  0.8660368217054265 val_auprc:  0.9448883085906014
EarlyStopping counter: 23 out of 50
epoch:  56
epoch:  57 val_f1:  0.8175531003768415 val_auroc:  0.8687015503875969 val_auprc:  0.9455777535871311
Validation loss improved to 0.103561
epoch:  57
epoch:  58 val_f1:  0.7789671954250403 val_auroc:  0.8679748062015504 val_auprc:  0.9455915362325329
EarlyStopping counter: 1 out of 50
epoch:  58
epoch:  59 val_f1:  0.7906801532257888 val_auroc:  0.8670058139534884 val_auprc:  0.9449929583510883
EarlyStopping counter: 2 out of 50
epoch:  59
epoch:  60 val_f1:  0.7603368061152953 val_auroc:  0.8699127906976745 val_auprc:  0.9455712109654191
EarlyStopping counter: 3 out of 50
epoch:  60
epoch:  61 val_f1:  0.7746634573712671 val_auroc:  0.8670058139534884 val_auprc:  0.9447915490939609
EarlyStopping counter: 4 out of 50
epoch:  61
epoch:  62 val_f1:  0.7841726618705036 val_auroc:  0.8679748062015504 val_auprc:  0.9444739468288854
EarlyStopping counter: 5 out of 50
epoch:  62
epoch:  63 val_f1:  0.794309372388086 val_auroc:  0.8655523255813954 val_auprc:  0.9439053708529844
EarlyStopping counter: 6 out of 50
epoch:  63
epoch:  64 val_f1:  0.7940592980161325 val_auroc:  0.8687015503875969 val_auprc:  0.9448281517953989
EarlyStopping counter: 7 out of 50
epoch:  64
epoch:  65 val_f1:  0.7827158008497472 val_auroc:  0.8682170542635659 val_auprc:  0.9446483630266237
EarlyStopping counter: 8 out of 50
epoch:  65
epoch:  66 val_f1:  0.7892012988311853 val_auroc:  0.8672480620155039 val_auprc:  0.944614870350947
EarlyStopping counter: 9 out of 50
epoch:  66
epoch:  67 val_f1:  0.7841726618705036 val_auroc:  0.8633720930232558 val_auprc:  0.9430908219012138
EarlyStopping counter: 10 out of 50
epoch:  67
epoch:  68 val_f1:  0.7625825493451395 val_auroc:  0.8674903100775194 val_auprc:  0.9443471371908643
EarlyStopping counter: 11 out of 50
epoch:  68
epoch:  69 val_f1:  0.7710202043822609 val_auroc:  0.8657945736434108 val_auprc:  0.9436140203294605
EarlyStopping counter: 12 out of 50
epoch:  69
epoch:  70 val_f1:  0.7841726618705036 val_auroc:  0.8672480620155039 val_auprc:  0.9443136638740914
EarlyStopping counter: 13 out of 50
epoch:  70
epoch:  71 val_f1:  0.7746634573712671 val_auroc:  0.8650678294573644 val_auprc:  0.9433914431009066
EarlyStopping counter: 14 out of 50
epoch:  71
epoch:  72 val_f1:  0.7854893118997625 val_auroc:  0.8648255813953489 val_auprc:  0.9439322662260943
EarlyStopping counter: 15 out of 50
epoch:  72
epoch:  73 val_f1:  0.7710202043822609 val_auroc:  0.867732558139535 val_auprc:  0.944373781641376
EarlyStopping counter: 16 out of 50
epoch:  73
epoch:  74 val_f1:  0.7841726618705036 val_auroc:  0.8650678294573644 val_auprc:  0.9434073991939704
EarlyStopping counter: 17 out of 50
epoch:  74
epoch:  75 val_f1:  0.7841726618705036 val_auroc:  0.8650678294573644 val_auprc:  0.943629731183923
EarlyStopping counter: 18 out of 50
epoch:  75
epoch:  76 val_f1:  0.7892012988311853 val_auroc:  0.8660368217054264 val_auprc:  0.943911464965495
EarlyStopping counter: 19 out of 50
epoch:  76
epoch:  77 val_f1:  0.7892012988311853 val_auroc:  0.8665213178294574 val_auprc:  0.9434140726681328
EarlyStopping counter: 20 out of 50
epoch:  77
epoch:  78 val_f1:  0.7841726618705036 val_auroc:  0.867732558139535 val_auprc:  0.944429528845656
EarlyStopping counter: 21 out of 50
epoch:  78
epoch:  79 val_f1:  0.7811109002295425 val_auroc:  0.8660368217054264 val_auprc:  0.9435884225259661
EarlyStopping counter: 22 out of 50
epoch:  79
epoch:  80 val_f1:  0.7682301875730638 val_auroc:  0.8670058139534885 val_auprc:  0.9441756382179016
EarlyStopping counter: 23 out of 50
epoch:  80
epoch:  81 val_f1:  0.7811109002295425 val_auroc:  0.8662790697674418 val_auprc:  0.9433775985571843
EarlyStopping counter: 24 out of 50
epoch:  81
epoch:  82 val_f1:  0.7841726618705036 val_auroc:  0.8674903100775194 val_auprc:  0.9440711859435175
EarlyStopping counter: 25 out of 50
epoch:  82
epoch:  83 val_f1:  0.7827158008497472 val_auroc:  0.8655523255813954 val_auprc:  0.9432873750361872
EarlyStopping counter: 26 out of 50
epoch:  83
epoch:  84 val_f1:  0.7811109002295425 val_auroc:  0.8667635658914729 val_auprc:  0.9436034804109106
EarlyStopping counter: 27 out of 50
epoch:  84
epoch:  85 val_f1:  0.7746634573712671 val_auroc:  0.8674903100775193 val_auprc:  0.9441366706512511
EarlyStopping counter: 28 out of 50
epoch:  85
epoch:  86 val_f1:  0.7746634573712671 val_auroc:  0.8674903100775194 val_auprc:  0.9441117759766566
EarlyStopping counter: 29 out of 50
epoch:  86
epoch:  87 val_f1:  0.7746634573712671 val_auroc:  0.8670058139534884 val_auprc:  0.9438798609357807
EarlyStopping counter: 30 out of 50
epoch:  87
epoch:  88 val_f1:  0.7793492478744277 val_auroc:  0.865794573643411 val_auprc:  0.9425699220647035
EarlyStopping counter: 31 out of 50
epoch:  88
epoch:  89 val_f1:  0.7776763243674784 val_auroc:  0.8674903100775194 val_auprc:  0.9439442560802136
EarlyStopping counter: 32 out of 50
epoch:  89
epoch:  90 val_f1:  0.7827158008497472 val_auroc:  0.867248062015504 val_auprc:  0.9437652447579445
EarlyStopping counter: 33 out of 50
epoch:  90
epoch:  91 val_f1:  0.7746634573712671 val_auroc:  0.8670058139534884 val_auprc:  0.9437545502733304
EarlyStopping counter: 34 out of 50
epoch:  91
epoch:  92 val_f1:  0.7811109002295425 val_auroc:  0.8667635658914729 val_auprc:  0.9435288857854854
EarlyStopping counter: 35 out of 50
epoch:  92
epoch:  93 val_f1:  0.7776763243674784 val_auroc:  0.8660368217054265 val_auprc:  0.943509840384484
EarlyStopping counter: 36 out of 50
epoch:  93
epoch:  94 val_f1:  0.7811109002295425 val_auroc:  0.8657945736434108 val_auprc:  0.9431797265314823
EarlyStopping counter: 37 out of 50
epoch:  94
epoch:  95 val_f1:  0.7811109002295425 val_auroc:  0.8667635658914729 val_auprc:  0.9434252303597843
EarlyStopping counter: 38 out of 50
epoch:  95
epoch:  96 val_f1:  0.7746634573712671 val_auroc:  0.8672480620155039 val_auprc:  0.9437711640573532
EarlyStopping counter: 39 out of 50
epoch:  96
epoch:  97 val_f1:  0.7729252582141845 val_auroc:  0.8660368217054264 val_auprc:  0.9429244634517354
EarlyStopping counter: 40 out of 50
epoch:  97
epoch:  98 val_f1:  0.7746634573712671 val_auroc:  0.8638565891472869 val_auprc:  0.94243738306452
EarlyStopping counter: 41 out of 50
epoch:  98
epoch:  99 val_f1:  0.7811109002295425 val_auroc:  0.8660368217054264 val_auprc:  0.9430389187577006
EarlyStopping counter: 42 out of 50
epoch:  99
epoch:  100 val_f1:  0.7746634573712671 val_auroc:  0.8657945736434108 val_auprc:  0.9431858339459809
EarlyStopping counter: 43 out of 50
epoch:  100
epoch:  101 val_f1:  0.7746634573712671 val_auroc:  0.8655523255813953 val_auprc:  0.9428517267435139
EarlyStopping counter: 44 out of 50
epoch:  101
epoch:  102 val_f1:  0.7827158008497472 val_auroc:  0.8645833333333334 val_auprc:  0.9427668078678166
EarlyStopping counter: 45 out of 50
epoch:  102
epoch:  103 val_f1:  0.7746634573712671 val_auroc:  0.8660368217054263 val_auprc:  0.9431894568541236
EarlyStopping counter: 46 out of 50
epoch:  103
epoch:  104 val_f1:  0.7811109002295425 val_auroc:  0.8657945736434108 val_auprc:  0.9431387041151945
EarlyStopping counter: 47 out of 50
epoch:  104
epoch:  105 val_f1:  0.7746634573712671 val_auroc:  0.8667635658914729 val_auprc:  0.9434934237131675
EarlyStopping counter: 48 out of 50
epoch:  105
epoch:  106 val_f1:  0.7827158008497472 val_auroc:  0.8660368217054264 val_auprc:  0.943006099874194
EarlyStopping counter: 49 out of 50
epoch:  106
epoch:  107 val_f1:  0.7746634573712671 val_auroc:  0.8657945736434108 val_auprc:  0.9429258232731597
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1469.3347477912903
{'time_elapsed': [1469.3347477912903], 'epoch': [106], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7746634573712671], 'auroc_test': [0.8657945736434108], 'auprc_test': [0.9429258232731597]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1278]           3,072
│    └─BatchNorm1d: 2-2                  [64, 512, 1278]           1,024
│    └─Tanh: 2-3                         [64, 512, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1274]           --
│    └─Dropout: 2-5                      [64, 512, 1274]           --
│    └─Flatten: 2-6                      [64, 652288]              --
│    └─Linear: 2-7                       [64, 1]                   652,289
==========================================================================================
Total params: 656,385
Trainable params: 656,385
Non-trainable params: 0
Total mult-adds (M): 293.08
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 670.04
Params size (MB): 2.63
Estimated Total Size (MB): 672.99
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5241123379300866 val_auroc:  0.7574404761904763 val_auprc:  0.879974946428532
epoch:  1
epoch:  2 val_f1:  0.6508468909020615 val_auroc:  0.6263640873015872 val_auprc:  0.852406157238371
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6802856368073759 val_auroc:  0.7088293650793651 val_auprc:  0.8529031219423321
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.7185990338164251 val_auroc:  0.7440476190476191 val_auprc:  0.8759231762744073
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.7513332730724035 val_auroc:  0.7800099206349207 val_auprc:  0.8976647455892013
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.7695918258740887 val_auroc:  0.8129960317460319 val_auprc:  0.9134900559201384
Validation loss improved to 0.578687
epoch:  6
epoch:  7 val_f1:  0.7214688992906433 val_auroc:  0.824156746031746 val_auprc:  0.9028219730284706
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.7616502189311872 val_auroc:  0.8194444444444445 val_auprc:  0.9082695808226476
Validation loss improved to 0.320716
epoch:  8
epoch:  9 val_f1:  0.7605491990846683 val_auroc:  0.8346974206349206 val_auprc:  0.9174816563706834
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7697938448700337 val_auroc:  0.8405257936507936 val_auprc:  0.9220873807951682
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.7627107192324585 val_auroc:  0.8442460317460317 val_auprc:  0.9231532440273845
EarlyStopping counter: 3 out of 50
epoch:  11
epoch:  12 val_f1:  0.7748792270531402 val_auroc:  0.8452380952380951 val_auprc:  0.9234283880215305
EarlyStopping counter: 4 out of 50
epoch:  12
epoch:  13 val_f1:  0.7682566483748418 val_auroc:  0.845486111111111 val_auprc:  0.9221741682022051
EarlyStopping counter: 5 out of 50
epoch:  13
epoch:  14 val_f1:  0.8138718358422335 val_auroc:  0.8534226190476191 val_auprc:  0.926697834157801
EarlyStopping counter: 6 out of 50
epoch:  14
epoch:  15 val_f1:  0.6046527563641347 val_auroc:  0.8531746031746031 val_auprc:  0.9273593226576623
EarlyStopping counter: 7 out of 50
epoch:  15
epoch:  16 val_f1:  0.7772795841859215 val_auroc:  0.8554067460317459 val_auprc:  0.9298735693306716
EarlyStopping counter: 8 out of 50
epoch:  16
epoch:  17 val_f1:  0.7355647573038877 val_auroc:  0.8625992063492063 val_auprc:  0.9318899340098148
EarlyStopping counter: 9 out of 50
epoch:  17
epoch:  18 val_f1:  0.7211394302848576 val_auroc:  0.8578869047619048 val_auprc:  0.9284227717247885
EarlyStopping counter: 10 out of 50
epoch:  18
epoch:  19 val_f1:  0.8248625247346153 val_auroc:  0.8598710317460317 val_auprc:  0.9313756784314868
EarlyStopping counter: 11 out of 50
epoch:  19
epoch:  20 val_f1:  0.7884143290944841 val_auroc:  0.8603670634920635 val_auprc:  0.9304661028706035
EarlyStopping counter: 12 out of 50
epoch:  20
epoch:  21 val_f1:  0.7797158172381521 val_auroc:  0.859375 val_auprc:  0.9290827280733076
EarlyStopping counter: 13 out of 50
epoch:  21
epoch:  22 val_f1:  0.8081713820844254 val_auroc:  0.859375 val_auprc:  0.9294088037504431
EarlyStopping counter: 14 out of 50
epoch:  22
epoch:  23 val_f1:  0.7425627404942808 val_auroc:  0.8648313492063492 val_auprc:  0.9328791821691937
EarlyStopping counter: 15 out of 50
epoch:  23
epoch:  24 val_f1:  0.8061683443992288 val_auroc:  0.8608630952380952 val_auprc:  0.927783717683163
EarlyStopping counter: 16 out of 50
epoch:  24
epoch:  25 val_f1:  0.8030193236714975 val_auroc:  0.8623511904761905 val_auprc:  0.9308837945161621
EarlyStopping counter: 17 out of 50
epoch:  25
epoch:  26 val_f1:  0.8215074100875418 val_auroc:  0.8658234126984127 val_auprc:  0.9328646186074172
EarlyStopping counter: 18 out of 50
epoch:  26
epoch:  27 val_f1:  0.8168793096329329 val_auroc:  0.8563988095238095 val_auprc:  0.9264807242333806
EarlyStopping counter: 19 out of 50
epoch:  27
epoch:  28 val_f1:  0.7949078298424175 val_auroc:  0.8623511904761905 val_auprc:  0.9307363894255911
EarlyStopping counter: 20 out of 50
epoch:  28
epoch:  29 val_f1:  0.8115942028985508 val_auroc:  0.8640873015873015 val_auprc:  0.931084405742515
EarlyStopping counter: 21 out of 50
epoch:  29
epoch:  30 val_f1:  0.8061683443992288 val_auroc:  0.8650793650793651 val_auprc:  0.9333096545967399
EarlyStopping counter: 22 out of 50
epoch:  30
epoch:  31 val_f1:  0.7995542847531747 val_auroc:  0.8628472222222222 val_auprc:  0.9265360119337203
EarlyStopping counter: 23 out of 50
epoch:  31
epoch:  32 val_f1:  0.8327610961982647 val_auroc:  0.8683035714285714 val_auprc:  0.933295377019407
EarlyStopping counter: 24 out of 50
epoch:  32
epoch:  33 val_f1:  0.7746271791640412 val_auroc:  0.8678075396825397 val_auprc:  0.9313372931244185
EarlyStopping counter: 25 out of 50
epoch:  33
epoch:  34 val_f1:  0.7926396128627546 val_auroc:  0.861111111111111 val_auprc:  0.9294818172136662
EarlyStopping counter: 26 out of 50
epoch:  34
epoch:  35 val_f1:  0.7949078298424175 val_auroc:  0.8628472222222221 val_auprc:  0.9274111976929005
EarlyStopping counter: 27 out of 50
epoch:  35
epoch:  36 val_f1:  0.7881997743237336 val_auroc:  0.867063492063492 val_auprc:  0.92838862605872
EarlyStopping counter: 28 out of 50
epoch:  36
epoch:  37 val_f1:  0.833877425315676 val_auroc:  0.8685515873015872 val_auprc:  0.9329809468657786
EarlyStopping counter: 29 out of 50
epoch:  37
epoch:  38 val_f1:  0.7588956111566858 val_auroc:  0.8658234126984128 val_auprc:  0.9276722831054743
EarlyStopping counter: 30 out of 50
epoch:  38
epoch:  39 val_f1:  0.740709548373513 val_auroc:  0.8596230158730159 val_auprc:  0.9212795108270877
EarlyStopping counter: 31 out of 50
epoch:  39
epoch:  40 val_f1:  0.7651901748656188 val_auroc:  0.8658234126984127 val_auprc:  0.9257693522614019
EarlyStopping counter: 32 out of 50
epoch:  40
epoch:  41 val_f1:  0.795635738397158 val_auroc:  0.8645833333333334 val_auprc:  0.9249014442960595
EarlyStopping counter: 33 out of 50
epoch:  41
epoch:  42 val_f1:  0.8022296544035674 val_auroc:  0.8700396825396826 val_auprc:  0.9299436072224437
EarlyStopping counter: 34 out of 50
epoch:  42
epoch:  43 val_f1:  0.7861608411480533 val_auroc:  0.8754960317460316 val_auprc:  0.9334347153004142
EarlyStopping counter: 35 out of 50
epoch:  43
epoch:  44 val_f1:  0.8154066640778435 val_auroc:  0.8727678571428571 val_auprc:  0.9313208619883063
EarlyStopping counter: 36 out of 50
epoch:  44
epoch:  45 val_f1:  0.7979659293160437 val_auroc:  0.8675595238095238 val_auprc:  0.9247059961624517
EarlyStopping counter: 37 out of 50
epoch:  45
epoch:  46 val_f1:  0.7717414591283235 val_auroc:  0.861111111111111 val_auprc:  0.9207038899160904
EarlyStopping counter: 38 out of 50
epoch:  46
epoch:  47 val_f1:  0.8127933585226971 val_auroc:  0.8625992063492064 val_auprc:  0.9198136235603593
EarlyStopping counter: 39 out of 50
epoch:  47
epoch:  48 val_f1:  0.807228002894545 val_auroc:  0.8680555555555556 val_auprc:  0.925600625138236
EarlyStopping counter: 40 out of 50
epoch:  48
epoch:  49 val_f1:  0.8014350667803353 val_auroc:  0.8685515873015873 val_auprc:  0.9236846886025845
EarlyStopping counter: 41 out of 50
epoch:  49
epoch:  50 val_f1:  0.8115942028985508 val_auroc:  0.8655753968253969 val_auprc:  0.9180894837178666
EarlyStopping counter: 42 out of 50
epoch:  50
epoch:  51 val_f1:  0.8154066640778435 val_auroc:  0.8715277777777778 val_auprc:  0.9249560328660636
EarlyStopping counter: 43 out of 50
epoch:  51
epoch:  52 val_f1:  0.8182185828242006 val_auroc:  0.8700396825396826 val_auprc:  0.9251300372957543
EarlyStopping counter: 44 out of 50
epoch:  52
epoch:  53 val_f1:  0.8137922815659323 val_auroc:  0.8675595238095238 val_auprc:  0.9222351572676164
EarlyStopping counter: 45 out of 50
epoch:  53
epoch:  54 val_f1:  0.8097298254042504 val_auroc:  0.8683035714285715 val_auprc:  0.9255638462380175
EarlyStopping counter: 46 out of 50
epoch:  54
epoch:  55 val_f1:  0.7837062051498522 val_auroc:  0.8655753968253969 val_auprc:  0.9195841189651214
EarlyStopping counter: 47 out of 50
epoch:  55
epoch:  56 val_f1:  0.8115942028985508 val_auroc:  0.8687996031746031 val_auprc:  0.9219841778297597
EarlyStopping counter: 48 out of 50
epoch:  56
epoch:  57 val_f1:  0.7861608411480533 val_auroc:  0.8638392857142857 val_auprc:  0.9143006822399967
EarlyStopping counter: 49 out of 50
epoch:  57
epoch:  58 val_f1:  0.8072024593763724 val_auroc:  0.8656994047619048 val_auprc:  0.9211581974971235
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  795.7249937057495
{'time_elapsed': [795.7249937057495], 'epoch': [57], 'fold': [4], 'f1_train': [0.9928291406519352], 'auroc_train': [0.9999235509074508], 'auprc_train': [0.9999667091485395], 'f1_test': [0.8072024593763724], 'auroc_test': [0.8656994047619048], 'auprc_test': [0.9211581974971235]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1278]           3,072
│    └─BatchNorm1d: 2-2                  [64, 512, 1278]           1,024
│    └─Tanh: 2-3                         [64, 512, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1274]           --
│    └─Dropout: 2-5                      [64, 512, 1274]           --
│    └─Flatten: 2-6                      [64, 652288]              --
│    └─Linear: 2-7                       [64, 1]                   652,289
==========================================================================================
Total params: 656,385
Trainable params: 656,385
Non-trainable params: 0
Total mult-adds (M): 293.08
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 670.04
Params size (MB): 2.63
Estimated Total Size (MB): 672.99
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_37', 'config': {'hidden_channels': [512], 'epochs': 500, 'kernel_size': 5, 'pool_kernel_size': 5, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6134480650773498 val_auroc:  0.6408934707903781 val_auprc:  0.7748342830427418
epoch:  1
epoch:  2 val_f1:  0.5512847967804356 val_auroc:  0.541728031418753 val_auprc:  0.6977486921621239
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.558290716824131 val_auroc:  0.5441826215022091 val_auprc:  0.7017029403323538
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5496743559647288 val_auroc:  0.5672557682866961 val_auprc:  0.7184215791713575
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6112456551612643 val_auroc:  0.5994108983799705 val_auprc:  0.7449233345088329
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.5846695524935984 val_auroc:  0.6566028473244968 val_auprc:  0.7894197393952003
Validation loss improved to 1.292420
epoch:  6
epoch:  7 val_f1:  0.575871059068063 val_auroc:  0.7108492881688758 val_auprc:  0.8381483967645857
Validation loss improved to 1.227553
epoch:  7
epoch:  8 val_f1:  0.7162290583621869 val_auroc:  0.7349042709867453 val_auprc:  0.8579067315747368
Validation loss improved to 1.225025
epoch:  8
epoch:  9 val_f1:  0.7100860488080124 val_auroc:  0.7552773686794305 val_auprc:  0.8741429937144138
Validation loss improved to 1.185022
epoch:  9
epoch:  10 val_f1:  0.6213039568345323 val_auroc:  0.7680412371134021 val_auprc:  0.8829456080220857
Validation loss improved to 1.154287
epoch:  10
epoch:  11 val_f1:  0.7607703458551531 val_auroc:  0.76313205694649 val_auprc:  0.878882691084508
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7371937993371881 val_auroc:  0.773686794305351 val_auprc:  0.8866894404414877
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.7371937993371881 val_auroc:  0.7783505154639174 val_auprc:  0.8894399193255764
Validation loss improved to 1.145915
epoch:  13
epoch:  14 val_f1:  0.7560320485424044 val_auroc:  0.7754050073637703 val_auprc:  0.8873498126164164
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.743914028278071 val_auroc:  0.7783505154639175 val_auprc:  0.8892663062101815
EarlyStopping counter: 2 out of 50
epoch:  15
epoch:  16 val_f1:  0.7573003855683703 val_auroc:  0.7815414825724104 val_auprc:  0.8921570584499179
EarlyStopping counter: 3 out of 50
epoch:  16
epoch:  17 val_f1:  0.6598406488264144 val_auroc:  0.7918507609229258 val_auprc:  0.8992405580145071
Validation loss improved to 1.113514
epoch:  17
epoch:  18 val_f1:  0.6524974219867484 val_auroc:  0.7935689739813451 val_auprc:  0.9016472142176954
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.76000113614692 val_auroc:  0.7844869906725577 val_auprc:  0.894711187879357
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.743914028278071 val_auroc:  0.7901325478645066 val_auprc:  0.8986842716113898
EarlyStopping counter: 3 out of 50
epoch:  20
epoch:  21 val_f1:  0.72389147505525 val_auroc:  0.7935689739813452 val_auprc:  0.9005510667911011
EarlyStopping counter: 4 out of 50
epoch:  21
epoch:  22 val_f1:  0.7510257046352308 val_auroc:  0.7974963181148749 val_auprc:  0.904341443030281
EarlyStopping counter: 5 out of 50
epoch:  22
epoch:  23 val_f1:  0.7510257046352308 val_auroc:  0.7984781541482572 val_auprc:  0.9049260242821511
EarlyStopping counter: 6 out of 50
epoch:  23
epoch:  24 val_f1:  0.7477455593342162 val_auroc:  0.7950417280314187 val_auprc:  0.9029970584007545
EarlyStopping counter: 7 out of 50
epoch:  24
epoch:  25 val_f1:  0.7307106601978622 val_auroc:  0.8043691703485518 val_auprc:  0.9090926068833791
Validation loss improved to 1.110802
epoch:  25
epoch:  26 val_f1:  0.7762067639678805 val_auroc:  0.796759941089838 val_auprc:  0.904002709859725
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7330561760022478 val_auroc:  0.7940598919980363 val_auprc:  0.9004790539019599
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7170655771870609 val_auroc:  0.8109965635738832 val_auprc:  0.9133096992012943
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.682026026688228 val_auroc:  0.810505645557192 val_auprc:  0.9131480328443682
EarlyStopping counter: 4 out of 50
epoch:  29
epoch:  30 val_f1:  0.696151679426677 val_auroc:  0.8068237604320079 val_auprc:  0.9101510393128672
EarlyStopping counter: 5 out of 50
epoch:  30
epoch:  31 val_f1:  0.7531731915989216 val_auroc:  0.8051055473735886 val_auprc:  0.9092225615503939
EarlyStopping counter: 6 out of 50
epoch:  31
epoch:  32 val_f1:  0.7371937993371881 val_auroc:  0.8136966126656848 val_auprc:  0.9159962854048245
EarlyStopping counter: 7 out of 50
epoch:  32
epoch:  33 val_f1:  0.7375047745919104 val_auroc:  0.814187530682376 val_auprc:  0.9167826012203408
EarlyStopping counter: 8 out of 50
epoch:  33
epoch:  34 val_f1:  0.7428255465713769 val_auroc:  0.8109965635738832 val_auprc:  0.9146058931814114
EarlyStopping counter: 9 out of 50
epoch:  34
epoch:  35 val_f1:  0.7308479257525525 val_auroc:  0.8159057437407953 val_auprc:  0.918074149157608
EarlyStopping counter: 10 out of 50
epoch:  35
epoch:  36 val_f1:  0.7402181480621955 val_auroc:  0.81173294059892 val_auprc:  0.915618367387775
EarlyStopping counter: 11 out of 50
epoch:  36
epoch:  37 val_f1:  0.7272357092755477 val_auroc:  0.8109965635738832 val_auprc:  0.9146371117030104
EarlyStopping counter: 12 out of 50
epoch:  37
epoch:  38 val_f1:  0.743431836172277 val_auroc:  0.8112420225822288 val_auprc:  0.9153559051513568
EarlyStopping counter: 13 out of 50
epoch:  38
epoch:  39 val_f1:  0.7791090204759269 val_auroc:  0.7999509081983308 val_auprc:  0.9067546155831266
EarlyStopping counter: 14 out of 50
epoch:  39
epoch:  40 val_f1:  0.7442757932382417 val_auroc:  0.8168875797741777 val_auprc:  0.9178571641706406
EarlyStopping counter: 15 out of 50
epoch:  40
epoch:  41 val_f1:  0.7577565132360132 val_auroc:  0.8183603338242513 val_auprc:  0.9198248399426977
EarlyStopping counter: 16 out of 50
epoch:  41
epoch:  42 val_f1:  0.7577565132360132 val_auroc:  0.819833087874325 val_auprc:  0.9205305849990015
EarlyStopping counter: 17 out of 50
epoch:  42
epoch:  43 val_f1:  0.7442757932382417 val_auroc:  0.8186057928325969 val_auprc:  0.9195004387937666
EarlyStopping counter: 18 out of 50
epoch:  43
epoch:  44 val_f1:  0.7420910227448273 val_auroc:  0.8168875797741777 val_auprc:  0.9183438792014974
EarlyStopping counter: 19 out of 50
epoch:  44
epoch:  45 val_f1:  0.7569659388768054 val_auroc:  0.8134511536573392 val_auprc:  0.915039134136967
EarlyStopping counter: 20 out of 50
epoch:  45
epoch:  46 val_f1:  0.7505653177403916 val_auroc:  0.8102601865488462 val_auprc:  0.9125018450608686
EarlyStopping counter: 21 out of 50
epoch:  46
epoch:  47 val_f1:  0.7376969013024874 val_auroc:  0.8217967599410898 val_auprc:  0.9216875767125594
EarlyStopping counter: 22 out of 50
epoch:  47
epoch:  48 val_f1:  0.7402181480621955 val_auroc:  0.8159057437407953 val_auprc:  0.9169736961435628
EarlyStopping counter: 23 out of 50
epoch:  48
epoch:  49 val_f1:  0.7567268683783295 val_auroc:  0.8200785468826706 val_auprc:  0.9203322197060189
EarlyStopping counter: 24 out of 50
epoch:  49
epoch:  50 val_f1:  0.7494347379239465 val_auroc:  0.8215513009327442 val_auprc:  0.9212030147851973
EarlyStopping counter: 25 out of 50
epoch:  50
epoch:  51 val_f1:  0.7466980132583976 val_auroc:  0.8149239077074129 val_auprc:  0.9148061429765779
EarlyStopping counter: 26 out of 50
epoch:  51
epoch:  52 val_f1:  0.7644702419882276 val_auroc:  0.8203240058910163 val_auprc:  0.9208738544851709
EarlyStopping counter: 27 out of 50
epoch:  52
epoch:  53 val_f1:  0.7596459003010357 val_auroc:  0.8132056946489936 val_auprc:  0.9141410063268758
EarlyStopping counter: 28 out of 50
epoch:  53
epoch:  54 val_f1:  0.7553956834532374 val_auroc:  0.8085419734904271 val_auprc:  0.9114200232632028
EarlyStopping counter: 29 out of 50
epoch:  54
epoch:  55 val_f1:  0.7402181480621955 val_auroc:  0.8163966617574865 val_auprc:  0.91639383557054
EarlyStopping counter: 30 out of 50
epoch:  55
epoch:  56 val_f1:  0.7412236216203913 val_auroc:  0.8154148257241041 val_auprc:  0.9159381842925941
EarlyStopping counter: 31 out of 50
epoch:  56
epoch:  57 val_f1:  0.7633714058926586 val_auroc:  0.8119783996072656 val_auprc:  0.9132116208985327
EarlyStopping counter: 32 out of 50
epoch:  57
epoch:  58 val_f1:  0.7790721385700611 val_auroc:  0.8149239077074127 val_auprc:  0.917720159501206
EarlyStopping counter: 33 out of 50
epoch:  58
epoch:  59 val_f1:  0.7577565132360132 val_auroc:  0.8203240058910162 val_auprc:  0.9215038781174404
EarlyStopping counter: 34 out of 50
epoch:  59
epoch:  60 val_f1:  0.7531731915989216 val_auroc:  0.8166421207658321 val_auprc:  0.9182335438486195
EarlyStopping counter: 35 out of 50
epoch:  60
epoch:  61 val_f1:  0.7596459003010357 val_auroc:  0.8141875306823761 val_auprc:  0.9147183413427873
EarlyStopping counter: 36 out of 50
epoch:  61
epoch:  62 val_f1:  0.7681512331200245 val_auroc:  0.8090328915071183 val_auprc:  0.9112870593996301
EarlyStopping counter: 37 out of 50
epoch:  62
epoch:  63 val_f1:  0.7596459003010357 val_auroc:  0.818605792832597 val_auprc:  0.9205729057726989
EarlyStopping counter: 38 out of 50
epoch:  63
epoch:  64 val_f1:  0.7672775806504117 val_auroc:  0.8176239567992145 val_auprc:  0.9173803049094027
EarlyStopping counter: 39 out of 50
epoch:  64
epoch:  65 val_f1:  0.7442757932382417 val_auroc:  0.8215513009327443 val_auprc:  0.9224393712939304
EarlyStopping counter: 40 out of 50
epoch:  65
epoch:  66 val_f1:  0.7307106601978622 val_auroc:  0.8240058910162003 val_auprc:  0.9239541224741229
EarlyStopping counter: 41 out of 50
epoch:  66
epoch:  67 val_f1:  0.7573003855683703 val_auroc:  0.8235149729995092 val_auprc:  0.923257983652802
EarlyStopping counter: 42 out of 50
epoch:  67
epoch:  68 val_f1:  0.7648187281552264 val_auroc:  0.8161512027491409 val_auprc:  0.9171768001003475
EarlyStopping counter: 43 out of 50
epoch:  68
epoch:  69 val_f1:  0.7633714058926586 val_auroc:  0.8161512027491409 val_auprc:  0.9164702003394609
EarlyStopping counter: 44 out of 50
epoch:  69
epoch:  70 val_f1:  0.7712620601193464 val_auroc:  0.8151693667157585 val_auprc:  0.9157116064504073
EarlyStopping counter: 45 out of 50
epoch:  70
epoch:  71 val_f1:  0.7376969013024874 val_auroc:  0.8252331860579283 val_auprc:  0.923756794358752
EarlyStopping counter: 46 out of 50
epoch:  71
epoch:  72 val_f1:  0.7737843767539161 val_auroc:  0.8146784486990674 val_auprc:  0.9145055496371226
EarlyStopping counter: 47 out of 50
epoch:  72
epoch:  73 val_f1:  0.7745465218349855 val_auroc:  0.809769268532155 val_auprc:  0.9107301086801253
EarlyStopping counter: 48 out of 50
epoch:  73
epoch:  74 val_f1:  0.7681512331200245 val_auroc:  0.8107511045655376 val_auprc:  0.912453666203964
EarlyStopping counter: 49 out of 50
epoch:  74
epoch:  75 val_f1:  0.7737843767539161 val_auroc:  0.8183603338242514 val_auprc:  0.9177678682944739
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  143.69944620132446
{'time_elapsed': [143.69944620132446], 'epoch': [74], 'fold': [0], 'f1_train': [0.9892411295259068], 'auroc_train': [0.9999233528528069], 'auprc_train': [0.9999664851387277], 'f1_test': [0.7737843767539161], 'auroc_test': [0.8183603338242514], 'auprc_test': [0.9177678682944739]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 256]            3,072
│    └─BatchNorm1d: 2-2                  [64, 512, 256]            1,024
│    └─Tanh: 2-3                         [64, 512, 256]            --
│    └─MaxPool1d: 2-4                    [64, 512, 51]             --
│    └─Dropout: 2-5                      [64, 512, 51]             --
│    └─Flatten: 2-6                      [64, 26112]               --
│    └─Linear: 2-7                       [64, 1]                   26,113
==========================================================================================
Total params: 30,209
Trainable params: 30,209
Non-trainable params: 0
Total mult-adds (M): 52.07
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 134.22
Params size (MB): 0.12
Estimated Total Size (MB): 134.67
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.7030919944895149 val_auroc:  0.7442317133038783 val_auprc:  0.8813023840367405
epoch:  1
epoch:  2 val_f1:  0.646262304336327 val_auroc:  0.7056946489936181 val_auprc:  0.8801581447578539
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.661834573381412 val_auroc:  0.7054491899852725 val_auprc:  0.881790778828948
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6667819901382266 val_auroc:  0.7162493863524791 val_auprc:  0.886031067558363
Validation loss improved to 1.113238
epoch:  4
epoch:  5 val_f1:  0.6824751963135375 val_auroc:  0.7295041728031418 val_auprc:  0.8904590347293623
Validation loss improved to 1.098577
epoch:  5
epoch:  6 val_f1:  0.6730611342088393 val_auroc:  0.7508591065292096 val_auprc:  0.8967261953414974
Validation loss improved to 1.071163
epoch:  6
epoch:  7 val_f1:  0.6663975251072785 val_auroc:  0.7653411880216003 val_auprc:  0.9029346930447846
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.7644702419882276 val_auroc:  0.7798232695139912 val_auprc:  0.9061538635988142
Validation loss improved to 1.015584
epoch:  8
epoch:  9 val_f1:  0.6977368320649064 val_auroc:  0.7916053019145803 val_auprc:  0.9104536838346486
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7445203699313053 val_auroc:  0.7984781541482572 val_auprc:  0.9149672480474376
Validation loss improved to 0.990577
epoch:  10
epoch:  11 val_f1:  0.770628190185282 val_auroc:  0.8082965144820815 val_auprc:  0.9191000701624774
Validation loss improved to 0.974683
epoch:  11
epoch:  12 val_f1:  0.7553956834532374 val_auroc:  0.809769268532155 val_auprc:  0.9192158484579079
Validation loss improved to 0.972228
epoch:  12
epoch:  13 val_f1:  0.7553956834532374 val_auroc:  0.814187530682376 val_auprc:  0.9213721062375616
Validation loss improved to 0.960270
epoch:  13
epoch:  14 val_f1:  0.7651358509506568 val_auroc:  0.8154148257241041 val_auprc:  0.9223003704720315
Validation loss improved to 0.959615
epoch:  14
epoch:  15 val_f1:  0.7699730743399811 val_auroc:  0.8188512518409425 val_auprc:  0.9235071440093013
Validation loss improved to 0.941614
epoch:  15
epoch:  16 val_f1:  0.7737843767539161 val_auroc:  0.8215513009327442 val_auprc:  0.9246792452225439
Validation loss improved to 0.936477
epoch:  16
epoch:  17 val_f1:  0.770628190185282 val_auroc:  0.8205694648993619 val_auprc:  0.9241993915526794
Validation loss improved to 0.930563
epoch:  17
epoch:  18 val_f1:  0.7583800901862243 val_auroc:  0.819833087874325 val_auprc:  0.922926231850562
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7715989981939552 val_auroc:  0.8217967599410899 val_auprc:  0.9243118581805535
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7584532667010088 val_auroc:  0.8215513009327442 val_auprc:  0.9248371860138214
EarlyStopping counter: 3 out of 50
epoch:  20
epoch:  21 val_f1:  0.7681512331200245 val_auroc:  0.8215513009327442 val_auprc:  0.9232685950095896
EarlyStopping counter: 4 out of 50
epoch:  21
epoch:  22 val_f1:  0.7790721385700611 val_auroc:  0.8215513009327442 val_auprc:  0.9229149999408435
EarlyStopping counter: 5 out of 50
epoch:  22
epoch:  23 val_f1:  0.7672775806504117 val_auroc:  0.8208149239077074 val_auprc:  0.9224365893710038
EarlyStopping counter: 6 out of 50
epoch:  23
epoch:  24 val_f1:  0.7617596949267598 val_auroc:  0.8225331369661266 val_auprc:  0.9230918801206651
EarlyStopping counter: 7 out of 50
epoch:  24
epoch:  25 val_f1:  0.7536606851900262 val_auroc:  0.821060382916053 val_auprc:  0.9215342793108319
EarlyStopping counter: 8 out of 50
epoch:  25
epoch:  26 val_f1:  0.7712620601193464 val_auroc:  0.8244968090328915 val_auprc:  0.9234346860984124
EarlyStopping counter: 9 out of 50
epoch:  26
epoch:  27 val_f1:  0.7617596949267598 val_auroc:  0.8252331860579284 val_auprc:  0.9239265575774419
EarlyStopping counter: 10 out of 50
epoch:  27
epoch:  28 val_f1:  0.7445203699313053 val_auroc:  0.8215513009327442 val_auprc:  0.9216809544971989
EarlyStopping counter: 11 out of 50
epoch:  28
epoch:  29 val_f1:  0.7790721385700611 val_auroc:  0.8200785468826707 val_auprc:  0.9208564780122438
EarlyStopping counter: 12 out of 50
epoch:  29
epoch:  30 val_f1:  0.7777125328082551 val_auroc:  0.8190967108492883 val_auprc:  0.9201801845885791
EarlyStopping counter: 13 out of 50
epoch:  30
epoch:  31 val_f1:  0.7790721385700611 val_auroc:  0.8242513500245459 val_auprc:  0.9232913493172047
EarlyStopping counter: 14 out of 50
epoch:  31
epoch:  32 val_f1:  0.7617596949267598 val_auroc:  0.824251350024546 val_auprc:  0.9240821346300555
EarlyStopping counter: 15 out of 50
epoch:  32
epoch:  33 val_f1:  0.7542604103291037 val_auroc:  0.8232695139911634 val_auprc:  0.9227084874878717
EarlyStopping counter: 16 out of 50
epoch:  33
epoch:  34 val_f1:  0.7823449348629204 val_auroc:  0.8183603338242514 val_auprc:  0.9197189222612839
EarlyStopping counter: 17 out of 50
epoch:  34
epoch:  35 val_f1:  0.7648187281552264 val_auroc:  0.819833087874325 val_auprc:  0.9199312815755623
EarlyStopping counter: 18 out of 50
epoch:  35
epoch:  36 val_f1:  0.7691994463100789 val_auroc:  0.8217967599410898 val_auprc:  0.921368687590929
EarlyStopping counter: 19 out of 50
epoch:  36
epoch:  37 val_f1:  0.7699730743399811 val_auroc:  0.8230240549828178 val_auprc:  0.9225854887400772
EarlyStopping counter: 20 out of 50
epoch:  37
epoch:  38 val_f1:  0.7765831291011147 val_auroc:  0.8242513500245459 val_auprc:  0.9232889428866982
EarlyStopping counter: 21 out of 50
epoch:  38
epoch:  39 val_f1:  0.7617596949267598 val_auroc:  0.8213058419243986 val_auprc:  0.9208995536125862
EarlyStopping counter: 22 out of 50
epoch:  39
epoch:  40 val_f1:  0.7697841726618705 val_auroc:  0.8190967108492881 val_auprc:  0.9191219928973795
EarlyStopping counter: 23 out of 50
epoch:  40
epoch:  41 val_f1:  0.7685409504908388 val_auroc:  0.8163966617574865 val_auprc:  0.9174063746913148
EarlyStopping counter: 24 out of 50
epoch:  41
epoch:  42 val_f1:  0.7635640416019908 val_auroc:  0.8124693176239569 val_auprc:  0.9147982714045266
EarlyStopping counter: 25 out of 50
epoch:  42
epoch:  43 val_f1:  0.7536606851900262 val_auroc:  0.8190967108492881 val_auprc:  0.9200329579094227
EarlyStopping counter: 26 out of 50
epoch:  43
epoch:  44 val_f1:  0.7617684906754855 val_auroc:  0.8190967108492881 val_auprc:  0.919466844249172
EarlyStopping counter: 27 out of 50
epoch:  44
epoch:  45 val_f1:  0.7553956834532374 val_auroc:  0.8186057928325969 val_auprc:  0.9189748216085512
EarlyStopping counter: 28 out of 50
epoch:  45
epoch:  46 val_f1:  0.7617684906754855 val_auroc:  0.8193421698576338 val_auprc:  0.9193759376975472
EarlyStopping counter: 29 out of 50
epoch:  46
epoch:  47 val_f1:  0.7812454480117876 val_auroc:  0.8161512027491409 val_auprc:  0.9158332954126887
EarlyStopping counter: 30 out of 50
epoch:  47
epoch:  48 val_f1:  0.743396428458658 val_auroc:  0.8154148257241041 val_auprc:  0.9156243602667872
EarlyStopping counter: 31 out of 50
epoch:  48
epoch:  49 val_f1:  0.7622262794246104 val_auroc:  0.8146784486990672 val_auprc:  0.914748770444221
EarlyStopping counter: 32 out of 50
epoch:  49
epoch:  50 val_f1:  0.7712620601193464 val_auroc:  0.8178694158075601 val_auprc:  0.9171545022690157
EarlyStopping counter: 33 out of 50
epoch:  50
epoch:  51 val_f1:  0.76000113614692 val_auroc:  0.8163966617574865 val_auprc:  0.9163041205987287
EarlyStopping counter: 34 out of 50
epoch:  51
epoch:  52 val_f1:  0.76000113614692 val_auroc:  0.8168875797741777 val_auprc:  0.9164312525885849
EarlyStopping counter: 35 out of 50
epoch:  52
epoch:  53 val_f1:  0.7633714058926586 val_auroc:  0.8168875797741777 val_auprc:  0.9166588185590411
EarlyStopping counter: 36 out of 50
epoch:  53
epoch:  54 val_f1:  0.7633714058926586 val_auroc:  0.8163966617574865 val_auprc:  0.9160677479214994
EarlyStopping counter: 37 out of 50
epoch:  54
epoch:  55 val_f1:  0.7553956834532374 val_auroc:  0.8136966126656848 val_auprc:  0.913638102723878
EarlyStopping counter: 38 out of 50
epoch:  55
epoch:  56 val_f1:  0.7712620601193464 val_auroc:  0.8146784486990674 val_auprc:  0.9148858994513931
EarlyStopping counter: 39 out of 50
epoch:  56
epoch:  57 val_f1:  0.7553956834532374 val_auroc:  0.8154148257241042 val_auprc:  0.9146422387066153
EarlyStopping counter: 40 out of 50
epoch:  57
epoch:  58 val_f1:  0.7812454480117876 val_auroc:  0.8087874324987727 val_auprc:  0.909906279832293
EarlyStopping counter: 41 out of 50
epoch:  58
epoch:  59 val_f1:  0.7812454480117876 val_auroc:  0.8058419243986255 val_auprc:  0.9073287448769202
EarlyStopping counter: 42 out of 50
epoch:  59
epoch:  60 val_f1:  0.787641731275174 val_auroc:  0.8097692685321551 val_auprc:  0.9088506635972607
EarlyStopping counter: 43 out of 50
epoch:  60
epoch:  61 val_f1:  0.766354189375772 val_auroc:  0.8146784486990672 val_auprc:  0.9124764494594206
EarlyStopping counter: 44 out of 50
epoch:  61
epoch:  62 val_f1:  0.7633714058926586 val_auroc:  0.8136966126656848 val_auprc:  0.9118298611575456
EarlyStopping counter: 45 out of 50
epoch:  62
epoch:  63 val_f1:  0.7685409504908388 val_auroc:  0.8095238095238094 val_auprc:  0.9085902133837138
EarlyStopping counter: 46 out of 50
epoch:  63
epoch:  64 val_f1:  0.751751326211758 val_auroc:  0.8085419734904271 val_auprc:  0.9084359859139512
EarlyStopping counter: 47 out of 50
epoch:  64
epoch:  65 val_f1:  0.7812454480117876 val_auroc:  0.8043691703485517 val_auprc:  0.9063206755916144
EarlyStopping counter: 48 out of 50
epoch:  65
epoch:  66 val_f1:  0.7617684906754855 val_auroc:  0.8102601865488465 val_auprc:  0.9095599918599105
EarlyStopping counter: 49 out of 50
epoch:  66
epoch:  67 val_f1:  0.787641731275174 val_auroc:  0.8080510554737359 val_auprc:  0.9064945289360494
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  126.25485825538635
{'time_elapsed': [126.25485825538635], 'epoch': [66], 'fold': [1], 'f1_train': [0.9945900710865144], 'auroc_train': [0.9998926939939295], 'auprc_train': [0.999953026957633], 'f1_test': [0.787641731275174], 'auroc_test': [0.8080510554737359], 'auprc_test': [0.9064945289360494]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 256]            3,072
│    └─BatchNorm1d: 2-2                  [64, 512, 256]            1,024
│    └─Tanh: 2-3                         [64, 512, 256]            --
│    └─MaxPool1d: 2-4                    [64, 512, 51]             --
│    └─Dropout: 2-5                      [64, 512, 51]             --
│    └─Flatten: 2-6                      [64, 26112]               --
│    └─Linear: 2-7                       [64, 1]                   26,113
==========================================================================================
Total params: 30,209
Trainable params: 30,209
Non-trainable params: 0
Total mult-adds (M): 52.07
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 134.22
Params size (MB): 0.12
Estimated Total Size (MB): 134.67
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5901444900487328 val_auroc:  0.6755031909671085 val_auprc:  0.8226049538926643
epoch:  1
epoch:  2 val_f1:  0.591898769565332 val_auroc:  0.6195385370643103 val_auprc:  0.8178920893941778
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.5912428769525999 val_auroc:  0.6212567501227295 val_auprc:  0.8199350888720849
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5919023546940849 val_auroc:  0.6367206676485028 val_auprc:  0.8278713915716499
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6203179049680608 val_auroc:  0.6531664212076584 val_auprc:  0.8355777764312946
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6338388558291804 val_auroc:  0.6779577810505646 val_auprc:  0.8501435572281869
Validation loss improved to 1.148777
epoch:  6
epoch:  7 val_f1:  0.6446766032150357 val_auroc:  0.7037309769268532 val_auprc:  0.8642667616543424
Validation loss improved to 1.105768
epoch:  7
epoch:  8 val_f1:  0.6756372438556401 val_auroc:  0.7216494845360826 val_auprc:  0.8721985269038576
Validation loss improved to 1.095850
epoch:  8
epoch:  9 val_f1:  0.6894399143298684 val_auroc:  0.7403043691703485 val_auprc:  0.8814611672640368
Validation loss improved to 1.081036
epoch:  9
epoch:  10 val_f1:  0.6610684696390046 val_auroc:  0.7444771723122239 val_auprc:  0.883256982463146
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.7377691212466089 val_auroc:  0.7545409916543937 val_auprc:  0.8868425172089923
Validation loss improved to 1.056738
epoch:  11
epoch:  12 val_f1:  0.499774526580479 val_auroc:  0.7469317623956799 val_auprc:  0.8821318934140154
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.713247796930704 val_auroc:  0.760677466863034 val_auprc:  0.8901509654723574
Validation loss improved to 1.037451
epoch:  13
epoch:  14 val_f1:  0.7229061670449737 val_auroc:  0.7604320078546882 val_auprc:  0.889297439465217
Validation loss improved to 1.034913
epoch:  14
epoch:  15 val_f1:  0.7150229029574715 val_auroc:  0.7621502209131076 val_auprc:  0.890142489829622
Validation loss improved to 1.027786
epoch:  15
epoch:  16 val_f1:  0.6213039568345323 val_auroc:  0.7538046146293569 val_auprc:  0.883242195488699
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7150229029574715 val_auroc:  0.7648502700049092 val_auprc:  0.8900332290658529
Validation loss improved to 1.025991
epoch:  17
epoch:  18 val_f1:  0.706765356945213 val_auroc:  0.7687776141384389 val_auprc:  0.8930303587039459
Validation loss improved to 1.015979
epoch:  18
epoch:  19 val_f1:  0.7031576347932113 val_auroc:  0.7695139911634756 val_auprc:  0.8919546387767681
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7207289113763933 val_auroc:  0.7731958762886598 val_auprc:  0.8929348266267343
Validation loss improved to 1.012089
epoch:  20
epoch:  21 val_f1:  0.7100860488080124 val_auroc:  0.7690230731467845 val_auprc:  0.8907007351266951
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7207289113763933 val_auroc:  0.774914089347079 val_auprc:  0.8930245552716325
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.713247796930704 val_auroc:  0.7731958762886598 val_auprc:  0.8900385770732662
EarlyStopping counter: 3 out of 50
epoch:  23
epoch:  24 val_f1:  0.6677356419948787 val_auroc:  0.7653411880216004 val_auprc:  0.884292653403369
EarlyStopping counter: 4 out of 50
epoch:  24
epoch:  25 val_f1:  0.6677356419948787 val_auroc:  0.7677957781050565 val_auprc:  0.8864678198770904
EarlyStopping counter: 5 out of 50
epoch:  25
epoch:  26 val_f1:  0.7223183251151889 val_auroc:  0.7766323024054983 val_auprc:  0.8916388119537018
Validation loss improved to 1.011091
epoch:  26
epoch:  27 val_f1:  0.6677356419948787 val_auroc:  0.7717231222385862 val_auprc:  0.8888407989722584
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7295632867761842 val_auroc:  0.7727049582719686 val_auprc:  0.8894292040785267
EarlyStopping counter: 2 out of 50
epoch:  28
epoch:  29 val_f1:  0.7030912407309765 val_auroc:  0.7687776141384389 val_auprc:  0.8863016213039163
EarlyStopping counter: 3 out of 50
epoch:  29
epoch:  30 val_f1:  0.7281499969472504 val_auroc:  0.7697594501718213 val_auprc:  0.887193839320136
EarlyStopping counter: 4 out of 50
epoch:  30
epoch:  31 val_f1:  0.7246795893300292 val_auroc:  0.7778595974472263 val_auprc:  0.8908499668339384
EarlyStopping counter: 5 out of 50
epoch:  31
epoch:  32 val_f1:  0.7169009504644194 val_auroc:  0.7700049091801668 val_auprc:  0.8865512346785973
EarlyStopping counter: 6 out of 50
epoch:  32
epoch:  33 val_f1:  0.7236892364125374 val_auroc:  0.7704958271968583 val_auprc:  0.88719866744878
EarlyStopping counter: 7 out of 50
epoch:  33
epoch:  34 val_f1:  0.7140775751491829 val_auroc:  0.7788414334806087 val_auprc:  0.8917794850583697
EarlyStopping counter: 8 out of 50
epoch:  34
epoch:  35 val_f1:  0.7156947373800909 val_auroc:  0.770004909180167 val_auprc:  0.8875048169675364
EarlyStopping counter: 9 out of 50
epoch:  35
epoch:  36 val_f1:  0.7304528631430115 val_auroc:  0.7700049091801668 val_auprc:  0.8868684936053992
EarlyStopping counter: 10 out of 50
epoch:  36
epoch:  37 val_f1:  0.7496568898727172 val_auroc:  0.7773686794305351 val_auprc:  0.8913751362642628
EarlyStopping counter: 11 out of 50
epoch:  37
epoch:  38 val_f1:  0.743396428458658 val_auroc:  0.7771232204221895 val_auprc:  0.8907135875816041
EarlyStopping counter: 12 out of 50
epoch:  38
epoch:  39 val_f1:  0.7100860488080124 val_auroc:  0.7660775650466373 val_auprc:  0.8850567912173807
EarlyStopping counter: 13 out of 50
epoch:  39
epoch:  40 val_f1:  0.7100860488080124 val_auroc:  0.7658321060382915 val_auprc:  0.8849105736639313
EarlyStopping counter: 14 out of 50
epoch:  40
epoch:  41 val_f1:  0.7328919440906961 val_auroc:  0.7707412862052037 val_auprc:  0.8881328237486782
EarlyStopping counter: 15 out of 50
epoch:  41
epoch:  42 val_f1:  0.7263486361521366 val_auroc:  0.7773686794305351 val_auprc:  0.8912972671002085
EarlyStopping counter: 16 out of 50
epoch:  42
epoch:  43 val_f1:  0.6945501576267077 val_auroc:  0.7626411389297987 val_auprc:  0.8830734169119141
EarlyStopping counter: 17 out of 50
epoch:  43
epoch:  44 val_f1:  0.6610684696390046 val_auroc:  0.7540500736377025 val_auprc:  0.8777470172707647
EarlyStopping counter: 18 out of 50
epoch:  44
epoch:  45 val_f1:  0.7108600244444511 val_auroc:  0.7734413352970054 val_auprc:  0.8904816116657075
EarlyStopping counter: 19 out of 50
epoch:  45
epoch:  46 val_f1:  0.7088095828755714 val_auroc:  0.7749140893470791 val_auprc:  0.8910946302239423
EarlyStopping counter: 20 out of 50
epoch:  46
epoch:  47 val_f1:  0.7015283467006299 val_auroc:  0.7734413352970054 val_auprc:  0.8905049126301138
EarlyStopping counter: 21 out of 50
epoch:  47
epoch:  48 val_f1:  0.6825214527173443 val_auroc:  0.7577319587628866 val_auprc:  0.8816096572257166
EarlyStopping counter: 22 out of 50
epoch:  48
epoch:  49 val_f1:  0.7057031525565856 val_auroc:  0.7682866961217477 val_auprc:  0.8866446171516914
EarlyStopping counter: 23 out of 50
epoch:  49
epoch:  50 val_f1:  0.7263486361521366 val_auroc:  0.7746686303387335 val_auprc:  0.8899419658237491
EarlyStopping counter: 24 out of 50
epoch:  50
epoch:  51 val_f1:  0.7184536707983012 val_auroc:  0.770495827196858 val_auprc:  0.8879266477293476
EarlyStopping counter: 25 out of 50
epoch:  51
epoch:  52 val_f1:  0.6818661781450172 val_auroc:  0.7513500245459008 val_auprc:  0.8748996849219082
EarlyStopping counter: 26 out of 50
epoch:  52
epoch:  53 val_f1:  0.6854853326641013 val_auroc:  0.7560137457044674 val_auprc:  0.8790766432729878
EarlyStopping counter: 27 out of 50
epoch:  53
epoch:  54 val_f1:  0.7030919944895149 val_auroc:  0.7653411880216003 val_auprc:  0.8862086361640942
EarlyStopping counter: 28 out of 50
epoch:  54
epoch:  55 val_f1:  0.6967556353929608 val_auroc:  0.7616593028964163 val_auprc:  0.882999736521963
EarlyStopping counter: 29 out of 50
epoch:  55
epoch:  56 val_f1:  0.7057031525565856 val_auroc:  0.7550319096710849 val_auprc:  0.8787698436309803
EarlyStopping counter: 30 out of 50
epoch:  56
epoch:  57 val_f1:  0.7040153975059064 val_auroc:  0.7641138929798723 val_auprc:  0.8850838796009689
EarlyStopping counter: 31 out of 50
epoch:  57
epoch:  58 val_f1:  0.717230470942395 val_auroc:  0.7614138438880707 val_auprc:  0.8826451175413006
EarlyStopping counter: 32 out of 50
epoch:  58
epoch:  59 val_f1:  0.6967556353929608 val_auroc:  0.7592047128129603 val_auprc:  0.8801780995320203
EarlyStopping counter: 33 out of 50
epoch:  59
epoch:  60 val_f1:  0.6747016034883605 val_auroc:  0.7511045655375553 val_auprc:  0.8753907564187317
EarlyStopping counter: 34 out of 50
epoch:  60
epoch:  61 val_f1:  0.6889535180366346 val_auroc:  0.7609229258713796 val_auprc:  0.8837158747443657
EarlyStopping counter: 35 out of 50
epoch:  61
epoch:  62 val_f1:  0.7121336235283787 val_auroc:  0.7569955817378499 val_auprc:  0.8797545623050256
EarlyStopping counter: 36 out of 50
epoch:  62
epoch:  63 val_f1:  0.7057031525565856 val_auroc:  0.7511045655375552 val_auprc:  0.8747211661179497
EarlyStopping counter: 37 out of 50
epoch:  63
epoch:  64 val_f1:  0.726967940210938 val_auroc:  0.761168384879725 val_auprc:  0.8797842392084835
EarlyStopping counter: 38 out of 50
epoch:  64
epoch:  65 val_f1:  0.7108600244444511 val_auroc:  0.7535591556210113 val_auprc:  0.8750842813858551
EarlyStopping counter: 39 out of 50
epoch:  65
epoch:  66 val_f1:  0.7108600244444511 val_auroc:  0.7520864015709376 val_auprc:  0.873425030900024
EarlyStopping counter: 40 out of 50
epoch:  66
epoch:  67 val_f1:  0.7057031525565856 val_auroc:  0.7535591556210114 val_auprc:  0.8762319371283955
EarlyStopping counter: 41 out of 50
epoch:  67
epoch:  68 val_f1:  0.7140703059967902 val_auroc:  0.7515954835542464 val_auprc:  0.8744638253791701
EarlyStopping counter: 42 out of 50
epoch:  68
epoch:  69 val_f1:  0.6967556353929608 val_auroc:  0.7464408443789887 val_auprc:  0.8712943291644915
EarlyStopping counter: 43 out of 50
epoch:  69
epoch:  70 val_f1:  0.6997814539066421 val_auroc:  0.7525773195876289 val_auprc:  0.875390259603385
EarlyStopping counter: 44 out of 50
epoch:  70
epoch:  71 val_f1:  0.6997814539066421 val_auroc:  0.7538046146293569 val_auprc:  0.8766061551616909
EarlyStopping counter: 45 out of 50
epoch:  71
epoch:  72 val_f1:  0.7030919944895149 val_auroc:  0.7474226804123711 val_auprc:  0.8723150090584962
EarlyStopping counter: 46 out of 50
epoch:  72
epoch:  73 val_f1:  0.7030919944895149 val_auroc:  0.7464408443789887 val_auprc:  0.872137251526485
EarlyStopping counter: 47 out of 50
epoch:  73
epoch:  74 val_f1:  0.6952451949622753 val_auroc:  0.7474226804123711 val_auprc:  0.8727761579158934
EarlyStopping counter: 48 out of 50
epoch:  74
epoch:  75 val_f1:  0.6952451949622753 val_auroc:  0.745704467353952 val_auprc:  0.870980247024136
EarlyStopping counter: 49 out of 50
epoch:  75
epoch:  76 val_f1:  0.7108600244444511 val_auroc:  0.7442317133038783 val_auprc:  0.8703321138981905
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  139.0141887664795
{'time_elapsed': [139.0141887664795], 'epoch': [75], 'fold': [2], 'f1_train': [0.9803492824837834], 'auroc_train': [0.9999693411411228], 'auprc_train': [0.9999866287592856], 'f1_test': [0.7108600244444511], 'auroc_test': [0.7442317133038783], 'auprc_test': [0.8703321138981905]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 256]            3,072
│    └─BatchNorm1d: 2-2                  [64, 512, 256]            1,024
│    └─Tanh: 2-3                         [64, 512, 256]            --
│    └─MaxPool1d: 2-4                    [64, 512, 51]             --
│    └─Dropout: 2-5                      [64, 512, 51]             --
│    └─Flatten: 2-6                      [64, 26112]               --
│    └─Linear: 2-7                       [64, 1]                   26,113
==========================================================================================
Total params: 30,209
Trainable params: 30,209
Non-trainable params: 0
Total mult-adds (M): 52.07
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 134.22
Params size (MB): 0.12
Estimated Total Size (MB): 134.67
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5642736874330323 val_auroc:  0.7194767441860465 val_auprc:  0.8088464971361071
epoch:  1
epoch:  2 val_f1:  0.5323741007194244 val_auroc:  0.658187984496124 val_auprc:  0.813457904963557
Validation loss improved to 1.258588
epoch:  2
epoch:  3 val_f1:  0.6557253914860215 val_auroc:  0.6712693798449614 val_auprc:  0.826034695118908
Validation loss improved to 1.245707
epoch:  3
epoch:  4 val_f1:  0.6394417594489569 val_auroc:  0.6916182170542635 val_auprc:  0.8441824706316579
Validation loss improved to 1.188352
epoch:  4
epoch:  5 val_f1:  0.6742890979887021 val_auroc:  0.7262596899224807 val_auprc:  0.8665100072042722
Validation loss improved to 1.134094
epoch:  5
epoch:  6 val_f1:  0.697841726618705 val_auroc:  0.7609011627906976 val_auprc:  0.888938120378485
Validation loss improved to 1.094796
epoch:  6
epoch:  7 val_f1:  0.7021337104762708 val_auroc:  0.7839147286821706 val_auprc:  0.903140442185137
Validation loss improved to 1.049626
epoch:  7
epoch:  8 val_f1:  0.7266187050359713 val_auroc:  0.8163759689922481 val_auprc:  0.921773791580895
Validation loss improved to 1.019591
epoch:  8
epoch:  9 val_f1:  0.7604868926320555 val_auroc:  0.8280038759689922 val_auprc:  0.9270927470904309
Validation loss improved to 0.985294
epoch:  9
epoch:  10 val_f1:  0.7555901444410748 val_auroc:  0.8369670542635658 val_auprc:  0.9312420611124556
Validation loss improved to 0.960100
epoch:  10
epoch:  11 val_f1:  0.7603368061152953 val_auroc:  0.8408430232558138 val_auprc:  0.9306995083296719
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7014382785827783 val_auroc:  0.8386627906976744 val_auprc:  0.9300730216785346
Validation loss improved to 0.951145
epoch:  12
epoch:  13 val_f1:  0.7319518471601456 val_auroc:  0.8464147286821705 val_auprc:  0.9312305119822832
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7713093666729185 val_auroc:  0.8406007751937984 val_auprc:  0.9312013473128129
Validation loss improved to 0.906693
epoch:  14
epoch:  15 val_f1:  0.7622179807174668 val_auroc:  0.8439922480620156 val_auprc:  0.9317650680288703
Validation loss improved to 0.887902
epoch:  15
epoch:  16 val_f1:  0.7335046248715313 val_auroc:  0.8461724806201552 val_auprc:  0.931591706182818
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7845506341112962 val_auroc:  0.8415697674418604 val_auprc:  0.9312097045464496
Validation loss improved to 0.864537
epoch:  17
epoch:  18 val_f1:  0.7849097105470042 val_auroc:  0.842296511627907 val_auprc:  0.9318441592256745
Validation loss improved to 0.857212
epoch:  18
epoch:  19 val_f1:  0.767033173809688 val_auroc:  0.8447189922480621 val_auprc:  0.9321897766422687
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7688372056811462 val_auroc:  0.8449612403100776 val_auprc:  0.932308045018418
Validation loss improved to 0.839129
epoch:  20
epoch:  21 val_f1:  0.7789671954250403 val_auroc:  0.8493217054263565 val_auprc:  0.9336468229995131
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7835226993620948 val_auroc:  0.8481104651162791 val_auprc:  0.9333642133751529
Validation loss improved to 0.821551
epoch:  22
epoch:  23 val_f1:  0.7932273763653603 val_auroc:  0.8507751937984497 val_auprc:  0.9343220707449928
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7840893588200424 val_auroc:  0.8495639534883722 val_auprc:  0.9342772777706625
Validation loss improved to 0.804006
epoch:  24
epoch:  25 val_f1:  0.7907929835906556 val_auroc:  0.8507751937984497 val_auprc:  0.93457168505175
Validation loss improved to 0.794544
epoch:  25
epoch:  26 val_f1:  0.7866727894280321 val_auroc:  0.8522286821705426 val_auprc:  0.9354386457357992
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7961192047225032 val_auroc:  0.8548934108527132 val_auprc:  0.9375174611268199
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7835226993620948 val_auroc:  0.8541666666666667 val_auprc:  0.9376493660818226
Validation loss improved to 0.785422
epoch:  28
epoch:  29 val_f1:  0.8084949329130455 val_auroc:  0.8551356589147288 val_auprc:  0.9376506167889543
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.8084949329130455 val_auroc:  0.8558624031007751 val_auprc:  0.9376652354497996
EarlyStopping counter: 2 out of 50
epoch:  30
epoch:  31 val_f1:  0.7968569383258559 val_auroc:  0.8558624031007752 val_auprc:  0.9382708981584735
Validation loss improved to 0.773309
epoch:  31
epoch:  32 val_f1:  0.7968569383258559 val_auroc:  0.8565891472868217 val_auprc:  0.9392612147412777
Validation loss improved to 0.769919
epoch:  32
epoch:  33 val_f1:  0.7507614687470803 val_auroc:  0.8568313953488371 val_auprc:  0.94056094079311
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.8035187234827523 val_auroc:  0.8582848837209304 val_auprc:  0.9400438554865016
Validation loss improved to 0.759662
epoch:  34
epoch:  35 val_f1:  0.7906801532257888 val_auroc:  0.8599806201550387 val_auprc:  0.9397948703578548
EarlyStopping counter: 1 out of 50
epoch:  35
epoch:  36 val_f1:  0.794309372388086 val_auroc:  0.8587693798449613 val_auprc:  0.939981078660007
EarlyStopping counter: 2 out of 50
epoch:  36
epoch:  37 val_f1:  0.8027539115793398 val_auroc:  0.8585271317829457 val_auprc:  0.9406496738190064
EarlyStopping counter: 3 out of 50
epoch:  37
epoch:  38 val_f1:  0.8018807955038493 val_auroc:  0.8607073643410852 val_auprc:  0.9408988266274274
EarlyStopping counter: 4 out of 50
epoch:  38
epoch:  39 val_f1:  0.8018807955038493 val_auroc:  0.8602228682170542 val_auprc:  0.9406901672195684
Validation loss improved to 0.758110
epoch:  39
epoch:  40 val_f1:  0.8018807955038493 val_auroc:  0.8619186046511628 val_auprc:  0.9418693176056363
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.8074875573056803 val_auroc:  0.8626453488372093 val_auprc:  0.9419216988227874
EarlyStopping counter: 2 out of 50
epoch:  41
epoch:  42 val_f1:  0.771032917679069 val_auroc:  0.8597383720930233 val_auprc:  0.9424816578066914
Validation loss improved to 0.756788
epoch:  42
epoch:  43 val_f1:  0.7576331204728416 val_auroc:  0.8578003875968991 val_auprc:  0.942169810482909
EarlyStopping counter: 1 out of 50
epoch:  43
epoch:  44 val_f1:  0.8022252248962252 val_auroc:  0.8640988372093023 val_auprc:  0.9423413934600116
EarlyStopping counter: 2 out of 50
epoch:  44
epoch:  45 val_f1:  0.7753157557330894 val_auroc:  0.8687015503875969 val_auprc:  0.9434472439977046
EarlyStopping counter: 3 out of 50
epoch:  45
epoch:  46 val_f1:  0.8027539115793398 val_auroc:  0.8648255813953488 val_auprc:  0.9434277038623383
Validation loss improved to 0.746078
epoch:  46
epoch:  47 val_f1:  0.7974889768226049 val_auroc:  0.8650678294573643 val_auprc:  0.9439942502095917
Validation loss improved to 0.737465
epoch:  47
epoch:  48 val_f1:  0.8102961135322703 val_auroc:  0.8687015503875969 val_auprc:  0.9445538235625964
EarlyStopping counter: 1 out of 50
epoch:  48
epoch:  49 val_f1:  0.8008946034661633 val_auroc:  0.8657945736434108 val_auprc:  0.9445058848496364
EarlyStopping counter: 2 out of 50
epoch:  49
epoch:  50 val_f1:  0.757449328289459 val_auroc:  0.8619186046511629 val_auprc:  0.9442287742431429
EarlyStopping counter: 3 out of 50
epoch:  50
epoch:  51 val_f1:  0.7961192047225032 val_auroc:  0.8660368217054263 val_auprc:  0.9454855125914934
EarlyStopping counter: 4 out of 50
epoch:  51
epoch:  52 val_f1:  0.8182769817510218 val_auroc:  0.8679748062015504 val_auprc:  0.9447956804279449
EarlyStopping counter: 5 out of 50
epoch:  52
epoch:  53 val_f1:  0.8182769817510218 val_auroc:  0.8699127906976745 val_auprc:  0.9455176019327354
EarlyStopping counter: 6 out of 50
epoch:  53
epoch:  54 val_f1:  0.7894843465886632 val_auroc:  0.8665213178294574 val_auprc:  0.9454021762876134
Validation loss improved to 0.732416
epoch:  54
epoch:  55 val_f1:  0.8129496402877698 val_auroc:  0.8696705426356589 val_auprc:  0.9461759588513508
EarlyStopping counter: 1 out of 50
epoch:  55
epoch:  56 val_f1:  0.8087693481578374 val_auroc:  0.8728197674418605 val_auprc:  0.9472405590620147
EarlyStopping counter: 2 out of 50
epoch:  56
epoch:  57 val_f1:  0.8018807955038493 val_auroc:  0.868217054263566 val_auprc:  0.9469997459839211
EarlyStopping counter: 3 out of 50
epoch:  57
epoch:  58 val_f1:  0.8108668046482106 val_auroc:  0.8653100775193798 val_auprc:  0.9458893319841246
EarlyStopping counter: 4 out of 50
epoch:  58
epoch:  59 val_f1:  0.7932273763653603 val_auroc:  0.8674903100775194 val_auprc:  0.9464669583733331
EarlyStopping counter: 5 out of 50
epoch:  59
epoch:  60 val_f1:  0.8116870274031143 val_auroc:  0.8708817829457364 val_auprc:  0.9476924913196393
EarlyStopping counter: 6 out of 50
epoch:  60
epoch:  61 val_f1:  0.794309372388086 val_auroc:  0.869186046511628 val_auprc:  0.9475888256155206
EarlyStopping counter: 7 out of 50
epoch:  61
epoch:  62 val_f1:  0.8063632502555458 val_auroc:  0.872093023255814 val_auprc:  0.9482805084507537
EarlyStopping counter: 8 out of 50
epoch:  62
epoch:  63 val_f1:  0.7997900244397783 val_auroc:  0.8733042635658914 val_auprc:  0.9486725460916885
EarlyStopping counter: 9 out of 50
epoch:  63
epoch:  64 val_f1:  0.8027539115793398 val_auroc:  0.8687015503875969 val_auprc:  0.9471490370169555
EarlyStopping counter: 10 out of 50
epoch:  64
epoch:  65 val_f1:  0.7932273763653603 val_auroc:  0.8703972868217055 val_auprc:  0.9483795511557109
EarlyStopping counter: 11 out of 50
epoch:  65
epoch:  66 val_f1:  0.8037391402911035 val_auroc:  0.874031007751938 val_auprc:  0.9493592927250692
EarlyStopping counter: 12 out of 50
epoch:  66
epoch:  67 val_f1:  0.7972014141264308 val_auroc:  0.874031007751938 val_auprc:  0.949634603495392
EarlyStopping counter: 13 out of 50
epoch:  67
epoch:  68 val_f1:  0.8063632502555458 val_auroc:  0.8711240310077519 val_auprc:  0.9486214078170929
EarlyStopping counter: 14 out of 50
epoch:  68
epoch:  69 val_f1:  0.7997900244397783 val_auroc:  0.8713662790697674 val_auprc:  0.9487446504730255
EarlyStopping counter: 15 out of 50
epoch:  69
epoch:  70 val_f1:  0.7932273763653603 val_auroc:  0.8706395348837208 val_auprc:  0.9484457788064683
EarlyStopping counter: 16 out of 50
epoch:  70
epoch:  71 val_f1:  0.7875752415552048 val_auroc:  0.8733042635658914 val_auprc:  0.9492557646583178
EarlyStopping counter: 17 out of 50
epoch:  71
epoch:  72 val_f1:  0.7997900244397783 val_auroc:  0.872093023255814 val_auprc:  0.9489943444357897
EarlyStopping counter: 18 out of 50
epoch:  72
epoch:  73 val_f1:  0.7932273763653603 val_auroc:  0.8747577519379844 val_auprc:  0.9501526550431113
EarlyStopping counter: 19 out of 50
epoch:  73
epoch:  74 val_f1:  0.7972014141264308 val_auroc:  0.8733042635658914 val_auprc:  0.9495511196625169
EarlyStopping counter: 20 out of 50
epoch:  74
epoch:  75 val_f1:  0.8101799492243995 val_auroc:  0.8687015503875969 val_auprc:  0.947521039351763
EarlyStopping counter: 21 out of 50
epoch:  75
epoch:  76 val_f1:  0.8116870274031143 val_auroc:  0.8747577519379846 val_auprc:  0.9500294089424307
EarlyStopping counter: 22 out of 50
epoch:  76
epoch:  77 val_f1:  0.7875752415552048 val_auroc:  0.875 val_auprc:  0.9499583238405389
EarlyStopping counter: 23 out of 50
epoch:  77
epoch:  78 val_f1:  0.8051160047274586 val_auroc:  0.8774224806201549 val_auprc:  0.9512064601404399
EarlyStopping counter: 24 out of 50
epoch:  78
epoch:  79 val_f1:  0.7952715769842713 val_auroc:  0.8713662790697674 val_auprc:  0.9487751590028529
EarlyStopping counter: 25 out of 50
epoch:  79
epoch:  80 val_f1:  0.7985611510791367 val_auroc:  0.872577519379845 val_auprc:  0.9493324257784181
EarlyStopping counter: 26 out of 50
epoch:  80
epoch:  81 val_f1:  0.8116870274031143 val_auroc:  0.875 val_auprc:  0.9504559292983459
EarlyStopping counter: 27 out of 50
epoch:  81
epoch:  82 val_f1:  0.8101799492243995 val_auroc:  0.8706395348837208 val_auprc:  0.948256082137696
EarlyStopping counter: 28 out of 50
epoch:  82
epoch:  83 val_f1:  0.7985611510791367 val_auroc:  0.8737887596899225 val_auprc:  0.9497007400154127
EarlyStopping counter: 29 out of 50
epoch:  83
epoch:  84 val_f1:  0.7875752415552048 val_auroc:  0.875484496124031 val_auprc:  0.9502899858395223
EarlyStopping counter: 30 out of 50
epoch:  84
epoch:  85 val_f1:  0.8116870274031143 val_auroc:  0.8745155038759689 val_auprc:  0.9501020015713071
EarlyStopping counter: 31 out of 50
epoch:  85
epoch:  86 val_f1:  0.8084949329130455 val_auroc:  0.8706395348837209 val_auprc:  0.9484311555198035
EarlyStopping counter: 32 out of 50
epoch:  86
epoch:  87 val_f1:  0.7985611510791367 val_auroc:  0.873062015503876 val_auprc:  0.9494813900604526
EarlyStopping counter: 33 out of 50
epoch:  87
epoch:  88 val_f1:  0.8116870274031143 val_auroc:  0.8754844961240309 val_auprc:  0.9505847847641685
EarlyStopping counter: 34 out of 50
epoch:  88
epoch:  89 val_f1:  0.8008946034661633 val_auroc:  0.873546511627907 val_auprc:  0.9495648431532284
EarlyStopping counter: 35 out of 50
epoch:  89
epoch:  90 val_f1:  0.8084949329130455 val_auroc:  0.8711240310077518 val_auprc:  0.9482330247976195
EarlyStopping counter: 36 out of 50
epoch:  90
epoch:  91 val_f1:  0.8051160047274586 val_auroc:  0.8752422480620154 val_auprc:  0.9504917997297613
EarlyStopping counter: 37 out of 50
epoch:  91
epoch:  92 val_f1:  0.7957035068809065 val_auroc:  0.875484496124031 val_auprc:  0.9505649347888191
EarlyStopping counter: 38 out of 50
epoch:  92
epoch:  93 val_f1:  0.8022252248962252 val_auroc:  0.8764534883720931 val_auprc:  0.9506125343663253
EarlyStopping counter: 39 out of 50
epoch:  93
epoch:  94 val_f1:  0.792019787311512 val_auroc:  0.8706395348837209 val_auprc:  0.9479222644016149
EarlyStopping counter: 40 out of 50
epoch:  94
epoch:  95 val_f1:  0.7906801532257888 val_auroc:  0.8728197674418604 val_auprc:  0.9491909587849334
EarlyStopping counter: 41 out of 50
epoch:  95
epoch:  96 val_f1:  0.8037391402911035 val_auroc:  0.8737887596899225 val_auprc:  0.949766576926842
EarlyStopping counter: 42 out of 50
epoch:  96
epoch:  97 val_f1:  0.792019787311512 val_auroc:  0.872577519379845 val_auprc:  0.9490347867729784
EarlyStopping counter: 43 out of 50
epoch:  97
epoch:  98 val_f1:  0.8051160047274586 val_auroc:  0.873062015503876 val_auprc:  0.9493904553221297
EarlyStopping counter: 44 out of 50
epoch:  98
epoch:  99 val_f1:  0.7972014141264308 val_auroc:  0.874031007751938 val_auprc:  0.9499940499982105
EarlyStopping counter: 45 out of 50
epoch:  99
epoch:  100 val_f1:  0.7875752415552048 val_auroc:  0.8757267441860466 val_auprc:  0.9506923258020499
EarlyStopping counter: 46 out of 50
epoch:  100
epoch:  101 val_f1:  0.7932273763653603 val_auroc:  0.8728197674418605 val_auprc:  0.9492957168198993
EarlyStopping counter: 47 out of 50
epoch:  101
epoch:  102 val_f1:  0.8037391402911035 val_auroc:  0.8742732558139534 val_auprc:  0.9501808062169186
EarlyStopping counter: 48 out of 50
epoch:  102
epoch:  103 val_f1:  0.7972014141264308 val_auroc:  0.8742732558139534 val_auprc:  0.950178629723783
EarlyStopping counter: 49 out of 50
epoch:  103
epoch:  104 val_f1:  0.8051160047274586 val_auroc:  0.8733042635658914 val_auprc:  0.9493699623640102
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  179.61007118225098
{'time_elapsed': [179.61007118225098], 'epoch': [103], 'fold': [3], 'f1_train': [0.9981997060342249], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8051160047274586], 'auroc_test': [0.8733042635658914], 'auprc_test': [0.9493699623640102]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 256]            3,072
│    └─BatchNorm1d: 2-2                  [64, 512, 256]            1,024
│    └─Tanh: 2-3                         [64, 512, 256]            --
│    └─MaxPool1d: 2-4                    [64, 512, 51]             --
│    └─Dropout: 2-5                      [64, 512, 51]             --
│    └─Flatten: 2-6                      [64, 26112]               --
│    └─Linear: 2-7                       [64, 1]                   26,113
==========================================================================================
Total params: 30,209
Trainable params: 30,209
Non-trainable params: 0
Total mult-adds (M): 52.07
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 134.22
Params size (MB): 0.12
Estimated Total Size (MB): 134.67
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6382466413111882 val_auroc:  0.7043650793650794 val_auprc:  0.7916087878828548
epoch:  1
epoch:  2 val_f1:  0.49649546370621045 val_auroc:  0.5873015873015873 val_auprc:  0.7042688303945511
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6032425362278767 val_auroc:  0.5726686507936508 val_auprc:  0.6950696559579205
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5295850400959252 val_auroc:  0.5885416666666666 val_auprc:  0.7051123827582165
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6501976284584978 val_auroc:  0.6165674603174602 val_auprc:  0.7226588990131009
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.5950393179295356 val_auroc:  0.6693948412698413 val_auprc:  0.7601788641043261
Validation loss improved to 1.244330
epoch:  6
epoch:  7 val_f1:  0.7099686539596411 val_auroc:  0.7229662698412699 val_auprc:  0.799092122356331
Validation loss improved to 1.164237
epoch:  7
epoch:  8 val_f1:  0.6484461504392117 val_auroc:  0.7891865079365079 val_auprc:  0.8783958439007916
Validation loss improved to 1.099097
epoch:  8
epoch:  9 val_f1:  0.7563367965827533 val_auroc:  0.8154761904761906 val_auprc:  0.9033414922671075
Validation loss improved to 1.081407
epoch:  9
epoch:  10 val_f1:  0.6927884480844753 val_auroc:  0.8484623015873015 val_auprc:  0.9291829053630188
Validation loss improved to 1.013819
epoch:  10
epoch:  11 val_f1:  0.7563367965827533 val_auroc:  0.8504464285714286 val_auprc:  0.9284057694331687
Validation loss improved to 1.009907
epoch:  11
epoch:  12 val_f1:  0.7285152146767162 val_auroc:  0.8608630952380952 val_auprc:  0.9337389310154279
Validation loss improved to 0.958384
epoch:  12
epoch:  13 val_f1:  0.8041106719367591 val_auroc:  0.8616071428571429 val_auprc:  0.9329764953478201
Validation loss improved to 0.934403
epoch:  13
epoch:  14 val_f1:  0.7948558771909655 val_auroc:  0.8655753968253967 val_auprc:  0.9341748213810259
Validation loss improved to 0.926276
epoch:  14
epoch:  15 val_f1:  0.7563598080432068 val_auroc:  0.8707837301587301 val_auprc:  0.9373010764446787
Validation loss improved to 0.906592
epoch:  15
epoch:  16 val_f1:  0.7819511139952413 val_auroc:  0.8663194444444443 val_auprc:  0.9345455004360554
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7973334973248877 val_auroc:  0.8715277777777778 val_auprc:  0.9374203337522384
Validation loss improved to 0.866366
epoch:  17
epoch:  18 val_f1:  0.7905459035188288 val_auroc:  0.8727678571428572 val_auprc:  0.9383204605457593
Validation loss improved to 0.857991
epoch:  18
epoch:  19 val_f1:  0.7929485957015485 val_auroc:  0.8727678571428571 val_auprc:  0.9383029470979961
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7769308547872755 val_auroc:  0.8750000000000001 val_auprc:  0.9390797664569652
Validation loss improved to 0.836932
epoch:  20
epoch:  21 val_f1:  0.7833564971403972 val_auroc:  0.8759920634920636 val_auprc:  0.9393365734650468
Validation loss improved to 0.828567
epoch:  21
epoch:  22 val_f1:  0.7891335560760728 val_auroc:  0.8710317460317459 val_auprc:  0.9363692679514869
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7988956640912072 val_auroc:  0.869295634920635 val_auprc:  0.9357547006666517
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.770099160945843 val_auroc:  0.8735119047619048 val_auprc:  0.9380680636326058
Validation loss improved to 0.808013
epoch:  24
epoch:  25 val_f1:  0.7703937955759801 val_auroc:  0.8759920634920635 val_auprc:  0.9395707777237375
Validation loss improved to 0.802636
epoch:  25
epoch:  26 val_f1:  0.792371879328401 val_auroc:  0.8730158730158731 val_auprc:  0.9378925605593746
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.782608695652174 val_auroc:  0.8735119047619048 val_auprc:  0.9380960464257502
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7703937955759801 val_auroc:  0.8764880952380953 val_auprc:  0.9405122363000911
Validation loss improved to 0.791791
epoch:  28
epoch:  29 val_f1:  0.7771751194325146 val_auroc:  0.8752480158730159 val_auprc:  0.9394973678828327
Validation loss improved to 0.782869
epoch:  29
epoch:  30 val_f1:  0.8030193236714975 val_auroc:  0.8767361111111112 val_auprc:  0.940175032824768
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7810781559182691 val_auroc:  0.8717757936507936 val_auprc:  0.937747764915859
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.7810781559182691 val_auroc:  0.8727678571428572 val_auprc:  0.938022612713667
EarlyStopping counter: 3 out of 50
epoch:  32
epoch:  33 val_f1:  0.8036150464093796 val_auroc:  0.876736111111111 val_auprc:  0.9407336963190701
Validation loss improved to 0.780176
epoch:  33
epoch:  34 val_f1:  0.7769308547872755 val_auroc:  0.876736111111111 val_auprc:  0.9405850652044342
Validation loss improved to 0.775802
epoch:  34
epoch:  35 val_f1:  0.7810781559182691 val_auroc:  0.8707837301587301 val_auprc:  0.9371298560723986
EarlyStopping counter: 1 out of 50
epoch:  35
epoch:  36 val_f1:  0.7837062051498522 val_auroc:  0.867063492063492 val_auprc:  0.93499522246384
EarlyStopping counter: 2 out of 50
epoch:  36
epoch:  37 val_f1:  0.8281893869312926 val_auroc:  0.871279761904762 val_auprc:  0.9370068271164977
EarlyStopping counter: 3 out of 50
epoch:  37
epoch:  38 val_f1:  0.7973334973248877 val_auroc:  0.8749999999999999 val_auprc:  0.9403451767962347
Validation loss improved to 0.773242
epoch:  38
epoch:  39 val_f1:  0.7968706966496207 val_auroc:  0.8745039682539683 val_auprc:  0.9403154277832027
EarlyStopping counter: 1 out of 50
epoch:  39
epoch:  40 val_f1:  0.8138718358422335 val_auroc:  0.8705357142857143 val_auprc:  0.9382935187427448
EarlyStopping counter: 2 out of 50
epoch:  40
epoch:  41 val_f1:  0.8061683443992288 val_auroc:  0.8700396825396824 val_auprc:  0.938005004530734
EarlyStopping counter: 3 out of 50
epoch:  41
epoch:  42 val_f1:  0.7905459035188288 val_auroc:  0.8747519841269841 val_auprc:  0.9405126773207406
Validation loss improved to 0.764719
epoch:  42
epoch:  43 val_f1:  0.8156899810964081 val_auroc:  0.8745039682539681 val_auprc:  0.9402702228593955
EarlyStopping counter: 1 out of 50
epoch:  43
epoch:  44 val_f1:  0.7646850044365572 val_auroc:  0.8712797619047619 val_auprc:  0.9388655557351415
EarlyStopping counter: 2 out of 50
epoch:  44
epoch:  45 val_f1:  0.7755148741418765 val_auroc:  0.869295634920635 val_auprc:  0.9373523621082812
EarlyStopping counter: 3 out of 50
epoch:  45
epoch:  46 val_f1:  0.8061683443992288 val_auroc:  0.8715277777777777 val_auprc:  0.9379591896897052
EarlyStopping counter: 4 out of 50
epoch:  46
epoch:  47 val_f1:  0.7775412992804297 val_auroc:  0.8687996031746031 val_auprc:  0.9367572210311285
EarlyStopping counter: 5 out of 50
epoch:  47
epoch:  48 val_f1:  0.7884143290944841 val_auroc:  0.8678075396825398 val_auprc:  0.9368520935198739
EarlyStopping counter: 6 out of 50
epoch:  48
epoch:  49 val_f1:  0.7819511139952413 val_auroc:  0.8675595238095238 val_auprc:  0.9360327444967739
EarlyStopping counter: 7 out of 50
epoch:  49
epoch:  50 val_f1:  0.7884143290944841 val_auroc:  0.8687996031746031 val_auprc:  0.937425609592642
EarlyStopping counter: 8 out of 50
epoch:  50
epoch:  51 val_f1:  0.8036760694501368 val_auroc:  0.875 val_auprc:  0.9408852071946332
EarlyStopping counter: 9 out of 50
epoch:  51
epoch:  52 val_f1:  0.807228002894545 val_auroc:  0.8784722222222222 val_auprc:  0.9425179929037749
EarlyStopping counter: 10 out of 50
epoch:  52
epoch:  53 val_f1:  0.8005921770297647 val_auroc:  0.8774801587301587 val_auprc:  0.9422498340657883
EarlyStopping counter: 11 out of 50
epoch:  53
epoch:  54 val_f1:  0.8005921770297647 val_auroc:  0.8782242063492064 val_auprc:  0.9423717339619899
EarlyStopping counter: 12 out of 50
epoch:  54
epoch:  55 val_f1:  0.7833564971403972 val_auroc:  0.8804563492063492 val_auprc:  0.9433707148881726
Validation loss improved to 0.761191
epoch:  55
epoch:  56 val_f1:  0.7884143290944841 val_auroc:  0.8702876984126985 val_auprc:  0.9384617263714605
EarlyStopping counter: 1 out of 50
epoch:  56
epoch:  57 val_f1:  0.7884143290944841 val_auroc:  0.869047619047619 val_auprc:  0.9380490754012946
EarlyStopping counter: 2 out of 50
epoch:  57
epoch:  58 val_f1:  0.8005921770297647 val_auroc:  0.8772321428571429 val_auprc:  0.9415281326704319
EarlyStopping counter: 3 out of 50
epoch:  58
epoch:  59 val_f1:  0.8168793096329329 val_auroc:  0.8764880952380952 val_auprc:  0.9416550813775626
EarlyStopping counter: 4 out of 50
epoch:  59
epoch:  60 val_f1:  0.7969889682024659 val_auroc:  0.8737599206349206 val_auprc:  0.9399917152235044
EarlyStopping counter: 5 out of 50
epoch:  60
epoch:  61 val_f1:  0.8115942028985508 val_auroc:  0.8792162698412699 val_auprc:  0.9427235548021007
EarlyStopping counter: 6 out of 50
epoch:  61
epoch:  62 val_f1:  0.7969889682024659 val_auroc:  0.8757440476190477 val_auprc:  0.9411334810449205
EarlyStopping counter: 7 out of 50
epoch:  62
epoch:  63 val_f1:  0.8127933585226971 val_auroc:  0.8787202380952381 val_auprc:  0.9422522722543208
EarlyStopping counter: 8 out of 50
epoch:  63
epoch:  64 val_f1:  0.8127933585226971 val_auroc:  0.8812003968253969 val_auprc:  0.943514669094281
EarlyStopping counter: 9 out of 50
epoch:  64
epoch:  65 val_f1:  0.7969889682024659 val_auroc:  0.875 val_auprc:  0.9405682430039296
EarlyStopping counter: 10 out of 50
epoch:  65
epoch:  66 val_f1:  0.7861608411480533 val_auroc:  0.8727678571428571 val_auprc:  0.9396566706394189
EarlyStopping counter: 11 out of 50
epoch:  66
epoch:  67 val_f1:  0.8168793096329329 val_auroc:  0.8816964285714287 val_auprc:  0.9443714695834832
EarlyStopping counter: 12 out of 50
epoch:  67
epoch:  68 val_f1:  0.8137922815659323 val_auroc:  0.8789682539682541 val_auprc:  0.9426003227123708
EarlyStopping counter: 13 out of 50
epoch:  68
epoch:  69 val_f1:  0.8137922815659323 val_auroc:  0.8774801587301587 val_auprc:  0.9417691303690374
EarlyStopping counter: 14 out of 50
epoch:  69
epoch:  70 val_f1:  0.8194319840387783 val_auroc:  0.882936507936508 val_auprc:  0.9446742218553827
EarlyStopping counter: 15 out of 50
epoch:  70
epoch:  71 val_f1:  0.8315289648622983 val_auroc:  0.8826884920634922 val_auprc:  0.9443499087808186
EarlyStopping counter: 16 out of 50
epoch:  71
epoch:  72 val_f1:  0.8137922815659323 val_auroc:  0.8804563492063492 val_auprc:  0.9433416035406117
EarlyStopping counter: 17 out of 50
epoch:  72
epoch:  73 val_f1:  0.8137922815659323 val_auroc:  0.8777281746031748 val_auprc:  0.9422615264859221
EarlyStopping counter: 18 out of 50
epoch:  73
epoch:  74 val_f1:  0.7969889682024659 val_auroc:  0.873263888888889 val_auprc:  0.9403760566741879
EarlyStopping counter: 19 out of 50
epoch:  74
epoch:  75 val_f1:  0.8220330394243437 val_auroc:  0.8792162698412699 val_auprc:  0.9428802794838577
EarlyStopping counter: 20 out of 50
epoch:  75
epoch:  76 val_f1:  0.8315289648622983 val_auroc:  0.8816964285714285 val_auprc:  0.9437514694175039
EarlyStopping counter: 21 out of 50
epoch:  76
epoch:  77 val_f1:  0.8220330394243437 val_auroc:  0.8821924603174603 val_auprc:  0.9439482345716149
EarlyStopping counter: 22 out of 50
epoch:  77
epoch:  78 val_f1:  0.830174130951616 val_auroc:  0.8821924603174603 val_auprc:  0.9441592625863912
EarlyStopping counter: 23 out of 50
epoch:  78
epoch:  79 val_f1:  0.8235137533274179 val_auroc:  0.8812003968253969 val_auprc:  0.9436755670638911
EarlyStopping counter: 24 out of 50
epoch:  79
epoch:  80 val_f1:  0.8382209405501332 val_auroc:  0.880952380952381 val_auprc:  0.9433995588265536
EarlyStopping counter: 25 out of 50
epoch:  80
epoch:  81 val_f1:  0.8127933585226971 val_auroc:  0.8831845238095238 val_auprc:  0.9446044084693822
EarlyStopping counter: 26 out of 50
epoch:  81
epoch:  82 val_f1:  0.8220330394243437 val_auroc:  0.8824404761904762 val_auprc:  0.9442558161906329
EarlyStopping counter: 27 out of 50
epoch:  82
epoch:  83 val_f1:  0.8054462242562929 val_auroc:  0.8812003968253966 val_auprc:  0.9440609934889443
EarlyStopping counter: 28 out of 50
epoch:  83
epoch:  84 val_f1:  0.8054462242562929 val_auroc:  0.8789682539682541 val_auprc:  0.9429134861270199
EarlyStopping counter: 29 out of 50
epoch:  84
epoch:  85 val_f1:  0.8220330394243437 val_auroc:  0.8797123015873015 val_auprc:  0.9432961805961715
EarlyStopping counter: 30 out of 50
epoch:  85
epoch:  86 val_f1:  0.7884143290944841 val_auroc:  0.8814484126984127 val_auprc:  0.9440943655161871
EarlyStopping counter: 31 out of 50
epoch:  86
epoch:  87 val_f1:  0.8220330394243437 val_auroc:  0.8812003968253969 val_auprc:  0.9438401985799603
EarlyStopping counter: 32 out of 50
epoch:  87
epoch:  88 val_f1:  0.8327610961982647 val_auroc:  0.8846726190476192 val_auprc:  0.94627186981791
EarlyStopping counter: 33 out of 50
epoch:  88
epoch:  89 val_f1:  0.8327610961982647 val_auroc:  0.884920634920635 val_auprc:  0.946436127054294
EarlyStopping counter: 34 out of 50
epoch:  89
epoch:  90 val_f1:  0.8220330394243437 val_auroc:  0.8814484126984127 val_auprc:  0.943911437057501
EarlyStopping counter: 35 out of 50
epoch:  90
epoch:  91 val_f1:  0.7969889682024659 val_auroc:  0.8799603174603173 val_auprc:  0.9433014537693812
EarlyStopping counter: 36 out of 50
epoch:  91
epoch:  92 val_f1:  0.7969889682024659 val_auroc:  0.8807043650793651 val_auprc:  0.943624238765454
EarlyStopping counter: 37 out of 50
epoch:  92
epoch:  93 val_f1:  0.8072024593763724 val_auroc:  0.8821924603174603 val_auprc:  0.9452349691746619
EarlyStopping counter: 38 out of 50
epoch:  93
epoch:  94 val_f1:  0.8248625247346153 val_auroc:  0.8846726190476191 val_auprc:  0.9463220909255702
EarlyStopping counter: 39 out of 50
epoch:  94
epoch:  95 val_f1:  0.8168793096329329 val_auroc:  0.8839285714285714 val_auprc:  0.9457660373961665
EarlyStopping counter: 40 out of 50
epoch:  95
epoch:  96 val_f1:  0.8054462242562929 val_auroc:  0.8831845238095238 val_auprc:  0.9446363902012453
EarlyStopping counter: 41 out of 50
epoch:  96
epoch:  97 val_f1:  0.8168793096329329 val_auroc:  0.8836805555555556 val_auprc:  0.9457731750199562
EarlyStopping counter: 42 out of 50
epoch:  97
epoch:  98 val_f1:  0.8137922815659323 val_auroc:  0.8836805555555555 val_auprc:  0.9456033356102418
EarlyStopping counter: 43 out of 50
epoch:  98
epoch:  99 val_f1:  0.8137922815659323 val_auroc:  0.8839285714285715 val_auprc:  0.945256651959228
EarlyStopping counter: 44 out of 50
epoch:  99
epoch:  100 val_f1:  0.8327610961982647 val_auroc:  0.886656746031746 val_auprc:  0.9471978939090919
EarlyStopping counter: 45 out of 50
epoch:  100
epoch:  101 val_f1:  0.8327610961982647 val_auroc:  0.8864087301587301 val_auprc:  0.9469129945034294
EarlyStopping counter: 46 out of 50
epoch:  101
epoch:  102 val_f1:  0.8137922815659323 val_auroc:  0.8829365079365079 val_auprc:  0.9452216625786436
EarlyStopping counter: 47 out of 50
epoch:  102
epoch:  103 val_f1:  0.8248625247346153 val_auroc:  0.884920634920635 val_auprc:  0.9463025768255879
EarlyStopping counter: 48 out of 50
epoch:  103
epoch:  104 val_f1:  0.8154066640778435 val_auroc:  0.8844246031746031 val_auprc:  0.946015956346465
EarlyStopping counter: 49 out of 50
epoch:  104
epoch:  105 val_f1:  0.8248625247346153 val_auroc:  0.884920634920635 val_auprc:  0.9463302589778364
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  172.05880069732666
{'time_elapsed': [172.05880069732666], 'epoch': [104], 'fold': [4], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8248625247346153], 'auroc_test': [0.884920634920635], 'auprc_test': [0.9463302589778364]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 256]            3,072
│    └─BatchNorm1d: 2-2                  [64, 512, 256]            1,024
│    └─Tanh: 2-3                         [64, 512, 256]            --
│    └─MaxPool1d: 2-4                    [64, 512, 51]             --
│    └─Dropout: 2-5                      [64, 512, 51]             --
│    └─Flatten: 2-6                      [64, 26112]               --
│    └─Linear: 2-7                       [64, 1]                   26,113
==========================================================================================
Total params: 30,209
Trainable params: 30,209
Non-trainable params: 0
Total mult-adds (M): 52.07
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 134.22
Params size (MB): 0.12
Estimated Total Size (MB): 134.67
==========================================================================================
