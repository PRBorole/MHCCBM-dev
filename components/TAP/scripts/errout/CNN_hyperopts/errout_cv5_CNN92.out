config:  {'project': 'MHCCBM', 'name': 'CNN_92', 'config': {'hidden_channels': [128], 'epochs': 500, 'kernel_size': 7, 'pool_kernel_size': 7, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.16999056925104916 val_auroc:  0.7385861561119293 val_auprc:  0.8763172839208989
epoch:  1
epoch:  2 val_f1:  0.5736495549323253 val_auroc:  0.47336769759450176 val_auprc:  0.814052700264019
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.15251668649843964 val_auroc:  0.5522827687776142 val_auprc:  0.7135673009747476
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5849273851946482 val_auroc:  0.5138684339715267 val_auprc:  0.7131876091326366
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.48051298091961214 val_auroc:  0.5967108492881689 val_auprc:  0.7409850421124533
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6720404448027615 val_auroc:  0.657093765341188 val_auprc:  0.7964487422938713
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.667134140788635 val_auroc:  0.7633775159548356 val_auprc:  0.8960107379729235
Validation loss improved to 0.510752
epoch:  7
epoch:  8 val_f1:  0.7169009504644194 val_auroc:  0.7972508591065292 val_auprc:  0.9138752663051312
Validation loss improved to 0.362582
epoch:  8
epoch:  9 val_f1:  0.7287333672277241 val_auroc:  0.7724594992636229 val_auprc:  0.890235225372608
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7346924658075737 val_auroc:  0.7832596956308296 val_auprc:  0.8974368457168299
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.7304528631430115 val_auroc:  0.7945508100147276 val_auprc:  0.9069356102029233
EarlyStopping counter: 3 out of 50
epoch:  11
epoch:  12 val_f1:  0.7402181480621955 val_auroc:  0.7884143348060874 val_auprc:  0.9023263017789314
EarlyStopping counter: 4 out of 50
epoch:  12
epoch:  13 val_f1:  0.7510257046352308 val_auroc:  0.7989690721649484 val_auprc:  0.9082671653517914
EarlyStopping counter: 5 out of 50
epoch:  13
epoch:  14 val_f1:  0.766354189375772 val_auroc:  0.791850760922926 val_auprc:  0.9017062419811743
EarlyStopping counter: 6 out of 50
epoch:  14
epoch:  15 val_f1:  0.7519437633413868 val_auroc:  0.8021600392734413 val_auprc:  0.9112390169629448
EarlyStopping counter: 7 out of 50
epoch:  15
epoch:  16 val_f1:  0.7169642564307364 val_auroc:  0.8100147275405007 val_auprc:  0.9157168901597877
EarlyStopping counter: 8 out of 50
epoch:  16
epoch:  17 val_f1:  0.7239714721729109 val_auroc:  0.8080510554737358 val_auprc:  0.9140851057535875
EarlyStopping counter: 9 out of 50
epoch:  17
epoch:  18 val_f1:  0.770628190185282 val_auroc:  0.8090328915071183 val_auprc:  0.9140632660753089
EarlyStopping counter: 10 out of 50
epoch:  18
epoch:  19 val_f1:  0.7699730743399811 val_auroc:  0.8149239077074129 val_auprc:  0.9184473819520204
EarlyStopping counter: 11 out of 50
epoch:  19
epoch:  20 val_f1:  0.7445203699313053 val_auroc:  0.8222876779577811 val_auprc:  0.9234945699539803
EarlyStopping counter: 12 out of 50
epoch:  20
epoch:  21 val_f1:  0.702570289683208 val_auroc:  0.8286696121747669 val_auprc:  0.9270614579706591
EarlyStopping counter: 13 out of 50
epoch:  21
epoch:  22 val_f1:  0.758098723333472 val_auroc:  0.8161512027491409 val_auprc:  0.9190487307923547
EarlyStopping counter: 14 out of 50
epoch:  22
epoch:  23 val_f1:  0.7868059619290214 val_auroc:  0.8090328915071183 val_auprc:  0.9141384928032354
EarlyStopping counter: 15 out of 50
epoch:  23
epoch:  24 val_f1:  0.7745465218349855 val_auroc:  0.808541973490427 val_auprc:  0.9145768416565291
EarlyStopping counter: 16 out of 50
epoch:  24
epoch:  25 val_f1:  0.7727225509205256 val_auroc:  0.8070692194403535 val_auprc:  0.9117752451046837
EarlyStopping counter: 17 out of 50
epoch:  25
epoch:  26 val_f1:  0.7536606851900262 val_auroc:  0.8102601865488464 val_auprc:  0.9153315304721
EarlyStopping counter: 18 out of 50
epoch:  26
epoch:  27 val_f1:  0.7879228532067962 val_auroc:  0.8132056946489935 val_auprc:  0.9167346518607946
EarlyStopping counter: 19 out of 50
epoch:  27
epoch:  28 val_f1:  0.7748426784519089 val_auroc:  0.8168875797741778 val_auprc:  0.9209911775249833
EarlyStopping counter: 20 out of 50
epoch:  28
epoch:  29 val_f1:  0.7879228532067962 val_auroc:  0.8213058419243986 val_auprc:  0.9234604170774288
EarlyStopping counter: 21 out of 50
epoch:  29
epoch:  30 val_f1:  0.7791090204759269 val_auroc:  0.803632793323515 val_auprc:  0.9081864614730734
EarlyStopping counter: 22 out of 50
epoch:  30
epoch:  31 val_f1:  0.7727225509205256 val_auroc:  0.810505645557192 val_auprc:  0.916271417725497
EarlyStopping counter: 23 out of 50
epoch:  31
epoch:  32 val_f1:  0.7633714058926586 val_auroc:  0.8136966126656849 val_auprc:  0.9195937109329261
EarlyStopping counter: 24 out of 50
epoch:  32
epoch:  33 val_f1:  0.797175270999766 val_auroc:  0.8154148257241041 val_auprc:  0.917695530808091
EarlyStopping counter: 25 out of 50
epoch:  33
epoch:  34 val_f1:  0.7772753225990636 val_auroc:  0.8213058419243986 val_auprc:  0.9224375876876726
EarlyStopping counter: 26 out of 50
epoch:  34
epoch:  35 val_f1:  0.7651358509506568 val_auroc:  0.8281786941580757 val_auprc:  0.9283611130027387
EarlyStopping counter: 27 out of 50
epoch:  35
epoch:  36 val_f1:  0.7944676896257205 val_auroc:  0.8173784977908689 val_auprc:  0.9202359919872698
EarlyStopping counter: 28 out of 50
epoch:  36
epoch:  37 val_f1:  0.7831873586549224 val_auroc:  0.8205694648993618 val_auprc:  0.9228711985319644
EarlyStopping counter: 29 out of 50
epoch:  37
epoch:  38 val_f1:  0.7802930475309426 val_auroc:  0.8176239567992145 val_auprc:  0.9196842178977049
EarlyStopping counter: 30 out of 50
epoch:  38
epoch:  39 val_f1:  0.76000113614692 val_auroc:  0.8149239077074129 val_auprc:  0.9163538892136991
EarlyStopping counter: 31 out of 50
epoch:  39
epoch:  40 val_f1:  0.7802930475309426 val_auroc:  0.8166421207658322 val_auprc:  0.9191637589609527
EarlyStopping counter: 32 out of 50
epoch:  40
epoch:  41 val_f1:  0.778324933635979 val_auroc:  0.826705940108002 val_auprc:  0.9267459640530165
EarlyStopping counter: 33 out of 50
epoch:  41
epoch:  42 val_f1:  0.7786895152313162 val_auroc:  0.8333333333333333 val_auprc:  0.9314515581600655
EarlyStopping counter: 34 out of 50
epoch:  42
epoch:  43 val_f1:  0.7648576099332736 val_auroc:  0.8350515463917526 val_auprc:  0.9327922698900109
EarlyStopping counter: 35 out of 50
epoch:  43
epoch:  44 val_f1:  0.7757738305193033 val_auroc:  0.8247422680412372 val_auprc:  0.9257835888137661
EarlyStopping counter: 36 out of 50
epoch:  44
epoch:  45 val_f1:  0.7889150110486646 val_auroc:  0.8183603338242514 val_auprc:  0.9211038591494588
EarlyStopping counter: 37 out of 50
epoch:  45
epoch:  46 val_f1:  0.7954863587533922 val_auroc:  0.8203240058910162 val_auprc:  0.9228461495841817
EarlyStopping counter: 38 out of 50
epoch:  46
epoch:  47 val_f1:  0.7772753225990636 val_auroc:  0.8237604320078548 val_auprc:  0.9247268449441104
EarlyStopping counter: 39 out of 50
epoch:  47
epoch:  48 val_f1:  0.7725930260576229 val_auroc:  0.8168875797741778 val_auprc:  0.920109442548352
EarlyStopping counter: 40 out of 50
epoch:  48
epoch:  49 val_f1:  0.7765831291011147 val_auroc:  0.8203240058910162 val_auprc:  0.9230196829065137
EarlyStopping counter: 41 out of 50
epoch:  49
epoch:  50 val_f1:  0.7777125328082551 val_auroc:  0.8163966617574865 val_auprc:  0.9190529398747149
EarlyStopping counter: 42 out of 50
epoch:  50
epoch:  51 val_f1:  0.7699730743399811 val_auroc:  0.8235149729995092 val_auprc:  0.925283381257774
EarlyStopping counter: 43 out of 50
epoch:  51
epoch:  52 val_f1:  0.7790721385700611 val_auroc:  0.8200785468826707 val_auprc:  0.9228121456756212
EarlyStopping counter: 44 out of 50
epoch:  52
epoch:  53 val_f1:  0.7777125328082551 val_auroc:  0.8156602847324497 val_auprc:  0.9181689056456122
EarlyStopping counter: 45 out of 50
epoch:  53
epoch:  54 val_f1:  0.7622262794246104 val_auroc:  0.8092783505154639 val_auprc:  0.9123258990401352
EarlyStopping counter: 46 out of 50
epoch:  54
epoch:  55 val_f1:  0.76000113614692 val_auroc:  0.8181148748159057 val_auprc:  0.9188536276853448
EarlyStopping counter: 47 out of 50
epoch:  55
epoch:  56 val_f1:  0.7944676896257205 val_auroc:  0.8210603829160531 val_auprc:  0.9223033822414566
EarlyStopping counter: 48 out of 50
epoch:  56
epoch:  57 val_f1:  0.7963871971298289 val_auroc:  0.8178694158075602 val_auprc:  0.920980217672126
EarlyStopping counter: 49 out of 50
epoch:  57
epoch:  58 val_f1:  0.7683026725960121 val_auroc:  0.8247422680412371 val_auprc:  0.9261607980243596
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  212.74838590621948
{'time_elapsed': [212.74838590621948], 'epoch': [57], 'fold': [0], 'f1_train': [0.9892411295259068], 'auroc_train': [0.9998926939939295], 'auprc_train': [0.9999537968294148], 'f1_test': [0.7683026725960121], 'auroc_test': [0.8247422680412371], 'auprc_test': [0.9261607980243596]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1276]           1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 1276]           256
│    └─Tanh: 2-3                         [64, 128, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1270]           --
│    └─Dropout: 2-5                      [64, 128, 1270]           --
│    └─Flatten: 2-6                      [64, 162560]              --
│    └─Linear: 2-7                       [64, 1]                   162,561
==========================================================================================
Total params: 163,841
Trainable params: 163,841
Non-trainable params: 0
Total mult-adds (M): 94.04
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.25
Params size (MB): 0.66
Estimated Total Size (MB): 168.23
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.6566028473244969 val_auprc:  0.8490765757280635
epoch:  1
epoch:  2 val_f1:  0.5994295090243594 val_auroc:  0.644575355915562 val_auprc:  0.8495463566229656
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.3514449261186385 val_auroc:  0.6161021109474718 val_auprc:  0.8337344740230325
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5809183374303692 val_auroc:  0.6784486990672558 val_auprc:  0.8702804030556683
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6616621115306476 val_auroc:  0.7029945999018165 val_auprc:  0.8817910033667417
Validation loss improved to 0.702569
epoch:  5
epoch:  6 val_f1:  0.6557351278334286 val_auroc:  0.751840942562592 val_auprc:  0.9001771652356046
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.7519437633413868 val_auroc:  0.8102601865488462 val_auprc:  0.9246050419937066
Validation loss improved to 0.319616
epoch:  7
epoch:  8 val_f1:  0.7737843767539161 val_auroc:  0.8134511536573393 val_auprc:  0.921238827954686
Validation loss improved to 0.286582
epoch:  8
epoch:  9 val_f1:  0.7699730743399811 val_auroc:  0.8188512518409425 val_auprc:  0.9257361611325251
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7813819697019021 val_auroc:  0.8075601374570447 val_auprc:  0.9210254687721297
Validation loss improved to 0.279699
epoch:  10
epoch:  11 val_f1:  0.7239714721729109 val_auroc:  0.8046146293568974 val_auprc:  0.9207781770822023
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7170452552783244 val_auroc:  0.8080510554737359 val_auprc:  0.9220435208514861
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.7737843767539161 val_auroc:  0.8100147275405007 val_auprc:  0.918717569160284
Validation loss improved to 0.277577
epoch:  13
epoch:  14 val_f1:  0.7639705763479104 val_auroc:  0.8122238586156112 val_auprc:  0.9214453366709952
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.7889150110486646 val_auroc:  0.8168875797741777 val_auprc:  0.9228303812232213
EarlyStopping counter: 2 out of 50
epoch:  15
epoch:  16 val_f1:  0.7823449348629204 val_auroc:  0.8163966617574865 val_auprc:  0.9228322619187647
EarlyStopping counter: 3 out of 50
epoch:  16
epoch:  17 val_f1:  0.7099629667254643 val_auroc:  0.8151693667157585 val_auprc:  0.924531465977813
EarlyStopping counter: 4 out of 50
epoch:  17
epoch:  18 val_f1:  0.7307106601978622 val_auroc:  0.8159057437407954 val_auprc:  0.9223727263895417
EarlyStopping counter: 5 out of 50
epoch:  18
epoch:  19 val_f1:  0.7391701372600277 val_auroc:  0.8225331369661267 val_auprc:  0.923225596551293
Validation loss improved to 0.247445
epoch:  19
epoch:  20 val_f1:  0.7386752666832053 val_auroc:  0.8338242513500245 val_auprc:  0.9282376198118255
Validation loss improved to 0.237235
epoch:  20
epoch:  21 val_f1:  0.7745465218349855 val_auroc:  0.8298969072164949 val_auprc:  0.9257127827497682
Validation loss improved to 0.234504
epoch:  21
epoch:  22 val_f1:  0.7911956149366222 val_auroc:  0.8281786941580757 val_auprc:  0.9257890426823845
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7711689349644636 val_auroc:  0.8259695630829652 val_auprc:  0.9256672891166677
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.7845295119922345 val_auroc:  0.8286696121747669 val_auprc:  0.9257937637503828
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.7985611510791367 val_auroc:  0.8289150711831124 val_auprc:  0.9251736263184449
EarlyStopping counter: 4 out of 50
epoch:  25
epoch:  26 val_f1:  0.7879228532067962 val_auroc:  0.8271968581246933 val_auprc:  0.9251164990775204
EarlyStopping counter: 5 out of 50
epoch:  26
epoch:  27 val_f1:  0.7823449348629204 val_auroc:  0.8311242022582229 val_auprc:  0.925796123719579
EarlyStopping counter: 6 out of 50
epoch:  27
epoch:  28 val_f1:  0.766354189375772 val_auroc:  0.8244968090328915 val_auprc:  0.9198209158908697
Validation loss improved to 0.224628
epoch:  28
epoch:  29 val_f1:  0.7933255489848959 val_auroc:  0.833578792341679 val_auprc:  0.9253073777099989
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.7725930260576229 val_auroc:  0.8281786941580757 val_auprc:  0.9230581613019864
EarlyStopping counter: 2 out of 50
epoch:  30
epoch:  31 val_f1:  0.7826417810500232 val_auroc:  0.8289150711831125 val_auprc:  0.921646216769826
Validation loss improved to 0.221489
epoch:  31
epoch:  32 val_f1:  0.7559325673789327 val_auroc:  0.8193421698576338 val_auprc:  0.9179041204043755
EarlyStopping counter: 1 out of 50
epoch:  32
epoch:  33 val_f1:  0.7411406017655346 val_auroc:  0.8286696121747668 val_auprc:  0.9234026290453583
EarlyStopping counter: 2 out of 50
epoch:  33
epoch:  34 val_f1:  0.7963871971298289 val_auroc:  0.830387825233186 val_auprc:  0.9258217062522027
EarlyStopping counter: 3 out of 50
epoch:  34
epoch:  35 val_f1:  0.7559325673789327 val_auroc:  0.8335787923416789 val_auprc:  0.923632154381673
Validation loss improved to 0.202512
epoch:  35
epoch:  36 val_f1:  0.7244548447263693 val_auroc:  0.8249877270495827 val_auprc:  0.916989341417056
Validation loss improved to 0.189580
epoch:  36
epoch:  37 val_f1:  0.7954863587533922 val_auroc:  0.8247422680412372 val_auprc:  0.9222666835383643
EarlyStopping counter: 1 out of 50
epoch:  37
epoch:  38 val_f1:  0.7813819697019021 val_auroc:  0.8262150220913107 val_auprc:  0.921561181122349
EarlyStopping counter: 2 out of 50
epoch:  38
epoch:  39 val_f1:  0.7745465218349855 val_auroc:  0.8311242022582229 val_auprc:  0.9215952911624667
EarlyStopping counter: 3 out of 50
epoch:  39
epoch:  40 val_f1:  0.7762067639678805 val_auroc:  0.826705940108002 val_auprc:  0.9195311555514291
EarlyStopping counter: 4 out of 50
epoch:  40
epoch:  41 val_f1:  0.7473654218886486 val_auroc:  0.8306332842415316 val_auprc:  0.9205800436683961
EarlyStopping counter: 5 out of 50
epoch:  41
epoch:  42 val_f1:  0.7681512331200245 val_auroc:  0.8281786941580757 val_auprc:  0.9194294122144915
EarlyStopping counter: 6 out of 50
epoch:  42
epoch:  43 val_f1:  0.7745465218349855 val_auroc:  0.8306332842415316 val_auprc:  0.9205726047116558
EarlyStopping counter: 7 out of 50
epoch:  43
epoch:  44 val_f1:  0.7791090204759269 val_auroc:  0.8306332842415318 val_auprc:  0.9195990620649719
EarlyStopping counter: 8 out of 50
epoch:  44
epoch:  45 val_f1:  0.7777125328082551 val_auroc:  0.8225331369661266 val_auprc:  0.9173761855843143
EarlyStopping counter: 9 out of 50
epoch:  45
epoch:  46 val_f1:  0.7536081085870222 val_auroc:  0.8274423171330388 val_auprc:  0.9181754741542163
EarlyStopping counter: 10 out of 50
epoch:  46
epoch:  47 val_f1:  0.742136387976997 val_auroc:  0.8276877761413843 val_auprc:  0.9175640541114075
Validation loss improved to 0.182658
epoch:  47
epoch:  48 val_f1:  0.742136387976997 val_auroc:  0.8284241531664212 val_auprc:  0.9178690005667155
Validation loss improved to 0.181459
epoch:  48
epoch:  49 val_f1:  0.742136387976997 val_auroc:  0.8284241531664212 val_auprc:  0.9177107855380824
Validation loss improved to 0.175188
epoch:  49
epoch:  50 val_f1:  0.7598715939807772 val_auroc:  0.826705940108002 val_auprc:  0.915676649653073
EarlyStopping counter: 1 out of 50
epoch:  50
epoch:  51 val_f1:  0.7712620601193464 val_auroc:  0.8276877761413844 val_auprc:  0.9189038500279569
EarlyStopping counter: 2 out of 50
epoch:  51
epoch:  52 val_f1:  0.7748426784519089 val_auroc:  0.8205694648993618 val_auprc:  0.916882559137625
EarlyStopping counter: 3 out of 50
epoch:  52
epoch:  53 val_f1:  0.7955599157038007 val_auroc:  0.8306332842415317 val_auprc:  0.9189505767511716
EarlyStopping counter: 4 out of 50
epoch:  53
epoch:  54 val_f1:  0.748164418722312 val_auroc:  0.8271968581246932 val_auprc:  0.9118551362723775
Validation loss improved to 0.148471
epoch:  54
epoch:  55 val_f1:  0.7359369647139431 val_auroc:  0.8257241040746195 val_auprc:  0.9119456340863354
Validation loss improved to 0.147997
epoch:  55
epoch:  56 val_f1:  0.742136387976997 val_auroc:  0.8252331860579283 val_auprc:  0.9124945754627746
EarlyStopping counter: 1 out of 50
epoch:  56
epoch:  57 val_f1:  0.7826417810500232 val_auroc:  0.8230240549828178 val_auprc:  0.9143515803152624
EarlyStopping counter: 2 out of 50
epoch:  57
epoch:  58 val_f1:  0.7841726618705036 val_auroc:  0.8286696121747669 val_auprc:  0.918216002306936
EarlyStopping counter: 3 out of 50
epoch:  58
epoch:  59 val_f1:  0.7855581813618873 val_auroc:  0.8264604810996563 val_auprc:  0.9184337056893275
EarlyStopping counter: 4 out of 50
epoch:  59
epoch:  60 val_f1:  0.7762067639678805 val_auroc:  0.8252331860579283 val_auprc:  0.9166387438391853
EarlyStopping counter: 5 out of 50
epoch:  60
epoch:  61 val_f1:  0.7391671278361928 val_auroc:  0.8195876288659795 val_auprc:  0.91141022304869
EarlyStopping counter: 6 out of 50
epoch:  61
epoch:  62 val_f1:  0.7510724063582411 val_auroc:  0.824251350024546 val_auprc:  0.914196149296878
EarlyStopping counter: 7 out of 50
epoch:  62
epoch:  63 val_f1:  0.743396428458658 val_auroc:  0.8200785468826707 val_auprc:  0.912865565277884
EarlyStopping counter: 8 out of 50
epoch:  63
epoch:  64 val_f1:  0.7473654218886486 val_auroc:  0.8173784977908689 val_auprc:  0.9088689507981079
EarlyStopping counter: 9 out of 50
epoch:  64
epoch:  65 val_f1:  0.7890919075230509 val_auroc:  0.819833087874325 val_auprc:  0.910519757299229
EarlyStopping counter: 10 out of 50
epoch:  65
epoch:  66 val_f1:  0.7580594896895918 val_auroc:  0.8200785468826706 val_auprc:  0.9113765640615537
EarlyStopping counter: 11 out of 50
epoch:  66
epoch:  67 val_f1:  0.7448635686045757 val_auroc:  0.8205694648993618 val_auprc:  0.911412618818975
EarlyStopping counter: 12 out of 50
epoch:  67
epoch:  68 val_f1:  0.7510724063582411 val_auroc:  0.8208149239077074 val_auprc:  0.9116202698202183
EarlyStopping counter: 13 out of 50
epoch:  68
epoch:  69 val_f1:  0.7559325673789327 val_auroc:  0.8190967108492881 val_auprc:  0.9089378927431275
EarlyStopping counter: 14 out of 50
epoch:  69
epoch:  70 val_f1:  0.7762067639678805 val_auroc:  0.8159057437407953 val_auprc:  0.9085327020518869
EarlyStopping counter: 15 out of 50
epoch:  70
epoch:  71 val_f1:  0.7643829551743221 val_auroc:  0.8161512027491409 val_auprc:  0.9084879409630559
EarlyStopping counter: 16 out of 50
epoch:  71
epoch:  72 val_f1:  0.7559325673789327 val_auroc:  0.8156602847324497 val_auprc:  0.9085136832870422
EarlyStopping counter: 17 out of 50
epoch:  72
epoch:  73 val_f1:  0.7745465218349855 val_auroc:  0.8178694158075601 val_auprc:  0.9101798851367305
EarlyStopping counter: 18 out of 50
epoch:  73
epoch:  74 val_f1:  0.7448635686045757 val_auroc:  0.8208149239077075 val_auprc:  0.9110286251602537
EarlyStopping counter: 19 out of 50
epoch:  74
epoch:  75 val_f1:  0.7473654218886486 val_auroc:  0.8205694648993618 val_auprc:  0.9105980037166174
EarlyStopping counter: 20 out of 50
epoch:  75
epoch:  76 val_f1:  0.7643829551743221 val_auroc:  0.8205694648993618 val_auprc:  0.9113548402025078
EarlyStopping counter: 21 out of 50
epoch:  76
epoch:  77 val_f1:  0.7510724063582411 val_auroc:  0.8178694158075601 val_auprc:  0.9076525883648106
EarlyStopping counter: 22 out of 50
epoch:  77
epoch:  78 val_f1:  0.7559325673789327 val_auroc:  0.8190967108492881 val_auprc:  0.9100479974625049
EarlyStopping counter: 23 out of 50
epoch:  78
epoch:  79 val_f1:  0.7727225509205256 val_auroc:  0.8195876288659795 val_auprc:  0.910336642432879
EarlyStopping counter: 24 out of 50
epoch:  79
epoch:  80 val_f1:  0.7643829551743221 val_auroc:  0.8193421698576338 val_auprc:  0.9099346313587942
EarlyStopping counter: 25 out of 50
epoch:  80
epoch:  81 val_f1:  0.7473654218886486 val_auroc:  0.8190967108492881 val_auprc:  0.909874968693248
EarlyStopping counter: 26 out of 50
epoch:  81
epoch:  82 val_f1:  0.7386752666832053 val_auroc:  0.8205694648993618 val_auprc:  0.9113928346190798
EarlyStopping counter: 27 out of 50
epoch:  82
epoch:  83 val_f1:  0.7473654218886486 val_auroc:  0.8181148748159058 val_auprc:  0.9097594090468937
EarlyStopping counter: 28 out of 50
epoch:  83
epoch:  84 val_f1:  0.7536081085870222 val_auroc:  0.8190967108492881 val_auprc:  0.9097631240575689
EarlyStopping counter: 29 out of 50
epoch:  84
epoch:  85 val_f1:  0.7473654218886486 val_auroc:  0.8190967108492881 val_auprc:  0.9102045943354964
EarlyStopping counter: 30 out of 50
epoch:  85
epoch:  86 val_f1:  0.7712620601193464 val_auroc:  0.8151693667157585 val_auprc:  0.909582990496375
EarlyStopping counter: 31 out of 50
epoch:  86
epoch:  87 val_f1:  0.7777125328082551 val_auroc:  0.8154148257241041 val_auprc:  0.9089965247214975
EarlyStopping counter: 32 out of 50
epoch:  87
epoch:  88 val_f1:  0.766354189375772 val_auroc:  0.8181148748159058 val_auprc:  0.910283467909881
EarlyStopping counter: 33 out of 50
epoch:  88
epoch:  89 val_f1:  0.7473654218886486 val_auroc:  0.8200785468826706 val_auprc:  0.9109029565537774
EarlyStopping counter: 34 out of 50
epoch:  89
epoch:  90 val_f1:  0.7559325673789327 val_auroc:  0.8144329896907216 val_auprc:  0.9049524271041733
EarlyStopping counter: 35 out of 50
epoch:  90
epoch:  91 val_f1:  0.7777125328082551 val_auroc:  0.8139420716740304 val_auprc:  0.9082126312569231
EarlyStopping counter: 36 out of 50
epoch:  91
epoch:  92 val_f1:  0.7643829551743221 val_auroc:  0.818605792832597 val_auprc:  0.9103656073780461
EarlyStopping counter: 37 out of 50
epoch:  92
epoch:  93 val_f1:  0.7496568898727172 val_auroc:  0.8161512027491409 val_auprc:  0.9086641945028053
EarlyStopping counter: 38 out of 50
epoch:  93
epoch:  94 val_f1:  0.7386752666832053 val_auroc:  0.8189739813451153 val_auprc:  0.9093496267054714
EarlyStopping counter: 39 out of 50
epoch:  94
epoch:  95 val_f1:  0.7510724063582411 val_auroc:  0.8181148748159058 val_auprc:  0.9070788821812514
EarlyStopping counter: 40 out of 50
epoch:  95
epoch:  96 val_f1:  0.7448635686045757 val_auroc:  0.8146784486990672 val_auprc:  0.9044092710546878
EarlyStopping counter: 41 out of 50
epoch:  96
epoch:  97 val_f1:  0.7473654218886486 val_auroc:  0.8181148748159057 val_auprc:  0.9094133906300541
EarlyStopping counter: 42 out of 50
epoch:  97
epoch:  98 val_f1:  0.7559325673789327 val_auroc:  0.8144329896907216 val_auprc:  0.907502745852508
EarlyStopping counter: 43 out of 50
epoch:  98
epoch:  99 val_f1:  0.766354189375772 val_auroc:  0.8154148257241041 val_auprc:  0.9083410611950635
EarlyStopping counter: 44 out of 50
epoch:  99
epoch:  100 val_f1:  0.7643829551743221 val_auroc:  0.8171330387825233 val_auprc:  0.9096217477108935
EarlyStopping counter: 45 out of 50
epoch:  100
epoch:  101 val_f1:  0.7536081085870222 val_auroc:  0.8166421207658321 val_auprc:  0.9079377718056957
EarlyStopping counter: 46 out of 50
epoch:  101
epoch:  102 val_f1:  0.7777125328082551 val_auroc:  0.8136966126656848 val_auprc:  0.9082149656274092
EarlyStopping counter: 47 out of 50
epoch:  102
epoch:  103 val_f1:  0.7712620601193464 val_auroc:  0.8127147766323024 val_auprc:  0.9078511491304239
EarlyStopping counter: 48 out of 50
epoch:  103
epoch:  104 val_f1:  0.7777125328082551 val_auroc:  0.8122238586156112 val_auprc:  0.9076705326834835
EarlyStopping counter: 49 out of 50
epoch:  104
epoch:  105 val_f1:  0.7777125328082551 val_auroc:  0.8132056946489937 val_auprc:  0.908043973344506
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  386.5145175457001
{'time_elapsed': [386.5145175457001], 'epoch': [104], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7777125328082551], 'auroc_test': [0.8132056946489937], 'auprc_test': [0.908043973344506]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1276]           1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 1276]           256
│    └─Tanh: 2-3                         [64, 128, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1270]           --
│    └─Dropout: 2-5                      [64, 128, 1270]           --
│    └─Flatten: 2-6                      [64, 162560]              --
│    └─Linear: 2-7                       [64, 1]                   162,561
==========================================================================================
Total params: 163,841
Trainable params: 163,841
Non-trainable params: 0
Total mult-adds (M): 94.04
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.25
Params size (MB): 0.66
Estimated Total Size (MB): 168.23
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.5 val_auprc:  0.8489208633093526
epoch:  1
epoch:  2 val_f1:  0.13764988009592327 val_auroc:  0.6747668139420716 val_auprc:  0.7914460716604235
Validation loss improved to 3.130643
epoch:  2
epoch:  3 val_f1:  0.6084646238081013 val_auroc:  0.6503436426116839 val_auprc:  0.7891301181616933
Validation loss improved to 0.506190
epoch:  3
epoch:  4 val_f1:  0.22913297497761753 val_auroc:  0.7002945508100147 val_auprc:  0.8035344225204708
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.6358450082039632 val_auroc:  0.7128129602356407 val_auprc:  0.8102995286118286
Validation loss improved to 0.353427
epoch:  5
epoch:  6 val_f1:  0.4282811359095257 val_auroc:  0.7542955326460481 val_auprc:  0.870713319958472
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.6476562574960038 val_auroc:  0.7250859106529209 val_auprc:  0.8398436253291881
EarlyStopping counter: 2 out of 50
epoch:  7
epoch:  8 val_f1:  0.7107661257285465 val_auroc:  0.7491408934707904 val_auprc:  0.8535743937287955
EarlyStopping counter: 3 out of 50
epoch:  8
epoch:  9 val_f1:  0.730071543320129 val_auroc:  0.7695139911634757 val_auprc:  0.8783637132216037
Validation loss improved to 0.347359
epoch:  9
epoch:  10 val_f1:  0.6451024231755431 val_auroc:  0.7709867452135494 val_auprc:  0.8787818745849771
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.7236892364125374 val_auroc:  0.7690230731467845 val_auprc:  0.8724097642548694
EarlyStopping counter: 2 out of 50
epoch:  11
epoch:  12 val_f1:  0.7122302158273381 val_auroc:  0.7776141384388807 val_auprc:  0.8781557459378284
EarlyStopping counter: 3 out of 50
epoch:  12
epoch:  13 val_f1:  0.7176437068167247 val_auroc:  0.7869415807560137 val_auprc:  0.8886592765328304
Validation loss improved to 0.334047
epoch:  13
epoch:  14 val_f1:  0.7249644134959412 val_auroc:  0.7788414334806087 val_auprc:  0.8874480266565258
Validation loss improved to 0.328809
epoch:  14
epoch:  15 val_f1:  0.7455074238481555 val_auroc:  0.7903780068728522 val_auprc:  0.8928499723399611
Validation loss improved to 0.324217
epoch:  15
epoch:  16 val_f1:  0.7428255465713769 val_auroc:  0.7898870888561611 val_auprc:  0.8935994549608107
Validation loss improved to 0.318217
epoch:  16
epoch:  17 val_f1:  0.6956980834430598 val_auroc:  0.773686794305351 val_auprc:  0.8856116392615203
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.7376969013024874 val_auroc:  0.7866961217476681 val_auprc:  0.89342053414376
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.730071543320129 val_auroc:  0.7854688267059401 val_auprc:  0.8914172922732663
EarlyStopping counter: 3 out of 50
epoch:  19
epoch:  20 val_f1:  0.7229061670449737 val_auroc:  0.7810505645557193 val_auprc:  0.8899467756036487
EarlyStopping counter: 4 out of 50
epoch:  20
epoch:  21 val_f1:  0.7266187050359713 val_auroc:  0.793078055964654 val_auprc:  0.8964158378494572
Validation loss improved to 0.317535
epoch:  21
epoch:  22 val_f1:  0.7299542184434271 val_auroc:  0.788659793814433 val_auprc:  0.8932156495893242
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7249644134959412 val_auroc:  0.7835051546391752 val_auprc:  0.8901683054220343
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.7162290583621869 val_auroc:  0.7835051546391752 val_auprc:  0.8917481229484221
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.7142089711496735 val_auroc:  0.7854688267059401 val_auprc:  0.8926443374413288
EarlyStopping counter: 4 out of 50
epoch:  25
epoch:  26 val_f1:  0.7122302158273381 val_auroc:  0.7778595974472262 val_auprc:  0.8851056283370938
EarlyStopping counter: 5 out of 50
epoch:  26
epoch:  27 val_f1:  0.7184536707983012 val_auroc:  0.7933235149729996 val_auprc:  0.8964614892931
EarlyStopping counter: 6 out of 50
epoch:  27
epoch:  28 val_f1:  0.7101890414000308 val_auroc:  0.7911143838978891 val_auprc:  0.8948599229475893
EarlyStopping counter: 7 out of 50
epoch:  28
epoch:  29 val_f1:  0.7140775751491829 val_auroc:  0.7825233186057928 val_auprc:  0.8887142446070929
EarlyStopping counter: 8 out of 50
epoch:  29
epoch:  30 val_f1:  0.7157412825720284 val_auroc:  0.7871870397643593 val_auprc:  0.8925189197614806
EarlyStopping counter: 9 out of 50
epoch:  30
epoch:  31 val_f1:  0.7140775751491829 val_auroc:  0.7962690230731468 val_auprc:  0.9002187616430546
EarlyStopping counter: 10 out of 50
epoch:  31
epoch:  32 val_f1:  0.7030919944895149 val_auroc:  0.7788414334806089 val_auprc:  0.8843772730341902
EarlyStopping counter: 11 out of 50
epoch:  32
epoch:  33 val_f1:  0.7266187050359713 val_auroc:  0.7874324987727049 val_auprc:  0.8906817882168558
EarlyStopping counter: 12 out of 50
epoch:  33
epoch:  34 val_f1:  0.7094198370570532 val_auroc:  0.7849779086892489 val_auprc:  0.887640314641188
EarlyStopping counter: 13 out of 50
epoch:  34
epoch:  35 val_f1:  0.7281499969472504 val_auroc:  0.7871870397643594 val_auprc:  0.8944612144851763
EarlyStopping counter: 14 out of 50
epoch:  35
epoch:  36 val_f1:  0.7157412825720284 val_auroc:  0.7670594010800197 val_auprc:  0.8775255158237272
EarlyStopping counter: 15 out of 50
epoch:  36
epoch:  37 val_f1:  0.7263486361521366 val_auroc:  0.7857142857142858 val_auprc:  0.8924218337968979
EarlyStopping counter: 16 out of 50
epoch:  37
epoch:  38 val_f1:  0.7140775751491829 val_auroc:  0.7847324496809033 val_auprc:  0.8887471707361244
EarlyStopping counter: 17 out of 50
epoch:  38
epoch:  39 val_f1:  0.7140775751491829 val_auroc:  0.7827687776141384 val_auprc:  0.8870171458667729
EarlyStopping counter: 18 out of 50
epoch:  39
epoch:  40 val_f1:  0.7023865734042448 val_auroc:  0.7670594010800197 val_auprc:  0.8793144659142184
EarlyStopping counter: 19 out of 50
epoch:  40
epoch:  41 val_f1:  0.7281499969472504 val_auroc:  0.7822778595974472 val_auprc:  0.8914944374999554
Validation loss improved to 0.307123
epoch:  41
epoch:  42 val_f1:  0.722058496910722 val_auroc:  0.7832596956308296 val_auprc:  0.8862495857469878
EarlyStopping counter: 1 out of 50
epoch:  42
epoch:  43 val_f1:  0.743396428458658 val_auroc:  0.7947962690230731 val_auprc:  0.896632242953007
EarlyStopping counter: 2 out of 50
epoch:  43
epoch:  44 val_f1:  0.717230470942395 val_auroc:  0.7847324496809033 val_auprc:  0.8878829571697107
EarlyStopping counter: 3 out of 50
epoch:  44
epoch:  45 val_f1:  0.7283736963917239 val_auroc:  0.7822778595974472 val_auprc:  0.8877468219302218
EarlyStopping counter: 4 out of 50
epoch:  45
epoch:  46 val_f1:  0.7225455998837295 val_auroc:  0.7812960235640648 val_auprc:  0.8861512350728338
EarlyStopping counter: 5 out of 50
epoch:  46
epoch:  47 val_f1:  0.7287333672277241 val_auroc:  0.7839960726558665 val_auprc:  0.8878973302309308
EarlyStopping counter: 6 out of 50
epoch:  47
epoch:  48 val_f1:  0.7298555432283743 val_auroc:  0.7847324496809034 val_auprc:  0.8883066389958257
EarlyStopping counter: 7 out of 50
epoch:  48
epoch:  49 val_f1:  0.7263486361521366 val_auroc:  0.7884143348060874 val_auprc:  0.8915905187875771
EarlyStopping counter: 8 out of 50
epoch:  49
epoch:  50 val_f1:  0.726967940210938 val_auroc:  0.7776141384388807 val_auprc:  0.8802209035310005
EarlyStopping counter: 9 out of 50
epoch:  50
epoch:  51 val_f1:  0.7140775751491829 val_auroc:  0.7781050564555719 val_auprc:  0.8840183725263746
EarlyStopping counter: 10 out of 50
epoch:  51
epoch:  52 val_f1:  0.6889535180366346 val_auroc:  0.7734413352970054 val_auprc:  0.8820312510848689
EarlyStopping counter: 11 out of 50
epoch:  52
epoch:  53 val_f1:  0.7281499969472504 val_auroc:  0.7670594010800196 val_auprc:  0.877338634619091
EarlyStopping counter: 12 out of 50
epoch:  53
epoch:  54 val_f1:  0.7121336235283787 val_auroc:  0.7719685812469318 val_auprc:  0.8806494761386927
EarlyStopping counter: 13 out of 50
epoch:  54
epoch:  55 val_f1:  0.7246795893300292 val_auroc:  0.7795778105056457 val_auprc:  0.8828139246384754
EarlyStopping counter: 14 out of 50
epoch:  55
epoch:  56 val_f1:  0.7202047592695074 val_auroc:  0.7798232695139912 val_auprc:  0.8858851158961485
EarlyStopping counter: 15 out of 50
epoch:  56
epoch:  57 val_f1:  0.7325045643526866 val_auroc:  0.7719685812469318 val_auprc:  0.8762100441387617
EarlyStopping counter: 16 out of 50
epoch:  57
epoch:  58 val_f1:  0.7202047592695074 val_auroc:  0.7800687285223368 val_auprc:  0.8858362195216594
EarlyStopping counter: 17 out of 50
epoch:  58
epoch:  59 val_f1:  0.7202047592695074 val_auroc:  0.7727049582719686 val_auprc:  0.8772830637022959
EarlyStopping counter: 18 out of 50
epoch:  59
epoch:  60 val_f1:  0.7325045643526866 val_auroc:  0.7781050564555719 val_auprc:  0.8816124540185717
EarlyStopping counter: 19 out of 50
epoch:  60
epoch:  61 val_f1:  0.7263486361521366 val_auroc:  0.7744231713303877 val_auprc:  0.8780521558074289
EarlyStopping counter: 20 out of 50
epoch:  61
epoch:  62 val_f1:  0.7283736963917239 val_auroc:  0.7729504172803142 val_auprc:  0.8773553999979727
EarlyStopping counter: 21 out of 50
epoch:  62
epoch:  63 val_f1:  0.7363119073255568 val_auroc:  0.7744231713303878 val_auprc:  0.8791278956189419
EarlyStopping counter: 22 out of 50
epoch:  63
epoch:  64 val_f1:  0.7263486361521366 val_auroc:  0.772459499263623 val_auprc:  0.876536005519084
EarlyStopping counter: 23 out of 50
epoch:  64
epoch:  65 val_f1:  0.7225455998837295 val_auroc:  0.7749140893470791 val_auprc:  0.8787521164592937
EarlyStopping counter: 24 out of 50
epoch:  65
epoch:  66 val_f1:  0.7346891520614657 val_auroc:  0.768041237113402 val_auprc:  0.8740331328190311
EarlyStopping counter: 25 out of 50
epoch:  66
epoch:  67 val_f1:  0.7325045643526866 val_auroc:  0.7707412862052038 val_auprc:  0.8767015200513417
EarlyStopping counter: 26 out of 50
epoch:  67
epoch:  68 val_f1:  0.7325045643526866 val_auroc:  0.7717231222385862 val_auprc:  0.876796758127578
EarlyStopping counter: 27 out of 50
epoch:  68
epoch:  69 val_f1:  0.7140703059967902 val_auroc:  0.7697594501718213 val_auprc:  0.8747407011603106
EarlyStopping counter: 28 out of 50
epoch:  69
epoch:  70 val_f1:  0.7325045643526866 val_auroc:  0.7704958271968582 val_auprc:  0.8739014359684585
EarlyStopping counter: 29 out of 50
epoch:  70
epoch:  71 val_f1:  0.7148475178521729 val_auroc:  0.7717231222385862 val_auprc:  0.878228838433994
EarlyStopping counter: 30 out of 50
epoch:  71
epoch:  72 val_f1:  0.7237424247793883 val_auroc:  0.7707412862052038 val_auprc:  0.8727724430805259
EarlyStopping counter: 31 out of 50
epoch:  72
epoch:  73 val_f1:  0.7325045643526866 val_auroc:  0.7685321551300933 val_auprc:  0.872729606433411
EarlyStopping counter: 32 out of 50
epoch:  73
epoch:  74 val_f1:  0.7325045643526866 val_auroc:  0.7704958271968582 val_auprc:  0.87350736075303
EarlyStopping counter: 33 out of 50
epoch:  74
epoch:  75 val_f1:  0.7325045643526866 val_auroc:  0.7717231222385862 val_auprc:  0.8750501862282776
EarlyStopping counter: 34 out of 50
epoch:  75
epoch:  76 val_f1:  0.7117994924448791 val_auroc:  0.7704958271968582 val_auprc:  0.8738384141514596
EarlyStopping counter: 35 out of 50
epoch:  76
epoch:  77 val_f1:  0.7325045643526866 val_auroc:  0.7655866470299459 val_auprc:  0.868645825761616
EarlyStopping counter: 36 out of 50
epoch:  77
epoch:  78 val_f1:  0.7263486361521366 val_auroc:  0.7741777123220421 val_auprc:  0.8774793996394936
EarlyStopping counter: 37 out of 50
epoch:  78
epoch:  79 val_f1:  0.7325045643526866 val_auroc:  0.7682866961217477 val_auprc:  0.8715357553237957
EarlyStopping counter: 38 out of 50
epoch:  79
epoch:  80 val_f1:  0.7263486361521366 val_auroc:  0.7650957290132548 val_auprc:  0.8701036298704589
EarlyStopping counter: 39 out of 50
epoch:  80
epoch:  81 val_f1:  0.7410071942446043 val_auroc:  0.7646048109965635 val_auprc:  0.8696379816391173
EarlyStopping counter: 40 out of 50
epoch:  81
epoch:  82 val_f1:  0.7328919440906961 val_auroc:  0.7685321551300933 val_auprc:  0.8739577489160729
EarlyStopping counter: 41 out of 50
epoch:  82
epoch:  83 val_f1:  0.7309103647707891 val_auroc:  0.7670594010800196 val_auprc:  0.8721731645699959
EarlyStopping counter: 42 out of 50
epoch:  83
epoch:  84 val_f1:  0.7287333672277241 val_auroc:  0.7648502700049092 val_auprc:  0.8692543500035861
EarlyStopping counter: 43 out of 50
epoch:  84
epoch:  85 val_f1:  0.7287333672277241 val_auroc:  0.7658321060382915 val_auprc:  0.8701163531831666
EarlyStopping counter: 44 out of 50
epoch:  85
epoch:  86 val_f1:  0.7287333672277241 val_auroc:  0.7650957290132547 val_auprc:  0.8698524997922938
EarlyStopping counter: 45 out of 50
epoch:  86
epoch:  87 val_f1:  0.7411406017655346 val_auroc:  0.7626411389297988 val_auprc:  0.8681147909755969
EarlyStopping counter: 46 out of 50
epoch:  87
epoch:  88 val_f1:  0.7411406017655346 val_auroc:  0.7633775159548356 val_auprc:  0.8684794055572547
EarlyStopping counter: 47 out of 50
epoch:  88
epoch:  89 val_f1:  0.7349308245711123 val_auroc:  0.765586647029946 val_auprc:  0.8700150818729947
EarlyStopping counter: 48 out of 50
epoch:  89
epoch:  90 val_f1:  0.7325045643526866 val_auroc:  0.7616593028964164 val_auprc:  0.8681637490258596
EarlyStopping counter: 49 out of 50
epoch:  90
epoch:  91 val_f1:  0.7325045643526866 val_auroc:  0.7653411880216004 val_auprc:  0.8704328991012705
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  338.19158935546875
{'time_elapsed': [338.19158935546875], 'epoch': [90], 'fold': [2], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7325045643526866], 'auroc_test': [0.7653411880216004], 'auprc_test': [0.8704328991012705]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1276]           1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 1276]           256
│    └─Tanh: 2-3                         [64, 128, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1270]           --
│    └─Dropout: 2-5                      [64, 128, 1270]           --
│    └─Flatten: 2-6                      [64, 162560]              --
│    └─Linear: 2-7                       [64, 1]                   162,561
==========================================================================================
Total params: 163,841
Trainable params: 163,841
Non-trainable params: 0
Total mult-adds (M): 94.04
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.25
Params size (MB): 0.66
Estimated Total Size (MB): 168.23
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5642736874330323 val_auroc:  0.595203488372093 val_auprc:  0.7393887528149388
epoch:  1
epoch:  2 val_f1:  0.6746013647649861 val_auroc:  0.6858042635658914 val_auprc:  0.7941813694261532
Validation loss improved to 0.107427
epoch:  2
epoch:  3 val_f1:  0.5595046350978917 val_auroc:  0.7344961240310078 val_auprc:  0.8379515937021338
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.4496266794886915 val_auroc:  0.8141957364341086 val_auprc:  0.912121304431813
EarlyStopping counter: 2 out of 50
epoch:  4
epoch:  5 val_f1:  0.6994791931160953 val_auroc:  0.8207364341085271 val_auprc:  0.921869056230025
EarlyStopping counter: 3 out of 50
epoch:  5
epoch:  6 val_f1:  0.7435892899059994 val_auroc:  0.8311531007751938 val_auprc:  0.9278585960875736
EarlyStopping counter: 4 out of 50
epoch:  6
epoch:  7 val_f1:  0.7783357627623393 val_auroc:  0.8340600775193798 val_auprc:  0.9258163637693303
EarlyStopping counter: 5 out of 50
epoch:  7
epoch:  8 val_f1:  0.7714826564458221 val_auroc:  0.8403585271317829 val_auprc:  0.9279615751414505
EarlyStopping counter: 6 out of 50
epoch:  8
epoch:  9 val_f1:  0.7706506750217025 val_auroc:  0.8381782945736433 val_auprc:  0.926195725884251
EarlyStopping counter: 7 out of 50
epoch:  9
epoch:  10 val_f1:  0.7912899626822607 val_auroc:  0.8435077519379844 val_auprc:  0.9307200645835235
EarlyStopping counter: 8 out of 50
epoch:  10
epoch:  11 val_f1:  0.7368544189039011 val_auroc:  0.8476259689922481 val_auprc:  0.9352148458210887
EarlyStopping counter: 9 out of 50
epoch:  11
epoch:  12 val_f1:  0.7932273763653603 val_auroc:  0.8495639534883721 val_auprc:  0.9347284963641866
EarlyStopping counter: 10 out of 50
epoch:  12
epoch:  13 val_f1:  0.7820584602206068 val_auroc:  0.8493217054263565 val_auprc:  0.9333159412833332
EarlyStopping counter: 11 out of 50
epoch:  13
epoch:  14 val_f1:  0.7932273763653603 val_auroc:  0.8495639534883721 val_auprc:  0.9347980655271859
EarlyStopping counter: 12 out of 50
epoch:  14
epoch:  15 val_f1:  0.7841726618705036 val_auroc:  0.8544089147286821 val_auprc:  0.9361026745081646
EarlyStopping counter: 13 out of 50
epoch:  15
epoch:  16 val_f1:  0.7701596400342386 val_auroc:  0.8551356589147285 val_auprc:  0.9401791783158413
EarlyStopping counter: 14 out of 50
epoch:  16
epoch:  17 val_f1:  0.7894843465886632 val_auroc:  0.8558624031007752 val_auprc:  0.9392506583437152
EarlyStopping counter: 15 out of 50
epoch:  17
epoch:  18 val_f1:  0.764639197732723 val_auroc:  0.8570736434108527 val_auprc:  0.9377855066691535
EarlyStopping counter: 16 out of 50
epoch:  18
epoch:  19 val_f1:  0.7768873694675612 val_auroc:  0.8597383720930232 val_auprc:  0.9382870555841327
EarlyStopping counter: 17 out of 50
epoch:  19
epoch:  20 val_f1:  0.7985611510791367 val_auroc:  0.8565891472868217 val_auprc:  0.9402922832771992
EarlyStopping counter: 18 out of 50
epoch:  20
epoch:  21 val_f1:  0.7745758989478168 val_auroc:  0.8582848837209303 val_auprc:  0.940120121816435
EarlyStopping counter: 19 out of 50
epoch:  21
epoch:  22 val_f1:  0.7507614687470803 val_auroc:  0.8563468992248061 val_auprc:  0.9412504030550406
EarlyStopping counter: 20 out of 50
epoch:  22
epoch:  23 val_f1:  0.7866727894280321 val_auroc:  0.8558624031007752 val_auprc:  0.9411177559582993
EarlyStopping counter: 21 out of 50
epoch:  23
epoch:  24 val_f1:  0.7827158008497472 val_auroc:  0.8616763565891473 val_auprc:  0.942053485814457
EarlyStopping counter: 22 out of 50
epoch:  24
epoch:  25 val_f1:  0.7603368061152953 val_auroc:  0.8640988372093024 val_auprc:  0.9413544825932367
EarlyStopping counter: 23 out of 50
epoch:  25
epoch:  26 val_f1:  0.794309372388086 val_auroc:  0.8616763565891472 val_auprc:  0.9439274205277244
EarlyStopping counter: 24 out of 50
epoch:  26
epoch:  27 val_f1:  0.7768458491633659 val_auroc:  0.8563468992248061 val_auprc:  0.9417316808446922
EarlyStopping counter: 25 out of 50
epoch:  27
epoch:  28 val_f1:  0.7961192047225032 val_auroc:  0.8624031007751939 val_auprc:  0.9437967298158564
EarlyStopping counter: 26 out of 50
epoch:  28
epoch:  29 val_f1:  0.794309372388086 val_auroc:  0.8650678294573643 val_auprc:  0.9447318814683799
EarlyStopping counter: 27 out of 50
epoch:  29
epoch:  30 val_f1:  0.8027539115793398 val_auroc:  0.8657945736434108 val_auprc:  0.9446752150610036
EarlyStopping counter: 28 out of 50
epoch:  30
epoch:  31 val_f1:  0.8035187234827523 val_auroc:  0.8645833333333334 val_auprc:  0.9440289034369596
EarlyStopping counter: 29 out of 50
epoch:  31
epoch:  32 val_f1:  0.7972014141264308 val_auroc:  0.8662790697674418 val_auprc:  0.9431525523211706
EarlyStopping counter: 30 out of 50
epoch:  32
epoch:  33 val_f1:  0.776244301724119 val_auroc:  0.8684593023255813 val_auprc:  0.9447935091369289
EarlyStopping counter: 31 out of 50
epoch:  33
epoch:  34 val_f1:  0.8018807955038493 val_auroc:  0.8657945736434107 val_auprc:  0.9432558685868285
EarlyStopping counter: 32 out of 50
epoch:  34
epoch:  35 val_f1:  0.7901923359271766 val_auroc:  0.8679748062015504 val_auprc:  0.9455602562972145
EarlyStopping counter: 33 out of 50
epoch:  35
epoch:  36 val_f1:  0.8101799492243995 val_auroc:  0.8662790697674418 val_auprc:  0.9447688809114286
EarlyStopping counter: 34 out of 50
epoch:  36
epoch:  37 val_f1:  0.7729252582141845 val_auroc:  0.8701550387596899 val_auprc:  0.9442227743116132
EarlyStopping counter: 35 out of 50
epoch:  37
epoch:  38 val_f1:  0.7420493511732671 val_auroc:  0.8718507751937984 val_auprc:  0.9439738948117138
EarlyStopping counter: 36 out of 50
epoch:  38
epoch:  39 val_f1:  0.7774211400110681 val_auroc:  0.8667635658914729 val_auprc:  0.9441866642158239
EarlyStopping counter: 37 out of 50
epoch:  39
epoch:  40 val_f1:  0.8074875573056803 val_auroc:  0.8611918604651162 val_auprc:  0.9433319418176378
EarlyStopping counter: 38 out of 50
epoch:  40
epoch:  41 val_f1:  0.7835226993620948 val_auroc:  0.8561046511627907 val_auprc:  0.9425948137892094
EarlyStopping counter: 39 out of 50
epoch:  41
epoch:  42 val_f1:  0.794309372388086 val_auroc:  0.8667635658914729 val_auprc:  0.9449904398207482
EarlyStopping counter: 40 out of 50
epoch:  42
epoch:  43 val_f1:  0.794309372388086 val_auroc:  0.8701550387596898 val_auprc:  0.9462818023412447
EarlyStopping counter: 41 out of 50
epoch:  43
epoch:  44 val_f1:  0.7841726618705036 val_auroc:  0.8667635658914727 val_auprc:  0.9451244770813441
EarlyStopping counter: 42 out of 50
epoch:  44
epoch:  45 val_f1:  0.7601256159113488 val_auroc:  0.8662790697674418 val_auprc:  0.9441248553666239
EarlyStopping counter: 43 out of 50
epoch:  45
epoch:  46 val_f1:  0.7932273763653603 val_auroc:  0.8689437984496126 val_auprc:  0.9451716522818188
EarlyStopping counter: 44 out of 50
epoch:  46
epoch:  47 val_f1:  0.7997900244397783 val_auroc:  0.8687015503875969 val_auprc:  0.9452043992270706
EarlyStopping counter: 45 out of 50
epoch:  47
epoch:  48 val_f1:  0.8008946034661633 val_auroc:  0.869186046511628 val_auprc:  0.9453996685479658
EarlyStopping counter: 46 out of 50
epoch:  48
epoch:  49 val_f1:  0.8084949329130455 val_auroc:  0.8679748062015503 val_auprc:  0.9448396090265662
EarlyStopping counter: 47 out of 50
epoch:  49
epoch:  50 val_f1:  0.7997900244397783 val_auroc:  0.8713662790697674 val_auprc:  0.9462383538937018
EarlyStopping counter: 48 out of 50
epoch:  50
epoch:  51 val_f1:  0.8008946034661633 val_auroc:  0.8694282945736433 val_auprc:  0.9454740585303932
EarlyStopping counter: 49 out of 50
epoch:  51
epoch:  52 val_f1:  0.8008946034661633 val_auroc:  0.8696705426356588 val_auprc:  0.9456146451136707
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  193.96730375289917
{'time_elapsed': [193.96730375289917], 'epoch': [51], 'fold': [3], 'f1_train': [0.9874585332212449], 'auroc_train': [0.9999538575119971], 'auprc_train': [0.9999800120410163], 'f1_test': [0.8008946034661633], 'auroc_test': [0.8696705426356588], 'auprc_test': [0.9456146451136707]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1276]           1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 1276]           256
│    └─Tanh: 2-3                         [64, 128, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1270]           --
│    └─Dropout: 2-5                      [64, 128, 1270]           --
│    └─Flatten: 2-6                      [64, 162560]              --
│    └─Linear: 2-7                       [64, 1]                   162,561
==========================================================================================
Total params: 163,841
Trainable params: 163,841
Non-trainable params: 0
Total mult-adds (M): 94.04
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.25
Params size (MB): 0.66
Estimated Total Size (MB): 168.23
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.14202898550724638 val_auroc:  0.6609623015873016 val_auprc:  0.8005196404075491
epoch:  1
epoch:  2 val_f1:  0.6143667296786389 val_auroc:  0.7978670634920635 val_auprc:  0.8996842925860624
Validation loss improved to 0.724057
epoch:  2
epoch:  3 val_f1:  0.6595795508838987 val_auroc:  0.8159722222222222 val_auprc:  0.9079370414801137
Validation loss improved to 0.519603
epoch:  3
epoch:  4 val_f1:  0.6961529519074277 val_auroc:  0.8717757936507936 val_auprc:  0.9322076845477412
Validation loss improved to 0.390568
epoch:  4
epoch:  5 val_f1:  0.7988956640912072 val_auroc:  0.8752480158730158 val_auprc:  0.937312141613329
Validation loss improved to 0.252720
epoch:  5
epoch:  6 val_f1:  0.8072024593763724 val_auroc:  0.8722718253968255 val_auprc:  0.9352809046254327
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.8103538508923273 val_auroc:  0.8814484126984127 val_auprc:  0.94024164683131
Validation loss improved to 0.230967
epoch:  7
epoch:  8 val_f1:  0.7207167709858867 val_auroc:  0.8824404761904762 val_auprc:  0.9424971897612018
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7285343668927576 val_auroc:  0.8759920634920635 val_auprc:  0.9405951106235177
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.7895875497243353 val_auroc:  0.8742559523809524 val_auprc:  0.9372469325118886
EarlyStopping counter: 3 out of 50
epoch:  10
epoch:  11 val_f1:  0.7988956640912072 val_auroc:  0.8742559523809524 val_auprc:  0.9363451707442519
EarlyStopping counter: 4 out of 50
epoch:  11
epoch:  12 val_f1:  0.8137922815659323 val_auroc:  0.8757440476190476 val_auprc:  0.9403116227922509
EarlyStopping counter: 5 out of 50
epoch:  12
epoch:  13 val_f1:  0.8238239124113431 val_auroc:  0.8779761904761904 val_auprc:  0.9397581115197802
EarlyStopping counter: 6 out of 50
epoch:  13
epoch:  14 val_f1:  0.7905459035188288 val_auroc:  0.8812003968253969 val_auprc:  0.9419028619146979
EarlyStopping counter: 7 out of 50
epoch:  14
epoch:  15 val_f1:  0.7973334973248877 val_auroc:  0.871031746031746 val_auprc:  0.9372282631704106
EarlyStopping counter: 8 out of 50
epoch:  15
epoch:  16 val_f1:  0.7966751918158568 val_auroc:  0.8625992063492064 val_auprc:  0.9286558297375428
EarlyStopping counter: 9 out of 50
epoch:  16
epoch:  17 val_f1:  0.8035275913020209 val_auroc:  0.8695436507936508 val_auprc:  0.936068015716238
EarlyStopping counter: 10 out of 50
epoch:  17
epoch:  18 val_f1:  0.8036150464093796 val_auroc:  0.8742559523809524 val_auprc:  0.9379459885336903
EarlyStopping counter: 11 out of 50
epoch:  18
epoch:  19 val_f1:  0.7797158172381521 val_auroc:  0.8586309523809524 val_auprc:  0.9250313008146058
EarlyStopping counter: 12 out of 50
epoch:  19
epoch:  20 val_f1:  0.8127933585226971 val_auroc:  0.8715277777777778 val_auprc:  0.936309795963821
EarlyStopping counter: 13 out of 50
epoch:  20
epoch:  21 val_f1:  0.8036760694501368 val_auroc:  0.8712797619047619 val_auprc:  0.9342381518822143
EarlyStopping counter: 14 out of 50
epoch:  21
epoch:  22 val_f1:  0.7884143290944841 val_auroc:  0.8653273809523809 val_auprc:  0.9300753042522758
EarlyStopping counter: 15 out of 50
epoch:  22
epoch:  23 val_f1:  0.8049865427618805 val_auroc:  0.8665674603174602 val_auprc:  0.9323746729415918
EarlyStopping counter: 16 out of 50
epoch:  23
epoch:  24 val_f1:  0.8115942028985508 val_auroc:  0.867063492063492 val_auprc:  0.9308214350628476
EarlyStopping counter: 17 out of 50
epoch:  24
epoch:  25 val_f1:  0.8057130854862423 val_auroc:  0.8623511904761906 val_auprc:  0.9234276078369397
EarlyStopping counter: 18 out of 50
epoch:  25
epoch:  26 val_f1:  0.7861608411480533 val_auroc:  0.8591269841269841 val_auprc:  0.9194304564459722
EarlyStopping counter: 19 out of 50
epoch:  26
epoch:  27 val_f1:  0.8205262448141007 val_auroc:  0.8705357142857143 val_auprc:  0.9334760606700815
EarlyStopping counter: 20 out of 50
epoch:  27
epoch:  28 val_f1:  0.8138718358422335 val_auroc:  0.8700396825396826 val_auprc:  0.9326922778481004
EarlyStopping counter: 21 out of 50
epoch:  28
epoch:  29 val_f1:  0.8231516182680737 val_auroc:  0.873263888888889 val_auprc:  0.9347006772091889
EarlyStopping counter: 22 out of 50
epoch:  29
epoch:  30 val_f1:  0.792371879328401 val_auroc:  0.8717757936507936 val_auprc:  0.9333036234782853
EarlyStopping counter: 23 out of 50
epoch:  30
epoch:  31 val_f1:  0.8108796141220607 val_auroc:  0.8824404761904763 val_auprc:  0.9419980687475692
Validation loss improved to 0.229265
epoch:  31
epoch:  32 val_f1:  0.800639197204071 val_auroc:  0.8670634920634921 val_auprc:  0.9233651675818583
EarlyStopping counter: 1 out of 50
epoch:  32
epoch:  33 val_f1:  0.8088065661047027 val_auroc:  0.8687996031746033 val_auprc:  0.9297250070942311
EarlyStopping counter: 2 out of 50
epoch:  33
epoch:  34 val_f1:  0.822380909337431 val_auroc:  0.875 val_auprc:  0.9340596289809759
EarlyStopping counter: 3 out of 50
epoch:  34
epoch:  35 val_f1:  0.7819511139952413 val_auroc:  0.8670634920634921 val_auprc:  0.9213912558603778
EarlyStopping counter: 4 out of 50
epoch:  35
epoch:  36 val_f1:  0.7797158172381521 val_auroc:  0.8668154761904763 val_auprc:  0.9220126475471846
EarlyStopping counter: 5 out of 50
epoch:  36
epoch:  37 val_f1:  0.7971014492753623 val_auroc:  0.8715277777777778 val_auprc:  0.9301570708921456
EarlyStopping counter: 6 out of 50
epoch:  37
epoch:  38 val_f1:  0.7797158172381521 val_auroc:  0.8663194444444445 val_auprc:  0.9290753944945501
EarlyStopping counter: 7 out of 50
epoch:  38
epoch:  39 val_f1:  0.7810348219555381 val_auroc:  0.8645833333333334 val_auprc:  0.9215581147486047
EarlyStopping counter: 8 out of 50
epoch:  39
epoch:  40 val_f1:  0.7891335560760728 val_auroc:  0.867311507936508 val_auprc:  0.9223426334364682
EarlyStopping counter: 9 out of 50
epoch:  40
epoch:  41 val_f1:  0.8088065661047027 val_auroc:  0.8663194444444445 val_auprc:  0.9224572282784054
EarlyStopping counter: 10 out of 50
epoch:  41
epoch:  42 val_f1:  0.7819511139952413 val_auroc:  0.8685515873015872 val_auprc:  0.9245609883047035
EarlyStopping counter: 11 out of 50
epoch:  42
epoch:  43 val_f1:  0.7901701323251418 val_auroc:  0.8650793650793651 val_auprc:  0.9179351032549417
EarlyStopping counter: 12 out of 50
epoch:  43
epoch:  44 val_f1:  0.7904805491990847 val_auroc:  0.8759920634920635 val_auprc:  0.9300794373928903
EarlyStopping counter: 13 out of 50
epoch:  44
epoch:  45 val_f1:  0.8365904365904365 val_auroc:  0.8769841269841271 val_auprc:  0.936069566808316
EarlyStopping counter: 14 out of 50
epoch:  45
epoch:  46 val_f1:  0.7839990466164816 val_auroc:  0.8745039682539683 val_auprc:  0.9338504862423183
EarlyStopping counter: 15 out of 50
epoch:  46
epoch:  47 val_f1:  0.7949078298424175 val_auroc:  0.8678075396825398 val_auprc:  0.9162949306234738
EarlyStopping counter: 16 out of 50
epoch:  47
epoch:  48 val_f1:  0.7755148741418765 val_auroc:  0.8678075396825397 val_auprc:  0.919375981710441
EarlyStopping counter: 17 out of 50
epoch:  48
epoch:  49 val_f1:  0.7839990466164816 val_auroc:  0.8707837301587302 val_auprc:  0.9260752732343134
EarlyStopping counter: 18 out of 50
epoch:  49
epoch:  50 val_f1:  0.792371879328401 val_auroc:  0.8705357142857142 val_auprc:  0.9230827743414487
EarlyStopping counter: 19 out of 50
epoch:  50
epoch:  51 val_f1:  0.7797158172381521 val_auroc:  0.8675595238095237 val_auprc:  0.9166558099434635
EarlyStopping counter: 20 out of 50
epoch:  51
epoch:  52 val_f1:  0.7755148741418765 val_auroc:  0.8675595238095238 val_auprc:  0.9216812628512274
EarlyStopping counter: 21 out of 50
epoch:  52
epoch:  53 val_f1:  0.792371879328401 val_auroc:  0.8690476190476191 val_auprc:  0.9265527310147961
EarlyStopping counter: 22 out of 50
epoch:  53
epoch:  54 val_f1:  0.7875799991742021 val_auroc:  0.8695436507936508 val_auprc:  0.927669474771579
EarlyStopping counter: 23 out of 50
epoch:  54
epoch:  55 val_f1:  0.7819511139952413 val_auroc:  0.8680555555555555 val_auprc:  0.9232993821198123
EarlyStopping counter: 24 out of 50
epoch:  55
epoch:  56 val_f1:  0.7797158172381521 val_auroc:  0.867311507936508 val_auprc:  0.9217663924175251
EarlyStopping counter: 25 out of 50
epoch:  56
epoch:  57 val_f1:  0.7797158172381521 val_auroc:  0.865079365079365 val_auprc:  0.9154833598045893
EarlyStopping counter: 26 out of 50
epoch:  57
epoch:  58 val_f1:  0.7891335560760728 val_auroc:  0.8725198412698413 val_auprc:  0.9297853035110835
EarlyStopping counter: 27 out of 50
epoch:  58
epoch:  59 val_f1:  0.7797158172381521 val_auroc:  0.8680555555555556 val_auprc:  0.9218361637668299
EarlyStopping counter: 28 out of 50
epoch:  59
epoch:  60 val_f1:  0.7884143290944841 val_auroc:  0.8680555555555556 val_auprc:  0.9251095076223226
EarlyStopping counter: 29 out of 50
epoch:  60
epoch:  61 val_f1:  0.7810781559182691 val_auroc:  0.8695436507936509 val_auprc:  0.9279481641615269
EarlyStopping counter: 30 out of 50
epoch:  61
epoch:  62 val_f1:  0.7837062051498522 val_auroc:  0.863343253968254 val_auprc:  0.9143731195004625
EarlyStopping counter: 31 out of 50
epoch:  62
epoch:  63 val_f1:  0.7669132597880164 val_auroc:  0.8673115079365079 val_auprc:  0.9246771017471707
EarlyStopping counter: 32 out of 50
epoch:  63
epoch:  64 val_f1:  0.7810781559182691 val_auroc:  0.8732638888888888 val_auprc:  0.9299449736607793
EarlyStopping counter: 33 out of 50
epoch:  64
epoch:  65 val_f1:  0.7691024291417562 val_auroc:  0.8673115079365079 val_auprc:  0.9247629698569964
EarlyStopping counter: 34 out of 50
epoch:  65
epoch:  66 val_f1:  0.7904805491990847 val_auroc:  0.871031746031746 val_auprc:  0.9288804320192137
EarlyStopping counter: 35 out of 50
epoch:  66
epoch:  67 val_f1:  0.7904805491990847 val_auroc:  0.8696676587301587 val_auprc:  0.9278031896747265
EarlyStopping counter: 36 out of 50
epoch:  67
epoch:  68 val_f1:  0.7733010668869473 val_auroc:  0.863343253968254 val_auprc:  0.9144496289564819
EarlyStopping counter: 37 out of 50
epoch:  68
epoch:  69 val_f1:  0.7797158172381521 val_auroc:  0.867311507936508 val_auprc:  0.9251179942679586
EarlyStopping counter: 38 out of 50
epoch:  69
epoch:  70 val_f1:  0.7884143290944841 val_auroc:  0.8691716269841271 val_auprc:  0.9280488923916511
EarlyStopping counter: 39 out of 50
epoch:  70
epoch:  71 val_f1:  0.7861608411480533 val_auroc:  0.8658234126984128 val_auprc:  0.921208335010689
EarlyStopping counter: 40 out of 50
epoch:  71
epoch:  72 val_f1:  0.7875799991742021 val_auroc:  0.8702876984126985 val_auprc:  0.9290756993503043
EarlyStopping counter: 41 out of 50
epoch:  72
epoch:  73 val_f1:  0.7875799991742021 val_auroc:  0.8725198412698413 val_auprc:  0.9298733039243487
EarlyStopping counter: 42 out of 50
epoch:  73
epoch:  74 val_f1:  0.7797158172381521 val_auroc:  0.8675595238095238 val_auprc:  0.9254082145792275
EarlyStopping counter: 43 out of 50
epoch:  74
epoch:  75 val_f1:  0.7861608411480533 val_auroc:  0.8660714285714286 val_auprc:  0.924496837922996
EarlyStopping counter: 44 out of 50
epoch:  75
epoch:  76 val_f1:  0.7755148741418765 val_auroc:  0.8690476190476191 val_auprc:  0.928551896079511
EarlyStopping counter: 45 out of 50
epoch:  76
epoch:  77 val_f1:  0.7733010668869473 val_auroc:  0.8673115079365078 val_auprc:  0.925442337334753
EarlyStopping counter: 46 out of 50
epoch:  77
epoch:  78 val_f1:  0.7711042634565258 val_auroc:  0.8700396825396827 val_auprc:  0.9291993699836069
EarlyStopping counter: 47 out of 50
epoch:  78
epoch:  79 val_f1:  0.7839990466164816 val_auroc:  0.8687996031746031 val_auprc:  0.9271775393797674
EarlyStopping counter: 48 out of 50
epoch:  79
epoch:  80 val_f1:  0.7755148741418765 val_auroc:  0.8683035714285715 val_auprc:  0.925627080941335
EarlyStopping counter: 49 out of 50
epoch:  80
epoch:  81 val_f1:  0.7861608411480533 val_auroc:  0.8665674603174603 val_auprc:  0.9251423854292022
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  289.7954156398773
{'time_elapsed': [289.7954156398773], 'epoch': [80], 'fold': [4], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7861608411480533], 'auroc_test': [0.8665674603174603], 'auprc_test': [0.9251423854292022]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1276]           1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 1276]           256
│    └─Tanh: 2-3                         [64, 128, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1270]           --
│    └─Dropout: 2-5                      [64, 128, 1270]           --
│    └─Flatten: 2-6                      [64, 162560]              --
│    └─Linear: 2-7                       [64, 1]                   162,561
==========================================================================================
Total params: 163,841
Trainable params: 163,841
Non-trainable params: 0
Total mult-adds (M): 94.04
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.25
Params size (MB): 0.66
Estimated Total Size (MB): 168.23
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_92', 'config': {'hidden_channels': [128], 'epochs': 500, 'kernel_size': 7, 'pool_kernel_size': 7, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.6136475208640157 val_auprc:  0.752893543039209
epoch:  1
epoch:  2 val_f1:  0.6568930901790195 val_auroc:  0.6369661266568483 val_auprc:  0.7664505301112705
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6731024749578328 val_auroc:  0.6480117820324006 val_auprc:  0.76803436713613
Validation loss improved to 1.290044
epoch:  3
epoch:  4 val_f1:  0.6033497670785479 val_auroc:  0.6718213058419245 val_auprc:  0.8013147133374698
Validation loss improved to 1.239466
epoch:  4
epoch:  5 val_f1:  0.6043044282266453 val_auroc:  0.6833578792341679 val_auprc:  0.8162186464328971
Validation loss improved to 1.230814
epoch:  5
epoch:  6 val_f1:  0.619566649594801 val_auroc:  0.6934216985763377 val_auprc:  0.8272700242011705
Validation loss improved to 1.218718
epoch:  6
epoch:  7 val_f1:  0.6273614874334299 val_auroc:  0.6958762886597938 val_auprc:  0.8302239853247423
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.6341245266055859 val_auroc:  0.7123220422189495 val_auprc:  0.842398189509723
Validation loss improved to 1.201272
epoch:  8
epoch:  9 val_f1:  0.6411112074196065 val_auroc:  0.7189494354442808 val_auprc:  0.8457644960601245
Validation loss improved to 1.190056
epoch:  9
epoch:  10 val_f1:  0.6478524017972046 val_auroc:  0.725085910652921 val_auprc:  0.8493822687846951
Validation loss improved to 1.182983
epoch:  10
epoch:  11 val_f1:  0.646667571603095 val_auroc:  0.7317133038782523 val_auprc:  0.8560854431301209
Validation loss improved to 1.159121
epoch:  11
epoch:  12 val_f1:  0.6813420921017198 val_auroc:  0.733186057928326 val_auprc:  0.8561311853061396
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.675544391518161 val_auroc:  0.7376043200785468 val_auprc:  0.8617038210604303
Validation loss improved to 1.149532
epoch:  13
epoch:  14 val_f1:  0.6889840728573212 val_auroc:  0.7410407461953854 val_auprc:  0.8648990162504684
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.6825214527173443 val_auroc:  0.7466863033873343 val_auprc:  0.8694124021065047
Validation loss improved to 1.129460
epoch:  15
epoch:  16 val_f1:  0.7018261879839978 val_auroc:  0.750613647520864 val_auprc:  0.8714303557512946
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7002679453520968 val_auroc:  0.7533136966126657 val_auprc:  0.8735236797617296
EarlyStopping counter: 2 out of 50
epoch:  17
epoch:  18 val_f1:  0.6756605397022405 val_auroc:  0.759941089837997 val_auprc:  0.878518714331235
Validation loss improved to 1.104839
epoch:  18
epoch:  19 val_f1:  0.6756605397022405 val_auroc:  0.7626411389297988 val_auprc:  0.8809342073853651
Validation loss improved to 1.098292
epoch:  19
epoch:  20 val_f1:  0.7166299330477814 val_auroc:  0.7611683848797252 val_auprc:  0.8804444004006059
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.6756605397022405 val_auroc:  0.7665684830633285 val_auprc:  0.8848033404543332
Validation loss improved to 1.079842
epoch:  21
epoch:  22 val_f1:  0.7166299330477814 val_auroc:  0.7682866961217477 val_auprc:  0.8857047723693272
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7098736982331642 val_auroc:  0.7697594501718213 val_auprc:  0.8871061858777013
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.7030912407309765 val_auroc:  0.7734413352970053 val_auprc:  0.8891946365054513
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.7166299330477814 val_auroc:  0.7741777123220422 val_auprc:  0.890486811668229
EarlyStopping counter: 4 out of 50
epoch:  25
epoch:  26 val_f1:  0.7223183251151889 val_auroc:  0.7727049582719685 val_auprc:  0.890342809224808
EarlyStopping counter: 5 out of 50
epoch:  26
epoch:  27 val_f1:  0.7169009504644194 val_auroc:  0.7778595974472263 val_auprc:  0.8936214529339055
Validation loss improved to 1.064387
epoch:  27
epoch:  28 val_f1:  0.7390688025474315 val_auroc:  0.7768777614138439 val_auprc:  0.8930630804761294
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.7289242247644242 val_auroc:  0.7812960235640648 val_auprc:  0.8967748096176809
EarlyStopping counter: 2 out of 50
epoch:  29
epoch:  30 val_f1:  0.7100860488080124 val_auroc:  0.7852233676975946 val_auprc:  0.8997176624806822
Validation loss improved to 1.045416
epoch:  30
epoch:  31 val_f1:  0.7553956834532374 val_auroc:  0.7815414825724105 val_auprc:  0.8972632056542202
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.7402181480621955 val_auroc:  0.7857142857142858 val_auprc:  0.899668767401433
EarlyStopping counter: 2 out of 50
epoch:  32
epoch:  33 val_f1:  0.6887363496684735 val_auroc:  0.7901325478645067 val_auprc:  0.9027557762923565
Validation loss improved to 1.034142
epoch:  33
epoch:  34 val_f1:  0.7233618940391454 val_auroc:  0.7903780068728523 val_auprc:  0.9028518618805191
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.7377691212466089 val_auroc:  0.7893961708394698 val_auprc:  0.9021569495991452
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.7390688025474315 val_auroc:  0.7903780068728523 val_auprc:  0.9026435487404469
EarlyStopping counter: 3 out of 50
epoch:  36
epoch:  37 val_f1:  0.7098736982331642 val_auroc:  0.7940598919980363 val_auprc:  0.9045916571957207
EarlyStopping counter: 4 out of 50
epoch:  37
epoch:  38 val_f1:  0.7477455593342162 val_auroc:  0.7930780559646539 val_auprc:  0.9045326182838487
EarlyStopping counter: 5 out of 50
epoch:  38
epoch:  39 val_f1:  0.7494347379239465 val_auroc:  0.7930780559646539 val_auprc:  0.9051966449462001
EarlyStopping counter: 6 out of 50
epoch:  39
epoch:  40 val_f1:  0.7477455593342162 val_auroc:  0.7935689739813451 val_auprc:  0.905473277469345
EarlyStopping counter: 7 out of 50
epoch:  40
epoch:  41 val_f1:  0.730071543320129 val_auroc:  0.7977417771232204 val_auprc:  0.9076136935899445
EarlyStopping counter: 8 out of 50
epoch:  41
epoch:  42 val_f1:  0.7477455593342162 val_auroc:  0.7957781050564556 val_auprc:  0.9063608832984531
EarlyStopping counter: 9 out of 50
epoch:  42
epoch:  43 val_f1:  0.7412236216203913 val_auroc:  0.7950417280314188 val_auprc:  0.9065428742117725
EarlyStopping counter: 10 out of 50
epoch:  43
epoch:  44 val_f1:  0.730071543320129 val_auroc:  0.7994599901816397 val_auprc:  0.9093042744873737
EarlyStopping counter: 11 out of 50
epoch:  44
epoch:  45 val_f1:  0.7542604103291037 val_auroc:  0.7935689739813451 val_auprc:  0.9070937540516879
EarlyStopping counter: 12 out of 50
epoch:  45
epoch:  46 val_f1:  0.730071543320129 val_auroc:  0.8001963672066765 val_auprc:  0.9100946290986497
EarlyStopping counter: 13 out of 50
epoch:  46
epoch:  47 val_f1:  0.7542604103291037 val_auroc:  0.7972508591065292 val_auprc:  0.908754793941073
EarlyStopping counter: 14 out of 50
epoch:  47
epoch:  48 val_f1:  0.7215941532488295 val_auroc:  0.8001963672066765 val_auprc:  0.9107635845124973
EarlyStopping counter: 15 out of 50
epoch:  48
epoch:  49 val_f1:  0.7542604103291037 val_auroc:  0.7989690721649484 val_auprc:  0.9102378073244622
EarlyStopping counter: 16 out of 50
epoch:  49
epoch:  50 val_f1:  0.7596459003010357 val_auroc:  0.8016691212567502 val_auprc:  0.912622883236354
EarlyStopping counter: 17 out of 50
epoch:  50
epoch:  51 val_f1:  0.743914028278071 val_auroc:  0.8073146784486991 val_auprc:  0.9162393606024899
Validation loss improved to 1.019677
epoch:  51
epoch:  52 val_f1:  0.7215941532488295 val_auroc:  0.8041237113402062 val_auprc:  0.9139233685459333
EarlyStopping counter: 1 out of 50
epoch:  52
epoch:  53 val_f1:  0.7661184054361647 val_auroc:  0.8021600392734413 val_auprc:  0.9132902364314563
EarlyStopping counter: 2 out of 50
epoch:  53
epoch:  54 val_f1:  0.7648187281552264 val_auroc:  0.8014236622484046 val_auprc:  0.9127533527784076
EarlyStopping counter: 3 out of 50
epoch:  54
epoch:  55 val_f1:  0.7531731915989216 val_auroc:  0.8021600392734413 val_auprc:  0.91361971286982
EarlyStopping counter: 4 out of 50
epoch:  55
epoch:  56 val_f1:  0.7712620601193464 val_auroc:  0.8028964162984782 val_auprc:  0.914062931764731
EarlyStopping counter: 5 out of 50
epoch:  56
epoch:  57 val_f1:  0.7223183251151889 val_auroc:  0.8097692685321551 val_auprc:  0.917956414575765
EarlyStopping counter: 6 out of 50
epoch:  57
epoch:  58 val_f1:  0.7531731915989216 val_auroc:  0.8041237113402062 val_auprc:  0.914770087446264
EarlyStopping counter: 7 out of 50
epoch:  58
epoch:  59 val_f1:  0.7633714058926586 val_auroc:  0.7997054491899852 val_auprc:  0.9129476685510147
EarlyStopping counter: 8 out of 50
epoch:  59
epoch:  60 val_f1:  0.7362024088594293 val_auroc:  0.807314678448699 val_auprc:  0.9168039117488095
EarlyStopping counter: 9 out of 50
epoch:  60
epoch:  61 val_f1:  0.7633714058926586 val_auroc:  0.7982326951399117 val_auprc:  0.912416508604412
EarlyStopping counter: 10 out of 50
epoch:  61
epoch:  62 val_f1:  0.7477455593342162 val_auroc:  0.8060873834069711 val_auprc:  0.9165662053288897
EarlyStopping counter: 11 out of 50
epoch:  62
epoch:  63 val_f1:  0.7725930260576229 val_auroc:  0.8028964162984782 val_auprc:  0.9153514010953212
EarlyStopping counter: 12 out of 50
epoch:  63
epoch:  64 val_f1:  0.7552115339652351 val_auroc:  0.8082965144820815 val_auprc:  0.9184063906855751
EarlyStopping counter: 13 out of 50
epoch:  64
epoch:  65 val_f1:  0.7596459003010357 val_auroc:  0.8028964162984781 val_auprc:  0.9151421253364482
EarlyStopping counter: 14 out of 50
epoch:  65
epoch:  66 val_f1:  0.7596459003010357 val_auroc:  0.802405498281787 val_auprc:  0.9152321825161813
EarlyStopping counter: 15 out of 50
epoch:  66
epoch:  67 val_f1:  0.7725930260576229 val_auroc:  0.8006872852233677 val_auprc:  0.9145688236487444
EarlyStopping counter: 16 out of 50
epoch:  67
epoch:  68 val_f1:  0.7542604103291037 val_auroc:  0.8058419243986255 val_auprc:  0.9180884008523778
EarlyStopping counter: 17 out of 50
epoch:  68
epoch:  69 val_f1:  0.748656020238754 val_auroc:  0.8048600883652429 val_auprc:  0.9172729175570332
EarlyStopping counter: 18 out of 50
epoch:  69
epoch:  70 val_f1:  0.7454557504588546 val_auroc:  0.7979872361315661 val_auprc:  0.9132691405574671
EarlyStopping counter: 19 out of 50
epoch:  70
epoch:  71 val_f1:  0.7367608586927249 val_auroc:  0.8090328915071183 val_auprc:  0.9196098784241631
EarlyStopping counter: 20 out of 50
epoch:  71
epoch:  72 val_f1:  0.7542604103291037 val_auroc:  0.8016691212567502 val_auprc:  0.9150734589181794
EarlyStopping counter: 21 out of 50
epoch:  72
epoch:  73 val_f1:  0.7536606851900262 val_auroc:  0.7974963181148748 val_auprc:  0.9127220747960176
EarlyStopping counter: 22 out of 50
epoch:  73
epoch:  74 val_f1:  0.748656020238754 val_auroc:  0.8046146293568974 val_auprc:  0.9171449838821166
EarlyStopping counter: 23 out of 50
epoch:  74
epoch:  75 val_f1:  0.7633714058926586 val_auroc:  0.799214531173294 val_auprc:  0.9137443886086016
EarlyStopping counter: 24 out of 50
epoch:  75
epoch:  76 val_f1:  0.7725930260576229 val_auroc:  0.8031418753068237 val_auprc:  0.9162219254036152
EarlyStopping counter: 25 out of 50
epoch:  76
epoch:  77 val_f1:  0.7802930475309426 val_auroc:  0.8026509572901326 val_auprc:  0.9160503945622949
EarlyStopping counter: 26 out of 50
epoch:  77
epoch:  78 val_f1:  0.7560320485424044 val_auroc:  0.8078055964653904 val_auprc:  0.918935106672583
EarlyStopping counter: 27 out of 50
epoch:  78
epoch:  79 val_f1:  0.7569659388768054 val_auroc:  0.802405498281787 val_auprc:  0.916335748033224
EarlyStopping counter: 28 out of 50
epoch:  79
epoch:  80 val_f1:  0.7737843767539161 val_auroc:  0.8031418753068237 val_auprc:  0.9167092347904935
EarlyStopping counter: 29 out of 50
epoch:  80
epoch:  81 val_f1:  0.7672775806504117 val_auroc:  0.8031418753068238 val_auprc:  0.916494008985432
EarlyStopping counter: 30 out of 50
epoch:  81
epoch:  82 val_f1:  0.7607703458551531 val_auroc:  0.8046146293568974 val_auprc:  0.9174727052452866
EarlyStopping counter: 31 out of 50
epoch:  82
epoch:  83 val_f1:  0.7569659388768054 val_auroc:  0.8043691703485517 val_auprc:  0.9173537332247174
EarlyStopping counter: 32 out of 50
epoch:  83
epoch:  84 val_f1:  0.7552115339652351 val_auroc:  0.8082965144820814 val_auprc:  0.9196698816335324
EarlyStopping counter: 33 out of 50
epoch:  84
epoch:  85 val_f1:  0.7633714058926586 val_auroc:  0.8011782032400588 val_auprc:  0.9158912486150863
EarlyStopping counter: 34 out of 50
epoch:  85
epoch:  86 val_f1:  0.7607703458551531 val_auroc:  0.8060873834069711 val_auprc:  0.9182813639839484
EarlyStopping counter: 35 out of 50
epoch:  86
epoch:  87 val_f1:  0.7505653177403916 val_auroc:  0.8014236622484046 val_auprc:  0.9158856639413329
EarlyStopping counter: 36 out of 50
epoch:  87
epoch:  88 val_f1:  0.7596459003010357 val_auroc:  0.8053510063819342 val_auprc:  0.9182669764124971
EarlyStopping counter: 37 out of 50
epoch:  88
epoch:  89 val_f1:  0.7505653177403916 val_auroc:  0.8026509572901325 val_auprc:  0.9171423344245799
EarlyStopping counter: 38 out of 50
epoch:  89
epoch:  90 val_f1:  0.7607703458551531 val_auroc:  0.8073146784486991 val_auprc:  0.9193584291998358
EarlyStopping counter: 39 out of 50
epoch:  90
epoch:  91 val_f1:  0.7553956834532374 val_auroc:  0.8024054982817869 val_auprc:  0.9168195727361533
EarlyStopping counter: 40 out of 50
epoch:  91
epoch:  92 val_f1:  0.7607703458551531 val_auroc:  0.8038782523318605 val_auprc:  0.917782676886512
EarlyStopping counter: 41 out of 50
epoch:  92
epoch:  93 val_f1:  0.7505653177403916 val_auroc:  0.803632793323515 val_auprc:  0.9174863339499537
EarlyStopping counter: 42 out of 50
epoch:  93
epoch:  94 val_f1:  0.7505653177403916 val_auroc:  0.8038782523318606 val_auprc:  0.9175562917812516
EarlyStopping counter: 43 out of 50
epoch:  94
epoch:  95 val_f1:  0.7607703458551531 val_auroc:  0.8070692194403535 val_auprc:  0.9192474408207244
EarlyStopping counter: 44 out of 50
epoch:  95
epoch:  96 val_f1:  0.7505653177403916 val_auroc:  0.8026509572901326 val_auprc:  0.916979375175206
EarlyStopping counter: 45 out of 50
epoch:  96
epoch:  97 val_f1:  0.7683026725960121 val_auroc:  0.8060873834069711 val_auprc:  0.91891402522817
EarlyStopping counter: 46 out of 50
epoch:  97
epoch:  98 val_f1:  0.7553956834532374 val_auroc:  0.8014236622484046 val_auprc:  0.9164436672666445
EarlyStopping counter: 47 out of 50
epoch:  98
epoch:  99 val_f1:  0.7531731915989216 val_auroc:  0.8041237113402061 val_auprc:  0.9179128200524537
EarlyStopping counter: 48 out of 50
epoch:  99
epoch:  100 val_f1:  0.7583800901862243 val_auroc:  0.8036327933235149 val_auprc:  0.917539987843788
EarlyStopping counter: 49 out of 50
epoch:  100
epoch:  101 val_f1:  0.7569659388768054 val_auroc:  0.8001963672066764 val_auprc:  0.9156124655700539
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  35.65572428703308
{'time_elapsed': [35.65572428703308], 'epoch': [100], 'fold': [0], 'f1_train': [0.9981996872393208], 'auroc_train': [0.9999846705705613], 'auprc_train': [0.9999932970817315], 'f1_test': [0.7569659388768054], 'auroc_test': [0.8001963672066764], 'auprc_test': [0.9156124655700539]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 183]            1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 183]            256
│    └─Tanh: 2-3                         [64, 128, 183]            --
│    └─MaxPool1d: 2-4                    [64, 128, 26]             --
│    └─Dropout: 2-5                      [64, 128, 26]             --
│    └─Flatten: 2-6                      [64, 3328]                --
│    └─Linear: 2-7                       [64, 1]                   3,329
==========================================================================================
Total params: 4,609
Trainable params: 4,609
Non-trainable params: 0
Total mult-adds (M): 12.22
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 23.99
Params size (MB): 0.02
Estimated Total Size (MB): 24.33
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5859572082593666 val_auroc:  0.5783014236622483 val_auprc:  0.7518936243126395
epoch:  1
epoch:  2 val_f1:  0.5575599172691673 val_auroc:  0.6541482572410406 val_auprc:  0.8275797457200295
Validation loss improved to 1.191925
epoch:  2
epoch:  3 val_f1:  0.6546762589928059 val_auroc:  0.6816396661757487 val_auprc:  0.849234454247936
Validation loss improved to 1.153861
epoch:  3
epoch:  4 val_f1:  0.575871059068063 val_auroc:  0.7071674030436916 val_auprc:  0.8698112985491513
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.7156947373800909 val_auroc:  0.7147766323024055 val_auprc:  0.8736394486685131
Validation loss improved to 1.121702
epoch:  5
epoch:  6 val_f1:  0.7095299887411026 val_auroc:  0.7233676975945018 val_auprc:  0.8785348519341798
Validation loss improved to 1.107075
epoch:  6
epoch:  7 val_f1:  0.6338388558291804 val_auroc:  0.7317133038782523 val_auprc:  0.8827677319775543
Validation loss improved to 1.097775
epoch:  7
epoch:  8 val_f1:  0.7095299887411026 val_auroc:  0.738831615120275 val_auprc:  0.8861261641223852
Validation loss improved to 1.080555
epoch:  8
epoch:  9 val_f1:  0.7229061670449737 val_auroc:  0.7471772214040255 val_auprc:  0.8903834476854542
Validation loss improved to 1.065281
epoch:  9
epoch:  10 val_f1:  0.681579990245092 val_auroc:  0.7638684339715267 val_auprc:  0.8998847824020656
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.7121336235283787 val_auroc:  0.7653411880216004 val_auprc:  0.8988498790327017
Validation loss improved to 1.039165
epoch:  11
epoch:  12 val_f1:  0.7308672563486676 val_auroc:  0.770004909180167 val_auprc:  0.9022320589025068
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7363119073255568 val_auroc:  0.7727049582719686 val_auprc:  0.8997030860368609
Validation loss improved to 1.021017
epoch:  13
epoch:  14 val_f1:  0.7289242247644242 val_auroc:  0.7822778595974472 val_auprc:  0.9062331739003292
Validation loss improved to 1.010724
epoch:  14
epoch:  15 val_f1:  0.7506155503404762 val_auroc:  0.7844869906725577 val_auprc:  0.9068455166956899
Validation loss improved to 1.004957
epoch:  15
epoch:  16 val_f1:  0.7577565132360132 val_auroc:  0.7866961217476681 val_auprc:  0.908167955844159
Validation loss improved to 0.997851
epoch:  16
epoch:  17 val_f1:  0.7420910227448273 val_auroc:  0.7869415807560136 val_auprc:  0.907061693119167
Validation loss improved to 0.985471
epoch:  17
epoch:  18 val_f1:  0.7510257046352308 val_auroc:  0.7898870888561611 val_auprc:  0.9103422366617836
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7567268683783295 val_auroc:  0.7901325478645066 val_auprc:  0.9081583658176934
Validation loss improved to 0.973846
epoch:  19
epoch:  20 val_f1:  0.7639705763479104 val_auroc:  0.7940598919980363 val_auprc:  0.9097017802100933
Validation loss improved to 0.968750
epoch:  20
epoch:  21 val_f1:  0.7412236216203913 val_auroc:  0.7970054000981837 val_auprc:  0.90977019879123
Validation loss improved to 0.960463
epoch:  21
epoch:  22 val_f1:  0.7639705763479104 val_auroc:  0.79553264604811 val_auprc:  0.9105474196311392
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7573003855683703 val_auroc:  0.79553264604811 val_auprc:  0.9104854288633141
Validation loss improved to 0.959149
epoch:  23
epoch:  24 val_f1:  0.7552115339652351 val_auroc:  0.7987236131566029 val_auprc:  0.9091675935647928
Validation loss improved to 0.949361
epoch:  24
epoch:  25 val_f1:  0.7626195746699344 val_auroc:  0.7982326951399117 val_auprc:  0.9102331765063882
Validation loss improved to 0.946552
epoch:  25
epoch:  26 val_f1:  0.7567268683783295 val_auroc:  0.7997054491899853 val_auprc:  0.9107340445315423
Validation loss improved to 0.946524
epoch:  26
epoch:  27 val_f1:  0.7376969013024874 val_auroc:  0.7989690721649485 val_auprc:  0.91109246071746
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7745465218349855 val_auroc:  0.8041237113402062 val_auprc:  0.9072194214008417
EarlyStopping counter: 2 out of 50
epoch:  28
epoch:  29 val_f1:  0.7445203699313053 val_auroc:  0.797987236131566 val_auprc:  0.9107534280874414
EarlyStopping counter: 3 out of 50
epoch:  29
epoch:  30 val_f1:  0.7569659388768054 val_auroc:  0.8043691703485518 val_auprc:  0.9082820824008291
EarlyStopping counter: 4 out of 50
epoch:  30
epoch:  31 val_f1:  0.7617596949267598 val_auroc:  0.8001963672066765 val_auprc:  0.9086722566268304
Validation loss improved to 0.938863
epoch:  31
epoch:  32 val_f1:  0.7699730743399811 val_auroc:  0.80166912125675 val_auprc:  0.909913030610118
Validation loss improved to 0.934108
epoch:  32
epoch:  33 val_f1:  0.7699730743399811 val_auroc:  0.8014236622484046 val_auprc:  0.9100262708791818
Validation loss improved to 0.933549
epoch:  33
epoch:  34 val_f1:  0.7617596949267598 val_auroc:  0.8060873834069711 val_auprc:  0.9081557337843772
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.7626195746699344 val_auroc:  0.803632793323515 val_auprc:  0.9092128424401668
Validation loss improved to 0.931654
epoch:  35
epoch:  36 val_f1:  0.7699730743399811 val_auroc:  0.8016691212567502 val_auprc:  0.9077259833038489
EarlyStopping counter: 1 out of 50
epoch:  36
epoch:  37 val_f1:  0.7626195746699344 val_auroc:  0.8001963672066765 val_auprc:  0.906803583789194
EarlyStopping counter: 2 out of 50
epoch:  37
epoch:  38 val_f1:  0.7691994463100789 val_auroc:  0.8055964653902798 val_auprc:  0.9076074638713534
EarlyStopping counter: 3 out of 50
epoch:  38
epoch:  39 val_f1:  0.7699730743399811 val_auroc:  0.8021600392734414 val_auprc:  0.9082797046953639
EarlyStopping counter: 4 out of 50
epoch:  39
epoch:  40 val_f1:  0.7699730743399811 val_auroc:  0.8033873343151694 val_auprc:  0.9085114391251894
EarlyStopping counter: 5 out of 50
epoch:  40
epoch:  41 val_f1:  0.7691994463100789 val_auroc:  0.8070692194403535 val_auprc:  0.9069203410548734
EarlyStopping counter: 6 out of 50
epoch:  41
epoch:  42 val_f1:  0.7772753225990636 val_auroc:  0.8053510063819342 val_auprc:  0.9078521668934965
EarlyStopping counter: 7 out of 50
epoch:  42
epoch:  43 val_f1:  0.7845295119922345 val_auroc:  0.8051055473735885 val_auprc:  0.9101041690801764
EarlyStopping counter: 8 out of 50
epoch:  43
epoch:  44 val_f1:  0.7648187281552264 val_auroc:  0.8055964653902798 val_auprc:  0.9057849125775383
EarlyStopping counter: 9 out of 50
epoch:  44
epoch:  45 val_f1:  0.7772753225990636 val_auroc:  0.8065783014236622 val_auprc:  0.9095653222736545
EarlyStopping counter: 10 out of 50
epoch:  45
epoch:  46 val_f1:  0.7542604103291037 val_auroc:  0.8041237113402062 val_auprc:  0.9070738440111714
EarlyStopping counter: 11 out of 50
epoch:  46
epoch:  47 val_f1:  0.7712620601193464 val_auroc:  0.804860088365243 val_auprc:  0.9064778057518758
EarlyStopping counter: 12 out of 50
epoch:  47
epoch:  48 val_f1:  0.7552115339652351 val_auroc:  0.8043691703485518 val_auprc:  0.9069903911250276
EarlyStopping counter: 13 out of 50
epoch:  48
epoch:  49 val_f1:  0.7772753225990636 val_auroc:  0.8043691703485517 val_auprc:  0.9074568405724099
EarlyStopping counter: 14 out of 50
epoch:  49
epoch:  50 val_f1:  0.7725930260576229 val_auroc:  0.8055964653902797 val_auprc:  0.9061880698397013
EarlyStopping counter: 15 out of 50
epoch:  50
epoch:  51 val_f1:  0.7477455593342162 val_auroc:  0.804860088365243 val_auprc:  0.9073683780786617
EarlyStopping counter: 16 out of 50
epoch:  51
epoch:  52 val_f1:  0.7552115339652351 val_auroc:  0.8038782523318606 val_auprc:  0.9065888779675368
EarlyStopping counter: 17 out of 50
epoch:  52
epoch:  53 val_f1:  0.7725930260576229 val_auroc:  0.8051055473735886 val_auprc:  0.9071025255111105
EarlyStopping counter: 18 out of 50
epoch:  53
epoch:  54 val_f1:  0.7772753225990636 val_auroc:  0.8060873834069711 val_auprc:  0.9078658314510722
EarlyStopping counter: 19 out of 50
epoch:  54
epoch:  55 val_f1:  0.7477455593342162 val_auroc:  0.8068237604320078 val_auprc:  0.9078036523530705
EarlyStopping counter: 20 out of 50
epoch:  55
epoch:  56 val_f1:  0.7790721385700611 val_auroc:  0.8073146784486991 val_auprc:  0.9071421259230097
EarlyStopping counter: 21 out of 50
epoch:  56
epoch:  57 val_f1:  0.7596459003010357 val_auroc:  0.8078055964653904 val_auprc:  0.9072166370176881
EarlyStopping counter: 22 out of 50
epoch:  57
epoch:  58 val_f1:  0.7683026725960121 val_auroc:  0.8085419734904271 val_auprc:  0.9079903029995345
EarlyStopping counter: 23 out of 50
epoch:  58
epoch:  59 val_f1:  0.7725930260576229 val_auroc:  0.8102601865488464 val_auprc:  0.9079003783491187
EarlyStopping counter: 24 out of 50
epoch:  59
epoch:  60 val_f1:  0.7596459003010357 val_auroc:  0.8100147275405007 val_auprc:  0.9077179489562269
EarlyStopping counter: 25 out of 50
epoch:  60
epoch:  61 val_f1:  0.7712620601193464 val_auroc:  0.8095238095238094 val_auprc:  0.9068353254578706
EarlyStopping counter: 26 out of 50
epoch:  61
epoch:  62 val_f1:  0.7596459003010357 val_auroc:  0.8095238095238094 val_auprc:  0.9068434058344685
EarlyStopping counter: 27 out of 50
epoch:  62
epoch:  63 val_f1:  0.7725930260576229 val_auroc:  0.810505645557192 val_auprc:  0.906765423947328
EarlyStopping counter: 28 out of 50
epoch:  63
epoch:  64 val_f1:  0.7725930260576229 val_auroc:  0.8114874815905744 val_auprc:  0.9071650917606062
EarlyStopping counter: 29 out of 50
epoch:  64
epoch:  65 val_f1:  0.7725930260576229 val_auroc:  0.8107511045655376 val_auprc:  0.9068832835935539
EarlyStopping counter: 30 out of 50
epoch:  65
epoch:  66 val_f1:  0.7777125328082551 val_auroc:  0.8112420225822288 val_auprc:  0.907343759034473
EarlyStopping counter: 31 out of 50
epoch:  66
epoch:  67 val_f1:  0.7748426784519089 val_auroc:  0.8100147275405007 val_auprc:  0.907126130449146
EarlyStopping counter: 32 out of 50
epoch:  67
epoch:  68 val_f1:  0.7971323289800215 val_auroc:  0.8109965635738832 val_auprc:  0.9067670328794093
EarlyStopping counter: 33 out of 50
epoch:  68
epoch:  69 val_f1:  0.7683026725960121 val_auroc:  0.8073146784486991 val_auprc:  0.9049516076664111
EarlyStopping counter: 34 out of 50
epoch:  69
epoch:  70 val_f1:  0.7855581813618873 val_auroc:  0.8119783996072656 val_auprc:  0.906967892807219
EarlyStopping counter: 35 out of 50
epoch:  70
epoch:  71 val_f1:  0.7725930260576229 val_auroc:  0.8124693176239568 val_auprc:  0.9076081519631095
EarlyStopping counter: 36 out of 50
epoch:  71
epoch:  72 val_f1:  0.7777125328082551 val_auroc:  0.812960235640648 val_auprc:  0.9073131060674948
EarlyStopping counter: 37 out of 50
epoch:  72
epoch:  73 val_f1:  0.7813819697019021 val_auroc:  0.8112420225822288 val_auprc:  0.9065319026706058
EarlyStopping counter: 38 out of 50
epoch:  73
epoch:  74 val_f1:  0.7855581813618873 val_auroc:  0.8095238095238095 val_auprc:  0.9055374155609398
EarlyStopping counter: 39 out of 50
epoch:  74
epoch:  75 val_f1:  0.7813819697019021 val_auroc:  0.8080510554737359 val_auprc:  0.9046775613477693
EarlyStopping counter: 40 out of 50
epoch:  75
epoch:  76 val_f1:  0.8036372932111164 val_auroc:  0.8119783996072656 val_auprc:  0.9062406440962821
EarlyStopping counter: 41 out of 50
epoch:  76
epoch:  77 val_f1:  0.7813819697019021 val_auroc:  0.8087874324987727 val_auprc:  0.9044332731059954
EarlyStopping counter: 42 out of 50
epoch:  77
epoch:  78 val_f1:  0.8036372932111164 val_auroc:  0.8107511045655376 val_auprc:  0.905326494955818
EarlyStopping counter: 43 out of 50
epoch:  78
epoch:  79 val_f1:  0.7906450372602754 val_auroc:  0.8092783505154638 val_auprc:  0.9047284214252101
EarlyStopping counter: 44 out of 50
epoch:  79
epoch:  80 val_f1:  0.7944676896257205 val_auroc:  0.8085419734904271 val_auprc:  0.9043799704376286
EarlyStopping counter: 45 out of 50
epoch:  80
epoch:  81 val_f1:  0.7906450372602754 val_auroc:  0.8095238095238095 val_auprc:  0.9045809003039521
EarlyStopping counter: 46 out of 50
epoch:  81
epoch:  82 val_f1:  0.7906450372602754 val_auroc:  0.8102601865488464 val_auprc:  0.9047929389441739
EarlyStopping counter: 47 out of 50
epoch:  82
epoch:  83 val_f1:  0.7933255489848959 val_auroc:  0.8095238095238095 val_auprc:  0.9043809556955902
EarlyStopping counter: 48 out of 50
epoch:  83
epoch:  84 val_f1:  0.7906450372602754 val_auroc:  0.8085419734904271 val_auprc:  0.9037430512599457
EarlyStopping counter: 49 out of 50
epoch:  84
epoch:  85 val_f1:  0.7906450372602754 val_auroc:  0.8073146784486991 val_auprc:  0.9033921246112767
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  25.338340282440186
{'time_elapsed': [25.338340282440186], 'epoch': [84], 'fold': [1], 'f1_train': [0.9838234850022257], 'auroc_train': [0.9989882576570499], 'auprc_train': [0.9995662899059505], 'f1_test': [0.7906450372602754], 'auroc_test': [0.8073146784486991], 'auprc_test': [0.9033921246112767]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 183]            1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 183]            256
│    └─Tanh: 2-3                         [64, 128, 183]            --
│    └─MaxPool1d: 2-4                    [64, 128, 26]             --
│    └─Dropout: 2-5                      [64, 128, 26]             --
│    └─Flatten: 2-6                      [64, 3328]                --
│    └─Linear: 2-7                       [64, 1]                   3,329
==========================================================================================
Total params: 4,609
Trainable params: 4,609
Non-trainable params: 0
Total mult-adds (M): 12.22
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 23.99
Params size (MB): 0.02
Estimated Total Size (MB): 24.33
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.5525282277859598 val_auprc:  0.7311342667978922
epoch:  1
epoch:  2 val_f1:  0.3817806514282245 val_auroc:  0.6062837506136475 val_auprc:  0.7945981201334982
Validation loss improved to 1.242799
epoch:  2
epoch:  3 val_f1:  0.5997009621218687 val_auroc:  0.6404025527736867 val_auprc:  0.8083921941499972
Validation loss improved to 1.192391
epoch:  3
epoch:  4 val_f1:  0.6050990506152238 val_auroc:  0.6573392243495336 val_auprc:  0.8279232241681449
Validation loss improved to 1.180159
epoch:  4
epoch:  5 val_f1:  0.580651268458917 val_auroc:  0.6742758959253805 val_auprc:  0.8423289428342341
Validation loss improved to 1.168465
epoch:  5
epoch:  6 val_f1:  0.5697197655491435 val_auroc:  0.6912125675012273 val_auprc:  0.8562826590171784
Validation loss improved to 1.160607
epoch:  6
epoch:  7 val_f1:  0.6476562574960038 val_auroc:  0.7059401080019637 val_auprc:  0.8631366431705931
Validation loss improved to 1.140433
epoch:  7
epoch:  8 val_f1:  0.5739378646336663 val_auroc:  0.7098674521354933 val_auprc:  0.8666242828959272
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.6680342728469744 val_auroc:  0.7226313205694649 val_auprc:  0.8727398215502816
Validation loss improved to 1.115150
epoch:  9
epoch:  10 val_f1:  0.6682010713268466 val_auroc:  0.7253313696612667 val_auprc:  0.8733911105987271
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.6892815309975336 val_auroc:  0.7307314678448699 val_auprc:  0.8758710308996994
Validation loss improved to 1.102466
epoch:  11
epoch:  12 val_f1:  0.6301488691399822 val_auroc:  0.7253313696612665 val_auprc:  0.8712850664231908
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7028070029525513 val_auroc:  0.7351497299950909 val_auprc:  0.8763311194569183
Validation loss improved to 1.090121
epoch:  13
epoch:  14 val_f1:  0.696151679426677 val_auroc:  0.7361315660284732 val_auprc:  0.8763263700185284
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.7166299330477814 val_auroc:  0.7390770741286204 val_auprc:  0.8764951973155611
Validation loss improved to 1.081527
epoch:  15
epoch:  16 val_f1:  0.7166299330477814 val_auroc:  0.7417771232204222 val_auprc:  0.8768430973631324
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.6894622188638474 val_auroc:  0.7376043200785468 val_auprc:  0.8738404471744574
EarlyStopping counter: 2 out of 50
epoch:  17
epoch:  18 val_f1:  0.7031576347932113 val_auroc:  0.7371134020618556 val_auprc:  0.8734013106618077
EarlyStopping counter: 3 out of 50
epoch:  18
epoch:  19 val_f1:  0.7233618940391454 val_auroc:  0.7447226313205694 val_auprc:  0.8773621876915814
Validation loss improved to 1.073752
epoch:  19
epoch:  20 val_f1:  0.703263898025454 val_auroc:  0.7432498772704959 val_auprc:  0.8748120277435576
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7229061670449737 val_auroc:  0.7476681394207167 val_auprc:  0.876059173771937
Validation loss improved to 1.071794
epoch:  21
epoch:  22 val_f1:  0.7281499969472504 val_auroc:  0.7513500245459009 val_auprc:  0.8743450475936982
Validation loss improved to 1.070354
epoch:  22
epoch:  23 val_f1:  0.7281499969472504 val_auroc:  0.7535591556210114 val_auprc:  0.8751857811388397
Validation loss improved to 1.070109
epoch:  23
epoch:  24 val_f1:  0.7170452552783244 val_auroc:  0.7513500245459009 val_auprc:  0.874047752247032
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7307106601978622 val_auroc:  0.7545409916543937 val_auprc:  0.8759513734146855
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.72389147505525 val_auroc:  0.7562592047128129 val_auprc:  0.8754588261172872
EarlyStopping counter: 3 out of 50
epoch:  26
epoch:  27 val_f1:  0.7207289113763933 val_auroc:  0.7577319587628866 val_auprc:  0.8751252957921938
EarlyStopping counter: 4 out of 50
epoch:  27
epoch:  28 val_f1:  0.7169009504644194 val_auroc:  0.7540500736377026 val_auprc:  0.873522435891279
EarlyStopping counter: 5 out of 50
epoch:  28
epoch:  29 val_f1:  0.7162290583621869 val_auroc:  0.7547864506627394 val_auprc:  0.8723812342513806
EarlyStopping counter: 6 out of 50
epoch:  29
epoch:  30 val_f1:  0.7078050864958872 val_auroc:  0.7628865979381443 val_auprc:  0.8763622859256157
EarlyStopping counter: 7 out of 50
epoch:  30
epoch:  31 val_f1:  0.7084342413709481 val_auroc:  0.7552773686794305 val_auprc:  0.8721719698146474
EarlyStopping counter: 8 out of 50
epoch:  31
epoch:  32 val_f1:  0.6887363496684735 val_auroc:  0.7479135984290624 val_auprc:  0.8694579057631139
EarlyStopping counter: 9 out of 50
epoch:  32
epoch:  33 val_f1:  0.7184536707983012 val_auroc:  0.7646048109965635 val_auprc:  0.8759164865002836
EarlyStopping counter: 10 out of 50
epoch:  33
epoch:  34 val_f1:  0.7018261879839978 val_auroc:  0.7520864015709376 val_auprc:  0.8676769681799383
EarlyStopping counter: 11 out of 50
epoch:  34
epoch:  35 val_f1:  0.7084342413709481 val_auroc:  0.7550319096710849 val_auprc:  0.8695841481276265
EarlyStopping counter: 12 out of 50
epoch:  35
epoch:  36 val_f1:  0.7202047592695074 val_auroc:  0.7690230731467845 val_auprc:  0.876655410512544
EarlyStopping counter: 13 out of 50
epoch:  36
epoch:  37 val_f1:  0.6954243384953055 val_auroc:  0.7488954344624448 val_auprc:  0.8664635133250003
EarlyStopping counter: 14 out of 50
epoch:  37
epoch:  38 val_f1:  0.7287333672277241 val_auroc:  0.7682866961217476 val_auprc:  0.8741102890191801
EarlyStopping counter: 15 out of 50
epoch:  38
epoch:  39 val_f1:  0.6962806225607748 val_auroc:  0.7484045164457536 val_auprc:  0.8644656260061685
EarlyStopping counter: 16 out of 50
epoch:  39
epoch:  40 val_f1:  0.6863269195545199 val_auroc:  0.7557682866961217 val_auprc:  0.8680950504677499
EarlyStopping counter: 17 out of 50
epoch:  40
epoch:  41 val_f1:  0.7225455998837295 val_auroc:  0.7670594010800197 val_auprc:  0.8748024984604846
EarlyStopping counter: 18 out of 50
epoch:  41
epoch:  42 val_f1:  0.7011215811505187 val_auroc:  0.7589592538046147 val_auprc:  0.8725035625287527
EarlyStopping counter: 19 out of 50
epoch:  42
epoch:  43 val_f1:  0.7121336235283787 val_auroc:  0.7609229258713794 val_auprc:  0.87256305920706
EarlyStopping counter: 20 out of 50
epoch:  43
epoch:  44 val_f1:  0.7018261879839978 val_auroc:  0.7567501227295041 val_auprc:  0.8709644383185617
EarlyStopping counter: 21 out of 50
epoch:  44
epoch:  45 val_f1:  0.7235944791518311 val_auroc:  0.7670594010800197 val_auprc:  0.8757861717425492
EarlyStopping counter: 22 out of 50
epoch:  45
epoch:  46 val_f1:  0.7044810154681304 val_auroc:  0.7633775159548355 val_auprc:  0.8744070771370082
EarlyStopping counter: 23 out of 50
epoch:  46
epoch:  47 val_f1:  0.7057031525565856 val_auroc:  0.758713794796269 val_auprc:  0.8714915944512319
EarlyStopping counter: 24 out of 50
epoch:  47
epoch:  48 val_f1:  0.7094198370570532 val_auroc:  0.7648502700049091 val_auprc:  0.874701678298605
EarlyStopping counter: 25 out of 50
epoch:  48
epoch:  49 val_f1:  0.7057031525565856 val_auroc:  0.7621502209131075 val_auprc:  0.8753977752904143
EarlyStopping counter: 26 out of 50
epoch:  49
epoch:  50 val_f1:  0.7011215811505187 val_auroc:  0.7579774177712323 val_auprc:  0.8732323417920546
EarlyStopping counter: 27 out of 50
epoch:  50
epoch:  51 val_f1:  0.7203480251458693 val_auroc:  0.7663230240549829 val_auprc:  0.875247757009478
EarlyStopping counter: 28 out of 50
epoch:  51
epoch:  52 val_f1:  0.6992598845858601 val_auroc:  0.759941089837997 val_auprc:  0.8693854460308037
EarlyStopping counter: 29 out of 50
epoch:  52
epoch:  53 val_f1:  0.7057031525565856 val_auroc:  0.7611683848797252 val_auprc:  0.8746151765815897
EarlyStopping counter: 30 out of 50
epoch:  53
epoch:  54 val_f1:  0.7140775751491829 val_auroc:  0.7653411880216004 val_auprc:  0.8767473888649923
EarlyStopping counter: 31 out of 50
epoch:  54
epoch:  55 val_f1:  0.7030919944895149 val_auroc:  0.7609229258713794 val_auprc:  0.8715297717654357
EarlyStopping counter: 32 out of 50
epoch:  55
epoch:  56 val_f1:  0.6852719722410164 val_auroc:  0.7569955817378499 val_auprc:  0.8697453417320823
EarlyStopping counter: 33 out of 50
epoch:  56
epoch:  57 val_f1:  0.722058496910722 val_auroc:  0.7609229258713794 val_auprc:  0.8716357976746196
EarlyStopping counter: 34 out of 50
epoch:  57
epoch:  58 val_f1:  0.6904086828713746 val_auroc:  0.7569955817378498 val_auprc:  0.8700824731069685
EarlyStopping counter: 35 out of 50
epoch:  58
epoch:  59 val_f1:  0.7094198370570532 val_auroc:  0.7611683848797252 val_auprc:  0.8716633498887775
EarlyStopping counter: 36 out of 50
epoch:  59
epoch:  60 val_f1:  0.6967556353929608 val_auroc:  0.758713794796269 val_auprc:  0.8709559421848518
EarlyStopping counter: 37 out of 50
epoch:  60
epoch:  61 val_f1:  0.7094198370570532 val_auroc:  0.761168384879725 val_auprc:  0.8716879880251749
EarlyStopping counter: 38 out of 50
epoch:  61
epoch:  62 val_f1:  0.7094198370570532 val_auroc:  0.7589592538046147 val_auprc:  0.8683514148292165
EarlyStopping counter: 39 out of 50
epoch:  62
epoch:  63 val_f1:  0.7094198370570532 val_auroc:  0.7565046637211585 val_auprc:  0.8675897083619784
EarlyStopping counter: 40 out of 50
epoch:  63
epoch:  64 val_f1:  0.7184536707983012 val_auroc:  0.7569955817378498 val_auprc:  0.8671210801218745
EarlyStopping counter: 41 out of 50
epoch:  64
epoch:  65 val_f1:  0.7094198370570532 val_auroc:  0.7545409916543937 val_auprc:  0.8661123586168222
EarlyStopping counter: 42 out of 50
epoch:  65
epoch:  66 val_f1:  0.7094198370570532 val_auroc:  0.7555228276877761 val_auprc:  0.8673570486850533
EarlyStopping counter: 43 out of 50
epoch:  66
epoch:  67 val_f1:  0.7237424247793883 val_auroc:  0.7604320078546882 val_auprc:  0.8675458505879203
EarlyStopping counter: 44 out of 50
epoch:  67
epoch:  68 val_f1:  0.6904086828713746 val_auroc:  0.7569955817378498 val_auprc:  0.8682663157617744
EarlyStopping counter: 45 out of 50
epoch:  68
epoch:  69 val_f1:  0.7094198370570532 val_auroc:  0.757486499754541 val_auprc:  0.8674012209533326
EarlyStopping counter: 46 out of 50
epoch:  69
epoch:  70 val_f1:  0.722058496910722 val_auroc:  0.7560137457044673 val_auprc:  0.8664131709223283
EarlyStopping counter: 47 out of 50
epoch:  70
epoch:  71 val_f1:  0.7140703059967902 val_auroc:  0.7574864997545411 val_auprc:  0.8672417326520002
EarlyStopping counter: 48 out of 50
epoch:  71
epoch:  72 val_f1:  0.7044810154681304 val_auroc:  0.7533136966126657 val_auprc:  0.8656863378067459
EarlyStopping counter: 49 out of 50
epoch:  72
epoch:  73 val_f1:  0.7202047592695074 val_auroc:  0.7582228767795778 val_auprc:  0.866648240547413
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  20.176610708236694
{'time_elapsed': [20.176610708236694], 'epoch': [72], 'fold': [2], 'f1_train': [0.9731640683178108], 'auroc_train': [0.9986816690682774], 'auprc_train': [0.9994249440334528], 'f1_test': [0.7202047592695074], 'auroc_test': [0.7582228767795778], 'auprc_test': [0.866648240547413]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 183]            1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 183]            256
│    └─Tanh: 2-3                         [64, 128, 183]            --
│    └─MaxPool1d: 2-4                    [64, 128, 26]             --
│    └─Dropout: 2-5                      [64, 128, 26]             --
│    └─Flatten: 2-6                      [64, 3328]                --
│    └─Linear: 2-7                       [64, 1]                   3,329
==========================================================================================
Total params: 4,609
Trainable params: 4,609
Non-trainable params: 0
Total mult-adds (M): 12.22
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 23.99
Params size (MB): 0.02
Estimated Total Size (MB): 24.33
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5896102192579737 val_auroc:  0.591327519379845 val_auprc:  0.7562138628784829
epoch:  1
epoch:  2 val_f1:  0.597585660285331 val_auroc:  0.6475290697674418 val_auprc:  0.8102248041709432
Validation loss improved to 1.168628
epoch:  2
epoch:  3 val_f1:  0.6191377607430368 val_auroc:  0.685562015503876 val_auprc:  0.8377424094953283
Validation loss improved to 1.144614
epoch:  3
epoch:  4 val_f1:  0.6325099499950922 val_auroc:  0.7170542635658915 val_auprc:  0.8630576675465806
Validation loss improved to 1.119682
epoch:  4
epoch:  5 val_f1:  0.6538353732598337 val_auroc:  0.7415213178294573 val_auprc:  0.8781551689785673
Validation loss improved to 1.098006
epoch:  5
epoch:  6 val_f1:  0.6677150534305774 val_auroc:  0.7611434108527132 val_auprc:  0.8903107316141177
Validation loss improved to 1.078350
epoch:  6
epoch:  7 val_f1:  0.7083611625288628 val_auroc:  0.7744670542635658 val_auprc:  0.8958999959137746
Validation loss improved to 1.058451
epoch:  7
epoch:  8 val_f1:  0.702009174755621 val_auroc:  0.7810077519379843 val_auprc:  0.899620772994494
Validation loss improved to 1.040377
epoch:  8
epoch:  9 val_f1:  0.7659382513381667 val_auroc:  0.7902131782945736 val_auprc:  0.902041302750221
Validation loss improved to 1.028390
epoch:  9
epoch:  10 val_f1:  0.7367737182802777 val_auroc:  0.7916666666666665 val_auprc:  0.9052061910244108
Validation loss improved to 1.005775
epoch:  10
epoch:  11 val_f1:  0.7633328614234447 val_auroc:  0.8018410852713178 val_auprc:  0.907848220305868
Validation loss improved to 1.001034
epoch:  11
epoch:  12 val_f1:  0.7161416160715836 val_auroc:  0.8030523255813953 val_auprc:  0.9112672898324036
Validation loss improved to 0.979384
epoch:  12
epoch:  13 val_f1:  0.7246280645386601 val_auroc:  0.8047480620155039 val_auprc:  0.906154557522812
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7230958778588147 val_auroc:  0.8088662790697674 val_auprc:  0.9140930877724803
Validation loss improved to 0.950565
epoch:  14
epoch:  15 val_f1:  0.7482308031126119 val_auroc:  0.8125 val_auprc:  0.9138149270620854
Validation loss improved to 0.935022
epoch:  15
epoch:  16 val_f1:  0.7594266802546743 val_auroc:  0.8141957364341086 val_auprc:  0.9145603015466195
Validation loss improved to 0.928008
epoch:  16
epoch:  17 val_f1:  0.7571561248111338 val_auroc:  0.814922480620155 val_auprc:  0.9164142326230049
Validation loss improved to 0.910601
epoch:  17
epoch:  18 val_f1:  0.7594266802546743 val_auroc:  0.817829457364341 val_auprc:  0.9160372653669255
Validation loss improved to 0.906622
epoch:  18
epoch:  19 val_f1:  0.7482308031126119 val_auroc:  0.818798449612403 val_auprc:  0.9169079852914904
Validation loss improved to 0.890109
epoch:  19
epoch:  20 val_f1:  0.7503827565415855 val_auroc:  0.8212209302325582 val_auprc:  0.9190435274859965
Validation loss improved to 0.882240
epoch:  20
epoch:  21 val_f1:  0.7540304643278981 val_auroc:  0.8267926356589147 val_auprc:  0.9191032371238661
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7571561248111338 val_auroc:  0.8234011627906977 val_auprc:  0.9212321415225153
Validation loss improved to 0.859042
epoch:  22
epoch:  23 val_f1:  0.7517526908132072 val_auroc:  0.8292151162790697 val_auprc:  0.9218297512978316
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7482308031126119 val_auroc:  0.8301841085271318 val_auprc:  0.9233959834056893
Validation loss improved to 0.845817
epoch:  24
epoch:  25 val_f1:  0.7416238669805648 val_auroc:  0.8316375968992248 val_auprc:  0.9246671126546008
Validation loss improved to 0.839201
epoch:  25
epoch:  26 val_f1:  0.7482308031126119 val_auroc:  0.8326065891472868 val_auprc:  0.9255876334511849
Validation loss improved to 0.835454
epoch:  26
epoch:  27 val_f1:  0.7614155928004849 val_auroc:  0.8364825581395349 val_auprc:  0.927084521369862
Validation loss improved to 0.832037
epoch:  27
epoch:  28 val_f1:  0.7562299212484351 val_auroc:  0.8367248062015503 val_auprc:  0.9277505438560519
Validation loss improved to 0.822394
epoch:  28
epoch:  29 val_f1:  0.767033173809688 val_auroc:  0.8406007751937986 val_auprc:  0.9291774729074819
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.7695564219015847 val_auroc:  0.8415697674418605 val_auprc:  0.9302889892705117
Validation loss improved to 0.812568
epoch:  30
epoch:  31 val_f1:  0.7754499696945739 val_auroc:  0.844718992248062 val_auprc:  0.9316930589544951
Validation loss improved to 0.805537
epoch:  31
epoch:  32 val_f1:  0.7594266802546743 val_auroc:  0.8454457364341085 val_auprc:  0.9319902968594144
EarlyStopping counter: 1 out of 50
epoch:  32
epoch:  33 val_f1:  0.7562299212484351 val_auroc:  0.8461724806201549 val_auprc:  0.9335774375199087
Validation loss improved to 0.794759
epoch:  33
epoch:  34 val_f1:  0.767033173809688 val_auroc:  0.8483527131782945 val_auprc:  0.9337441656826568
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.7594266802546743 val_auroc:  0.8502906976744186 val_auprc:  0.9351598176610263
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.7659382513381667 val_auroc:  0.8502906976744186 val_auprc:  0.9352872079721368
Validation loss improved to 0.790641
epoch:  36
epoch:  37 val_f1:  0.7500238535961682 val_auroc:  0.8502906976744186 val_auprc:  0.9364164668574702
Validation loss improved to 0.779113
epoch:  37
epoch:  38 val_f1:  0.7776763243674784 val_auroc:  0.8522286821705426 val_auprc:  0.9358058135898657
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.7762051583223217 val_auroc:  0.8534399224806201 val_auprc:  0.937524337330917
Validation loss improved to 0.760913
epoch:  39
epoch:  40 val_f1:  0.7985611510791367 val_auroc:  0.8541666666666666 val_auprc:  0.9368932617569752
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.7754499696945739 val_auroc:  0.8556201550387597 val_auprc:  0.9390875569340269
Validation loss improved to 0.754111
epoch:  41
epoch:  42 val_f1:  0.7820584602206068 val_auroc:  0.8578003875968991 val_auprc:  0.9395267741164605
Validation loss improved to 0.753904
epoch:  42
epoch:  43 val_f1:  0.7695564219015847 val_auroc:  0.8585271317829456 val_auprc:  0.9406669414449496
Validation loss improved to 0.753120
epoch:  43
epoch:  44 val_f1:  0.7957035068809065 val_auroc:  0.8565891472868218 val_auprc:  0.9384499665479704
EarlyStopping counter: 1 out of 50
epoch:  44
epoch:  45 val_f1:  0.7820584602206068 val_auroc:  0.8599806201550387 val_auprc:  0.9413013906339487
Validation loss improved to 0.743222
epoch:  45
epoch:  46 val_f1:  0.7811523753969797 val_auroc:  0.8624031007751939 val_auprc:  0.9421611356938676
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.7866727894280321 val_auroc:  0.8624031007751937 val_auprc:  0.9422308333314372
EarlyStopping counter: 2 out of 50
epoch:  47
epoch:  48 val_f1:  0.7866727894280321 val_auroc:  0.8640988372093024 val_auprc:  0.943154402056687
EarlyStopping counter: 3 out of 50
epoch:  48
epoch:  49 val_f1:  0.7811523753969797 val_auroc:  0.8640988372093023 val_auprc:  0.9438171483339746
Validation loss improved to 0.733464
epoch:  49
epoch:  50 val_f1:  0.7932273763653603 val_auroc:  0.8657945736434108 val_auprc:  0.9441502385274183
EarlyStopping counter: 1 out of 50
epoch:  50
epoch:  51 val_f1:  0.7932273763653603 val_auroc:  0.8667635658914729 val_auprc:  0.9447299221163069
EarlyStopping counter: 2 out of 50
epoch:  51
epoch:  52 val_f1:  0.7877294237541244 val_auroc:  0.8667635658914729 val_auprc:  0.944881865721869
Validation loss improved to 0.729097
epoch:  52
epoch:  53 val_f1:  0.7793492478744277 val_auroc:  0.8723352713178295 val_auprc:  0.9468640846675428
EarlyStopping counter: 1 out of 50
epoch:  53
epoch:  54 val_f1:  0.7961192047225032 val_auroc:  0.8689437984496123 val_auprc:  0.9467736343683779
Validation loss improved to 0.716394
epoch:  54
epoch:  55 val_f1:  0.8063632502555458 val_auroc:  0.872093023255814 val_auprc:  0.9475183408319316
EarlyStopping counter: 1 out of 50
epoch:  55
epoch:  56 val_f1:  0.8035187234827523 val_auroc:  0.8706395348837209 val_auprc:  0.9471449055953723
EarlyStopping counter: 2 out of 50
epoch:  56
epoch:  57 val_f1:  0.7866727894280321 val_auroc:  0.8716085271317829 val_auprc:  0.9472293561968319
EarlyStopping counter: 3 out of 50
epoch:  57
epoch:  58 val_f1:  0.7932273763653603 val_auroc:  0.8747577519379847 val_auprc:  0.9486950972638706
EarlyStopping counter: 4 out of 50
epoch:  58
epoch:  59 val_f1:  0.7952715769842713 val_auroc:  0.8723352713178294 val_auprc:  0.94783304899467
Validation loss improved to 0.706218
epoch:  59
epoch:  60 val_f1:  0.7952715769842713 val_auroc:  0.8708817829457364 val_auprc:  0.9473862328791259
EarlyStopping counter: 1 out of 50
epoch:  60
epoch:  61 val_f1:  0.7997900244397783 val_auroc:  0.8757267441860465 val_auprc:  0.9492659098904668
EarlyStopping counter: 2 out of 50
epoch:  61
epoch:  62 val_f1:  0.794309372388086 val_auroc:  0.8747577519379844 val_auprc:  0.9488166222691462
EarlyStopping counter: 3 out of 50
epoch:  62
epoch:  63 val_f1:  0.8063632502555458 val_auroc:  0.8783914728682171 val_auprc:  0.9504024268051833
EarlyStopping counter: 4 out of 50
epoch:  63
epoch:  64 val_f1:  0.794309372388086 val_auroc:  0.8769379844961239 val_auprc:  0.9496629548574366
EarlyStopping counter: 5 out of 50
epoch:  64
epoch:  65 val_f1:  0.7972014141264308 val_auroc:  0.878875968992248 val_auprc:  0.9507264177334995
EarlyStopping counter: 6 out of 50
epoch:  65
epoch:  66 val_f1:  0.8063632502555458 val_auroc:  0.876937984496124 val_auprc:  0.9494091957991514
EarlyStopping counter: 7 out of 50
epoch:  66
epoch:  67 val_f1:  0.8063632502555458 val_auroc:  0.8766957364341085 val_auprc:  0.9495386919907136
EarlyStopping counter: 8 out of 50
epoch:  67
epoch:  68 val_f1:  0.794309372388086 val_auroc:  0.8762112403100775 val_auprc:  0.9490805072365711
Validation loss improved to 0.700783
epoch:  68
epoch:  69 val_f1:  0.8074875573056803 val_auroc:  0.87984496124031 val_auprc:  0.9507231140541447
EarlyStopping counter: 1 out of 50
epoch:  69
epoch:  70 val_f1:  0.8008946034661633 val_auroc:  0.8793604651162791 val_auprc:  0.9504418537742321
EarlyStopping counter: 2 out of 50
epoch:  70
epoch:  71 val_f1:  0.8074875573056803 val_auroc:  0.8800872093023256 val_auprc:  0.9512844509715839
EarlyStopping counter: 3 out of 50
epoch:  71
epoch:  72 val_f1:  0.7985611510791367 val_auroc:  0.8798449612403102 val_auprc:  0.9505144652163334
EarlyStopping counter: 4 out of 50
epoch:  72
epoch:  73 val_f1:  0.8140907369797942 val_auroc:  0.8786337209302326 val_auprc:  0.9499369445286254
EarlyStopping counter: 5 out of 50
epoch:  73
epoch:  74 val_f1:  0.8063632502555458 val_auroc:  0.8805717054263565 val_auprc:  0.9511054927236549
EarlyStopping counter: 6 out of 50
epoch:  74
epoch:  75 val_f1:  0.8063632502555458 val_auroc:  0.8808139534883721 val_auprc:  0.9513124646630083
EarlyStopping counter: 7 out of 50
epoch:  75
epoch:  76 val_f1:  0.8063632502555458 val_auroc:  0.8817829457364341 val_auprc:  0.9515601689087037
EarlyStopping counter: 8 out of 50
epoch:  76
epoch:  77 val_f1:  0.7906801532257888 val_auroc:  0.8781492248062015 val_auprc:  0.9493517440305131
EarlyStopping counter: 9 out of 50
epoch:  77
epoch:  78 val_f1:  0.8074875573056803 val_auroc:  0.8803294573643411 val_auprc:  0.9504660292928001
EarlyStopping counter: 10 out of 50
epoch:  78
epoch:  79 val_f1:  0.8074875573056803 val_auroc:  0.8820251937984497 val_auprc:  0.9516102136856959
EarlyStopping counter: 11 out of 50
epoch:  79
epoch:  80 val_f1:  0.7892012988311853 val_auroc:  0.8815406976744186 val_auprc:  0.9512500990173071
EarlyStopping counter: 12 out of 50
epoch:  80
epoch:  81 val_f1:  0.7892012988311853 val_auroc:  0.8825096899224806 val_auprc:  0.9520661565428358
EarlyStopping counter: 13 out of 50
epoch:  81
epoch:  82 val_f1:  0.8084949329130455 val_auroc:  0.8832364341085271 val_auprc:  0.9523871571743177
EarlyStopping counter: 14 out of 50
epoch:  82
epoch:  83 val_f1:  0.7811109002295425 val_auroc:  0.8817829457364341 val_auprc:  0.9516905387615751
EarlyStopping counter: 15 out of 50
epoch:  83
epoch:  84 val_f1:  0.8235099801588546 val_auroc:  0.878875968992248 val_auprc:  0.9489667118051841
EarlyStopping counter: 16 out of 50
epoch:  84
epoch:  85 val_f1:  0.7774211400110681 val_auroc:  0.8854166666666666 val_auprc:  0.953262789232448
EarlyStopping counter: 17 out of 50
epoch:  85
epoch:  86 val_f1:  0.8309319242108626 val_auroc:  0.8783914728682171 val_auprc:  0.9490258617458268
Validation loss improved to 0.699154
epoch:  86
epoch:  87 val_f1:  0.7892012988311853 val_auroc:  0.8851744186046513 val_auprc:  0.9531824493120706
EarlyStopping counter: 1 out of 50
epoch:  87
epoch:  88 val_f1:  0.7972014141264308 val_auroc:  0.8851744186046512 val_auprc:  0.9533011410901447
EarlyStopping counter: 2 out of 50
epoch:  88
epoch:  89 val_f1:  0.7972014141264308 val_auroc:  0.8842054263565892 val_auprc:  0.9527101789256135
EarlyStopping counter: 3 out of 50
epoch:  89
epoch:  90 val_f1:  0.7972014141264308 val_auroc:  0.8832364341085271 val_auprc:  0.9521429697814832
EarlyStopping counter: 4 out of 50
epoch:  90
epoch:  91 val_f1:  0.7972014141264308 val_auroc:  0.8844476744186046 val_auprc:  0.9524692598981055
EarlyStopping counter: 5 out of 50
epoch:  91
epoch:  92 val_f1:  0.7972014141264308 val_auroc:  0.8846899224806202 val_auprc:  0.9526882589119707
EarlyStopping counter: 6 out of 50
epoch:  92
epoch:  93 val_f1:  0.8129496402877698 val_auroc:  0.8832364341085271 val_auprc:  0.9518345722600516
EarlyStopping counter: 7 out of 50
epoch:  93
epoch:  94 val_f1:  0.7892012988311853 val_auroc:  0.8856589147286821 val_auprc:  0.9534905178484101
EarlyStopping counter: 8 out of 50
epoch:  94
epoch:  95 val_f1:  0.8074875573056803 val_auroc:  0.8832364341085271 val_auprc:  0.9514801332949134
EarlyStopping counter: 9 out of 50
epoch:  95
epoch:  96 val_f1:  0.7972014141264308 val_auroc:  0.8863856589147288 val_auprc:  0.9535045638014794
EarlyStopping counter: 10 out of 50
epoch:  96
epoch:  97 val_f1:  0.7972014141264308 val_auroc:  0.8859011627906977 val_auprc:  0.9528953707526027
EarlyStopping counter: 11 out of 50
epoch:  97
epoch:  98 val_f1:  0.7892012988311853 val_auroc:  0.8868701550387597 val_auprc:  0.9538801550779051
EarlyStopping counter: 12 out of 50
epoch:  98
epoch:  99 val_f1:  0.8051160047274586 val_auroc:  0.8873546511627907 val_auprc:  0.9542184530467817
EarlyStopping counter: 13 out of 50
epoch:  99
epoch:  100 val_f1:  0.7972014141264308 val_auroc:  0.8871124031007752 val_auprc:  0.9534220375561671
EarlyStopping counter: 14 out of 50
epoch:  100
epoch:  101 val_f1:  0.8129496402877698 val_auroc:  0.8851744186046512 val_auprc:  0.9525256270877585
EarlyStopping counter: 15 out of 50
epoch:  101
epoch:  102 val_f1:  0.7972014141264308 val_auroc:  0.8868701550387598 val_auprc:  0.9540968561087508
EarlyStopping counter: 16 out of 50
epoch:  102
epoch:  103 val_f1:  0.8129496402877698 val_auroc:  0.8854166666666669 val_auprc:  0.9524888582258663
EarlyStopping counter: 17 out of 50
epoch:  103
epoch:  104 val_f1:  0.8051160047274586 val_auroc:  0.8873546511627907 val_auprc:  0.9538862579747693
EarlyStopping counter: 18 out of 50
epoch:  104
epoch:  105 val_f1:  0.8051160047274586 val_auroc:  0.8875968992248062 val_auprc:  0.954098177498625
EarlyStopping counter: 19 out of 50
epoch:  105
epoch:  106 val_f1:  0.8129496402877698 val_auroc:  0.8856589147286821 val_auprc:  0.9529562048234711
EarlyStopping counter: 20 out of 50
epoch:  106
epoch:  107 val_f1:  0.8129496402877698 val_auroc:  0.8883236434108527 val_auprc:  0.954552547014887
EarlyStopping counter: 21 out of 50
epoch:  107
epoch:  108 val_f1:  0.8129496402877698 val_auroc:  0.8868701550387598 val_auprc:  0.9535280762808404
EarlyStopping counter: 22 out of 50
epoch:  108
epoch:  109 val_f1:  0.8129496402877698 val_auroc:  0.8856589147286821 val_auprc:  0.9527993234106844
EarlyStopping counter: 23 out of 50
epoch:  109
epoch:  110 val_f1:  0.7811109002295425 val_auroc:  0.8897771317829457 val_auprc:  0.9552639738742243
EarlyStopping counter: 24 out of 50
epoch:  110
epoch:  111 val_f1:  0.8129496402877698 val_auroc:  0.8854166666666666 val_auprc:  0.9524742670836284
EarlyStopping counter: 25 out of 50
epoch:  111
epoch:  112 val_f1:  0.8051160047274586 val_auroc:  0.8895348837209304 val_auprc:  0.955140536436721
EarlyStopping counter: 26 out of 50
epoch:  112
epoch:  113 val_f1:  0.8051160047274586 val_auroc:  0.8880813953488372 val_auprc:  0.9542550303465618
EarlyStopping counter: 27 out of 50
epoch:  113
epoch:  114 val_f1:  0.8129496402877698 val_auroc:  0.8851744186046512 val_auprc:  0.9523181467796796
EarlyStopping counter: 28 out of 50
epoch:  114
epoch:  115 val_f1:  0.8051160047274586 val_auroc:  0.8890503875968991 val_auprc:  0.9546573420444915
EarlyStopping counter: 29 out of 50
epoch:  115
epoch:  116 val_f1:  0.8129496402877698 val_auroc:  0.8861434108527132 val_auprc:  0.9528150526925024
EarlyStopping counter: 30 out of 50
epoch:  116
epoch:  117 val_f1:  0.8051160047274586 val_auroc:  0.8880813953488372 val_auprc:  0.9540687938320792
EarlyStopping counter: 31 out of 50
epoch:  117
epoch:  118 val_f1:  0.8129496402877698 val_auroc:  0.8888081395348837 val_auprc:  0.9544072573246023
EarlyStopping counter: 32 out of 50
epoch:  118
epoch:  119 val_f1:  0.8129496402877698 val_auroc:  0.8880813953488371 val_auprc:  0.9540491740420625
EarlyStopping counter: 33 out of 50
epoch:  119
epoch:  120 val_f1:  0.8129496402877698 val_auroc:  0.8878391472868218 val_auprc:  0.9537640136849369
EarlyStopping counter: 34 out of 50
epoch:  120
epoch:  121 val_f1:  0.8051160047274586 val_auroc:  0.8883236434108527 val_auprc:  0.9542255240622324
EarlyStopping counter: 35 out of 50
epoch:  121
epoch:  122 val_f1:  0.8129496402877698 val_auroc:  0.8885658914728682 val_auprc:  0.9541658540467004
EarlyStopping counter: 36 out of 50
epoch:  122
epoch:  123 val_f1:  0.7972014141264308 val_auroc:  0.8885658914728682 val_auprc:  0.9542883405315842
EarlyStopping counter: 37 out of 50
epoch:  123
epoch:  124 val_f1:  0.8129496402877698 val_auroc:  0.8880813953488372 val_auprc:  0.9537385489340616
EarlyStopping counter: 38 out of 50
epoch:  124
epoch:  125 val_f1:  0.8051160047274586 val_auroc:  0.8873546511627907 val_auprc:  0.9533043899771924
EarlyStopping counter: 39 out of 50
epoch:  125
epoch:  126 val_f1:  0.8129496402877698 val_auroc:  0.8885658914728682 val_auprc:  0.9540435689111412
EarlyStopping counter: 40 out of 50
epoch:  126
epoch:  127 val_f1:  0.8129496402877698 val_auroc:  0.8866279069767441 val_auprc:  0.952806985480063
EarlyStopping counter: 41 out of 50
epoch:  127
epoch:  128 val_f1:  0.8051160047274586 val_auroc:  0.8890503875968992 val_auprc:  0.9542742511974711
EarlyStopping counter: 42 out of 50
epoch:  128
epoch:  129 val_f1:  0.8129496402877698 val_auroc:  0.8880813953488372 val_auprc:  0.9537824660934486
EarlyStopping counter: 43 out of 50
epoch:  129
epoch:  130 val_f1:  0.8051160047274586 val_auroc:  0.8883236434108527 val_auprc:  0.9539028526900943
EarlyStopping counter: 44 out of 50
epoch:  130
epoch:  131 val_f1:  0.8051160047274586 val_auroc:  0.8880813953488372 val_auprc:  0.9536443585119504
EarlyStopping counter: 45 out of 50
epoch:  131
epoch:  132 val_f1:  0.8051160047274586 val_auroc:  0.8885658914728682 val_auprc:  0.9539946747005679
EarlyStopping counter: 46 out of 50
epoch:  132
epoch:  133 val_f1:  0.8129496402877698 val_auroc:  0.8859011627906976 val_auprc:  0.952117217932393
EarlyStopping counter: 47 out of 50
epoch:  133
epoch:  134 val_f1:  0.8037391402911035 val_auroc:  0.8902616279069767 val_auprc:  0.9551129454337373
EarlyStopping counter: 48 out of 50
epoch:  134
epoch:  135 val_f1:  0.8129496402877698 val_auroc:  0.8871124031007752 val_auprc:  0.9526812629433412
EarlyStopping counter: 49 out of 50
epoch:  135
epoch:  136 val_f1:  0.8037391402911035 val_auroc:  0.8905038759689922 val_auprc:  0.9551785271977026
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  37.78172779083252
{'time_elapsed': [37.78172779083252], 'epoch': [135], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8037391402911035], 'auroc_test': [0.8905038759689922], 'auprc_test': [0.9551785271977026]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 183]            1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 183]            256
│    └─Tanh: 2-3                         [64, 128, 183]            --
│    └─MaxPool1d: 2-4                    [64, 128, 26]             --
│    └─Dropout: 2-5                      [64, 128, 26]             --
│    └─Flatten: 2-6                      [64, 3328]                --
│    └─Linear: 2-7                       [64, 1]                   3,329
==========================================================================================
Total params: 4,609
Trainable params: 4,609
Non-trainable params: 0
Total mult-adds (M): 12.22
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 23.99
Params size (MB): 0.02
Estimated Total Size (MB): 24.33
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5637181409295352 val_auroc:  0.5964781746031745 val_auprc:  0.7290759702015505
epoch:  1
epoch:  2 val_f1:  0.5674115955785752 val_auroc:  0.7026289682539683 val_auprc:  0.8028394811425748
Validation loss improved to 1.207968
epoch:  2
epoch:  3 val_f1:  0.6278807033594633 val_auroc:  0.7371031746031745 val_auprc:  0.8285360591435998
Validation loss improved to 1.186308
epoch:  3
epoch:  4 val_f1:  0.7467391304347826 val_auroc:  0.753968253968254 val_auprc:  0.8393643731289699
Validation loss improved to 1.167544
epoch:  4
epoch:  5 val_f1:  0.7346914777905165 val_auroc:  0.7777777777777778 val_auprc:  0.8616531316298991
Validation loss improved to 1.143976
epoch:  5
epoch:  6 val_f1:  0.6855197354488737 val_auroc:  0.8000992063492065 val_auprc:  0.8853936583732169
Validation loss improved to 1.124172
epoch:  6
epoch:  7 val_f1:  0.756376995929398 val_auroc:  0.8139880952380951 val_auprc:  0.8930675390579497
Validation loss improved to 1.104318
epoch:  7
epoch:  8 val_f1:  0.7139661905863711 val_auroc:  0.8229166666666666 val_auprc:  0.8972871897103004
Validation loss improved to 1.088725
epoch:  8
epoch:  9 val_f1:  0.7828617791771808 val_auroc:  0.8231646825396826 val_auprc:  0.8978364598546924
Validation loss improved to 1.070009
epoch:  9
epoch:  10 val_f1:  0.7632485643970468 val_auroc:  0.8373015873015872 val_auprc:  0.9069987687897347
Validation loss improved to 1.054008
epoch:  10
epoch:  11 val_f1:  0.8036150464093796 val_auroc:  0.8387896825396824 val_auprc:  0.903197210327831
Validation loss improved to 1.041449
epoch:  11
epoch:  12 val_f1:  0.7769308547872755 val_auroc:  0.8407738095238096 val_auprc:  0.9086106040571343
Validation loss improved to 1.023064
epoch:  12
epoch:  13 val_f1:  0.7905459035188288 val_auroc:  0.84375 val_auprc:  0.9092741520721233
Validation loss improved to 1.010310
epoch:  13
epoch:  14 val_f1:  0.8030193236714975 val_auroc:  0.8442460317460317 val_auprc:  0.9048817708858025
Validation loss improved to 1.005834
epoch:  14
epoch:  15 val_f1:  0.7769308547872755 val_auroc:  0.8489583333333334 val_auprc:  0.9105873315305061
Validation loss improved to 0.987676
epoch:  15
epoch:  16 val_f1:  0.8030193236714975 val_auroc:  0.8489583333333333 val_auprc:  0.9103815716535313
Validation loss improved to 0.984471
epoch:  16
epoch:  17 val_f1:  0.7901185770750988 val_auroc:  0.8511904761904762 val_auprc:  0.9112831504205408
Validation loss improved to 0.962778
epoch:  17
epoch:  18 val_f1:  0.8097298254042504 val_auroc:  0.8492063492063492 val_auprc:  0.9058388422906413
Validation loss improved to 0.960459
epoch:  18
epoch:  19 val_f1:  0.7968706966496207 val_auroc:  0.8524305555555556 val_auprc:  0.914265025732468
Validation loss improved to 0.944422
epoch:  19
epoch:  20 val_f1:  0.7968706966496207 val_auroc:  0.8524305555555556 val_auprc:  0.9143066225461504
Validation loss improved to 0.935207
epoch:  20
epoch:  21 val_f1:  0.7840325451309432 val_auroc:  0.8539186507936508 val_auprc:  0.9144545474944126
Validation loss improved to 0.928683
epoch:  21
epoch:  22 val_f1:  0.7891335560760728 val_auroc:  0.855406746031746 val_auprc:  0.9118243949206521
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7833564971403972 val_auroc:  0.8529265873015872 val_auprc:  0.915908328446453
Validation loss improved to 0.909497
epoch:  23
epoch:  24 val_f1:  0.7905459035188288 val_auroc:  0.8549107142857143 val_auprc:  0.916758617283185
Validation loss improved to 0.902513
epoch:  24
epoch:  25 val_f1:  0.8036150464093796 val_auroc:  0.8561507936507936 val_auprc:  0.9170387605313284
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.7901185770750988 val_auroc:  0.8566468253968255 val_auprc:  0.9192728665260665
Validation loss improved to 0.890165
epoch:  26
epoch:  27 val_f1:  0.7968706966496207 val_auroc:  0.8568948412698413 val_auprc:  0.9191694163712385
Validation loss improved to 0.888431
epoch:  27
epoch:  28 val_f1:  0.7760956602080848 val_auroc:  0.8583829365079365 val_auprc:  0.9192835868181005
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.7973334973248877 val_auroc:  0.8593750000000001 val_auprc:  0.9205348974915621
Validation loss improved to 0.872387
epoch:  29
epoch:  30 val_f1:  0.770099160945843 val_auroc:  0.8591269841269841 val_auprc:  0.9203240999718669
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.8090037477295196 val_auroc:  0.8578869047619048 val_auprc:  0.9194022466756742
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.7837457330597287 val_auroc:  0.861111111111111 val_auprc:  0.9222772165454066
Validation loss improved to 0.861040
epoch:  32
epoch:  33 val_f1:  0.8015122873345937 val_auroc:  0.8583829365079365 val_auprc:  0.9208999149179753
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.7901185770750988 val_auroc:  0.861111111111111 val_auprc:  0.9222047147789385
Validation loss improved to 0.850571
epoch:  34
epoch:  35 val_f1:  0.8103538508923273 val_auroc:  0.861111111111111 val_auprc:  0.9229875267680161
Validation loss improved to 0.850117
epoch:  35
epoch:  36 val_f1:  0.8090037477295196 val_auroc:  0.8608630952380952 val_auprc:  0.9230486635969266
EarlyStopping counter: 1 out of 50
epoch:  36
epoch:  37 val_f1:  0.770099160945843 val_auroc:  0.8643353174603176 val_auprc:  0.9270355194411952
Validation loss improved to 0.841820
epoch:  37
epoch:  38 val_f1:  0.8081713820844254 val_auroc:  0.8596230158730158 val_auprc:  0.9222288796098095
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.8164398044139025 val_auroc:  0.8616071428571429 val_auprc:  0.9241390879471173
EarlyStopping counter: 2 out of 50
epoch:  39
epoch:  40 val_f1:  0.7833564971403972 val_auroc:  0.8640873015873016 val_auprc:  0.9265161021751401
Validation loss improved to 0.827309
epoch:  40
epoch:  41 val_f1:  0.8090037477295196 val_auroc:  0.861359126984127 val_auprc:  0.9246861060143914
EarlyStopping counter: 1 out of 50
epoch:  41
epoch:  42 val_f1:  0.8097298254042504 val_auroc:  0.8628472222222223 val_auprc:  0.9254546412238083
EarlyStopping counter: 2 out of 50
epoch:  42
epoch:  43 val_f1:  0.7963059879954627 val_auroc:  0.863343253968254 val_auprc:  0.9255640753655325
EarlyStopping counter: 3 out of 50
epoch:  43
epoch:  44 val_f1:  0.8164398044139025 val_auroc:  0.8621031746031746 val_auprc:  0.9247358171394862
EarlyStopping counter: 4 out of 50
epoch:  44
epoch:  45 val_f1:  0.7895875497243353 val_auroc:  0.8658234126984127 val_auprc:  0.926702058939639
Validation loss improved to 0.824846
epoch:  45
epoch:  46 val_f1:  0.8097298254042504 val_auroc:  0.8623511904761905 val_auprc:  0.926001549520558
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.7833564971403972 val_auroc:  0.8673115079365079 val_auprc:  0.9274036552592007
Validation loss improved to 0.820757
epoch:  47
epoch:  48 val_f1:  0.822380909337431 val_auroc:  0.863343253968254 val_auprc:  0.9262003261137696
EarlyStopping counter: 1 out of 50
epoch:  48
epoch:  49 val_f1:  0.8030193236714975 val_auroc:  0.8653273809523809 val_auprc:  0.9271591812440221
EarlyStopping counter: 2 out of 50
epoch:  49
epoch:  50 val_f1:  0.8030193236714975 val_auroc:  0.8653273809523809 val_auprc:  0.9272346063526715
EarlyStopping counter: 3 out of 50
epoch:  50
epoch:  51 val_f1:  0.822380909337431 val_auroc:  0.8663194444444444 val_auprc:  0.9272409392022013
EarlyStopping counter: 4 out of 50
epoch:  51
epoch:  52 val_f1:  0.8156899810964081 val_auroc:  0.8670634920634921 val_auprc:  0.9274612511519376
EarlyStopping counter: 5 out of 50
epoch:  52
epoch:  53 val_f1:  0.7765822970867508 val_auroc:  0.8697916666666669 val_auprc:  0.9299425665349617
Validation loss improved to 0.813721
epoch:  53
epoch:  54 val_f1:  0.8215074100875418 val_auroc:  0.8660714285714286 val_auprc:  0.9270162229128224
EarlyStopping counter: 1 out of 50
epoch:  54
epoch:  55 val_f1:  0.8030193236714975 val_auroc:  0.8678075396825398 val_auprc:  0.9295318954020746
EarlyStopping counter: 2 out of 50
epoch:  55
epoch:  56 val_f1:  0.7901185770750988 val_auroc:  0.8692956349206349 val_auprc:  0.9317637940584763
Validation loss improved to 0.813592
epoch:  56
epoch:  57 val_f1:  0.81483559295621 val_auroc:  0.8665674603174602 val_auprc:  0.9272288698267547
EarlyStopping counter: 1 out of 50
epoch:  57
epoch:  58 val_f1:  0.81483559295621 val_auroc:  0.8675595238095237 val_auprc:  0.9277502797396162
EarlyStopping counter: 2 out of 50
epoch:  58
epoch:  59 val_f1:  0.8090037477295196 val_auroc:  0.8680555555555556 val_auprc:  0.927906921362609
EarlyStopping counter: 3 out of 50
epoch:  59
epoch:  60 val_f1:  0.8090037477295196 val_auroc:  0.8680555555555556 val_auprc:  0.9287798161652494
EarlyStopping counter: 4 out of 50
epoch:  60
epoch:  61 val_f1:  0.8156899810964081 val_auroc:  0.8668154761904762 val_auprc:  0.9296816695099218
EarlyStopping counter: 5 out of 50
epoch:  61
epoch:  62 val_f1:  0.8081713820844254 val_auroc:  0.8643353174603174 val_auprc:  0.9285475909791527
EarlyStopping counter: 6 out of 50
epoch:  62
epoch:  63 val_f1:  0.7963059879954627 val_auroc:  0.8668154761904763 val_auprc:  0.9300659543687826
EarlyStopping counter: 7 out of 50
epoch:  63
epoch:  64 val_f1:  0.8081713820844254 val_auroc:  0.8630952380952381 val_auprc:  0.927557515700705
EarlyStopping counter: 8 out of 50
epoch:  64
epoch:  65 val_f1:  0.8205262448141007 val_auroc:  0.8625992063492064 val_auprc:  0.9277501809132336
EarlyStopping counter: 9 out of 50
epoch:  65
epoch:  66 val_f1:  0.7963059879954627 val_auroc:  0.8660714285714286 val_auprc:  0.9298308326152037
EarlyStopping counter: 10 out of 50
epoch:  66
epoch:  67 val_f1:  0.8271938694055665 val_auroc:  0.8621031746031745 val_auprc:  0.9271443732411673
EarlyStopping counter: 11 out of 50
epoch:  67
epoch:  68 val_f1:  0.807228002894545 val_auroc:  0.8635912698412699 val_auprc:  0.9282946193310603
EarlyStopping counter: 12 out of 50
epoch:  68
epoch:  69 val_f1:  0.8090037477295196 val_auroc:  0.8650793650793651 val_auprc:  0.9298357360055879
EarlyStopping counter: 13 out of 50
epoch:  69
epoch:  70 val_f1:  0.81483559295621 val_auroc:  0.861359126984127 val_auprc:  0.9270652180403962
EarlyStopping counter: 14 out of 50
epoch:  70
epoch:  71 val_f1:  0.8138718358422335 val_auroc:  0.861359126984127 val_auprc:  0.9272912963511413
EarlyStopping counter: 15 out of 50
epoch:  71
epoch:  72 val_f1:  0.8215074100875418 val_auroc:  0.8621031746031746 val_auprc:  0.9276220530343948
EarlyStopping counter: 16 out of 50
epoch:  72
epoch:  73 val_f1:  0.8194319840387783 val_auroc:  0.8606150793650793 val_auprc:  0.9266696596323805
EarlyStopping counter: 17 out of 50
epoch:  73
epoch:  74 val_f1:  0.8138718358422335 val_auroc:  0.8611111111111112 val_auprc:  0.9275474369599641
EarlyStopping counter: 18 out of 50
epoch:  74
epoch:  75 val_f1:  0.8090037477295196 val_auroc:  0.8621031746031746 val_auprc:  0.9290260557259589
EarlyStopping counter: 19 out of 50
epoch:  75
epoch:  76 val_f1:  0.8115942028985508 val_auroc:  0.8598710317460319 val_auprc:  0.9268192640498583
EarlyStopping counter: 20 out of 50
epoch:  76
epoch:  77 val_f1:  0.8138718358422335 val_auroc:  0.8608630952380953 val_auprc:  0.9273884737685018
EarlyStopping counter: 21 out of 50
epoch:  77
epoch:  78 val_f1:  0.807228002894545 val_auroc:  0.8596230158730158 val_auprc:  0.9266998040626816
EarlyStopping counter: 22 out of 50
epoch:  78
epoch:  79 val_f1:  0.8290790088826556 val_auroc:  0.8601190476190477 val_auprc:  0.9272062417177878
EarlyStopping counter: 23 out of 50
epoch:  79
epoch:  80 val_f1:  0.8115942028985508 val_auroc:  0.8598710317460317 val_auprc:  0.9265998805078307
EarlyStopping counter: 24 out of 50
epoch:  80
epoch:  81 val_f1:  0.8049865427618805 val_auroc:  0.8608630952380952 val_auprc:  0.9273563319479293
EarlyStopping counter: 25 out of 50
epoch:  81
epoch:  82 val_f1:  0.8138718358422335 val_auroc:  0.8596230158730159 val_auprc:  0.9268051896404944
EarlyStopping counter: 26 out of 50
epoch:  82
epoch:  83 val_f1:  0.8049865427618805 val_auroc:  0.8591269841269842 val_auprc:  0.9261265056095408
EarlyStopping counter: 27 out of 50
epoch:  83
epoch:  84 val_f1:  0.8061683443992288 val_auroc:  0.8588789682539683 val_auprc:  0.9267788391213251
EarlyStopping counter: 28 out of 50
epoch:  84
epoch:  85 val_f1:  0.7956729455237178 val_auroc:  0.8586309523809524 val_auprc:  0.9258417698732173
EarlyStopping counter: 29 out of 50
epoch:  85
epoch:  86 val_f1:  0.822380909337431 val_auroc:  0.8588789682539683 val_auprc:  0.9269401503524766
EarlyStopping counter: 30 out of 50
epoch:  86
epoch:  87 val_f1:  0.8115942028985508 val_auroc:  0.8586309523809524 val_auprc:  0.9262223434513215
EarlyStopping counter: 31 out of 50
epoch:  87
epoch:  88 val_f1:  0.8115942028985508 val_auroc:  0.8586309523809524 val_auprc:  0.9264145146200231
EarlyStopping counter: 32 out of 50
epoch:  88
epoch:  89 val_f1:  0.8061683443992288 val_auroc:  0.8578869047619049 val_auprc:  0.9263758661284396
EarlyStopping counter: 33 out of 50
epoch:  89
epoch:  90 val_f1:  0.7983928476398275 val_auroc:  0.8588789682539683 val_auprc:  0.9267986934715866
EarlyStopping counter: 34 out of 50
epoch:  90
epoch:  91 val_f1:  0.8115942028985508 val_auroc:  0.8568948412698414 val_auprc:  0.9254796771233215
EarlyStopping counter: 35 out of 50
epoch:  91
epoch:  92 val_f1:  0.7983928476398275 val_auroc:  0.857390873015873 val_auprc:  0.926266776409966
EarlyStopping counter: 36 out of 50
epoch:  92
epoch:  93 val_f1:  0.8049865427618805 val_auroc:  0.8571428571428571 val_auprc:  0.9263205846334746
EarlyStopping counter: 37 out of 50
epoch:  93
epoch:  94 val_f1:  0.8115942028985508 val_auroc:  0.8539186507936508 val_auprc:  0.9241226540925289
EarlyStopping counter: 38 out of 50
epoch:  94
epoch:  95 val_f1:  0.8156899810964081 val_auroc:  0.8591269841269842 val_auprc:  0.9265829344749127
EarlyStopping counter: 39 out of 50
epoch:  95
epoch:  96 val_f1:  0.7956729455237178 val_auroc:  0.8546626984126985 val_auprc:  0.9249189308891517
EarlyStopping counter: 40 out of 50
epoch:  96
epoch:  97 val_f1:  0.8115942028985508 val_auroc:  0.8576388888888888 val_auprc:  0.9266374234007446
EarlyStopping counter: 41 out of 50
epoch:  97
epoch:  98 val_f1:  0.8115942028985508 val_auroc:  0.8566468253968254 val_auprc:  0.9269121181272775
EarlyStopping counter: 42 out of 50
epoch:  98
epoch:  99 val_f1:  0.7983928476398275 val_auroc:  0.8563988095238095 val_auprc:  0.926383316843449
EarlyStopping counter: 43 out of 50
epoch:  99
epoch:  100 val_f1:  0.8115942028985508 val_auroc:  0.8531746031746033 val_auprc:  0.9243313479271619
EarlyStopping counter: 44 out of 50
epoch:  100
epoch:  101 val_f1:  0.7983928476398275 val_auroc:  0.8559027777777777 val_auprc:  0.9269417254149566
EarlyStopping counter: 45 out of 50
epoch:  101
epoch:  102 val_f1:  0.8049865427618805 val_auroc:  0.8561507936507936 val_auprc:  0.9258732954896155
EarlyStopping counter: 46 out of 50
epoch:  102
epoch:  103 val_f1:  0.8115942028985508 val_auroc:  0.8549107142857143 val_auprc:  0.9247910401395857
EarlyStopping counter: 47 out of 50
epoch:  103
epoch:  104 val_f1:  0.8115942028985508 val_auroc:  0.8554067460317459 val_auprc:  0.9270621709632317
EarlyStopping counter: 48 out of 50
epoch:  104
epoch:  105 val_f1:  0.8115942028985508 val_auroc:  0.8549107142857143 val_auprc:  0.9253820390814977
EarlyStopping counter: 49 out of 50
epoch:  105
epoch:  106 val_f1:  0.8049865427618805 val_auroc:  0.8551587301587301 val_auprc:  0.9251979818737189
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  29.883599996566772
{'time_elapsed': [29.883599996566772], 'epoch': [105], 'fold': [4], 'f1_train': [0.989260590074452], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8049865427618805], 'auroc_test': [0.8551587301587301], 'auprc_test': [0.9251979818737189]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 183]            1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 183]            256
│    └─Tanh: 2-3                         [64, 128, 183]            --
│    └─MaxPool1d: 2-4                    [64, 128, 26]             --
│    └─Dropout: 2-5                      [64, 128, 26]             --
│    └─Flatten: 2-6                      [64, 3328]                --
│    └─Linear: 2-7                       [64, 1]                   3,329
==========================================================================================
Total params: 4,609
Trainable params: 4,609
Non-trainable params: 0
Total mult-adds (M): 12.22
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 23.99
Params size (MB): 0.02
Estimated Total Size (MB): 24.33
==========================================================================================
