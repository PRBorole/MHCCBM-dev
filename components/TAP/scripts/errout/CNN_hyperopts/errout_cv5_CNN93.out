config:  {'project': 'MHCCBM', 'name': 'CNN_93', 'config': {'hidden_channels': [128], 'epochs': 500, 'kernel_size': 7, 'pool_kernel_size': 7, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.673294059891998 val_auprc:  0.8207600659571896
epoch:  1
epoch:  2 val_f1:  0.5736495549323253 val_auroc:  0.5004909180166912 val_auprc:  0.7996233326950044
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.15251668649843964 val_auroc:  0.5594010800196367 val_auprc:  0.714470266534555
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6072007259057618 val_auroc:  0.5272459499263623 val_auprc:  0.7306402936450396
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.3975597733144841 val_auroc:  0.6158566519391262 val_auprc:  0.7467407045088148
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6907263230511482 val_auroc:  0.6514482081492391 val_auprc:  0.7839138456128854
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.5557862334840752 val_auroc:  0.76926853215513 val_auprc:  0.9016473341601265
Validation loss improved to 0.756849
epoch:  7
epoch:  8 val_f1:  0.7349308245711123 val_auroc:  0.7918507609229258 val_auprc:  0.9134950222428752
Validation loss improved to 0.472331
epoch:  8
epoch:  9 val_f1:  0.7096759374109908 val_auroc:  0.8001963672066765 val_auprc:  0.9094633364464413
Validation loss improved to 0.458583
epoch:  9
epoch:  10 val_f1:  0.7596459003010357 val_auroc:  0.7758959253804615 val_auprc:  0.8908259999865189
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.7473302173830908 val_auroc:  0.7788414334806087 val_auprc:  0.8952287742348981
EarlyStopping counter: 2 out of 50
epoch:  11
epoch:  12 val_f1:  0.7308479257525525 val_auroc:  0.8014236622484046 val_auprc:  0.911154338241067
EarlyStopping counter: 3 out of 50
epoch:  12
epoch:  13 val_f1:  0.7510257046352308 val_auroc:  0.7992145311732941 val_auprc:  0.9077374178002555
EarlyStopping counter: 4 out of 50
epoch:  13
epoch:  14 val_f1:  0.7607703458551531 val_auroc:  0.7960235640648012 val_auprc:  0.9052463723537059
EarlyStopping counter: 5 out of 50
epoch:  14
epoch:  15 val_f1:  0.7308672563486676 val_auroc:  0.8100147275405007 val_auprc:  0.9149311381735653
EarlyStopping counter: 6 out of 50
epoch:  15
epoch:  16 val_f1:  0.7648187281552264 val_auroc:  0.801178203240059 val_auprc:  0.9093152636513187
EarlyStopping counter: 7 out of 50
epoch:  16
epoch:  17 val_f1:  0.7727225509205256 val_auroc:  0.7938144329896908 val_auprc:  0.9055746626508243
EarlyStopping counter: 8 out of 50
epoch:  17
epoch:  18 val_f1:  0.7777125328082551 val_auroc:  0.7972508591065292 val_auprc:  0.9070238571710856
EarlyStopping counter: 9 out of 50
epoch:  18
epoch:  19 val_f1:  0.7308672563486676 val_auroc:  0.818605792832597 val_auprc:  0.9214504860754599
EarlyStopping counter: 10 out of 50
epoch:  19
epoch:  20 val_f1:  0.7648187281552264 val_auroc:  0.8075601374570447 val_auprc:  0.9149659836723931
EarlyStopping counter: 11 out of 50
epoch:  20
epoch:  21 val_f1:  0.7643829551743221 val_auroc:  0.8038782523318605 val_auprc:  0.9115934797318603
EarlyStopping counter: 12 out of 50
epoch:  21
epoch:  22 val_f1:  0.7446505962267806 val_auroc:  0.8257241040746195 val_auprc:  0.927337603090826
EarlyStopping counter: 13 out of 50
epoch:  22
epoch:  23 val_f1:  0.7445203699313053 val_auroc:  0.8188512518409425 val_auprc:  0.9223577783857966
EarlyStopping counter: 14 out of 50
epoch:  23
epoch:  24 val_f1:  0.7607703458551531 val_auroc:  0.8136966126656848 val_auprc:  0.9187765555436256
EarlyStopping counter: 15 out of 50
epoch:  24
epoch:  25 val_f1:  0.7790721385700611 val_auroc:  0.8139420716740304 val_auprc:  0.9173367245804356
EarlyStopping counter: 16 out of 50
epoch:  25
epoch:  26 val_f1:  0.7831873586549224 val_auroc:  0.8168875797741777 val_auprc:  0.9198797053153112
EarlyStopping counter: 17 out of 50
epoch:  26
epoch:  27 val_f1:  0.7583300796647482 val_auroc:  0.8230240549828179 val_auprc:  0.9246586623701873
EarlyStopping counter: 18 out of 50
epoch:  27
epoch:  28 val_f1:  0.7513203127712835 val_auroc:  0.8159057437407954 val_auprc:  0.91910247589424
EarlyStopping counter: 19 out of 50
epoch:  28
epoch:  29 val_f1:  0.7577565132360132 val_auroc:  0.8134511536573391 val_auprc:  0.9180525572201068
EarlyStopping counter: 20 out of 50
epoch:  29
epoch:  30 val_f1:  0.7841726618705036 val_auroc:  0.8107511045655376 val_auprc:  0.916919456361101
EarlyStopping counter: 21 out of 50
epoch:  30
epoch:  31 val_f1:  0.7868059619290214 val_auroc:  0.8188512518409427 val_auprc:  0.9198792546143797
EarlyStopping counter: 22 out of 50
epoch:  31
epoch:  32 val_f1:  0.7813819697019021 val_auroc:  0.8168875797741777 val_auprc:  0.9195971538999173
EarlyStopping counter: 23 out of 50
epoch:  32
epoch:  33 val_f1:  0.7905466835322951 val_auroc:  0.8203240058910163 val_auprc:  0.9225625662552175
EarlyStopping counter: 24 out of 50
epoch:  33
epoch:  34 val_f1:  0.7897879661118469 val_auroc:  0.8181148748159058 val_auprc:  0.9214691594309459
EarlyStopping counter: 25 out of 50
epoch:  34
epoch:  35 val_f1:  0.770628190185282 val_auroc:  0.8230240549828178 val_auprc:  0.9249302305521463
EarlyStopping counter: 26 out of 50
epoch:  35
epoch:  36 val_f1:  0.7633714058926586 val_auroc:  0.8149239077074127 val_auprc:  0.9192883711209028
EarlyStopping counter: 27 out of 50
epoch:  36
epoch:  37 val_f1:  0.7617684906754855 val_auroc:  0.8107511045655376 val_auprc:  0.9129039084957074
EarlyStopping counter: 28 out of 50
epoch:  37
epoch:  38 val_f1:  0.7737843767539161 val_auroc:  0.822287677957781 val_auprc:  0.9248192215498796
EarlyStopping counter: 29 out of 50
epoch:  38
epoch:  39 val_f1:  0.7905466835322951 val_auroc:  0.8244968090328916 val_auprc:  0.9261703556060539
EarlyStopping counter: 30 out of 50
epoch:  39
epoch:  40 val_f1:  0.7905466835322951 val_auroc:  0.8171330387825234 val_auprc:  0.9201154956509552
EarlyStopping counter: 31 out of 50
epoch:  40
epoch:  41 val_f1:  0.7831873586549224 val_auroc:  0.8183603338242514 val_auprc:  0.9212685374968046
EarlyStopping counter: 32 out of 50
epoch:  41
epoch:  42 val_f1:  0.7868059619290214 val_auroc:  0.8205694648993619 val_auprc:  0.9230772022590474
EarlyStopping counter: 33 out of 50
epoch:  42
epoch:  43 val_f1:  0.76000113614692 val_auroc:  0.8154148257241041 val_auprc:  0.9172455534993595
EarlyStopping counter: 34 out of 50
epoch:  43
epoch:  44 val_f1:  0.7643829551743221 val_auroc:  0.8097692685321551 val_auprc:  0.9128153493135247
EarlyStopping counter: 35 out of 50
epoch:  44
epoch:  45 val_f1:  0.7963871971298289 val_auroc:  0.8176239567992145 val_auprc:  0.9202276475448221
EarlyStopping counter: 36 out of 50
epoch:  45
epoch:  46 val_f1:  0.7897879661118469 val_auroc:  0.8230240549828179 val_auprc:  0.9254850830751211
EarlyStopping counter: 37 out of 50
epoch:  46
epoch:  47 val_f1:  0.7681512331200245 val_auroc:  0.8107511045655376 val_auprc:  0.9146242308580188
EarlyStopping counter: 38 out of 50
epoch:  47
epoch:  48 val_f1:  0.7777125328082551 val_auroc:  0.8124693176239569 val_auprc:  0.9173716529443469
EarlyStopping counter: 39 out of 50
epoch:  48
epoch:  49 val_f1:  0.7831873586549224 val_auroc:  0.8215513009327442 val_auprc:  0.9240723910200395
EarlyStopping counter: 40 out of 50
epoch:  49
epoch:  50 val_f1:  0.778324933635979 val_auroc:  0.8289150711831125 val_auprc:  0.9290761522946818
EarlyStopping counter: 41 out of 50
epoch:  50
epoch:  51 val_f1:  0.7839141001375581 val_auroc:  0.8281786941580755 val_auprc:  0.9284547918478392
EarlyStopping counter: 42 out of 50
epoch:  51
epoch:  52 val_f1:  0.7697841726618705 val_auroc:  0.8183603338242513 val_auprc:  0.9220737706479877
EarlyStopping counter: 43 out of 50
epoch:  52
epoch:  53 val_f1:  0.751751326211758 val_auroc:  0.8144329896907216 val_auprc:  0.9158604956971463
EarlyStopping counter: 44 out of 50
epoch:  53
epoch:  54 val_f1:  0.7790721385700611 val_auroc:  0.8215513009327442 val_auprc:  0.9231726428894373
EarlyStopping counter: 45 out of 50
epoch:  54
epoch:  55 val_f1:  0.7839141001375581 val_auroc:  0.82793323514973 val_auprc:  0.9280444501692079
EarlyStopping counter: 46 out of 50
epoch:  55
epoch:  56 val_f1:  0.7879228532067962 val_auroc:  0.821060382916053 val_auprc:  0.9224272460199988
EarlyStopping counter: 47 out of 50
epoch:  56
epoch:  57 val_f1:  0.7823449348629204 val_auroc:  0.825478645066274 val_auprc:  0.9270678395205009
EarlyStopping counter: 48 out of 50
epoch:  57
epoch:  58 val_f1:  0.7879228532067962 val_auroc:  0.821060382916053 val_auprc:  0.9244018573567339
EarlyStopping counter: 49 out of 50
epoch:  58
epoch:  59 val_f1:  0.7681512331200245 val_auroc:  0.8132056946489936 val_auprc:  0.9161391458978907
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  208.62670230865479
{'time_elapsed': [208.62670230865479], 'epoch': [58], 'fold': [0], 'f1_train': [0.9964023152258445], 'auroc_train': [0.9999846705705613], 'auprc_train': [0.9999932970817315], 'f1_test': [0.7681512331200245], 'auroc_test': [0.8132056946489936], 'auprc_test': [0.9161391458978907]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1276]           1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 1276]           256
│    └─Tanh: 2-3                         [64, 128, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1270]           --
│    └─Dropout: 2-5                      [64, 128, 1270]           --
│    └─Flatten: 2-6                      [64, 162560]              --
│    └─Linear: 2-7                       [64, 1]                   162,561
==========================================================================================
Total params: 163,841
Trainable params: 163,841
Non-trainable params: 0
Total mult-adds (M): 94.04
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.25
Params size (MB): 0.66
Estimated Total Size (MB): 168.23
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.6550073637702504 val_auprc:  0.840730496580011
epoch:  1
epoch:  2 val_f1:  0.1402281489725347 val_auroc:  0.6313205694648993 val_auprc:  0.8343368958562265
Validation loss improved to 1.860040
epoch:  2
epoch:  3 val_f1:  0.5031855112924587 val_auroc:  0.6499754540991654 val_auprc:  0.8410673202973882
Validation loss improved to 1.241545
epoch:  3
epoch:  4 val_f1:  0.603804916141946 val_auroc:  0.7120765832106037 val_auprc:  0.8549468490713276
Validation loss improved to 0.284316
epoch:  4
epoch:  5 val_f1:  0.66505973282868 val_auroc:  0.8183603338242513 val_auprc:  0.925846615514576
Validation loss improved to 0.264184
epoch:  5
epoch:  6 val_f1:  0.751502327549725 val_auroc:  0.8195876288659794 val_auprc:  0.92643149051539
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.6868550792725379 val_auroc:  0.8154148257241041 val_auprc:  0.924742203073995
EarlyStopping counter: 2 out of 50
epoch:  7
epoch:  8 val_f1:  0.7377728985642654 val_auroc:  0.8181148748159057 val_auprc:  0.9242850885850233
EarlyStopping counter: 3 out of 50
epoch:  8
epoch:  9 val_f1:  0.7823449348629204 val_auroc:  0.8225331369661267 val_auprc:  0.9237002815809701
EarlyStopping counter: 4 out of 50
epoch:  9
epoch:  10 val_f1:  0.7681512331200245 val_auroc:  0.8188512518409427 val_auprc:  0.9208869953077786
Validation loss improved to 0.243338
epoch:  10
epoch:  11 val_f1:  0.7697841726618705 val_auroc:  0.8208149239077075 val_auprc:  0.9218557316407279
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7772753225990636 val_auroc:  0.8141875306823761 val_auprc:  0.9194307856629604
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.7850374843605565 val_auroc:  0.8235149729995092 val_auprc:  0.9248141809684702
EarlyStopping counter: 3 out of 50
epoch:  13
epoch:  14 val_f1:  0.6794627975876525 val_auroc:  0.8146784486990672 val_auprc:  0.9235584140452061
EarlyStopping counter: 4 out of 50
epoch:  14
epoch:  15 val_f1:  0.7715989981939552 val_auroc:  0.8237604320078546 val_auprc:  0.9253862111306312
EarlyStopping counter: 5 out of 50
epoch:  15
epoch:  16 val_f1:  0.7580594896895918 val_auroc:  0.82793323514973 val_auprc:  0.9233179759381274
Validation loss improved to 0.230518
epoch:  16
epoch:  17 val_f1:  0.7920536597238516 val_auroc:  0.8284241531664213 val_auprc:  0.9228816471810508
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.766354189375772 val_auroc:  0.8227785959744722 val_auprc:  0.9203465882974997
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7809570525397864 val_auroc:  0.8298969072164949 val_auprc:  0.9236405008447879
Validation loss improved to 0.225737
epoch:  19
epoch:  20 val_f1:  0.7643829551743221 val_auroc:  0.8271968581246931 val_auprc:  0.921483299980701
Validation loss improved to 0.218282
epoch:  20
epoch:  21 val_f1:  0.7906450372602754 val_auroc:  0.8281786941580757 val_auprc:  0.9223793694663989
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7826417810500232 val_auroc:  0.8298969072164949 val_auprc:  0.9232086039490608
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.7711689349644636 val_auroc:  0.8247422680412371 val_auprc:  0.9227569217497721
EarlyStopping counter: 3 out of 50
epoch:  23
epoch:  24 val_f1:  0.8178162372969339 val_auroc:  0.8333333333333333 val_auprc:  0.9248016102750278
EarlyStopping counter: 4 out of 50
epoch:  24
epoch:  25 val_f1:  0.797175270999766 val_auroc:  0.8308787432498773 val_auprc:  0.9238694470389137
EarlyStopping counter: 5 out of 50
epoch:  25
epoch:  26 val_f1:  0.8218323698145653 val_auroc:  0.8352970054000982 val_auprc:  0.9252898050067858
EarlyStopping counter: 6 out of 50
epoch:  26
epoch:  27 val_f1:  0.7906450372602754 val_auroc:  0.8306332842415316 val_auprc:  0.9226537110249452
EarlyStopping counter: 7 out of 50
epoch:  27
epoch:  28 val_f1:  0.7643829551743221 val_auroc:  0.8340697103583702 val_auprc:  0.9230212457055642
Validation loss improved to 0.209908
epoch:  28
epoch:  29 val_f1:  0.7727225509205256 val_auroc:  0.834806087383407 val_auprc:  0.9237870582530177
Validation loss improved to 0.206388
epoch:  29
epoch:  30 val_f1:  0.766354189375772 val_auroc:  0.8357879234167894 val_auprc:  0.9244183283689947
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7906450372602754 val_auroc:  0.834806087383407 val_auprc:  0.9229154134617342
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.7622262794246104 val_auroc:  0.8372606774668631 val_auprc:  0.9223778375210174
Validation loss improved to 0.196490
epoch:  32
epoch:  33 val_f1:  0.7791090204759269 val_auroc:  0.8370152184585175 val_auprc:  0.9215435273268372
Validation loss improved to 0.186676
epoch:  33
epoch:  34 val_f1:  0.806394786639448 val_auroc:  0.8421698576337752 val_auprc:  0.9268799588013714
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.7727225509205256 val_auroc:  0.8328424153166422 val_auprc:  0.9216983968639133
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.7707245329923307 val_auroc:  0.836033382425135 val_auprc:  0.9220846604290671
Validation loss improved to 0.185837
epoch:  36
epoch:  37 val_f1:  0.7791090204759269 val_auroc:  0.8365243004418262 val_auprc:  0.9219667102605098
Validation loss improved to 0.183007
epoch:  37
epoch:  38 val_f1:  0.7971323289800215 val_auroc:  0.8370152184585175 val_auprc:  0.9237447904379389
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.76000113614692 val_auroc:  0.8274423171330387 val_auprc:  0.9194096998246967
EarlyStopping counter: 2 out of 50
epoch:  39
epoch:  40 val_f1:  0.7707245329923307 val_auroc:  0.8343151693667157 val_auprc:  0.9210920367333366
EarlyStopping counter: 3 out of 50
epoch:  40
epoch:  41 val_f1:  0.7598715939807772 val_auroc:  0.833578792341679 val_auprc:  0.9183889911759282
Validation loss improved to 0.178711
epoch:  41
epoch:  42 val_f1:  0.7791090204759269 val_auroc:  0.8352970054000982 val_auprc:  0.9206301630247793
EarlyStopping counter: 1 out of 50
epoch:  42
epoch:  43 val_f1:  0.7648576099332736 val_auroc:  0.8281786941580757 val_auprc:  0.92190315406033
EarlyStopping counter: 2 out of 50
epoch:  43
epoch:  44 val_f1:  0.7879228532067962 val_auroc:  0.8301423662248404 val_auprc:  0.921715208988321
EarlyStopping counter: 3 out of 50
epoch:  44
epoch:  45 val_f1:  0.8029873436454202 val_auroc:  0.826705940108002 val_auprc:  0.9202207038263552
EarlyStopping counter: 4 out of 50
epoch:  45
epoch:  46 val_f1:  0.7944676896257205 val_auroc:  0.8296514482081492 val_auprc:  0.9201038687390748
EarlyStopping counter: 5 out of 50
epoch:  46
epoch:  47 val_f1:  0.7890919075230509 val_auroc:  0.8392243495336279 val_auprc:  0.9228639455203493
EarlyStopping counter: 6 out of 50
epoch:  47
epoch:  48 val_f1:  0.7963871971298289 val_auroc:  0.8316151202749141 val_auprc:  0.9213474935537357
EarlyStopping counter: 7 out of 50
epoch:  48
epoch:  49 val_f1:  0.7839141001375581 val_auroc:  0.82793323514973 val_auprc:  0.9212710336494164
EarlyStopping counter: 8 out of 50
epoch:  49
epoch:  50 val_f1:  0.7745465218349855 val_auroc:  0.8330878743249878 val_auprc:  0.9210987298174138
EarlyStopping counter: 9 out of 50
epoch:  50
epoch:  51 val_f1:  0.766354189375772 val_auroc:  0.8291605301914581 val_auprc:  0.9176993384778478
EarlyStopping counter: 10 out of 50
epoch:  51
epoch:  52 val_f1:  0.7510724063582411 val_auroc:  0.8355424644084438 val_auprc:  0.9197103928062166
Validation loss improved to 0.158742
epoch:  52
epoch:  53 val_f1:  0.7707245329923307 val_auroc:  0.8357879234167893 val_auprc:  0.9197193512818554
EarlyStopping counter: 1 out of 50
epoch:  53
epoch:  54 val_f1:  0.7643829551743221 val_auroc:  0.8313696612665685 val_auprc:  0.918292127311414
EarlyStopping counter: 2 out of 50
epoch:  54
epoch:  55 val_f1:  0.7826417810500232 val_auroc:  0.8313696612665685 val_auprc:  0.917077778977426
EarlyStopping counter: 3 out of 50
epoch:  55
epoch:  56 val_f1:  0.7707245329923307 val_auroc:  0.8330878743249877 val_auprc:  0.9189324085602957
EarlyStopping counter: 4 out of 50
epoch:  56
epoch:  57 val_f1:  0.7510724063582411 val_auroc:  0.8338242513500246 val_auprc:  0.9180666961360602
Validation loss improved to 0.149696
epoch:  57
epoch:  58 val_f1:  0.7944676896257205 val_auroc:  0.8289150711831124 val_auprc:  0.918083065596663
EarlyStopping counter: 1 out of 50
epoch:  58
epoch:  59 val_f1:  0.7681512331200245 val_auroc:  0.8276877761413843 val_auprc:  0.9156900632426244
EarlyStopping counter: 2 out of 50
epoch:  59
epoch:  60 val_f1:  0.76000113614692 val_auroc:  0.8301423662248405 val_auprc:  0.9168337758337565
EarlyStopping counter: 3 out of 50
epoch:  60
epoch:  61 val_f1:  0.7868059619290214 val_auroc:  0.8279332351497299 val_auprc:  0.9176372620941071
EarlyStopping counter: 4 out of 50
epoch:  61
epoch:  62 val_f1:  0.7841726618705036 val_auroc:  0.8291605301914581 val_auprc:  0.9161044522868058
EarlyStopping counter: 5 out of 50
epoch:  62
epoch:  63 val_f1:  0.7855581813618873 val_auroc:  0.8333333333333333 val_auprc:  0.918881119845602
EarlyStopping counter: 6 out of 50
epoch:  63
epoch:  64 val_f1:  0.7643829551743221 val_auroc:  0.830387825233186 val_auprc:  0.9166503787437001
EarlyStopping counter: 7 out of 50
epoch:  64
epoch:  65 val_f1:  0.7598715939807772 val_auroc:  0.8316151202749141 val_auprc:  0.916503769836614
EarlyStopping counter: 8 out of 50
epoch:  65
epoch:  66 val_f1:  0.7536081085870222 val_auroc:  0.8330878743249877 val_auprc:  0.9172629513680148
EarlyStopping counter: 9 out of 50
epoch:  66
epoch:  67 val_f1:  0.7841726618705036 val_auroc:  0.8262150220913107 val_auprc:  0.9140971983988015
EarlyStopping counter: 10 out of 50
epoch:  67
epoch:  68 val_f1:  0.7762067639678805 val_auroc:  0.8252331860579283 val_auprc:  0.9131000020328055
EarlyStopping counter: 11 out of 50
epoch:  68
epoch:  69 val_f1:  0.7762067639678805 val_auroc:  0.8269513991163476 val_auprc:  0.914748928402151
EarlyStopping counter: 12 out of 50
epoch:  69
epoch:  70 val_f1:  0.7841726618705036 val_auroc:  0.8252331860579284 val_auprc:  0.9138684313520651
EarlyStopping counter: 13 out of 50
epoch:  70
epoch:  71 val_f1:  0.8010188978004199 val_auroc:  0.8242513500245459 val_auprc:  0.914157448876752
EarlyStopping counter: 14 out of 50
epoch:  71
epoch:  72 val_f1:  0.7944676896257205 val_auroc:  0.8269513991163476 val_auprc:  0.9161744595921154
EarlyStopping counter: 15 out of 50
epoch:  72
epoch:  73 val_f1:  0.7944676896257205 val_auroc:  0.8259695630829652 val_auprc:  0.9149994273670541
EarlyStopping counter: 16 out of 50
epoch:  73
epoch:  74 val_f1:  0.7933255489848959 val_auroc:  0.8284241531664213 val_auprc:  0.9159191663435811
EarlyStopping counter: 17 out of 50
epoch:  74
epoch:  75 val_f1:  0.751751326211758 val_auroc:  0.8257241040746196 val_auprc:  0.914525779638212
EarlyStopping counter: 18 out of 50
epoch:  75
epoch:  76 val_f1:  0.76000113614692 val_auroc:  0.8242513500245459 val_auprc:  0.9127023600224617
EarlyStopping counter: 19 out of 50
epoch:  76
epoch:  77 val_f1:  0.7855581813618873 val_auroc:  0.8254786450662739 val_auprc:  0.9142104034408938
EarlyStopping counter: 20 out of 50
epoch:  77
epoch:  78 val_f1:  0.7944676896257205 val_auroc:  0.8244968090328915 val_auprc:  0.9133999167512925
EarlyStopping counter: 21 out of 50
epoch:  78
epoch:  79 val_f1:  0.7944676896257205 val_auroc:  0.8240058910162003 val_auprc:  0.9133010355133424
EarlyStopping counter: 22 out of 50
epoch:  79
epoch:  80 val_f1:  0.7809570525397864 val_auroc:  0.8294059891998037 val_auprc:  0.915502524918007
EarlyStopping counter: 23 out of 50
epoch:  80
epoch:  81 val_f1:  0.7622262794246104 val_auroc:  0.8311242022582228 val_auprc:  0.91683802574412
EarlyStopping counter: 24 out of 50
epoch:  81
epoch:  82 val_f1:  0.7920536597238516 val_auroc:  0.8267059401080019 val_auprc:  0.9140263210327054
EarlyStopping counter: 25 out of 50
epoch:  82
epoch:  83 val_f1:  0.7920536597238516 val_auroc:  0.824251350024546 val_auprc:  0.9117581384656767
EarlyStopping counter: 26 out of 50
epoch:  83
epoch:  84 val_f1:  0.7685409504908388 val_auroc:  0.8249877270495827 val_auprc:  0.9120303711257557
EarlyStopping counter: 27 out of 50
epoch:  84
epoch:  85 val_f1:  0.7685409504908388 val_auroc:  0.8269513991163475 val_auprc:  0.9133810802446235
EarlyStopping counter: 28 out of 50
epoch:  85
epoch:  86 val_f1:  0.7685409504908388 val_auroc:  0.8264604810996564 val_auprc:  0.9126455266077822
EarlyStopping counter: 29 out of 50
epoch:  86
epoch:  87 val_f1:  0.7920536597238516 val_auroc:  0.8240058910162003 val_auprc:  0.9128564501536054
EarlyStopping counter: 30 out of 50
epoch:  87
epoch:  88 val_f1:  0.7841726618705036 val_auroc:  0.8247422680412371 val_auprc:  0.9134002908065812
EarlyStopping counter: 31 out of 50
epoch:  88
epoch:  89 val_f1:  0.7707245329923307 val_auroc:  0.8257241040746196 val_auprc:  0.9127654977584614
EarlyStopping counter: 32 out of 50
epoch:  89
epoch:  90 val_f1:  0.8010188978004199 val_auroc:  0.8232695139911635 val_auprc:  0.9130877059642791
EarlyStopping counter: 33 out of 50
epoch:  90
epoch:  91 val_f1:  0.7681512331200245 val_auroc:  0.8252331860579283 val_auprc:  0.913498406752543
EarlyStopping counter: 34 out of 50
epoch:  91
epoch:  92 val_f1:  0.7685409504908388 val_auroc:  0.8271968581246931 val_auprc:  0.9144941497814005
EarlyStopping counter: 35 out of 50
epoch:  92
epoch:  93 val_f1:  0.7685409504908388 val_auroc:  0.8262150220913108 val_auprc:  0.9134941605628243
EarlyStopping counter: 36 out of 50
epoch:  93
epoch:  94 val_f1:  0.7598715939807772 val_auroc:  0.8264604810996564 val_auprc:  0.9128738358257511
EarlyStopping counter: 37 out of 50
epoch:  94
epoch:  95 val_f1:  0.7762067639678805 val_auroc:  0.8244968090328915 val_auprc:  0.9118734690701388
EarlyStopping counter: 38 out of 50
epoch:  95
epoch:  96 val_f1:  0.7944676896257205 val_auroc:  0.8230240549828178 val_auprc:  0.9126922623862972
EarlyStopping counter: 39 out of 50
epoch:  96
epoch:  97 val_f1:  0.7920536597238516 val_auroc:  0.824742268041237 val_auprc:  0.9139055330799299
EarlyStopping counter: 40 out of 50
epoch:  97
epoch:  98 val_f1:  0.7598715939807772 val_auroc:  0.8248649975454099 val_auprc:  0.912306745313584
EarlyStopping counter: 41 out of 50
epoch:  98
epoch:  99 val_f1:  0.7622262794246104 val_auroc:  0.8240058910162003 val_auprc:  0.9110717151761297
EarlyStopping counter: 42 out of 50
epoch:  99
epoch:  100 val_f1:  0.7496568898727172 val_auroc:  0.824251350024546 val_auprc:  0.9119394303835319
EarlyStopping counter: 43 out of 50
epoch:  100
epoch:  101 val_f1:  0.76000113614692 val_auroc:  0.8240058910162003 val_auprc:  0.911819264213817
EarlyStopping counter: 44 out of 50
epoch:  101
epoch:  102 val_f1:  0.7933255489848959 val_auroc:  0.822287677957781 val_auprc:  0.912187186573318
EarlyStopping counter: 45 out of 50
epoch:  102
epoch:  103 val_f1:  0.7841726618705036 val_auroc:  0.823514972999509 val_auprc:  0.9120814013149381
EarlyStopping counter: 46 out of 50
epoch:  103
epoch:  104 val_f1:  0.7559325673789327 val_auroc:  0.8252331860579283 val_auprc:  0.9130783655089502
EarlyStopping counter: 47 out of 50
epoch:  104
epoch:  105 val_f1:  0.7598715939807772 val_auroc:  0.8257241040746196 val_auprc:  0.9125729206259763
EarlyStopping counter: 48 out of 50
epoch:  105
epoch:  106 val_f1:  0.7598715939807772 val_auroc:  0.8244968090328915 val_auprc:  0.9110633768544547
EarlyStopping counter: 49 out of 50
epoch:  106
epoch:  107 val_f1:  0.7622262794246104 val_auroc:  0.8244968090328915 val_auprc:  0.9112856191170531
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  364.35379695892334
{'time_elapsed': [364.35379695892334], 'epoch': [106], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7622262794246104], 'auroc_test': [0.8244968090328915], 'auprc_test': [0.9112856191170531]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1276]           1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 1276]           256
│    └─Tanh: 2-3                         [64, 128, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1270]           --
│    └─Dropout: 2-5                      [64, 128, 1270]           --
│    └─Flatten: 2-6                      [64, 162560]              --
│    └─Linear: 2-7                       [64, 1]                   162,561
==========================================================================================
Total params: 163,841
Trainable params: 163,841
Non-trainable params: 0
Total mult-adds (M): 94.04
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.25
Params size (MB): 0.66
Estimated Total Size (MB): 168.23
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.3038384015115686 val_auroc:  0.6298478154148257 val_auprc:  0.8185931503059347
epoch:  1
epoch:  2 val_f1:  0.6192125314526703 val_auroc:  0.6354933726067746 val_auprc:  0.8257946755442114
Validation loss improved to 0.452947
epoch:  2
epoch:  3 val_f1:  0.5630140098447558 val_auroc:  0.6762395679921454 val_auprc:  0.8483810004923962
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6119595151436944 val_auroc:  0.7147766323024055 val_auprc:  0.866865300278853
EarlyStopping counter: 2 out of 50
epoch:  4
epoch:  5 val_f1:  0.6787370103916865 val_auroc:  0.7410407461953854 val_auprc:  0.8737415462996712
EarlyStopping counter: 3 out of 50
epoch:  5
epoch:  6 val_f1:  0.7157412825720284 val_auroc:  0.7528227785959745 val_auprc:  0.8786712074452402
EarlyStopping counter: 4 out of 50
epoch:  6
epoch:  7 val_f1:  0.7266187050359713 val_auroc:  0.7744231713303878 val_auprc:  0.8909041651014107
Validation loss improved to 0.399197
epoch:  7
epoch:  8 val_f1:  0.7122302158273381 val_auroc:  0.7744231713303878 val_auprc:  0.8904296356551216
Validation loss improved to 0.358278
epoch:  8
epoch:  9 val_f1:  0.6610684696390046 val_auroc:  0.7579774177712323 val_auprc:  0.8806319291497239
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.6590199752078746 val_auroc:  0.7677957781050564 val_auprc:  0.8868916771055446
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.7428255465713769 val_auroc:  0.7771232204221895 val_auprc:  0.888726571339844
Validation loss improved to 0.337117
epoch:  11
epoch:  12 val_f1:  0.7346160281077464 val_auroc:  0.7893961708394698 val_auprc:  0.8922960770651898
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7208636520171812 val_auroc:  0.7925871379479626 val_auprc:  0.8954269511791773
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.7371484630477437 val_auroc:  0.7790868924889544 val_auprc:  0.8886221589259343
EarlyStopping counter: 3 out of 50
epoch:  14
epoch:  15 val_f1:  0.7215941532488295 val_auroc:  0.7687776141384389 val_auprc:  0.8831500285138731
EarlyStopping counter: 4 out of 50
epoch:  15
epoch:  16 val_f1:  0.6289646282660997 val_auroc:  0.7734413352970054 val_auprc:  0.8900873038310143
EarlyStopping counter: 5 out of 50
epoch:  16
epoch:  17 val_f1:  0.7313689473952751 val_auroc:  0.7869415807560137 val_auprc:  0.8956974165640239
Validation loss improved to 0.322613
epoch:  17
epoch:  18 val_f1:  0.7044810154681304 val_auroc:  0.7731958762886598 val_auprc:  0.8859297036496603
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7090514753972222 val_auroc:  0.7803141875306824 val_auprc:  0.8927681389252965
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7203480251458693 val_auroc:  0.7808051055473737 val_auprc:  0.8899970697946604
EarlyStopping counter: 3 out of 50
epoch:  20
epoch:  21 val_f1:  0.7169009504644194 val_auroc:  0.7641138929798724 val_auprc:  0.8817424580609661
EarlyStopping counter: 4 out of 50
epoch:  21
epoch:  22 val_f1:  0.7162290583621869 val_auroc:  0.7712322042218949 val_auprc:  0.8851222997956948
EarlyStopping counter: 5 out of 50
epoch:  22
epoch:  23 val_f1:  0.7328919440906961 val_auroc:  0.7842415316642121 val_auprc:  0.8908385249769166
EarlyStopping counter: 6 out of 50
epoch:  23
epoch:  24 val_f1:  0.7108600244444511 val_auroc:  0.7673048600883653 val_auprc:  0.8813042736774286
EarlyStopping counter: 7 out of 50
epoch:  24
epoch:  25 val_f1:  0.706765356945213 val_auroc:  0.7741777123220422 val_auprc:  0.887583857897329
Validation loss improved to 0.321759
epoch:  25
epoch:  26 val_f1:  0.7094198370570532 val_auroc:  0.7631320569464899 val_auprc:  0.8763496379010509
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7283736963917239 val_auroc:  0.7734413352970053 val_auprc:  0.8884388907130687
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7266187050359713 val_auroc:  0.7695139911634756 val_auprc:  0.8767968353315186
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.7094198370570532 val_auroc:  0.7704958271968582 val_auprc:  0.8832262786950085
EarlyStopping counter: 4 out of 50
epoch:  29
epoch:  30 val_f1:  0.7140775751491829 val_auroc:  0.7714776632302406 val_auprc:  0.8825768556834368
EarlyStopping counter: 5 out of 50
epoch:  30
epoch:  31 val_f1:  0.7095299887411026 val_auroc:  0.7589592538046147 val_auprc:  0.876171753843113
EarlyStopping counter: 6 out of 50
epoch:  31
epoch:  32 val_f1:  0.7094198370570532 val_auroc:  0.7609229258713796 val_auprc:  0.8780261946695347
EarlyStopping counter: 7 out of 50
epoch:  32
epoch:  33 val_f1:  0.7078050864958872 val_auroc:  0.7663230240549828 val_auprc:  0.8805322927477504
EarlyStopping counter: 8 out of 50
epoch:  33
epoch:  34 val_f1:  0.7359369647139431 val_auroc:  0.7697594501718213 val_auprc:  0.8729384668530547
EarlyStopping counter: 9 out of 50
epoch:  34
epoch:  35 val_f1:  0.7029258641632973 val_auroc:  0.7614138438880707 val_auprc:  0.8806798836683101
EarlyStopping counter: 10 out of 50
epoch:  35
epoch:  36 val_f1:  0.7015283467006299 val_auroc:  0.7663230240549829 val_auprc:  0.8765989854451595
EarlyStopping counter: 11 out of 50
epoch:  36
epoch:  37 val_f1:  0.726967940210938 val_auroc:  0.7731958762886598 val_auprc:  0.8800281070370034
EarlyStopping counter: 12 out of 50
epoch:  37
epoch:  38 val_f1:  0.7266187050359713 val_auroc:  0.7675503190967109 val_auprc:  0.8762866937797352
EarlyStopping counter: 13 out of 50
epoch:  38
epoch:  39 val_f1:  0.6967556353929608 val_auroc:  0.7628865979381444 val_auprc:  0.8745481647845058
Validation loss improved to 0.311670
epoch:  39
epoch:  40 val_f1:  0.7117994924448791 val_auroc:  0.770004909180167 val_auprc:  0.8733089324978739
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.7266187050359713 val_auroc:  0.764359351988218 val_auprc:  0.8727920296836649
EarlyStopping counter: 2 out of 50
epoch:  41
epoch:  42 val_f1:  0.7203480251458693 val_auroc:  0.757486499754541 val_auprc:  0.8635825398575812
EarlyStopping counter: 3 out of 50
epoch:  42
epoch:  43 val_f1:  0.7015283467006299 val_auroc:  0.7638684339715267 val_auprc:  0.8736034442767471
EarlyStopping counter: 4 out of 50
epoch:  43
epoch:  44 val_f1:  0.6794975987802813 val_auroc:  0.7668139420716741 val_auprc:  0.8766834818856688
EarlyStopping counter: 5 out of 50
epoch:  44
epoch:  45 val_f1:  0.7391701372600277 val_auroc:  0.7594501718213059 val_auprc:  0.8708101497633077
EarlyStopping counter: 6 out of 50
epoch:  45
epoch:  46 val_f1:  0.7349308245711123 val_auroc:  0.7582228767795778 val_auprc:  0.8659670600711242
EarlyStopping counter: 7 out of 50
epoch:  46
epoch:  47 val_f1:  0.7263486361521366 val_auroc:  0.7601865488463427 val_auprc:  0.8661776799473205
EarlyStopping counter: 8 out of 50
epoch:  47
epoch:  48 val_f1:  0.7157412825720284 val_auroc:  0.7528227785959745 val_auprc:  0.8647443030176423
EarlyStopping counter: 9 out of 50
epoch:  48
epoch:  49 val_f1:  0.751751326211758 val_auroc:  0.7594501718213059 val_auprc:  0.8660311904149769
EarlyStopping counter: 10 out of 50
epoch:  49
epoch:  50 val_f1:  0.7349308245711123 val_auroc:  0.7646048109965636 val_auprc:  0.8754630803141168
EarlyStopping counter: 11 out of 50
epoch:  50
epoch:  51 val_f1:  0.7391701372600277 val_auroc:  0.7542955326460481 val_auprc:  0.8632914809717575
EarlyStopping counter: 12 out of 50
epoch:  51
epoch:  52 val_f1:  0.7371484630477437 val_auroc:  0.7577319587628867 val_auprc:  0.8639454329011513
EarlyStopping counter: 13 out of 50
epoch:  52
epoch:  53 val_f1:  0.7411406017655346 val_auroc:  0.7569955817378499 val_auprc:  0.8645089447186687
EarlyStopping counter: 14 out of 50
epoch:  53
epoch:  54 val_f1:  0.706765356945213 val_auroc:  0.7474226804123711 val_auprc:  0.8590208165923054
EarlyStopping counter: 15 out of 50
epoch:  54
epoch:  55 val_f1:  0.7309103647707891 val_auroc:  0.7545409916543937 val_auprc:  0.8632149274079258
EarlyStopping counter: 16 out of 50
epoch:  55
epoch:  56 val_f1:  0.6931377974543442 val_auroc:  0.7574864997545411 val_auprc:  0.8631538294333817
EarlyStopping counter: 17 out of 50
epoch:  56
epoch:  57 val_f1:  0.7235944791518311 val_auroc:  0.7538046146293569 val_auprc:  0.8624499632361592
EarlyStopping counter: 18 out of 50
epoch:  57
epoch:  58 val_f1:  0.7266187050359713 val_auroc:  0.7542955326460481 val_auprc:  0.8621619185878596
EarlyStopping counter: 19 out of 50
epoch:  58
epoch:  59 val_f1:  0.7117994924448791 val_auroc:  0.7594501718213058 val_auprc:  0.8666614312062286
EarlyStopping counter: 20 out of 50
epoch:  59
epoch:  60 val_f1:  0.7287333672277241 val_auroc:  0.749386352479136 val_auprc:  0.8594048267386852
EarlyStopping counter: 21 out of 50
epoch:  60
epoch:  61 val_f1:  0.7235944791518311 val_auroc:  0.7474226804123711 val_auprc:  0.858372956610351
EarlyStopping counter: 22 out of 50
epoch:  61
epoch:  62 val_f1:  0.7325045643526866 val_auroc:  0.7545409916543938 val_auprc:  0.8637320711404988
EarlyStopping counter: 23 out of 50
epoch:  62
epoch:  63 val_f1:  0.7225455998837295 val_auroc:  0.7520864015709376 val_auprc:  0.8601026577925757
EarlyStopping counter: 24 out of 50
epoch:  63
epoch:  64 val_f1:  0.7349308245711123 val_auroc:  0.7533136966126657 val_auprc:  0.8607160506242315
EarlyStopping counter: 25 out of 50
epoch:  64
epoch:  65 val_f1:  0.7391701372600277 val_auroc:  0.7542955326460481 val_auprc:  0.8615505024013232
EarlyStopping counter: 26 out of 50
epoch:  65
epoch:  66 val_f1:  0.7287333672277241 val_auroc:  0.7550319096710849 val_auprc:  0.8616380855720928
EarlyStopping counter: 27 out of 50
epoch:  66
epoch:  67 val_f1:  0.7325045643526866 val_auroc:  0.7545409916543937 val_auprc:  0.8617535437047021
EarlyStopping counter: 28 out of 50
epoch:  67
epoch:  68 val_f1:  0.7325045643526866 val_auroc:  0.7515954835542464 val_auprc:  0.8584577017435069
EarlyStopping counter: 29 out of 50
epoch:  68
epoch:  69 val_f1:  0.7249644134959412 val_auroc:  0.7447226313205695 val_auprc:  0.8556704690815701
EarlyStopping counter: 30 out of 50
epoch:  69
epoch:  70 val_f1:  0.7263486361521366 val_auroc:  0.7550319096710849 val_auprc:  0.8621632868097739
EarlyStopping counter: 31 out of 50
epoch:  70
epoch:  71 val_f1:  0.7237424247793883 val_auroc:  0.7410407461953853 val_auprc:  0.8497657023809045
EarlyStopping counter: 32 out of 50
epoch:  71
epoch:  72 val_f1:  0.7197172881491292 val_auroc:  0.7447226313205695 val_auprc:  0.8584495335485622
EarlyStopping counter: 33 out of 50
epoch:  72
epoch:  73 val_f1:  0.726175885795287 val_auroc:  0.7503681885125183 val_auprc:  0.8635838406926364
EarlyStopping counter: 34 out of 50
epoch:  73
epoch:  74 val_f1:  0.7473302173830908 val_auroc:  0.7540500736377025 val_auprc:  0.8646494825581083
EarlyStopping counter: 35 out of 50
epoch:  74
epoch:  75 val_f1:  0.76000113614692 val_auroc:  0.7525773195876289 val_auprc:  0.8596328672675142
EarlyStopping counter: 36 out of 50
epoch:  75
epoch:  76 val_f1:  0.751751326211758 val_auroc:  0.749386352479136 val_auprc:  0.8572368480355661
EarlyStopping counter: 37 out of 50
epoch:  76
epoch:  77 val_f1:  0.751751326211758 val_auroc:  0.751840942562592 val_auprc:  0.8590607430213489
EarlyStopping counter: 38 out of 50
epoch:  77
epoch:  78 val_f1:  0.751751326211758 val_auroc:  0.7525773195876289 val_auprc:  0.8593040325499599
EarlyStopping counter: 39 out of 50
epoch:  78
epoch:  79 val_f1:  0.743396428458658 val_auroc:  0.750613647520864 val_auprc:  0.8578011754744974
EarlyStopping counter: 40 out of 50
epoch:  79
epoch:  80 val_f1:  0.7325045643526866 val_auroc:  0.7506136475208639 val_auprc:  0.8568225361148714
EarlyStopping counter: 41 out of 50
epoch:  80
epoch:  81 val_f1:  0.7148475178521729 val_auroc:  0.7533136966126657 val_auprc:  0.8610925402649199
EarlyStopping counter: 42 out of 50
epoch:  81
epoch:  82 val_f1:  0.7025483104025048 val_auroc:  0.7547864506627393 val_auprc:  0.8629320271345775
EarlyStopping counter: 43 out of 50
epoch:  82
epoch:  83 val_f1:  0.7117994924448791 val_auroc:  0.7533136966126657 val_auprc:  0.859915056300253
EarlyStopping counter: 44 out of 50
epoch:  83
epoch:  84 val_f1:  0.7237424247793883 val_auroc:  0.7479135984290622 val_auprc:  0.8537830864850908
EarlyStopping counter: 45 out of 50
epoch:  84
epoch:  85 val_f1:  0.751751326211758 val_auroc:  0.755031909671085 val_auprc:  0.862286306928328
EarlyStopping counter: 46 out of 50
epoch:  85
epoch:  86 val_f1:  0.7426698176342648 val_auroc:  0.7479135984290624 val_auprc:  0.8556365589095152
EarlyStopping counter: 47 out of 50
epoch:  86
epoch:  87 val_f1:  0.76000113614692 val_auroc:  0.7501227295041728 val_auprc:  0.8581328904116092
EarlyStopping counter: 48 out of 50
epoch:  87
epoch:  88 val_f1:  0.7536606851900262 val_auroc:  0.749386352479136 val_auprc:  0.8577769550217214
EarlyStopping counter: 49 out of 50
epoch:  88
epoch:  89 val_f1:  0.7505653177403916 val_auroc:  0.7474226804123711 val_auprc:  0.8559034636295046
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  309.0413053035736
{'time_elapsed': [309.0413053035736], 'epoch': [88], 'fold': [2], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7505653177403916], 'auroc_test': [0.7474226804123711], 'auprc_test': [0.8559034636295046]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1276]           1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 1276]           256
│    └─Tanh: 2-3                         [64, 128, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1270]           --
│    └─Dropout: 2-5                      [64, 128, 1270]           --
│    └─Flatten: 2-6                      [64, 162560]              --
│    └─Linear: 2-7                       [64, 1]                   162,561
==========================================================================================
Total params: 163,841
Trainable params: 163,841
Non-trainable params: 0
Total mult-adds (M): 94.04
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.25
Params size (MB): 0.66
Estimated Total Size (MB): 168.23
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5642736874330323 val_auroc:  0.6688468992248062 val_auprc:  0.7859514176839677
epoch:  1
epoch:  2 val_f1:  0.6122720870922309 val_auroc:  0.5738856589147286 val_auprc:  0.7403706268285071
Validation loss improved to 0.578779
epoch:  2
epoch:  3 val_f1:  0.368300041320209 val_auroc:  0.6242732558139535 val_auprc:  0.7534005532869812
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6410754081450012 val_auroc:  0.623062015503876 val_auprc:  0.7655121055322667
Validation loss improved to 0.075922
epoch:  4
epoch:  5 val_f1:  0.5927742805755396 val_auroc:  0.6814437984496124 val_auprc:  0.7979271562480474
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.7016489533393928 val_auroc:  0.7446705426356588 val_auprc:  0.851964060263294
EarlyStopping counter: 2 out of 50
epoch:  6
epoch:  7 val_f1:  0.7052680436296125 val_auroc:  0.7742248062015504 val_auprc:  0.879274318539932
EarlyStopping counter: 3 out of 50
epoch:  7
epoch:  8 val_f1:  0.6694349218611688 val_auroc:  0.784156976744186 val_auprc:  0.9067888585886887
EarlyStopping counter: 4 out of 50
epoch:  8
epoch:  9 val_f1:  0.7246280645386601 val_auroc:  0.8088662790697675 val_auprc:  0.9070204505946067
EarlyStopping counter: 5 out of 50
epoch:  9
epoch:  10 val_f1:  0.7582291613517698 val_auroc:  0.8183139534883721 val_auprc:  0.9100340322820966
EarlyStopping counter: 6 out of 50
epoch:  10
epoch:  11 val_f1:  0.7754499696945739 val_auroc:  0.8255813953488372 val_auprc:  0.9131935110870232
EarlyStopping counter: 7 out of 50
epoch:  11
epoch:  12 val_f1:  0.7789671954250403 val_auroc:  0.8234011627906976 val_auprc:  0.9125865867172316
EarlyStopping counter: 8 out of 50
epoch:  12
epoch:  13 val_f1:  0.8093907785715628 val_auroc:  0.8277616279069767 val_auprc:  0.917466675759423
EarlyStopping counter: 9 out of 50
epoch:  13
epoch:  14 val_f1:  0.8101799492243995 val_auroc:  0.8292151162790697 val_auprc:  0.9194884680310748
EarlyStopping counter: 10 out of 50
epoch:  14
epoch:  15 val_f1:  0.8035187234827523 val_auroc:  0.8323643410852714 val_auprc:  0.9236253631641357
EarlyStopping counter: 11 out of 50
epoch:  15
epoch:  16 val_f1:  0.776244301724119 val_auroc:  0.8398740310077519 val_auprc:  0.9258389724941127
EarlyStopping counter: 12 out of 50
epoch:  16
epoch:  17 val_f1:  0.7877294237541244 val_auroc:  0.8415697674418605 val_auprc:  0.9288028718854454
EarlyStopping counter: 13 out of 50
epoch:  17
epoch:  18 val_f1:  0.757449328289459 val_auroc:  0.8449612403100775 val_auprc:  0.9332720422010821
EarlyStopping counter: 14 out of 50
epoch:  18
epoch:  19 val_f1:  0.8035187234827523 val_auroc:  0.8459302325581396 val_auprc:  0.9336277272607416
EarlyStopping counter: 15 out of 50
epoch:  19
epoch:  20 val_f1:  0.7776763243674784 val_auroc:  0.8527131782945735 val_auprc:  0.9331202478396348
EarlyStopping counter: 16 out of 50
epoch:  20
epoch:  21 val_f1:  0.7776763243674784 val_auroc:  0.8558624031007751 val_auprc:  0.9352036990941397
EarlyStopping counter: 17 out of 50
epoch:  21
epoch:  22 val_f1:  0.7776763243674784 val_auroc:  0.8570736434108528 val_auprc:  0.9366109194781567
EarlyStopping counter: 18 out of 50
epoch:  22
epoch:  23 val_f1:  0.7886649052635782 val_auroc:  0.8568313953488372 val_auprc:  0.9395142550812032
EarlyStopping counter: 19 out of 50
epoch:  23
epoch:  24 val_f1:  0.7789671954250403 val_auroc:  0.857800387596899 val_auprc:  0.9389520091063529
EarlyStopping counter: 20 out of 50
epoch:  24
epoch:  25 val_f1:  0.7801238118631262 val_auroc:  0.8570736434108527 val_auprc:  0.9389901070373832
EarlyStopping counter: 21 out of 50
epoch:  25
epoch:  26 val_f1:  0.7854893118997625 val_auroc:  0.8580426356589147 val_auprc:  0.9387234631787615
EarlyStopping counter: 22 out of 50
epoch:  26
epoch:  27 val_f1:  0.7811523753969797 val_auroc:  0.8607073643410853 val_auprc:  0.9417218647352862
EarlyStopping counter: 23 out of 50
epoch:  27
epoch:  28 val_f1:  0.792019787311512 val_auroc:  0.8592538759689922 val_auprc:  0.9397739750280274
EarlyStopping counter: 24 out of 50
epoch:  28
epoch:  29 val_f1:  0.7665182935781787 val_auroc:  0.8631298449612402 val_auprc:  0.9396040711823621
EarlyStopping counter: 25 out of 50
epoch:  29
epoch:  30 val_f1:  0.792019787311512 val_auroc:  0.8640988372093023 val_auprc:  0.9417739055017745
EarlyStopping counter: 26 out of 50
epoch:  30
epoch:  31 val_f1:  0.7894843465886632 val_auroc:  0.8626453488372092 val_auprc:  0.9438038702018079
EarlyStopping counter: 27 out of 50
epoch:  31
epoch:  32 val_f1:  0.7768458491633659 val_auroc:  0.8660368217054264 val_auprc:  0.945885524475784
EarlyStopping counter: 28 out of 50
epoch:  32
epoch:  33 val_f1:  0.7877294237541244 val_auroc:  0.8662790697674417 val_auprc:  0.9460415301845639
EarlyStopping counter: 29 out of 50
epoch:  33
epoch:  34 val_f1:  0.794309372388086 val_auroc:  0.8670058139534884 val_auprc:  0.9464208560889865
EarlyStopping counter: 30 out of 50
epoch:  34
epoch:  35 val_f1:  0.7841726618705036 val_auroc:  0.872577519379845 val_auprc:  0.9447608955735138
EarlyStopping counter: 31 out of 50
epoch:  35
epoch:  36 val_f1:  0.8027539115793398 val_auroc:  0.8682170542635659 val_auprc:  0.9460340299424468
EarlyStopping counter: 32 out of 50
epoch:  36
epoch:  37 val_f1:  0.7906801532257888 val_auroc:  0.8708817829457364 val_auprc:  0.9468669851567223
EarlyStopping counter: 33 out of 50
epoch:  37
epoch:  38 val_f1:  0.7952715769842713 val_auroc:  0.8699127906976744 val_auprc:  0.9467523320569615
EarlyStopping counter: 34 out of 50
epoch:  38
epoch:  39 val_f1:  0.792019787311512 val_auroc:  0.872093023255814 val_auprc:  0.9462380078288744
EarlyStopping counter: 35 out of 50
epoch:  39
epoch:  40 val_f1:  0.794309372388086 val_auroc:  0.8703972868217054 val_auprc:  0.9468782929288176
EarlyStopping counter: 36 out of 50
epoch:  40
epoch:  41 val_f1:  0.7827158008497472 val_auroc:  0.8728197674418604 val_auprc:  0.9470386385742525
EarlyStopping counter: 37 out of 50
epoch:  41
epoch:  42 val_f1:  0.7997900244397783 val_auroc:  0.872577519379845 val_auprc:  0.9469573364115003
EarlyStopping counter: 38 out of 50
epoch:  42
epoch:  43 val_f1:  0.7827158008497472 val_auroc:  0.8728197674418605 val_auprc:  0.9456328036845048
EarlyStopping counter: 39 out of 50
epoch:  43
epoch:  44 val_f1:  0.7906801532257888 val_auroc:  0.8708817829457364 val_auprc:  0.9464041040214615
EarlyStopping counter: 40 out of 50
epoch:  44
epoch:  45 val_f1:  0.7827158008497472 val_auroc:  0.8687015503875969 val_auprc:  0.9457114231100596
EarlyStopping counter: 41 out of 50
epoch:  45
epoch:  46 val_f1:  0.7729252582141845 val_auroc:  0.873546511627907 val_auprc:  0.94584374924832
EarlyStopping counter: 42 out of 50
epoch:  46
epoch:  47 val_f1:  0.8018807955038493 val_auroc:  0.872577519379845 val_auprc:  0.9475937358568846
EarlyStopping counter: 43 out of 50
epoch:  47
epoch:  48 val_f1:  0.7952715769842713 val_auroc:  0.8723352713178294 val_auprc:  0.9472250314727271
EarlyStopping counter: 44 out of 50
epoch:  48
epoch:  49 val_f1:  0.8018807955038493 val_auroc:  0.8737887596899224 val_auprc:  0.9475519491527442
EarlyStopping counter: 45 out of 50
epoch:  49
epoch:  50 val_f1:  0.8093907785715628 val_auroc:  0.8716085271317829 val_auprc:  0.9468618355383878
EarlyStopping counter: 46 out of 50
epoch:  50
epoch:  51 val_f1:  0.7729252582141845 val_auroc:  0.872093023255814 val_auprc:  0.9455689515949528
EarlyStopping counter: 47 out of 50
epoch:  51
epoch:  52 val_f1:  0.7666659578740948 val_auroc:  0.872577519379845 val_auprc:  0.9457774373750046
EarlyStopping counter: 48 out of 50
epoch:  52
epoch:  53 val_f1:  0.7827158008497472 val_auroc:  0.8771802325581396 val_auprc:  0.9486866687744904
EarlyStopping counter: 49 out of 50
epoch:  53
epoch:  54 val_f1:  0.7972014141264308 val_auroc:  0.875 val_auprc:  0.948314984630947
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  189.42598032951355
{'time_elapsed': [189.42598032951355], 'epoch': [53], 'fold': [3], 'f1_train': [0.9892417911332385], 'auroc_train': [0.9992155777039498], 'auprc_train': [0.9996712346504409], 'f1_test': [0.7972014141264308], 'auroc_test': [0.875], 'auprc_test': [0.948314984630947]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1276]           1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 1276]           256
│    └─Tanh: 2-3                         [64, 128, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1270]           --
│    └─Dropout: 2-5                      [64, 128, 1270]           --
│    └─Flatten: 2-6                      [64, 162560]              --
│    └─Linear: 2-7                       [64, 1]                   162,561
==========================================================================================
Total params: 163,841
Trainable params: 163,841
Non-trainable params: 0
Total mult-adds (M): 94.04
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.25
Params size (MB): 0.66
Estimated Total Size (MB): 168.23
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6590606416693372 val_auroc:  0.7805059523809524 val_auprc:  0.8797527812946769
epoch:  1
epoch:  2 val_f1:  0.13678553981436248 val_auroc:  0.6564980158730158 val_auprc:  0.7567217656327896
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6033801281177593 val_auroc:  0.5804811507936507 val_auprc:  0.7409188858583987
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.19449098979921806 val_auroc:  0.6971726190476191 val_auprc:  0.7831429276626226
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.700034403921559 val_auroc:  0.7358630952380952 val_auprc:  0.805870397487765
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6905138339920949 val_auroc:  0.7976190476190477 val_auprc:  0.8596276951421167
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.7995542847531747 val_auroc:  0.8509424603174603 val_auprc:  0.9303085850000964
Validation loss improved to 0.268999
epoch:  7
epoch:  8 val_f1:  0.7697938448700337 val_auroc:  0.8764880952380952 val_auprc:  0.9416232483144873
Validation loss improved to 0.244067
epoch:  8
epoch:  9 val_f1:  0.8231516182680737 val_auroc:  0.8812003968253969 val_auprc:  0.9385790339312119
Validation loss improved to 0.225322
epoch:  9
epoch:  10 val_f1:  0.8635999460587166 val_auroc:  0.8819444444444444 val_auprc:  0.9371597976119096
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.8108796141220607 val_auroc:  0.8856646825396826 val_auprc:  0.9423646334930542
Validation loss improved to 0.217791
epoch:  11
epoch:  12 val_f1:  0.8238239124113431 val_auroc:  0.8824404761904762 val_auprc:  0.9403821786842366
Validation loss improved to 0.206741
epoch:  12
epoch:  13 val_f1:  0.8108796141220607 val_auroc:  0.8784722222222222 val_auprc:  0.9376629779290386
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7634000460087416 val_auroc:  0.8829365079365079 val_auprc:  0.9429488802814274
EarlyStopping counter: 2 out of 50
epoch:  14
epoch:  15 val_f1:  0.7840325451309432 val_auroc:  0.8807043650793651 val_auprc:  0.9414995063473319
EarlyStopping counter: 3 out of 50
epoch:  15
epoch:  16 val_f1:  0.8108796141220607 val_auroc:  0.8725198412698413 val_auprc:  0.9353056529521064
Validation loss improved to 0.203548
epoch:  16
epoch:  17 val_f1:  0.7793921916592724 val_auroc:  0.8623511904761905 val_auprc:  0.9281356123562721
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.8030193236714975 val_auroc:  0.8670634920634921 val_auprc:  0.9303633856250518
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7904805491990847 val_auroc:  0.8603670634920635 val_auprc:  0.9229242945389853
EarlyStopping counter: 3 out of 50
epoch:  19
epoch:  20 val_f1:  0.8103538508923273 val_auroc:  0.8712797619047619 val_auprc:  0.9344246194383323
EarlyStopping counter: 4 out of 50
epoch:  20
epoch:  21 val_f1:  0.782608695652174 val_auroc:  0.8635912698412699 val_auprc:  0.9268539014292785
EarlyStopping counter: 5 out of 50
epoch:  21
epoch:  22 val_f1:  0.7711042634565258 val_auroc:  0.8618551587301587 val_auprc:  0.9273691232133361
EarlyStopping counter: 6 out of 50
epoch:  22
epoch:  23 val_f1:  0.7819511139952413 val_auroc:  0.8586309523809524 val_auprc:  0.9181984894997401
EarlyStopping counter: 7 out of 50
epoch:  23
epoch:  24 val_f1:  0.7971014492753623 val_auroc:  0.8618551587301586 val_auprc:  0.9237727040574513
EarlyStopping counter: 8 out of 50
epoch:  24
epoch:  25 val_f1:  0.8238239124113431 val_auroc:  0.8745039682539683 val_auprc:  0.9353871116925969
EarlyStopping counter: 9 out of 50
epoch:  25
epoch:  26 val_f1:  0.8023197893688181 val_auroc:  0.8735119047619048 val_auprc:  0.9339942658504872
EarlyStopping counter: 10 out of 50
epoch:  26
epoch:  27 val_f1:  0.8298676748582231 val_auroc:  0.8757440476190476 val_auprc:  0.937721618048486
EarlyStopping counter: 11 out of 50
epoch:  27
epoch:  28 val_f1:  0.822380909337431 val_auroc:  0.8687996031746031 val_auprc:  0.9312202482763551
EarlyStopping counter: 12 out of 50
epoch:  28
epoch:  29 val_f1:  0.8081713820844254 val_auroc:  0.8663194444444444 val_auprc:  0.925563459325857
EarlyStopping counter: 13 out of 50
epoch:  29
epoch:  30 val_f1:  0.8215074100875418 val_auroc:  0.8687996031746031 val_auprc:  0.9288068304834378
EarlyStopping counter: 14 out of 50
epoch:  30
epoch:  31 val_f1:  0.7793921916592724 val_auroc:  0.8670634920634921 val_auprc:  0.9265091126153628
EarlyStopping counter: 15 out of 50
epoch:  31
epoch:  32 val_f1:  0.81483559295621 val_auroc:  0.8695436507936508 val_auprc:  0.9297030128190326
EarlyStopping counter: 16 out of 50
epoch:  32
epoch:  33 val_f1:  0.7711042634565258 val_auroc:  0.8653273809523809 val_auprc:  0.9226440735737871
EarlyStopping counter: 17 out of 50
epoch:  33
epoch:  34 val_f1:  0.8290790088826556 val_auroc:  0.869295634920635 val_auprc:  0.9297813808055798
EarlyStopping counter: 18 out of 50
epoch:  34
epoch:  35 val_f1:  0.8281893869312926 val_auroc:  0.8687996031746031 val_auprc:  0.9279841234643408
EarlyStopping counter: 19 out of 50
epoch:  35
epoch:  36 val_f1:  0.8231516182680737 val_auroc:  0.8707837301587302 val_auprc:  0.930656031902143
EarlyStopping counter: 20 out of 50
epoch:  36
epoch:  37 val_f1:  0.8103538508923273 val_auroc:  0.8722718253968254 val_auprc:  0.9316564594725231
EarlyStopping counter: 21 out of 50
epoch:  37
epoch:  38 val_f1:  0.8194319840387783 val_auroc:  0.8660714285714285 val_auprc:  0.9241743502411509
EarlyStopping counter: 22 out of 50
epoch:  38
epoch:  39 val_f1:  0.81483559295621 val_auroc:  0.8700396825396826 val_auprc:  0.9285098393932465
EarlyStopping counter: 23 out of 50
epoch:  39
epoch:  40 val_f1:  0.7793921916592724 val_auroc:  0.8680555555555556 val_auprc:  0.9232310481834538
EarlyStopping counter: 24 out of 50
epoch:  40
epoch:  41 val_f1:  0.8057130854862423 val_auroc:  0.859375 val_auprc:  0.9144143247197731
EarlyStopping counter: 25 out of 50
epoch:  41
epoch:  42 val_f1:  0.7845614924947297 val_auroc:  0.8501984126984127 val_auprc:  0.8935549687466839
EarlyStopping counter: 26 out of 50
epoch:  42
epoch:  43 val_f1:  0.7991557619248628 val_auroc:  0.8576388888888888 val_auprc:  0.8983408205543073
EarlyStopping counter: 27 out of 50
epoch:  43
epoch:  44 val_f1:  0.7793921916592724 val_auroc:  0.8683035714285715 val_auprc:  0.9226233827554372
EarlyStopping counter: 28 out of 50
epoch:  44
epoch:  45 val_f1:  0.7884143290944841 val_auroc:  0.8628472222222223 val_auprc:  0.9105382662174937
EarlyStopping counter: 29 out of 50
epoch:  45
epoch:  46 val_f1:  0.7755148741418765 val_auroc:  0.8621031746031745 val_auprc:  0.9117766447607253
EarlyStopping counter: 30 out of 50
epoch:  46
epoch:  47 val_f1:  0.7797158172381521 val_auroc:  0.8578869047619048 val_auprc:  0.9053824690653315
EarlyStopping counter: 31 out of 50
epoch:  47
epoch:  48 val_f1:  0.7819511139952413 val_auroc:  0.8568948412698413 val_auprc:  0.8967154488287498
EarlyStopping counter: 32 out of 50
epoch:  48
epoch:  49 val_f1:  0.7733010668869473 val_auroc:  0.8568948412698413 val_auprc:  0.8977311669243724
EarlyStopping counter: 33 out of 50
epoch:  49
epoch:  50 val_f1:  0.7755148741418765 val_auroc:  0.859871031746032 val_auprc:  0.9109043928931575
EarlyStopping counter: 34 out of 50
epoch:  50
epoch:  51 val_f1:  0.7839990466164816 val_auroc:  0.8616071428571429 val_auprc:  0.9182765065809558
EarlyStopping counter: 35 out of 50
epoch:  51
epoch:  52 val_f1:  0.7711042634565258 val_auroc:  0.8653273809523809 val_auprc:  0.9197034514037361
EarlyStopping counter: 36 out of 50
epoch:  52
epoch:  53 val_f1:  0.7669132597880164 val_auroc:  0.8611111111111112 val_auprc:  0.9112108484938459
EarlyStopping counter: 37 out of 50
epoch:  53
epoch:  54 val_f1:  0.7810781559182691 val_auroc:  0.8670634920634921 val_auprc:  0.9222414594018445
EarlyStopping counter: 38 out of 50
epoch:  54
epoch:  55 val_f1:  0.7669132597880164 val_auroc:  0.8601190476190477 val_auprc:  0.9105584813253653
EarlyStopping counter: 39 out of 50
epoch:  55
epoch:  56 val_f1:  0.7991557619248628 val_auroc:  0.8563988095238094 val_auprc:  0.8971583727228847
EarlyStopping counter: 40 out of 50
epoch:  56
epoch:  57 val_f1:  0.7797158172381521 val_auroc:  0.8591269841269841 val_auprc:  0.9059592657043699
EarlyStopping counter: 41 out of 50
epoch:  57
epoch:  58 val_f1:  0.7605491990846683 val_auroc:  0.8638392857142857 val_auprc:  0.9157791376350455
EarlyStopping counter: 42 out of 50
epoch:  58
epoch:  59 val_f1:  0.7755148741418765 val_auroc:  0.8603670634920634 val_auprc:  0.9121059350789049
EarlyStopping counter: 43 out of 50
epoch:  59
epoch:  60 val_f1:  0.7711042634565258 val_auroc:  0.8640873015873016 val_auprc:  0.9152827746351486
EarlyStopping counter: 44 out of 50
epoch:  60
epoch:  61 val_f1:  0.7810781559182691 val_auroc:  0.8638392857142857 val_auprc:  0.9191066397064823
EarlyStopping counter: 45 out of 50
epoch:  61
epoch:  62 val_f1:  0.7810781559182691 val_auroc:  0.865079365079365 val_auprc:  0.9199124048269048
EarlyStopping counter: 46 out of 50
epoch:  62
epoch:  63 val_f1:  0.7691024291417562 val_auroc:  0.8645833333333331 val_auprc:  0.9184340785892435
EarlyStopping counter: 47 out of 50
epoch:  63
epoch:  64 val_f1:  0.7627107192324585 val_auroc:  0.8640873015873015 val_auprc:  0.9141318629148596
EarlyStopping counter: 48 out of 50
epoch:  64
epoch:  65 val_f1:  0.7669132597880164 val_auroc:  0.8606150793650793 val_auprc:  0.911250895760835
EarlyStopping counter: 49 out of 50
epoch:  65
epoch:  66 val_f1:  0.7627107192324585 val_auroc:  0.8635912698412699 val_auprc:  0.913339759104503
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  232.83412313461304
{'time_elapsed': [232.83412313461304], 'epoch': [65], 'fold': [4], 'f1_train': [0.9964087979844714], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7627107192324585], 'auroc_test': [0.8635912698412699], 'auprc_test': [0.913339759104503]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1276]           1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 1276]           256
│    └─Tanh: 2-3                         [64, 128, 1276]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1270]           --
│    └─Dropout: 2-5                      [64, 128, 1270]           --
│    └─Flatten: 2-6                      [64, 162560]              --
│    └─Linear: 2-7                       [64, 1]                   162,561
==========================================================================================
Total params: 163,841
Trainable params: 163,841
Non-trainable params: 0
Total mult-adds (M): 94.04
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.25
Params size (MB): 0.66
Estimated Total Size (MB): 168.23
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_93', 'config': {'hidden_channels': [128], 'epochs': 500, 'kernel_size': 7, 'pool_kernel_size': 7, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.6534118802160038 val_auprc:  0.8364802189200506
epoch:  1
epoch:  2 val_f1:  0.648642390567887 val_auroc:  0.637211585665194 val_auprc:  0.8260354012016509
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6134480650773498 val_auroc:  0.6654393716249386 val_auprc:  0.8393283706675012
Validation loss improved to 1.270286
epoch:  3
epoch:  4 val_f1:  0.5829969063840983 val_auroc:  0.6772214040255278 val_auprc:  0.8434634461099718
Validation loss improved to 1.233005
epoch:  4
epoch:  5 val_f1:  0.6272534913245873 val_auroc:  0.6867943053510065 val_auprc:  0.8445020223908626
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.612901249881321 val_auroc:  0.7052037309769268 val_auprc:  0.856412066404519
Validation loss improved to 1.211224
epoch:  6
epoch:  7 val_f1:  0.6033497670785479 val_auroc:  0.7179675994108984 val_auprc:  0.863035129857516
Validation loss improved to 1.189855
epoch:  7
epoch:  8 val_f1:  0.6475152825716306 val_auroc:  0.7218949435444281 val_auprc:  0.8634393878664707
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.6405511606040838 val_auroc:  0.7299950908198332 val_auprc:  0.86850811512723
Validation loss improved to 1.178093
epoch:  9
epoch:  10 val_f1:  0.6476562574960038 val_auroc:  0.7368679430535101 val_auprc:  0.8725318698919081
Validation loss improved to 1.170011
epoch:  10
epoch:  11 val_f1:  0.6618588605406337 val_auroc:  0.7459499263622975 val_auprc:  0.8779335582912773
Validation loss improved to 1.166017
epoch:  11
epoch:  12 val_f1:  0.6617377698806362 val_auroc:  0.7491408934707903 val_auprc:  0.879718346922716
Validation loss improved to 1.153123
epoch:  12
epoch:  13 val_f1:  0.6685291048291022 val_auroc:  0.7560137457044673 val_auprc:  0.8839700049439185
Validation loss improved to 1.138651
epoch:  13
epoch:  14 val_f1:  0.6687657666074932 val_auroc:  0.7582228767795779 val_auprc:  0.8853972574977136
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.6756372438556401 val_auroc:  0.7623956799214532 val_auprc:  0.8879289070202363
Validation loss improved to 1.134112
epoch:  15
epoch:  16 val_f1:  0.6685291048291022 val_auroc:  0.770495827196858 val_auprc:  0.8928708668946324
Validation loss improved to 1.109343
epoch:  16
epoch:  17 val_f1:  0.6825214527173443 val_auroc:  0.7702503681885126 val_auprc:  0.8922212966426883
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.713247796930704 val_auroc:  0.7729504172803142 val_auprc:  0.8944483858231005
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.6825214527173443 val_auroc:  0.7825233186057928 val_auprc:  0.8999966602179459
Validation loss improved to 1.089656
epoch:  19
epoch:  20 val_f1:  0.7150229029574715 val_auroc:  0.7812960235640648 val_auprc:  0.9002138526465088
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7018261879839978 val_auroc:  0.7871870397643593 val_auprc:  0.9036634551511341
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.6614736591628271 val_auroc:  0.7960235640648011 val_auprc:  0.9081943544340896
Validation loss improved to 1.058091
epoch:  22
epoch:  23 val_f1:  0.7505653177403916 val_auroc:  0.7849779086892489 val_auprc:  0.9028037811684566
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.6685291048291022 val_auroc:  0.7977417771232204 val_auprc:  0.9087723361469919
Validation loss improved to 1.054240
epoch:  24
epoch:  25 val_f1:  0.7281499969472504 val_auroc:  0.7960235640648011 val_auprc:  0.9081463278078741
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.7477455593342162 val_auroc:  0.7965144820814923 val_auprc:  0.9098227606937659
EarlyStopping counter: 2 out of 50
epoch:  26
epoch:  27 val_f1:  0.7583800901862243 val_auroc:  0.7965144820814923 val_auprc:  0.9099480532478788
EarlyStopping counter: 3 out of 50
epoch:  27
epoch:  28 val_f1:  0.6682010713268466 val_auroc:  0.8046146293568973 val_auprc:  0.9142973203304119
Validation loss improved to 1.033265
epoch:  28
epoch:  29 val_f1:  0.7580594896895918 val_auroc:  0.793078055964654 val_auprc:  0.9095253500154113
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.6685291048291022 val_auroc:  0.8102601865488462 val_auprc:  0.9183412674655467
Validation loss improved to 1.019591
epoch:  30
epoch:  31 val_f1:  0.7412236216203913 val_auroc:  0.8082965144820815 val_auprc:  0.9176702119992057
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.7648187281552264 val_auroc:  0.8033873343151694 val_auprc:  0.9150207213263658
EarlyStopping counter: 2 out of 50
epoch:  32
epoch:  33 val_f1:  0.6756605397022405 val_auroc:  0.814187530682376 val_auprc:  0.9207156834372328
EarlyStopping counter: 3 out of 50
epoch:  33
epoch:  34 val_f1:  0.7531731915989216 val_auroc:  0.8041237113402062 val_auprc:  0.9153037176737326
EarlyStopping counter: 4 out of 50
epoch:  34
epoch:  35 val_f1:  0.6823403921278894 val_auroc:  0.8163966617574865 val_auprc:  0.9223617180745157
EarlyStopping counter: 5 out of 50
epoch:  35
epoch:  36 val_f1:  0.7569659388768054 val_auroc:  0.8068237604320079 val_auprc:  0.9176927322368011
EarlyStopping counter: 6 out of 50
epoch:  36
epoch:  37 val_f1:  0.7490302789770621 val_auroc:  0.8063328424153167 val_auprc:  0.9176582398489168
EarlyStopping counter: 7 out of 50
epoch:  37
epoch:  38 val_f1:  0.6891084624964738 val_auroc:  0.8227785959744722 val_auprc:  0.9251453263474083
EarlyStopping counter: 8 out of 50
epoch:  38
epoch:  39 val_f1:  0.7490302789770621 val_auroc:  0.8085419734904271 val_auprc:  0.9182943267229661
EarlyStopping counter: 9 out of 50
epoch:  39
epoch:  40 val_f1:  0.6962806225607748 val_auroc:  0.8188512518409425 val_auprc:  0.9231859739575903
EarlyStopping counter: 10 out of 50
epoch:  40
epoch:  41 val_f1:  0.7519437633413868 val_auroc:  0.8149239077074129 val_auprc:  0.9211686997731862
EarlyStopping counter: 11 out of 50
epoch:  41
epoch:  42 val_f1:  0.7583800901862243 val_auroc:  0.8122238586156112 val_auprc:  0.9199993530704562
EarlyStopping counter: 12 out of 50
epoch:  42
epoch:  43 val_f1:  0.7648187281552264 val_auroc:  0.8127147766323024 val_auprc:  0.920556688158693
EarlyStopping counter: 13 out of 50
epoch:  43
epoch:  44 val_f1:  0.7455074238481555 val_auroc:  0.8163966617574865 val_auprc:  0.9223093075682163
EarlyStopping counter: 14 out of 50
epoch:  44
epoch:  45 val_f1:  0.7390688025474315 val_auroc:  0.8149239077074129 val_auprc:  0.9216660653755098
EarlyStopping counter: 15 out of 50
epoch:  45
epoch:  46 val_f1:  0.7272357092755477 val_auroc:  0.8188512518409425 val_auprc:  0.9232674899643604
EarlyStopping counter: 16 out of 50
epoch:  46
epoch:  47 val_f1:  0.7473302173830908 val_auroc:  0.8119783996072657 val_auprc:  0.9193839094181655
EarlyStopping counter: 17 out of 50
epoch:  47
epoch:  48 val_f1:  0.7466980132583976 val_auroc:  0.8163966617574866 val_auprc:  0.9219559243532063
EarlyStopping counter: 18 out of 50
epoch:  48
epoch:  49 val_f1:  0.7371937993371881 val_auroc:  0.8264604810996564 val_auprc:  0.9274218718403924
EarlyStopping counter: 19 out of 50
epoch:  49
epoch:  50 val_f1:  0.7466980132583976 val_auroc:  0.8230240549828178 val_auprc:  0.9255645633806265
EarlyStopping counter: 20 out of 50
epoch:  50
epoch:  51 val_f1:  0.7583800901862243 val_auroc:  0.8173784977908689 val_auprc:  0.9223412810247159
EarlyStopping counter: 21 out of 50
epoch:  51
epoch:  52 val_f1:  0.735514445586388 val_auroc:  0.8232695139911635 val_auprc:  0.9254796992612109
EarlyStopping counter: 22 out of 50
epoch:  52
epoch:  53 val_f1:  0.7441671543148256 val_auroc:  0.8163966617574866 val_auprc:  0.9215791229449646
EarlyStopping counter: 23 out of 50
epoch:  53
epoch:  54 val_f1:  0.735514445586388 val_auroc:  0.8249877270495828 val_auprc:  0.9263734007033037
EarlyStopping counter: 24 out of 50
epoch:  54
epoch:  55 val_f1:  0.7390688025474315 val_auroc:  0.8205694648993619 val_auprc:  0.9235099953342261
EarlyStopping counter: 25 out of 50
epoch:  55
epoch:  56 val_f1:  0.7402181480621955 val_auroc:  0.8195876288659794 val_auprc:  0.922795533500238
EarlyStopping counter: 26 out of 50
epoch:  56
epoch:  57 val_f1:  0.7363119073255568 val_auroc:  0.8200785468826707 val_auprc:  0.9235157906624762
EarlyStopping counter: 27 out of 50
epoch:  57
epoch:  58 val_f1:  0.735514445586388 val_auroc:  0.8301423662248404 val_auprc:  0.9292324533842622
EarlyStopping counter: 28 out of 50
epoch:  58
epoch:  59 val_f1:  0.7266187050359713 val_auroc:  0.8195876288659795 val_auprc:  0.9234521348765983
EarlyStopping counter: 29 out of 50
epoch:  59
epoch:  60 val_f1:  0.7402181480621955 val_auroc:  0.8264604810996564 val_auprc:  0.9268897084302816
EarlyStopping counter: 30 out of 50
epoch:  60
epoch:  61 val_f1:  0.7402181480621955 val_auroc:  0.821060382916053 val_auprc:  0.923562101215049
EarlyStopping counter: 31 out of 50
epoch:  61
epoch:  62 val_f1:  0.7328919440906961 val_auroc:  0.8176239567992146 val_auprc:  0.9225456907759668
EarlyStopping counter: 32 out of 50
epoch:  62
epoch:  63 val_f1:  0.7412236216203913 val_auroc:  0.8296514482081493 val_auprc:  0.9281173524173811
EarlyStopping counter: 33 out of 50
epoch:  63
epoch:  64 val_f1:  0.7299542184434271 val_auroc:  0.8237604320078546 val_auprc:  0.9254479819505437
EarlyStopping counter: 34 out of 50
epoch:  64
epoch:  65 val_f1:  0.7477455593342162 val_auroc:  0.8257241040746195 val_auprc:  0.9264327035383975
EarlyStopping counter: 35 out of 50
epoch:  65
epoch:  66 val_f1:  0.7203480251458693 val_auroc:  0.8232695139911635 val_auprc:  0.9253880396228891
EarlyStopping counter: 36 out of 50
epoch:  66
epoch:  67 val_f1:  0.751751326211758 val_auroc:  0.8205694648993618 val_auprc:  0.923784875264947
EarlyStopping counter: 37 out of 50
epoch:  67
epoch:  68 val_f1:  0.7513203127712835 val_auroc:  0.8357879234167894 val_auprc:  0.9317078567030397
EarlyStopping counter: 38 out of 50
epoch:  68
epoch:  69 val_f1:  0.7391701372600277 val_auroc:  0.8203240058910163 val_auprc:  0.9231086210428439
EarlyStopping counter: 39 out of 50
epoch:  69
epoch:  70 val_f1:  0.7542604103291037 val_auroc:  0.8311242022582229 val_auprc:  0.9289021315900272
EarlyStopping counter: 40 out of 50
epoch:  70
epoch:  71 val_f1:  0.7328919440906961 val_auroc:  0.8269513991163475 val_auprc:  0.9267836596304377
EarlyStopping counter: 41 out of 50
epoch:  71
epoch:  72 val_f1:  0.7542604103291037 val_auroc:  0.833578792341679 val_auprc:  0.9302466118908144
EarlyStopping counter: 42 out of 50
epoch:  72
epoch:  73 val_f1:  0.7596459003010357 val_auroc:  0.8311242022582229 val_auprc:  0.9290922825033308
EarlyStopping counter: 43 out of 50
epoch:  73
epoch:  74 val_f1:  0.7490302789770621 val_auroc:  0.8252331860579283 val_auprc:  0.9256125414193604
EarlyStopping counter: 44 out of 50
epoch:  74
epoch:  75 val_f1:  0.7466980132583976 val_auroc:  0.832842415316642 val_auprc:  0.9297575823898343
EarlyStopping counter: 45 out of 50
epoch:  75
epoch:  76 val_f1:  0.7391701372600277 val_auroc:  0.8235149729995092 val_auprc:  0.9245117091204924
EarlyStopping counter: 46 out of 50
epoch:  76
epoch:  77 val_f1:  0.7531731915989216 val_auroc:  0.8291605301914581 val_auprc:  0.9276329105186196
EarlyStopping counter: 47 out of 50
epoch:  77
epoch:  78 val_f1:  0.7569659388768054 val_auroc:  0.8271968581246931 val_auprc:  0.9262271114106084
EarlyStopping counter: 48 out of 50
epoch:  78
epoch:  79 val_f1:  0.7531731915989216 val_auroc:  0.8325969563082966 val_auprc:  0.929162496159573
EarlyStopping counter: 49 out of 50
epoch:  79
epoch:  80 val_f1:  0.7455074238481555 val_auroc:  0.8321060382916053 val_auprc:  0.9290685052239285
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  25.154642581939697
{'time_elapsed': [25.154642581939697], 'epoch': [79], 'fold': [0], 'f1_train': [0.9749716863211297], 'auroc_train': [0.9978538798785909], 'auprc_train': [0.9990351726786515], 'f1_test': [0.7455074238481555], 'auroc_test': [0.8321060382916053], 'auprc_test': [0.9290685052239285]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 183]            1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 183]            256
│    └─Tanh: 2-3                         [64, 128, 183]            --
│    └─MaxPool1d: 2-4                    [64, 128, 26]             --
│    └─Dropout: 2-5                      [64, 128, 26]             --
│    └─Flatten: 2-6                      [64, 3328]                --
│    └─Linear: 2-7                       [64, 1]                   3,329
==========================================================================================
Total params: 4,609
Trainable params: 4,609
Non-trainable params: 0
Total mult-adds (M): 12.22
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 23.99
Params size (MB): 0.02
Estimated Total Size (MB): 24.33
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6546762589928059 val_auroc:  0.67206676485027 val_auprc:  0.8262155225067194
epoch:  1
epoch:  2 val_f1:  0.5635546448496088 val_auroc:  0.6966126656848306 val_auprc:  0.8553922187283063
Validation loss improved to 1.158267
epoch:  2
epoch:  3 val_f1:  0.6003766994689254 val_auroc:  0.7096219931271478 val_auprc:  0.8678893062315665
Validation loss improved to 1.145974
epoch:  3
epoch:  4 val_f1:  0.6043044282266453 val_auroc:  0.7214040255277369 val_auprc:  0.8735136130578154
Validation loss improved to 1.111040
epoch:  4
epoch:  5 val_f1:  0.619566649594801 val_auroc:  0.7353951890034365 val_auprc:  0.8822269309225361
Validation loss improved to 1.095280
epoch:  5
epoch:  6 val_f1:  0.6409065302315272 val_auroc:  0.7390770741286206 val_auprc:  0.884412597939342
Validation loss improved to 1.079796
epoch:  6
epoch:  7 val_f1:  0.6135802455273177 val_auroc:  0.7479135984290624 val_auprc:  0.89202868784513
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.7249644134959412 val_auroc:  0.7653411880216004 val_auprc:  0.8966954046960884
Validation loss improved to 1.042225
epoch:  8
epoch:  9 val_f1:  0.6515899973778831 val_auroc:  0.7673048600883653 val_auprc:  0.9013271697357685
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7170452552783244 val_auroc:  0.7746686303387335 val_auprc:  0.9029353151152995
Validation loss improved to 1.026096
epoch:  10
epoch:  11 val_f1:  0.7281499969472504 val_auroc:  0.7815414825724104 val_auprc:  0.9048675311873489
Validation loss improved to 1.010565
epoch:  11
epoch:  12 val_f1:  0.6958509820496094 val_auroc:  0.780559646539028 val_auprc:  0.9071901392502238
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7412236216203913 val_auroc:  0.7884143348060874 val_auprc:  0.9077949959273992
Validation loss improved to 0.989745
epoch:  13
epoch:  14 val_f1:  0.7362024088594293 val_auroc:  0.793078055964654 val_auprc:  0.9097700005598729
Validation loss improved to 0.981238
epoch:  14
epoch:  15 val_f1:  0.6802976282278086 val_auroc:  0.792341678939617 val_auprc:  0.9121678210717823
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7140703059967902 val_auroc:  0.7945508100147276 val_auprc:  0.9075731645377606
Validation loss improved to 0.975871
epoch:  16
epoch:  17 val_f1:  0.7377728985642654 val_auroc:  0.7982326951399116 val_auprc:  0.9141480834008848
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.7225455998837295 val_auroc:  0.8004418262150221 val_auprc:  0.9106761009348343
Validation loss improved to 0.961526
epoch:  18
epoch:  19 val_f1:  0.7446505962267806 val_auroc:  0.8028964162984781 val_auprc:  0.9155864088629013
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7402181480621955 val_auroc:  0.8006872852233677 val_auprc:  0.910816562514513
Validation loss improved to 0.942119
epoch:  20
epoch:  21 val_f1:  0.7639705763479104 val_auroc:  0.8006872852233676 val_auprc:  0.9117857241156455
Validation loss improved to 0.941596
epoch:  21
epoch:  22 val_f1:  0.758098723333472 val_auroc:  0.8041237113402062 val_auprc:  0.914639611016496
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7633550302615051 val_auroc:  0.8063328424153167 val_auprc:  0.9136270849346563
Validation loss improved to 0.929554
epoch:  23
epoch:  24 val_f1:  0.777854660092151 val_auroc:  0.8068237604320079 val_auprc:  0.914437903067991
Validation loss improved to 0.929137
epoch:  24
epoch:  25 val_f1:  0.7560320485424044 val_auroc:  0.8095238095238095 val_auprc:  0.9146295446227625
Validation loss improved to 0.923692
epoch:  25
epoch:  26 val_f1:  0.7560320485424044 val_auroc:  0.8102601865488464 val_auprc:  0.914741638162085
Validation loss improved to 0.921010
epoch:  26
epoch:  27 val_f1:  0.723931698015082 val_auroc:  0.8085419734904271 val_auprc:  0.9156919995636753
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7455074238481555 val_auroc:  0.8075601374570447 val_auprc:  0.9121254031261646
EarlyStopping counter: 2 out of 50
epoch:  28
epoch:  29 val_f1:  0.7455074238481555 val_auroc:  0.8080510554737359 val_auprc:  0.9122825056087303
Validation loss improved to 0.920654
epoch:  29
epoch:  30 val_f1:  0.7513203127712835 val_auroc:  0.8119783996072656 val_auprc:  0.9164412528132052
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7454557504588546 val_auroc:  0.8112420225822288 val_auprc:  0.913199384123113
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.7412236216203913 val_auroc:  0.8114874815905744 val_auprc:  0.9145153061021367
Validation loss improved to 0.919085
epoch:  32
epoch:  33 val_f1:  0.7411406017655346 val_auroc:  0.8041237113402061 val_auprc:  0.9077779317631529
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.7412236216203913 val_auroc:  0.8107511045655375 val_auprc:  0.9135373412420759
EarlyStopping counter: 2 out of 50
epoch:  34
epoch:  35 val_f1:  0.7573003855683703 val_auroc:  0.8132056946489936 val_auprc:  0.916149612042426
EarlyStopping counter: 3 out of 50
epoch:  35
epoch:  36 val_f1:  0.7386752666832053 val_auroc:  0.8092783505154639 val_auprc:  0.9113009145301043
EarlyStopping counter: 4 out of 50
epoch:  36
epoch:  37 val_f1:  0.7633550302615051 val_auroc:  0.810505645557192 val_auprc:  0.913269962176973
EarlyStopping counter: 5 out of 50
epoch:  37
epoch:  38 val_f1:  0.7441671543148256 val_auroc:  0.8122238586156114 val_auprc:  0.912748569875806
EarlyStopping counter: 6 out of 50
epoch:  38
epoch:  39 val_f1:  0.7633714058926586 val_auroc:  0.810505645557192 val_auprc:  0.9119729657148713
EarlyStopping counter: 7 out of 50
epoch:  39
epoch:  40 val_f1:  0.7494347379239465 val_auroc:  0.81173294059892 val_auprc:  0.912766958187203
EarlyStopping counter: 8 out of 50
epoch:  40
epoch:  41 val_f1:  0.7505653177403916 val_auroc:  0.8114874815905743 val_auprc:  0.9118416001516308
EarlyStopping counter: 9 out of 50
epoch:  41
epoch:  42 val_f1:  0.7441671543148256 val_auroc:  0.810505645557192 val_auprc:  0.9113414332685459
EarlyStopping counter: 10 out of 50
epoch:  42
epoch:  43 val_f1:  0.7455074238481555 val_auroc:  0.8114874815905744 val_auprc:  0.9117703009825007
EarlyStopping counter: 11 out of 50
epoch:  43
epoch:  44 val_f1:  0.7402181480621955 val_auroc:  0.8112420225822289 val_auprc:  0.9116077761198306
EarlyStopping counter: 12 out of 50
epoch:  44
epoch:  45 val_f1:  0.7681512331200245 val_auroc:  0.8102601865488464 val_auprc:  0.9101830529123738
EarlyStopping counter: 13 out of 50
epoch:  45
epoch:  46 val_f1:  0.7569659388768054 val_auroc:  0.8095238095238095 val_auprc:  0.9098806410201733
EarlyStopping counter: 14 out of 50
epoch:  46
epoch:  47 val_f1:  0.7569659388768054 val_auroc:  0.8087874324987726 val_auprc:  0.9093572840985571
EarlyStopping counter: 15 out of 50
epoch:  47
epoch:  48 val_f1:  0.7519437633413868 val_auroc:  0.8085419734904271 val_auprc:  0.9093471005754585
EarlyStopping counter: 16 out of 50
epoch:  48
epoch:  49 val_f1:  0.7855164986057286 val_auroc:  0.8075601374570447 val_auprc:  0.9080730431213394
EarlyStopping counter: 17 out of 50
epoch:  49
epoch:  50 val_f1:  0.7583800901862243 val_auroc:  0.8065783014236623 val_auprc:  0.9080077844914807
EarlyStopping counter: 18 out of 50
epoch:  50
epoch:  51 val_f1:  0.76000113614692 val_auroc:  0.806087383406971 val_auprc:  0.9071091152603921
EarlyStopping counter: 19 out of 50
epoch:  51
epoch:  52 val_f1:  0.7633714058926586 val_auroc:  0.8073146784486991 val_auprc:  0.9082996128967503
EarlyStopping counter: 20 out of 50
epoch:  52
epoch:  53 val_f1:  0.7791090204759269 val_auroc:  0.8068237604320078 val_auprc:  0.9075824406858888
EarlyStopping counter: 21 out of 50
epoch:  53
epoch:  54 val_f1:  0.7727225509205256 val_auroc:  0.8082965144820814 val_auprc:  0.9080522846528014
EarlyStopping counter: 22 out of 50
epoch:  54
epoch:  55 val_f1:  0.7346924658075737 val_auroc:  0.803632793323515 val_auprc:  0.9072289071105397
EarlyStopping counter: 23 out of 50
epoch:  55
epoch:  56 val_f1:  0.7855164986057286 val_auroc:  0.8065783014236622 val_auprc:  0.9068752610501457
EarlyStopping counter: 24 out of 50
epoch:  56
epoch:  57 val_f1:  0.7727225509205256 val_auroc:  0.8024054982817869 val_auprc:  0.9046120733882099
EarlyStopping counter: 25 out of 50
epoch:  57
epoch:  58 val_f1:  0.7777125328082551 val_auroc:  0.8055964653902798 val_auprc:  0.9071010776344698
EarlyStopping counter: 26 out of 50
epoch:  58
epoch:  59 val_f1:  0.7712620601193464 val_auroc:  0.8021600392734413 val_auprc:  0.9056867431758095
EarlyStopping counter: 27 out of 50
epoch:  59
epoch:  60 val_f1:  0.7791090204759269 val_auroc:  0.8033873343151694 val_auprc:  0.9049426681207391
EarlyStopping counter: 28 out of 50
epoch:  60
epoch:  61 val_f1:  0.7777125328082551 val_auroc:  0.8031418753068237 val_auprc:  0.9054474206015333
EarlyStopping counter: 29 out of 50
epoch:  61
epoch:  62 val_f1:  0.7748796193569787 val_auroc:  0.8006872852233677 val_auprc:  0.9028917277429486
EarlyStopping counter: 30 out of 50
epoch:  62
epoch:  63 val_f1:  0.7712620601193464 val_auroc:  0.7989690721649484 val_auprc:  0.9032942120386286
EarlyStopping counter: 31 out of 50
epoch:  63
epoch:  64 val_f1:  0.7791090204759269 val_auroc:  0.8006872852233677 val_auprc:  0.9027920852742565
EarlyStopping counter: 32 out of 50
epoch:  64
epoch:  65 val_f1:  0.7727225509205256 val_auroc:  0.8009327442317132 val_auprc:  0.9033632318360858
EarlyStopping counter: 33 out of 50
epoch:  65
epoch:  66 val_f1:  0.7826417810500232 val_auroc:  0.8016691212567502 val_auprc:  0.9042060746883753
EarlyStopping counter: 34 out of 50
epoch:  66
epoch:  67 val_f1:  0.7727225509205256 val_auroc:  0.7997054491899853 val_auprc:  0.9013215618757988
EarlyStopping counter: 35 out of 50
epoch:  67
epoch:  68 val_f1:  0.766354189375772 val_auroc:  0.7982326951399116 val_auprc:  0.9009164794119209
EarlyStopping counter: 36 out of 50
epoch:  68
epoch:  69 val_f1:  0.7770871369605723 val_auroc:  0.7974963181148748 val_auprc:  0.8999129911747591
EarlyStopping counter: 37 out of 50
epoch:  69
epoch:  70 val_f1:  0.7681512331200245 val_auroc:  0.7977417771232204 val_auprc:  0.9015745379905692
EarlyStopping counter: 38 out of 50
epoch:  70
epoch:  71 val_f1:  0.7770871369605723 val_auroc:  0.7982326951399116 val_auprc:  0.9002540347519257
EarlyStopping counter: 39 out of 50
epoch:  71
epoch:  72 val_f1:  0.7622262794246104 val_auroc:  0.7987236131566029 val_auprc:  0.9006012611590842
EarlyStopping counter: 40 out of 50
epoch:  72
epoch:  73 val_f1:  0.7697841726618705 val_auroc:  0.7945508100147275 val_auprc:  0.8998328414721977
EarlyStopping counter: 41 out of 50
epoch:  73
epoch:  74 val_f1:  0.7748796193569787 val_auroc:  0.7918507609229258 val_auprc:  0.8964877781662088
EarlyStopping counter: 42 out of 50
epoch:  74
epoch:  75 val_f1:  0.766354189375772 val_auroc:  0.7994599901816396 val_auprc:  0.9022410404113022
EarlyStopping counter: 43 out of 50
epoch:  75
epoch:  76 val_f1:  0.7748796193569787 val_auroc:  0.7938144329896907 val_auprc:  0.8966715460608884
EarlyStopping counter: 44 out of 50
epoch:  76
epoch:  77 val_f1:  0.7685409504908388 val_auroc:  0.7965144820814923 val_auprc:  0.8983186015098463
EarlyStopping counter: 45 out of 50
epoch:  77
epoch:  78 val_f1:  0.766354189375772 val_auroc:  0.7947962690230732 val_auprc:  0.8980930509820316
EarlyStopping counter: 46 out of 50
epoch:  78
epoch:  79 val_f1:  0.7685409504908388 val_auroc:  0.7957781050564555 val_auprc:  0.8971400782857843
EarlyStopping counter: 47 out of 50
epoch:  79
epoch:  80 val_f1:  0.7617684906754855 val_auroc:  0.7957781050564555 val_auprc:  0.8994421071856145
EarlyStopping counter: 48 out of 50
epoch:  80
epoch:  81 val_f1:  0.7748796193569787 val_auroc:  0.7965144820814923 val_auprc:  0.8981617540351075
EarlyStopping counter: 49 out of 50
epoch:  81
epoch:  82 val_f1:  0.7622262794246104 val_auroc:  0.7925871379479626 val_auprc:  0.8968838978293368
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  20.972609758377075
{'time_elapsed': [20.972609758377075], 'epoch': [81], 'fold': [1], 'f1_train': [0.9820404285864812], 'auroc_train': [0.9995707759757182], 'auprc_train': [0.9998111551760841], 'f1_test': [0.7622262794246104], 'auroc_test': [0.7925871379479626], 'auprc_test': [0.8968838978293368]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 183]            1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 183]            256
│    └─Tanh: 2-3                         [64, 128, 183]            --
│    └─MaxPool1d: 2-4                    [64, 128, 26]             --
│    └─Dropout: 2-5                      [64, 128, 26]             --
│    └─Flatten: 2-6                      [64, 3328]                --
│    └─Linear: 2-7                       [64, 1]                   3,329
==========================================================================================
Total params: 4,609
Trainable params: 4,609
Non-trainable params: 0
Total mult-adds (M): 12.22
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 23.99
Params size (MB): 0.02
Estimated Total Size (MB): 24.33
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.6045655375552282 val_auprc:  0.7636024506733554
epoch:  1
epoch:  2 val_f1:  0.4885733204481192 val_auroc:  0.6470299459990182 val_auprc:  0.8238533934838056
Validation loss improved to 1.193612
epoch:  2
epoch:  3 val_f1:  0.38527798450894457 val_auroc:  0.6654393716249386 val_auprc:  0.8330839119511245
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6523888080851465 val_auroc:  0.678939617083947 val_auprc:  0.8412253710209368
Validation loss improved to 1.139880
epoch:  4
epoch:  5 val_f1:  0.4719351099423255 val_auroc:  0.7047128129602357 val_auprc:  0.851886000257044
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.6405511606040838 val_auroc:  0.7216494845360825 val_auprc:  0.8612089450296857
Validation loss improved to 1.118829
epoch:  6
epoch:  7 val_f1:  0.6022355762448864 val_auroc:  0.7304860088365244 val_auprc:  0.8641219738764617
Validation loss improved to 1.116951
epoch:  7
epoch:  8 val_f1:  0.6614736591628271 val_auroc:  0.7420225822287678 val_auprc:  0.8707945597013413
Validation loss improved to 1.102161
epoch:  8
epoch:  9 val_f1:  0.5917124096980212 val_auroc:  0.7449680903289151 val_auprc:  0.8720171410875923
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.6889840728573212 val_auroc:  0.749386352479136 val_auprc:  0.8747660794030006
Validation loss improved to 1.081523
epoch:  10
epoch:  11 val_f1:  0.6451024231755431 val_auroc:  0.750613647520864 val_auprc:  0.8748024180516192
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.713247796930704 val_auroc:  0.7562592047128129 val_auprc:  0.8784927221916714
Validation loss improved to 1.063533
epoch:  12
epoch:  13 val_f1:  0.6743799189283424 val_auroc:  0.7535591556210114 val_auprc:  0.8756641446859856
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.726175885795287 val_auroc:  0.7611683848797252 val_auprc:  0.8796387237085119
Validation loss improved to 1.054643
epoch:  14
epoch:  15 val_f1:  0.682026026688228 val_auroc:  0.7555228276877761 val_auprc:  0.8769361283250925
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7031576347932113 val_auroc:  0.7592047128129602 val_auprc:  0.8789248401500502
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.7308479257525525 val_auroc:  0.7638684339715268 val_auprc:  0.8815407029326133
Validation loss improved to 1.045540
epoch:  17
epoch:  18 val_f1:  0.7367608586927249 val_auroc:  0.7658321060382917 val_auprc:  0.8826584659883381
Validation loss improved to 1.039506
epoch:  18
epoch:  19 val_f1:  0.72389147505525 val_auroc:  0.7665684830633284 val_auprc:  0.8830668876660407
Validation loss improved to 1.038028
epoch:  19
epoch:  20 val_f1:  0.6524974219867484 val_auroc:  0.7596956308296514 val_auprc:  0.8784338131796806
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7018195933946583 val_auroc:  0.76926853215513 val_auprc:  0.884594607281506
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.6598406488264144 val_auroc:  0.7601865488463427 val_auprc:  0.8794520976574386
EarlyStopping counter: 3 out of 50
epoch:  22
epoch:  23 val_f1:  0.7299542184434271 val_auroc:  0.7663230240549828 val_auprc:  0.8815197570187967
Validation loss improved to 1.030386
epoch:  23
epoch:  24 val_f1:  0.6891084624964738 val_auroc:  0.7614138438880708 val_auprc:  0.8789262291711573
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7500864926036699 val_auroc:  0.765586647029946 val_auprc:  0.8803408999108695
Validation loss improved to 1.027336
epoch:  25
epoch:  26 val_f1:  0.7098736982331642 val_auroc:  0.7609229258713796 val_auprc:  0.8777660014425811
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.6677356419948787 val_auroc:  0.7609229258713796 val_auprc:  0.8773714309552376
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.722058496910722 val_auroc:  0.7663230240549829 val_auprc:  0.8797900495992461
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.7032425848040964 val_auroc:  0.760677466863034 val_auprc:  0.8769830550069365
EarlyStopping counter: 4 out of 50
epoch:  29
epoch:  30 val_f1:  0.722058496910722 val_auroc:  0.7636229749631811 val_auprc:  0.8773775468888672
EarlyStopping counter: 5 out of 50
epoch:  30
epoch:  31 val_f1:  0.682026026688228 val_auroc:  0.7567501227295041 val_auprc:  0.8731332402442368
EarlyStopping counter: 6 out of 50
epoch:  31
epoch:  32 val_f1:  0.7542604103291037 val_auroc:  0.7626411389297988 val_auprc:  0.8761713657379203
EarlyStopping counter: 7 out of 50
epoch:  32
epoch:  33 val_f1:  0.7229061670449737 val_auroc:  0.7621502209131075 val_auprc:  0.8762957383236545
EarlyStopping counter: 8 out of 50
epoch:  33
epoch:  34 val_f1:  0.7477455593342162 val_auroc:  0.7626411389297987 val_auprc:  0.8759714220159612
EarlyStopping counter: 9 out of 50
epoch:  34
epoch:  35 val_f1:  0.7494347379239465 val_auroc:  0.7616593028964163 val_auprc:  0.8755495223145506
EarlyStopping counter: 10 out of 50
epoch:  35
epoch:  36 val_f1:  0.748656020238754 val_auroc:  0.7606774668630338 val_auprc:  0.8741741327969981
EarlyStopping counter: 11 out of 50
epoch:  36
epoch:  37 val_f1:  0.7095299887411026 val_auroc:  0.7596956308296514 val_auprc:  0.8734767104348541
EarlyStopping counter: 12 out of 50
epoch:  37
epoch:  38 val_f1:  0.7362024088594293 val_auroc:  0.7594501718213058 val_auprc:  0.8743843223302182
EarlyStopping counter: 13 out of 50
epoch:  38
epoch:  39 val_f1:  0.7289242247644242 val_auroc:  0.7596956308296515 val_auprc:  0.8734295276644063
EarlyStopping counter: 14 out of 50
epoch:  39
epoch:  40 val_f1:  0.735514445586388 val_auroc:  0.7592047128129602 val_auprc:  0.8719821561994354
EarlyStopping counter: 15 out of 50
epoch:  40
epoch:  41 val_f1:  0.7337314237416728 val_auroc:  0.7601865488463427 val_auprc:  0.870850629680954
EarlyStopping counter: 16 out of 50
epoch:  41
epoch:  42 val_f1:  0.726175885795287 val_auroc:  0.761904761904762 val_auprc:  0.8708961677329687
EarlyStopping counter: 17 out of 50
epoch:  42
epoch:  43 val_f1:  0.7090514753972222 val_auroc:  0.7577319587628867 val_auprc:  0.8706307682381712
EarlyStopping counter: 18 out of 50
epoch:  43
epoch:  44 val_f1:  0.7281499969472504 val_auroc:  0.7614138438880707 val_auprc:  0.8735080464106885
EarlyStopping counter: 19 out of 50
epoch:  44
epoch:  45 val_f1:  0.7215941532488295 val_auroc:  0.7584683357879234 val_auprc:  0.8696984994484331
EarlyStopping counter: 20 out of 50
epoch:  45
epoch:  46 val_f1:  0.7207289113763933 val_auroc:  0.7589592538046147 val_auprc:  0.8679790403249208
EarlyStopping counter: 21 out of 50
epoch:  46
epoch:  47 val_f1:  0.7207289113763933 val_auroc:  0.7587137947962691 val_auprc:  0.8686418042435261
EarlyStopping counter: 22 out of 50
epoch:  47
epoch:  48 val_f1:  0.7215941532488295 val_auroc:  0.7577319587628866 val_auprc:  0.8686580194849274
EarlyStopping counter: 23 out of 50
epoch:  48
epoch:  49 val_f1:  0.7410071942446043 val_auroc:  0.7623956799214531 val_auprc:  0.8702083289302545
EarlyStopping counter: 24 out of 50
epoch:  49
epoch:  50 val_f1:  0.7207289113763933 val_auroc:  0.7562592047128129 val_auprc:  0.8680302402647124
EarlyStopping counter: 25 out of 50
epoch:  50
epoch:  51 val_f1:  0.6962806225607748 val_auroc:  0.7476681394207167 val_auprc:  0.8637658095003846
EarlyStopping counter: 26 out of 50
epoch:  51
epoch:  52 val_f1:  0.7202047592695074 val_auroc:  0.7621502209131075 val_auprc:  0.8695268096789308
EarlyStopping counter: 27 out of 50
epoch:  52
epoch:  53 val_f1:  0.7215941532488295 val_auroc:  0.7496318114874816 val_auprc:  0.8641233296882185
EarlyStopping counter: 28 out of 50
epoch:  53
epoch:  54 val_f1:  0.713247796930704 val_auroc:  0.7560137457044673 val_auprc:  0.8673132587445073
EarlyStopping counter: 29 out of 50
epoch:  54
epoch:  55 val_f1:  0.7349308245711123 val_auroc:  0.7638684339715267 val_auprc:  0.8704553390293661
EarlyStopping counter: 30 out of 50
epoch:  55
epoch:  56 val_f1:  0.6894399143298684 val_auroc:  0.7491408934707904 val_auprc:  0.8633859836746186
EarlyStopping counter: 31 out of 50
epoch:  56
epoch:  57 val_f1:  0.7237424247793883 val_auroc:  0.7587137947962691 val_auprc:  0.8645933405272179
EarlyStopping counter: 32 out of 50
epoch:  57
epoch:  58 val_f1:  0.7084342413709481 val_auroc:  0.7452135493372606 val_auprc:  0.8588243098353264
EarlyStopping counter: 33 out of 50
epoch:  58
epoch:  59 val_f1:  0.7326256806616418 val_auroc:  0.7520864015709376 val_auprc:  0.8620482951047829
EarlyStopping counter: 34 out of 50
epoch:  59
epoch:  60 val_f1:  0.7371484630477437 val_auroc:  0.7567501227295041 val_auprc:  0.8642268986931507
EarlyStopping counter: 35 out of 50
epoch:  60
epoch:  61 val_f1:  0.7272357092755477 val_auroc:  0.7545409916543937 val_auprc:  0.864529879718538
EarlyStopping counter: 36 out of 50
epoch:  61
epoch:  62 val_f1:  0.7326256806616418 val_auroc:  0.7535591556210113 val_auprc:  0.8627559184599731
EarlyStopping counter: 37 out of 50
epoch:  62
epoch:  63 val_f1:  0.7272357092755477 val_auroc:  0.7496318114874816 val_auprc:  0.8607278091674098
EarlyStopping counter: 38 out of 50
epoch:  63
epoch:  64 val_f1:  0.717230470942395 val_auroc:  0.7530682376043201 val_auprc:  0.8622292445739821
EarlyStopping counter: 39 out of 50
epoch:  64
epoch:  65 val_f1:  0.7249644134959412 val_auroc:  0.7508591065292095 val_auprc:  0.8605374533558898
EarlyStopping counter: 40 out of 50
epoch:  65
epoch:  66 val_f1:  0.7326256806616418 val_auroc:  0.750613647520864 val_auprc:  0.8609232903561185
EarlyStopping counter: 41 out of 50
epoch:  66
epoch:  67 val_f1:  0.7015283467006299 val_auroc:  0.7515954835542464 val_auprc:  0.8609241911235685
EarlyStopping counter: 42 out of 50
epoch:  67
epoch:  68 val_f1:  0.7326256806616418 val_auroc:  0.7511045655375552 val_auprc:  0.8613129164109171
EarlyStopping counter: 43 out of 50
epoch:  68
epoch:  69 val_f1:  0.7337314237416728 val_auroc:  0.7491408934707904 val_auprc:  0.8603970196663294
EarlyStopping counter: 44 out of 50
epoch:  69
epoch:  70 val_f1:  0.7184536707983012 val_auroc:  0.7513500245459008 val_auprc:  0.8612648621411338
EarlyStopping counter: 45 out of 50
epoch:  70
epoch:  71 val_f1:  0.7326256806616418 val_auroc:  0.7491408934707904 val_auprc:  0.8597526280185023
EarlyStopping counter: 46 out of 50
epoch:  71
epoch:  72 val_f1:  0.7235944791518311 val_auroc:  0.7503681885125184 val_auprc:  0.8604047758015267
EarlyStopping counter: 47 out of 50
epoch:  72
epoch:  73 val_f1:  0.7157412825720284 val_auroc:  0.7511045655375552 val_auprc:  0.8607529778389251
EarlyStopping counter: 48 out of 50
epoch:  73
epoch:  74 val_f1:  0.7060068982302729 val_auroc:  0.7513500245459008 val_auprc:  0.86092920849867
EarlyStopping counter: 49 out of 50
epoch:  74
epoch:  75 val_f1:  0.7249644134959412 val_auroc:  0.7474226804123711 val_auprc:  0.8578378051482964
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  19.39985942840576
{'time_elapsed': [19.39985942840576], 'epoch': [74], 'fold': [2], 'f1_train': [0.9644448489857246], 'auroc_train': [0.997685256154766], 'auprc_train': [0.9989998185205984], 'f1_test': [0.7249644134959412], 'auroc_test': [0.7474226804123711], 'auprc_test': [0.8578378051482964]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 183]            1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 183]            256
│    └─Tanh: 2-3                         [64, 128, 183]            --
│    └─MaxPool1d: 2-4                    [64, 128, 26]             --
│    └─Dropout: 2-5                      [64, 128, 26]             --
│    └─Flatten: 2-6                      [64, 3328]                --
│    └─Linear: 2-7                       [64, 1]                   3,329
==========================================================================================
Total params: 4,609
Trainable params: 4,609
Non-trainable params: 0
Total mult-adds (M): 12.22
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 23.99
Params size (MB): 0.02
Estimated Total Size (MB): 24.33
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5642736874330323 val_auroc:  0.5414244186046512 val_auprc:  0.7114508123955545
epoch:  1
epoch:  2 val_f1:  0.6351062007536827 val_auroc:  0.6201550387596899 val_auprc:  0.7648945928764413
Validation loss improved to 1.211647
epoch:  2
epoch:  3 val_f1:  0.4240324539697944 val_auroc:  0.6654554263565893 val_auprc:  0.8061479962826604
Validation loss improved to 1.208085
epoch:  3
epoch:  4 val_f1:  0.6910889470241989 val_auroc:  0.6792635658914729 val_auprc:  0.8020760906747197
Validation loss improved to 1.167125
epoch:  4
epoch:  5 val_f1:  0.6676055817733489 val_auroc:  0.7170542635658914 val_auprc:  0.857148571747921
Validation loss improved to 1.135666
epoch:  5
epoch:  6 val_f1:  0.6812159467828036 val_auroc:  0.7403100775193799 val_auprc:  0.8795884666474136
Validation loss improved to 1.117679
epoch:  6
epoch:  7 val_f1:  0.7144407648910238 val_auroc:  0.7526647286821706 val_auprc:  0.884022377678737
Validation loss improved to 1.095630
epoch:  7
epoch:  8 val_f1:  0.7226475072684283 val_auroc:  0.7676841085271318 val_auprc:  0.8933694730982306
Validation loss improved to 1.076517
epoch:  8
epoch:  9 val_f1:  0.7342436255077571 val_auroc:  0.7776162790697676 val_auprc:  0.8988652470869263
Validation loss improved to 1.059592
epoch:  9
epoch:  10 val_f1:  0.7230958778588147 val_auroc:  0.7841569767441859 val_auprc:  0.9048831747795394
Validation loss improved to 1.043739
epoch:  10
epoch:  11 val_f1:  0.7333468390123067 val_auroc:  0.7911821705426356 val_auprc:  0.9066806952151526
Validation loss improved to 1.031139
epoch:  11
epoch:  12 val_f1:  0.7294025390752633 val_auroc:  0.7948158914728682 val_auprc:  0.9093410994234907
Validation loss improved to 1.012572
epoch:  12
epoch:  13 val_f1:  0.7202564479029021 val_auroc:  0.7991763565891472 val_auprc:  0.9109146209349378
Validation loss improved to 0.997661
epoch:  13
epoch:  14 val_f1:  0.7289507977529213 val_auroc:  0.7996608527131782 val_auprc:  0.9110107252816827
Validation loss improved to 0.981134
epoch:  14
epoch:  15 val_f1:  0.7517526908132072 val_auroc:  0.8037790697674418 val_auprc:  0.9114202546708194
Validation loss improved to 0.973333
epoch:  15
epoch:  16 val_f1:  0.7432793319431985 val_auroc:  0.8076550387596898 val_auprc:  0.9158820688306655
Validation loss improved to 0.953264
epoch:  16
epoch:  17 val_f1:  0.7482308031126119 val_auroc:  0.8093507751937985 val_auprc:  0.9154078491868249
Validation loss improved to 0.941245
epoch:  17
epoch:  18 val_f1:  0.7440073473136385 val_auroc:  0.812984496124031 val_auprc:  0.916666550830433
Validation loss improved to 0.938741
epoch:  18
epoch:  19 val_f1:  0.7529139722223964 val_auroc:  0.8183139534883721 val_auprc:  0.9191554356886391
Validation loss improved to 0.924482
epoch:  19
epoch:  20 val_f1:  0.7428507568425149 val_auroc:  0.8192829457364341 val_auprc:  0.9201912321095802
Validation loss improved to 0.908721
epoch:  20
epoch:  21 val_f1:  0.7695564219015847 val_auroc:  0.8207364341085271 val_auprc:  0.9204298533386653
Validation loss improved to 0.899275
epoch:  21
epoch:  22 val_f1:  0.7504468335444003 val_auroc:  0.8229166666666667 val_auprc:  0.9201991419928908
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7428507568425149 val_auroc:  0.8255813953488372 val_auprc:  0.9242932744730012
Validation loss improved to 0.877722
epoch:  23
epoch:  24 val_f1:  0.7504468335444003 val_auroc:  0.8250968992248062 val_auprc:  0.9224733160057156
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7432793319431985 val_auroc:  0.8294573643410853 val_auprc:  0.9260349082474313
Validation loss improved to 0.863619
epoch:  25
epoch:  26 val_f1:  0.7594266802546743 val_auroc:  0.8299418604651162 val_auprc:  0.9246569408593817
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7768458491633659 val_auroc:  0.8330910852713179 val_auprc:  0.9273717145148999
Validation loss improved to 0.848246
epoch:  27
epoch:  28 val_f1:  0.7266187050359713 val_auroc:  0.8323643410852714 val_auprc:  0.9254786755753145
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.757449328289459 val_auroc:  0.8362403100775194 val_auprc:  0.9295161539539014
Validation loss improved to 0.834781
epoch:  29
epoch:  30 val_f1:  0.7594266802546743 val_auroc:  0.8357558139534883 val_auprc:  0.9283486091946969
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7529139722223964 val_auroc:  0.8372093023255814 val_auprc:  0.929254667892907
Validation loss improved to 0.825135
epoch:  31
epoch:  32 val_f1:  0.7594266802546743 val_auroc:  0.8391472868217055 val_auprc:  0.930128918531266
Validation loss improved to 0.821880
epoch:  32
epoch:  33 val_f1:  0.7504468335444003 val_auroc:  0.8408430232558138 val_auprc:  0.930497268383264
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.7622179807174668 val_auroc:  0.841327519379845 val_auprc:  0.9317716357524911
Validation loss improved to 0.806602
epoch:  34
epoch:  35 val_f1:  0.7504468335444003 val_auroc:  0.8430232558139534 val_auprc:  0.9321452368055969
EarlyStopping counter: 1 out of 50
epoch:  35
epoch:  36 val_f1:  0.767033173809688 val_auroc:  0.845687984496124 val_auprc:  0.9339805886163928
Validation loss improved to 0.804807
epoch:  36
epoch:  37 val_f1:  0.7777989809743717 val_auroc:  0.8454457364341084 val_auprc:  0.934526181410445
Validation loss improved to 0.795028
epoch:  37
epoch:  38 val_f1:  0.7504468335444003 val_auroc:  0.846656976744186 val_auprc:  0.9333055720704866
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.7745758989478168 val_auroc:  0.8464147286821705 val_auprc:  0.9348365846234714
Validation loss improved to 0.789381
epoch:  39
epoch:  40 val_f1:  0.7697841726618705 val_auroc:  0.8471414728682171 val_auprc:  0.9338821617042312
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.7773759601944114 val_auroc:  0.8471414728682171 val_auprc:  0.9354465528654652
Validation loss improved to 0.780996
epoch:  41
epoch:  42 val_f1:  0.7659382513381667 val_auroc:  0.851501937984496 val_auprc:  0.9372308356484335
EarlyStopping counter: 1 out of 50
epoch:  42
epoch:  43 val_f1:  0.7724509753899008 val_auroc:  0.8502906976744186 val_auprc:  0.9365010854859261
EarlyStopping counter: 2 out of 50
epoch:  43
epoch:  44 val_f1:  0.7735780520043992 val_auroc:  0.8519864341085271 val_auprc:  0.9374875133733338
Validation loss improved to 0.780949
epoch:  44
epoch:  45 val_f1:  0.7854893118997625 val_auroc:  0.8527131782945736 val_auprc:  0.937570149633609
EarlyStopping counter: 1 out of 50
epoch:  45
epoch:  46 val_f1:  0.7604868926320555 val_auroc:  0.8531976744186046 val_auprc:  0.9381264074199608
Validation loss improved to 0.768439
epoch:  46
epoch:  47 val_f1:  0.7854893118997625 val_auroc:  0.8539244186046512 val_auprc:  0.9385963927665368
EarlyStopping counter: 1 out of 50
epoch:  47
epoch:  48 val_f1:  0.7735780520043992 val_auroc:  0.8573158914728682 val_auprc:  0.9402045111197003
Validation loss improved to 0.761772
epoch:  48
epoch:  49 val_f1:  0.7854893118997625 val_auroc:  0.8563468992248062 val_auprc:  0.9397558988366658
EarlyStopping counter: 1 out of 50
epoch:  49
epoch:  50 val_f1:  0.7776763243674784 val_auroc:  0.8582848837209301 val_auprc:  0.9398693375956402
EarlyStopping counter: 2 out of 50
epoch:  50
epoch:  51 val_f1:  0.7735780520043992 val_auroc:  0.8590116279069767 val_auprc:  0.9410032993159466
Validation loss improved to 0.756294
epoch:  51
epoch:  52 val_f1:  0.7854893118997625 val_auroc:  0.8609496124031008 val_auprc:  0.9418208446605751
EarlyStopping counter: 1 out of 50
epoch:  52
epoch:  53 val_f1:  0.7877294237541244 val_auroc:  0.8624031007751939 val_auprc:  0.9430054396775871
Validation loss improved to 0.746337
epoch:  53
epoch:  54 val_f1:  0.7854893118997625 val_auroc:  0.8640988372093025 val_auprc:  0.9434192016836085
EarlyStopping counter: 1 out of 50
epoch:  54
epoch:  55 val_f1:  0.7866727894280321 val_auroc:  0.8645833333333334 val_auprc:  0.9436691921781981
EarlyStopping counter: 2 out of 50
epoch:  55
epoch:  56 val_f1:  0.7866727894280321 val_auroc:  0.8653100775193799 val_auprc:  0.9442875135941071
EarlyStopping counter: 3 out of 50
epoch:  56
epoch:  57 val_f1:  0.7789671954250403 val_auroc:  0.8655523255813954 val_auprc:  0.9444760166422439
EarlyStopping counter: 4 out of 50
epoch:  57
epoch:  58 val_f1:  0.792019787311512 val_auroc:  0.8667635658914729 val_auprc:  0.9446555938965298
EarlyStopping counter: 5 out of 50
epoch:  58
epoch:  59 val_f1:  0.7894843465886632 val_auroc:  0.8653100775193798 val_auprc:  0.9442255098113917
Validation loss improved to 0.742716
epoch:  59
epoch:  60 val_f1:  0.7854893118997625 val_auroc:  0.867248062015504 val_auprc:  0.945014173634386
EarlyStopping counter: 1 out of 50
epoch:  60
epoch:  61 val_f1:  0.7841726618705036 val_auroc:  0.8703972868217055 val_auprc:  0.9465408941486182
EarlyStopping counter: 2 out of 50
epoch:  61
epoch:  62 val_f1:  0.7866727894280321 val_auroc:  0.8677325581395349 val_auprc:  0.9457860935915396
EarlyStopping counter: 3 out of 50
epoch:  62
epoch:  63 val_f1:  0.7776763243674784 val_auroc:  0.8703972868217055 val_auprc:  0.9466821681125134
EarlyStopping counter: 4 out of 50
epoch:  63
epoch:  64 val_f1:  0.8018807955038493 val_auroc:  0.8689437984496126 val_auprc:  0.9462891970431411
Validation loss improved to 0.738415
epoch:  64
epoch:  65 val_f1:  0.764639197732723 val_auroc:  0.8733042635658915 val_auprc:  0.9479362891427616
EarlyStopping counter: 1 out of 50
epoch:  65
epoch:  66 val_f1:  0.8027539115793398 val_auroc:  0.8691860465116278 val_auprc:  0.9466968778374105
EarlyStopping counter: 2 out of 50
epoch:  66
epoch:  67 val_f1:  0.776244301724119 val_auroc:  0.8730620155038759 val_auprc:  0.9483465028468164
EarlyStopping counter: 3 out of 50
epoch:  67
epoch:  68 val_f1:  0.7841726618705036 val_auroc:  0.8733042635658914 val_auprc:  0.9482809870122295
EarlyStopping counter: 4 out of 50
epoch:  68
epoch:  69 val_f1:  0.7968569383258559 val_auroc:  0.8711240310077519 val_auprc:  0.9472530749098111
Validation loss improved to 0.735827
epoch:  69
epoch:  70 val_f1:  0.758275274873164 val_auroc:  0.874515503875969 val_auprc:  0.9488743396408365
EarlyStopping counter: 1 out of 50
epoch:  70
epoch:  71 val_f1:  0.7841726618705036 val_auroc:  0.8733042635658915 val_auprc:  0.9485671878527937
EarlyStopping counter: 2 out of 50
epoch:  71
epoch:  72 val_f1:  0.7827158008497472 val_auroc:  0.873546511627907 val_auprc:  0.9485287200059113
EarlyStopping counter: 3 out of 50
epoch:  72
epoch:  73 val_f1:  0.8018807955038493 val_auroc:  0.8747577519379844 val_auprc:  0.9490930489593683
EarlyStopping counter: 4 out of 50
epoch:  73
epoch:  74 val_f1:  0.7841726618705036 val_auroc:  0.8766957364341085 val_auprc:  0.9497109209276579
EarlyStopping counter: 5 out of 50
epoch:  74
epoch:  75 val_f1:  0.7827158008497472 val_auroc:  0.8781492248062016 val_auprc:  0.9504596773476564
EarlyStopping counter: 6 out of 50
epoch:  75
epoch:  76 val_f1:  0.7985611510791367 val_auroc:  0.8786337209302325 val_auprc:  0.9507094358803265
EarlyStopping counter: 7 out of 50
epoch:  76
epoch:  77 val_f1:  0.792019787311512 val_auroc:  0.8786337209302325 val_auprc:  0.950903273386552
EarlyStopping counter: 8 out of 50
epoch:  77
epoch:  78 val_f1:  0.7746634573712671 val_auroc:  0.8774224806201548 val_auprc:  0.9502269141789912
EarlyStopping counter: 9 out of 50
epoch:  78
epoch:  79 val_f1:  0.792019787311512 val_auroc:  0.8766957364341085 val_auprc:  0.9502654106094769
EarlyStopping counter: 10 out of 50
epoch:  79
epoch:  80 val_f1:  0.7827158008497472 val_auroc:  0.876937984496124 val_auprc:  0.9503653899486977
EarlyStopping counter: 11 out of 50
epoch:  80
epoch:  81 val_f1:  0.8151164175042944 val_auroc:  0.8781492248062016 val_auprc:  0.9507606746259989
EarlyStopping counter: 12 out of 50
epoch:  81
epoch:  82 val_f1:  0.7746634573712671 val_auroc:  0.880813953488372 val_auprc:  0.9516716218740732
EarlyStopping counter: 13 out of 50
epoch:  82
epoch:  83 val_f1:  0.7746634573712671 val_auroc:  0.878875968992248 val_auprc:  0.9511023303393404
EarlyStopping counter: 14 out of 50
epoch:  83
epoch:  84 val_f1:  0.7985611510791367 val_auroc:  0.87984496124031 val_auprc:  0.9514729027361956
EarlyStopping counter: 15 out of 50
epoch:  84
epoch:  85 val_f1:  0.7665182935781787 val_auroc:  0.8803294573643411 val_auprc:  0.9516908395403106
EarlyStopping counter: 16 out of 50
epoch:  85
epoch:  86 val_f1:  0.7985611510791367 val_auroc:  0.8810562015503874 val_auprc:  0.9520887671185623
EarlyStopping counter: 17 out of 50
epoch:  86
epoch:  87 val_f1:  0.7985611510791367 val_auroc:  0.8810562015503874 val_auprc:  0.9520518046132381
EarlyStopping counter: 18 out of 50
epoch:  87
epoch:  88 val_f1:  0.7985611510791367 val_auroc:  0.8812984496124031 val_auprc:  0.952155339474906
EarlyStopping counter: 19 out of 50
epoch:  88
epoch:  89 val_f1:  0.7665182935781787 val_auroc:  0.8815406976744186 val_auprc:  0.952013508017246
EarlyStopping counter: 20 out of 50
epoch:  89
epoch:  90 val_f1:  0.8140907369797942 val_auroc:  0.8776647286821705 val_auprc:  0.9503154326877327
EarlyStopping counter: 21 out of 50
epoch:  90
epoch:  91 val_f1:  0.758275274873164 val_auroc:  0.8820251937984496 val_auprc:  0.9524864552311686
EarlyStopping counter: 22 out of 50
epoch:  91
epoch:  92 val_f1:  0.8301835390032996 val_auroc:  0.8776647286821705 val_auprc:  0.9501194095933021
EarlyStopping counter: 23 out of 50
epoch:  92
epoch:  93 val_f1:  0.758275274873164 val_auroc:  0.882751937984496 val_auprc:  0.9526204208752564
EarlyStopping counter: 24 out of 50
epoch:  93
epoch:  94 val_f1:  0.7906801532257888 val_auroc:  0.8815406976744186 val_auprc:  0.9520001067959971
EarlyStopping counter: 25 out of 50
epoch:  94
epoch:  95 val_f1:  0.8063632502555458 val_auroc:  0.8803294573643411 val_auprc:  0.9511991108327253
EarlyStopping counter: 26 out of 50
epoch:  95
epoch:  96 val_f1:  0.749929147591018 val_auroc:  0.8827519379844961 val_auprc:  0.9528091831778615
EarlyStopping counter: 27 out of 50
epoch:  96
epoch:  97 val_f1:  0.8368660539629647 val_auroc:  0.8771802325581395 val_auprc:  0.9497056648958144
EarlyStopping counter: 28 out of 50
epoch:  97
epoch:  98 val_f1:  0.749929147591018 val_auroc:  0.8829941860465117 val_auprc:  0.9529627822857124
EarlyStopping counter: 29 out of 50
epoch:  98
epoch:  99 val_f1:  0.8140907369797942 val_auroc:  0.87984496124031 val_auprc:  0.9507865745195683
EarlyStopping counter: 30 out of 50
epoch:  99
epoch:  100 val_f1:  0.7827158008497472 val_auroc:  0.8832364341085271 val_auprc:  0.952600021647886
EarlyStopping counter: 31 out of 50
epoch:  100
epoch:  101 val_f1:  0.7906801532257888 val_auroc:  0.8822674418604651 val_auprc:  0.9522764583434942
EarlyStopping counter: 32 out of 50
epoch:  101
epoch:  102 val_f1:  0.7906801532257888 val_auroc:  0.8817829457364341 val_auprc:  0.9518958611174322
EarlyStopping counter: 33 out of 50
epoch:  102
epoch:  103 val_f1:  0.7906801532257888 val_auroc:  0.880813953488372 val_auprc:  0.9515561252362875
EarlyStopping counter: 34 out of 50
epoch:  103
epoch:  104 val_f1:  0.7746634573712671 val_auroc:  0.883720930232558 val_auprc:  0.9530586863937728
EarlyStopping counter: 35 out of 50
epoch:  104
epoch:  105 val_f1:  0.7985611510791367 val_auroc:  0.8800872093023255 val_auprc:  0.9513175971783814
EarlyStopping counter: 36 out of 50
epoch:  105
epoch:  106 val_f1:  0.7746634573712671 val_auroc:  0.882751937984496 val_auprc:  0.9522962540187863
EarlyStopping counter: 37 out of 50
epoch:  106
epoch:  107 val_f1:  0.8140907369797942 val_auroc:  0.8786337209302325 val_auprc:  0.9500365666945315
EarlyStopping counter: 38 out of 50
epoch:  107
epoch:  108 val_f1:  0.7746634573712671 val_auroc:  0.8825096899224806 val_auprc:  0.9520877110156464
EarlyStopping counter: 39 out of 50
epoch:  108
epoch:  109 val_f1:  0.7985611510791367 val_auroc:  0.8803294573643411 val_auprc:  0.9506650306959521
EarlyStopping counter: 40 out of 50
epoch:  109
epoch:  110 val_f1:  0.7827158008497472 val_auroc:  0.8825096899224806 val_auprc:  0.9521296663635755
EarlyStopping counter: 41 out of 50
epoch:  110
epoch:  111 val_f1:  0.7827158008497472 val_auroc:  0.8822674418604651 val_auprc:  0.9521210548361448
EarlyStopping counter: 42 out of 50
epoch:  111
epoch:  112 val_f1:  0.7985611510791367 val_auroc:  0.87984496124031 val_auprc:  0.9509177481414564
EarlyStopping counter: 43 out of 50
epoch:  112
epoch:  113 val_f1:  0.7827158008497472 val_auroc:  0.8810562015503877 val_auprc:  0.9515638202950143
EarlyStopping counter: 44 out of 50
epoch:  113
epoch:  114 val_f1:  0.8140907369797942 val_auroc:  0.8779069767441859 val_auprc:  0.9497331151597201
EarlyStopping counter: 45 out of 50
epoch:  114
epoch:  115 val_f1:  0.7827158008497472 val_auroc:  0.8822674418604651 val_auprc:  0.9518389841464883
EarlyStopping counter: 46 out of 50
epoch:  115
epoch:  116 val_f1:  0.8140907369797942 val_auroc:  0.8776647286821705 val_auprc:  0.9492896542587101
EarlyStopping counter: 47 out of 50
epoch:  116
epoch:  117 val_f1:  0.7906801532257888 val_auroc:  0.8793604651162791 val_auprc:  0.95045106036853
EarlyStopping counter: 48 out of 50
epoch:  117
epoch:  118 val_f1:  0.7985611510791367 val_auroc:  0.878391472868217 val_auprc:  0.9498630949291395
EarlyStopping counter: 49 out of 50
epoch:  118
epoch:  119 val_f1:  0.7827158008497472 val_auroc:  0.87984496124031 val_auprc:  0.9507259950841561
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  31.523707628250122
{'time_elapsed': [31.523707628250122], 'epoch': [118], 'fold': [3], 'f1_train': [0.9981997060342249], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7827158008497472], 'auroc_test': [0.87984496124031], 'auprc_test': [0.9507259950841561]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 183]            1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 183]            256
│    └─Tanh: 2-3                         [64, 128, 183]            --
│    └─MaxPool1d: 2-4                    [64, 128, 26]             --
│    └─Dropout: 2-5                      [64, 128, 26]             --
│    └─Flatten: 2-6                      [64, 3328]                --
│    └─Linear: 2-7                       [64, 1]                   3,329
==========================================================================================
Total params: 4,609
Trainable params: 4,609
Non-trainable params: 0
Total mult-adds (M): 12.22
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 23.99
Params size (MB): 0.02
Estimated Total Size (MB): 24.33
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5707915273132664 val_auroc:  0.6902281746031745 val_auprc:  0.8505438619048373
epoch:  1
epoch:  2 val_f1:  0.4811076467790519 val_auroc:  0.8154761904761905 val_auprc:  0.9048979686715867
Validation loss improved to 1.186271
epoch:  2
epoch:  3 val_f1:  0.7616502189311872 val_auroc:  0.8323412698412699 val_auprc:  0.9169293945387624
Validation loss improved to 1.151860
epoch:  3
epoch:  4 val_f1:  0.6921962095875139 val_auroc:  0.8422619047619047 val_auprc:  0.9210413676150769
Validation loss improved to 1.122916
epoch:  4
epoch:  5 val_f1:  0.7755600530392909 val_auroc:  0.8400297619047619 val_auprc:  0.9172960854170824
Validation loss improved to 1.101543
epoch:  5
epoch:  6 val_f1:  0.7632485643970468 val_auroc:  0.8472222222222223 val_auprc:  0.9206144753549848
Validation loss improved to 1.077856
epoch:  6
epoch:  7 val_f1:  0.7697938448700337 val_auroc:  0.8514384920634921 val_auprc:  0.9225655432320292
Validation loss improved to 1.059892
epoch:  7
epoch:  8 val_f1:  0.7629890332114801 val_auroc:  0.8578869047619049 val_auprc:  0.9240406710045803
Validation loss improved to 1.042167
epoch:  8
epoch:  9 val_f1:  0.742455681411078 val_auroc:  0.8598710317460317 val_auprc:  0.925998477106397
Validation loss improved to 1.026099
epoch:  9
epoch:  10 val_f1:  0.8164398044139025 val_auroc:  0.8596230158730158 val_auprc:  0.92568411514439
Validation loss improved to 1.023171
epoch:  10
epoch:  11 val_f1:  0.7493220093615789 val_auroc:  0.8623511904761905 val_auprc:  0.92639141255375
Validation loss improved to 0.997122
epoch:  11
epoch:  12 val_f1:  0.8049865427618805 val_auroc:  0.8621031746031746 val_auprc:  0.9247990002928606
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7561657767607425 val_auroc:  0.8640873015873015 val_auprc:  0.9262470858210228
Validation loss improved to 0.973485
epoch:  13
epoch:  14 val_f1:  0.8030193236714975 val_auroc:  0.8643353174603174 val_auprc:  0.9259127070413911
Validation loss improved to 0.965632
epoch:  14
epoch:  15 val_f1:  0.7833564971403972 val_auroc:  0.8645833333333334 val_auprc:  0.9255532877295155
Validation loss improved to 0.951637
epoch:  15
epoch:  16 val_f1:  0.7632485643970468 val_auroc:  0.8665674603174603 val_auprc:  0.9264175645660295
Validation loss improved to 0.944021
epoch:  16
epoch:  17 val_f1:  0.8097298254042504 val_auroc:  0.8640873015873016 val_auprc:  0.9232413469188111
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.8030193236714975 val_auroc:  0.8638392857142857 val_auprc:  0.9225344127270939
Validation loss improved to 0.936398
epoch:  18
epoch:  19 val_f1:  0.770099160945843 val_auroc:  0.8673115079365079 val_auprc:  0.9252745087988441
Validation loss improved to 0.916362
epoch:  19
epoch:  20 val_f1:  0.8030193236714975 val_auroc:  0.8663194444444444 val_auprc:  0.9225398281686953
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7634000460087416 val_auroc:  0.8683035714285715 val_auprc:  0.9254598274255628
Validation loss improved to 0.909295
epoch:  21
epoch:  22 val_f1:  0.8102677351291666 val_auroc:  0.8640873015873016 val_auprc:  0.920117066635793
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.6994966360955902 val_auroc:  0.8692956349206349 val_auprc:  0.9247598128729007
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.7614778962024896 val_auroc:  0.8583829365079365 val_auprc:  0.9161443661224564
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.7355514316012725 val_auroc:  0.8683035714285715 val_auprc:  0.923901492498206
Validation loss improved to 0.892525
epoch:  25
epoch:  26 val_f1:  0.8205262448141007 val_auroc:  0.863343253968254 val_auprc:  0.9195015799955504
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7968706966496207 val_auroc:  0.8665674603174602 val_auprc:  0.9225320439967415
Validation loss improved to 0.867441
epoch:  27
epoch:  28 val_f1:  0.7976976212494236 val_auroc:  0.8680555555555555 val_auprc:  0.9237928433006353
Validation loss improved to 0.859230
epoch:  28
epoch:  29 val_f1:  0.8023197893688181 val_auroc:  0.8663194444444445 val_auprc:  0.922179546347184
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.8194319840387783 val_auroc:  0.8618551587301587 val_auprc:  0.9185059609588625
EarlyStopping counter: 2 out of 50
epoch:  30
epoch:  31 val_f1:  0.7973334973248877 val_auroc:  0.8685515873015873 val_auprc:  0.9229251519321812
Validation loss improved to 0.845226
epoch:  31
epoch:  32 val_f1:  0.8194319840387783 val_auroc:  0.8628472222222222 val_auprc:  0.9203508150450553
EarlyStopping counter: 1 out of 50
epoch:  32
epoch:  33 val_f1:  0.8164398044139025 val_auroc:  0.8640873015873015 val_auprc:  0.9210879652989261
EarlyStopping counter: 2 out of 50
epoch:  33
epoch:  34 val_f1:  0.8164398044139025 val_auroc:  0.8658234126984128 val_auprc:  0.9217599969441694
EarlyStopping counter: 3 out of 50
epoch:  34
epoch:  35 val_f1:  0.8102677351291666 val_auroc:  0.8613591269841271 val_auprc:  0.9193318112785834
EarlyStopping counter: 4 out of 50
epoch:  35
epoch:  36 val_f1:  0.7837457330597287 val_auroc:  0.8705357142857143 val_auprc:  0.9251652706231758
Validation loss improved to 0.833108
epoch:  36
epoch:  37 val_f1:  0.7963059879954627 val_auroc:  0.8670634920634921 val_auprc:  0.923537004208825
EarlyStopping counter: 1 out of 50
epoch:  37
epoch:  38 val_f1:  0.8182185828242006 val_auroc:  0.8608630952380951 val_auprc:  0.9207997160087711
EarlyStopping counter: 2 out of 50
epoch:  38
epoch:  39 val_f1:  0.7837457330597287 val_auroc:  0.8663194444444444 val_auprc:  0.9230483119529014
Validation loss improved to 0.830878
epoch:  39
epoch:  40 val_f1:  0.8194319840387783 val_auroc:  0.8613591269841271 val_auprc:  0.9207744787780938
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.822380909337431 val_auroc:  0.8648313492063492 val_auprc:  0.9225623523983573
EarlyStopping counter: 2 out of 50
epoch:  41
epoch:  42 val_f1:  0.7968706966496207 val_auroc:  0.865079365079365 val_auprc:  0.9231774374959116
Validation loss improved to 0.827288
epoch:  42
epoch:  43 val_f1:  0.8103538508923273 val_auroc:  0.8645833333333334 val_auprc:  0.9227516068794305
EarlyStopping counter: 1 out of 50
epoch:  43
epoch:  44 val_f1:  0.8115942028985508 val_auroc:  0.861359126984127 val_auprc:  0.9206849444802581
EarlyStopping counter: 2 out of 50
epoch:  44
epoch:  45 val_f1:  0.7901185770750988 val_auroc:  0.8653273809523809 val_auprc:  0.9233668299427464
EarlyStopping counter: 3 out of 50
epoch:  45
epoch:  46 val_f1:  0.8127933585226971 val_auroc:  0.8598710317460317 val_auprc:  0.9199136318451939
EarlyStopping counter: 4 out of 50
epoch:  46
epoch:  47 val_f1:  0.8127933585226971 val_auroc:  0.8616071428571429 val_auprc:  0.9210952088788923
EarlyStopping counter: 5 out of 50
epoch:  47
epoch:  48 val_f1:  0.8156899810964081 val_auroc:  0.8628472222222223 val_auprc:  0.9220563979972485
EarlyStopping counter: 6 out of 50
epoch:  48
epoch:  49 val_f1:  0.8156899810964081 val_auroc:  0.8625992063492063 val_auprc:  0.9218351707707193
EarlyStopping counter: 7 out of 50
epoch:  49
epoch:  50 val_f1:  0.8156899810964081 val_auroc:  0.8618551587301586 val_auprc:  0.92149177381806
EarlyStopping counter: 8 out of 50
epoch:  50
epoch:  51 val_f1:  0.8103538508923273 val_auroc:  0.8635912698412699 val_auprc:  0.9226213461902937
EarlyStopping counter: 9 out of 50
epoch:  51
epoch:  52 val_f1:  0.8102677351291666 val_auroc:  0.8591269841269842 val_auprc:  0.9195653884106421
EarlyStopping counter: 10 out of 50
epoch:  52
epoch:  53 val_f1:  0.8103538508923273 val_auroc:  0.8623511904761905 val_auprc:  0.9224753811488936
EarlyStopping counter: 11 out of 50
epoch:  53
epoch:  54 val_f1:  0.8061683443992288 val_auroc:  0.8603670634920635 val_auprc:  0.9211198956815102
EarlyStopping counter: 12 out of 50
epoch:  54
epoch:  55 val_f1:  0.8215074100875418 val_auroc:  0.8608630952380952 val_auprc:  0.9213402474339861
EarlyStopping counter: 13 out of 50
epoch:  55
epoch:  56 val_f1:  0.8103538508923273 val_auroc:  0.8621031746031746 val_auprc:  0.9222986499535261
EarlyStopping counter: 14 out of 50
epoch:  56
epoch:  57 val_f1:  0.8022296544035674 val_auroc:  0.8568948412698413 val_auprc:  0.9193590833648226
EarlyStopping counter: 15 out of 50
epoch:  57
epoch:  58 val_f1:  0.81483559295621 val_auroc:  0.8630952380952381 val_auprc:  0.9234250544386209
EarlyStopping counter: 16 out of 50
epoch:  58
epoch:  59 val_f1:  0.8127933585226971 val_auroc:  0.8603670634920635 val_auprc:  0.9213207910200605
EarlyStopping counter: 17 out of 50
epoch:  59
epoch:  60 val_f1:  0.8215074100875418 val_auroc:  0.8596230158730158 val_auprc:  0.9209168929783942
EarlyStopping counter: 18 out of 50
epoch:  60
epoch:  61 val_f1:  0.8205262448141007 val_auroc:  0.8598710317460316 val_auprc:  0.9210692847928621
EarlyStopping counter: 19 out of 50
epoch:  61
epoch:  62 val_f1:  0.8215074100875418 val_auroc:  0.8606150793650793 val_auprc:  0.92141557245267
EarlyStopping counter: 20 out of 50
epoch:  62
epoch:  63 val_f1:  0.8164398044139025 val_auroc:  0.8606150793650793 val_auprc:  0.9218138208195769
EarlyStopping counter: 21 out of 50
epoch:  63
epoch:  64 val_f1:  0.8127933585226971 val_auroc:  0.8571428571428571 val_auprc:  0.9199485547306067
EarlyStopping counter: 22 out of 50
epoch:  64
epoch:  65 val_f1:  0.8205262448141007 val_auroc:  0.8576388888888888 val_auprc:  0.9202067241006903
EarlyStopping counter: 23 out of 50
epoch:  65
epoch:  66 val_f1:  0.8164398044139025 val_auroc:  0.8581349206349207 val_auprc:  0.9208806373832445
EarlyStopping counter: 24 out of 50
epoch:  66
epoch:  67 val_f1:  0.7875799991742021 val_auroc:  0.8566468253968254 val_auprc:  0.9195832867546578
EarlyStopping counter: 25 out of 50
epoch:  67
epoch:  68 val_f1:  0.8290790088826556 val_auroc:  0.8583829365079365 val_auprc:  0.9213468073313411
EarlyStopping counter: 26 out of 50
epoch:  68
epoch:  69 val_f1:  0.8194319840387783 val_auroc:  0.8588789682539681 val_auprc:  0.9210629829624776
EarlyStopping counter: 27 out of 50
epoch:  69
epoch:  70 val_f1:  0.8231516182680737 val_auroc:  0.8596230158730158 val_auprc:  0.9222861363235418
EarlyStopping counter: 28 out of 50
epoch:  70
epoch:  71 val_f1:  0.7956729455237178 val_auroc:  0.8576388888888888 val_auprc:  0.9209430538348453
EarlyStopping counter: 29 out of 50
epoch:  71
epoch:  72 val_f1:  0.8215074100875418 val_auroc:  0.8596230158730158 val_auprc:  0.9226504169728696
EarlyStopping counter: 30 out of 50
epoch:  72
epoch:  73 val_f1:  0.8271938694055665 val_auroc:  0.8591269841269842 val_auprc:  0.9218001658777838
EarlyStopping counter: 31 out of 50
epoch:  73
epoch:  74 val_f1:  0.8036760694501368 val_auroc:  0.8581349206349207 val_auprc:  0.9214738277563641
EarlyStopping counter: 32 out of 50
epoch:  74
epoch:  75 val_f1:  0.8115942028985508 val_auroc:  0.8578869047619048 val_auprc:  0.9214064997257188
EarlyStopping counter: 33 out of 50
epoch:  75
epoch:  76 val_f1:  0.8194319840387783 val_auroc:  0.857390873015873 val_auprc:  0.9210092947343467
EarlyStopping counter: 34 out of 50
epoch:  76
epoch:  77 val_f1:  0.8127933585226971 val_auroc:  0.8588789682539683 val_auprc:  0.9220995665470246
EarlyStopping counter: 35 out of 50
epoch:  77
epoch:  78 val_f1:  0.8205262448141007 val_auroc:  0.8581349206349206 val_auprc:  0.9218532935765862
EarlyStopping counter: 36 out of 50
epoch:  78
epoch:  79 val_f1:  0.8115942028985508 val_auroc:  0.8571428571428571 val_auprc:  0.9211712090124556
EarlyStopping counter: 37 out of 50
epoch:  79
epoch:  80 val_f1:  0.8205262448141007 val_auroc:  0.8568948412698413 val_auprc:  0.9209682200218074
EarlyStopping counter: 38 out of 50
epoch:  80
epoch:  81 val_f1:  0.7875799991742021 val_auroc:  0.8591269841269841 val_auprc:  0.92241943849307
EarlyStopping counter: 39 out of 50
epoch:  81
epoch:  82 val_f1:  0.8138718358422335 val_auroc:  0.8583829365079365 val_auprc:  0.9218225169218275
EarlyStopping counter: 40 out of 50
epoch:  82
epoch:  83 val_f1:  0.8231516182680737 val_auroc:  0.8617311507936508 val_auprc:  0.9233796268829219
EarlyStopping counter: 41 out of 50
epoch:  83
epoch:  84 val_f1:  0.800639197204071 val_auroc:  0.8551587301587301 val_auprc:  0.9188148471517783
EarlyStopping counter: 42 out of 50
epoch:  84
epoch:  85 val_f1:  0.8138718358422335 val_auroc:  0.8581349206349206 val_auprc:  0.9217293663976567
EarlyStopping counter: 43 out of 50
epoch:  85
epoch:  86 val_f1:  0.8205262448141007 val_auroc:  0.8566468253968255 val_auprc:  0.9209331174051139
EarlyStopping counter: 44 out of 50
epoch:  86
epoch:  87 val_f1:  0.8102677351291666 val_auroc:  0.8554067460317462 val_auprc:  0.9194303137528104
EarlyStopping counter: 45 out of 50
epoch:  87
epoch:  88 val_f1:  0.8127933585226971 val_auroc:  0.8566468253968254 val_auprc:  0.9199278675020908
EarlyStopping counter: 46 out of 50
epoch:  88
epoch:  89 val_f1:  0.800639197204071 val_auroc:  0.8546626984126984 val_auprc:  0.919258034889318
EarlyStopping counter: 47 out of 50
epoch:  89
epoch:  90 val_f1:  0.81483559295621 val_auroc:  0.8578869047619048 val_auprc:  0.9219882843353948
EarlyStopping counter: 48 out of 50
epoch:  90
epoch:  91 val_f1:  0.800639197204071 val_auroc:  0.8549107142857143 val_auprc:  0.9191569836498684
EarlyStopping counter: 49 out of 50
epoch:  91
epoch:  92 val_f1:  0.8138718358422335 val_auroc:  0.8556547619047619 val_auprc:  0.9196037257169942
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  23.937559366226196
{'time_elapsed': [23.937559366226196], 'epoch': [91], 'fold': [4], 'f1_train': [0.9839276502175103], 'auroc_train': [0.9998776814519212], 'auprc_train': [0.9999463220949848], 'f1_test': [0.8138718358422335], 'auroc_test': [0.8556547619047619], 'auprc_test': [0.9196037257169942]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 183]            1,024
│    └─BatchNorm1d: 2-2                  [64, 128, 183]            256
│    └─Tanh: 2-3                         [64, 128, 183]            --
│    └─MaxPool1d: 2-4                    [64, 128, 26]             --
│    └─Dropout: 2-5                      [64, 128, 26]             --
│    └─Flatten: 2-6                      [64, 3328]                --
│    └─Linear: 2-7                       [64, 1]                   3,329
==========================================================================================
Total params: 4,609
Trainable params: 4,609
Non-trainable params: 0
Total mult-adds (M): 12.22
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 23.99
Params size (MB): 0.02
Estimated Total Size (MB): 24.33
==========================================================================================
