config:  {'project': 'MHCCBM', 'name': 'CNN_13', 'config': {'hidden_channels': [1024], 'epochs': 500, 'kernel_size': 5, 'pool_kernel_size': 5, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.4920115468426625 val_auroc:  0.668384879725086 val_auprc:  0.7833411841137617
epoch:  1
epoch:  2 val_f1:  0.6788382480828524 val_auroc:  0.6956308296514483 val_auprc:  0.8548586606879118
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.7025483104025048 val_auroc:  0.6514482081492392 val_auprc:  0.8598417062451591
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.652897906393986 val_auroc:  0.7153902798232694 val_auprc:  0.8664954234948661
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6267262052427024 val_auroc:  0.7295041728031418 val_auprc:  0.872455677013977
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.682242621874418 val_auroc:  0.7434953362788413 val_auprc:  0.8809094344897148
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.7246795893300292 val_auroc:  0.7382179675994108 val_auprc:  0.8714429433489514
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.6041463217968589 val_auroc:  0.7660775650466372 val_auprc:  0.8945457602911471
EarlyStopping counter: 7 out of 50
epoch:  8
epoch:  9 val_f1:  0.684049098994562 val_auroc:  0.7709867452135493 val_auprc:  0.8991037369303763
EarlyStopping counter: 8 out of 50
epoch:  9
epoch:  10 val_f1:  0.7166299330477814 val_auroc:  0.7778595974472263 val_auprc:  0.9036860020147645
Validation loss improved to 2.188990
epoch:  10
epoch:  11 val_f1:  0.681579990245092 val_auroc:  0.7884143348060875 val_auprc:  0.9092001980551884
Validation loss improved to 1.979422
epoch:  11
epoch:  12 val_f1:  0.7029258641632973 val_auroc:  0.79553264604811 val_auprc:  0.9130518550397205
Validation loss improved to 1.782844
epoch:  12
epoch:  13 val_f1:  0.7289242247644242 val_auroc:  0.7974963181148749 val_auprc:  0.91395057670936
Validation loss improved to 1.525623
epoch:  13
epoch:  14 val_f1:  0.730071543320129 val_auroc:  0.797987236131566 val_auprc:  0.9143201799910373
Validation loss improved to 1.411099
epoch:  14
epoch:  15 val_f1:  0.6963686193902022 val_auroc:  0.8004418262150221 val_auprc:  0.915307051698343
Validation loss improved to 1.337414
epoch:  15
epoch:  16 val_f1:  0.726175885795287 val_auroc:  0.8004418262150221 val_auprc:  0.9153999448787686
Validation loss improved to 1.275827
epoch:  16
epoch:  17 val_f1:  0.5557862334840752 val_auroc:  0.8085419734904271 val_auprc:  0.9193736322389034
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.7169642564307364 val_auroc:  0.8127147766323024 val_auprc:  0.922247796584374
Validation loss improved to 1.168658
epoch:  18
epoch:  19 val_f1:  0.7169009504644194 val_auroc:  0.8019145802650958 val_auprc:  0.9152761500652902
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.6580621620350778 val_auroc:  0.8041237113402062 val_auprc:  0.9157882976415663
EarlyStopping counter: 2 out of 50
epoch:  20
epoch:  21 val_f1:  0.41765629830050655 val_auroc:  0.8171330387825233 val_auprc:  0.9238494842925467
EarlyStopping counter: 3 out of 50
epoch:  21
epoch:  22 val_f1:  0.4882109350113894 val_auroc:  0.8156602847324498 val_auprc:  0.9240160191781666
EarlyStopping counter: 4 out of 50
epoch:  22
epoch:  23 val_f1:  0.7371484630477437 val_auroc:  0.8053510063819342 val_auprc:  0.9165797938403981
EarlyStopping counter: 5 out of 50
epoch:  23
epoch:  24 val_f1:  0.7757738305193033 val_auroc:  0.8146784486990672 val_auprc:  0.9224897812168501
EarlyStopping counter: 6 out of 50
epoch:  24
epoch:  25 val_f1:  0.7712620601193464 val_auroc:  0.8289150711831124 val_auprc:  0.9300700345847536
Validation loss improved to 1.131493
epoch:  25
epoch:  26 val_f1:  0.6720188084826255 val_auroc:  0.816151202749141 val_auprc:  0.9237082533916083
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7412236216203913 val_auroc:  0.8178694158075601 val_auprc:  0.9244014267753532
Validation loss improved to 1.130746
epoch:  27
epoch:  28 val_f1:  0.7648187281552264 val_auroc:  0.8195876288659795 val_auprc:  0.9250133345366098
Validation loss improved to 1.071433
epoch:  28
epoch:  29 val_f1:  0.7024482739389885 val_auroc:  0.8163966617574865 val_auprc:  0.9217855532675353
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.7140753816830194 val_auroc:  0.814187530682376 val_auprc:  0.9189862780597475
EarlyStopping counter: 2 out of 50
epoch:  30
epoch:  31 val_f1:  0.7737843767539161 val_auroc:  0.8213058419243986 val_auprc:  0.923853193710928
EarlyStopping counter: 3 out of 50
epoch:  31
epoch:  32 val_f1:  0.7711689349644636 val_auroc:  0.8446244477172313 val_auprc:  0.9389674281356188
Validation loss improved to 0.950397
epoch:  32
epoch:  33 val_f1:  0.7373258481337533 val_auroc:  0.8404516445753558 val_auprc:  0.9365359350874505
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.7298678635622811 val_auroc:  0.8242513500245459 val_auprc:  0.9248582288155968
EarlyStopping counter: 2 out of 50
epoch:  34
epoch:  35 val_f1:  0.7725930260576229 val_auroc:  0.8210603829160529 val_auprc:  0.9229358497620488
EarlyStopping counter: 3 out of 50
epoch:  35
epoch:  36 val_f1:  0.7691994463100789 val_auroc:  0.8215513009327443 val_auprc:  0.9232172444161186
EarlyStopping counter: 4 out of 50
epoch:  36
epoch:  37 val_f1:  0.7510257046352308 val_auroc:  0.8210603829160531 val_auprc:  0.922462364860604
EarlyStopping counter: 5 out of 50
epoch:  37
epoch:  38 val_f1:  0.7536081085870222 val_auroc:  0.8215513009327442 val_auprc:  0.9231810861944364
EarlyStopping counter: 6 out of 50
epoch:  38
epoch:  39 val_f1:  0.7762067639678805 val_auroc:  0.8264604810996563 val_auprc:  0.9274491168614835
Validation loss improved to 0.923501
epoch:  39
epoch:  40 val_f1:  0.7500864926036699 val_auroc:  0.8181148748159057 val_auprc:  0.9220232616423647
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.7622262794246104 val_auroc:  0.8109965635738832 val_auprc:  0.9168037067435055
EarlyStopping counter: 2 out of 50
epoch:  41
epoch:  42 val_f1:  0.7757738305193033 val_auroc:  0.8171330387825233 val_auprc:  0.9212376374860667
EarlyStopping counter: 3 out of 50
epoch:  42
epoch:  43 val_f1:  0.7681512331200245 val_auroc:  0.8136966126656848 val_auprc:  0.9187868792392233
EarlyStopping counter: 4 out of 50
epoch:  43
epoch:  44 val_f1:  0.6759950757759244 val_auroc:  0.8127147766323023 val_auprc:  0.9163110301759969
EarlyStopping counter: 5 out of 50
epoch:  44
epoch:  45 val_f1:  0.5736495549323253 val_auroc:  0.7810505645557192 val_auprc:  0.8933630024825614
EarlyStopping counter: 6 out of 50
epoch:  45
epoch:  46 val_f1:  0.7845295119922345 val_auroc:  0.8225331369661267 val_auprc:  0.922590065616476
EarlyStopping counter: 7 out of 50
epoch:  46
epoch:  47 val_f1:  0.7305606674969439 val_auroc:  0.8362788414334806 val_auprc:  0.9335623915481348
EarlyStopping counter: 8 out of 50
epoch:  47
epoch:  48 val_f1:  0.6324215845256547 val_auroc:  0.8183603338242513 val_auprc:  0.9210734711852904
EarlyStopping counter: 9 out of 50
epoch:  48
epoch:  49 val_f1:  0.735514445586388 val_auroc:  0.7947962690230732 val_auprc:  0.904882220114382
EarlyStopping counter: 10 out of 50
epoch:  49
epoch:  50 val_f1:  0.7536081085870222 val_auroc:  0.826705940108002 val_auprc:  0.9257999169033052
EarlyStopping counter: 11 out of 50
epoch:  50
epoch:  51 val_f1:  0.7144317414801258 val_auroc:  0.8389788905252823 val_auprc:  0.934320090480524
EarlyStopping counter: 12 out of 50
epoch:  51
epoch:  52 val_f1:  0.7617596949267598 val_auroc:  0.8082965144820815 val_auprc:  0.9133429425198214
EarlyStopping counter: 13 out of 50
epoch:  52
epoch:  53 val_f1:  0.7307106601978622 val_auroc:  0.8046146293568973 val_auprc:  0.9094434463314274
EarlyStopping counter: 14 out of 50
epoch:  53
epoch:  54 val_f1:  0.8010188978004199 val_auroc:  0.8144329896907216 val_auprc:  0.9168853738509395
EarlyStopping counter: 15 out of 50
epoch:  54
epoch:  55 val_f1:  0.7879228532067962 val_auroc:  0.8200785468826706 val_auprc:  0.9220255974608466
EarlyStopping counter: 16 out of 50
epoch:  55
epoch:  56 val_f1:  0.7622262794246104 val_auroc:  0.8195876288659795 val_auprc:  0.9207593576991735
EarlyStopping counter: 17 out of 50
epoch:  56
epoch:  57 val_f1:  0.7707245329923307 val_auroc:  0.8181148748159056 val_auprc:  0.9180332741484859
EarlyStopping counter: 18 out of 50
epoch:  57
epoch:  58 val_f1:  0.7765831291011147 val_auroc:  0.825478645066274 val_auprc:  0.9262291394891161
EarlyStopping counter: 19 out of 50
epoch:  58
epoch:  59 val_f1:  0.7737843767539161 val_auroc:  0.8225331369661266 val_auprc:  0.9218849539219583
EarlyStopping counter: 20 out of 50
epoch:  59
epoch:  60 val_f1:  0.7552115339652351 val_auroc:  0.8176239567992145 val_auprc:  0.9207757835869927
EarlyStopping counter: 21 out of 50
epoch:  60
epoch:  61 val_f1:  0.7377728985642654 val_auroc:  0.8154148257241041 val_auprc:  0.918597660745378
EarlyStopping counter: 22 out of 50
epoch:  61
epoch:  62 val_f1:  0.7691994463100789 val_auroc:  0.8208149239077074 val_auprc:  0.9198156670989337
EarlyStopping counter: 23 out of 50
epoch:  62
epoch:  63 val_f1:  0.7802930475309426 val_auroc:  0.821060382916053 val_auprc:  0.9228254487596929
EarlyStopping counter: 24 out of 50
epoch:  63
epoch:  64 val_f1:  0.7412236216203913 val_auroc:  0.81173294059892 val_auprc:  0.915595762991115
EarlyStopping counter: 25 out of 50
epoch:  64
epoch:  65 val_f1:  0.7802930475309426 val_auroc:  0.8178694158075602 val_auprc:  0.9191591598092459
EarlyStopping counter: 26 out of 50
epoch:  65
epoch:  66 val_f1:  0.7748796193569787 val_auroc:  0.8195876288659795 val_auprc:  0.9215591055558118
EarlyStopping counter: 27 out of 50
epoch:  66
epoch:  67 val_f1:  0.6966777045653197 val_auroc:  0.8220422189494355 val_auprc:  0.9236122523659335
EarlyStopping counter: 28 out of 50
epoch:  67
epoch:  68 val_f1:  0.7790721385700611 val_auroc:  0.8215513009327442 val_auprc:  0.9241405197572494
EarlyStopping counter: 29 out of 50
epoch:  68
epoch:  69 val_f1:  0.7802930475309426 val_auroc:  0.8144329896907216 val_auprc:  0.9184086523070474
EarlyStopping counter: 30 out of 50
epoch:  69
epoch:  70 val_f1:  0.7725930260576229 val_auroc:  0.8124693176239567 val_auprc:  0.9170745219115257
EarlyStopping counter: 31 out of 50
epoch:  70
epoch:  71 val_f1:  0.7622262794246104 val_auroc:  0.8200785468826707 val_auprc:  0.9209372485712852
EarlyStopping counter: 32 out of 50
epoch:  71
epoch:  72 val_f1:  0.7500864926036699 val_auroc:  0.8247422680412371 val_auprc:  0.9235827255239539
EarlyStopping counter: 33 out of 50
epoch:  72
epoch:  73 val_f1:  0.7920536597238516 val_auroc:  0.8166421207658322 val_auprc:  0.9193284387740335
EarlyStopping counter: 34 out of 50
epoch:  73
epoch:  74 val_f1:  0.7643829551743221 val_auroc:  0.8232695139911634 val_auprc:  0.9212916448558297
EarlyStopping counter: 35 out of 50
epoch:  74
epoch:  75 val_f1:  0.7683026725960121 val_auroc:  0.8220422189494354 val_auprc:  0.9220991793027171
EarlyStopping counter: 36 out of 50
epoch:  75
epoch:  76 val_f1:  0.7868059619290214 val_auroc:  0.8225331369661267 val_auprc:  0.9228147342883277
EarlyStopping counter: 37 out of 50
epoch:  76
epoch:  77 val_f1:  0.7770871369605723 val_auroc:  0.8230240549828179 val_auprc:  0.9223933670724724
EarlyStopping counter: 38 out of 50
epoch:  77
epoch:  78 val_f1:  0.799854302604428 val_auroc:  0.8200785468826706 val_auprc:  0.9216142127207394
EarlyStopping counter: 39 out of 50
epoch:  78
epoch:  79 val_f1:  0.7841726618705036 val_auroc:  0.825478645066274 val_auprc:  0.9250866652076714
EarlyStopping counter: 40 out of 50
epoch:  79
epoch:  80 val_f1:  0.7762067639678805 val_auroc:  0.8333333333333334 val_auprc:  0.9292269634238588
EarlyStopping counter: 41 out of 50
epoch:  80
epoch:  81 val_f1:  0.7691994463100789 val_auroc:  0.8195876288659795 val_auprc:  0.9212478065358044
EarlyStopping counter: 42 out of 50
epoch:  81
epoch:  82 val_f1:  0.7598715939807772 val_auroc:  0.8200785468826707 val_auprc:  0.9207805538437595
EarlyStopping counter: 43 out of 50
epoch:  82
epoch:  83 val_f1:  0.7583300796647482 val_auroc:  0.8303878252331861 val_auprc:  0.9288178847859321
EarlyStopping counter: 44 out of 50
epoch:  83
epoch:  84 val_f1:  0.7598715939807772 val_auroc:  0.829160530191458 val_auprc:  0.9276815139884855
EarlyStopping counter: 45 out of 50
epoch:  84
epoch:  85 val_f1:  0.7841726618705036 val_auroc:  0.8154148257241041 val_auprc:  0.9187415325465376
EarlyStopping counter: 46 out of 50
epoch:  85
epoch:  86 val_f1:  0.7933255489848959 val_auroc:  0.8200785468826707 val_auprc:  0.9212322077441641
EarlyStopping counter: 47 out of 50
epoch:  86
epoch:  87 val_f1:  0.7868059619290214 val_auroc:  0.8247422680412373 val_auprc:  0.9237127074890732
EarlyStopping counter: 48 out of 50
epoch:  87
epoch:  88 val_f1:  0.7868059619290214 val_auroc:  0.8252331860579283 val_auprc:  0.9249798049996785
EarlyStopping counter: 49 out of 50
epoch:  88
epoch:  89 val_f1:  0.7809570525397864 val_auroc:  0.8215513009327442 val_auprc:  0.9220953187972649
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  2561.8435502052307
{'time_elapsed': [2561.8435502052307], 'epoch': [88], 'fold': [0], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7809570525397864], 'auroc_test': [0.8215513009327442], 'auprc_test': [0.9220953187972649]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1278]          6,144
│    └─BatchNorm1d: 2-2                  [64, 1024, 1278]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1278]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1274]          --
│    └─Dropout: 2-5                      [64, 1024, 1274]          --
│    └─Flatten: 2-6                      [64, 1304576]             --
│    └─Linear: 2-7                       [64, 1]                   1,304,577
==========================================================================================
Total params: 1,312,769
Trainable params: 1,312,769
Non-trainable params: 0
Total mult-adds (M): 586.15
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1340.08
Params size (MB): 5.25
Estimated Total Size (MB): 1345.66
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.516953950006809 val_auroc:  0.6179430535100637 val_auprc:  0.7926841835109318
epoch:  1
epoch:  2 val_f1:  0.328035071942446 val_auroc:  0.6104565537555229 val_auprc:  0.7605777020748103
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6810705528674974 val_auroc:  0.6493618065783014 val_auprc:  0.8406681089498906
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.49507194244604313 val_auroc:  0.6151202749140893 val_auprc:  0.7754561927920398
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.3902385961984347 val_auroc:  0.6254295532646048 val_auprc:  0.7727104827697427
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.45189694398327496 val_auroc:  0.6381934216985764 val_auprc:  0.779513120028499
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.3967869291117542 val_auroc:  0.657093765341188 val_auprc:  0.7800835614285272
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.5371492805755396 val_auroc:  0.6806578301423662 val_auprc:  0.7877964480374728
EarlyStopping counter: 7 out of 50
epoch:  8
epoch:  9 val_f1:  0.698190734000651 val_auroc:  0.7131811487481591 val_auprc:  0.845181009226693
Validation loss improved to 0.537135
epoch:  9
epoch:  10 val_f1:  0.4978104472943385 val_auroc:  0.7204221894943544 val_auprc:  0.8220869268664901
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.5838273142196633 val_auroc:  0.7452135493372606 val_auprc:  0.845618984744896
EarlyStopping counter: 2 out of 50
epoch:  11
epoch:  12 val_f1:  0.7648187281552264 val_auroc:  0.758713794796269 val_auprc:  0.8632424087793202
EarlyStopping counter: 3 out of 50
epoch:  12
epoch:  13 val_f1:  0.730071543320129 val_auroc:  0.7702503681885126 val_auprc:  0.873434212984914
EarlyStopping counter: 4 out of 50
epoch:  13
epoch:  14 val_f1:  0.7617684906754855 val_auroc:  0.776755031909671 val_auprc:  0.876041089933875
Validation loss improved to 0.454896
epoch:  14
epoch:  15 val_f1:  0.710128282915836 val_auroc:  0.7842415316642121 val_auprc:  0.8826910590580819
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.6605237452657186 val_auroc:  0.7906234658811978 val_auprc:  0.8882280751112751
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.45280186134244294 val_auroc:  0.7943053510063819 val_auprc:  0.8914393662438732
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.43835312981286517 val_auroc:  0.7965144820814924 val_auprc:  0.8943570160998573
EarlyStopping counter: 4 out of 50
epoch:  18
epoch:  19 val_f1:  0.5323741007194245 val_auroc:  0.80166912125675 val_auprc:  0.8990396313390336
EarlyStopping counter: 5 out of 50
epoch:  19
epoch:  20 val_f1:  0.6459565936764723 val_auroc:  0.8041237113402062 val_auprc:  0.9010175005079719
EarlyStopping counter: 6 out of 50
epoch:  20
epoch:  21 val_f1:  0.7745465218349855 val_auroc:  0.8033873343151695 val_auprc:  0.901560823440799
EarlyStopping counter: 7 out of 50
epoch:  21
epoch:  22 val_f1:  0.6689862395797648 val_auroc:  0.8049828178694158 val_auprc:  0.8987382923556426
EarlyStopping counter: 8 out of 50
epoch:  22
epoch:  23 val_f1:  0.7346160281077464 val_auroc:  0.814187530682376 val_auprc:  0.9065276199235197
EarlyStopping counter: 9 out of 50
epoch:  23
epoch:  24 val_f1:  0.6503552063019382 val_auroc:  0.8189739813451153 val_auprc:  0.908157078835642
EarlyStopping counter: 10 out of 50
epoch:  24
epoch:  25 val_f1:  0.7911956149366222 val_auroc:  0.822287677957781 val_auprc:  0.9130452073630149
EarlyStopping counter: 11 out of 50
epoch:  25
epoch:  26 val_f1:  0.7920536597238516 val_auroc:  0.8205694648993619 val_auprc:  0.9138561863913149
Validation loss improved to 0.450963
epoch:  26
epoch:  27 val_f1:  0.6019040561542183 val_auroc:  0.832965144820815 val_auprc:  0.9192692499643405
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.6314554877236647 val_auroc:  0.8270741286205204 val_auprc:  0.9179609209631674
EarlyStopping counter: 2 out of 50
epoch:  28
epoch:  29 val_f1:  0.5901444900487328 val_auroc:  0.8125920471281296 val_auprc:  0.908587652979331
EarlyStopping counter: 3 out of 50
epoch:  29
epoch:  30 val_f1:  0.7831873586549224 val_auroc:  0.8259695630829651 val_auprc:  0.9215495068845516
EarlyStopping counter: 4 out of 50
epoch:  30
epoch:  31 val_f1:  0.7845295119922345 val_auroc:  0.8330878743249878 val_auprc:  0.9245424653721342
EarlyStopping counter: 5 out of 50
epoch:  31
epoch:  32 val_f1:  0.7170655771870609 val_auroc:  0.8313696612665685 val_auprc:  0.9214416400922312
EarlyStopping counter: 6 out of 50
epoch:  32
epoch:  33 val_f1:  0.7985611510791367 val_auroc:  0.8340697103583702 val_auprc:  0.9215606764331057
Validation loss improved to 0.338762
epoch:  33
epoch:  34 val_f1:  0.8218323698145653 val_auroc:  0.8291605301914581 val_auprc:  0.9178447156746454
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.72389147505525 val_auroc:  0.8259695630829652 val_auprc:  0.9182571198766845
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.777854660092151 val_auroc:  0.8276877761413843 val_auprc:  0.9191174678302558
EarlyStopping counter: 3 out of 50
epoch:  36
epoch:  37 val_f1:  0.7971323289800215 val_auroc:  0.8289150711831124 val_auprc:  0.9184732682485474
Validation loss improved to 0.277995
epoch:  37
epoch:  38 val_f1:  0.8029873436454202 val_auroc:  0.8286696121747669 val_auprc:  0.9180547208018544
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.6019040561542183 val_auroc:  0.8281786941580755 val_auprc:  0.9175618931414646
EarlyStopping counter: 2 out of 50
epoch:  39
epoch:  40 val_f1:  0.7809570525397864 val_auroc:  0.8225331369661266 val_auprc:  0.915146275618935
EarlyStopping counter: 3 out of 50
epoch:  40
epoch:  41 val_f1:  0.7573003855683703 val_auroc:  0.8225331369661266 val_auprc:  0.9151026438747143
EarlyStopping counter: 4 out of 50
epoch:  41
epoch:  42 val_f1:  0.806394786639448 val_auroc:  0.832351497299951 val_auprc:  0.92082933848742
EarlyStopping counter: 5 out of 50
epoch:  42
epoch:  43 val_f1:  0.6120424115607032 val_auroc:  0.8377515954835543 val_auprc:  0.921954180931755
EarlyStopping counter: 6 out of 50
epoch:  43
epoch:  44 val_f1:  0.7685409504908388 val_auroc:  0.834806087383407 val_auprc:  0.9212519345931486
EarlyStopping counter: 7 out of 50
epoch:  44
epoch:  45 val_f1:  0.7185321510233673 val_auroc:  0.8387334315169367 val_auprc:  0.9233981031038352
EarlyStopping counter: 8 out of 50
epoch:  45
epoch:  46 val_f1:  0.5901444900487328 val_auroc:  0.8112420225822288 val_auprc:  0.9160057708820775
EarlyStopping counter: 9 out of 50
epoch:  46
epoch:  47 val_f1:  0.23980974371696281 val_auroc:  0.8188512518409425 val_auprc:  0.9191144640356669
EarlyStopping counter: 10 out of 50
epoch:  47
epoch:  48 val_f1:  0.7483101088021195 val_auroc:  0.8265832106038291 val_auprc:  0.9247094814128898
EarlyStopping counter: 11 out of 50
epoch:  48
epoch:  49 val_f1:  0.7944676896257205 val_auroc:  0.835419734904271 val_auprc:  0.9280671873412972
EarlyStopping counter: 12 out of 50
epoch:  49
epoch:  50 val_f1:  0.6580621620350778 val_auroc:  0.8340697103583702 val_auprc:  0.9240871923892277
EarlyStopping counter: 13 out of 50
epoch:  50
epoch:  51 val_f1:  0.612555769145391 val_auroc:  0.820446735395189 val_auprc:  0.9155561180541012
EarlyStopping counter: 14 out of 50
epoch:  51
epoch:  52 val_f1:  0.7917387438363913 val_auroc:  0.8362788414334806 val_auprc:  0.926438446632483
EarlyStopping counter: 15 out of 50
epoch:  52
epoch:  53 val_f1:  0.702570289683208 val_auroc:  0.8343151693667158 val_auprc:  0.9263978813272685
EarlyStopping counter: 16 out of 50
epoch:  53
epoch:  54 val_f1:  0.7420346526768117 val_auroc:  0.8324742268041238 val_auprc:  0.9249802768269639
EarlyStopping counter: 17 out of 50
epoch:  54
epoch:  55 val_f1:  0.6810035515891084 val_auroc:  0.8301423662248404 val_auprc:  0.9224576357481459
EarlyStopping counter: 18 out of 50
epoch:  55
epoch:  56 val_f1:  0.7954863587533922 val_auroc:  0.8278105056455572 val_auprc:  0.9203749248172081
EarlyStopping counter: 19 out of 50
epoch:  56
epoch:  57 val_f1:  0.7770871369605723 val_auroc:  0.8170103092783504 val_auprc:  0.9121556259717689
EarlyStopping counter: 20 out of 50
epoch:  57
epoch:  58 val_f1:  0.7513203127712835 val_auroc:  0.8301423662248405 val_auprc:  0.9207113954238687
EarlyStopping counter: 21 out of 50
epoch:  58
epoch:  59 val_f1:  0.7150244694526511 val_auroc:  0.8275650466372115 val_auprc:  0.9178908294831483
EarlyStopping counter: 22 out of 50
epoch:  59
epoch:  60 val_f1:  0.7933255489848959 val_auroc:  0.8318605792832597 val_auprc:  0.9223919548465667
EarlyStopping counter: 23 out of 50
epoch:  60
epoch:  61 val_f1:  0.7711689349644636 val_auroc:  0.832842415316642 val_auprc:  0.9191978263060184
EarlyStopping counter: 24 out of 50
epoch:  61
epoch:  62 val_f1:  0.7598715939807772 val_auroc:  0.8371379479626901 val_auprc:  0.9206199384362828
Validation loss improved to 0.158599
epoch:  62
epoch:  63 val_f1:  0.7140753816830194 val_auroc:  0.8308787432498772 val_auprc:  0.9166876229806677
EarlyStopping counter: 1 out of 50
epoch:  63
epoch:  64 val_f1:  0.7559325673789327 val_auroc:  0.832965144820815 val_auprc:  0.9191755316739005
EarlyStopping counter: 2 out of 50
epoch:  64
epoch:  65 val_f1:  0.7169642564307364 val_auroc:  0.8296514482081493 val_auprc:  0.9159756764191271
EarlyStopping counter: 3 out of 50
epoch:  65
epoch:  66 val_f1:  0.642965963048511 val_auroc:  0.8271968581246932 val_auprc:  0.9143210245838697
EarlyStopping counter: 4 out of 50
epoch:  66
epoch:  67 val_f1:  0.743396428458658 val_auroc:  0.8340697103583702 val_auprc:  0.9225042289352292
EarlyStopping counter: 5 out of 50
epoch:  67
epoch:  68 val_f1:  0.742136387976997 val_auroc:  0.8338242513500245 val_auprc:  0.9239533023706533
EarlyStopping counter: 6 out of 50
epoch:  68
epoch:  69 val_f1:  0.799854302604428 val_auroc:  0.8327196858124692 val_auprc:  0.9201074479151325
EarlyStopping counter: 7 out of 50
epoch:  69
epoch:  70 val_f1:  0.6977368320649064 val_auroc:  0.8362788414334805 val_auprc:  0.9199728515652678
EarlyStopping counter: 8 out of 50
epoch:  70
epoch:  71 val_f1:  0.7199392779354498 val_auroc:  0.8307560137457045 val_auprc:  0.9171077427126346
EarlyStopping counter: 9 out of 50
epoch:  71
epoch:  72 val_f1:  0.766354189375772 val_auroc:  0.8208149239077075 val_auprc:  0.9098287152559048
EarlyStopping counter: 10 out of 50
epoch:  72
epoch:  73 val_f1:  0.694872962389582 val_auroc:  0.8426607756504665 val_auprc:  0.9241050693827237
EarlyStopping counter: 11 out of 50
epoch:  73
epoch:  74 val_f1:  0.7868059619290214 val_auroc:  0.8403289150711831 val_auprc:  0.9237427949741424
EarlyStopping counter: 12 out of 50
epoch:  74
epoch:  75 val_f1:  0.7576689161509443 val_auroc:  0.8334560628375061 val_auprc:  0.9181861429489258
Validation loss improved to 0.109339
epoch:  75
epoch:  76 val_f1:  0.7712620601193464 val_auroc:  0.8394698085419735 val_auprc:  0.9230779981367071
EarlyStopping counter: 1 out of 50
epoch:  76
epoch:  77 val_f1:  0.7802930475309426 val_auroc:  0.8411880216003927 val_auprc:  0.9242067668405912
EarlyStopping counter: 2 out of 50
epoch:  77
epoch:  78 val_f1:  0.799854302604428 val_auroc:  0.8426607756504664 val_auprc:  0.9228649875268573
EarlyStopping counter: 3 out of 50
epoch:  78
epoch:  79 val_f1:  0.7745465218349855 val_auroc:  0.8364015709376534 val_auprc:  0.9162373760070203
EarlyStopping counter: 4 out of 50
epoch:  79
epoch:  80 val_f1:  0.7855164986057286 val_auroc:  0.8287923416789397 val_auprc:  0.9101726715377875
EarlyStopping counter: 5 out of 50
epoch:  80
epoch:  81 val_f1:  0.7560320485424044 val_auroc:  0.8237604320078546 val_auprc:  0.9040532465585084
EarlyStopping counter: 6 out of 50
epoch:  81
epoch:  82 val_f1:  0.7140753816830194 val_auroc:  0.8287923416789397 val_auprc:  0.9135874185513879
EarlyStopping counter: 7 out of 50
epoch:  82
epoch:  83 val_f1:  0.7813819697019021 val_auroc:  0.8224104074619538 val_auprc:  0.9014658263596184
EarlyStopping counter: 8 out of 50
epoch:  83
epoch:  84 val_f1:  0.7955599157038007 val_auroc:  0.821060382916053 val_auprc:  0.9057408834414375
EarlyStopping counter: 9 out of 50
epoch:  84
epoch:  85 val_f1:  0.7777125328082551 val_auroc:  0.8311242022582228 val_auprc:  0.9071443923273711
EarlyStopping counter: 10 out of 50
epoch:  85
epoch:  86 val_f1:  0.7699730743399811 val_auroc:  0.825478645066274 val_auprc:  0.9077198264507664
EarlyStopping counter: 11 out of 50
epoch:  86
epoch:  87 val_f1:  0.6540527577937649 val_auroc:  0.830387825233186 val_auprc:  0.9160413214039516
EarlyStopping counter: 12 out of 50
epoch:  87
epoch:  88 val_f1:  0.7082463061808618 val_auroc:  0.8210603829160531 val_auprc:  0.9114811363179852
EarlyStopping counter: 13 out of 50
epoch:  88
epoch:  89 val_f1:  0.7727225509205256 val_auroc:  0.8275650466372116 val_auprc:  0.909621571367163
EarlyStopping counter: 14 out of 50
epoch:  89
epoch:  90 val_f1:  0.7672775806504117 val_auroc:  0.8267059401080019 val_auprc:  0.9062519907019062
EarlyStopping counter: 15 out of 50
epoch:  90
epoch:  91 val_f1:  0.76000113614692 val_auroc:  0.8298969072164948 val_auprc:  0.9085718684539237
EarlyStopping counter: 16 out of 50
epoch:  91
epoch:  92 val_f1:  0.7855581813618873 val_auroc:  0.8311242022582228 val_auprc:  0.9123641340899195
EarlyStopping counter: 17 out of 50
epoch:  92
epoch:  93 val_f1:  0.7971323289800215 val_auroc:  0.8327196858124694 val_auprc:  0.9139803672029617
EarlyStopping counter: 18 out of 50
epoch:  93
epoch:  94 val_f1:  0.7748796193569787 val_auroc:  0.8267059401080019 val_auprc:  0.9087144795791806
EarlyStopping counter: 19 out of 50
epoch:  94
epoch:  95 val_f1:  0.7855581813618873 val_auroc:  0.8294059891998036 val_auprc:  0.9106130656076745
EarlyStopping counter: 20 out of 50
epoch:  95
epoch:  96 val_f1:  0.7823449348629204 val_auroc:  0.8291605301914581 val_auprc:  0.9053879024090772
EarlyStopping counter: 21 out of 50
epoch:  96
epoch:  97 val_f1:  0.7286063672426545 val_auroc:  0.8244968090328916 val_auprc:  0.9098464426565319
EarlyStopping counter: 22 out of 50
epoch:  97
epoch:  98 val_f1:  0.7725930260576229 val_auroc:  0.8238831615120275 val_auprc:  0.9061059004717543
EarlyStopping counter: 23 out of 50
epoch:  98
epoch:  99 val_f1:  0.7791090204759269 val_auroc:  0.8203240058910161 val_auprc:  0.9079460188422249
EarlyStopping counter: 24 out of 50
epoch:  99
epoch:  100 val_f1:  0.7707245329923307 val_auroc:  0.8262150220913107 val_auprc:  0.9104546584888797
EarlyStopping counter: 25 out of 50
epoch:  100
epoch:  101 val_f1:  0.7770871369605723 val_auroc:  0.8227785959744723 val_auprc:  0.9051235494809452
EarlyStopping counter: 26 out of 50
epoch:  101
epoch:  102 val_f1:  0.787641731275174 val_auroc:  0.8220422189494354 val_auprc:  0.9055989712182582
EarlyStopping counter: 27 out of 50
epoch:  102
epoch:  103 val_f1:  0.7777125328082551 val_auroc:  0.8219194894452626 val_auprc:  0.9055049158562504
EarlyStopping counter: 28 out of 50
epoch:  103
epoch:  104 val_f1:  0.7841726618705036 val_auroc:  0.8206921944035346 val_auprc:  0.9063380801169452
EarlyStopping counter: 29 out of 50
epoch:  104
epoch:  105 val_f1:  0.7873856121514594 val_auroc:  0.8252331860579283 val_auprc:  0.9080435792301718
EarlyStopping counter: 30 out of 50
epoch:  105
epoch:  106 val_f1:  0.7955599157038007 val_auroc:  0.8227785959744723 val_auprc:  0.9025809632829273
EarlyStopping counter: 31 out of 50
epoch:  106
epoch:  107 val_f1:  0.7648187281552264 val_auroc:  0.8221649484536082 val_auprc:  0.9045471828541032
EarlyStopping counter: 32 out of 50
epoch:  107
epoch:  108 val_f1:  0.7712620601193464 val_auroc:  0.8264604810996563 val_auprc:  0.9078758539265204
EarlyStopping counter: 33 out of 50
epoch:  108
epoch:  109 val_f1:  0.7545102379634754 val_auroc:  0.8213058419243985 val_auprc:  0.9067329498665953
EarlyStopping counter: 34 out of 50
epoch:  109
epoch:  110 val_f1:  0.7841726618705036 val_auroc:  0.820446735395189 val_auprc:  0.9062702549032655
EarlyStopping counter: 35 out of 50
epoch:  110
epoch:  111 val_f1:  0.7809570525397864 val_auroc:  0.822287677957781 val_auprc:  0.9027722632992825
EarlyStopping counter: 36 out of 50
epoch:  111
epoch:  112 val_f1:  0.7855164986057286 val_auroc:  0.8237604320078546 val_auprc:  0.9062528685972173
EarlyStopping counter: 37 out of 50
epoch:  112
epoch:  113 val_f1:  0.7841726618705036 val_auroc:  0.822287677957781 val_auprc:  0.9027581216133763
EarlyStopping counter: 38 out of 50
epoch:  113
epoch:  114 val_f1:  0.7841726618705036 val_auroc:  0.8240058910162003 val_auprc:  0.9033631510148008
EarlyStopping counter: 39 out of 50
epoch:  114
epoch:  115 val_f1:  0.7841726618705036 val_auroc:  0.8215513009327442 val_auprc:  0.902328375675292
EarlyStopping counter: 40 out of 50
epoch:  115
epoch:  116 val_f1:  0.7841726618705036 val_auroc:  0.8217967599410898 val_auprc:  0.9024323691452927
EarlyStopping counter: 41 out of 50
epoch:  116
epoch:  117 val_f1:  0.7745465218349855 val_auroc:  0.8240058910162003 val_auprc:  0.9035555171629199
EarlyStopping counter: 42 out of 50
epoch:  117
epoch:  118 val_f1:  0.7841726618705036 val_auroc:  0.8225331369661267 val_auprc:  0.9028913555755319
EarlyStopping counter: 43 out of 50
epoch:  118
epoch:  119 val_f1:  0.7770871369605723 val_auroc:  0.8242513500245459 val_auprc:  0.9064133059536978
EarlyStopping counter: 44 out of 50
epoch:  119
epoch:  120 val_f1:  0.7873856121514594 val_auroc:  0.8232695139911634 val_auprc:  0.9055062002728592
EarlyStopping counter: 45 out of 50
epoch:  120
epoch:  121 val_f1:  0.7809570525397864 val_auroc:  0.8230240549828178 val_auprc:  0.9062261705436045
EarlyStopping counter: 46 out of 50
epoch:  121
epoch:  122 val_f1:  0.7873856121514594 val_auroc:  0.8237604320078546 val_auprc:  0.905029965279401
EarlyStopping counter: 47 out of 50
epoch:  122
epoch:  123 val_f1:  0.7748796193569787 val_auroc:  0.8257241040746195 val_auprc:  0.9072664010297375
EarlyStopping counter: 48 out of 50
epoch:  123
epoch:  124 val_f1:  0.7685409504908388 val_auroc:  0.8226558664702994 val_auprc:  0.9073264416120932
EarlyStopping counter: 49 out of 50
epoch:  124
epoch:  125 val_f1:  0.7685409504908388 val_auroc:  0.823514972999509 val_auprc:  0.9073799856548974
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  3519.5692522525787
{'time_elapsed': [3519.5692522525787], 'epoch': [124], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7685409504908388], 'auroc_test': [0.823514972999509], 'auprc_test': [0.9073799856548974]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1278]          6,144
│    └─BatchNorm1d: 2-2                  [64, 1024, 1278]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1278]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1274]          --
│    └─Dropout: 2-5                      [64, 1024, 1274]          --
│    └─Flatten: 2-6                      [64, 1304576]             --
│    └─Linear: 2-7                       [64, 1]                   1,304,577
==========================================================================================
Total params: 1,312,769
Trainable params: 1,312,769
Non-trainable params: 0
Total mult-adds (M): 586.15
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1340.08
Params size (MB): 5.25
Estimated Total Size (MB): 1345.66
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.6043200785468826 val_auprc:  0.8102652228640813
epoch:  1
epoch:  2 val_f1:  0.5857532631262036 val_auroc:  0.5549828178694158 val_auprc:  0.7926556675653248
Validation loss improved to 3.664891
epoch:  2
epoch:  3 val_f1:  0.5683453237410072 val_auroc:  0.5616102110947472 val_auprc:  0.8060901784134558
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6056190098210977 val_auroc:  0.5770741286205203 val_auprc:  0.8070923174371332
EarlyStopping counter: 2 out of 50
epoch:  4
epoch:  5 val_f1:  0.6241521068859198 val_auroc:  0.6264113892979873 val_auprc:  0.8211174406377006
Validation loss improved to 2.859879
epoch:  5
epoch:  6 val_f1:  0.6427382463776877 val_auroc:  0.6503436426116839 val_auprc:  0.8335196102038358
Validation loss improved to 2.413991
epoch:  6
epoch:  7 val_f1:  0.6376535972729985 val_auroc:  0.7029945999018165 val_auprc:  0.8639276370605965
Validation loss improved to 2.224682
epoch:  7
epoch:  8 val_f1:  0.6409065302315272 val_auroc:  0.7093765341188022 val_auprc:  0.8613636646745556
Validation loss improved to 1.931510
epoch:  8
epoch:  9 val_f1:  0.6613382126668607 val_auroc:  0.7231222385861561 val_auprc:  0.8661517510294743
Validation loss improved to 1.478334
epoch:  9
epoch:  10 val_f1:  0.6262025972442385 val_auroc:  0.7334315169366716 val_auprc:  0.8714293278196757
Validation loss improved to 1.331015
epoch:  10
epoch:  11 val_f1:  0.7246795893300292 val_auroc:  0.739445262641139 val_auprc:  0.8719714569710401
Validation loss improved to 1.002684
epoch:  11
epoch:  12 val_f1:  0.6759950757759244 val_auroc:  0.7444771723122239 val_auprc:  0.8695478658514384
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.3514449261186385 val_auroc:  0.755031909671085 val_auprc:  0.880566130896544
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.6689862395797648 val_auroc:  0.7581001472754051 val_auprc:  0.8756477679288588
EarlyStopping counter: 3 out of 50
epoch:  14
epoch:  15 val_f1:  0.6532647299881614 val_auroc:  0.772459499263623 val_auprc:  0.8885105014551256
Validation loss improved to 0.988557
epoch:  15
epoch:  16 val_f1:  0.6754718212640907 val_auroc:  0.7614138438880708 val_auprc:  0.8775554989186913
Validation loss improved to 0.920892
epoch:  16
epoch:  17 val_f1:  0.682242621874418 val_auroc:  0.7594501718213058 val_auprc:  0.8773275546384325
Validation loss improved to 0.898816
epoch:  17
epoch:  18 val_f1:  0.7313689473952751 val_auroc:  0.7695139911634757 val_auprc:  0.8850471805781981
Validation loss improved to 0.770615
epoch:  18
epoch:  19 val_f1:  0.7359858855314679 val_auroc:  0.7739322533136966 val_auprc:  0.8861995494977143
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7543299271741869 val_auroc:  0.7744231713303878 val_auprc:  0.8835380897112963
EarlyStopping counter: 2 out of 50
epoch:  20
epoch:  21 val_f1:  0.7605350299199892 val_auroc:  0.7722140402552774 val_auprc:  0.882346518651792
EarlyStopping counter: 3 out of 50
epoch:  21
epoch:  22 val_f1:  0.7144317414801258 val_auroc:  0.770495827196858 val_auprc:  0.8872350576808891
Validation loss improved to 0.681997
epoch:  22
epoch:  23 val_f1:  0.7117994924448791 val_auroc:  0.7653411880216004 val_auprc:  0.8856350712853707
Validation loss improved to 0.586985
epoch:  23
epoch:  24 val_f1:  0.7506999051921254 val_auroc:  0.7820324005891016 val_auprc:  0.8923134609169074
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.5053701858578568 val_auroc:  0.7859597447226313 val_auprc:  0.8945709837737149
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.5526639557918883 val_auroc:  0.7665684830633285 val_auprc:  0.8872830774430052
EarlyStopping counter: 3 out of 50
epoch:  26
epoch:  27 val_f1:  0.3398212583117671 val_auroc:  0.760677466863034 val_auprc:  0.8815017415930596
EarlyStopping counter: 4 out of 50
epoch:  27
epoch:  28 val_f1:  0.3914126326057798 val_auroc:  0.7619047619047619 val_auprc:  0.8829213241093197
EarlyStopping counter: 5 out of 50
epoch:  28
epoch:  29 val_f1:  0.687028943170779 val_auroc:  0.7789641629847815 val_auprc:  0.8969502395187995
EarlyStopping counter: 6 out of 50
epoch:  29
epoch:  30 val_f1:  0.49614561988662703 val_auroc:  0.7739322533136966 val_auprc:  0.8884240493740063
EarlyStopping counter: 7 out of 50
epoch:  30
epoch:  31 val_f1:  0.7150244694526511 val_auroc:  0.7536818851251841 val_auprc:  0.8705034069774865
EarlyStopping counter: 8 out of 50
epoch:  31
epoch:  32 val_f1:  0.6980913612614702 val_auroc:  0.7572410407461954 val_auprc:  0.8802794818077568
EarlyStopping counter: 9 out of 50
epoch:  32
epoch:  33 val_f1:  0.6614736591628271 val_auroc:  0.7717231222385862 val_auprc:  0.8853654353539879
EarlyStopping counter: 10 out of 50
epoch:  33
epoch:  34 val_f1:  0.7096701017564327 val_auroc:  0.756872852233677 val_auprc:  0.8706112041237412
EarlyStopping counter: 11 out of 50
epoch:  34
epoch:  35 val_f1:  0.7249644134959412 val_auroc:  0.7793323514973 val_auprc:  0.8886324636217828
EarlyStopping counter: 12 out of 50
epoch:  35
epoch:  36 val_f1:  0.6824751963135375 val_auroc:  0.7754050073637703 val_auprc:  0.8831027352113714
EarlyStopping counter: 13 out of 50
epoch:  36
epoch:  37 val_f1:  0.7298678635622811 val_auroc:  0.7739322533136966 val_auprc:  0.8809900506389376
EarlyStopping counter: 14 out of 50
epoch:  37
epoch:  38 val_f1:  0.7580594896895918 val_auroc:  0.7793323514973 val_auprc:  0.8857717087017491
EarlyStopping counter: 15 out of 50
epoch:  38
epoch:  39 val_f1:  0.7249644134959412 val_auroc:  0.7562592047128129 val_auprc:  0.8671479004331462
EarlyStopping counter: 16 out of 50
epoch:  39
epoch:  40 val_f1:  0.6945501576267077 val_auroc:  0.7690230731467845 val_auprc:  0.880800848472356
EarlyStopping counter: 17 out of 50
epoch:  40
epoch:  41 val_f1:  0.76000113614692 val_auroc:  0.7658321060382917 val_auprc:  0.8744325864372091
EarlyStopping counter: 18 out of 50
epoch:  41
epoch:  42 val_f1:  0.7238240177089098 val_auroc:  0.7641138929798723 val_auprc:  0.8747271221858142
EarlyStopping counter: 19 out of 50
epoch:  42
epoch:  43 val_f1:  0.707673860911271 val_auroc:  0.7636229749631811 val_auprc:  0.8752712109681338
EarlyStopping counter: 20 out of 50
epoch:  43
epoch:  44 val_f1:  0.39234290306345226 val_auroc:  0.759941089837997 val_auprc:  0.8733746163677849
EarlyStopping counter: 21 out of 50
epoch:  44
epoch:  45 val_f1:  0.5900086904324611 val_auroc:  0.7616593028964163 val_auprc:  0.8751742093730926
EarlyStopping counter: 22 out of 50
epoch:  45
epoch:  46 val_f1:  0.6541966426858513 val_auroc:  0.7800687285223368 val_auprc:  0.8967900096792492
EarlyStopping counter: 23 out of 50
epoch:  46
epoch:  47 val_f1:  0.7078050864958872 val_auroc:  0.7508591065292096 val_auprc:  0.8683181775112051
EarlyStopping counter: 24 out of 50
epoch:  47
epoch:  48 val_f1:  0.6882360925909661 val_auroc:  0.794305351006382 val_auprc:  0.8984033489874816
EarlyStopping counter: 25 out of 50
epoch:  48
epoch:  49 val_f1:  0.743396428458658 val_auroc:  0.7776141384388807 val_auprc:  0.881182403841813
EarlyStopping counter: 26 out of 50
epoch:  49
epoch:  50 val_f1:  0.6989956193979703 val_auroc:  0.7535591556210113 val_auprc:  0.86668331275216
EarlyStopping counter: 27 out of 50
epoch:  50
epoch:  51 val_f1:  0.7326256806616418 val_auroc:  0.7768777614138439 val_auprc:  0.8801671414755753
Validation loss improved to 0.538448
epoch:  51
epoch:  52 val_f1:  0.726400389202679 val_auroc:  0.7554000981836034 val_auprc:  0.8566543646511023
EarlyStopping counter: 1 out of 50
epoch:  52
epoch:  53 val_f1:  0.7426698176342648 val_auroc:  0.7763868433971527 val_auprc:  0.878885169206711
EarlyStopping counter: 2 out of 50
epoch:  53
epoch:  54 val_f1:  0.7313689473952751 val_auroc:  0.7579774177712322 val_auprc:  0.8641991002877979
EarlyStopping counter: 3 out of 50
epoch:  54
epoch:  55 val_f1:  0.7126420359039872 val_auroc:  0.7466863033873343 val_auprc:  0.8597768546128235
EarlyStopping counter: 4 out of 50
epoch:  55
epoch:  56 val_f1:  0.7349308245711123 val_auroc:  0.7572410407461954 val_auprc:  0.8667086123546289
EarlyStopping counter: 5 out of 50
epoch:  56
epoch:  57 val_f1:  0.722058496910722 val_auroc:  0.7447226313205695 val_auprc:  0.8510496289493893
EarlyStopping counter: 6 out of 50
epoch:  57
epoch:  58 val_f1:  0.7410071942446043 val_auroc:  0.7525773195876289 val_auprc:  0.8633716916380696
EarlyStopping counter: 7 out of 50
epoch:  58
epoch:  59 val_f1:  0.7057031525565856 val_auroc:  0.7530682376043201 val_auprc:  0.8627122002545289
EarlyStopping counter: 8 out of 50
epoch:  59
epoch:  60 val_f1:  0.7371484630477437 val_auroc:  0.7407952871870397 val_auprc:  0.851830325037072
EarlyStopping counter: 9 out of 50
epoch:  60
epoch:  61 val_f1:  0.7144317414801258 val_auroc:  0.7507363770250368 val_auprc:  0.8638103479789605
EarlyStopping counter: 10 out of 50
epoch:  61
epoch:  62 val_f1:  0.708480907581627 val_auroc:  0.7447226313205695 val_auprc:  0.8583201729291525
EarlyStopping counter: 11 out of 50
epoch:  62
epoch:  63 val_f1:  0.7363119073255568 val_auroc:  0.7469317623956799 val_auprc:  0.8589138522697357
EarlyStopping counter: 12 out of 50
epoch:  63
epoch:  64 val_f1:  0.6980913612614702 val_auroc:  0.7432498772704957 val_auprc:  0.854910044526008
EarlyStopping counter: 13 out of 50
epoch:  64
epoch:  65 val_f1:  0.7473302173830908 val_auroc:  0.749386352479136 val_auprc:  0.8589020507125048
EarlyStopping counter: 14 out of 50
epoch:  65
epoch:  66 val_f1:  0.7263486361521366 val_auroc:  0.7434953362788413 val_auprc:  0.8539711188805057
EarlyStopping counter: 15 out of 50
epoch:  66
epoch:  67 val_f1:  0.7473302173830908 val_auroc:  0.7427589592538046 val_auprc:  0.8528949438015501
EarlyStopping counter: 16 out of 50
epoch:  67
epoch:  68 val_f1:  0.743396428458658 val_auroc:  0.7427589592538046 val_auprc:  0.8512498947661771
EarlyStopping counter: 17 out of 50
epoch:  68
epoch:  69 val_f1:  0.7410071942446043 val_auroc:  0.740058910162003 val_auprc:  0.849512304447277
EarlyStopping counter: 18 out of 50
epoch:  69
epoch:  70 val_f1:  0.7346891520614657 val_auroc:  0.7376043200785468 val_auprc:  0.84820946058865
EarlyStopping counter: 19 out of 50
epoch:  70
epoch:  71 val_f1:  0.743396428458658 val_auroc:  0.7410407461953854 val_auprc:  0.8506839606331886
EarlyStopping counter: 20 out of 50
epoch:  71
epoch:  72 val_f1:  0.7536606851900262 val_auroc:  0.7373588610702012 val_auprc:  0.8477437733713848
EarlyStopping counter: 21 out of 50
epoch:  72
epoch:  73 val_f1:  0.7283736963917239 val_auroc:  0.7395679921453118 val_auprc:  0.8498770743031222
EarlyStopping counter: 22 out of 50
epoch:  73
epoch:  74 val_f1:  0.7283736963917239 val_auroc:  0.7383406971035837 val_auprc:  0.8483371712530787
EarlyStopping counter: 23 out of 50
epoch:  74
epoch:  75 val_f1:  0.7094198370570532 val_auroc:  0.7358861070201276 val_auprc:  0.8471298795587087
EarlyStopping counter: 24 out of 50
epoch:  75
epoch:  76 val_f1:  0.7030919944895149 val_auroc:  0.7373588610702012 val_auprc:  0.8468964646156345
EarlyStopping counter: 25 out of 50
epoch:  76
epoch:  77 val_f1:  0.722058496910722 val_auroc:  0.7444771723122239 val_auprc:  0.852328122819509
EarlyStopping counter: 26 out of 50
epoch:  77
epoch:  78 val_f1:  0.713247796930704 val_auroc:  0.7385861561119293 val_auprc:  0.8482950415095687
EarlyStopping counter: 27 out of 50
epoch:  78
epoch:  79 val_f1:  0.7454557504588546 val_auroc:  0.738831615120275 val_auprc:  0.8494898976410331
EarlyStopping counter: 28 out of 50
epoch:  79
epoch:  80 val_f1:  0.69663104467882 val_auroc:  0.7432498772704959 val_auprc:  0.8478246103613442
EarlyStopping counter: 29 out of 50
epoch:  80
epoch:  81 val_f1:  0.7426698176342648 val_auroc:  0.741899852724595 val_auprc:  0.845454417614365
EarlyStopping counter: 30 out of 50
epoch:  81
epoch:  82 val_f1:  0.7346891520614657 val_auroc:  0.7360088365243005 val_auprc:  0.8441686611740028
EarlyStopping counter: 31 out of 50
epoch:  82
epoch:  83 val_f1:  0.7094198370570532 val_auroc:  0.7344133529700541 val_auprc:  0.841330284534933
EarlyStopping counter: 32 out of 50
epoch:  83
epoch:  84 val_f1:  0.7346891520614657 val_auroc:  0.7416543937162494 val_auprc:  0.848296157862416
EarlyStopping counter: 33 out of 50
epoch:  84
epoch:  85 val_f1:  0.7410071942446043 val_auroc:  0.7363770250368189 val_auprc:  0.8444880249751706
EarlyStopping counter: 34 out of 50
epoch:  85
epoch:  86 val_f1:  0.7346891520614657 val_auroc:  0.7398134511536574 val_auprc:  0.8484339997881862
EarlyStopping counter: 35 out of 50
epoch:  86
epoch:  87 val_f1:  0.7410071942446043 val_auroc:  0.740672557682867 val_auprc:  0.848338447250721
EarlyStopping counter: 36 out of 50
epoch:  87
epoch:  88 val_f1:  0.7410071942446043 val_auroc:  0.7390770741286204 val_auprc:  0.8456938639433309
EarlyStopping counter: 37 out of 50
epoch:  88
epoch:  89 val_f1:  0.7454557504588546 val_auroc:  0.7421453117329406 val_auprc:  0.8504472418228474
EarlyStopping counter: 38 out of 50
epoch:  89
epoch:  90 val_f1:  0.7283736963917239 val_auroc:  0.7368679430535101 val_auprc:  0.8476357224606743
EarlyStopping counter: 39 out of 50
epoch:  90
epoch:  91 val_f1:  0.7283736963917239 val_auroc:  0.7366224840451645 val_auprc:  0.848652745676684
EarlyStopping counter: 40 out of 50
epoch:  91
epoch:  92 val_f1:  0.7283736963917239 val_auroc:  0.7410407461953854 val_auprc:  0.8494449429938503
EarlyStopping counter: 41 out of 50
epoch:  92
epoch:  93 val_f1:  0.7473302173830908 val_auroc:  0.7393225331369662 val_auprc:  0.846600007194996
EarlyStopping counter: 42 out of 50
epoch:  93
epoch:  94 val_f1:  0.7411406017655346 val_auroc:  0.7360088365243004 val_auprc:  0.8432128072917541
EarlyStopping counter: 43 out of 50
epoch:  94
epoch:  95 val_f1:  0.7411406017655346 val_auroc:  0.7417771232204221 val_auprc:  0.8499081062377971
EarlyStopping counter: 44 out of 50
epoch:  95
epoch:  96 val_f1:  0.7410071942446043 val_auroc:  0.7416543937162493 val_auprc:  0.8497091567271348
EarlyStopping counter: 45 out of 50
epoch:  96
epoch:  97 val_f1:  0.7536606851900262 val_auroc:  0.7410407461953853 val_auprc:  0.8453365821446526
EarlyStopping counter: 46 out of 50
epoch:  97
epoch:  98 val_f1:  0.7346891520614657 val_auroc:  0.7417771232204222 val_auprc:  0.8487241181373897
EarlyStopping counter: 47 out of 50
epoch:  98
epoch:  99 val_f1:  0.7410071942446043 val_auroc:  0.7417771232204222 val_auprc:  0.8499199708087758
EarlyStopping counter: 48 out of 50
epoch:  99
epoch:  100 val_f1:  0.7283736963917239 val_auroc:  0.7398134511536573 val_auprc:  0.844749773752959
EarlyStopping counter: 49 out of 50
epoch:  100
epoch:  101 val_f1:  0.722058496910722 val_auroc:  0.742513500245459 val_auprc:  0.849141329126585
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  2787.820034980774
{'time_elapsed': [2787.820034980774], 'epoch': [100], 'fold': [2], 'f1_train': [0.9981996872393208], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.722058496910722], 'auroc_test': [0.742513500245459], 'auprc_test': [0.849141329126585]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1278]          6,144
│    └─BatchNorm1d: 2-2                  [64, 1024, 1278]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1278]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1274]          --
│    └─Dropout: 2-5                      [64, 1024, 1274]          --
│    └─Flatten: 2-6                      [64, 1304576]             --
│    └─Linear: 2-7                       [64, 1]                   1,304,577
==========================================================================================
Total params: 1,312,769
Trainable params: 1,312,769
Non-trainable params: 0
Total mult-adds (M): 586.15
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1340.08
Params size (MB): 5.25
Estimated Total Size (MB): 1345.66
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5642736874330323 val_auroc:  0.5 val_auprc:  0.8453237410071943
epoch:  1
epoch:  2 val_f1:  0.6751933412124308 val_auroc:  0.6672722868217054 val_auprc:  0.8387557723973429
Validation loss improved to 1.103107
epoch:  2
epoch:  3 val_f1:  0.6144680959617768 val_auroc:  0.7013081395348837 val_auprc:  0.850646058569233
Validation loss improved to 0.272391
epoch:  3
epoch:  4 val_f1:  0.6723699875662018 val_auroc:  0.7877906976744187 val_auprc:  0.9066917633056397
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.7155257462073281 val_auroc:  0.7587209302325582 val_auprc:  0.8797861955775528
EarlyStopping counter: 2 out of 50
epoch:  5
epoch:  6 val_f1:  0.7452753085049493 val_auroc:  0.8012354651162791 val_auprc:  0.9026016792147946
EarlyStopping counter: 3 out of 50
epoch:  6
epoch:  7 val_f1:  0.751925686926815 val_auroc:  0.8249757751937984 val_auprc:  0.9138607640960108
Validation loss improved to 0.204556
epoch:  7
epoch:  8 val_f1:  0.7894843465886632 val_auroc:  0.8309108527131782 val_auprc:  0.9222371297659764
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7682301875730638 val_auroc:  0.8277616279069767 val_auprc:  0.9208817254284274
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.7489783115038208 val_auroc:  0.82703488372093 val_auprc:  0.922560518571304
EarlyStopping counter: 3 out of 50
epoch:  10
epoch:  11 val_f1:  0.7307261355642982 val_auroc:  0.8335755813953488 val_auprc:  0.9237907693209009
EarlyStopping counter: 4 out of 50
epoch:  11
epoch:  12 val_f1:  0.7489783115038208 val_auroc:  0.8335755813953488 val_auprc:  0.9257795274447718
EarlyStopping counter: 5 out of 50
epoch:  12
epoch:  13 val_f1:  0.7399265053976237 val_auroc:  0.8447189922480619 val_auprc:  0.9290357134143878
EarlyStopping counter: 6 out of 50
epoch:  13
epoch:  14 val_f1:  0.8101799492243995 val_auroc:  0.8439922480620156 val_auprc:  0.9293628249871049
Validation loss improved to 0.144438
epoch:  14
epoch:  15 val_f1:  0.7644817479349855 val_auroc:  0.845203488372093 val_auprc:  0.9315107160215694
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7701596400342386 val_auroc:  0.8481104651162791 val_auprc:  0.9325582652276682
Validation loss improved to 0.124117
epoch:  16
epoch:  17 val_f1:  0.6288049924600502 val_auroc:  0.8490794573643412 val_auprc:  0.934369215598296
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.7502255822460676 val_auroc:  0.8372093023255813 val_auprc:  0.9319974143901903
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7437835844998612 val_auroc:  0.844234496124031 val_auprc:  0.9345910919392265
EarlyStopping counter: 3 out of 50
epoch:  19
epoch:  20 val_f1:  0.7745758989478168 val_auroc:  0.84375 val_auprc:  0.932526610882948
EarlyStopping counter: 4 out of 50
epoch:  20
epoch:  21 val_f1:  0.7489515803087866 val_auroc:  0.8306686046511628 val_auprc:  0.9325536535962242
Validation loss improved to 0.096732
epoch:  21
epoch:  22 val_f1:  0.7489783115038208 val_auroc:  0.8444767441860466 val_auprc:  0.934490933671368
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7603368061152953 val_auroc:  0.8500484496124031 val_auprc:  0.9342772565863425
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.7682301875730638 val_auroc:  0.8505329457364341 val_auprc:  0.9359977021045869
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.7746634573712671 val_auroc:  0.8580426356589147 val_auprc:  0.9416169222946769
EarlyStopping counter: 4 out of 50
epoch:  25
epoch:  26 val_f1:  0.7811109002295425 val_auroc:  0.8614341085271318 val_auprc:  0.943511105848463
EarlyStopping counter: 5 out of 50
epoch:  26
epoch:  27 val_f1:  0.757317891506193 val_auroc:  0.8590116279069767 val_auprc:  0.9402279987137656
EarlyStopping counter: 6 out of 50
epoch:  27
epoch:  28 val_f1:  0.7426405456673774 val_auroc:  0.8602228682170543 val_auprc:  0.9440399641226626
EarlyStopping counter: 7 out of 50
epoch:  28
epoch:  29 val_f1:  0.7216420412057452 val_auroc:  0.8626453488372092 val_auprc:  0.9436992424860884
EarlyStopping counter: 8 out of 50
epoch:  29
epoch:  30 val_f1:  0.7907929835906556 val_auroc:  0.8599806201550387 val_auprc:  0.9419124749491754
EarlyStopping counter: 9 out of 50
epoch:  30
epoch:  31 val_f1:  0.7540304643278981 val_auroc:  0.8628875968992248 val_auprc:  0.9439583993352241
EarlyStopping counter: 10 out of 50
epoch:  31
epoch:  32 val_f1:  0.758275274873164 val_auroc:  0.8597383720930233 val_auprc:  0.9437462526317656
EarlyStopping counter: 11 out of 50
epoch:  32
epoch:  33 val_f1:  0.7961192047225032 val_auroc:  0.8626453488372092 val_auprc:  0.9434823319631647
EarlyStopping counter: 12 out of 50
epoch:  33
epoch:  34 val_f1:  0.7997900244397783 val_auroc:  0.8633720930232558 val_auprc:  0.9423424220550185
EarlyStopping counter: 13 out of 50
epoch:  34
epoch:  35 val_f1:  0.7562473143424068 val_auroc:  0.8655523255813953 val_auprc:  0.9445790986915725
EarlyStopping counter: 14 out of 50
epoch:  35
epoch:  36 val_f1:  0.8093907785715628 val_auroc:  0.8689437984496124 val_auprc:  0.9450861454454546
EarlyStopping counter: 15 out of 50
epoch:  36
epoch:  37 val_f1:  0.7997900244397783 val_auroc:  0.8638565891472868 val_auprc:  0.9432343799323575
EarlyStopping counter: 16 out of 50
epoch:  37
epoch:  38 val_f1:  0.7540304643278981 val_auroc:  0.8679748062015503 val_auprc:  0.9437754491647894
EarlyStopping counter: 17 out of 50
epoch:  38
epoch:  39 val_f1:  0.8074875573056803 val_auroc:  0.8679748062015502 val_auprc:  0.9438623016363252
EarlyStopping counter: 18 out of 50
epoch:  39
epoch:  40 val_f1:  0.8160321672535743 val_auroc:  0.872577519379845 val_auprc:  0.948417731192966
EarlyStopping counter: 19 out of 50
epoch:  40
epoch:  41 val_f1:  0.7641917471702557 val_auroc:  0.875484496124031 val_auprc:  0.9479293139159347
EarlyStopping counter: 20 out of 50
epoch:  41
epoch:  42 val_f1:  0.7789671954250403 val_auroc:  0.8713662790697674 val_auprc:  0.9456256365246176
EarlyStopping counter: 21 out of 50
epoch:  42
epoch:  43 val_f1:  0.7997900244397783 val_auroc:  0.8716085271317829 val_auprc:  0.9476934393017187
EarlyStopping counter: 22 out of 50
epoch:  43
epoch:  44 val_f1:  0.749929147591018 val_auroc:  0.872577519379845 val_auprc:  0.9475691430249866
EarlyStopping counter: 23 out of 50
epoch:  44
epoch:  45 val_f1:  0.749929147591018 val_auroc:  0.8733042635658915 val_auprc:  0.9474988889433469
EarlyStopping counter: 24 out of 50
epoch:  45
epoch:  46 val_f1:  0.7665182935781787 val_auroc:  0.8750000000000001 val_auprc:  0.9488335436144285
EarlyStopping counter: 25 out of 50
epoch:  46
epoch:  47 val_f1:  0.749929147591018 val_auroc:  0.8737887596899225 val_auprc:  0.9474324960193584
EarlyStopping counter: 26 out of 50
epoch:  47
epoch:  48 val_f1:  0.7841726618705036 val_auroc:  0.8723352713178295 val_auprc:  0.9480363008037459
EarlyStopping counter: 27 out of 50
epoch:  48
epoch:  49 val_f1:  0.7997900244397783 val_auroc:  0.8716085271317829 val_auprc:  0.9467867720454212
EarlyStopping counter: 28 out of 50
epoch:  49
epoch:  50 val_f1:  0.764639197732723 val_auroc:  0.874031007751938 val_auprc:  0.9481874944606778
EarlyStopping counter: 29 out of 50
epoch:  50
epoch:  51 val_f1:  0.776244301724119 val_auroc:  0.8747577519379844 val_auprc:  0.9483387475586149
EarlyStopping counter: 30 out of 50
epoch:  51
epoch:  52 val_f1:  0.7841726618705036 val_auroc:  0.8730620155038759 val_auprc:  0.9472374374744593
EarlyStopping counter: 31 out of 50
epoch:  52
epoch:  53 val_f1:  0.7746634573712671 val_auroc:  0.8701550387596899 val_auprc:  0.9471613416660283
EarlyStopping counter: 32 out of 50
epoch:  53
epoch:  54 val_f1:  0.7841726618705036 val_auroc:  0.8720930232558138 val_auprc:  0.9464125346720716
EarlyStopping counter: 33 out of 50
epoch:  54
epoch:  55 val_f1:  0.792019787311512 val_auroc:  0.8713662790697675 val_auprc:  0.9463175872999573
EarlyStopping counter: 34 out of 50
epoch:  55
epoch:  56 val_f1:  0.776244301724119 val_auroc:  0.874515503875969 val_auprc:  0.9475819409102849
EarlyStopping counter: 35 out of 50
epoch:  56
epoch:  57 val_f1:  0.7827158008497472 val_auroc:  0.8701550387596898 val_auprc:  0.9459574996425106
EarlyStopping counter: 36 out of 50
epoch:  57
epoch:  58 val_f1:  0.7746634573712671 val_auroc:  0.8703972868217055 val_auprc:  0.9458968605300084
EarlyStopping counter: 37 out of 50
epoch:  58
epoch:  59 val_f1:  0.7774211400110681 val_auroc:  0.8728197674418605 val_auprc:  0.9462981447415983
EarlyStopping counter: 38 out of 50
epoch:  59
epoch:  60 val_f1:  0.7562473143424068 val_auroc:  0.8691860465116279 val_auprc:  0.9453119383826043
EarlyStopping counter: 39 out of 50
epoch:  60
epoch:  61 val_f1:  0.7625825493451395 val_auroc:  0.8716085271317829 val_auprc:  0.9463898453130428
EarlyStopping counter: 40 out of 50
epoch:  61
epoch:  62 val_f1:  0.7516121487046815 val_auroc:  0.8696705426356589 val_auprc:  0.9457003471645884
EarlyStopping counter: 41 out of 50
epoch:  62
epoch:  63 val_f1:  0.7625825493451395 val_auroc:  0.872577519379845 val_auprc:  0.9465732048032162
EarlyStopping counter: 42 out of 50
epoch:  63
epoch:  64 val_f1:  0.7540304643278981 val_auroc:  0.866279069767442 val_auprc:  0.9447982121952394
EarlyStopping counter: 43 out of 50
epoch:  64
epoch:  65 val_f1:  0.7827158008497472 val_auroc:  0.8662790697674418 val_auprc:  0.9444160198561647
EarlyStopping counter: 44 out of 50
epoch:  65
epoch:  66 val_f1:  0.7854893118997625 val_auroc:  0.8653100775193797 val_auprc:  0.9442537916605764
EarlyStopping counter: 45 out of 50
epoch:  66
epoch:  67 val_f1:  0.776244301724119 val_auroc:  0.8699127906976746 val_auprc:  0.9459408599332988
EarlyStopping counter: 46 out of 50
epoch:  67
epoch:  68 val_f1:  0.776244301724119 val_auroc:  0.869186046511628 val_auprc:  0.9462033597237101
EarlyStopping counter: 47 out of 50
epoch:  68
epoch:  69 val_f1:  0.7665182935781787 val_auroc:  0.8684593023255813 val_auprc:  0.9451095161627334
EarlyStopping counter: 48 out of 50
epoch:  69
epoch:  70 val_f1:  0.7516121487046815 val_auroc:  0.8703972868217055 val_auprc:  0.9458554307372963
EarlyStopping counter: 49 out of 50
epoch:  70
epoch:  71 val_f1:  0.7516121487046815 val_auroc:  0.8699127906976744 val_auprc:  0.9454743223411114
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1962.1597776412964
{'time_elapsed': [1962.1597776412964], 'epoch': [70], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7516121487046815], 'auroc_test': [0.8699127906976744], 'auprc_test': [0.9454743223411114]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1278]          6,144
│    └─BatchNorm1d: 2-2                  [64, 1024, 1278]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1278]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1274]          --
│    └─Dropout: 2-5                      [64, 1024, 1274]          --
│    └─Flatten: 2-6                      [64, 1304576]             --
│    └─Linear: 2-7                       [64, 1]                   1,304,577
==========================================================================================
Total params: 1,312,769
Trainable params: 1,312,769
Non-trainable params: 0
Total mult-adds (M): 586.15
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1340.08
Params size (MB): 5.25
Estimated Total Size (MB): 1345.66
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5707915273132664 val_auroc:  0.5 val_auprc:  0.8478260869565217
epoch:  1
epoch:  2 val_f1:  0.2775047258979206 val_auroc:  0.5445188492063492 val_auprc:  0.7044250846983576
Validation loss improved to 8.921464
epoch:  2
epoch:  3 val_f1:  0.47189284145805876 val_auroc:  0.5575396825396826 val_auprc:  0.7514143584258491
Validation loss improved to 6.955005
epoch:  3
epoch:  4 val_f1:  0.5961299039714327 val_auroc:  0.5783730158730158 val_auprc:  0.7788619806028669
Validation loss improved to 5.347833
epoch:  4
epoch:  5 val_f1:  0.616783172941287 val_auroc:  0.5949900793650793 val_auprc:  0.8229615014229712
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.6831887605768718 val_auroc:  0.6243799603174603 val_auprc:  0.7790211478815688
Validation loss improved to 3.243622
epoch:  6
epoch:  7 val_f1:  0.5485990338164252 val_auroc:  0.6875 val_auprc:  0.7786626677580828
Validation loss improved to 1.742226
epoch:  7
epoch:  8 val_f1:  0.6729851027900322 val_auroc:  0.7744295634920636 val_auprc:  0.8655838605615742
Validation loss improved to 0.825239
epoch:  8
epoch:  9 val_f1:  0.7651901748656188 val_auroc:  0.8165922619047619 val_auprc:  0.9062628636992887
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7147242103763842 val_auroc:  0.8464781746031746 val_auprc:  0.9285707575547277
Validation loss improved to 0.588148
epoch:  10
epoch:  11 val_f1:  0.7564782680351303 val_auroc:  0.8556547619047619 val_auprc:  0.930299885943099
Validation loss improved to 0.525106
epoch:  11
epoch:  12 val_f1:  0.7366862686046695 val_auroc:  0.8536706349206349 val_auprc:  0.926056279438625
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7366862686046695 val_auroc:  0.8647073412698413 val_auprc:  0.9303084118610152
Validation loss improved to 0.455012
epoch:  13
epoch:  14 val_f1:  0.6753495498946562 val_auroc:  0.8645833333333334 val_auprc:  0.9271433566861084
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.8115942028985508 val_auroc:  0.8687996031746033 val_auprc:  0.9335046630610668
Validation loss improved to 0.226178
epoch:  15
epoch:  16 val_f1:  0.7861608411480533 val_auroc:  0.8690476190476191 val_auprc:  0.9340821071128338
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7574379646074798 val_auroc:  0.8736359126984127 val_auprc:  0.9365590159149321
EarlyStopping counter: 2 out of 50
epoch:  17
epoch:  18 val_f1:  0.7468467601061853 val_auroc:  0.8763640873015874 val_auprc:  0.9366515859497501
EarlyStopping counter: 3 out of 50
epoch:  18
epoch:  19 val_f1:  0.8035275913020209 val_auroc:  0.8737599206349205 val_auprc:  0.9320740004565211
EarlyStopping counter: 4 out of 50
epoch:  19
epoch:  20 val_f1:  0.7428219852337982 val_auroc:  0.8638392857142857 val_auprc:  0.9290231642003662
EarlyStopping counter: 5 out of 50
epoch:  20
epoch:  21 val_f1:  0.804509509950907 val_auroc:  0.8814484126984128 val_auprc:  0.9398377735953862
EarlyStopping counter: 6 out of 50
epoch:  21
epoch:  22 val_f1:  0.763388123011665 val_auroc:  0.8787202380952381 val_auprc:  0.937777269623404
EarlyStopping counter: 7 out of 50
epoch:  22
epoch:  23 val_f1:  0.8049865427618805 val_auroc:  0.8675595238095237 val_auprc:  0.9308163507534585
Validation loss improved to 0.208880
epoch:  23
epoch:  24 val_f1:  0.7061872909698997 val_auroc:  0.8571428571428572 val_auprc:  0.9243125637467158
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.5149020174298233 val_auroc:  0.8737599206349207 val_auprc:  0.9392106160015308
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.5964194373401533 val_auroc:  0.871279761904762 val_auprc:  0.9335954772216463
EarlyStopping counter: 3 out of 50
epoch:  26
epoch:  27 val_f1:  0.4419215547654198 val_auroc:  0.869047619047619 val_auprc:  0.9334861444178395
EarlyStopping counter: 4 out of 50
epoch:  27
epoch:  28 val_f1:  0.7139661905863711 val_auroc:  0.8625992063492064 val_auprc:  0.9281755233992585
EarlyStopping counter: 5 out of 50
epoch:  28
epoch:  29 val_f1:  0.7807080066524115 val_auroc:  0.871031746031746 val_auprc:  0.9317584643306329
Validation loss improved to 0.166333
epoch:  29
epoch:  30 val_f1:  0.6128085841460184 val_auroc:  0.8683035714285714 val_auprc:  0.9289205815137112
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.6208894080747627 val_auroc:  0.8640873015873016 val_auprc:  0.9262049901025219
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.6538029405209672 val_auroc:  0.8650793650793651 val_auprc:  0.9310878399916633
EarlyStopping counter: 3 out of 50
epoch:  32
epoch:  33 val_f1:  0.763388123011665 val_auroc:  0.8630952380952382 val_auprc:  0.9273295693998403
EarlyStopping counter: 4 out of 50
epoch:  33
epoch:  34 val_f1:  0.7881997743237336 val_auroc:  0.8660714285714285 val_auprc:  0.9277544072181354
Validation loss improved to 0.134215
epoch:  34
epoch:  35 val_f1:  0.5363972412027331 val_auroc:  0.8680555555555556 val_auprc:  0.9254239524215742
EarlyStopping counter: 1 out of 50
epoch:  35
epoch:  36 val_f1:  0.7249011857707508 val_auroc:  0.878968253968254 val_auprc:  0.9404530236340767
EarlyStopping counter: 2 out of 50
epoch:  36
epoch:  37 val_f1:  0.6447060979520777 val_auroc:  0.8797123015873016 val_auprc:  0.9373132257471222
EarlyStopping counter: 3 out of 50
epoch:  37
epoch:  38 val_f1:  0.7874834274643012 val_auroc:  0.8797123015873016 val_auprc:  0.9402685581149991
EarlyStopping counter: 4 out of 50
epoch:  38
epoch:  39 val_f1:  0.8041106719367591 val_auroc:  0.8742559523809524 val_auprc:  0.9352271522872331
EarlyStopping counter: 5 out of 50
epoch:  39
epoch:  40 val_f1:  0.7845614924947297 val_auroc:  0.8685515873015873 val_auprc:  0.9270741585269751
EarlyStopping counter: 6 out of 50
epoch:  40
epoch:  41 val_f1:  0.6690377195508206 val_auroc:  0.8645833333333333 val_auprc:  0.9277280775446426
EarlyStopping counter: 7 out of 50
epoch:  41
epoch:  42 val_f1:  0.7845614924947297 val_auroc:  0.8790922619047619 val_auprc:  0.9402707786052249
EarlyStopping counter: 8 out of 50
epoch:  42
epoch:  43 val_f1:  0.804814497938866 val_auroc:  0.8777281746031746 val_auprc:  0.9369759650360174
EarlyStopping counter: 9 out of 50
epoch:  43
epoch:  44 val_f1:  0.7901701323251418 val_auroc:  0.8678075396825397 val_auprc:  0.9288184681701207
EarlyStopping counter: 10 out of 50
epoch:  44
epoch:  45 val_f1:  0.8035275913020209 val_auroc:  0.8689236111111112 val_auprc:  0.9270430730582391
EarlyStopping counter: 11 out of 50
epoch:  45
epoch:  46 val_f1:  0.8035275913020209 val_auroc:  0.8722718253968254 val_auprc:  0.9334826626158798
EarlyStopping counter: 12 out of 50
epoch:  46
epoch:  47 val_f1:  0.791810443984357 val_auroc:  0.8643353174603176 val_auprc:  0.9236420191199008
EarlyStopping counter: 13 out of 50
epoch:  47
epoch:  48 val_f1:  0.7904805491990847 val_auroc:  0.8604910714285715 val_auprc:  0.9229723053402088
EarlyStopping counter: 14 out of 50
epoch:  48
epoch:  49 val_f1:  0.7969889682024659 val_auroc:  0.8637152777777778 val_auprc:  0.9246664632428765
EarlyStopping counter: 15 out of 50
epoch:  49
epoch:  50 val_f1:  0.7819511139952413 val_auroc:  0.8597470238095238 val_auprc:  0.9205471661233631
EarlyStopping counter: 16 out of 50
epoch:  50
epoch:  51 val_f1:  0.7797158172381521 val_auroc:  0.8629712301587301 val_auprc:  0.922879978835081
EarlyStopping counter: 17 out of 50
epoch:  51
epoch:  52 val_f1:  0.8108796141220607 val_auroc:  0.8678075396825398 val_auprc:  0.92558021665088
EarlyStopping counter: 18 out of 50
epoch:  52
epoch:  53 val_f1:  0.7875799991742021 val_auroc:  0.8640873015873016 val_auprc:  0.9192165798950133
EarlyStopping counter: 19 out of 50
epoch:  53
epoch:  54 val_f1:  0.7904805491990847 val_auroc:  0.8664434523809523 val_auprc:  0.9237425598137984
EarlyStopping counter: 20 out of 50
epoch:  54
epoch:  55 val_f1:  0.8005921770297647 val_auroc:  0.8643353174603176 val_auprc:  0.9188769261924261
EarlyStopping counter: 21 out of 50
epoch:  55
epoch:  56 val_f1:  0.7926396128627546 val_auroc:  0.8515625 val_auprc:  0.9155222970867543
EarlyStopping counter: 22 out of 50
epoch:  56
epoch:  57 val_f1:  0.7810781559182691 val_auroc:  0.8591269841269842 val_auprc:  0.9139381106642097
EarlyStopping counter: 23 out of 50
epoch:  57
epoch:  58 val_f1:  0.7775412992804297 val_auroc:  0.8604910714285714 val_auprc:  0.9201930302531525
EarlyStopping counter: 24 out of 50
epoch:  58
epoch:  59 val_f1:  0.7711042634565258 val_auroc:  0.8621031746031746 val_auprc:  0.9219374413844217
EarlyStopping counter: 25 out of 50
epoch:  59
epoch:  60 val_f1:  0.8022296544035674 val_auroc:  0.8692956349206349 val_auprc:  0.9225817627092191
EarlyStopping counter: 26 out of 50
epoch:  60
epoch:  61 val_f1:  0.7775412992804297 val_auroc:  0.8653273809523809 val_auprc:  0.9217641848548944
EarlyStopping counter: 27 out of 50
epoch:  61
epoch:  62 val_f1:  0.7905411014849827 val_auroc:  0.8696676587301587 val_auprc:  0.9270722013751287
EarlyStopping counter: 28 out of 50
epoch:  62
epoch:  63 val_f1:  0.7772795841859215 val_auroc:  0.869171626984127 val_auprc:  0.9262645900928196
EarlyStopping counter: 29 out of 50
epoch:  63
epoch:  64 val_f1:  0.792371879328401 val_auroc:  0.8687996031746033 val_auprc:  0.9221144022850852
EarlyStopping counter: 30 out of 50
epoch:  64
epoch:  65 val_f1:  0.7874834274643012 val_auroc:  0.8669394841269842 val_auprc:  0.9259241212249476
EarlyStopping counter: 31 out of 50
epoch:  65
epoch:  66 val_f1:  0.7760956602080848 val_auroc:  0.8661954365079365 val_auprc:  0.9185567115936962
EarlyStopping counter: 32 out of 50
epoch:  66
epoch:  67 val_f1:  0.7711042634565258 val_auroc:  0.8669394841269841 val_auprc:  0.9214023936312035
EarlyStopping counter: 33 out of 50
epoch:  67
epoch:  68 val_f1:  0.7797158172381521 val_auroc:  0.8668154761904763 val_auprc:  0.9240312621919993
EarlyStopping counter: 34 out of 50
epoch:  68
epoch:  69 val_f1:  0.7775412992804297 val_auroc:  0.869171626984127 val_auprc:  0.922864464944294
EarlyStopping counter: 35 out of 50
epoch:  69
epoch:  70 val_f1:  0.7891335560760728 val_auroc:  0.8717757936507935 val_auprc:  0.9220337834313017
EarlyStopping counter: 36 out of 50
epoch:  70
epoch:  71 val_f1:  0.7969889682024659 val_auroc:  0.8697916666666667 val_auprc:  0.9240227271925284
EarlyStopping counter: 37 out of 50
epoch:  71
epoch:  72 val_f1:  0.7797158172381521 val_auroc:  0.8695436507936507 val_auprc:  0.924054235657255
EarlyStopping counter: 38 out of 50
epoch:  72
epoch:  73 val_f1:  0.7875799991742021 val_auroc:  0.8692956349206349 val_auprc:  0.92312165708767
EarlyStopping counter: 39 out of 50
epoch:  73
epoch:  74 val_f1:  0.7884143290944841 val_auroc:  0.8702876984126984 val_auprc:  0.9246243602876287
EarlyStopping counter: 40 out of 50
epoch:  74
epoch:  75 val_f1:  0.7755148741418765 val_auroc:  0.8699156746031746 val_auprc:  0.9244200788378889
EarlyStopping counter: 41 out of 50
epoch:  75
epoch:  76 val_f1:  0.7810781559182691 val_auroc:  0.8686755952380953 val_auprc:  0.9220800951015724
EarlyStopping counter: 42 out of 50
epoch:  76
epoch:  77 val_f1:  0.7940993788819876 val_auroc:  0.8684275793650795 val_auprc:  0.9222187939198478
EarlyStopping counter: 43 out of 50
epoch:  77
epoch:  78 val_f1:  0.7755148741418765 val_auroc:  0.8674355158730158 val_auprc:  0.9227258112991157
EarlyStopping counter: 44 out of 50
epoch:  78
epoch:  79 val_f1:  0.7875799991742021 val_auroc:  0.8679315476190477 val_auprc:  0.9231520846098645
EarlyStopping counter: 45 out of 50
epoch:  79
epoch:  80 val_f1:  0.7819511139952413 val_auroc:  0.8697916666666666 val_auprc:  0.9242866750701724
EarlyStopping counter: 46 out of 50
epoch:  80
epoch:  81 val_f1:  0.7940993788819876 val_auroc:  0.8695436507936507 val_auprc:  0.9231606198219025
EarlyStopping counter: 47 out of 50
epoch:  81
epoch:  82 val_f1:  0.7775412992804297 val_auroc:  0.8702876984126984 val_auprc:  0.9239289473534168
EarlyStopping counter: 48 out of 50
epoch:  82
epoch:  83 val_f1:  0.7755148741418765 val_auroc:  0.87140376984127 val_auprc:  0.9251534809884674
EarlyStopping counter: 49 out of 50
epoch:  83
epoch:  84 val_f1:  0.7755148741418765 val_auroc:  0.8699156746031746 val_auprc:  0.9242763020516391
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  2308.0027780532837
{'time_elapsed': [2308.0027780532837], 'epoch': [83], 'fold': [4], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7755148741418765], 'auroc_test': [0.8699156746031746], 'auprc_test': [0.9242763020516391]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1278]          6,144
│    └─BatchNorm1d: 2-2                  [64, 1024, 1278]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1278]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1274]          --
│    └─Dropout: 2-5                      [64, 1024, 1274]          --
│    └─Flatten: 2-6                      [64, 1304576]             --
│    └─Linear: 2-7                       [64, 1]                   1,304,577
==========================================================================================
Total params: 1,312,769
Trainable params: 1,312,769
Non-trainable params: 0
Total mult-adds (M): 586.15
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1340.08
Params size (MB): 5.25
Estimated Total Size (MB): 1345.66
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_13', 'config': {'hidden_channels': [1024], 'epochs': 500, 'kernel_size': 5, 'pool_kernel_size': 5, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.6860579283259696 val_auprc:  0.8483419617465742
epoch:  1
epoch:  2 val_f1:  0.6390926504079756 val_auroc:  0.6961217476681395 val_auprc:  0.8509876183636507
Validation loss improved to 1.534285
epoch:  2
epoch:  3 val_f1:  0.5575599172691673 val_auroc:  0.70446735395189 val_auprc:  0.856059864671612
Validation loss improved to 1.206900
epoch:  3
epoch:  4 val_f1:  0.6542023675489317 val_auroc:  0.7120765832106039 val_auprc:  0.857986150550226
Validation loss improved to 1.189038
epoch:  4
epoch:  5 val_f1:  0.6788382480828524 val_auroc:  0.7231222385861562 val_auprc:  0.8626736468237812
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.6172673191108796 val_auroc:  0.7351497299950909 val_auprc:  0.8685477891611192
Validation loss improved to 1.163745
epoch:  6
epoch:  7 val_f1:  0.6246972157456884 val_auroc:  0.7471772214040255 val_auprc:  0.8745188764782502
Validation loss improved to 1.157799
epoch:  7
epoch:  8 val_f1:  0.6889840728573212 val_auroc:  0.7552773686794306 val_auprc:  0.878079683622059
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7166299330477814 val_auroc:  0.7687776141384388 val_auprc:  0.8848847437341233
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.7169009504644194 val_auroc:  0.7781050564555719 val_auprc:  0.890899152715235
EarlyStopping counter: 3 out of 50
epoch:  10
epoch:  11 val_f1:  0.7661184054361647 val_auroc:  0.7810505645557193 val_auprc:  0.8926280621613597
EarlyStopping counter: 4 out of 50
epoch:  11
epoch:  12 val_f1:  0.7683026725960121 val_auroc:  0.787432498772705 val_auprc:  0.8978019905017911
EarlyStopping counter: 5 out of 50
epoch:  12
epoch:  13 val_f1:  0.7223183251151889 val_auroc:  0.7859597447226313 val_auprc:  0.8966870071271678
Validation loss improved to 1.141673
epoch:  13
epoch:  14 val_f1:  0.7371484630477437 val_auroc:  0.7847324496809033 val_auprc:  0.894885986656178
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.6893510131556864 val_auroc:  0.7925871379479628 val_auprc:  0.9015619603458926
Validation loss improved to 1.109003
epoch:  15
epoch:  16 val_f1:  0.7289242247644242 val_auroc:  0.7935689739813451 val_auprc:  0.9015579170483866
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7144317414801258 val_auroc:  0.7876779577810507 val_auprc:  0.8976122951847286
EarlyStopping counter: 2 out of 50
epoch:  17
epoch:  18 val_f1:  0.7298555432283743 val_auroc:  0.7906234658811979 val_auprc:  0.8996417082931378
EarlyStopping counter: 3 out of 50
epoch:  18
epoch:  19 val_f1:  0.696151679426677 val_auroc:  0.7972508591065293 val_auprc:  0.9039704096502302
Validation loss improved to 1.098530
epoch:  19
epoch:  20 val_f1:  0.6891084624964738 val_auroc:  0.8016691212567502 val_auprc:  0.9083258371266355
Validation loss improved to 1.092525
epoch:  20
epoch:  21 val_f1:  0.730071543320129 val_auroc:  0.8016691212567502 val_auprc:  0.9087728558400991
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7371937993371881 val_auroc:  0.8060873834069711 val_auprc:  0.9118075670295254
Validation loss improved to 1.086051
epoch:  22
epoch:  23 val_f1:  0.7362024088594293 val_auroc:  0.8053510063819341 val_auprc:  0.9110936847824112
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7233618940391454 val_auroc:  0.8087874324987727 val_auprc:  0.914396996369711
Validation loss improved to 1.077471
epoch:  24
epoch:  25 val_f1:  0.6677356419948787 val_auroc:  0.8092783505154639 val_auprc:  0.9141880391173937
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.703263898025454 val_auroc:  0.81173294059892 val_auprc:  0.9165555250184008
EarlyStopping counter: 2 out of 50
epoch:  26
epoch:  27 val_f1:  0.7672775806504117 val_auroc:  0.8087874324987726 val_auprc:  0.9145199182086577
EarlyStopping counter: 3 out of 50
epoch:  27
epoch:  28 val_f1:  0.7683026725960121 val_auroc:  0.814187530682376 val_auprc:  0.9176177105831628
EarlyStopping counter: 4 out of 50
epoch:  28
epoch:  29 val_f1:  0.7683026725960121 val_auroc:  0.8163966617574864 val_auprc:  0.9195367609585903
EarlyStopping counter: 5 out of 50
epoch:  29
epoch:  30 val_f1:  0.6893510131556864 val_auroc:  0.8205694648993618 val_auprc:  0.9218332369491289
EarlyStopping counter: 6 out of 50
epoch:  30
epoch:  31 val_f1:  0.7166299330477814 val_auroc:  0.8181148748159057 val_auprc:  0.9197128769572167
EarlyStopping counter: 7 out of 50
epoch:  31
epoch:  32 val_f1:  0.696151679426677 val_auroc:  0.8252331860579283 val_auprc:  0.9243042429622598
EarlyStopping counter: 8 out of 50
epoch:  32
epoch:  33 val_f1:  0.6802976282278086 val_auroc:  0.826705940108002 val_auprc:  0.9253640483983934
EarlyStopping counter: 9 out of 50
epoch:  33
epoch:  34 val_f1:  0.7367608586927249 val_auroc:  0.8205694648993619 val_auprc:  0.9219383563101959
EarlyStopping counter: 10 out of 50
epoch:  34
epoch:  35 val_f1:  0.7542604103291037 val_auroc:  0.8176239567992145 val_auprc:  0.9194627537738268
EarlyStopping counter: 11 out of 50
epoch:  35
epoch:  36 val_f1:  0.7596459003010357 val_auroc:  0.8151693667157585 val_auprc:  0.9171187310496154
EarlyStopping counter: 12 out of 50
epoch:  36
epoch:  37 val_f1:  0.7477455593342162 val_auroc:  0.8151693667157583 val_auprc:  0.9167011730949797
EarlyStopping counter: 13 out of 50
epoch:  37
epoch:  38 val_f1:  0.7233618940391454 val_auroc:  0.8195876288659794 val_auprc:  0.9209085292823194
EarlyStopping counter: 14 out of 50
epoch:  38
epoch:  39 val_f1:  0.7233618940391454 val_auroc:  0.8220422189494354 val_auprc:  0.9224802047766298
EarlyStopping counter: 15 out of 50
epoch:  39
epoch:  40 val_f1:  0.6737247039763566 val_auroc:  0.8279332351497299 val_auprc:  0.9263494772706288
EarlyStopping counter: 16 out of 50
epoch:  40
epoch:  41 val_f1:  0.6887363496684735 val_auroc:  0.8244968090328916 val_auprc:  0.92470205655143
EarlyStopping counter: 17 out of 50
epoch:  41
epoch:  42 val_f1:  0.7402181480621955 val_auroc:  0.8134511536573392 val_auprc:  0.9169447209902215
EarlyStopping counter: 18 out of 50
epoch:  42
epoch:  43 val_f1:  0.7712620601193464 val_auroc:  0.8163966617574865 val_auprc:  0.9195435229599234
EarlyStopping counter: 19 out of 50
epoch:  43
epoch:  44 val_f1:  0.7295632867761842 val_auroc:  0.8225331369661267 val_auprc:  0.9226354234561741
EarlyStopping counter: 20 out of 50
epoch:  44
epoch:  45 val_f1:  0.7170452552783244 val_auroc:  0.8190967108492881 val_auprc:  0.9214533174709114
EarlyStopping counter: 21 out of 50
epoch:  45
epoch:  46 val_f1:  0.7466980132583976 val_auroc:  0.8156602847324497 val_auprc:  0.91820583099264
EarlyStopping counter: 22 out of 50
epoch:  46
epoch:  47 val_f1:  0.7466980132583976 val_auroc:  0.8178694158075601 val_auprc:  0.9194567071553347
EarlyStopping counter: 23 out of 50
epoch:  47
epoch:  48 val_f1:  0.7648187281552264 val_auroc:  0.819833087874325 val_auprc:  0.9207736149736951
EarlyStopping counter: 24 out of 50
epoch:  48
epoch:  49 val_f1:  0.7777125328082551 val_auroc:  0.8173784977908689 val_auprc:  0.918839930999152
EarlyStopping counter: 25 out of 50
epoch:  49
epoch:  50 val_f1:  0.7367608586927249 val_auroc:  0.8240058910162004 val_auprc:  0.9236303402936076
EarlyStopping counter: 26 out of 50
epoch:  50
epoch:  51 val_f1:  0.7239714721729109 val_auroc:  0.8257241040746196 val_auprc:  0.9248777230623219
EarlyStopping counter: 27 out of 50
epoch:  51
epoch:  52 val_f1:  0.7169642564307364 val_auroc:  0.8235149729995092 val_auprc:  0.9232146386974514
EarlyStopping counter: 28 out of 50
epoch:  52
epoch:  53 val_f1:  0.710128282915836 val_auroc:  0.8215513009327442 val_auprc:  0.9223528194590574
EarlyStopping counter: 29 out of 50
epoch:  53
epoch:  54 val_f1:  0.7552115339652351 val_auroc:  0.8208149239077075 val_auprc:  0.9222965416141031
EarlyStopping counter: 30 out of 50
epoch:  54
epoch:  55 val_f1:  0.7531731915989216 val_auroc:  0.8217967599410899 val_auprc:  0.9225885985997166
EarlyStopping counter: 31 out of 50
epoch:  55
epoch:  56 val_f1:  0.7855581813618873 val_auroc:  0.8146784486990674 val_auprc:  0.9161601570222087
EarlyStopping counter: 32 out of 50
epoch:  56
epoch:  57 val_f1:  0.7596459003010357 val_auroc:  0.8188512518409427 val_auprc:  0.9210708074616359
EarlyStopping counter: 33 out of 50
epoch:  57
epoch:  58 val_f1:  0.7790721385700611 val_auroc:  0.8159057437407953 val_auprc:  0.9184623801762599
EarlyStopping counter: 34 out of 50
epoch:  58
epoch:  59 val_f1:  0.7712620601193464 val_auroc:  0.817378497790869 val_auprc:  0.9203517986398502
EarlyStopping counter: 35 out of 50
epoch:  59
epoch:  60 val_f1:  0.7790721385700611 val_auroc:  0.8159057437407953 val_auprc:  0.9186367204215661
EarlyStopping counter: 36 out of 50
epoch:  60
epoch:  61 val_f1:  0.7725930260576229 val_auroc:  0.8203240058910162 val_auprc:  0.9217477424248903
EarlyStopping counter: 37 out of 50
epoch:  61
epoch:  62 val_f1:  0.7777125328082551 val_auroc:  0.8156602847324497 val_auprc:  0.9185647044796117
EarlyStopping counter: 38 out of 50
epoch:  62
epoch:  63 val_f1:  0.7790721385700611 val_auroc:  0.8132056946489936 val_auprc:  0.9166245389634609
EarlyStopping counter: 39 out of 50
epoch:  63
epoch:  64 val_f1:  0.7737843767539161 val_auroc:  0.821060382916053 val_auprc:  0.9223466448165769
EarlyStopping counter: 40 out of 50
epoch:  64
epoch:  65 val_f1:  0.7683026725960121 val_auroc:  0.8225331369661266 val_auprc:  0.9229637579662088
EarlyStopping counter: 41 out of 50
epoch:  65
epoch:  66 val_f1:  0.7737843767539161 val_auroc:  0.8205694648993619 val_auprc:  0.921746791710488
EarlyStopping counter: 42 out of 50
epoch:  66
epoch:  67 val_f1:  0.7737843767539161 val_auroc:  0.8183603338242513 val_auprc:  0.9208711894337038
EarlyStopping counter: 43 out of 50
epoch:  67
epoch:  68 val_f1:  0.7745465218349855 val_auroc:  0.8159057437407953 val_auprc:  0.9183204781518592
EarlyStopping counter: 44 out of 50
epoch:  68
epoch:  69 val_f1:  0.7855581813618873 val_auroc:  0.8171330387825233 val_auprc:  0.9190620951741142
EarlyStopping counter: 45 out of 50
epoch:  69
epoch:  70 val_f1:  0.7725930260576229 val_auroc:  0.8154148257241041 val_auprc:  0.9181218589367894
EarlyStopping counter: 46 out of 50
epoch:  70
epoch:  71 val_f1:  0.7748426784519089 val_auroc:  0.8188512518409425 val_auprc:  0.9208194074683727
EarlyStopping counter: 47 out of 50
epoch:  71
epoch:  72 val_f1:  0.7617596949267598 val_auroc:  0.8242513500245459 val_auprc:  0.9242783232958411
EarlyStopping counter: 48 out of 50
epoch:  72
epoch:  73 val_f1:  0.7307106601978622 val_auroc:  0.8276877761413843 val_auprc:  0.9260161952690144
EarlyStopping counter: 49 out of 50
epoch:  73
epoch:  74 val_f1:  0.7170655771870609 val_auroc:  0.8274423171330387 val_auprc:  0.9259629964193326
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  230.79394125938416
{'time_elapsed': [230.79394125938416], 'epoch': [73], 'fold': [0], 'f1_train': [0.9383982328642406], 'auroc_train': [0.999831376276175], 'auprc_train': [0.9999262487101681], 'f1_test': [0.7170655771870609], 'auroc_test': [0.8274423171330387], 'auprc_test': [0.9259629964193326]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 256]           6,144
│    └─BatchNorm1d: 2-2                  [64, 1024, 256]           2,048
│    └─Tanh: 2-3                         [64, 1024, 256]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 51]            --
│    └─Dropout: 2-5                      [64, 1024, 51]            --
│    └─Flatten: 2-6                      [64, 52224]               --
│    └─Linear: 2-7                       [64, 1]                   52,225
==========================================================================================
Total params: 60,417
Trainable params: 60,417
Non-trainable params: 0
Total mult-adds (M): 104.14
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 268.44
Params size (MB): 0.24
Estimated Total Size (MB): 269.01
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.3628922279378038 val_auroc:  0.6686303387334316 val_auprc:  0.8548926781008808
epoch:  1
epoch:  2 val_f1:  0.6144448704359395 val_auroc:  0.6296023564064801 val_auprc:  0.8357272695386986
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6022355762448864 val_auroc:  0.6192930780559647 val_auprc:  0.8268576570511065
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5652835621000462 val_auroc:  0.6298478154148257 val_auprc:  0.8346331192240121
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.5997955253931118 val_auroc:  0.6438389788905253 val_auprc:  0.845592490879865
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6478524017972046 val_auroc:  0.6659302896416298 val_auprc:  0.8580730615898806
Validation loss improved to 1.364125
epoch:  6
epoch:  7 val_f1:  0.6493555155875299 val_auroc:  0.6929307805596465 val_auprc:  0.8719148021363861
Validation loss improved to 1.331616
epoch:  7
epoch:  8 val_f1:  0.629092664954331 val_auroc:  0.7233676975945017 val_auprc:  0.8884617149926322
Validation loss improved to 1.160005
epoch:  8
epoch:  9 val_f1:  0.7028070029525513 val_auroc:  0.7407952871870398 val_auprc:  0.8962778670394205
Validation loss improved to 1.097750
epoch:  9
epoch:  10 val_f1:  0.7002679453520968 val_auroc:  0.7614138438880708 val_auprc:  0.9036168347353366
Validation loss improved to 1.050455
epoch:  10
epoch:  11 val_f1:  0.7362024088594293 val_auroc:  0.7803141875306824 val_auprc:  0.9104635166200207
Validation loss improved to 1.027249
epoch:  11
epoch:  12 val_f1:  0.7412236216203913 val_auroc:  0.7913598429062347 val_auprc:  0.9150058611805003
Validation loss improved to 1.010513
epoch:  12
epoch:  13 val_f1:  0.7420910227448273 val_auroc:  0.7960235640648012 val_auprc:  0.9164757084918558
Validation loss improved to 0.998354
epoch:  13
epoch:  14 val_f1:  0.7542604103291037 val_auroc:  0.8026509572901325 val_auprc:  0.9196667115751582
Validation loss improved to 0.987436
epoch:  14
epoch:  15 val_f1:  0.6956984934700323 val_auroc:  0.8053510063819341 val_auprc:  0.9205270914294408
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7494347379239465 val_auroc:  0.8075601374570446 val_auprc:  0.9221652162296067
Validation loss improved to 0.972765
epoch:  16
epoch:  17 val_f1:  0.7510257046352308 val_auroc:  0.8092783505154639 val_auprc:  0.9231565582804043
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.7577565132360132 val_auroc:  0.8114874815905745 val_auprc:  0.9239302733426249
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7477455593342162 val_auroc:  0.8114874815905744 val_auprc:  0.9230377674201724
Validation loss improved to 0.962608
epoch:  19
epoch:  20 val_f1:  0.7513203127712835 val_auroc:  0.8114874815905744 val_auprc:  0.9235515629118893
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7617596949267598 val_auroc:  0.8168875797741777 val_auprc:  0.9248178654146919
Validation loss improved to 0.956296
epoch:  21
epoch:  22 val_f1:  0.7362024088594293 val_auroc:  0.8122238586156112 val_auprc:  0.9226060718717277
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.6876087591262989 val_auroc:  0.8119783996072656 val_auprc:  0.9222237655386015
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.702570289683208 val_auroc:  0.8112420225822289 val_auprc:  0.9219853298146792
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.7672775806504117 val_auroc:  0.8134511536573392 val_auprc:  0.9216140775608694
Validation loss improved to 0.954745
epoch:  25
epoch:  26 val_f1:  0.708480907581627 val_auroc:  0.8132056946489936 val_auprc:  0.9198448751563935
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7607703458551531 val_auroc:  0.8122238586156111 val_auprc:  0.9206166857957463
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7500864926036699 val_auroc:  0.8117329405989201 val_auprc:  0.9203139122075448
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.7607703458551531 val_auroc:  0.8122238586156113 val_auprc:  0.9200393156523954
EarlyStopping counter: 4 out of 50
epoch:  29
epoch:  30 val_f1:  0.7542604103291037 val_auroc:  0.8134511536573392 val_auprc:  0.9204960857598518
EarlyStopping counter: 5 out of 50
epoch:  30
epoch:  31 val_f1:  0.7490302789770621 val_auroc:  0.8122238586156112 val_auprc:  0.9191314232201006
EarlyStopping counter: 6 out of 50
epoch:  31
epoch:  32 val_f1:  0.7661184054361647 val_auroc:  0.8134511536573392 val_auprc:  0.9204087390468736
EarlyStopping counter: 7 out of 50
epoch:  32
epoch:  33 val_f1:  0.7648187281552264 val_auroc:  0.8146784486990672 val_auprc:  0.9206407571807464
EarlyStopping counter: 8 out of 50
epoch:  33
epoch:  34 val_f1:  0.7648187281552264 val_auroc:  0.8141875306823761 val_auprc:  0.9200739512530891
EarlyStopping counter: 9 out of 50
epoch:  34
epoch:  35 val_f1:  0.7648187281552264 val_auroc:  0.8136966126656849 val_auprc:  0.919245201090646
EarlyStopping counter: 10 out of 50
epoch:  35
epoch:  36 val_f1:  0.7359369647139431 val_auroc:  0.81173294059892 val_auprc:  0.9174474838212364
EarlyStopping counter: 11 out of 50
epoch:  36
epoch:  37 val_f1:  0.7034651178140057 val_auroc:  0.8090328915071183 val_auprc:  0.9155238734116722
EarlyStopping counter: 12 out of 50
epoch:  37
epoch:  38 val_f1:  0.7034651178140057 val_auroc:  0.8080510554737358 val_auprc:  0.9151475169186981
EarlyStopping counter: 13 out of 50
epoch:  38
epoch:  39 val_f1:  0.7082463061808618 val_auroc:  0.8001963672066765 val_auprc:  0.9094815430107464
EarlyStopping counter: 14 out of 50
epoch:  39
epoch:  40 val_f1:  0.7226305629385982 val_auroc:  0.8038782523318606 val_auprc:  0.9112702265617767
EarlyStopping counter: 15 out of 50
epoch:  40
epoch:  41 val_f1:  0.757304835743056 val_auroc:  0.8068237604320079 val_auprc:  0.9134579456675339
EarlyStopping counter: 16 out of 50
epoch:  41
epoch:  42 val_f1:  0.7559325673789327 val_auroc:  0.8134511536573392 val_auprc:  0.9177387628449207
EarlyStopping counter: 17 out of 50
epoch:  42
epoch:  43 val_f1:  0.7569659388768054 val_auroc:  0.8173784977908689 val_auprc:  0.9203265842869501
EarlyStopping counter: 18 out of 50
epoch:  43
epoch:  44 val_f1:  0.7697841726618705 val_auroc:  0.8151693667157585 val_auprc:  0.919054442510653
EarlyStopping counter: 19 out of 50
epoch:  44
epoch:  45 val_f1:  0.7648187281552264 val_auroc:  0.812960235640648 val_auprc:  0.9171782214284958
EarlyStopping counter: 20 out of 50
epoch:  45
epoch:  46 val_f1:  0.7170452552783244 val_auroc:  0.8163966617574866 val_auprc:  0.9206244958148474
EarlyStopping counter: 21 out of 50
epoch:  46
epoch:  47 val_f1:  0.7375047745919104 val_auroc:  0.8178694158075602 val_auprc:  0.9215701839020022
EarlyStopping counter: 22 out of 50
epoch:  47
epoch:  48 val_f1:  0.7699730743399811 val_auroc:  0.8195876288659795 val_auprc:  0.9219339443703257
EarlyStopping counter: 23 out of 50
epoch:  48
epoch:  49 val_f1:  0.7727225509205256 val_auroc:  0.8205694648993618 val_auprc:  0.9217013060676
EarlyStopping counter: 24 out of 50
epoch:  49
epoch:  50 val_f1:  0.76000113614692 val_auroc:  0.8176239567992145 val_auprc:  0.9184882781845716
EarlyStopping counter: 25 out of 50
epoch:  50
epoch:  51 val_f1:  0.766354189375772 val_auroc:  0.8166421207658321 val_auprc:  0.9173923755553749
EarlyStopping counter: 26 out of 50
epoch:  51
epoch:  52 val_f1:  0.7712620601193464 val_auroc:  0.8181148748159057 val_auprc:  0.9194281359532194
EarlyStopping counter: 27 out of 50
epoch:  52
epoch:  53 val_f1:  0.7536606851900262 val_auroc:  0.8161512027491409 val_auprc:  0.9174451492670598
EarlyStopping counter: 28 out of 50
epoch:  53
epoch:  54 val_f1:  0.76000113614692 val_auroc:  0.8144329896907216 val_auprc:  0.9170700498643862
EarlyStopping counter: 29 out of 50
epoch:  54
epoch:  55 val_f1:  0.7536606851900262 val_auroc:  0.8144329896907216 val_auprc:  0.9159952035754899
EarlyStopping counter: 30 out of 50
epoch:  55
epoch:  56 val_f1:  0.76000113614692 val_auroc:  0.8151693667157585 val_auprc:  0.9160205966031948
EarlyStopping counter: 31 out of 50
epoch:  56
epoch:  57 val_f1:  0.751751326211758 val_auroc:  0.8154148257241041 val_auprc:  0.9155390979220126
EarlyStopping counter: 32 out of 50
epoch:  57
epoch:  58 val_f1:  0.7559325673789327 val_auroc:  0.8092783505154639 val_auprc:  0.9123372063056641
EarlyStopping counter: 33 out of 50
epoch:  58
epoch:  59 val_f1:  0.7559325673789327 val_auroc:  0.8100147275405007 val_auprc:  0.9118480788842779
EarlyStopping counter: 34 out of 50
epoch:  59
epoch:  60 val_f1:  0.7633714058926586 val_auroc:  0.8151693667157585 val_auprc:  0.9159590871151566
EarlyStopping counter: 35 out of 50
epoch:  60
epoch:  61 val_f1:  0.7622262794246104 val_auroc:  0.8100147275405006 val_auprc:  0.9109784102741056
EarlyStopping counter: 36 out of 50
epoch:  61
epoch:  62 val_f1:  0.7748796193569787 val_auroc:  0.8068237604320079 val_auprc:  0.9090039877568257
EarlyStopping counter: 37 out of 50
epoch:  62
epoch:  63 val_f1:  0.7473302173830908 val_auroc:  0.812960235640648 val_auprc:  0.913752749149589
EarlyStopping counter: 38 out of 50
epoch:  63
epoch:  64 val_f1:  0.7454557504588546 val_auroc:  0.810505645557192 val_auprc:  0.9119216918130783
EarlyStopping counter: 39 out of 50
epoch:  64
epoch:  65 val_f1:  0.751751326211758 val_auroc:  0.809769268532155 val_auprc:  0.9117102549450783
EarlyStopping counter: 40 out of 50
epoch:  65
epoch:  66 val_f1:  0.7812454480117876 val_auroc:  0.8060873834069711 val_auprc:  0.908148784370229
EarlyStopping counter: 41 out of 50
epoch:  66
epoch:  67 val_f1:  0.743396428458658 val_auroc:  0.8100147275405007 val_auprc:  0.911292376488613
EarlyStopping counter: 42 out of 50
epoch:  67
epoch:  68 val_f1:  0.7712620601193464 val_auroc:  0.8112420225822288 val_auprc:  0.9116332202411918
EarlyStopping counter: 43 out of 50
epoch:  68
epoch:  69 val_f1:  0.751751326211758 val_auroc:  0.8109965635738832 val_auprc:  0.9109818041872917
EarlyStopping counter: 44 out of 50
epoch:  69
epoch:  70 val_f1:  0.7622262794246104 val_auroc:  0.8087874324987728 val_auprc:  0.9088183107031587
EarlyStopping counter: 45 out of 50
epoch:  70
epoch:  71 val_f1:  0.7622262794246104 val_auroc:  0.8102601865488464 val_auprc:  0.9096427234355768
EarlyStopping counter: 46 out of 50
epoch:  71
epoch:  72 val_f1:  0.7724732835091151 val_auroc:  0.8046146293568973 val_auprc:  0.9072105601006273
EarlyStopping counter: 47 out of 50
epoch:  72
epoch:  73 val_f1:  0.7812454480117876 val_auroc:  0.8073146784486991 val_auprc:  0.9069705782317308
EarlyStopping counter: 48 out of 50
epoch:  73
epoch:  74 val_f1:  0.7812454480117876 val_auroc:  0.8075601374570448 val_auprc:  0.9071831370852926
EarlyStopping counter: 49 out of 50
epoch:  74
epoch:  75 val_f1:  0.7812454480117876 val_auroc:  0.8021600392734413 val_auprc:  0.9044994683409618
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  230.02700686454773
{'time_elapsed': [230.02700686454773], 'epoch': [74], 'fold': [1], 'f1_train': [0.989206945677534], 'auroc_train': [0.9995707759757182], 'auprc_train': [0.9998122580866993], 'f1_test': [0.7812454480117876], 'auroc_test': [0.8021600392734413], 'auprc_test': [0.9044994683409618]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 256]           6,144
│    └─BatchNorm1d: 2-2                  [64, 1024, 256]           2,048
│    └─Tanh: 2-3                         [64, 1024, 256]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 51]            --
│    └─Dropout: 2-5                      [64, 1024, 51]            --
│    └─Flatten: 2-6                      [64, 52224]               --
│    └─Linear: 2-7                       [64, 1]                   52,225
==========================================================================================
Total params: 60,417
Trainable params: 60,417
Non-trainable params: 0
Total mult-adds (M): 104.14
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 268.44
Params size (MB): 0.24
Estimated Total Size (MB): 269.01
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.5864015709376534 val_auprc:  0.8030548926015115
epoch:  1
epoch:  2 val_f1:  0.5492721446269734 val_auroc:  0.5058910162002945 val_auprc:  0.7115459235096316
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.5857532631262036 val_auroc:  0.5073637702503682 val_auprc:  0.7138862576301537
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5997955253931118 val_auroc:  0.5135002454590083 val_auprc:  0.7201424664570857
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.5059269028522264 val_auroc:  0.5225822287677958 val_auprc:  0.7341957530882022
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.5797741100300449 val_auroc:  0.5355915562101129 val_auprc:  0.751609489536393
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.5210000973269918 val_auroc:  0.5510554737358861 val_auprc:  0.7645120997673565
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.5431365077429582 val_auroc:  0.5628375061364752 val_auprc:  0.7748043273190839
EarlyStopping counter: 7 out of 50
epoch:  8
epoch:  9 val_f1:  0.6216183390013243 val_auroc:  0.5763377515954835 val_auprc:  0.78561570743695
EarlyStopping counter: 8 out of 50
epoch:  9
epoch:  10 val_f1:  0.6145472792662655 val_auroc:  0.5925380461462935 val_auprc:  0.797881929032154
EarlyStopping counter: 9 out of 50
epoch:  10
epoch:  11 val_f1:  0.5063210807344186 val_auroc:  0.6057928325969564 val_auprc:  0.8064907115347643
EarlyStopping counter: 10 out of 50
epoch:  11
epoch:  12 val_f1:  0.607604203408781 val_auroc:  0.6205203730976927 val_auprc:  0.8168353761542421
Validation loss improved to 1.265392
epoch:  12
epoch:  13 val_f1:  0.6318240310439324 val_auroc:  0.6369661266568484 val_auprc:  0.8270962552767822
Validation loss improved to 1.228651
epoch:  13
epoch:  14 val_f1:  0.646262304336327 val_auroc:  0.6553755522827689 val_auprc:  0.8384738611836313
Validation loss improved to 1.186859
epoch:  14
epoch:  15 val_f1:  0.591898769565332 val_auroc:  0.6698576337751596 val_auprc:  0.8467293004581136
Validation loss improved to 1.179588
epoch:  15
epoch:  16 val_f1:  0.517797702136798 val_auroc:  0.6828669612174767 val_auprc:  0.8520884969937738
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.6132839556339524 val_auroc:  0.6975945017182131 val_auprc:  0.8599822434615563
Validation loss improved to 1.128395
epoch:  17
epoch:  18 val_f1:  0.5053701858578568 val_auroc:  0.706921944035346 val_auprc:  0.8642847527348696
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.3583244260819672 val_auroc:  0.7118311242022582 val_auprc:  0.8656116073755735
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.5838273142196633 val_auroc:  0.7265586647029946 val_auprc:  0.873598766485778
EarlyStopping counter: 3 out of 50
epoch:  20
epoch:  21 val_f1:  0.5900086904324611 val_auroc:  0.7329405989199803 val_auprc:  0.8751645357054403
EarlyStopping counter: 4 out of 50
epoch:  21
epoch:  22 val_f1:  0.6872742077065929 val_auroc:  0.7439862542955327 val_auprc:  0.8794594542729748
Validation loss improved to 1.075741
epoch:  22
epoch:  23 val_f1:  0.6889840728573212 val_auroc:  0.7449680903289151 val_auprc:  0.8801387467736697
Validation loss improved to 1.056418
epoch:  23
epoch:  24 val_f1:  0.6963248678165901 val_auroc:  0.748159057437408 val_auprc:  0.8814925621949307
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.6963248678165901 val_auroc:  0.7488954344624448 val_auprc:  0.8820031020796992
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.6892815309975336 val_auroc:  0.7557682866961217 val_auprc:  0.8852109037242296
Validation loss improved to 1.043791
epoch:  26
epoch:  27 val_f1:  0.69663104467882 val_auroc:  0.7614138438880707 val_auprc:  0.8890405621596855
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7140703059967902 val_auroc:  0.7653411880216004 val_auprc:  0.8907476726639432
EarlyStopping counter: 2 out of 50
epoch:  28
epoch:  29 val_f1:  0.7281499969472504 val_auroc:  0.7648502700049091 val_auprc:  0.889579533139451
Validation loss improved to 1.032811
epoch:  29
epoch:  30 val_f1:  0.7362024088594293 val_auroc:  0.7628865979381444 val_auprc:  0.8881322524957653
Validation loss improved to 1.030256
epoch:  30
epoch:  31 val_f1:  0.7098736982331642 val_auroc:  0.7621502209131075 val_auprc:  0.887506907429848
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.7215941532488295 val_auroc:  0.7677957781050565 val_auprc:  0.8908470386433941
Validation loss improved to 1.027834
epoch:  32
epoch:  33 val_f1:  0.6893510131556864 val_auroc:  0.7626411389297987 val_auprc:  0.8879385958184494
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.703263898025454 val_auroc:  0.7648502700049092 val_auprc:  0.8891928280535121
EarlyStopping counter: 2 out of 50
epoch:  34
epoch:  35 val_f1:  0.6963248678165901 val_auroc:  0.7638684339715268 val_auprc:  0.8887245240891875
EarlyStopping counter: 3 out of 50
epoch:  35
epoch:  36 val_f1:  0.7197172881491292 val_auroc:  0.7695139911634757 val_auprc:  0.8908522696042882
EarlyStopping counter: 4 out of 50
epoch:  36
epoch:  37 val_f1:  0.730071543320129 val_auroc:  0.7690230731467844 val_auprc:  0.8902926033587809
EarlyStopping counter: 5 out of 50
epoch:  37
epoch:  38 val_f1:  0.735514445586388 val_auroc:  0.7741777123220422 val_auprc:  0.8932320144460016
EarlyStopping counter: 6 out of 50
epoch:  38
epoch:  39 val_f1:  0.7287333672277241 val_auroc:  0.7776141384388807 val_auprc:  0.8941956106537455
EarlyStopping counter: 7 out of 50
epoch:  39
epoch:  40 val_f1:  0.7298555432283743 val_auroc:  0.7803141875306824 val_auprc:  0.8953787620524715
EarlyStopping counter: 8 out of 50
epoch:  40
epoch:  41 val_f1:  0.7298555432283743 val_auroc:  0.7768777614138439 val_auprc:  0.8933228860123283
EarlyStopping counter: 9 out of 50
epoch:  41
epoch:  42 val_f1:  0.7287333672277241 val_auroc:  0.7761413843888071 val_auprc:  0.8915577434812795
EarlyStopping counter: 10 out of 50
epoch:  42
epoch:  43 val_f1:  0.7304528631430115 val_auroc:  0.7734413352970054 val_auprc:  0.8895105994393189
EarlyStopping counter: 11 out of 50
epoch:  43
epoch:  44 val_f1:  0.7236892364125374 val_auroc:  0.7778595974472262 val_auprc:  0.892304175881669
EarlyStopping counter: 12 out of 50
epoch:  44
epoch:  45 val_f1:  0.7477455593342162 val_auroc:  0.7790868924889544 val_auprc:  0.892691174944458
EarlyStopping counter: 13 out of 50
epoch:  45
epoch:  46 val_f1:  0.7298555432283743 val_auroc:  0.7825233186057929 val_auprc:  0.8945195891213433
EarlyStopping counter: 14 out of 50
epoch:  46
epoch:  47 val_f1:  0.7411406017655346 val_auroc:  0.7795778105056457 val_auprc:  0.891825774497777
EarlyStopping counter: 15 out of 50
epoch:  47
epoch:  48 val_f1:  0.7304528631430115 val_auroc:  0.7788414334806087 val_auprc:  0.8927560935107566
EarlyStopping counter: 16 out of 50
epoch:  48
epoch:  49 val_f1:  0.726175885795287 val_auroc:  0.780559646539028 val_auprc:  0.8926646487420249
EarlyStopping counter: 17 out of 50
epoch:  49
epoch:  50 val_f1:  0.7411406017655346 val_auroc:  0.7803141875306824 val_auprc:  0.8927709050924305
EarlyStopping counter: 18 out of 50
epoch:  50
epoch:  51 val_f1:  0.7304528631430115 val_auroc:  0.7663230240549828 val_auprc:  0.8846050803413218
EarlyStopping counter: 19 out of 50
epoch:  51
epoch:  52 val_f1:  0.7304528631430115 val_auroc:  0.7665684830633284 val_auprc:  0.8847456953455526
EarlyStopping counter: 20 out of 50
epoch:  52
epoch:  53 val_f1:  0.7371937993371881 val_auroc:  0.770004909180167 val_auprc:  0.8862416394476499
EarlyStopping counter: 21 out of 50
epoch:  53
epoch:  54 val_f1:  0.703263898025454 val_auroc:  0.7754050073637703 val_auprc:  0.8899857704114225
EarlyStopping counter: 22 out of 50
epoch:  54
epoch:  55 val_f1:  0.7371937993371881 val_auroc:  0.7751595483554247 val_auprc:  0.8895456463500089
EarlyStopping counter: 23 out of 50
epoch:  55
epoch:  56 val_f1:  0.7375047745919104 val_auroc:  0.7697594501718213 val_auprc:  0.8852922532730025
EarlyStopping counter: 24 out of 50
epoch:  56
epoch:  57 val_f1:  0.7150229029574715 val_auroc:  0.7746686303387335 val_auprc:  0.8880296498844833
EarlyStopping counter: 25 out of 50
epoch:  57
epoch:  58 val_f1:  0.7454557504588546 val_auroc:  0.7739322533136966 val_auprc:  0.8875752192401819
EarlyStopping counter: 26 out of 50
epoch:  58
epoch:  59 val_f1:  0.7281499969472504 val_auroc:  0.7741777123220422 val_auprc:  0.8875748755498787
EarlyStopping counter: 27 out of 50
epoch:  59
epoch:  60 val_f1:  0.7337314237416728 val_auroc:  0.7793323514973 val_auprc:  0.8914610720576407
EarlyStopping counter: 28 out of 50
epoch:  60
epoch:  61 val_f1:  0.7289242247644242 val_auroc:  0.7751595483554247 val_auprc:  0.8884294994651474
EarlyStopping counter: 29 out of 50
epoch:  61
epoch:  62 val_f1:  0.7371484630477437 val_auroc:  0.7788414334806087 val_auprc:  0.8914937192202979
EarlyStopping counter: 30 out of 50
epoch:  62
epoch:  63 val_f1:  0.7298555432283743 val_auroc:  0.7771232204221895 val_auprc:  0.8903343809347837
EarlyStopping counter: 31 out of 50
epoch:  63
epoch:  64 val_f1:  0.682026026688228 val_auroc:  0.7641138929798724 val_auprc:  0.8827117751343643
EarlyStopping counter: 32 out of 50
epoch:  64
epoch:  65 val_f1:  0.7090514753972222 val_auroc:  0.7682866961217477 val_auprc:  0.885370506779505
EarlyStopping counter: 33 out of 50
epoch:  65
epoch:  66 val_f1:  0.7090514753972222 val_auroc:  0.771232204221895 val_auprc:  0.8870467621395518
EarlyStopping counter: 34 out of 50
epoch:  66
epoch:  67 val_f1:  0.7090514753972222 val_auroc:  0.7729504172803142 val_auprc:  0.8875071192761694
EarlyStopping counter: 35 out of 50
epoch:  67
epoch:  68 val_f1:  0.7349308245711123 val_auroc:  0.7702503681885126 val_auprc:  0.8854777060320672
EarlyStopping counter: 36 out of 50
epoch:  68
epoch:  69 val_f1:  0.7156947373800909 val_auroc:  0.7709867452135494 val_auprc:  0.8859175166720934
EarlyStopping counter: 37 out of 50
epoch:  69
epoch:  70 val_f1:  0.722058496910722 val_auroc:  0.7695139911634757 val_auprc:  0.8851315085010434
EarlyStopping counter: 38 out of 50
epoch:  70
epoch:  71 val_f1:  0.713247796930704 val_auroc:  0.770004909180167 val_auprc:  0.8857364859613976
EarlyStopping counter: 39 out of 50
epoch:  71
epoch:  72 val_f1:  0.7095299887411026 val_auroc:  0.7655866470299459 val_auprc:  0.8826845942603831
EarlyStopping counter: 40 out of 50
epoch:  72
epoch:  73 val_f1:  0.7084342413709481 val_auroc:  0.7677957781050565 val_auprc:  0.8843074989522361
EarlyStopping counter: 41 out of 50
epoch:  73
epoch:  74 val_f1:  0.7095299887411026 val_auroc:  0.7675503190967109 val_auprc:  0.8837910343872424
EarlyStopping counter: 42 out of 50
epoch:  74
epoch:  75 val_f1:  0.7236892364125374 val_auroc:  0.7687776141384389 val_auprc:  0.8861911592022998
EarlyStopping counter: 43 out of 50
epoch:  75
epoch:  76 val_f1:  0.7166299330477814 val_auroc:  0.7682866961217477 val_auprc:  0.8842381280281704
EarlyStopping counter: 44 out of 50
epoch:  76
epoch:  77 val_f1:  0.7150229029574715 val_auroc:  0.7665684830633284 val_auprc:  0.8834664050435945
EarlyStopping counter: 45 out of 50
epoch:  77
epoch:  78 val_f1:  0.7263486361521366 val_auroc:  0.7704958271968582 val_auprc:  0.8846814273995199
EarlyStopping counter: 46 out of 50
epoch:  78
epoch:  79 val_f1:  0.7410071942446043 val_auroc:  0.7680412371134021 val_auprc:  0.8844204263265212
EarlyStopping counter: 47 out of 50
epoch:  79
epoch:  80 val_f1:  0.7536606851900262 val_auroc:  0.7680412371134021 val_auprc:  0.8845139480624133
EarlyStopping counter: 48 out of 50
epoch:  80
epoch:  81 val_f1:  0.7410071942446043 val_auroc:  0.766813942071674 val_auprc:  0.8828479607582082
EarlyStopping counter: 49 out of 50
epoch:  81
epoch:  82 val_f1:  0.7197172881491292 val_auroc:  0.7680412371134021 val_auprc:  0.8836121919135953
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  248.12546181678772
{'time_elapsed': [248.12546181678772], 'epoch': [81], 'fold': [2], 'f1_train': [0.9452609294211752], 'auroc_train': [0.9972253732716068], 'auprc_train': [0.9987961168553622], 'f1_test': [0.7197172881491292], 'auroc_test': [0.7680412371134021], 'auprc_test': [0.8836121919135953]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 256]           6,144
│    └─BatchNorm1d: 2-2                  [64, 1024, 256]           2,048
│    └─Tanh: 2-3                         [64, 1024, 256]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 51]            --
│    └─Dropout: 2-5                      [64, 1024, 51]            --
│    └─Flatten: 2-6                      [64, 52224]               --
│    └─Linear: 2-7                       [64, 1]                   52,225
==========================================================================================
Total params: 60,417
Trainable params: 60,417
Non-trainable params: 0
Total mult-adds (M): 104.14
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 268.44
Params size (MB): 0.24
Estimated Total Size (MB): 269.01
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6745184497563239 val_auroc:  0.6908914728682171 val_auprc:  0.8319682532958987
epoch:  1
epoch:  2 val_f1:  0.4467582189117066 val_auroc:  0.6448643410852714 val_auprc:  0.7752447861622175
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6234273704631801 val_auroc:  0.6375968992248062 val_auprc:  0.770322067044706
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6690647482014388 val_auroc:  0.6504360465116279 val_auprc:  0.7798199529875639
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6791459288428006 val_auroc:  0.6814437984496124 val_auprc:  0.807458885739089
Validation loss improved to 1.080333
epoch:  5
epoch:  6 val_f1:  0.5777808565385616 val_auroc:  0.7340116279069766 val_auprc:  0.8487883242003122
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.7423002024626313 val_auroc:  0.7788275193798451 val_auprc:  0.8843028488095134
Validation loss improved to 0.996512
epoch:  7
epoch:  8 val_f1:  0.6832158193710812 val_auroc:  0.7882751937984496 val_auprc:  0.8965348630669941
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.6962717739268124 val_auroc:  0.7948158914728681 val_auprc:  0.9041604882689449
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.7392589610196967 val_auroc:  0.8040213178294574 val_auprc:  0.9102811895241955
Validation loss improved to 0.974568
epoch:  10
epoch:  11 val_f1:  0.7428507568425149 val_auroc:  0.8088662790697675 val_auprc:  0.912787046357181
Validation loss improved to 0.936874
epoch:  11
epoch:  12 val_f1:  0.7571561248111338 val_auroc:  0.8141957364341086 val_auprc:  0.9163138674654473
Validation loss improved to 0.919874
epoch:  12
epoch:  13 val_f1:  0.7500238535961682 val_auroc:  0.8187984496124031 val_auprc:  0.9189118005182293
Validation loss improved to 0.904465
epoch:  13
epoch:  14 val_f1:  0.7695564219015847 val_auroc:  0.8212209302325582 val_auprc:  0.9186651269046379
Validation loss improved to 0.894111
epoch:  14
epoch:  15 val_f1:  0.7724509753899008 val_auroc:  0.8248546511627907 val_auprc:  0.9196179387425105
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7548273393587915 val_auroc:  0.8258236434108527 val_auprc:  0.9209282570056339
Validation loss improved to 0.874204
epoch:  16
epoch:  17 val_f1:  0.7639114172852699 val_auroc:  0.8289728682170543 val_auprc:  0.9227117932559536
Validation loss improved to 0.856637
epoch:  17
epoch:  18 val_f1:  0.7811523753969797 val_auroc:  0.8301841085271318 val_auprc:  0.9228792388103819
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7714826564458221 val_auroc:  0.8311531007751938 val_auprc:  0.9246977501503092
Validation loss improved to 0.848968
epoch:  19
epoch:  20 val_f1:  0.6629856115107914 val_auroc:  0.8338178294573644 val_auprc:  0.9267504920052606
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7646080538166868 val_auroc:  0.8369670542635659 val_auprc:  0.9283246826555451
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7644817479349855 val_auroc:  0.8369670542635659 val_auprc:  0.928247073209937
Validation loss improved to 0.837373
epoch:  22
epoch:  23 val_f1:  0.7754499696945739 val_auroc:  0.8376937984496123 val_auprc:  0.9281460515007305
Validation loss improved to 0.823689
epoch:  23
epoch:  24 val_f1:  0.7768458491633659 val_auroc:  0.8401162790697675 val_auprc:  0.929702455756265
Validation loss improved to 0.809937
epoch:  24
epoch:  25 val_f1:  0.7841726618705036 val_auroc:  0.8425387596899224 val_auprc:  0.9299861195142652
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.792019787311512 val_auroc:  0.8435077519379844 val_auprc:  0.9303029420272554
EarlyStopping counter: 2 out of 50
epoch:  26
epoch:  27 val_f1:  0.7952715769842713 val_auroc:  0.8435077519379844 val_auprc:  0.9320194754145352
Validation loss improved to 0.809131
epoch:  27
epoch:  28 val_f1:  0.7835226993620948 val_auroc:  0.8439922480620156 val_auprc:  0.9326148554745914
Validation loss improved to 0.789185
epoch:  28
epoch:  29 val_f1:  0.7894843465886632 val_auroc:  0.8473837209302325 val_auprc:  0.9343374418057103
Validation loss improved to 0.781440
epoch:  29
epoch:  30 val_f1:  0.7811523753969797 val_auroc:  0.8488372093023256 val_auprc:  0.933159551960119
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7701596400342386 val_auroc:  0.8478682170542635 val_auprc:  0.93435026017689
Validation loss improved to 0.774186
epoch:  31
epoch:  32 val_f1:  0.7701596400342386 val_auroc:  0.8490794573643411 val_auprc:  0.9352156036839279
Validation loss improved to 0.772264
epoch:  32
epoch:  33 val_f1:  0.7801238118631262 val_auroc:  0.8490794573643411 val_auprc:  0.9348246000706057
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.8063632502555458 val_auroc:  0.8507751937984497 val_auprc:  0.9355246459255397
EarlyStopping counter: 2 out of 50
epoch:  34
epoch:  35 val_f1:  0.7886649052635782 val_auroc:  0.8515019379844961 val_auprc:  0.9360877948639819
EarlyStopping counter: 3 out of 50
epoch:  35
epoch:  36 val_f1:  0.7997900244397783 val_auroc:  0.8527131782945737 val_auprc:  0.9361367219086436
EarlyStopping counter: 4 out of 50
epoch:  36
epoch:  37 val_f1:  0.8102961135322703 val_auroc:  0.8527131782945735 val_auprc:  0.9366625344238377
EarlyStopping counter: 5 out of 50
epoch:  37
epoch:  38 val_f1:  0.7972014141264308 val_auroc:  0.8544089147286822 val_auprc:  0.9376885110752993
EarlyStopping counter: 6 out of 50
epoch:  38
epoch:  39 val_f1:  0.7997900244397783 val_auroc:  0.8546511627906976 val_auprc:  0.9376506612372095
EarlyStopping counter: 7 out of 50
epoch:  39
epoch:  40 val_f1:  0.7735780520043992 val_auroc:  0.8541666666666666 val_auprc:  0.938653770007976
EarlyStopping counter: 8 out of 50
epoch:  40
epoch:  41 val_f1:  0.7932273763653603 val_auroc:  0.8524709302325582 val_auprc:  0.9377845794818027
EarlyStopping counter: 9 out of 50
epoch:  41
epoch:  42 val_f1:  0.7875752415552048 val_auroc:  0.8548934108527133 val_auprc:  0.9375632977750583
EarlyStopping counter: 10 out of 50
epoch:  42
epoch:  43 val_f1:  0.768937708914086 val_auroc:  0.8578003875968991 val_auprc:  0.9388656998248677
EarlyStopping counter: 11 out of 50
epoch:  43
epoch:  44 val_f1:  0.8129496402877698 val_auroc:  0.8587693798449612 val_auprc:  0.9394749056666445
EarlyStopping counter: 12 out of 50
epoch:  44
epoch:  45 val_f1:  0.7886649052635782 val_auroc:  0.8570736434108527 val_auprc:  0.9397922056821805
Validation loss improved to 0.754514
epoch:  45
epoch:  46 val_f1:  0.7866727894280321 val_auroc:  0.8582848837209303 val_auprc:  0.9407140117634395
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.7801238118631262 val_auroc:  0.8578003875968991 val_auprc:  0.9402254429899686
EarlyStopping counter: 2 out of 50
epoch:  47
epoch:  48 val_f1:  0.7972014141264308 val_auroc:  0.8582848837209303 val_auprc:  0.9407468379660399
EarlyStopping counter: 3 out of 50
epoch:  48
epoch:  49 val_f1:  0.7906801532257888 val_auroc:  0.8575581395348837 val_auprc:  0.9413298754775612
EarlyStopping counter: 4 out of 50
epoch:  49
epoch:  50 val_f1:  0.7735780520043992 val_auroc:  0.8594961240310077 val_auprc:  0.9419352689679954
EarlyStopping counter: 5 out of 50
epoch:  50
epoch:  51 val_f1:  0.7811523753969797 val_auroc:  0.8592538759689923 val_auprc:  0.9417851973723328
EarlyStopping counter: 6 out of 50
epoch:  51
epoch:  52 val_f1:  0.7789671954250403 val_auroc:  0.8587693798449612 val_auprc:  0.9419364972941566
EarlyStopping counter: 7 out of 50
epoch:  52
epoch:  53 val_f1:  0.8041795135320315 val_auroc:  0.8597383720930233 val_auprc:  0.9427749467796639
EarlyStopping counter: 8 out of 50
epoch:  53
epoch:  54 val_f1:  0.7789671954250403 val_auroc:  0.8597383720930233 val_auprc:  0.9421588509852938
EarlyStopping counter: 9 out of 50
epoch:  54
epoch:  55 val_f1:  0.8022252248962252 val_auroc:  0.8619186046511628 val_auprc:  0.9419588320447327
EarlyStopping counter: 10 out of 50
epoch:  55
epoch:  56 val_f1:  0.8022252248962252 val_auroc:  0.8602228682170543 val_auprc:  0.9413702026578772
EarlyStopping counter: 11 out of 50
epoch:  56
epoch:  57 val_f1:  0.7841726618705036 val_auroc:  0.8599806201550387 val_auprc:  0.9419684982224635
EarlyStopping counter: 12 out of 50
epoch:  57
epoch:  58 val_f1:  0.792019787311512 val_auroc:  0.8599806201550388 val_auprc:  0.9423178855311679
EarlyStopping counter: 13 out of 50
epoch:  58
epoch:  59 val_f1:  0.7875752415552048 val_auroc:  0.8616763565891473 val_auprc:  0.9431400356189096
EarlyStopping counter: 14 out of 50
epoch:  59
epoch:  60 val_f1:  0.7801238118631262 val_auroc:  0.8616763565891473 val_auprc:  0.943718245858389
EarlyStopping counter: 15 out of 50
epoch:  60
epoch:  61 val_f1:  0.7801238118631262 val_auroc:  0.8640988372093024 val_auprc:  0.9446676525048416
EarlyStopping counter: 16 out of 50
epoch:  61
epoch:  62 val_f1:  0.7952715769842713 val_auroc:  0.8624031007751938 val_auprc:  0.9443927403590128
EarlyStopping counter: 17 out of 50
epoch:  62
epoch:  63 val_f1:  0.8027539115793398 val_auroc:  0.8609496124031009 val_auprc:  0.9439462368296518
EarlyStopping counter: 18 out of 50
epoch:  63
epoch:  64 val_f1:  0.8035187234827523 val_auroc:  0.8611918604651162 val_auprc:  0.9440201271701634
EarlyStopping counter: 19 out of 50
epoch:  64
epoch:  65 val_f1:  0.7886649052635782 val_auroc:  0.8631298449612403 val_auprc:  0.9443010508003591
EarlyStopping counter: 20 out of 50
epoch:  65
epoch:  66 val_f1:  0.7952715769842713 val_auroc:  0.8640988372093023 val_auprc:  0.9450478253760097
EarlyStopping counter: 21 out of 50
epoch:  66
epoch:  67 val_f1:  0.792019787311512 val_auroc:  0.8653100775193799 val_auprc:  0.9456265789593211
EarlyStopping counter: 22 out of 50
epoch:  67
epoch:  68 val_f1:  0.7952715769842713 val_auroc:  0.8631298449612403 val_auprc:  0.9447591367248569
EarlyStopping counter: 23 out of 50
epoch:  68
epoch:  69 val_f1:  0.7866727894280321 val_auroc:  0.8631298449612403 val_auprc:  0.9452291877628876
EarlyStopping counter: 24 out of 50
epoch:  69
epoch:  70 val_f1:  0.7866727894280321 val_auroc:  0.8633720930232558 val_auprc:  0.944940654648368
EarlyStopping counter: 25 out of 50
epoch:  70
epoch:  71 val_f1:  0.794309372388086 val_auroc:  0.8616763565891472 val_auprc:  0.9441753070801762
EarlyStopping counter: 26 out of 50
epoch:  71
epoch:  72 val_f1:  0.7866727894280321 val_auroc:  0.8619186046511628 val_auprc:  0.9445103640236606
EarlyStopping counter: 27 out of 50
epoch:  72
epoch:  73 val_f1:  0.8018807955038493 val_auroc:  0.8599806201550387 val_auprc:  0.9436769764796175
EarlyStopping counter: 28 out of 50
epoch:  73
epoch:  74 val_f1:  0.794309372388086 val_auroc:  0.8624031007751938 val_auprc:  0.944626632617049
EarlyStopping counter: 29 out of 50
epoch:  74
epoch:  75 val_f1:  0.7776763243674784 val_auroc:  0.8645833333333334 val_auprc:  0.9453263655927628
EarlyStopping counter: 30 out of 50
epoch:  75
epoch:  76 val_f1:  0.7841726618705036 val_auroc:  0.8643410852713178 val_auprc:  0.9454812673430764
EarlyStopping counter: 31 out of 50
epoch:  76
epoch:  77 val_f1:  0.7857930944221151 val_auroc:  0.8643410852713178 val_auprc:  0.9451773470948647
EarlyStopping counter: 32 out of 50
epoch:  77
epoch:  78 val_f1:  0.792259730676997 val_auroc:  0.8633720930232558 val_auprc:  0.9446062512941997
EarlyStopping counter: 33 out of 50
epoch:  78
epoch:  79 val_f1:  0.7776763243674784 val_auroc:  0.8628875968992248 val_auprc:  0.9442873661142857
EarlyStopping counter: 34 out of 50
epoch:  79
epoch:  80 val_f1:  0.7776763243674784 val_auroc:  0.8633720930232558 val_auprc:  0.9446640239055444
EarlyStopping counter: 35 out of 50
epoch:  80
epoch:  81 val_f1:  0.7932273763653603 val_auroc:  0.8619186046511629 val_auprc:  0.9447198447259203
EarlyStopping counter: 36 out of 50
epoch:  81
epoch:  82 val_f1:  0.7932273763653603 val_auroc:  0.8624031007751938 val_auprc:  0.9450942589038189
EarlyStopping counter: 37 out of 50
epoch:  82
epoch:  83 val_f1:  0.7776763243674784 val_auroc:  0.8614341085271318 val_auprc:  0.9442483188092416
EarlyStopping counter: 38 out of 50
epoch:  83
epoch:  84 val_f1:  0.7906801532257888 val_auroc:  0.8621608527131783 val_auprc:  0.9446538696550285
EarlyStopping counter: 39 out of 50
epoch:  84
epoch:  85 val_f1:  0.7776763243674784 val_auroc:  0.8624031007751938 val_auprc:  0.9449033740889767
EarlyStopping counter: 40 out of 50
epoch:  85
epoch:  86 val_f1:  0.7776763243674784 val_auroc:  0.8638565891472868 val_auprc:  0.9454747735300693
EarlyStopping counter: 41 out of 50
epoch:  86
epoch:  87 val_f1:  0.7854893118997625 val_auroc:  0.8624031007751938 val_auprc:  0.9450091131180344
EarlyStopping counter: 42 out of 50
epoch:  87
epoch:  88 val_f1:  0.7854893118997625 val_auroc:  0.8619186046511629 val_auprc:  0.9446149652167961
EarlyStopping counter: 43 out of 50
epoch:  88
epoch:  89 val_f1:  0.7854893118997625 val_auroc:  0.8624031007751938 val_auprc:  0.9447607269549176
EarlyStopping counter: 44 out of 50
epoch:  89
epoch:  90 val_f1:  0.8093907785715628 val_auroc:  0.8616763565891472 val_auprc:  0.9445169732307765
EarlyStopping counter: 45 out of 50
epoch:  90
epoch:  91 val_f1:  0.7854893118997625 val_auroc:  0.8631298449612403 val_auprc:  0.9456130340925711
EarlyStopping counter: 46 out of 50
epoch:  91
epoch:  92 val_f1:  0.7854893118997625 val_auroc:  0.8616763565891473 val_auprc:  0.9449087093890555
EarlyStopping counter: 47 out of 50
epoch:  92
epoch:  93 val_f1:  0.7854893118997625 val_auroc:  0.8626453488372092 val_auprc:  0.945345468885308
EarlyStopping counter: 48 out of 50
epoch:  93
epoch:  94 val_f1:  0.7906801532257888 val_auroc:  0.8638565891472869 val_auprc:  0.9457670763094074
EarlyStopping counter: 49 out of 50
epoch:  94
epoch:  95 val_f1:  0.7906801532257888 val_auroc:  0.8626453488372092 val_auprc:  0.9452363112398543
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  286.5697491168976
{'time_elapsed': [286.5697491168976], 'epoch': [94], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7906801532257888], 'auroc_test': [0.8626453488372092], 'auprc_test': [0.9452363112398543]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 256]           6,144
│    └─BatchNorm1d: 2-2                  [64, 1024, 256]           2,048
│    └─Tanh: 2-3                         [64, 1024, 256]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 51]            --
│    └─Dropout: 2-5                      [64, 1024, 51]            --
│    └─Flatten: 2-6                      [64, 52224]               --
│    └─Linear: 2-7                       [64, 1]                   52,225
==========================================================================================
Total params: 60,417
Trainable params: 60,417
Non-trainable params: 0
Total mult-adds (M): 104.14
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 268.44
Params size (MB): 0.24
Estimated Total Size (MB): 269.01
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.45721137518280547 val_auroc:  0.8013392857142857 val_auprc:  0.9095464516163428
epoch:  1
epoch:  2 val_f1:  0.6680274886031162 val_auroc:  0.7063492063492063 val_auprc:  0.8494324803910186
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.5831504794027971 val_auroc:  0.7021329365079365 val_auprc:  0.841554972602238
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6643198390746795 val_auroc:  0.7170138888888888 val_auprc:  0.8589509311303863
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6792412617220801 val_auroc:  0.7428075396825399 val_auprc:  0.8765274769463633
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6873359624576251 val_auroc:  0.7666170634920634 val_auprc:  0.8885385422375097
Validation loss improved to 1.093124
epoch:  6
epoch:  7 val_f1:  0.672107584330718 val_auroc:  0.7867063492063492 val_auprc:  0.8973643222918176
Validation loss improved to 1.078021
epoch:  7
epoch:  8 val_f1:  0.6715428348021568 val_auroc:  0.806795634920635 val_auprc:  0.9034813174833222
Validation loss improved to 1.015277
epoch:  8
epoch:  9 val_f1:  0.7450280959405923 val_auroc:  0.8365575396825395 val_auprc:  0.9164802997021161
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.718035426731079 val_auroc:  0.8526785714285714 val_auprc:  0.9207675124735855
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.755213590069602 val_auroc:  0.8628472222222222 val_auprc:  0.9251172990112145
EarlyStopping counter: 3 out of 50
epoch:  11
epoch:  12 val_f1:  0.7564718869066693 val_auroc:  0.8616071428571428 val_auprc:  0.9243837477674481
Validation loss improved to 0.923410
epoch:  12
epoch:  13 val_f1:  0.7128626569146779 val_auroc:  0.8678075396825398 val_auprc:  0.9293602815344311
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7702983104477182 val_auroc:  0.8685515873015873 val_auprc:  0.9300775567195403
Validation loss improved to 0.897643
epoch:  14
epoch:  15 val_f1:  0.7901701323251418 val_auroc:  0.8695436507936509 val_auprc:  0.9299914968263979
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7822581250985979 val_auroc:  0.8712797619047619 val_auprc:  0.932774364901052
Validation loss improved to 0.881344
epoch:  16
epoch:  17 val_f1:  0.7702983104477182 val_auroc:  0.8705357142857143 val_auprc:  0.9365020870631561
Validation loss improved to 0.879095
epoch:  17
epoch:  18 val_f1:  0.7424375113599616 val_auroc:  0.8722718253968255 val_auprc:  0.9374689568833732
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7703937955759801 val_auroc:  0.873263888888889 val_auprc:  0.9386173324641136
Validation loss improved to 0.865115
epoch:  19
epoch:  20 val_f1:  0.7761264822134387 val_auroc:  0.8742559523809523 val_auprc:  0.9395972923388396
Validation loss improved to 0.847538
epoch:  20
epoch:  21 val_f1:  0.7901701323251418 val_auroc:  0.8742559523809524 val_auprc:  0.9390314958476728
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7889492753623188 val_auroc:  0.8742559523809524 val_auprc:  0.9391275829804011
Validation loss improved to 0.844651
epoch:  22
epoch:  23 val_f1:  0.8127933585226971 val_auroc:  0.8742559523809523 val_auprc:  0.939204984917074
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7755600530392909 val_auroc:  0.8740079365079365 val_auprc:  0.9392201407488177
Validation loss improved to 0.831136
epoch:  24
epoch:  25 val_f1:  0.7988956640912072 val_auroc:  0.8740079365079365 val_auprc:  0.9392141508958212
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.8061683443992288 val_auroc:  0.8735119047619048 val_auprc:  0.939089425484605
EarlyStopping counter: 2 out of 50
epoch:  26
epoch:  27 val_f1:  0.7833564971403972 val_auroc:  0.8772321428571428 val_auprc:  0.9404837536040263
Validation loss improved to 0.814288
epoch:  27
epoch:  28 val_f1:  0.7901185770750988 val_auroc:  0.8757440476190476 val_auprc:  0.9399533772433941
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.8015122873345937 val_auroc:  0.875 val_auprc:  0.9395046544091437
EarlyStopping counter: 2 out of 50
epoch:  29
epoch:  30 val_f1:  0.795635738397158 val_auroc:  0.8752480158730159 val_auprc:  0.9395301772938928
EarlyStopping counter: 3 out of 50
epoch:  30
epoch:  31 val_f1:  0.7837457330597287 val_auroc:  0.8772321428571429 val_auprc:  0.9409541318748346
Validation loss improved to 0.810334
epoch:  31
epoch:  32 val_f1:  0.7769308547872755 val_auroc:  0.876984126984127 val_auprc:  0.9407869735553882
Validation loss improved to 0.801835
epoch:  32
epoch:  33 val_f1:  0.7833564971403972 val_auroc:  0.8769841269841271 val_auprc:  0.9409969552379476
Validation loss improved to 0.797567
epoch:  33
epoch:  34 val_f1:  0.8030193236714975 val_auroc:  0.8752480158730159 val_auprc:  0.939721355091814
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.756376995929398 val_auroc:  0.878720238095238 val_auprc:  0.9421592760581701
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.7948558771909655 val_auroc:  0.8750000000000001 val_auprc:  0.9393523344703285
EarlyStopping counter: 3 out of 50
epoch:  36
epoch:  37 val_f1:  0.7769308547872755 val_auroc:  0.8767361111111112 val_auprc:  0.9407203912756915
Validation loss improved to 0.791494
epoch:  37
epoch:  38 val_f1:  0.7564718869066693 val_auroc:  0.878968253968254 val_auprc:  0.9419316926437542
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.7564718869066693 val_auroc:  0.8799603174603176 val_auprc:  0.9422537791925892
EarlyStopping counter: 2 out of 50
epoch:  39
epoch:  40 val_f1:  0.756376995929398 val_auroc:  0.8807043650793651 val_auprc:  0.9432006130458126
EarlyStopping counter: 3 out of 50
epoch:  40
epoch:  41 val_f1:  0.7494824016563146 val_auroc:  0.8772321428571429 val_auprc:  0.9416893105940545
EarlyStopping counter: 4 out of 50
epoch:  41
epoch:  42 val_f1:  0.7632485643970468 val_auroc:  0.8750000000000001 val_auprc:  0.9409873026993485
EarlyStopping counter: 5 out of 50
epoch:  42
epoch:  43 val_f1:  0.7837062051498522 val_auroc:  0.869295634920635 val_auprc:  0.9385822734900486
EarlyStopping counter: 6 out of 50
epoch:  43
epoch:  44 val_f1:  0.8014350667803353 val_auroc:  0.8707837301587303 val_auprc:  0.9392874988787776
EarlyStopping counter: 7 out of 50
epoch:  44
epoch:  45 val_f1:  0.8054462242562929 val_auroc:  0.8697916666666667 val_auprc:  0.9376179146822075
EarlyStopping counter: 8 out of 50
epoch:  45
epoch:  46 val_f1:  0.7760956602080848 val_auroc:  0.8752480158730159 val_auprc:  0.9397312546845841
EarlyStopping counter: 9 out of 50
epoch:  46
epoch:  47 val_f1:  0.770099160945843 val_auroc:  0.8826884920634921 val_auprc:  0.9429984982724424
EarlyStopping counter: 10 out of 50
epoch:  47
epoch:  48 val_f1:  0.8015122873345937 val_auroc:  0.8777281746031745 val_auprc:  0.940849775893773
EarlyStopping counter: 11 out of 50
epoch:  48
epoch:  49 val_f1:  0.8023197893688181 val_auroc:  0.880952380952381 val_auprc:  0.9422822954351617
EarlyStopping counter: 12 out of 50
epoch:  49
epoch:  50 val_f1:  0.800639197204071 val_auroc:  0.8757440476190477 val_auprc:  0.9403215342395537
EarlyStopping counter: 13 out of 50
epoch:  50
epoch:  51 val_f1:  0.8072024593763724 val_auroc:  0.8745039682539681 val_auprc:  0.9389144910892261
EarlyStopping counter: 14 out of 50
epoch:  51
epoch:  52 val_f1:  0.8035275913020209 val_auroc:  0.873015873015873 val_auprc:  0.9392680639300355
EarlyStopping counter: 15 out of 50
epoch:  52
epoch:  53 val_f1:  0.79396185483142 val_auroc:  0.8814484126984128 val_auprc:  0.9429684296850451
EarlyStopping counter: 16 out of 50
epoch:  53
epoch:  54 val_f1:  0.795635738397158 val_auroc:  0.8834325396825398 val_auprc:  0.9440242035252874
EarlyStopping counter: 17 out of 50
epoch:  54
epoch:  55 val_f1:  0.79396185483142 val_auroc:  0.8804563492063491 val_auprc:  0.9424931642652421
EarlyStopping counter: 18 out of 50
epoch:  55
epoch:  56 val_f1:  0.795635738397158 val_auroc:  0.8792162698412699 val_auprc:  0.9412086598398597
EarlyStopping counter: 19 out of 50
epoch:  56
epoch:  57 val_f1:  0.800639197204071 val_auroc:  0.875 val_auprc:  0.939925483683898
EarlyStopping counter: 20 out of 50
epoch:  57
epoch:  58 val_f1:  0.7746271791640412 val_auroc:  0.865079365079365 val_auprc:  0.9351497357894605
EarlyStopping counter: 21 out of 50
epoch:  58
epoch:  59 val_f1:  0.8035275913020209 val_auroc:  0.8752480158730159 val_auprc:  0.9404832666359488
EarlyStopping counter: 22 out of 50
epoch:  59
epoch:  60 val_f1:  0.8035275913020209 val_auroc:  0.8767361111111112 val_auprc:  0.9407655253221194
EarlyStopping counter: 23 out of 50
epoch:  60
epoch:  61 val_f1:  0.8120268224096906 val_auroc:  0.8779761904761905 val_auprc:  0.9414453582174022
EarlyStopping counter: 24 out of 50
epoch:  61
epoch:  62 val_f1:  0.7948558771909655 val_auroc:  0.8821924603174603 val_auprc:  0.9431073462421662
EarlyStopping counter: 25 out of 50
epoch:  62
epoch:  63 val_f1:  0.7948558771909655 val_auroc:  0.882688492063492 val_auprc:  0.9431928442476201
EarlyStopping counter: 26 out of 50
epoch:  63
epoch:  64 val_f1:  0.8168793096329329 val_auroc:  0.8792162698412699 val_auprc:  0.9419466612406067
EarlyStopping counter: 27 out of 50
epoch:  64
epoch:  65 val_f1:  0.8072024593763724 val_auroc:  0.8792162698412699 val_auprc:  0.9422663762371069
EarlyStopping counter: 28 out of 50
epoch:  65
epoch:  66 val_f1:  0.8035275913020209 val_auroc:  0.8772321428571429 val_auprc:  0.9413098091812131
EarlyStopping counter: 29 out of 50
epoch:  66
epoch:  67 val_f1:  0.8035275913020209 val_auroc:  0.8792162698412699 val_auprc:  0.941829758680611
EarlyStopping counter: 30 out of 50
epoch:  67
epoch:  68 val_f1:  0.820411899313501 val_auroc:  0.8804563492063493 val_auprc:  0.9424745975206259
EarlyStopping counter: 31 out of 50
epoch:  68
epoch:  69 val_f1:  0.8315289648622983 val_auroc:  0.8799603174603174 val_auprc:  0.942154039970687
EarlyStopping counter: 32 out of 50
epoch:  69
epoch:  70 val_f1:  0.8061683443992288 val_auroc:  0.8836805555555556 val_auprc:  0.9437434416607867
EarlyStopping counter: 33 out of 50
epoch:  70
epoch:  71 val_f1:  0.8248625247346153 val_auroc:  0.8819444444444444 val_auprc:  0.9430669118131967
EarlyStopping counter: 34 out of 50
epoch:  71
epoch:  72 val_f1:  0.8137922815659323 val_auroc:  0.8807043650793652 val_auprc:  0.942728884964011
EarlyStopping counter: 35 out of 50
epoch:  72
epoch:  73 val_f1:  0.8194319840387783 val_auroc:  0.8846726190476191 val_auprc:  0.9445267974302541
EarlyStopping counter: 36 out of 50
epoch:  73
epoch:  74 val_f1:  0.8235137533274179 val_auroc:  0.8829365079365079 val_auprc:  0.9433301562819912
EarlyStopping counter: 37 out of 50
epoch:  74
epoch:  75 val_f1:  0.8137922815659323 val_auroc:  0.8789682539682541 val_auprc:  0.9413934540408111
EarlyStopping counter: 38 out of 50
epoch:  75
epoch:  76 val_f1:  0.7949078298424175 val_auroc:  0.8769841269841271 val_auprc:  0.9409249470743777
EarlyStopping counter: 39 out of 50
epoch:  76
epoch:  77 val_f1:  0.7949078298424175 val_auroc:  0.8782242063492064 val_auprc:  0.9414255911940823
EarlyStopping counter: 40 out of 50
epoch:  77
epoch:  78 val_f1:  0.8137922815659323 val_auroc:  0.8824404761904763 val_auprc:  0.9436533263466272
EarlyStopping counter: 41 out of 50
epoch:  78
epoch:  79 val_f1:  0.8194319840387783 val_auroc:  0.8878968253968254 val_auprc:  0.9460444094914053
EarlyStopping counter: 42 out of 50
epoch:  79
epoch:  80 val_f1:  0.8194319840387783 val_auroc:  0.886904761904762 val_auprc:  0.9459101793210141
EarlyStopping counter: 43 out of 50
epoch:  80
epoch:  81 val_f1:  0.8220330394243437 val_auroc:  0.8804563492063492 val_auprc:  0.9424836924432402
EarlyStopping counter: 44 out of 50
epoch:  81
epoch:  82 val_f1:  0.8220330394243437 val_auroc:  0.8814484126984127 val_auprc:  0.9433799930299747
EarlyStopping counter: 45 out of 50
epoch:  82
epoch:  83 val_f1:  0.8248625247346153 val_auroc:  0.8841765873015873 val_auprc:  0.9445204876223254
EarlyStopping counter: 46 out of 50
epoch:  83
epoch:  84 val_f1:  0.8260869565217391 val_auroc:  0.8874007936507937 val_auprc:  0.9459856413601886
EarlyStopping counter: 47 out of 50
epoch:  84
epoch:  85 val_f1:  0.8260869565217391 val_auroc:  0.8871527777777778 val_auprc:  0.9457607926313452
EarlyStopping counter: 48 out of 50
epoch:  85
epoch:  86 val_f1:  0.8248625247346153 val_auroc:  0.8851686507936508 val_auprc:  0.9451501411962124
EarlyStopping counter: 49 out of 50
epoch:  86
epoch:  87 val_f1:  0.7949078298424175 val_auroc:  0.8764880952380952 val_auprc:  0.9407914252041765
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  262.5693528652191
{'time_elapsed': [262.5693528652191], 'epoch': [86], 'fold': [4], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7949078298424175], 'auroc_test': [0.8764880952380952], 'auprc_test': [0.9407914252041765]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 256]           6,144
│    └─BatchNorm1d: 2-2                  [64, 1024, 256]           2,048
│    └─Tanh: 2-3                         [64, 1024, 256]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 51]            --
│    └─Dropout: 2-5                      [64, 1024, 51]            --
│    └─Flatten: 2-6                      [64, 52224]               --
│    └─Linear: 2-7                       [64, 1]                   52,225
==========================================================================================
Total params: 60,417
Trainable params: 60,417
Non-trainable params: 0
Total mult-adds (M): 104.14
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 268.44
Params size (MB): 0.24
Estimated Total Size (MB): 269.01
==========================================================================================
