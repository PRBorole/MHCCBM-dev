config:  {'project': 'MHCCBM', 'name': 'CNN_76', 'config': {'hidden_channels': [128], 'epochs': 500, 'kernel_size': 3, 'pool_kernel_size': 3, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.4975286903344458 val_auroc:  0.7241040746195385 val_auprc:  0.8491519771353612
epoch:  1
epoch:  2 val_f1:  0.720403844991234 val_auroc:  0.7326951399116347 val_auprc:  0.8679671239219315
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.7553956834532374 val_auroc:  0.7803141875306824 val_auprc:  0.9002386269496161
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6740890891918117 val_auroc:  0.7864506627393226 val_auprc:  0.9074813868851185
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6617377698806362 val_auroc:  0.7881688757977419 val_auprc:  0.9034496399497243
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.7410071942446043 val_auroc:  0.8043691703485517 val_auprc:  0.9146433624577319
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.7648187281552264 val_auroc:  0.819833087874325 val_auprc:  0.9252846582102958
Validation loss improved to 0.795017
epoch:  7
epoch:  8 val_f1:  0.7477455593342162 val_auroc:  0.8213058419243986 val_auprc:  0.9257735272044996
Validation loss improved to 0.752514
epoch:  8
epoch:  9 val_f1:  0.7500864926036699 val_auroc:  0.8070692194403535 val_auprc:  0.9139290863194393
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7573003855683703 val_auroc:  0.8181148748159057 val_auprc:  0.9211437219650112
Validation loss improved to 0.728210
epoch:  10
epoch:  11 val_f1:  0.7170655771870609 val_auroc:  0.8092783505154639 val_auprc:  0.9107276755117352
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7765831291011147 val_auroc:  0.8205694648993619 val_auprc:  0.921458949565533
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.7099629667254643 val_auroc:  0.8119783996072656 val_auprc:  0.9134958255935117
EarlyStopping counter: 3 out of 50
epoch:  13
epoch:  14 val_f1:  0.7897879661118469 val_auroc:  0.8213058419243986 val_auprc:  0.918988034481157
Validation loss improved to 0.701063
epoch:  14
epoch:  15 val_f1:  0.7577565132360132 val_auroc:  0.8274423171330387 val_auprc:  0.9221533302890415
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7648576099332736 val_auroc:  0.8306332842415316 val_auprc:  0.9251322124669485
Validation loss improved to 0.694314
epoch:  16
epoch:  17 val_f1:  0.7580594896895918 val_auroc:  0.8237604320078546 val_auprc:  0.9216472015846942
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.7510257046352308 val_auroc:  0.8269513991163476 val_auprc:  0.9206334106706764
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7889150110486646 val_auroc:  0.8294059891998036 val_auprc:  0.924925319781319
Validation loss improved to 0.662623
epoch:  19
epoch:  20 val_f1:  0.7510257046352308 val_auroc:  0.8259695630829651 val_auprc:  0.9206208193422284
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7648187281552264 val_auroc:  0.8355424644084438 val_auprc:  0.9312753957902749
Validation loss improved to 0.635187
epoch:  21
epoch:  22 val_f1:  0.7639705763479104 val_auroc:  0.8316151202749141 val_auprc:  0.9259693197298268
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7954863587533922 val_auroc:  0.8237604320078548 val_auprc:  0.9214786067683514
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.7748426784519089 val_auroc:  0.8298969072164948 val_auprc:  0.9239182751487889
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.7307708780682615 val_auroc:  0.8274423171330387 val_auprc:  0.9220325389089277
EarlyStopping counter: 4 out of 50
epoch:  25
epoch:  26 val_f1:  0.7691994463100789 val_auroc:  0.8286696121747668 val_auprc:  0.9220619588343675
EarlyStopping counter: 5 out of 50
epoch:  26
epoch:  27 val_f1:  0.7536081085870222 val_auroc:  0.8262150220913107 val_auprc:  0.9226020461166553
EarlyStopping counter: 6 out of 50
epoch:  27
epoch:  28 val_f1:  0.7790721385700611 val_auroc:  0.8274423171330387 val_auprc:  0.9214334590471958
EarlyStopping counter: 7 out of 50
epoch:  28
epoch:  29 val_f1:  0.7748426784519089 val_auroc:  0.8220422189494354 val_auprc:  0.9198000968645104
EarlyStopping counter: 8 out of 50
epoch:  29
epoch:  30 val_f1:  0.7826417810500232 val_auroc:  0.8284241531664213 val_auprc:  0.9230663263587362
EarlyStopping counter: 9 out of 50
epoch:  30
epoch:  31 val_f1:  0.7777125328082551 val_auroc:  0.8119783996072657 val_auprc:  0.9116962826822272
EarlyStopping counter: 10 out of 50
epoch:  31
epoch:  32 val_f1:  0.7854414831518974 val_auroc:  0.8350515463917525 val_auprc:  0.9278160227679135
EarlyStopping counter: 11 out of 50
epoch:  32
epoch:  33 val_f1:  0.770628190185282 val_auroc:  0.8230240549828179 val_auprc:  0.9199922789443136
EarlyStopping counter: 12 out of 50
epoch:  33
epoch:  34 val_f1:  0.7823449348629204 val_auroc:  0.8242513500245459 val_auprc:  0.9214446910829079
EarlyStopping counter: 13 out of 50
epoch:  34
epoch:  35 val_f1:  0.7745465218349855 val_auroc:  0.8262150220913108 val_auprc:  0.9219023663203594
EarlyStopping counter: 14 out of 50
epoch:  35
epoch:  36 val_f1:  0.7496568898727172 val_auroc:  0.8271968581246932 val_auprc:  0.9229781504964252
EarlyStopping counter: 15 out of 50
epoch:  36
epoch:  37 val_f1:  0.799854302604428 val_auroc:  0.8291605301914581 val_auprc:  0.9233307504792618
EarlyStopping counter: 16 out of 50
epoch:  37
epoch:  38 val_f1:  0.8010188978004199 val_auroc:  0.8237604320078545 val_auprc:  0.9195388662793632
EarlyStopping counter: 17 out of 50
epoch:  38
epoch:  39 val_f1:  0.778324933635979 val_auroc:  0.8267059401080019 val_auprc:  0.9233598832798806
EarlyStopping counter: 18 out of 50
epoch:  39
epoch:  40 val_f1:  0.7813819697019021 val_auroc:  0.8281786941580757 val_auprc:  0.9237877881169173
EarlyStopping counter: 19 out of 50
epoch:  40
epoch:  41 val_f1:  0.766354189375772 val_auroc:  0.8259695630829651 val_auprc:  0.9228199341500276
EarlyStopping counter: 20 out of 50
epoch:  41
epoch:  42 val_f1:  0.7745465218349855 val_auroc:  0.8316151202749141 val_auprc:  0.9256830017895532
EarlyStopping counter: 21 out of 50
epoch:  42
epoch:  43 val_f1:  0.7906450372602754 val_auroc:  0.8271968581246931 val_auprc:  0.9222453860482056
EarlyStopping counter: 22 out of 50
epoch:  43
epoch:  44 val_f1:  0.7906450372602754 val_auroc:  0.8291605301914581 val_auprc:  0.923373145865156
EarlyStopping counter: 23 out of 50
epoch:  44
epoch:  45 val_f1:  0.7745465218349855 val_auroc:  0.8308787432498772 val_auprc:  0.9245037921376306
EarlyStopping counter: 24 out of 50
epoch:  45
epoch:  46 val_f1:  0.7580594896895918 val_auroc:  0.8284241531664213 val_auprc:  0.9232068162215921
EarlyStopping counter: 25 out of 50
epoch:  46
epoch:  47 val_f1:  0.766354189375772 val_auroc:  0.8257241040746195 val_auprc:  0.9208309298275361
EarlyStopping counter: 26 out of 50
epoch:  47
epoch:  48 val_f1:  0.7906450372602754 val_auroc:  0.8301423662248405 val_auprc:  0.9234821682189948
EarlyStopping counter: 27 out of 50
epoch:  48
epoch:  49 val_f1:  0.7580594896895918 val_auroc:  0.8289150711831124 val_auprc:  0.9241323987510053
EarlyStopping counter: 28 out of 50
epoch:  49
epoch:  50 val_f1:  0.7906450372602754 val_auroc:  0.82793323514973 val_auprc:  0.9236957983100677
EarlyStopping counter: 29 out of 50
epoch:  50
epoch:  51 val_f1:  0.7765831291011147 val_auroc:  0.830387825233186 val_auprc:  0.9254687231342004
EarlyStopping counter: 30 out of 50
epoch:  51
epoch:  52 val_f1:  0.799854302604428 val_auroc:  0.8308787432498773 val_auprc:  0.9256447225912953
EarlyStopping counter: 31 out of 50
epoch:  52
epoch:  53 val_f1:  0.7683026725960121 val_auroc:  0.8328424153166422 val_auprc:  0.9268697549910909
EarlyStopping counter: 32 out of 50
epoch:  53
epoch:  54 val_f1:  0.7879228532067962 val_auroc:  0.8296514482081493 val_auprc:  0.9238098341561211
EarlyStopping counter: 33 out of 50
epoch:  54
epoch:  55 val_f1:  0.7683026725960121 val_auroc:  0.8313696612665685 val_auprc:  0.9274925135396994
EarlyStopping counter: 34 out of 50
epoch:  55
epoch:  56 val_f1:  0.7855581813618873 val_auroc:  0.8286696121747668 val_auprc:  0.9240622585973096
EarlyStopping counter: 35 out of 50
epoch:  56
epoch:  57 val_f1:  0.7737843767539161 val_auroc:  0.8269513991163476 val_auprc:  0.922635294686674
EarlyStopping counter: 36 out of 50
epoch:  57
epoch:  58 val_f1:  0.7826417810500232 val_auroc:  0.8296514482081493 val_auprc:  0.9245758309817866
EarlyStopping counter: 37 out of 50
epoch:  58
epoch:  59 val_f1:  0.7580594896895918 val_auroc:  0.8301423662248405 val_auprc:  0.9249817950104239
EarlyStopping counter: 38 out of 50
epoch:  59
epoch:  60 val_f1:  0.766354189375772 val_auroc:  0.8313696612665684 val_auprc:  0.9252162617472731
EarlyStopping counter: 39 out of 50
epoch:  60
epoch:  61 val_f1:  0.7985611510791367 val_auroc:  0.8281786941580755 val_auprc:  0.922024129090951
EarlyStopping counter: 40 out of 50
epoch:  61
epoch:  62 val_f1:  0.7855581813618873 val_auroc:  0.8286696121747668 val_auprc:  0.9240336943546272
EarlyStopping counter: 41 out of 50
epoch:  62
epoch:  63 val_f1:  0.7855581813618873 val_auroc:  0.8303878252331861 val_auprc:  0.9256467415977976
EarlyStopping counter: 42 out of 50
epoch:  63
epoch:  64 val_f1:  0.7920536597238516 val_auroc:  0.8303878252331861 val_auprc:  0.9255063558824566
EarlyStopping counter: 43 out of 50
epoch:  64
epoch:  65 val_f1:  0.7906450372602754 val_auroc:  0.826705940108002 val_auprc:  0.922988915987871
EarlyStopping counter: 44 out of 50
epoch:  65
epoch:  66 val_f1:  0.7920536597238516 val_auroc:  0.8289150711831124 val_auprc:  0.9246600912203209
EarlyStopping counter: 45 out of 50
epoch:  66
epoch:  67 val_f1:  0.7580594896895918 val_auroc:  0.829160530191458 val_auprc:  0.9246996893617788
EarlyStopping counter: 46 out of 50
epoch:  67
epoch:  68 val_f1:  0.766354189375772 val_auroc:  0.8264604810996563 val_auprc:  0.9222419954620267
EarlyStopping counter: 47 out of 50
epoch:  68
epoch:  69 val_f1:  0.7790721385700611 val_auroc:  0.8306332842415317 val_auprc:  0.9254870615710444
EarlyStopping counter: 48 out of 50
epoch:  69
epoch:  70 val_f1:  0.7855581813618873 val_auroc:  0.831615120274914 val_auprc:  0.9259865312653501
EarlyStopping counter: 49 out of 50
epoch:  70
epoch:  71 val_f1:  0.7985611510791367 val_auroc:  0.8296514482081492 val_auprc:  0.9252021301484095
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  218.12651991844177
{'time_elapsed': [218.12651991844177], 'epoch': [70], 'fold': [0], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7985611510791367], 'auroc_test': [0.8296514482081492], 'auprc_test': [0.9252021301484095]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1280]           512
│    └─BatchNorm1d: 2-2                  [64, 128, 1280]           256
│    └─Tanh: 2-3                         [64, 128, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1278]           --
│    └─Dropout: 2-5                      [64, 128, 1278]           --
│    └─Flatten: 2-6                      [64, 163584]              --
│    └─Linear: 2-7                       [64, 1]                   163,585
==========================================================================================
Total params: 164,353
Trainable params: 164,353
Non-trainable params: 0
Total mult-adds (M): 52.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.77
Params size (MB): 0.66
Estimated Total Size (MB): 168.76
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6360893294360015 val_auroc:  0.8205694648993617 val_auprc:  0.9100579378875696
epoch:  1
epoch:  2 val_f1:  0.6641538942758836 val_auroc:  0.7995827196858124 val_auprc:  0.901634717329307
Validation loss improved to 0.536326
epoch:  2
epoch:  3 val_f1:  0.7096701017564327 val_auroc:  0.8195876288659795 val_auprc:  0.9138092636984618
Validation loss improved to 0.483931
epoch:  3
epoch:  4 val_f1:  0.7330561760022478 val_auroc:  0.8163966617574865 val_auprc:  0.91221805099997
Validation loss improved to 0.401966
epoch:  4
epoch:  5 val_f1:  0.7617684906754855 val_auroc:  0.8129602356406481 val_auprc:  0.9103528601075633
Validation loss improved to 0.324144
epoch:  5
epoch:  6 val_f1:  0.7560320485424044 val_auroc:  0.8112420225822289 val_auprc:  0.9112016260835769
Validation loss improved to 0.316634
epoch:  6
epoch:  7 val_f1:  0.7170655771870609 val_auroc:  0.8163966617574865 val_auprc:  0.9155800342048568
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.6749024096537389 val_auroc:  0.8203240058910163 val_auprc:  0.9167921033002422
EarlyStopping counter: 2 out of 50
epoch:  8
epoch:  9 val_f1:  0.770628190185282 val_auroc:  0.8230240549828178 val_auprc:  0.9165514297068329
Validation loss improved to 0.307245
epoch:  9
epoch:  10 val_f1:  0.7938350857775318 val_auroc:  0.8186057928325969 val_auprc:  0.913905090959143
Validation loss improved to 0.226773
epoch:  10
epoch:  11 val_f1:  0.6963248678165901 val_auroc:  0.8215513009327443 val_auprc:  0.9153793359766889
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7308479257525525 val_auroc:  0.8313696612665684 val_auprc:  0.9218295818489067
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.7670032041593616 val_auroc:  0.8379970544918999 val_auprc:  0.9239392381927847
Validation loss improved to 0.221183
epoch:  13
epoch:  14 val_f1:  0.7985611510791367 val_auroc:  0.818605792832597 val_auprc:  0.9126948711807158
Validation loss improved to 0.216034
epoch:  14
epoch:  15 val_f1:  0.7985611510791367 val_auroc:  0.8350515463917525 val_auprc:  0.9211020251991673
Validation loss improved to 0.201029
epoch:  15
epoch:  16 val_f1:  0.7453039856444363 val_auroc:  0.8276877761413843 val_auprc:  0.9172567917752978
Validation loss improved to 0.175908
epoch:  16
epoch:  17 val_f1:  0.770628190185282 val_auroc:  0.8325969563082966 val_auprc:  0.9211423531157393
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.723931698015082 val_auroc:  0.8330878743249878 val_auprc:  0.9216778437082551
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7244548447263693 val_auroc:  0.8264604810996564 val_auprc:  0.9123984190714363
EarlyStopping counter: 3 out of 50
epoch:  19
epoch:  20 val_f1:  0.7580594896895918 val_auroc:  0.8139420716740305 val_auprc:  0.9110848282458165
EarlyStopping counter: 4 out of 50
epoch:  20
epoch:  21 val_f1:  0.799854302604428 val_auroc:  0.842906234658812 val_auprc:  0.9265595263375345
EarlyStopping counter: 5 out of 50
epoch:  21
epoch:  22 val_f1:  0.7697841726618705 val_auroc:  0.8325969563082966 val_auprc:  0.921300924430204
EarlyStopping counter: 6 out of 50
epoch:  22
epoch:  23 val_f1:  0.80508331055267 val_auroc:  0.8470790378006873 val_auprc:  0.9272545976232107
EarlyStopping counter: 7 out of 50
epoch:  23
epoch:  24 val_f1:  0.7685409504908388 val_auroc:  0.8399607265586647 val_auprc:  0.9227434526855507
Validation loss improved to 0.163055
epoch:  24
epoch:  25 val_f1:  0.7598715939807772 val_auroc:  0.834806087383407 val_auprc:  0.9168266967839129
Validation loss improved to 0.159056
epoch:  25
epoch:  26 val_f1:  0.7598715939807772 val_auroc:  0.8355424644084438 val_auprc:  0.9140301994904376
Validation loss improved to 0.141330
epoch:  26
epoch:  27 val_f1:  0.7724732835091151 val_auroc:  0.8244968090328915 val_auprc:  0.9027383326643748
Validation loss improved to 0.128255
epoch:  27
epoch:  28 val_f1:  0.7685409504908388 val_auroc:  0.8330878743249877 val_auprc:  0.9127346678953859
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.806394786639448 val_auroc:  0.8318605792832596 val_auprc:  0.9102176607277435
EarlyStopping counter: 2 out of 50
epoch:  29
epoch:  30 val_f1:  0.766354189375772 val_auroc:  0.8345606283750614 val_auprc:  0.9135589932981464
EarlyStopping counter: 3 out of 50
epoch:  30
epoch:  31 val_f1:  0.7685409504908388 val_auroc:  0.832351497299951 val_auprc:  0.910788055785079
EarlyStopping counter: 4 out of 50
epoch:  31
epoch:  32 val_f1:  0.7809570525397864 val_auroc:  0.8279332351497299 val_auprc:  0.9064984652023105
EarlyStopping counter: 5 out of 50
epoch:  32
epoch:  33 val_f1:  0.7873856121514594 val_auroc:  0.8375061364752086 val_auprc:  0.9120819210357803
EarlyStopping counter: 6 out of 50
epoch:  33
epoch:  34 val_f1:  0.7598715939807772 val_auroc:  0.8259695630829652 val_auprc:  0.9022007443464661
EarlyStopping counter: 7 out of 50
epoch:  34
epoch:  35 val_f1:  0.7770871369605723 val_auroc:  0.8316151202749141 val_auprc:  0.9040513072728606
EarlyStopping counter: 8 out of 50
epoch:  35
epoch:  36 val_f1:  0.7598715939807772 val_auroc:  0.8267059401080019 val_auprc:  0.902628334519413
EarlyStopping counter: 9 out of 50
epoch:  36
epoch:  37 val_f1:  0.7770871369605723 val_auroc:  0.834806087383407 val_auprc:  0.9073023663085414
Validation loss improved to 0.108305
epoch:  37
epoch:  38 val_f1:  0.7598715939807772 val_auroc:  0.8325969563082964 val_auprc:  0.9066391233614102
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.7598715939807772 val_auroc:  0.8311242022582228 val_auprc:  0.9066680484730827
EarlyStopping counter: 2 out of 50
epoch:  39
epoch:  40 val_f1:  0.7598715939807772 val_auroc:  0.8313696612665685 val_auprc:  0.9065092512615083
EarlyStopping counter: 3 out of 50
epoch:  40
epoch:  41 val_f1:  0.7791090204759269 val_auroc:  0.8306332842415317 val_auprc:  0.9057706131666348
EarlyStopping counter: 4 out of 50
epoch:  41
epoch:  42 val_f1:  0.7791090204759269 val_auroc:  0.8301423662248404 val_auprc:  0.905497294557418
EarlyStopping counter: 5 out of 50
epoch:  42
epoch:  43 val_f1:  0.7791090204759269 val_auroc:  0.8312469317623957 val_auprc:  0.9004411783705297
EarlyStopping counter: 6 out of 50
epoch:  43
epoch:  44 val_f1:  0.7770871369605723 val_auroc:  0.8321060382916052 val_auprc:  0.9049052353880394
EarlyStopping counter: 7 out of 50
epoch:  44
epoch:  45 val_f1:  0.7685409504908388 val_auroc:  0.832351497299951 val_auprc:  0.904588232874713
Validation loss improved to 0.097043
epoch:  45
epoch:  46 val_f1:  0.7791090204759269 val_auroc:  0.8310014727540501 val_auprc:  0.9029197084755733
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.7598715939807772 val_auroc:  0.8306332842415317 val_auprc:  0.9043724083048466
EarlyStopping counter: 2 out of 50
epoch:  47
epoch:  48 val_f1:  0.7770871369605723 val_auroc:  0.8316151202749141 val_auprc:  0.9024465631962248
EarlyStopping counter: 3 out of 50
epoch:  48
epoch:  49 val_f1:  0.7598715939807772 val_auroc:  0.8295287187039765 val_auprc:  0.9020300379994104
EarlyStopping counter: 4 out of 50
epoch:  49
epoch:  50 val_f1:  0.7770871369605723 val_auroc:  0.8297741777123221 val_auprc:  0.9006531434967244
EarlyStopping counter: 5 out of 50
epoch:  50
epoch:  51 val_f1:  0.7510724063582411 val_auroc:  0.829774177712322 val_auprc:  0.8995251982958316
EarlyStopping counter: 6 out of 50
epoch:  51
epoch:  52 val_f1:  0.7598715939807772 val_auroc:  0.8295287187039765 val_auprc:  0.8997351907776057
EarlyStopping counter: 7 out of 50
epoch:  52
epoch:  53 val_f1:  0.7770871369605723 val_auroc:  0.830387825233186 val_auprc:  0.9020926734276256
EarlyStopping counter: 8 out of 50
epoch:  53
epoch:  54 val_f1:  0.7770871369605723 val_auroc:  0.8296514482081493 val_auprc:  0.8990084506506311
EarlyStopping counter: 9 out of 50
epoch:  54
epoch:  55 val_f1:  0.7770871369605723 val_auroc:  0.8303878252331861 val_auprc:  0.9021518923806788
EarlyStopping counter: 10 out of 50
epoch:  55
epoch:  56 val_f1:  0.7770871369605723 val_auroc:  0.8301423662248405 val_auprc:  0.8981237354304918
EarlyStopping counter: 11 out of 50
epoch:  56
epoch:  57 val_f1:  0.7698533480907581 val_auroc:  0.8314923907707413 val_auprc:  0.900800964130418
Validation loss improved to 0.076335
epoch:  57
epoch:  58 val_f1:  0.7661589271850144 val_auroc:  0.8284241531664212 val_auprc:  0.9026027574509945
Validation loss improved to 0.076195
epoch:  58
epoch:  59 val_f1:  0.7661589271850144 val_auroc:  0.8339469808541974 val_auprc:  0.9016958551134217
EarlyStopping counter: 1 out of 50
epoch:  59
epoch:  60 val_f1:  0.7791090204759269 val_auroc:  0.8317378497790869 val_auprc:  0.8986247964185826
EarlyStopping counter: 2 out of 50
epoch:  60
epoch:  61 val_f1:  0.7748796193569787 val_auroc:  0.8324742268041238 val_auprc:  0.901550592220514
EarlyStopping counter: 3 out of 50
epoch:  61
epoch:  62 val_f1:  0.7510724063582411 val_auroc:  0.8295287187039765 val_auprc:  0.9025756522900681
EarlyStopping counter: 4 out of 50
epoch:  62
epoch:  63 val_f1:  0.7707245329923307 val_auroc:  0.8313696612665685 val_auprc:  0.8999880702752701
EarlyStopping counter: 5 out of 50
epoch:  63
epoch:  64 val_f1:  0.7510724063582411 val_auroc:  0.8308787432498772 val_auprc:  0.8947755275862455
EarlyStopping counter: 6 out of 50
epoch:  64
epoch:  65 val_f1:  0.757304835743056 val_auroc:  0.8312469317623957 val_auprc:  0.8979625821135808
EarlyStopping counter: 7 out of 50
epoch:  65
epoch:  66 val_f1:  0.7707245329923307 val_auroc:  0.8323514972999508 val_auprc:  0.9034525993542357
EarlyStopping counter: 8 out of 50
epoch:  66
epoch:  67 val_f1:  0.7510724063582411 val_auroc:  0.8319833087874324 val_auprc:  0.8984849490361189
EarlyStopping counter: 9 out of 50
epoch:  67
epoch:  68 val_f1:  0.7661589271850144 val_auroc:  0.8307560137457044 val_auprc:  0.8980319697111443
EarlyStopping counter: 10 out of 50
epoch:  68
epoch:  69 val_f1:  0.7685409504908388 val_auroc:  0.8335787923416791 val_auprc:  0.897076166166672
EarlyStopping counter: 11 out of 50
epoch:  69
epoch:  70 val_f1:  0.7598715939807772 val_auroc:  0.833578792341679 val_auprc:  0.8971846899446891
EarlyStopping counter: 12 out of 50
epoch:  70
epoch:  71 val_f1:  0.7635640416019908 val_auroc:  0.8329651448208149 val_auprc:  0.902810386768342
EarlyStopping counter: 13 out of 50
epoch:  71
epoch:  72 val_f1:  0.757304835743056 val_auroc:  0.833578792341679 val_auprc:  0.9018380771508079
EarlyStopping counter: 14 out of 50
epoch:  72
epoch:  73 val_f1:  0.7598715939807772 val_auroc:  0.8339469808541974 val_auprc:  0.904022719583452
EarlyStopping counter: 15 out of 50
epoch:  73
epoch:  74 val_f1:  0.7661589271850144 val_auroc:  0.832842415316642 val_auprc:  0.9011550857817845
EarlyStopping counter: 16 out of 50
epoch:  74
epoch:  75 val_f1:  0.757304835743056 val_auroc:  0.8322287677957781 val_auprc:  0.902551438935155
EarlyStopping counter: 17 out of 50
epoch:  75
epoch:  76 val_f1:  0.7685409504908388 val_auroc:  0.8332106038291605 val_auprc:  0.9035946788670275
EarlyStopping counter: 18 out of 50
epoch:  76
epoch:  77 val_f1:  0.7635640416019908 val_auroc:  0.832842415316642 val_auprc:  0.9025182987567442
EarlyStopping counter: 19 out of 50
epoch:  77
epoch:  78 val_f1:  0.7661589271850144 val_auroc:  0.832228767795778 val_auprc:  0.9030188984476367
EarlyStopping counter: 20 out of 50
epoch:  78
epoch:  79 val_f1:  0.7598715939807772 val_auroc:  0.8324742268041238 val_auprc:  0.9034813111653353
EarlyStopping counter: 21 out of 50
epoch:  79
epoch:  80 val_f1:  0.757304835743056 val_auroc:  0.8325969563082966 val_auprc:  0.9042361816250761
EarlyStopping counter: 22 out of 50
epoch:  80
epoch:  81 val_f1:  0.757304835743056 val_auroc:  0.833578792341679 val_auprc:  0.904743205348527
EarlyStopping counter: 23 out of 50
epoch:  81
epoch:  82 val_f1:  0.757304835743056 val_auroc:  0.8337015218458518 val_auprc:  0.9063160416696011
EarlyStopping counter: 24 out of 50
epoch:  82
epoch:  83 val_f1:  0.7685409504908388 val_auroc:  0.8334560628375061 val_auprc:  0.9037376595982394
EarlyStopping counter: 25 out of 50
epoch:  83
epoch:  84 val_f1:  0.7661589271850144 val_auroc:  0.8334560628375061 val_auprc:  0.9061555351193542
EarlyStopping counter: 26 out of 50
epoch:  84
epoch:  85 val_f1:  0.7622262794246104 val_auroc:  0.8325969563082966 val_auprc:  0.905052055874534
EarlyStopping counter: 27 out of 50
epoch:  85
epoch:  86 val_f1:  0.7748796193569787 val_auroc:  0.832965144820815 val_auprc:  0.9058097887259902
EarlyStopping counter: 28 out of 50
epoch:  86
epoch:  87 val_f1:  0.7748796193569787 val_auroc:  0.8332106038291605 val_auprc:  0.9061760820984781
EarlyStopping counter: 29 out of 50
epoch:  87
epoch:  88 val_f1:  0.757304835743056 val_auroc:  0.8339469808541974 val_auprc:  0.9063953460109762
EarlyStopping counter: 30 out of 50
epoch:  88
epoch:  89 val_f1:  0.7661589271850144 val_auroc:  0.8346833578792342 val_auprc:  0.9069498226269287
EarlyStopping counter: 31 out of 50
epoch:  89
epoch:  90 val_f1:  0.7661589271850144 val_auroc:  0.8329651448208149 val_auprc:  0.9063282187906172
EarlyStopping counter: 32 out of 50
epoch:  90
epoch:  91 val_f1:  0.7661589271850144 val_auroc:  0.834192439862543 val_auprc:  0.9069021430850095
EarlyStopping counter: 33 out of 50
epoch:  91
epoch:  92 val_f1:  0.7661589271850144 val_auroc:  0.834192439862543 val_auprc:  0.9065879319961538
EarlyStopping counter: 34 out of 50
epoch:  92
epoch:  93 val_f1:  0.7661589271850144 val_auroc:  0.834192439862543 val_auprc:  0.9066472213690782
EarlyStopping counter: 35 out of 50
epoch:  93
epoch:  94 val_f1:  0.7661589271850144 val_auroc:  0.8341924398625429 val_auprc:  0.9067893708760976
EarlyStopping counter: 36 out of 50
epoch:  94
epoch:  95 val_f1:  0.757304835743056 val_auroc:  0.834806087383407 val_auprc:  0.9081202390691805
EarlyStopping counter: 37 out of 50
epoch:  95
epoch:  96 val_f1:  0.7748796193569787 val_auroc:  0.8337015218458518 val_auprc:  0.9064735035783362
EarlyStopping counter: 38 out of 50
epoch:  96
epoch:  97 val_f1:  0.7635640416019908 val_auroc:  0.8340697103583701 val_auprc:  0.9084454520553147
EarlyStopping counter: 39 out of 50
epoch:  97
epoch:  98 val_f1:  0.7748796193569787 val_auroc:  0.8349288168875797 val_auprc:  0.9091761298615455
EarlyStopping counter: 40 out of 50
epoch:  98
epoch:  99 val_f1:  0.7724732835091151 val_auroc:  0.834192439862543 val_auprc:  0.9085831289479854
EarlyStopping counter: 41 out of 50
epoch:  99
epoch:  100 val_f1:  0.7661589271850144 val_auroc:  0.834192439862543 val_auprc:  0.9087992136937184
EarlyStopping counter: 42 out of 50
epoch:  100
epoch:  101 val_f1:  0.757304835743056 val_auroc:  0.8330878743249878 val_auprc:  0.9092219529087682
EarlyStopping counter: 43 out of 50
epoch:  101
epoch:  102 val_f1:  0.7661589271850144 val_auroc:  0.8341924398625429 val_auprc:  0.9087649715013227
EarlyStopping counter: 44 out of 50
epoch:  102
epoch:  103 val_f1:  0.7724732835091151 val_auroc:  0.8338242513500245 val_auprc:  0.9094847681435948
EarlyStopping counter: 45 out of 50
epoch:  103
epoch:  104 val_f1:  0.7661589271850144 val_auroc:  0.833578792341679 val_auprc:  0.9095213489001153
EarlyStopping counter: 46 out of 50
epoch:  104
epoch:  105 val_f1:  0.7661589271850144 val_auroc:  0.8335787923416789 val_auprc:  0.9093217356333739
EarlyStopping counter: 47 out of 50
epoch:  105
epoch:  106 val_f1:  0.7661589271850144 val_auroc:  0.8338242513500245 val_auprc:  0.9094161145530248
EarlyStopping counter: 48 out of 50
epoch:  106
epoch:  107 val_f1:  0.757304835743056 val_auroc:  0.8343151693667158 val_auprc:  0.9113973424924494
EarlyStopping counter: 49 out of 50
epoch:  107
epoch:  108 val_f1:  0.7661589271850144 val_auroc:  0.8340697103583702 val_auprc:  0.9096094199919122
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  314.9079976081848
{'time_elapsed': [314.9079976081848], 'epoch': [107], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7661589271850144], 'auroc_test': [0.8340697103583702], 'auprc_test': [0.9096094199919122]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1280]           512
│    └─BatchNorm1d: 2-2                  [64, 128, 1280]           256
│    └─Tanh: 2-3                         [64, 128, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1278]           --
│    └─Dropout: 2-5                      [64, 128, 1278]           --
│    └─Flatten: 2-6                      [64, 163584]              --
│    └─Linear: 2-7                       [64, 1]                   163,585
==========================================================================================
Total params: 164,353
Trainable params: 164,353
Non-trainable params: 0
Total mult-adds (M): 52.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.77
Params size (MB): 0.66
Estimated Total Size (MB): 168.76
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6331741486145341 val_auroc:  0.647766323024055 val_auprc:  0.8039953822079872
epoch:  1
epoch:  2 val_f1:  0.6511257013806431 val_auroc:  0.6438389788905252 val_auprc:  0.8230363884212222
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.648229071832016 val_auroc:  0.6543937162493864 val_auprc:  0.8208170926839938
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.652687253151504 val_auroc:  0.7231222385861561 val_auprc:  0.8710185456273731
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.675161142762091 val_auroc:  0.7503681885125185 val_auprc:  0.8760285926339583
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.7142089711496735 val_auroc:  0.7430044182621502 val_auprc:  0.8623660864080389
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.7098736982331642 val_auroc:  0.7623956799214532 val_auprc:  0.8819292283548915
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.6524974219867484 val_auroc:  0.7614138438880707 val_auprc:  0.8797667204946245
EarlyStopping counter: 7 out of 50
epoch:  8
epoch:  9 val_f1:  0.6687180376180983 val_auroc:  0.7606774668630338 val_auprc:  0.8774941791354787
EarlyStopping counter: 8 out of 50
epoch:  9
epoch:  10 val_f1:  0.7477455593342162 val_auroc:  0.7839960726558665 val_auprc:  0.8936138802795481
EarlyStopping counter: 9 out of 50
epoch:  10
epoch:  11 val_f1:  0.7215941532488295 val_auroc:  0.75306823760432 val_auprc:  0.8722568809153823
EarlyStopping counter: 10 out of 50
epoch:  11
epoch:  12 val_f1:  0.7223183251151889 val_auroc:  0.7592047128129602 val_auprc:  0.8801991029563434
EarlyStopping counter: 11 out of 50
epoch:  12
epoch:  13 val_f1:  0.7272357092755477 val_auroc:  0.7596956308296514 val_auprc:  0.8801111688367745
EarlyStopping counter: 12 out of 50
epoch:  13
epoch:  14 val_f1:  0.6617377698806362 val_auroc:  0.7511045655375552 val_auprc:  0.8728587687093761
EarlyStopping counter: 13 out of 50
epoch:  14
epoch:  15 val_f1:  0.7163649790827238 val_auroc:  0.7535591556210113 val_auprc:  0.8750667051932737
EarlyStopping counter: 14 out of 50
epoch:  15
epoch:  16 val_f1:  0.7011215811505187 val_auroc:  0.7626411389297987 val_auprc:  0.880590167433152
EarlyStopping counter: 15 out of 50
epoch:  16
epoch:  17 val_f1:  0.7148475178521729 val_auroc:  0.7616593028964164 val_auprc:  0.8770301817614321
EarlyStopping counter: 16 out of 50
epoch:  17
epoch:  18 val_f1:  0.6956984934700323 val_auroc:  0.7655866470299459 val_auprc:  0.8802054626106437
EarlyStopping counter: 17 out of 50
epoch:  18
epoch:  19 val_f1:  0.7057031525565856 val_auroc:  0.764359351988218 val_auprc:  0.8780079887444006
EarlyStopping counter: 18 out of 50
epoch:  19
epoch:  20 val_f1:  0.7184536707983012 val_auroc:  0.7614138438880708 val_auprc:  0.8721098065114077
EarlyStopping counter: 19 out of 50
epoch:  20
epoch:  21 val_f1:  0.7263486361521366 val_auroc:  0.7675503190967108 val_auprc:  0.8792402667120617
EarlyStopping counter: 20 out of 50
epoch:  21
epoch:  22 val_f1:  0.7040153975059064 val_auroc:  0.7547864506627393 val_auprc:  0.8685553180616739
EarlyStopping counter: 21 out of 50
epoch:  22
epoch:  23 val_f1:  0.7156947373800909 val_auroc:  0.7638684339715268 val_auprc:  0.8737120519505359
EarlyStopping counter: 22 out of 50
epoch:  23
epoch:  24 val_f1:  0.717230470942395 val_auroc:  0.7621502209131075 val_auprc:  0.8686712574102589
EarlyStopping counter: 23 out of 50
epoch:  24
epoch:  25 val_f1:  0.7092263500553166 val_auroc:  0.7665684830633285 val_auprc:  0.8735873250553523
EarlyStopping counter: 24 out of 50
epoch:  25
epoch:  26 val_f1:  0.7202047592695074 val_auroc:  0.7555228276877761 val_auprc:  0.8680291748720015
EarlyStopping counter: 25 out of 50
epoch:  26
epoch:  27 val_f1:  0.706765356945213 val_auroc:  0.7533136966126657 val_auprc:  0.8700135823572606
EarlyStopping counter: 26 out of 50
epoch:  27
epoch:  28 val_f1:  0.7142089711496735 val_auroc:  0.7599410898379971 val_auprc:  0.865499939283325
EarlyStopping counter: 27 out of 50
epoch:  28
epoch:  29 val_f1:  0.726175885795287 val_auroc:  0.7619047619047619 val_auprc:  0.8661520540707679
EarlyStopping counter: 28 out of 50
epoch:  29
epoch:  30 val_f1:  0.7246795893300292 val_auroc:  0.765586647029946 val_auprc:  0.869961110327592
EarlyStopping counter: 29 out of 50
epoch:  30
epoch:  31 val_f1:  0.7281499969472504 val_auroc:  0.7628865979381443 val_auprc:  0.8661505159202603
EarlyStopping counter: 30 out of 50
epoch:  31
epoch:  32 val_f1:  0.7044810154681304 val_auroc:  0.7538046146293569 val_auprc:  0.8585495653526531
EarlyStopping counter: 31 out of 50
epoch:  32
epoch:  33 val_f1:  0.717230470942395 val_auroc:  0.7731958762886598 val_auprc:  0.872878436877878
EarlyStopping counter: 32 out of 50
epoch:  33
epoch:  34 val_f1:  0.7410071942446043 val_auroc:  0.758713794796269 val_auprc:  0.863090637904089
EarlyStopping counter: 33 out of 50
epoch:  34
epoch:  35 val_f1:  0.7473654218886486 val_auroc:  0.761168384879725 val_auprc:  0.8622610540576763
EarlyStopping counter: 34 out of 50
epoch:  35
epoch:  36 val_f1:  0.751751326211758 val_auroc:  0.7604320078546882 val_auprc:  0.8644762587158636
EarlyStopping counter: 35 out of 50
epoch:  36
epoch:  37 val_f1:  0.7203480251458693 val_auroc:  0.7511045655375552 val_auprc:  0.8503554773549247
EarlyStopping counter: 36 out of 50
epoch:  37
epoch:  38 val_f1:  0.7203480251458693 val_auroc:  0.7641138929798723 val_auprc:  0.8632768670992692
EarlyStopping counter: 37 out of 50
epoch:  38
epoch:  39 val_f1:  0.7454557504588546 val_auroc:  0.7621502209131075 val_auprc:  0.8623897920422546
EarlyStopping counter: 38 out of 50
epoch:  39
epoch:  40 val_f1:  0.743396428458658 val_auroc:  0.7569955817378498 val_auprc:  0.8528440040129458
EarlyStopping counter: 39 out of 50
epoch:  40
epoch:  41 val_f1:  0.7496568898727172 val_auroc:  0.7633775159548356 val_auprc:  0.8582185594821315
EarlyStopping counter: 40 out of 50
epoch:  41
epoch:  42 val_f1:  0.7496568898727172 val_auroc:  0.7677957781050565 val_auprc:  0.8678811293321698
EarlyStopping counter: 41 out of 50
epoch:  42
epoch:  43 val_f1:  0.7454557504588546 val_auroc:  0.7587137947962691 val_auprc:  0.8503161890955511
EarlyStopping counter: 42 out of 50
epoch:  43
epoch:  44 val_f1:  0.7313689473952751 val_auroc:  0.7663230240549829 val_auprc:  0.866731869098039
EarlyStopping counter: 43 out of 50
epoch:  44
epoch:  45 val_f1:  0.7185533480648861 val_auroc:  0.7538046146293569 val_auprc:  0.8503805920091817
EarlyStopping counter: 44 out of 50
epoch:  45
epoch:  46 val_f1:  0.7272357092755477 val_auroc:  0.760677466863034 val_auprc:  0.8554169802293551
EarlyStopping counter: 45 out of 50
epoch:  46
epoch:  47 val_f1:  0.7203480251458693 val_auroc:  0.7658321060382915 val_auprc:  0.8568830730446069
EarlyStopping counter: 46 out of 50
epoch:  47
epoch:  48 val_f1:  0.743396428458658 val_auroc:  0.7572410407461954 val_auprc:  0.8550358803076205
EarlyStopping counter: 47 out of 50
epoch:  48
epoch:  49 val_f1:  0.7490302789770621 val_auroc:  0.7606774668630338 val_auprc:  0.8624972343025108
EarlyStopping counter: 48 out of 50
epoch:  49
epoch:  50 val_f1:  0.7140775751491829 val_auroc:  0.7550319096710849 val_auprc:  0.8495281131353412
EarlyStopping counter: 49 out of 50
epoch:  50
epoch:  51 val_f1:  0.7496568898727172 val_auroc:  0.7552773686794305 val_auprc:  0.8492899243563108
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  147.90238213539124
{'time_elapsed': [147.90238213539124], 'epoch': [50], 'fold': [2], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7496568898727172], 'auroc_test': [0.7552773686794305], 'auprc_test': [0.8492899243563108]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1280]           512
│    └─BatchNorm1d: 2-2                  [64, 128, 1280]           256
│    └─Tanh: 2-3                         [64, 128, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1278]           --
│    └─Dropout: 2-5                      [64, 128, 1278]           --
│    └─Flatten: 2-6                      [64, 163584]              --
│    └─Linear: 2-7                       [64, 1]                   163,585
==========================================================================================
Total params: 164,353
Trainable params: 164,353
Non-trainable params: 0
Total mult-adds (M): 52.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.77
Params size (MB): 0.66
Estimated Total Size (MB): 168.76
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5642736874330323 val_auroc:  0.6717538759689922 val_auprc:  0.7954075106760966
epoch:  1
epoch:  2 val_f1:  0.6746390555463059 val_auroc:  0.7088178294573643 val_auprc:  0.8212633252250623
Validation loss improved to 0.116000
epoch:  2
epoch:  3 val_f1:  0.7022948656360511 val_auroc:  0.7868217054263565 val_auprc:  0.8885661775346683
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6500543925761647 val_auroc:  0.7781007751937985 val_auprc:  0.8906853262539857
EarlyStopping counter: 2 out of 50
epoch:  4
epoch:  5 val_f1:  0.764250381178164 val_auroc:  0.8122577519379846 val_auprc:  0.9172948923621254
EarlyStopping counter: 3 out of 50
epoch:  5
epoch:  6 val_f1:  0.7768458491633659 val_auroc:  0.8195251937984496 val_auprc:  0.9203101877474845
EarlyStopping counter: 4 out of 50
epoch:  6
epoch:  7 val_f1:  0.8074875573056803 val_auroc:  0.8250968992248062 val_auprc:  0.9146408602232263
EarlyStopping counter: 5 out of 50
epoch:  7
epoch:  8 val_f1:  0.7827158008497472 val_auroc:  0.839874031007752 val_auprc:  0.9226700709235914
EarlyStopping counter: 6 out of 50
epoch:  8
epoch:  9 val_f1:  0.7961192047225032 val_auroc:  0.8350290697674418 val_auprc:  0.9277128169826518
EarlyStopping counter: 7 out of 50
epoch:  9
epoch:  10 val_f1:  0.7854893118997625 val_auroc:  0.8415697674418605 val_auprc:  0.9303538449615147
EarlyStopping counter: 8 out of 50
epoch:  10
epoch:  11 val_f1:  0.7916865446634734 val_auroc:  0.8488372093023256 val_auprc:  0.9334718931259791
EarlyStopping counter: 9 out of 50
epoch:  11
epoch:  12 val_f1:  0.7238355598325329 val_auroc:  0.8517441860465117 val_auprc:  0.9343282087061698
EarlyStopping counter: 10 out of 50
epoch:  12
epoch:  13 val_f1:  0.757449328289459 val_auroc:  0.8502906976744186 val_auprc:  0.9344457773822121
EarlyStopping counter: 11 out of 50
epoch:  13
epoch:  14 val_f1:  0.7866727894280321 val_auroc:  0.8529554263565892 val_auprc:  0.9378404006024077
EarlyStopping counter: 12 out of 50
epoch:  14
epoch:  15 val_f1:  0.7961192047225032 val_auroc:  0.8556201550387597 val_auprc:  0.9401119762316297
EarlyStopping counter: 13 out of 50
epoch:  15
epoch:  16 val_f1:  0.7697841726618705 val_auroc:  0.8621608527131783 val_auprc:  0.9404682688804358
EarlyStopping counter: 14 out of 50
epoch:  16
epoch:  17 val_f1:  0.7811109002295425 val_auroc:  0.8609496124031008 val_auprc:  0.9400312620399459
EarlyStopping counter: 15 out of 50
epoch:  17
epoch:  18 val_f1:  0.7912899626822607 val_auroc:  0.8536821705426356 val_auprc:  0.938840930482297
EarlyStopping counter: 16 out of 50
epoch:  18
epoch:  19 val_f1:  0.768937708914086 val_auroc:  0.8626453488372093 val_auprc:  0.9380147416009917
EarlyStopping counter: 17 out of 50
epoch:  19
epoch:  20 val_f1:  0.7892012988311853 val_auroc:  0.867248062015504 val_auprc:  0.9420803458059305
EarlyStopping counter: 18 out of 50
epoch:  20
epoch:  21 val_f1:  0.7841726618705036 val_auroc:  0.8640988372093021 val_auprc:  0.9426013886463335
EarlyStopping counter: 19 out of 50
epoch:  21
epoch:  22 val_f1:  0.7841726618705036 val_auroc:  0.8670058139534884 val_auprc:  0.9427339515105504
EarlyStopping counter: 20 out of 50
epoch:  22
epoch:  23 val_f1:  0.8093907785715628 val_auroc:  0.8638565891472868 val_auprc:  0.9421708098782972
EarlyStopping counter: 21 out of 50
epoch:  23
epoch:  24 val_f1:  0.7427571456348435 val_auroc:  0.8677325581395349 val_auprc:  0.9425007689076859
EarlyStopping counter: 22 out of 50
epoch:  24
epoch:  25 val_f1:  0.7854002281262867 val_auroc:  0.8674903100775193 val_auprc:  0.9452829100451347
EarlyStopping counter: 23 out of 50
epoch:  25
epoch:  26 val_f1:  0.8175531003768415 val_auroc:  0.8713662790697675 val_auprc:  0.946599226575803
EarlyStopping counter: 24 out of 50
epoch:  26
epoch:  27 val_f1:  0.7625825493451395 val_auroc:  0.875968992248062 val_auprc:  0.9473626229383939
EarlyStopping counter: 25 out of 50
epoch:  27
epoch:  28 val_f1:  0.7625825493451395 val_auroc:  0.8713662790697675 val_auprc:  0.9448677663419792
EarlyStopping counter: 26 out of 50
epoch:  28
epoch:  29 val_f1:  0.8047401180179452 val_auroc:  0.8677325581395349 val_auprc:  0.9447105075567468
EarlyStopping counter: 27 out of 50
epoch:  29
epoch:  30 val_f1:  0.8235099801588546 val_auroc:  0.8730620155038761 val_auprc:  0.946572752288664
EarlyStopping counter: 28 out of 50
epoch:  30
epoch:  31 val_f1:  0.8160321672535743 val_auroc:  0.8757267441860465 val_auprc:  0.9480439838721283
EarlyStopping counter: 29 out of 50
epoch:  31
epoch:  32 val_f1:  0.8160321672535743 val_auroc:  0.8713662790697674 val_auprc:  0.9466134116806976
EarlyStopping counter: 30 out of 50
epoch:  32
epoch:  33 val_f1:  0.7985611510791367 val_auroc:  0.8747577519379846 val_auprc:  0.9469137974166533
EarlyStopping counter: 31 out of 50
epoch:  33
epoch:  34 val_f1:  0.8235099801588546 val_auroc:  0.875484496124031 val_auprc:  0.9478038221135736
EarlyStopping counter: 32 out of 50
epoch:  34
epoch:  35 val_f1:  0.8151164175042944 val_auroc:  0.8740310077519379 val_auprc:  0.9478962951658222
EarlyStopping counter: 33 out of 50
epoch:  35
epoch:  36 val_f1:  0.7578890782445586 val_auroc:  0.8796027131782946 val_auprc:  0.94852819946453
EarlyStopping counter: 34 out of 50
epoch:  36
epoch:  37 val_f1:  0.7774211400110681 val_auroc:  0.8820251937984496 val_auprc:  0.9496610978173728
EarlyStopping counter: 35 out of 50
epoch:  37
epoch:  38 val_f1:  0.8129496402877698 val_auroc:  0.8747577519379846 val_auprc:  0.9488421338697354
EarlyStopping counter: 36 out of 50
epoch:  38
epoch:  39 val_f1:  0.7985611510791367 val_auroc:  0.8766957364341086 val_auprc:  0.949370171583709
EarlyStopping counter: 37 out of 50
epoch:  39
epoch:  40 val_f1:  0.7875752415552048 val_auroc:  0.8781492248062015 val_auprc:  0.9482350604364982
EarlyStopping counter: 38 out of 50
epoch:  40
epoch:  41 val_f1:  0.7625825493451395 val_auroc:  0.8786337209302326 val_auprc:  0.9484036598856016
EarlyStopping counter: 39 out of 50
epoch:  41
epoch:  42 val_f1:  0.8129496402877698 val_auroc:  0.874515503875969 val_auprc:  0.9465081789233415
EarlyStopping counter: 40 out of 50
epoch:  42
epoch:  43 val_f1:  0.8168429178951009 val_auroc:  0.876453488372093 val_auprc:  0.9493565060890166
EarlyStopping counter: 41 out of 50
epoch:  43
epoch:  44 val_f1:  0.8084949329130455 val_auroc:  0.8793604651162791 val_auprc:  0.9497131249131254
EarlyStopping counter: 42 out of 50
epoch:  44
epoch:  45 val_f1:  0.7974889768226049 val_auroc:  0.8740310077519381 val_auprc:  0.9476021303275411
Validation loss improved to 0.106392
epoch:  45
epoch:  46 val_f1:  0.8074875573056803 val_auroc:  0.8791182170542635 val_auprc:  0.949371977103352
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.8084949329130455 val_auroc:  0.8798449612403101 val_auprc:  0.9497970197578953
EarlyStopping counter: 2 out of 50
epoch:  47
epoch:  48 val_f1:  0.8293382315424257 val_auroc:  0.8800872093023254 val_auprc:  0.9495355433058013
EarlyStopping counter: 3 out of 50
epoch:  48
epoch:  49 val_f1:  0.8063632502555458 val_auroc:  0.8815406976744187 val_auprc:  0.950176094850391
EarlyStopping counter: 4 out of 50
epoch:  49
epoch:  50 val_f1:  0.8037391402911035 val_auroc:  0.8800872093023256 val_auprc:  0.9492558719278968
EarlyStopping counter: 5 out of 50
epoch:  50
epoch:  51 val_f1:  0.8207067131995794 val_auroc:  0.8783914728682171 val_auprc:  0.9482757068803638
EarlyStopping counter: 6 out of 50
epoch:  51
epoch:  52 val_f1:  0.8207067131995794 val_auroc:  0.8839631782945736 val_auprc:  0.9508507766949839
EarlyStopping counter: 7 out of 50
epoch:  52
epoch:  53 val_f1:  0.8093907785715628 val_auroc:  0.8817829457364341 val_auprc:  0.9501168567582212
EarlyStopping counter: 8 out of 50
epoch:  53
epoch:  54 val_f1:  0.8129496402877698 val_auroc:  0.87984496124031 val_auprc:  0.9495605650221297
EarlyStopping counter: 9 out of 50
epoch:  54
epoch:  55 val_f1:  0.8129496402877698 val_auroc:  0.8798449612403101 val_auprc:  0.9493642628224914
EarlyStopping counter: 10 out of 50
epoch:  55
epoch:  56 val_f1:  0.8037391402911035 val_auroc:  0.8825096899224806 val_auprc:  0.9501215359976857
EarlyStopping counter: 11 out of 50
epoch:  56
epoch:  57 val_f1:  0.8037391402911035 val_auroc:  0.8815406976744187 val_auprc:  0.9492882315177046
EarlyStopping counter: 12 out of 50
epoch:  57
epoch:  58 val_f1:  0.8037391402911035 val_auroc:  0.8808139534883721 val_auprc:  0.9495817705394869
EarlyStopping counter: 13 out of 50
epoch:  58
epoch:  59 val_f1:  0.8151164175042944 val_auroc:  0.8796027131782946 val_auprc:  0.948879295995652
EarlyStopping counter: 14 out of 50
epoch:  59
epoch:  60 val_f1:  0.7940592980161325 val_auroc:  0.8851744186046512 val_auprc:  0.9513803887077263
EarlyStopping counter: 15 out of 50
epoch:  60
epoch:  61 val_f1:  0.7857930944221151 val_auroc:  0.8837209302325582 val_auprc:  0.9511089292435347
EarlyStopping counter: 16 out of 50
epoch:  61
epoch:  62 val_f1:  0.8022252248962252 val_auroc:  0.8832364341085271 val_auprc:  0.9503132468799733
EarlyStopping counter: 17 out of 50
epoch:  62
epoch:  63 val_f1:  0.7892012988311853 val_auroc:  0.8842054263565892 val_auprc:  0.9503596031423918
EarlyStopping counter: 18 out of 50
epoch:  63
epoch:  64 val_f1:  0.7875752415552048 val_auroc:  0.8863856589147288 val_auprc:  0.9512170823812602
EarlyStopping counter: 19 out of 50
epoch:  64
epoch:  65 val_f1:  0.7957035068809065 val_auroc:  0.8800872093023255 val_auprc:  0.9492587201377476
EarlyStopping counter: 20 out of 50
epoch:  65
epoch:  66 val_f1:  0.7940592980161325 val_auroc:  0.8817829457364341 val_auprc:  0.9491668339862849
EarlyStopping counter: 21 out of 50
epoch:  66
epoch:  67 val_f1:  0.7957035068809065 val_auroc:  0.8815406976744186 val_auprc:  0.9494145070791409
EarlyStopping counter: 22 out of 50
epoch:  67
epoch:  68 val_f1:  0.7972014141264308 val_auroc:  0.8829941860465116 val_auprc:  0.9502693439188741
EarlyStopping counter: 23 out of 50
epoch:  68
epoch:  69 val_f1:  0.7940592980161325 val_auroc:  0.8825096899224807 val_auprc:  0.9497157340462548
EarlyStopping counter: 24 out of 50
epoch:  69
epoch:  70 val_f1:  0.7940592980161325 val_auroc:  0.8810562015503876 val_auprc:  0.9492490918889469
EarlyStopping counter: 25 out of 50
epoch:  70
epoch:  71 val_f1:  0.7972014141264308 val_auroc:  0.8808139534883722 val_auprc:  0.9493857178882608
EarlyStopping counter: 26 out of 50
epoch:  71
epoch:  72 val_f1:  0.8129496402877698 val_auroc:  0.8803294573643411 val_auprc:  0.9492890634813118
EarlyStopping counter: 27 out of 50
epoch:  72
epoch:  73 val_f1:  0.7957035068809065 val_auroc:  0.8822674418604651 val_auprc:  0.9498396456652278
EarlyStopping counter: 28 out of 50
epoch:  73
epoch:  74 val_f1:  0.7957035068809065 val_auroc:  0.8810562015503876 val_auprc:  0.9495175683258633
EarlyStopping counter: 29 out of 50
epoch:  74
epoch:  75 val_f1:  0.7774211400110681 val_auroc:  0.8844476744186046 val_auprc:  0.9500926331014661
EarlyStopping counter: 30 out of 50
epoch:  75
epoch:  76 val_f1:  0.7940592980161325 val_auroc:  0.8815406976744186 val_auprc:  0.9494341800857156
EarlyStopping counter: 31 out of 50
epoch:  76
epoch:  77 val_f1:  0.7875752415552048 val_auroc:  0.8808139534883722 val_auprc:  0.9490796699739867
EarlyStopping counter: 32 out of 50
epoch:  77
epoch:  78 val_f1:  0.7940592980161325 val_auroc:  0.882751937984496 val_auprc:  0.9496086441039229
EarlyStopping counter: 33 out of 50
epoch:  78
epoch:  79 val_f1:  0.7892012988311853 val_auroc:  0.8812984496124031 val_auprc:  0.9491312873148939
EarlyStopping counter: 34 out of 50
epoch:  79
epoch:  80 val_f1:  0.7940592980161325 val_auroc:  0.8815406976744186 val_auprc:  0.9496091728896585
EarlyStopping counter: 35 out of 50
epoch:  80
epoch:  81 val_f1:  0.7940592980161325 val_auroc:  0.8798449612403101 val_auprc:  0.9476160107371412
EarlyStopping counter: 36 out of 50
epoch:  81
epoch:  82 val_f1:  0.8160321672535743 val_auroc:  0.8791182170542636 val_auprc:  0.9487476092604108
EarlyStopping counter: 37 out of 50
epoch:  82
epoch:  83 val_f1:  0.7972014141264308 val_auroc:  0.8805717054263565 val_auprc:  0.9486854742853323
EarlyStopping counter: 38 out of 50
epoch:  83
epoch:  84 val_f1:  0.7940592980161325 val_auroc:  0.8798449612403101 val_auprc:  0.9480346544807705
EarlyStopping counter: 39 out of 50
epoch:  84
epoch:  85 val_f1:  0.7940592980161325 val_auroc:  0.8810562015503877 val_auprc:  0.9492288241945107
EarlyStopping counter: 40 out of 50
epoch:  85
epoch:  86 val_f1:  0.7957035068809065 val_auroc:  0.8815406976744186 val_auprc:  0.949345984774415
EarlyStopping counter: 41 out of 50
epoch:  86
epoch:  87 val_f1:  0.8037391402911035 val_auroc:  0.8791182170542635 val_auprc:  0.948852958656093
EarlyStopping counter: 42 out of 50
epoch:  87
epoch:  88 val_f1:  0.7940592980161325 val_auroc:  0.8832364341085271 val_auprc:  0.9494279674789504
EarlyStopping counter: 43 out of 50
epoch:  88
epoch:  89 val_f1:  0.8051160047274586 val_auroc:  0.8817829457364341 val_auprc:  0.9492685935404224
EarlyStopping counter: 44 out of 50
epoch:  89
epoch:  90 val_f1:  0.7972014141264308 val_auroc:  0.8820251937984497 val_auprc:  0.9495592749688875
EarlyStopping counter: 45 out of 50
epoch:  90
epoch:  91 val_f1:  0.8037391402911035 val_auroc:  0.8808139534883721 val_auprc:  0.9491055787044123
EarlyStopping counter: 46 out of 50
epoch:  91
epoch:  92 val_f1:  0.7940592980161325 val_auroc:  0.8815406976744187 val_auprc:  0.9487650328353896
EarlyStopping counter: 47 out of 50
epoch:  92
epoch:  93 val_f1:  0.8037391402911035 val_auroc:  0.8798449612403101 val_auprc:  0.9490107112540997
EarlyStopping counter: 48 out of 50
epoch:  93
epoch:  94 val_f1:  0.7940592980161325 val_auroc:  0.8810562015503876 val_auprc:  0.9487188533875464
EarlyStopping counter: 49 out of 50
epoch:  94
epoch:  95 val_f1:  0.7875752415552048 val_auroc:  0.8805717054263565 val_auprc:  0.9490874184182471
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  275.5342400074005
{'time_elapsed': [275.5342400074005], 'epoch': [94], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7875752415552048], 'auroc_test': [0.8805717054263565], 'auprc_test': [0.9490874184182471]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1280]           512
│    └─BatchNorm1d: 2-2                  [64, 128, 1280]           256
│    └─Tanh: 2-3                         [64, 128, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1278]           --
│    └─Dropout: 2-5                      [64, 128, 1278]           --
│    └─Flatten: 2-6                      [64, 163584]              --
│    └─Linear: 2-7                       [64, 1]                   163,585
==========================================================================================
Total params: 164,353
Trainable params: 164,353
Non-trainable params: 0
Total mult-adds (M): 52.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.77
Params size (MB): 0.66
Estimated Total Size (MB): 168.76
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.7619195555090884 val_auroc:  0.8241567460317459 val_auprc:  0.9015120675189451
epoch:  1
epoch:  2 val_f1:  0.7346914777905165 val_auroc:  0.8110119047619048 val_auprc:  0.9093253224563168
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.7524122655753033 val_auroc:  0.8191964285714287 val_auprc:  0.9125263805680877
Validation loss improved to 0.353156
epoch:  3
epoch:  4 val_f1:  0.7674475643829729 val_auroc:  0.8442460317460317 val_auprc:  0.9221799954254023
Validation loss improved to 0.326718
epoch:  4
epoch:  5 val_f1:  0.7815416513900654 val_auroc:  0.8519345238095238 val_auprc:  0.922475682544227
Validation loss improved to 0.268702
epoch:  5
epoch:  6 val_f1:  0.7621343873517787 val_auroc:  0.8472222222222222 val_auprc:  0.9220566700828348
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.7425627404942808 val_auroc:  0.8511904761904762 val_auprc:  0.9278114863922178
EarlyStopping counter: 2 out of 50
epoch:  7
epoch:  8 val_f1:  0.7793921916592724 val_auroc:  0.8541666666666667 val_auprc:  0.9288426140679547
EarlyStopping counter: 3 out of 50
epoch:  8
epoch:  9 val_f1:  0.7852367336641158 val_auroc:  0.8524305555555556 val_auprc:  0.9246656029629752
EarlyStopping counter: 4 out of 50
epoch:  9
epoch:  10 val_f1:  0.7746271791640412 val_auroc:  0.8395337301587302 val_auprc:  0.9176911955590374
EarlyStopping counter: 5 out of 50
epoch:  10
epoch:  11 val_f1:  0.7703937955759801 val_auroc:  0.8539186507936508 val_auprc:  0.9270073820776833
EarlyStopping counter: 6 out of 50
epoch:  11
epoch:  12 val_f1:  0.7695918258740887 val_auroc:  0.8504464285714286 val_auprc:  0.9248224975490562
EarlyStopping counter: 7 out of 50
epoch:  12
epoch:  13 val_f1:  0.7755148741418765 val_auroc:  0.8452380952380953 val_auprc:  0.9200337951684033
EarlyStopping counter: 8 out of 50
epoch:  13
epoch:  14 val_f1:  0.7627107192324585 val_auroc:  0.8539186507936508 val_auprc:  0.9266817039218603
EarlyStopping counter: 9 out of 50
epoch:  14
epoch:  15 val_f1:  0.7388944960742422 val_auroc:  0.8616071428571429 val_auprc:  0.9299233833598165
EarlyStopping counter: 10 out of 50
epoch:  15
epoch:  16 val_f1:  0.7071964017991005 val_auroc:  0.8539186507936508 val_auprc:  0.9293403665303474
EarlyStopping counter: 11 out of 50
epoch:  16
epoch:  17 val_f1:  0.7819511139952413 val_auroc:  0.8603670634920635 val_auprc:  0.9288545899015632
EarlyStopping counter: 12 out of 50
epoch:  17
epoch:  18 val_f1:  0.8215074100875418 val_auroc:  0.8630952380952381 val_auprc:  0.9344125489008503
EarlyStopping counter: 13 out of 50
epoch:  18
epoch:  19 val_f1:  0.792371879328401 val_auroc:  0.8692956349206349 val_auprc:  0.9349251780926846
EarlyStopping counter: 14 out of 50
epoch:  19
epoch:  20 val_f1:  0.8127933585226971 val_auroc:  0.8635912698412698 val_auprc:  0.932552806904386
EarlyStopping counter: 15 out of 50
epoch:  20
epoch:  21 val_f1:  0.740709548373513 val_auroc:  0.8519345238095238 val_auprc:  0.9241169397457647
EarlyStopping counter: 16 out of 50
epoch:  21
epoch:  22 val_f1:  0.7282743721307049 val_auroc:  0.8640873015873015 val_auprc:  0.93524318464829
EarlyStopping counter: 17 out of 50
epoch:  22
epoch:  23 val_f1:  0.740709548373513 val_auroc:  0.857638888888889 val_auprc:  0.9271359698906863
EarlyStopping counter: 18 out of 50
epoch:  23
epoch:  24 val_f1:  0.7773176903611687 val_auroc:  0.871031746031746 val_auprc:  0.9375490786485284
EarlyStopping counter: 19 out of 50
epoch:  24
epoch:  25 val_f1:  0.7861608411480533 val_auroc:  0.873015873015873 val_auprc:  0.9387551613116917
EarlyStopping counter: 20 out of 50
epoch:  25
epoch:  26 val_f1:  0.8127933585226971 val_auroc:  0.8712797619047619 val_auprc:  0.9381846594764138
EarlyStopping counter: 21 out of 50
epoch:  26
epoch:  27 val_f1:  0.7653944520952194 val_auroc:  0.8526785714285714 val_auprc:  0.9197235428604806
EarlyStopping counter: 22 out of 50
epoch:  27
epoch:  28 val_f1:  0.8194319840387783 val_auroc:  0.8556547619047619 val_auprc:  0.9264147985681324
EarlyStopping counter: 23 out of 50
epoch:  28
epoch:  29 val_f1:  0.8022296544035674 val_auroc:  0.8650793650793651 val_auprc:  0.9281783634115373
EarlyStopping counter: 24 out of 50
epoch:  29
epoch:  30 val_f1:  0.8194319840387783 val_auroc:  0.8678075396825398 val_auprc:  0.9309115550775192
EarlyStopping counter: 25 out of 50
epoch:  30
epoch:  31 val_f1:  0.7746271791640412 val_auroc:  0.8628472222222222 val_auprc:  0.9262450351557816
EarlyStopping counter: 26 out of 50
epoch:  31
epoch:  32 val_f1:  0.8061683443992288 val_auroc:  0.8702876984126985 val_auprc:  0.9338131895977025
EarlyStopping counter: 27 out of 50
epoch:  32
epoch:  33 val_f1:  0.800639197204071 val_auroc:  0.8670634920634921 val_auprc:  0.9278000164159015
EarlyStopping counter: 28 out of 50
epoch:  33
epoch:  34 val_f1:  0.8054462242562929 val_auroc:  0.8660714285714286 val_auprc:  0.9275133078819003
EarlyStopping counter: 29 out of 50
epoch:  34
epoch:  35 val_f1:  0.8072024593763724 val_auroc:  0.8675595238095237 val_auprc:  0.9289039854225187
EarlyStopping counter: 30 out of 50
epoch:  35
epoch:  36 val_f1:  0.800639197204071 val_auroc:  0.8653273809523809 val_auprc:  0.9278234075434593
EarlyStopping counter: 31 out of 50
epoch:  36
epoch:  37 val_f1:  0.8035275913020209 val_auroc:  0.8660714285714286 val_auprc:  0.924411936486025
EarlyStopping counter: 32 out of 50
epoch:  37
epoch:  38 val_f1:  0.7940993788819876 val_auroc:  0.8665674603174603 val_auprc:  0.9260124956233544
EarlyStopping counter: 33 out of 50
epoch:  38
epoch:  39 val_f1:  0.8054462242562929 val_auroc:  0.863343253968254 val_auprc:  0.9204477270086301
EarlyStopping counter: 34 out of 50
epoch:  39
epoch:  40 val_f1:  0.8015122873345937 val_auroc:  0.8702876984126983 val_auprc:  0.929547097931432
EarlyStopping counter: 35 out of 50
epoch:  40
epoch:  41 val_f1:  0.8102677351291666 val_auroc:  0.8621031746031746 val_auprc:  0.9225092639963208
EarlyStopping counter: 36 out of 50
epoch:  41
epoch:  42 val_f1:  0.8154066640778435 val_auroc:  0.8650793650793651 val_auprc:  0.9242257805252501
EarlyStopping counter: 37 out of 50
epoch:  42
epoch:  43 val_f1:  0.8054462242562929 val_auroc:  0.8655753968253969 val_auprc:  0.9211551148887814
EarlyStopping counter: 38 out of 50
epoch:  43
epoch:  44 val_f1:  0.7875799991742021 val_auroc:  0.8623511904761905 val_auprc:  0.9196602368851736
EarlyStopping counter: 39 out of 50
epoch:  44
epoch:  45 val_f1:  0.8022296544035674 val_auroc:  0.865079365079365 val_auprc:  0.9206142852197439
EarlyStopping counter: 40 out of 50
epoch:  45
epoch:  46 val_f1:  0.8022296544035674 val_auroc:  0.8690476190476192 val_auprc:  0.9288522387166318
EarlyStopping counter: 41 out of 50
epoch:  46
epoch:  47 val_f1:  0.800639197204071 val_auroc:  0.8670634920634922 val_auprc:  0.9239054702078999
EarlyStopping counter: 42 out of 50
epoch:  47
epoch:  48 val_f1:  0.8022296544035674 val_auroc:  0.8670634920634921 val_auprc:  0.923834452245034
EarlyStopping counter: 43 out of 50
epoch:  48
epoch:  49 val_f1:  0.8054462242562929 val_auroc:  0.8678075396825397 val_auprc:  0.9238624860173618
EarlyStopping counter: 44 out of 50
epoch:  49
epoch:  50 val_f1:  0.8154066640778435 val_auroc:  0.8683035714285715 val_auprc:  0.9243793727364114
EarlyStopping counter: 45 out of 50
epoch:  50
epoch:  51 val_f1:  0.807228002894545 val_auroc:  0.8720238095238096 val_auprc:  0.9288888139636509
EarlyStopping counter: 46 out of 50
epoch:  51
epoch:  52 val_f1:  0.792371879328401 val_auroc:  0.8668154761904762 val_auprc:  0.9221652833158874
EarlyStopping counter: 47 out of 50
epoch:  52
epoch:  53 val_f1:  0.8120268224096906 val_auroc:  0.8689236111111112 val_auprc:  0.9232660880395176
EarlyStopping counter: 48 out of 50
epoch:  53
epoch:  54 val_f1:  0.8102677351291666 val_auroc:  0.8700396825396827 val_auprc:  0.9275623867167706
EarlyStopping counter: 49 out of 50
epoch:  54
epoch:  55 val_f1:  0.792371879328401 val_auroc:  0.8660714285714287 val_auprc:  0.9224216029332253
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  159.65053915977478
{'time_elapsed': [159.65053915977478], 'epoch': [54], 'fold': [4], 'f1_train': [0.9982029282297181], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.792371879328401], 'auroc_test': [0.8660714285714287], 'auprc_test': [0.9224216029332253]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1280]           512
│    └─BatchNorm1d: 2-2                  [64, 128, 1280]           256
│    └─Tanh: 2-3                         [64, 128, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1278]           --
│    └─Dropout: 2-5                      [64, 128, 1278]           --
│    └─Flatten: 2-6                      [64, 163584]              --
│    └─Linear: 2-7                       [64, 1]                   163,585
==========================================================================================
Total params: 164,353
Trainable params: 164,353
Non-trainable params: 0
Total mult-adds (M): 52.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.77
Params size (MB): 0.66
Estimated Total Size (MB): 168.76
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_76', 'config': {'hidden_channels': [128], 'epochs': 500, 'kernel_size': 3, 'pool_kernel_size': 3, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5063210807344186 val_auroc:  0.6737849779086893 val_auprc:  0.8093961296071168
epoch:  1
epoch:  2 val_f1:  0.5729592891364544 val_auroc:  0.6647029945999018 val_auprc:  0.7876264515557929
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6624515771997785 val_auroc:  0.6750122729504173 val_auprc:  0.811794972874659
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5820104714776274 val_auroc:  0.742513500245459 val_auprc:  0.8763571748064563
Validation loss improved to 1.202652
epoch:  4
epoch:  5 val_f1:  0.7166299330477814 val_auroc:  0.7633775159548355 val_auprc:  0.8914956006534562
Validation loss improved to 1.156918
epoch:  5
epoch:  6 val_f1:  0.7442757932382417 val_auroc:  0.7778595974472263 val_auprc:  0.8972787416104375
Validation loss improved to 1.115300
epoch:  6
epoch:  7 val_f1:  0.7170655771870609 val_auroc:  0.7812960235640649 val_auprc:  0.8969446805819827
Validation loss improved to 1.098963
epoch:  7
epoch:  8 val_f1:  0.7466980132583976 val_auroc:  0.7827687776141384 val_auprc:  0.8971632464513295
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.6954243384953055 val_auroc:  0.8053510063819342 val_auprc:  0.9148848483212766
Validation loss improved to 1.075726
epoch:  9
epoch:  10 val_f1:  0.7510257046352308 val_auroc:  0.8021600392734414 val_auprc:  0.9114456064633973
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.735514445586388 val_auroc:  0.8060873834069711 val_auprc:  0.9130868836811126
EarlyStopping counter: 2 out of 50
epoch:  11
epoch:  12 val_f1:  0.7683026725960121 val_auroc:  0.8031418753068238 val_auprc:  0.9113127955176931
EarlyStopping counter: 3 out of 50
epoch:  12
epoch:  13 val_f1:  0.7428255465713769 val_auroc:  0.8100147275405007 val_auprc:  0.914836690623504
EarlyStopping counter: 4 out of 50
epoch:  13
epoch:  14 val_f1:  0.7170452552783244 val_auroc:  0.81173294059892 val_auprc:  0.9176416249134678
EarlyStopping counter: 5 out of 50
epoch:  14
epoch:  15 val_f1:  0.7617596949267598 val_auroc:  0.8109965635738832 val_auprc:  0.9166613089769631
EarlyStopping counter: 6 out of 50
epoch:  15
epoch:  16 val_f1:  0.7477455593342162 val_auroc:  0.8092783505154638 val_auprc:  0.9155722944002365
EarlyStopping counter: 7 out of 50
epoch:  16
epoch:  17 val_f1:  0.7367608586927249 val_auroc:  0.8112420225822288 val_auprc:  0.9176947569220704
EarlyStopping counter: 8 out of 50
epoch:  17
epoch:  18 val_f1:  0.6720188084826255 val_auroc:  0.823514972999509 val_auprc:  0.9251557903907044
EarlyStopping counter: 9 out of 50
epoch:  18
epoch:  19 val_f1:  0.7617596949267598 val_auroc:  0.8114874815905745 val_auprc:  0.9173850898676821
EarlyStopping counter: 10 out of 50
epoch:  19
epoch:  20 val_f1:  0.7553956834532374 val_auroc:  0.8107511045655376 val_auprc:  0.9172927748928922
EarlyStopping counter: 11 out of 50
epoch:  20
epoch:  21 val_f1:  0.7020922662535899 val_auroc:  0.8190967108492881 val_auprc:  0.921764278779688
EarlyStopping counter: 12 out of 50
epoch:  21
epoch:  22 val_f1:  0.7699730743399811 val_auroc:  0.8139420716740304 val_auprc:  0.9191273166081414
EarlyStopping counter: 13 out of 50
epoch:  22
epoch:  23 val_f1:  0.7519437633413868 val_auroc:  0.814187530682376 val_auprc:  0.9200079321528878
EarlyStopping counter: 14 out of 50
epoch:  23
epoch:  24 val_f1:  0.7569659388768054 val_auroc:  0.8149239077074129 val_auprc:  0.9209038926112727
EarlyStopping counter: 15 out of 50
epoch:  24
epoch:  25 val_f1:  0.7367608586927249 val_auroc:  0.8154148257241041 val_auprc:  0.9206245741006124
EarlyStopping counter: 16 out of 50
epoch:  25
epoch:  26 val_f1:  0.748656020238754 val_auroc:  0.822287677957781 val_auprc:  0.9256600383350384
EarlyStopping counter: 17 out of 50
epoch:  26
epoch:  27 val_f1:  0.7367608586927249 val_auroc:  0.8136966126656848 val_auprc:  0.9191482172328896
EarlyStopping counter: 18 out of 50
epoch:  27
epoch:  28 val_f1:  0.7410071942446043 val_auroc:  0.8092783505154639 val_auprc:  0.918470524083655
EarlyStopping counter: 19 out of 50
epoch:  28
epoch:  29 val_f1:  0.7494347379239465 val_auroc:  0.8117329405989201 val_auprc:  0.9176757673159397
EarlyStopping counter: 20 out of 50
epoch:  29
epoch:  30 val_f1:  0.7239714721729109 val_auroc:  0.821060382916053 val_auprc:  0.9244672360835362
EarlyStopping counter: 21 out of 50
epoch:  30
epoch:  31 val_f1:  0.7363119073255568 val_auroc:  0.8139420716740304 val_auprc:  0.9210434180009158
EarlyStopping counter: 22 out of 50
epoch:  31
epoch:  32 val_f1:  0.7490302789770621 val_auroc:  0.8117329405989201 val_auprc:  0.9192531404269548
EarlyStopping counter: 23 out of 50
epoch:  32
epoch:  33 val_f1:  0.7420910227448273 val_auroc:  0.8188512518409427 val_auprc:  0.9221077008196765
EarlyStopping counter: 24 out of 50
epoch:  33
epoch:  34 val_f1:  0.7441671543148256 val_auroc:  0.8154148257241041 val_auprc:  0.9216967372581927
EarlyStopping counter: 25 out of 50
epoch:  34
epoch:  35 val_f1:  0.7441671543148256 val_auroc:  0.8127147766323024 val_auprc:  0.9204822403930064
EarlyStopping counter: 26 out of 50
epoch:  35
epoch:  36 val_f1:  0.748656020238754 val_auroc:  0.8127147766323024 val_auprc:  0.9177476811844739
EarlyStopping counter: 27 out of 50
epoch:  36
epoch:  37 val_f1:  0.7583800901862243 val_auroc:  0.8151693667157586 val_auprc:  0.9221420435737518
EarlyStopping counter: 28 out of 50
epoch:  37
epoch:  38 val_f1:  0.7473302173830908 val_auroc:  0.8036327933235149 val_auprc:  0.9115754382473996
EarlyStopping counter: 29 out of 50
epoch:  38
epoch:  39 val_f1:  0.7477455593342162 val_auroc:  0.8178694158075601 val_auprc:  0.9228463272719858
EarlyStopping counter: 30 out of 50
epoch:  39
epoch:  40 val_f1:  0.7363119073255568 val_auroc:  0.8095238095238094 val_auprc:  0.9155873882917203
EarlyStopping counter: 31 out of 50
epoch:  40
epoch:  41 val_f1:  0.7363119073255568 val_auroc:  0.8146784486990672 val_auprc:  0.9191507813684027
EarlyStopping counter: 32 out of 50
epoch:  41
epoch:  42 val_f1:  0.7542604103291037 val_auroc:  0.8220422189494354 val_auprc:  0.9248423089539818
EarlyStopping counter: 33 out of 50
epoch:  42
epoch:  43 val_f1:  0.7466980132583976 val_auroc:  0.8156602847324497 val_auprc:  0.9200524388337845
EarlyStopping counter: 34 out of 50
epoch:  43
epoch:  44 val_f1:  0.7363119073255568 val_auroc:  0.8068237604320079 val_auprc:  0.915836035722388
EarlyStopping counter: 35 out of 50
epoch:  44
epoch:  45 val_f1:  0.7477455593342162 val_auroc:  0.819833087874325 val_auprc:  0.9241474623354559
EarlyStopping counter: 36 out of 50
epoch:  45
epoch:  46 val_f1:  0.7455074238481555 val_auroc:  0.821060382916053 val_auprc:  0.9244917605967053
EarlyStopping counter: 37 out of 50
epoch:  46
epoch:  47 val_f1:  0.7617684906754855 val_auroc:  0.8053510063819342 val_auprc:  0.9138069586729316
EarlyStopping counter: 38 out of 50
epoch:  47
epoch:  48 val_f1:  0.7839141001375581 val_auroc:  0.8208149239077074 val_auprc:  0.9234097865562252
EarlyStopping counter: 39 out of 50
epoch:  48
epoch:  49 val_f1:  0.7377691212466089 val_auroc:  0.8200785468826706 val_auprc:  0.922916211180267
EarlyStopping counter: 40 out of 50
epoch:  49
epoch:  50 val_f1:  0.7490302789770621 val_auroc:  0.8114874815905744 val_auprc:  0.9160509536517772
EarlyStopping counter: 41 out of 50
epoch:  50
epoch:  51 val_f1:  0.7542604103291037 val_auroc:  0.8230240549828178 val_auprc:  0.9257456231875875
EarlyStopping counter: 42 out of 50
epoch:  51
epoch:  52 val_f1:  0.7490302789770621 val_auroc:  0.8075601374570447 val_auprc:  0.9140729899778897
EarlyStopping counter: 43 out of 50
epoch:  52
epoch:  53 val_f1:  0.7426698176342648 val_auroc:  0.8097692685321551 val_auprc:  0.9156484856464515
EarlyStopping counter: 44 out of 50
epoch:  53
epoch:  54 val_f1:  0.7607703458551531 val_auroc:  0.8213058419243986 val_auprc:  0.9246412842105762
EarlyStopping counter: 45 out of 50
epoch:  54
epoch:  55 val_f1:  0.7426698176342648 val_auroc:  0.809769268532155 val_auprc:  0.9144198897247173
EarlyStopping counter: 46 out of 50
epoch:  55
epoch:  56 val_f1:  0.7363119073255568 val_auroc:  0.8225331369661267 val_auprc:  0.9250397398542051
EarlyStopping counter: 47 out of 50
epoch:  56
epoch:  57 val_f1:  0.7441671543148256 val_auroc:  0.8230240549828178 val_auprc:  0.925066882006409
EarlyStopping counter: 48 out of 50
epoch:  57
epoch:  58 val_f1:  0.7426698176342648 val_auroc:  0.812960235640648 val_auprc:  0.9173609664219556
EarlyStopping counter: 49 out of 50
epoch:  58
epoch:  59 val_f1:  0.7441671543148256 val_auroc:  0.8188512518409425 val_auprc:  0.9222354291059847
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  41.88358664512634
{'time_elapsed': [41.88358664512634], 'epoch': [58], 'fold': [0], 'f1_train': [0.9928161714345926], 'auroc_train': [0.9999693411411227], 'auprc_train': [0.9999865767758085], 'f1_test': [0.7441671543148256], 'auroc_test': [0.8188512518409425], 'auprc_test': [0.9222354291059847]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 427]            512
│    └─BatchNorm1d: 2-2                  [64, 128, 427]            256
│    └─Tanh: 2-3                         [64, 128, 427]            --
│    └─MaxPool1d: 2-4                    [64, 128, 142]            --
│    └─Dropout: 2-5                      [64, 128, 142]            --
│    └─Flatten: 2-6                      [64, 18176]               --
│    └─Linear: 2-7                       [64, 1]                   18,177
==========================================================================================
Total params: 18,945
Trainable params: 18,945
Non-trainable params: 0
Total mult-adds (M): 15.17
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 55.97
Params size (MB): 0.08
Estimated Total Size (MB): 56.37
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6270952429327398 val_auroc:  0.6217476681394207 val_auprc:  0.8193656287130745
epoch:  1
epoch:  2 val_f1:  0.6549146225188524 val_auroc:  0.6909671084928817 val_auprc:  0.8233613272439426
Validation loss improved to 1.123838
epoch:  2
epoch:  3 val_f1:  0.703263898025454 val_auroc:  0.7376043200785469 val_auprc:  0.8668159557702431
Validation loss improved to 1.091865
epoch:  3
epoch:  4 val_f1:  0.7236892364125374 val_auroc:  0.7763868433971528 val_auprc:  0.9007541514565017
Validation loss improved to 1.063335
epoch:  4
epoch:  5 val_f1:  0.7246795893300292 val_auroc:  0.7749140893470791 val_auprc:  0.901044758202589
Validation loss improved to 1.038226
epoch:  5
epoch:  6 val_f1:  0.7377691212466089 val_auroc:  0.7854688267059401 val_auprc:  0.9093692226048324
Validation loss improved to 1.005207
epoch:  6
epoch:  7 val_f1:  0.7308672563486676 val_auroc:  0.7876779577810507 val_auprc:  0.9116948520342619
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.7159484399162135 val_auroc:  0.7933235149729995 val_auprc:  0.9145635308958541
EarlyStopping counter: 2 out of 50
epoch:  8
epoch:  9 val_f1:  0.7428255465713769 val_auroc:  0.7960235640648011 val_auprc:  0.9154008721864519
Validation loss improved to 0.979987
epoch:  9
epoch:  10 val_f1:  0.7691994463100789 val_auroc:  0.7928325969563083 val_auprc:  0.9118757470983232
Validation loss improved to 0.971328
epoch:  10
epoch:  11 val_f1:  0.7428255465713769 val_auroc:  0.7952871870397643 val_auprc:  0.9127142935347319
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7362024088594293 val_auroc:  0.7955326460481099 val_auprc:  0.9128857103862676
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.7617596949267598 val_auroc:  0.8009327442317133 val_auprc:  0.9145070227084069
Validation loss improved to 0.964167
epoch:  13
epoch:  14 val_f1:  0.7426698176342648 val_auroc:  0.7950417280314188 val_auprc:  0.9111263960989768
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.730071543320129 val_auroc:  0.7979872361315661 val_auprc:  0.9133573111718478
EarlyStopping counter: 2 out of 50
epoch:  15
epoch:  16 val_f1:  0.7500864926036699 val_auroc:  0.8011782032400588 val_auprc:  0.9141934268687931
EarlyStopping counter: 3 out of 50
epoch:  16
epoch:  17 val_f1:  0.7473302173830908 val_auroc:  0.7989690721649485 val_auprc:  0.9128276475032371
EarlyStopping counter: 4 out of 50
epoch:  17
epoch:  18 val_f1:  0.7390688025474315 val_auroc:  0.8009327442317132 val_auprc:  0.9140411429497718
EarlyStopping counter: 5 out of 50
epoch:  18
epoch:  19 val_f1:  0.748656020238754 val_auroc:  0.8014236622484046 val_auprc:  0.9139599416194036
Validation loss improved to 0.963284
epoch:  19
epoch:  20 val_f1:  0.7420910227448273 val_auroc:  0.8031418753068237 val_auprc:  0.9153015507994487
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7519437633413868 val_auroc:  0.8021600392734413 val_auprc:  0.9140370639527171
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7737843767539161 val_auroc:  0.8014236622484044 val_auprc:  0.9136960177214086
EarlyStopping counter: 3 out of 50
epoch:  22
epoch:  23 val_f1:  0.7672775806504117 val_auroc:  0.799214531173294 val_auprc:  0.9125850113206673
EarlyStopping counter: 4 out of 50
epoch:  23
epoch:  24 val_f1:  0.7441671543148256 val_auroc:  0.8028964162984781 val_auprc:  0.9133249123295821
EarlyStopping counter: 5 out of 50
epoch:  24
epoch:  25 val_f1:  0.7428255465713769 val_auroc:  0.803632793323515 val_auprc:  0.9147942503736753
EarlyStopping counter: 6 out of 50
epoch:  25
epoch:  26 val_f1:  0.7166299330477814 val_auroc:  0.8026509572901325 val_auprc:  0.9152614351351412
EarlyStopping counter: 7 out of 50
epoch:  26
epoch:  27 val_f1:  0.7531731915989216 val_auroc:  0.8026509572901325 val_auprc:  0.9134305606437898
EarlyStopping counter: 8 out of 50
epoch:  27
epoch:  28 val_f1:  0.7607703458551531 val_auroc:  0.804860088365243 val_auprc:  0.914367986518956
EarlyStopping counter: 9 out of 50
epoch:  28
epoch:  29 val_f1:  0.7596459003010357 val_auroc:  0.8046146293568974 val_auprc:  0.9136222350090835
EarlyStopping counter: 10 out of 50
epoch:  29
epoch:  30 val_f1:  0.7531731915989216 val_auroc:  0.8033873343151693 val_auprc:  0.9134894515470287
EarlyStopping counter: 11 out of 50
epoch:  30
epoch:  31 val_f1:  0.7420910227448273 val_auroc:  0.8053510063819342 val_auprc:  0.9147304763284787
EarlyStopping counter: 12 out of 50
epoch:  31
epoch:  32 val_f1:  0.735514445586388 val_auroc:  0.8046146293568973 val_auprc:  0.9142014957092918
EarlyStopping counter: 13 out of 50
epoch:  32
epoch:  33 val_f1:  0.7777125328082551 val_auroc:  0.8058419243986253 val_auprc:  0.9136182229545853
EarlyStopping counter: 14 out of 50
epoch:  33
epoch:  34 val_f1:  0.7298678635622811 val_auroc:  0.8019145802650957 val_auprc:  0.9090918044530177
EarlyStopping counter: 15 out of 50
epoch:  34
epoch:  35 val_f1:  0.7402181480621955 val_auroc:  0.8041237113402062 val_auprc:  0.9134653138643216
EarlyStopping counter: 16 out of 50
epoch:  35
epoch:  36 val_f1:  0.7441671543148256 val_auroc:  0.8065783014236623 val_auprc:  0.9139782325762866
EarlyStopping counter: 17 out of 50
epoch:  36
epoch:  37 val_f1:  0.7448635686045757 val_auroc:  0.7989690721649484 val_auprc:  0.9084720918433642
EarlyStopping counter: 18 out of 50
epoch:  37
epoch:  38 val_f1:  0.7633714058926586 val_auroc:  0.8006872852233676 val_auprc:  0.909602216756012
EarlyStopping counter: 19 out of 50
epoch:  38
epoch:  39 val_f1:  0.7490302789770621 val_auroc:  0.8019145802650958 val_auprc:  0.9096873988328689
EarlyStopping counter: 20 out of 50
epoch:  39
epoch:  40 val_f1:  0.7583800901862243 val_auroc:  0.7994599901816397 val_auprc:  0.9095576533930362
EarlyStopping counter: 21 out of 50
epoch:  40
epoch:  41 val_f1:  0.7426698176342648 val_auroc:  0.7997054491899853 val_auprc:  0.9087733101418439
EarlyStopping counter: 22 out of 50
epoch:  41
epoch:  42 val_f1:  0.7580594896895918 val_auroc:  0.7999509081983309 val_auprc:  0.9082348597326355
EarlyStopping counter: 23 out of 50
epoch:  42
epoch:  43 val_f1:  0.7643829551743221 val_auroc:  0.8016691212567502 val_auprc:  0.9085902381789522
EarlyStopping counter: 24 out of 50
epoch:  43
epoch:  44 val_f1:  0.7363119073255568 val_auroc:  0.8021600392734414 val_auprc:  0.9113523191987006
EarlyStopping counter: 25 out of 50
epoch:  44
epoch:  45 val_f1:  0.7377691212466089 val_auroc:  0.8004418262150221 val_auprc:  0.9099204710751558
EarlyStopping counter: 26 out of 50
epoch:  45
epoch:  46 val_f1:  0.7727225509205256 val_auroc:  0.7999509081983309 val_auprc:  0.9078867007812035
EarlyStopping counter: 27 out of 50
epoch:  46
epoch:  47 val_f1:  0.766354189375772 val_auroc:  0.8001963672066765 val_auprc:  0.9081725876657608
EarlyStopping counter: 28 out of 50
epoch:  47
epoch:  48 val_f1:  0.7426698176342648 val_auroc:  0.7992145311732941 val_auprc:  0.9088412492837704
EarlyStopping counter: 29 out of 50
epoch:  48
epoch:  49 val_f1:  0.766354189375772 val_auroc:  0.802405498281787 val_auprc:  0.9101217671907857
EarlyStopping counter: 30 out of 50
epoch:  49
epoch:  50 val_f1:  0.766354189375772 val_auroc:  0.7982326951399117 val_auprc:  0.9061041322331136
EarlyStopping counter: 31 out of 50
epoch:  50
epoch:  51 val_f1:  0.7553956834532374 val_auroc:  0.7982326951399116 val_auprc:  0.9072511731205863
EarlyStopping counter: 32 out of 50
epoch:  51
epoch:  52 val_f1:  0.766354189375772 val_auroc:  0.797987236131566 val_auprc:  0.9072299464360174
EarlyStopping counter: 33 out of 50
epoch:  52
epoch:  53 val_f1:  0.7473302173830908 val_auroc:  0.7945508100147275 val_auprc:  0.9053322192646407
EarlyStopping counter: 34 out of 50
epoch:  53
epoch:  54 val_f1:  0.76000113614692 val_auroc:  0.7972508591065292 val_auprc:  0.9068211393766636
EarlyStopping counter: 35 out of 50
epoch:  54
epoch:  55 val_f1:  0.766354189375772 val_auroc:  0.7957781050564555 val_auprc:  0.9054168331482253
EarlyStopping counter: 36 out of 50
epoch:  55
epoch:  56 val_f1:  0.766354189375772 val_auroc:  0.7970054000981835 val_auprc:  0.906202219439165
EarlyStopping counter: 37 out of 50
epoch:  56
epoch:  57 val_f1:  0.76000113614692 val_auroc:  0.7960235640648011 val_auprc:  0.9050980504895749
EarlyStopping counter: 38 out of 50
epoch:  57
epoch:  58 val_f1:  0.766354189375772 val_auroc:  0.7947962690230732 val_auprc:  0.9036282477749857
EarlyStopping counter: 39 out of 50
epoch:  58
epoch:  59 val_f1:  0.766354189375772 val_auroc:  0.7960235640648012 val_auprc:  0.9044546577858996
EarlyStopping counter: 40 out of 50
epoch:  59
epoch:  60 val_f1:  0.7580594896895918 val_auroc:  0.7962690230731468 val_auprc:  0.9046346722755302
EarlyStopping counter: 41 out of 50
epoch:  60
epoch:  61 val_f1:  0.7283736963917239 val_auroc:  0.793078055964654 val_auprc:  0.9049531708858908
EarlyStopping counter: 42 out of 50
epoch:  61
epoch:  62 val_f1:  0.751751326211758 val_auroc:  0.7938144329896907 val_auprc:  0.902982777822856
EarlyStopping counter: 43 out of 50
epoch:  62
epoch:  63 val_f1:  0.7727225509205256 val_auroc:  0.7965144820814923 val_auprc:  0.9046289780999712
EarlyStopping counter: 44 out of 50
epoch:  63
epoch:  64 val_f1:  0.76000113614692 val_auroc:  0.794305351006382 val_auprc:  0.9037032463420257
EarlyStopping counter: 45 out of 50
epoch:  64
epoch:  65 val_f1:  0.751751326211758 val_auroc:  0.7952871870397643 val_auprc:  0.9039844242658268
EarlyStopping counter: 46 out of 50
epoch:  65
epoch:  66 val_f1:  0.7536606851900262 val_auroc:  0.7947962690230732 val_auprc:  0.9041856861633635
EarlyStopping counter: 47 out of 50
epoch:  66
epoch:  67 val_f1:  0.7536606851900262 val_auroc:  0.793078055964654 val_auprc:  0.9023111359175766
EarlyStopping counter: 48 out of 50
epoch:  67
epoch:  68 val_f1:  0.7580594896895918 val_auroc:  0.7955326460481099 val_auprc:  0.9021434961398402
EarlyStopping counter: 49 out of 50
epoch:  68
epoch:  69 val_f1:  0.7536606851900262 val_auroc:  0.7906234658811979 val_auprc:  0.9023366426474657
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  46.64424920082092
{'time_elapsed': [46.64424920082092], 'epoch': [68], 'fold': [1], 'f1_train': [0.9964023152258445], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7536606851900262], 'auroc_test': [0.7906234658811979], 'auprc_test': [0.9023366426474657]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 427]            512
│    └─BatchNorm1d: 2-2                  [64, 128, 427]            256
│    └─Tanh: 2-3                         [64, 128, 427]            --
│    └─MaxPool1d: 2-4                    [64, 128, 142]            --
│    └─Dropout: 2-5                      [64, 128, 142]            --
│    └─Flatten: 2-6                      [64, 18176]               --
│    └─Linear: 2-7                       [64, 1]                   18,177
==========================================================================================
Total params: 18,945
Trainable params: 18,945
Non-trainable params: 0
Total mult-adds (M): 15.17
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 55.97
Params size (MB): 0.08
Estimated Total Size (MB): 56.37
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.6676485027000492 val_auprc:  0.8381997371848049
epoch:  1
epoch:  2 val_f1:  0.6546762589928059 val_auroc:  0.6735395189003437 val_auprc:  0.8394244966774531
Validation loss improved to 1.071004
epoch:  2
epoch:  3 val_f1:  0.5266574619092604 val_auroc:  0.7022582228767795 val_auprc:  0.8594505894749546
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.7030912407309765 val_auroc:  0.7437407952871871 val_auprc:  0.8724549281801002
Validation loss improved to 1.055151
epoch:  4
epoch:  5 val_f1:  0.6328113979404711 val_auroc:  0.7454590083456063 val_auprc:  0.8655828042862768
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.7477455593342162 val_auroc:  0.7565046637211585 val_auprc:  0.8768422049050536
Validation loss improved to 1.031167
epoch:  6
epoch:  7 val_f1:  0.6385973188662184 val_auroc:  0.7604320078546883 val_auprc:  0.8791541797317509
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.7233618940391454 val_auroc:  0.7621502209131075 val_auprc:  0.8794916734715377
Validation loss improved to 1.021994
epoch:  8
epoch:  9 val_f1:  0.743914028278071 val_auroc:  0.7643593519882179 val_auprc:  0.879352073049744
Validation loss improved to 1.016328
epoch:  9
epoch:  10 val_f1:  0.7100860488080124 val_auroc:  0.7704958271968582 val_auprc:  0.8799893408933801
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.6823403921278894 val_auroc:  0.7665684830633284 val_auprc:  0.8759980764462865
EarlyStopping counter: 2 out of 50
epoch:  11
epoch:  12 val_f1:  0.7371937993371881 val_auroc:  0.7783505154639175 val_auprc:  0.8836208404299495
Validation loss improved to 1.014852
epoch:  12
epoch:  13 val_f1:  0.682026026688228 val_auroc:  0.7795778105056456 val_auprc:  0.8844169816860854
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7225455998837295 val_auroc:  0.7776141384388807 val_auprc:  0.879987636212854
EarlyStopping counter: 2 out of 50
epoch:  14
epoch:  15 val_f1:  0.7233618940391454 val_auroc:  0.7832596956308296 val_auprc:  0.8845571688131693
EarlyStopping counter: 3 out of 50
epoch:  15
epoch:  16 val_f1:  0.730071543320129 val_auroc:  0.7788414334806087 val_auprc:  0.8830963218935783
EarlyStopping counter: 4 out of 50
epoch:  16
epoch:  17 val_f1:  0.7583800901862243 val_auroc:  0.7803141875306824 val_auprc:  0.8835395131092662
EarlyStopping counter: 5 out of 50
epoch:  17
epoch:  18 val_f1:  0.696151679426677 val_auroc:  0.7793323514973 val_auprc:  0.882827984109444
EarlyStopping counter: 6 out of 50
epoch:  18
epoch:  19 val_f1:  0.730071543320129 val_auroc:  0.7798232695139912 val_auprc:  0.8825552338027036
EarlyStopping counter: 7 out of 50
epoch:  19
epoch:  20 val_f1:  0.7552115339652351 val_auroc:  0.7798232695139912 val_auprc:  0.8844576154758919
EarlyStopping counter: 8 out of 50
epoch:  20
epoch:  21 val_f1:  0.7466980132583976 val_auroc:  0.7768777614138439 val_auprc:  0.8830298224713877
EarlyStopping counter: 9 out of 50
epoch:  21
epoch:  22 val_f1:  0.7375047745919104 val_auroc:  0.7729504172803142 val_auprc:  0.87918416080577
EarlyStopping counter: 10 out of 50
epoch:  22
epoch:  23 val_f1:  0.7359858855314679 val_auroc:  0.7812960235640648 val_auprc:  0.8843901244279724
EarlyStopping counter: 11 out of 50
epoch:  23
epoch:  24 val_f1:  0.7304528631430115 val_auroc:  0.7707412862052037 val_auprc:  0.8797458649649679
EarlyStopping counter: 12 out of 50
epoch:  24
epoch:  25 val_f1:  0.72389147505525 val_auroc:  0.7771232204221895 val_auprc:  0.885383446835742
EarlyStopping counter: 13 out of 50
epoch:  25
epoch:  26 val_f1:  0.726967940210938 val_auroc:  0.7852233676975946 val_auprc:  0.8902540437915748
EarlyStopping counter: 14 out of 50
epoch:  26
epoch:  27 val_f1:  0.7428255465713769 val_auroc:  0.7729504172803141 val_auprc:  0.8824074095146641
EarlyStopping counter: 15 out of 50
epoch:  27
epoch:  28 val_f1:  0.726175885795287 val_auroc:  0.7697594501718213 val_auprc:  0.8775018772112417
EarlyStopping counter: 16 out of 50
epoch:  28
epoch:  29 val_f1:  0.7607703458551531 val_auroc:  0.781786941580756 val_auprc:  0.8861048027940036
EarlyStopping counter: 17 out of 50
epoch:  29
epoch:  30 val_f1:  0.7337314237416728 val_auroc:  0.7790868924889544 val_auprc:  0.8833467503218516
EarlyStopping counter: 18 out of 50
epoch:  30
epoch:  31 val_f1:  0.7326256806616418 val_auroc:  0.7756504663721159 val_auprc:  0.8823861948154927
EarlyStopping counter: 19 out of 50
epoch:  31
epoch:  32 val_f1:  0.7377691212466089 val_auroc:  0.7793323514973 val_auprc:  0.8847811281804213
EarlyStopping counter: 20 out of 50
epoch:  32
epoch:  33 val_f1:  0.7272357092755477 val_auroc:  0.7766323024054983 val_auprc:  0.8822837080324428
EarlyStopping counter: 21 out of 50
epoch:  33
epoch:  34 val_f1:  0.7326256806616418 val_auroc:  0.7776141384388807 val_auprc:  0.8837854358795997
EarlyStopping counter: 22 out of 50
epoch:  34
epoch:  35 val_f1:  0.722058496910722 val_auroc:  0.7825233186057928 val_auprc:  0.8861876642115017
EarlyStopping counter: 23 out of 50
epoch:  35
epoch:  36 val_f1:  0.7122302158273381 val_auroc:  0.7810505645557192 val_auprc:  0.8843178495672386
EarlyStopping counter: 24 out of 50
epoch:  36
epoch:  37 val_f1:  0.7235944791518311 val_auroc:  0.7785959744722631 val_auprc:  0.8827434015526492
EarlyStopping counter: 25 out of 50
epoch:  37
epoch:  38 val_f1:  0.7313689473952751 val_auroc:  0.7798232695139912 val_auprc:  0.8850698088316675
EarlyStopping counter: 26 out of 50
epoch:  38
epoch:  39 val_f1:  0.7266187050359713 val_auroc:  0.7783505154639175 val_auprc:  0.8830160735736627
EarlyStopping counter: 27 out of 50
epoch:  39
epoch:  40 val_f1:  0.7140775751491829 val_auroc:  0.780559646539028 val_auprc:  0.887021318845812
EarlyStopping counter: 28 out of 50
epoch:  40
epoch:  41 val_f1:  0.7203480251458693 val_auroc:  0.7692685321551301 val_auprc:  0.8766576672252342
EarlyStopping counter: 29 out of 50
epoch:  41
epoch:  42 val_f1:  0.726175885795287 val_auroc:  0.7741777123220422 val_auprc:  0.881120185168121
EarlyStopping counter: 30 out of 50
epoch:  42
epoch:  43 val_f1:  0.7328919440906961 val_auroc:  0.7776141384388807 val_auprc:  0.8829113466770724
EarlyStopping counter: 31 out of 50
epoch:  43
epoch:  44 val_f1:  0.7094198370570532 val_auroc:  0.7729504172803141 val_auprc:  0.8806039675624091
EarlyStopping counter: 32 out of 50
epoch:  44
epoch:  45 val_f1:  0.7140775751491829 val_auroc:  0.7776141384388807 val_auprc:  0.8842734309196194
EarlyStopping counter: 33 out of 50
epoch:  45
epoch:  46 val_f1:  0.7122302158273381 val_auroc:  0.7771232204221895 val_auprc:  0.883589917195762
EarlyStopping counter: 34 out of 50
epoch:  46
epoch:  47 val_f1:  0.6997814539066421 val_auroc:  0.7677957781050565 val_auprc:  0.8745265676056553
EarlyStopping counter: 35 out of 50
epoch:  47
epoch:  48 val_f1:  0.722058496910722 val_auroc:  0.7746686303387335 val_auprc:  0.879416987611813
EarlyStopping counter: 36 out of 50
epoch:  48
epoch:  49 val_f1:  0.743396428458658 val_auroc:  0.7746686303387335 val_auprc:  0.8794110304975143
EarlyStopping counter: 37 out of 50
epoch:  49
epoch:  50 val_f1:  0.7078050864958872 val_auroc:  0.7675503190967108 val_auprc:  0.8748966740449189
EarlyStopping counter: 38 out of 50
epoch:  50
epoch:  51 val_f1:  0.7246795893300292 val_auroc:  0.7707412862052037 val_auprc:  0.8779211115534764
EarlyStopping counter: 39 out of 50
epoch:  51
epoch:  52 val_f1:  0.7309103647707891 val_auroc:  0.7744231713303878 val_auprc:  0.8801631757277644
EarlyStopping counter: 40 out of 50
epoch:  52
epoch:  53 val_f1:  0.7235944791518311 val_auroc:  0.7697594501718213 val_auprc:  0.8768886717385784
EarlyStopping counter: 41 out of 50
epoch:  53
epoch:  54 val_f1:  0.7122302158273381 val_auroc:  0.7763868433971527 val_auprc:  0.8835598964832356
EarlyStopping counter: 42 out of 50
epoch:  54
epoch:  55 val_f1:  0.7349308245711123 val_auroc:  0.7719685812469318 val_auprc:  0.8768387664100714
EarlyStopping counter: 43 out of 50
epoch:  55
epoch:  56 val_f1:  0.7184536707983012 val_auroc:  0.7697594501718212 val_auprc:  0.8773732925589195
EarlyStopping counter: 44 out of 50
epoch:  56
epoch:  57 val_f1:  0.7184536707983012 val_auroc:  0.7741777123220422 val_auprc:  0.8819433249134834
EarlyStopping counter: 45 out of 50
epoch:  57
epoch:  58 val_f1:  0.7349308245711123 val_auroc:  0.7709867452135494 val_auprc:  0.876449614164776
EarlyStopping counter: 46 out of 50
epoch:  58
epoch:  59 val_f1:  0.743396428458658 val_auroc:  0.7739322533136966 val_auprc:  0.8804874678748755
EarlyStopping counter: 47 out of 50
epoch:  59
epoch:  60 val_f1:  0.7349308245711123 val_auroc:  0.770004909180167 val_auprc:  0.8771757592336171
EarlyStopping counter: 48 out of 50
epoch:  60
epoch:  61 val_f1:  0.717230470942395 val_auroc:  0.7687776141384389 val_auprc:  0.8765394165688669
EarlyStopping counter: 49 out of 50
epoch:  61
epoch:  62 val_f1:  0.7386752666832053 val_auroc:  0.772459499263623 val_auprc:  0.8789583172572039
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  42.19809341430664
{'time_elapsed': [42.19809341430664], 'epoch': [61], 'fold': [2], 'f1_train': [0.9928046304516892], 'auroc_train': [0.9998313762761749], 'auprc_train': [0.9999268344700424], 'f1_test': [0.7386752666832053], 'auroc_test': [0.772459499263623], 'auprc_test': [0.8789583172572039]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 427]            512
│    └─BatchNorm1d: 2-2                  [64, 128, 427]            256
│    └─Tanh: 2-3                         [64, 128, 427]            --
│    └─MaxPool1d: 2-4                    [64, 128, 142]            --
│    └─Dropout: 2-5                      [64, 128, 142]            --
│    └─Flatten: 2-6                      [64, 18176]               --
│    └─Linear: 2-7                       [64, 1]                   18,177
==========================================================================================
Total params: 18,945
Trainable params: 18,945
Non-trainable params: 0
Total mult-adds (M): 15.17
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 55.97
Params size (MB): 0.08
Estimated Total Size (MB): 56.37
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5642736874330323 val_auroc:  0.6741763565891473 val_auprc:  0.7795878439700662
epoch:  1
epoch:  2 val_f1:  0.48732669865356343 val_auroc:  0.7747093023255813 val_auprc:  0.8773427079865462
Validation loss improved to 1.087584
epoch:  2
epoch:  3 val_f1:  0.7688372056811462 val_auroc:  0.8008720930232559 val_auprc:  0.8988633995155115
Validation loss improved to 0.986700
epoch:  3
epoch:  4 val_f1:  0.767033173809688 val_auroc:  0.8117732558139534 val_auprc:  0.9110366815294846
Validation loss improved to 0.948545
epoch:  4
epoch:  5 val_f1:  0.7968569383258559 val_auroc:  0.8202519379844961 val_auprc:  0.9165918665465947
Validation loss improved to 0.918285
epoch:  5
epoch:  6 val_f1:  0.7773759601944114 val_auroc:  0.8248546511627908 val_auprc:  0.9208652180436816
Validation loss improved to 0.895060
epoch:  6
epoch:  7 val_f1:  0.7724509753899008 val_auroc:  0.8260658914728682 val_auprc:  0.9221674818522673
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.7507041863300117 val_auroc:  0.8294573643410852 val_auprc:  0.9241079441921405
Validation loss improved to 0.877178
epoch:  8
epoch:  9 val_f1:  0.7473725987207795 val_auroc:  0.8313953488372092 val_auprc:  0.9224027247476891
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7373330802754513 val_auroc:  0.8333333333333333 val_auprc:  0.9234960403716401
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.7783357627623393 val_auroc:  0.8340600775193799 val_auprc:  0.9261265070909159
Validation loss improved to 0.821396
epoch:  11
epoch:  12 val_f1:  0.7473725987207795 val_auroc:  0.8381782945736435 val_auprc:  0.9262006463704336
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7438351169426486 val_auroc:  0.840843023255814 val_auprc:  0.9289838738044777
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.7793492478744277 val_auroc:  0.8391472868217055 val_auprc:  0.9271146154360992
EarlyStopping counter: 3 out of 50
epoch:  14
epoch:  15 val_f1:  0.7840893588200424 val_auroc:  0.8364825581395349 val_auprc:  0.9271935594762422
Validation loss improved to 0.787616
epoch:  15
epoch:  16 val_f1:  0.7916865446634734 val_auroc:  0.835998062015504 val_auprc:  0.9281161517246841
Validation loss improved to 0.776912
epoch:  16
epoch:  17 val_f1:  0.7906801532257888 val_auroc:  0.842296511627907 val_auprc:  0.9304549682101919
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.7644817479349855 val_auroc:  0.8418120155038759 val_auprc:  0.9310876101916101
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7894843465886632 val_auroc:  0.8449612403100776 val_auprc:  0.9322580177179419
Validation loss improved to 0.765135
epoch:  19
epoch:  20 val_f1:  0.8114552542831148 val_auroc:  0.8456879844961241 val_auprc:  0.9335705552382806
Validation loss improved to 0.764130
epoch:  20
epoch:  21 val_f1:  0.7735780520043992 val_auroc:  0.8502906976744187 val_auprc:  0.9354280176210639
Validation loss improved to 0.763200
epoch:  21
epoch:  22 val_f1:  0.7875752415552048 val_auroc:  0.8505329457364341 val_auprc:  0.9348771412639498
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7754499696945739 val_auroc:  0.8500484496124031 val_auprc:  0.9366165886951237
Validation loss improved to 0.738258
epoch:  23
epoch:  24 val_f1:  0.7507614687470803 val_auroc:  0.8539244186046512 val_auprc:  0.9398554219719062
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7828470720035011 val_auroc:  0.8536821705426357 val_auprc:  0.9396804619512376
Validation loss improved to 0.728944
epoch:  25
epoch:  26 val_f1:  0.7972014141264308 val_auroc:  0.8548934108527131 val_auprc:  0.9386537437713995
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7984505932008901 val_auroc:  0.8575581395348838 val_auprc:  0.9412029910926409
Validation loss improved to 0.726946
epoch:  27
epoch:  28 val_f1:  0.792019787311512 val_auroc:  0.8582848837209303 val_auprc:  0.9403840067070187
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.7789671954250403 val_auroc:  0.8614341085271318 val_auprc:  0.9432747892254983
Validation loss improved to 0.718912
epoch:  29
epoch:  30 val_f1:  0.8008946034661633 val_auroc:  0.8640988372093024 val_auprc:  0.9446572229549496
Validation loss improved to 0.711186
epoch:  30
epoch:  31 val_f1:  0.7841726618705036 val_auroc:  0.8667635658914729 val_auprc:  0.9441345429009546
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.8041795135320315 val_auroc:  0.8640988372093024 val_auprc:  0.9446350481299661
Validation loss improved to 0.705286
epoch:  32
epoch:  33 val_f1:  0.7985611510791367 val_auroc:  0.8684593023255814 val_auprc:  0.9458586651611802
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.7985611510791367 val_auroc:  0.8699127906976746 val_auprc:  0.9465253668592712
EarlyStopping counter: 2 out of 50
epoch:  34
epoch:  35 val_f1:  0.8041795135320315 val_auroc:  0.8670058139534884 val_auprc:  0.9465779591227907
Validation loss improved to 0.687994
epoch:  35
epoch:  36 val_f1:  0.792019787311512 val_auroc:  0.8684593023255814 val_auprc:  0.9466227565071513
EarlyStopping counter: 1 out of 50
epoch:  36
epoch:  37 val_f1:  0.7985611510791367 val_auroc:  0.8733042635658915 val_auprc:  0.9482743000551156
EarlyStopping counter: 2 out of 50
epoch:  37
epoch:  38 val_f1:  0.8008946034661633 val_auroc:  0.875484496124031 val_auprc:  0.9493570450522866
Validation loss improved to 0.684012
epoch:  38
epoch:  39 val_f1:  0.792019787311512 val_auroc:  0.873546511627907 val_auprc:  0.9484722237350819
EarlyStopping counter: 1 out of 50
epoch:  39
epoch:  40 val_f1:  0.792019787311512 val_auroc:  0.8766957364341086 val_auprc:  0.9496648056656465
EarlyStopping counter: 2 out of 50
epoch:  40
epoch:  41 val_f1:  0.8063632502555458 val_auroc:  0.8781492248062016 val_auprc:  0.9501414133535445
EarlyStopping counter: 3 out of 50
epoch:  41
epoch:  42 val_f1:  0.7952715769842713 val_auroc:  0.876937984496124 val_auprc:  0.9508861756616342
Validation loss improved to 0.672979
epoch:  42
epoch:  43 val_f1:  0.7997900244397783 val_auroc:  0.8793604651162791 val_auprc:  0.950943890500858
EarlyStopping counter: 1 out of 50
epoch:  43
epoch:  44 val_f1:  0.8063632502555458 val_auroc:  0.8805717054263567 val_auprc:  0.9516240298458721
EarlyStopping counter: 2 out of 50
epoch:  44
epoch:  45 val_f1:  0.7985611510791367 val_auroc:  0.8796027131782944 val_auprc:  0.950680969003673
EarlyStopping counter: 3 out of 50
epoch:  45
epoch:  46 val_f1:  0.8084949329130455 val_auroc:  0.8808139534883721 val_auprc:  0.9516480695419598
Validation loss improved to 0.665171
epoch:  46
epoch:  47 val_f1:  0.8063632502555458 val_auroc:  0.881298449612403 val_auprc:  0.9517712961902703
EarlyStopping counter: 1 out of 50
epoch:  47
epoch:  48 val_f1:  0.7997900244397783 val_auroc:  0.8851744186046513 val_auprc:  0.9535986365620805
EarlyStopping counter: 2 out of 50
epoch:  48
epoch:  49 val_f1:  0.8084949329130455 val_auroc:  0.8851744186046512 val_auprc:  0.9534820154618217
EarlyStopping counter: 3 out of 50
epoch:  49
epoch:  50 val_f1:  0.8051160047274586 val_auroc:  0.8846899224806202 val_auprc:  0.9534447484557609
EarlyStopping counter: 4 out of 50
epoch:  50
epoch:  51 val_f1:  0.8063632502555458 val_auroc:  0.8875968992248062 val_auprc:  0.953977221841183
EarlyStopping counter: 5 out of 50
epoch:  51
epoch:  52 val_f1:  0.8235099801588546 val_auroc:  0.8856589147286822 val_auprc:  0.954163234420598
Validation loss improved to 0.660982
epoch:  52
epoch:  53 val_f1:  0.8129496402877698 val_auroc:  0.8878391472868217 val_auprc:  0.9543885407951516
EarlyStopping counter: 1 out of 50
epoch:  53
epoch:  54 val_f1:  0.8063632502555458 val_auroc:  0.8900193798449613 val_auprc:  0.9557029016549886
EarlyStopping counter: 2 out of 50
epoch:  54
epoch:  55 val_f1:  0.8008946034661633 val_auroc:  0.8902616279069767 val_auprc:  0.9556659570076625
EarlyStopping counter: 3 out of 50
epoch:  55
epoch:  56 val_f1:  0.7932273763653603 val_auroc:  0.8907461240310077 val_auprc:  0.9560601279186443
EarlyStopping counter: 4 out of 50
epoch:  56
epoch:  57 val_f1:  0.7997900244397783 val_auroc:  0.8924418604651163 val_auprc:  0.9566059350843794
EarlyStopping counter: 5 out of 50
epoch:  57
epoch:  58 val_f1:  0.8084949329130455 val_auroc:  0.8907461240310077 val_auprc:  0.9557131879474853
EarlyStopping counter: 6 out of 50
epoch:  58
epoch:  59 val_f1:  0.8008946034661633 val_auroc:  0.8917151162790697 val_auprc:  0.9563315108629598
EarlyStopping counter: 7 out of 50
epoch:  59
epoch:  60 val_f1:  0.7932273763653603 val_auroc:  0.8929263565891473 val_auprc:  0.9568314591415842
EarlyStopping counter: 8 out of 50
epoch:  60
epoch:  61 val_f1:  0.8008946034661633 val_auroc:  0.8924418604651162 val_auprc:  0.9563887362906894
EarlyStopping counter: 9 out of 50
epoch:  61
epoch:  62 val_f1:  0.8084949329130455 val_auroc:  0.8948643410852714 val_auprc:  0.9576591540469072
EarlyStopping counter: 10 out of 50
epoch:  62
epoch:  63 val_f1:  0.7932273763653603 val_auroc:  0.8946220930232558 val_auprc:  0.9572517549967857
EarlyStopping counter: 11 out of 50
epoch:  63
epoch:  64 val_f1:  0.7932273763653603 val_auroc:  0.8938953488372093 val_auprc:  0.9567208801324119
EarlyStopping counter: 12 out of 50
epoch:  64
epoch:  65 val_f1:  0.7997900244397783 val_auroc:  0.8912306201550387 val_auprc:  0.9562994060656229
EarlyStopping counter: 13 out of 50
epoch:  65
epoch:  66 val_f1:  0.8008946034661633 val_auroc:  0.8936531007751938 val_auprc:  0.9559366278589948
EarlyStopping counter: 14 out of 50
epoch:  66
epoch:  67 val_f1:  0.7906801532257888 val_auroc:  0.8977713178294573 val_auprc:  0.9586851778019666
EarlyStopping counter: 15 out of 50
epoch:  67
epoch:  68 val_f1:  0.8084949329130455 val_auroc:  0.8931686046511628 val_auprc:  0.9564023773125362
EarlyStopping counter: 16 out of 50
epoch:  68
epoch:  69 val_f1:  0.8182769817510218 val_auroc:  0.8975290697674418 val_auprc:  0.9579486269203007
EarlyStopping counter: 17 out of 50
epoch:  69
epoch:  70 val_f1:  0.8151164175042944 val_auroc:  0.8919573643410852 val_auprc:  0.9561349549169758
EarlyStopping counter: 18 out of 50
epoch:  70
epoch:  71 val_f1:  0.7997900244397783 val_auroc:  0.8951065891472868 val_auprc:  0.9571353412153096
EarlyStopping counter: 19 out of 50
epoch:  71
epoch:  72 val_f1:  0.7997900244397783 val_auroc:  0.8914728682170542 val_auprc:  0.9561566885163347
EarlyStopping counter: 20 out of 50
epoch:  72
epoch:  73 val_f1:  0.8151164175042944 val_auroc:  0.8934108527131783 val_auprc:  0.9564751966649004
EarlyStopping counter: 21 out of 50
epoch:  73
epoch:  74 val_f1:  0.8063632502555458 val_auroc:  0.8972868217054264 val_auprc:  0.9580549495395297
EarlyStopping counter: 22 out of 50
epoch:  74
epoch:  75 val_f1:  0.8151164175042944 val_auroc:  0.8924418604651163 val_auprc:  0.9562120547861679
EarlyStopping counter: 23 out of 50
epoch:  75
epoch:  76 val_f1:  0.8074875573056803 val_auroc:  0.8946220930232558 val_auprc:  0.9569510306569873
EarlyStopping counter: 24 out of 50
epoch:  76
epoch:  77 val_f1:  0.8074875573056803 val_auroc:  0.8924418604651163 val_auprc:  0.9563572528371744
EarlyStopping counter: 25 out of 50
epoch:  77
epoch:  78 val_f1:  0.8074875573056803 val_auroc:  0.8972868217054264 val_auprc:  0.9580497265783342
EarlyStopping counter: 26 out of 50
epoch:  78
epoch:  79 val_f1:  0.8151164175042944 val_auroc:  0.8968023255813954 val_auprc:  0.9581789083687731
EarlyStopping counter: 27 out of 50
epoch:  79
epoch:  80 val_f1:  0.8074875573056803 val_auroc:  0.8936531007751938 val_auprc:  0.956497592681395
EarlyStopping counter: 28 out of 50
epoch:  80
epoch:  81 val_f1:  0.7997900244397783 val_auroc:  0.8972868217054262 val_auprc:  0.9582821832375541
EarlyStopping counter: 29 out of 50
epoch:  81
epoch:  82 val_f1:  0.8151164175042944 val_auroc:  0.8958333333333333 val_auprc:  0.957545696690415
EarlyStopping counter: 30 out of 50
epoch:  82
epoch:  83 val_f1:  0.8261726406797978 val_auroc:  0.8989825581395348 val_auprc:  0.9586870121105129
EarlyStopping counter: 31 out of 50
epoch:  83
epoch:  84 val_f1:  0.8151164175042944 val_auroc:  0.8968023255813953 val_auprc:  0.9580806598447208
EarlyStopping counter: 32 out of 50
epoch:  84
epoch:  85 val_f1:  0.8261726406797978 val_auroc:  0.8992248062015503 val_auprc:  0.9586288464785497
EarlyStopping counter: 33 out of 50
epoch:  85
epoch:  86 val_f1:  0.8151164175042944 val_auroc:  0.8960755813953489 val_auprc:  0.957491209179403
EarlyStopping counter: 34 out of 50
epoch:  86
epoch:  87 val_f1:  0.8022252248962252 val_auroc:  0.8992248062015503 val_auprc:  0.958865514922175
EarlyStopping counter: 35 out of 50
epoch:  87
epoch:  88 val_f1:  0.8151164175042944 val_auroc:  0.8953488372093024 val_auprc:  0.9573813484095992
EarlyStopping counter: 36 out of 50
epoch:  88
epoch:  89 val_f1:  0.8129496402877698 val_auroc:  0.8987403100775193 val_auprc:  0.9587108214363922
EarlyStopping counter: 37 out of 50
epoch:  89
epoch:  90 val_f1:  0.8074875573056803 val_auroc:  0.8987403100775194 val_auprc:  0.9587062157408772
EarlyStopping counter: 38 out of 50
epoch:  90
epoch:  91 val_f1:  0.8063632502555458 val_auroc:  0.8989825581395349 val_auprc:  0.9586141288453573
EarlyStopping counter: 39 out of 50
epoch:  91
epoch:  92 val_f1:  0.8140907369797942 val_auroc:  0.8984980620155039 val_auprc:  0.9584319063562539
EarlyStopping counter: 40 out of 50
epoch:  92
epoch:  93 val_f1:  0.8074875573056803 val_auroc:  0.8977713178294573 val_auprc:  0.9588562866306909
EarlyStopping counter: 41 out of 50
epoch:  93
epoch:  94 val_f1:  0.8195518562291283 val_auroc:  0.8992248062015504 val_auprc:  0.9588352422266753
EarlyStopping counter: 42 out of 50
epoch:  94
epoch:  95 val_f1:  0.7997900244397783 val_auroc:  0.8972868217054263 val_auprc:  0.957772811496935
EarlyStopping counter: 43 out of 50
epoch:  95
epoch:  96 val_f1:  0.8074875573056803 val_auroc:  0.8977713178294574 val_auprc:  0.9586691899217794
EarlyStopping counter: 44 out of 50
epoch:  96
epoch:  97 val_f1:  0.8129496402877698 val_auroc:  0.897044573643411 val_auprc:  0.9576196354791823
EarlyStopping counter: 45 out of 50
epoch:  97
epoch:  98 val_f1:  0.8074875573056803 val_auroc:  0.8982558139534883 val_auprc:  0.9586757575354415
EarlyStopping counter: 46 out of 50
epoch:  98
epoch:  99 val_f1:  0.8195518562291283 val_auroc:  0.899467054263566 val_auprc:  0.9588143546534417
EarlyStopping counter: 47 out of 50
epoch:  99
epoch:  100 val_f1:  0.8074875573056803 val_auroc:  0.8972868217054264 val_auprc:  0.958233642513295
EarlyStopping counter: 48 out of 50
epoch:  100
epoch:  101 val_f1:  0.8195518562291283 val_auroc:  0.898013565891473 val_auprc:  0.9580740301767303
EarlyStopping counter: 49 out of 50
epoch:  101
epoch:  102 val_f1:  0.8074875573056803 val_auroc:  0.8968023255813954 val_auprc:  0.9581068930189082
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  68.36505675315857
{'time_elapsed': [68.36505675315857], 'epoch': [101], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8074875573056803], 'auroc_test': [0.8968023255813954], 'auprc_test': [0.9581068930189082]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 427]            512
│    └─BatchNorm1d: 2-2                  [64, 128, 427]            256
│    └─Tanh: 2-3                         [64, 128, 427]            --
│    └─MaxPool1d: 2-4                    [64, 128, 142]            --
│    └─Dropout: 2-5                      [64, 128, 142]            --
│    └─Flatten: 2-6                      [64, 18176]               --
│    └─Linear: 2-7                       [64, 1]                   18,177
==========================================================================================
Total params: 18,945
Trainable params: 18,945
Non-trainable params: 0
Total mult-adds (M): 15.17
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 55.97
Params size (MB): 0.08
Estimated Total Size (MB): 56.37
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5149020174298233 val_auroc:  0.7757936507936508 val_auprc:  0.894787284617573
epoch:  1
epoch:  2 val_f1:  0.7279381803009489 val_auroc:  0.7916666666666667 val_auprc:  0.8997446791245897
Validation loss improved to 1.041473
epoch:  2
epoch:  3 val_f1:  0.7554024967714164 val_auroc:  0.8311011904761905 val_auprc:  0.9129923033606322
Validation loss improved to 1.004059
epoch:  3
epoch:  4 val_f1:  0.7495309300442878 val_auroc:  0.8464781746031745 val_auprc:  0.9157265273255669
Validation loss improved to 0.979246
epoch:  4
epoch:  5 val_f1:  0.7858717303302986 val_auroc:  0.8521825396825397 val_auprc:  0.9175271719067205
Validation loss improved to 0.971953
epoch:  5
epoch:  6 val_f1:  0.7852367336641158 val_auroc:  0.8563988095238095 val_auprc:  0.9221244517627502
Validation loss improved to 0.927724
epoch:  6
epoch:  7 val_f1:  0.6765704584040747 val_auroc:  0.8618551587301587 val_auprc:  0.9259849139334141
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.7771751194325146 val_auroc:  0.8680555555555556 val_auprc:  0.9280783088433805
Validation loss improved to 0.866035
epoch:  8
epoch:  9 val_f1:  0.8100998424466828 val_auroc:  0.8668154761904762 val_auprc:  0.9264502581597955
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.735373054213634 val_auroc:  0.8705357142857144 val_auprc:  0.9300157537089611
Validation loss improved to 0.859555
epoch:  10
epoch:  11 val_f1:  0.791810443984357 val_auroc:  0.8690476190476191 val_auprc:  0.9299638214444976
Validation loss improved to 0.829414
epoch:  11
epoch:  12 val_f1:  0.7873345935727789 val_auroc:  0.8715277777777778 val_auprc:  0.9333891666747365
Validation loss improved to 0.803201
epoch:  12
epoch:  13 val_f1:  0.7983928476398275 val_auroc:  0.8712797619047619 val_auprc:  0.9322923428911774
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7929485957015485 val_auroc:  0.8727678571428571 val_auprc:  0.9335284406802771
Validation loss improved to 0.796521
epoch:  14
epoch:  15 val_f1:  0.8015122873345937 val_auroc:  0.8777281746031745 val_auprc:  0.936400615308702
Validation loss improved to 0.780558
epoch:  15
epoch:  16 val_f1:  0.8061683443992288 val_auroc:  0.8747519841269841 val_auprc:  0.9359903227293518
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7629890332114801 val_auroc:  0.880704365079365 val_auprc:  0.9386909480009438
Validation loss improved to 0.763652
epoch:  17
epoch:  18 val_f1:  0.795635738397158 val_auroc:  0.8774801587301587 val_auprc:  0.937443240837885
Validation loss improved to 0.763427
epoch:  18
epoch:  19 val_f1:  0.8235137533274179 val_auroc:  0.8745039682539683 val_auprc:  0.9355850742691301
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7494824016563146 val_auroc:  0.8772321428571428 val_auprc:  0.937973080836092
EarlyStopping counter: 2 out of 50
epoch:  20
epoch:  21 val_f1:  0.7948558771909655 val_auroc:  0.8792162698412699 val_auprc:  0.9376892094208163
Validation loss improved to 0.758071
epoch:  21
epoch:  22 val_f1:  0.8248625247346153 val_auroc:  0.8797123015873015 val_auprc:  0.9388171620960383
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.807228002894545 val_auroc:  0.8772321428571429 val_auprc:  0.9377736947211787
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.7755600530392909 val_auroc:  0.8767361111111112 val_auprc:  0.9382769329222282
Validation loss improved to 0.751832
epoch:  24
epoch:  25 val_f1:  0.8014350667803353 val_auroc:  0.8727678571428571 val_auprc:  0.9352763144147318
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.79396185483142 val_auroc:  0.876984126984127 val_auprc:  0.9376786437021671
EarlyStopping counter: 2 out of 50
epoch:  26
epoch:  27 val_f1:  0.7929485957015485 val_auroc:  0.8782242063492064 val_auprc:  0.9382469973680279
EarlyStopping counter: 3 out of 50
epoch:  27
epoch:  28 val_f1:  0.8327610961982647 val_auroc:  0.8769841269841271 val_auprc:  0.9381924166979094
EarlyStopping counter: 4 out of 50
epoch:  28
epoch:  29 val_f1:  0.7905459035188288 val_auroc:  0.8804563492063491 val_auprc:  0.9411428246587412
Validation loss improved to 0.749171
epoch:  29
epoch:  30 val_f1:  0.8005921770297647 val_auroc:  0.8797123015873015 val_auprc:  0.9397328931193428
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.792371879328401 val_auroc:  0.8737599206349207 val_auprc:  0.9376041269212999
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.7988956640912072 val_auroc:  0.8692956349206349 val_auprc:  0.9342710227687172
EarlyStopping counter: 3 out of 50
epoch:  32
epoch:  33 val_f1:  0.7995542847531747 val_auroc:  0.8774801587301587 val_auprc:  0.9378470486865729
EarlyStopping counter: 4 out of 50
epoch:  33
epoch:  34 val_f1:  0.8049865427618805 val_auroc:  0.8742559523809524 val_auprc:  0.9389042890910309
EarlyStopping counter: 5 out of 50
epoch:  34
epoch:  35 val_f1:  0.8120268224096906 val_auroc:  0.8737599206349206 val_auprc:  0.9366003566695857
EarlyStopping counter: 6 out of 50
epoch:  35
epoch:  36 val_f1:  0.807228002894545 val_auroc:  0.8804563492063492 val_auprc:  0.9412607144679928
EarlyStopping counter: 7 out of 50
epoch:  36
epoch:  37 val_f1:  0.8036760694501368 val_auroc:  0.8747519841269842 val_auprc:  0.9387158102034766
EarlyStopping counter: 8 out of 50
epoch:  37
epoch:  38 val_f1:  0.8022296544035674 val_auroc:  0.8737599206349207 val_auprc:  0.9376589141931924
EarlyStopping counter: 9 out of 50
epoch:  38
epoch:  39 val_f1:  0.8036760694501368 val_auroc:  0.875 val_auprc:  0.9389702964236827
EarlyStopping counter: 10 out of 50
epoch:  39
epoch:  40 val_f1:  0.7956729455237178 val_auroc:  0.8774801587301587 val_auprc:  0.9394083063842592
EarlyStopping counter: 11 out of 50
epoch:  40
epoch:  41 val_f1:  0.8072024593763724 val_auroc:  0.8754960317460317 val_auprc:  0.9385592798649688
EarlyStopping counter: 12 out of 50
epoch:  41
epoch:  42 val_f1:  0.7956729455237178 val_auroc:  0.8762400793650794 val_auprc:  0.9388023464972273
EarlyStopping counter: 13 out of 50
epoch:  42
epoch:  43 val_f1:  0.8036760694501368 val_auroc:  0.8784722222222222 val_auprc:  0.9401928985120256
EarlyStopping counter: 14 out of 50
epoch:  43
epoch:  44 val_f1:  0.8154066640778435 val_auroc:  0.8747519841269842 val_auprc:  0.937827520596471
EarlyStopping counter: 15 out of 50
epoch:  44
epoch:  45 val_f1:  0.8154066640778435 val_auroc:  0.8794642857142857 val_auprc:  0.9400006893425985
EarlyStopping counter: 16 out of 50
epoch:  45
epoch:  46 val_f1:  0.8036760694501368 val_auroc:  0.878968253968254 val_auprc:  0.9399433265725148
EarlyStopping counter: 17 out of 50
epoch:  46
epoch:  47 val_f1:  0.8022296544035674 val_auroc:  0.8779761904761905 val_auprc:  0.9392544533158652
EarlyStopping counter: 18 out of 50
epoch:  47
epoch:  48 val_f1:  0.8138718358422335 val_auroc:  0.8797123015873016 val_auprc:  0.9404600164797043
EarlyStopping counter: 19 out of 50
epoch:  48
epoch:  49 val_f1:  0.8220330394243437 val_auroc:  0.8774801587301587 val_auprc:  0.9391238149642848
EarlyStopping counter: 20 out of 50
epoch:  49
epoch:  50 val_f1:  0.8036760694501368 val_auroc:  0.8794642857142857 val_auprc:  0.9399106403325155
EarlyStopping counter: 21 out of 50
epoch:  50
epoch:  51 val_f1:  0.8049865427618805 val_auroc:  0.87921626984127 val_auprc:  0.9401124970507022
EarlyStopping counter: 22 out of 50
epoch:  51
epoch:  52 val_f1:  0.8286888990406578 val_auroc:  0.8792162698412699 val_auprc:  0.9397384969683384
EarlyStopping counter: 23 out of 50
epoch:  52
epoch:  53 val_f1:  0.820411899313501 val_auroc:  0.8789682539682541 val_auprc:  0.9399202614340914
EarlyStopping counter: 24 out of 50
epoch:  53
epoch:  54 val_f1:  0.8138718358422335 val_auroc:  0.8851686507936509 val_auprc:  0.9434146082245237
EarlyStopping counter: 25 out of 50
epoch:  54
epoch:  55 val_f1:  0.7891335560760728 val_auroc:  0.8797123015873016 val_auprc:  0.9401259978634455
EarlyStopping counter: 26 out of 50
epoch:  55
epoch:  56 val_f1:  0.8154066640778435 val_auroc:  0.8799603174603174 val_auprc:  0.9400933549050525
EarlyStopping counter: 27 out of 50
epoch:  56
epoch:  57 val_f1:  0.7971014492753623 val_auroc:  0.8834325396825398 val_auprc:  0.9419678944127513
EarlyStopping counter: 28 out of 50
epoch:  57
epoch:  58 val_f1:  0.7956729455237178 val_auroc:  0.8804563492063493 val_auprc:  0.9403779722467054
EarlyStopping counter: 29 out of 50
epoch:  58
epoch:  59 val_f1:  0.8154066640778435 val_auroc:  0.8812003968253969 val_auprc:  0.9404891139546642
EarlyStopping counter: 30 out of 50
epoch:  59
epoch:  60 val_f1:  0.8022296544035674 val_auroc:  0.8792162698412699 val_auprc:  0.9397482036745055
EarlyStopping counter: 31 out of 50
epoch:  60
epoch:  61 val_f1:  0.8022296544035674 val_auroc:  0.8826884920634921 val_auprc:  0.9408206004173095
EarlyStopping counter: 32 out of 50
epoch:  61
epoch:  62 val_f1:  0.8154066640778435 val_auroc:  0.8821924603174603 val_auprc:  0.941652555948774
EarlyStopping counter: 33 out of 50
epoch:  62
epoch:  63 val_f1:  0.7983928476398275 val_auroc:  0.8826884920634921 val_auprc:  0.9414001744215215
EarlyStopping counter: 34 out of 50
epoch:  63
epoch:  64 val_f1:  0.8022296544035674 val_auroc:  0.8844246031746031 val_auprc:  0.9416943572387648
EarlyStopping counter: 35 out of 50
epoch:  64
epoch:  65 val_f1:  0.820411899313501 val_auroc:  0.881200396825397 val_auprc:  0.9410725984053843
EarlyStopping counter: 36 out of 50
epoch:  65
epoch:  66 val_f1:  0.8088065661047027 val_auroc:  0.8826884920634922 val_auprc:  0.9408073172226756
EarlyStopping counter: 37 out of 50
epoch:  66
epoch:  67 val_f1:  0.7971014492753623 val_auroc:  0.8816964285714286 val_auprc:  0.9408019794668212
EarlyStopping counter: 38 out of 50
epoch:  67
epoch:  68 val_f1:  0.8102677351291666 val_auroc:  0.8859126984126985 val_auprc:  0.9437675313230169
EarlyStopping counter: 39 out of 50
epoch:  68
epoch:  69 val_f1:  0.8102677351291666 val_auroc:  0.8849206349206349 val_auprc:  0.9422720105759699
EarlyStopping counter: 40 out of 50
epoch:  69
epoch:  70 val_f1:  0.8072024593763724 val_auroc:  0.8797123015873015 val_auprc:  0.9395479644075675
EarlyStopping counter: 41 out of 50
epoch:  70
epoch:  71 val_f1:  0.8102677351291666 val_auroc:  0.8841765873015873 val_auprc:  0.9419252567945757
EarlyStopping counter: 42 out of 50
epoch:  71
epoch:  72 val_f1:  0.8102677351291666 val_auroc:  0.8856646825396826 val_auprc:  0.9426578222590097
EarlyStopping counter: 43 out of 50
epoch:  72
epoch:  73 val_f1:  0.8035275913020209 val_auroc:  0.8804563492063492 val_auprc:  0.9397764127323718
EarlyStopping counter: 44 out of 50
epoch:  73
epoch:  74 val_f1:  0.7983928476398275 val_auroc:  0.886904761904762 val_auprc:  0.9429581556961097
EarlyStopping counter: 45 out of 50
epoch:  74
epoch:  75 val_f1:  0.8035275913020209 val_auroc:  0.8804563492063492 val_auprc:  0.9401831557716018
EarlyStopping counter: 46 out of 50
epoch:  75
epoch:  76 val_f1:  0.800639197204071 val_auroc:  0.8831845238095238 val_auprc:  0.9417268436605823
EarlyStopping counter: 47 out of 50
epoch:  76
epoch:  77 val_f1:  0.8102677351291666 val_auroc:  0.8854166666666666 val_auprc:  0.9427230648463332
EarlyStopping counter: 48 out of 50
epoch:  77
epoch:  78 val_f1:  0.8072024593763724 val_auroc:  0.8816964285714285 val_auprc:  0.9407629809663516
EarlyStopping counter: 49 out of 50
epoch:  78
epoch:  79 val_f1:  0.8168793096329329 val_auroc:  0.884920634920635 val_auprc:  0.9423498557545272
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  52.84240770339966
{'time_elapsed': [52.84240770339966], 'epoch': [78], 'fold': [4], 'f1_train': [0.9982029282297181], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8168793096329329], 'auroc_test': [0.884920634920635], 'auprc_test': [0.9423498557545272]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 427]            512
│    └─BatchNorm1d: 2-2                  [64, 128, 427]            256
│    └─Tanh: 2-3                         [64, 128, 427]            --
│    └─MaxPool1d: 2-4                    [64, 128, 142]            --
│    └─Dropout: 2-5                      [64, 128, 142]            --
│    └─Flatten: 2-6                      [64, 18176]               --
│    └─Linear: 2-7                       [64, 1]                   18,177
==========================================================================================
Total params: 18,945
Trainable params: 18,945
Non-trainable params: 0
Total mult-adds (M): 15.17
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 55.97
Params size (MB): 0.08
Estimated Total Size (MB): 56.37
==========================================================================================
