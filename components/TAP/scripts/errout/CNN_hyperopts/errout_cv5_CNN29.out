config:  {'project': 'MHCCBM', 'name': 'CNN_29', 'config': {'hidden_channels': [512], 'epochs': 500, 'kernel_size': 3, 'pool_kernel_size': 3, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5846695524935984 val_auroc:  0.6926853215513009 val_auprc:  0.801782700553467
epoch:  1
epoch:  2 val_f1:  0.460431654676259 val_auroc:  0.5316642120765832 val_auprc:  0.7305307772278056
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.5071160421770495 val_auroc:  0.5229504172803141 val_auprc:  0.7368178195106804
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6193595254779743 val_auroc:  0.5308051055473736 val_auprc:  0.8042850985116201
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6072007259057618 val_auroc:  0.5390279823269514 val_auprc:  0.8006110930843642
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6454667605708284 val_auroc:  0.5753559155621012 val_auprc:  0.7703513263925917
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.6751388509211166 val_auroc:  0.6460481099656358 val_auprc:  0.8094280905498281
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.6189552242778474 val_auroc:  0.7079037800687286 val_auprc:  0.8618421104010328
Validation loss improved to 1.880158
epoch:  8
epoch:  9 val_f1:  0.6812079455400337 val_auroc:  0.7469317623956799 val_auprc:  0.8880681697073664
Validation loss improved to 1.779623
epoch:  9
epoch:  10 val_f1:  0.6904086828713746 val_auroc:  0.7488954344624448 val_auprc:  0.8853252555794342
Validation loss improved to 1.579837
epoch:  10
epoch:  11 val_f1:  0.6894622188638474 val_auroc:  0.7498772704958272 val_auprc:  0.8826050226620554
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.6198701745464336 val_auroc:  0.7555228276877761 val_auprc:  0.8834979086438635
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.6636982464578685 val_auroc:  0.751840942562592 val_auprc:  0.880361791947291
EarlyStopping counter: 3 out of 50
epoch:  13
epoch:  14 val_f1:  0.6810705528674974 val_auroc:  0.7717231222385861 val_auprc:  0.8978651229125112
Validation loss improved to 1.317073
epoch:  14
epoch:  15 val_f1:  0.6353297362110312 val_auroc:  0.7704958271968582 val_auprc:  0.8941961159119716
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7169642564307364 val_auroc:  0.7707412862052038 val_auprc:  0.8894449062103468
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.6353297362110312 val_auroc:  0.7785959744722631 val_auprc:  0.8990685914235927
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.7096759374109908 val_auroc:  0.7749140893470791 val_auprc:  0.8955580844764759
Validation loss improved to 1.290962
epoch:  18
epoch:  19 val_f1:  0.5440877923534755 val_auroc:  0.7790868924889544 val_auprc:  0.8969074877345828
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.5053701858578568 val_auroc:  0.7857142857142857 val_auprc:  0.8973828163348612
EarlyStopping counter: 2 out of 50
epoch:  20
epoch:  21 val_f1:  0.6636982464578685 val_auroc:  0.7891507118311241 val_auprc:  0.8963398430445999
EarlyStopping counter: 3 out of 50
epoch:  21
epoch:  22 val_f1:  0.7286063672426545 val_auroc:  0.8032646048109966 val_auprc:  0.9032082255229422
EarlyStopping counter: 4 out of 50
epoch:  22
epoch:  23 val_f1:  0.6120424115607032 val_auroc:  0.8068237604320078 val_auprc:  0.9083150559685629
EarlyStopping counter: 5 out of 50
epoch:  23
epoch:  24 val_f1:  0.5557862334840752 val_auroc:  0.8009327442317132 val_auprc:  0.905533523730329
EarlyStopping counter: 6 out of 50
epoch:  24
epoch:  25 val_f1:  0.6310465491302215 val_auroc:  0.7919734904270986 val_auprc:  0.9024910821840524
EarlyStopping counter: 7 out of 50
epoch:  25
epoch:  26 val_f1:  0.7101700457815566 val_auroc:  0.799214531173294 val_auprc:  0.9066309748045589
EarlyStopping counter: 8 out of 50
epoch:  26
epoch:  27 val_f1:  0.7346924658075737 val_auroc:  0.8171330387825234 val_auprc:  0.9233284240004181
Validation loss improved to 1.093954
epoch:  27
epoch:  28 val_f1:  0.7617684906754855 val_auroc:  0.8085419734904271 val_auprc:  0.9154649822497476
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.6737247039763566 val_auroc:  0.8033873343151694 val_auprc:  0.9103565383824339
EarlyStopping counter: 2 out of 50
epoch:  29
epoch:  30 val_f1:  0.7441671543148256 val_auroc:  0.8053510063819341 val_auprc:  0.914710816469971
EarlyStopping counter: 3 out of 50
epoch:  30
epoch:  31 val_f1:  0.7580594896895918 val_auroc:  0.8016691212567502 val_auprc:  0.9110588765048566
EarlyStopping counter: 4 out of 50
epoch:  31
epoch:  32 val_f1:  0.6598406488264144 val_auroc:  0.803632793323515 val_auprc:  0.9128586989225127
EarlyStopping counter: 5 out of 50
epoch:  32
epoch:  33 val_f1:  0.694872962389582 val_auroc:  0.8068237604320078 val_auprc:  0.9160240394603898
EarlyStopping counter: 6 out of 50
epoch:  33
epoch:  34 val_f1:  0.7683026725960121 val_auroc:  0.7977417771232204 val_auprc:  0.9058628474500884
EarlyStopping counter: 7 out of 50
epoch:  34
epoch:  35 val_f1:  0.7826417810500232 val_auroc:  0.8014236622484046 val_auprc:  0.90529078916453
EarlyStopping counter: 8 out of 50
epoch:  35
epoch:  36 val_f1:  0.7029258641632973 val_auroc:  0.8092783505154639 val_auprc:  0.9126880822706784
EarlyStopping counter: 9 out of 50
epoch:  36
epoch:  37 val_f1:  0.7513203127712835 val_auroc:  0.8119783996072656 val_auprc:  0.9148517297955167
EarlyStopping counter: 10 out of 50
epoch:  37
epoch:  38 val_f1:  0.7626195746699344 val_auroc:  0.8095238095238095 val_auprc:  0.91121814155116
EarlyStopping counter: 11 out of 50
epoch:  38
epoch:  39 val_f1:  0.7661184054361647 val_auroc:  0.7992145311732941 val_auprc:  0.9038243142561382
EarlyStopping counter: 12 out of 50
epoch:  39
epoch:  40 val_f1:  0.6584354138310973 val_auroc:  0.8058419243986255 val_auprc:  0.9135619108819283
EarlyStopping counter: 13 out of 50
epoch:  40
epoch:  41 val_f1:  0.7505653177403916 val_auroc:  0.8112420225822288 val_auprc:  0.915062557341212
EarlyStopping counter: 14 out of 50
epoch:  41
epoch:  42 val_f1:  0.743914028278071 val_auroc:  0.8021600392734414 val_auprc:  0.9055668530804475
EarlyStopping counter: 15 out of 50
epoch:  42
epoch:  43 val_f1:  0.7445203699313053 val_auroc:  0.8058419243986255 val_auprc:  0.9095684233203541
EarlyStopping counter: 16 out of 50
epoch:  43
epoch:  44 val_f1:  0.7648187281552264 val_auroc:  0.8075601374570447 val_auprc:  0.9131031224104518
Validation loss improved to 1.029899
epoch:  44
epoch:  45 val_f1:  0.7580594896895918 val_auroc:  0.8112420225822288 val_auprc:  0.9137455141420109
EarlyStopping counter: 1 out of 50
epoch:  45
epoch:  46 val_f1:  0.7809570525397864 val_auroc:  0.8132056946489936 val_auprc:  0.9133056371219892
EarlyStopping counter: 2 out of 50
epoch:  46
epoch:  47 val_f1:  0.7725930260576229 val_auroc:  0.8122238586156112 val_auprc:  0.9128188410127347
EarlyStopping counter: 3 out of 50
epoch:  47
epoch:  48 val_f1:  0.7826417810500232 val_auroc:  0.8149239077074129 val_auprc:  0.9133298285335775
EarlyStopping counter: 4 out of 50
epoch:  48
epoch:  49 val_f1:  0.7298678635622811 val_auroc:  0.8173784977908689 val_auprc:  0.9189683899552885
EarlyStopping counter: 5 out of 50
epoch:  49
epoch:  50 val_f1:  0.7622262794246104 val_auroc:  0.8097692685321551 val_auprc:  0.9102182475666631
EarlyStopping counter: 6 out of 50
epoch:  50
epoch:  51 val_f1:  0.7024482739389885 val_auroc:  0.8168875797741777 val_auprc:  0.9152666035770738
EarlyStopping counter: 7 out of 50
epoch:  51
epoch:  52 val_f1:  0.7308672563486676 val_auroc:  0.8146784486990672 val_auprc:  0.912640736822956
EarlyStopping counter: 8 out of 50
epoch:  52
epoch:  53 val_f1:  0.7515743249556199 val_auroc:  0.8237604320078546 val_auprc:  0.9207518457830532
EarlyStopping counter: 9 out of 50
epoch:  53
epoch:  54 val_f1:  0.7473654218886486 val_auroc:  0.8195876288659794 val_auprc:  0.9199189115479576
EarlyStopping counter: 10 out of 50
epoch:  54
epoch:  55 val_f1:  0.7757738305193033 val_auroc:  0.8144329896907216 val_auprc:  0.9140400299646172
EarlyStopping counter: 11 out of 50
epoch:  55
epoch:  56 val_f1:  0.7672775806504117 val_auroc:  0.8146784486990671 val_auprc:  0.9156343566110277
EarlyStopping counter: 12 out of 50
epoch:  56
epoch:  57 val_f1:  0.7298678635622811 val_auroc:  0.818605792832597 val_auprc:  0.9176624289320432
EarlyStopping counter: 13 out of 50
epoch:  57
epoch:  58 val_f1:  0.7748426784519089 val_auroc:  0.8132056946489936 val_auprc:  0.9125165360502063
EarlyStopping counter: 14 out of 50
epoch:  58
epoch:  59 val_f1:  0.777854660092151 val_auroc:  0.8173784977908689 val_auprc:  0.9146571295824754
EarlyStopping counter: 15 out of 50
epoch:  59
epoch:  60 val_f1:  0.7583300796647482 val_auroc:  0.8183603338242513 val_auprc:  0.9147310973897789
EarlyStopping counter: 16 out of 50
epoch:  60
epoch:  61 val_f1:  0.7096759374109908 val_auroc:  0.82793323514973 val_auprc:  0.9229739227612559
EarlyStopping counter: 17 out of 50
epoch:  61
epoch:  62 val_f1:  0.7536081085870222 val_auroc:  0.8252331860579283 val_auprc:  0.9197815518927397
EarlyStopping counter: 18 out of 50
epoch:  62
epoch:  63 val_f1:  0.7855581813618873 val_auroc:  0.8183603338242514 val_auprc:  0.9154234916788565
EarlyStopping counter: 19 out of 50
epoch:  63
epoch:  64 val_f1:  0.7448635686045757 val_auroc:  0.8195876288659795 val_auprc:  0.916906893650638
EarlyStopping counter: 20 out of 50
epoch:  64
epoch:  65 val_f1:  0.7777125328082551 val_auroc:  0.8230240549828178 val_auprc:  0.9202886864819751
EarlyStopping counter: 21 out of 50
epoch:  65
epoch:  66 val_f1:  0.766354189375772 val_auroc:  0.8244968090328915 val_auprc:  0.9200179089573925
EarlyStopping counter: 22 out of 50
epoch:  66
epoch:  67 val_f1:  0.7802930475309426 val_auroc:  0.8208149239077074 val_auprc:  0.9165296340970583
EarlyStopping counter: 23 out of 50
epoch:  67
epoch:  68 val_f1:  0.7622262794246104 val_auroc:  0.8205694648993619 val_auprc:  0.9158730964092884
EarlyStopping counter: 24 out of 50
epoch:  68
epoch:  69 val_f1:  0.7823449348629204 val_auroc:  0.8230240549828178 val_auprc:  0.9183945188025338
EarlyStopping counter: 25 out of 50
epoch:  69
epoch:  70 val_f1:  0.7831873586549224 val_auroc:  0.8232695139911635 val_auprc:  0.918961198957007
EarlyStopping counter: 26 out of 50
epoch:  70
epoch:  71 val_f1:  0.7879228532067962 val_auroc:  0.8225331369661266 val_auprc:  0.9193345971900082
EarlyStopping counter: 27 out of 50
epoch:  71
epoch:  72 val_f1:  0.7661184054361647 val_auroc:  0.8205694648993619 val_auprc:  0.9164267925794396
EarlyStopping counter: 28 out of 50
epoch:  72
epoch:  73 val_f1:  0.7868059619290214 val_auroc:  0.8208149239077074 val_auprc:  0.9164643810596728
EarlyStopping counter: 29 out of 50
epoch:  73
epoch:  74 val_f1:  0.7879228532067962 val_auroc:  0.8227785959744722 val_auprc:  0.9193909043929238
EarlyStopping counter: 30 out of 50
epoch:  74
epoch:  75 val_f1:  0.7762067639678805 val_auroc:  0.8208149239077075 val_auprc:  0.9180227178773368
EarlyStopping counter: 31 out of 50
epoch:  75
epoch:  76 val_f1:  0.7802930475309426 val_auroc:  0.8205694648993619 val_auprc:  0.9167689868679322
EarlyStopping counter: 32 out of 50
epoch:  76
epoch:  77 val_f1:  0.7727225509205256 val_auroc:  0.8199558173784978 val_auprc:  0.9159225696438853
EarlyStopping counter: 33 out of 50
epoch:  77
epoch:  78 val_f1:  0.7577565132360132 val_auroc:  0.8225331369661266 val_auprc:  0.9189828115535303
EarlyStopping counter: 34 out of 50
epoch:  78
epoch:  79 val_f1:  0.766354189375772 val_auroc:  0.8220422189494354 val_auprc:  0.9184714499239148
EarlyStopping counter: 35 out of 50
epoch:  79
epoch:  80 val_f1:  0.777854660092151 val_auroc:  0.8205694648993618 val_auprc:  0.9156126046760189
EarlyStopping counter: 36 out of 50
epoch:  80
epoch:  81 val_f1:  0.7809570525397864 val_auroc:  0.8237604320078548 val_auprc:  0.9178293106779065
EarlyStopping counter: 37 out of 50
epoch:  81
epoch:  82 val_f1:  0.7845295119922345 val_auroc:  0.8217967599410899 val_auprc:  0.9166567411302479
EarlyStopping counter: 38 out of 50
epoch:  82
epoch:  83 val_f1:  0.742136387976997 val_auroc:  0.8188512518409425 val_auprc:  0.9150823392591553
EarlyStopping counter: 39 out of 50
epoch:  83
epoch:  84 val_f1:  0.7823449348629204 val_auroc:  0.8252331860579284 val_auprc:  0.9204170852783402
EarlyStopping counter: 40 out of 50
epoch:  84
epoch:  85 val_f1:  0.7513203127712835 val_auroc:  0.8286696121747668 val_auprc:  0.921539222669858
EarlyStopping counter: 41 out of 50
epoch:  85
epoch:  86 val_f1:  0.7598715939807772 val_auroc:  0.8221649484536082 val_auprc:  0.917820385145783
EarlyStopping counter: 42 out of 50
epoch:  86
epoch:  87 val_f1:  0.7711689349644636 val_auroc:  0.8188512518409425 val_auprc:  0.9141255087397729
EarlyStopping counter: 43 out of 50
epoch:  87
epoch:  88 val_f1:  0.7643829551743221 val_auroc:  0.8220422189494354 val_auprc:  0.9183428716370888
EarlyStopping counter: 44 out of 50
epoch:  88
epoch:  89 val_f1:  0.777854660092151 val_auroc:  0.8195876288659794 val_auprc:  0.9166185130256076
EarlyStopping counter: 45 out of 50
epoch:  89
epoch:  90 val_f1:  0.7777125328082551 val_auroc:  0.8206921944035346 val_auprc:  0.9156109265929712
EarlyStopping counter: 46 out of 50
epoch:  90
epoch:  91 val_f1:  0.7813819697019021 val_auroc:  0.8240058910162003 val_auprc:  0.9175905620198546
EarlyStopping counter: 47 out of 50
epoch:  91
epoch:  92 val_f1:  0.7855581813618873 val_auroc:  0.8241286205203731 val_auprc:  0.9185214057944472
EarlyStopping counter: 48 out of 50
epoch:  92
epoch:  93 val_f1:  0.7622262794246104 val_auroc:  0.8190967108492881 val_auprc:  0.9144740173625155
EarlyStopping counter: 49 out of 50
epoch:  93
epoch:  94 val_f1:  0.6802976282278086 val_auroc:  0.8252331860579283 val_auprc:  0.9204541701456439
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1259.3824729919434
{'time_elapsed': [1259.3824729919434], 'epoch': [93], 'fold': [0], 'f1_train': [0.8096675522090929], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.6802976282278086], 'auroc_test': [0.8252331860579283], 'auprc_test': [0.9204541701456439]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1280]           2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 1280]           1,024
│    └─Tanh: 2-3                         [64, 512, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1278]           --
│    └─Dropout: 2-5                      [64, 512, 1278]           --
│    └─Flatten: 2-6                      [64, 654336]              --
│    └─Linear: 2-7                       [64, 1]                   654,337
==========================================================================================
Total params: 657,409
Trainable params: 657,409
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 671.09
Params size (MB): 2.63
Estimated Total Size (MB): 674.05
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.7009452472327455 val_auroc:  0.6659302896416298 val_auprc:  0.8318745690594789
epoch:  1
epoch:  2 val_f1:  0.5626522627768186 val_auroc:  0.6553755522827688 val_auprc:  0.7931039212616512
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.4247067613974088 val_auroc:  0.6491163475699557 val_auprc:  0.7856232787865893
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.43722239599624646 val_auroc:  0.665193912616593 val_auprc:  0.7943553194585736
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.5923866508287102 val_auroc:  0.686426116838488 val_auprc:  0.8067243512565864
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.619566649594801 val_auroc:  0.7134266077565047 val_auprc:  0.8109612922418353
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.7455074238481555 val_auroc:  0.7448453608247422 val_auprc:  0.8470044545808084
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.7031576347932113 val_auroc:  0.7686548846342661 val_auprc:  0.8713840122727248
EarlyStopping counter: 7 out of 50
epoch:  8
epoch:  9 val_f1:  0.7531731915989216 val_auroc:  0.7827687776141384 val_auprc:  0.8869656744826967
EarlyStopping counter: 8 out of 50
epoch:  9
epoch:  10 val_f1:  0.7490302789770621 val_auroc:  0.7960235640648012 val_auprc:  0.8953043864175136
EarlyStopping counter: 9 out of 50
epoch:  10
epoch:  11 val_f1:  0.723931698015082 val_auroc:  0.8055964653902798 val_auprc:  0.9007499597091071
EarlyStopping counter: 10 out of 50
epoch:  11
epoch:  12 val_f1:  0.7500864926036699 val_auroc:  0.8087874324987727 val_auprc:  0.903525992329353
EarlyStopping counter: 11 out of 50
epoch:  12
epoch:  13 val_f1:  0.7506155503404762 val_auroc:  0.8151693667157585 val_auprc:  0.9054289783186374
EarlyStopping counter: 12 out of 50
epoch:  13
epoch:  14 val_f1:  0.742136387976997 val_auroc:  0.8192194403534611 val_auprc:  0.9081127051037484
Validation loss improved to 0.288605
epoch:  14
epoch:  15 val_f1:  0.6749024096537389 val_auroc:  0.8190967108492881 val_auprc:  0.9072411232640712
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7304139313011326 val_auroc:  0.8175012272950418 val_auprc:  0.9058246049217675
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.7573003855683703 val_auroc:  0.8181148748159057 val_auprc:  0.9099997203608866
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.7371937993371881 val_auroc:  0.8190967108492881 val_auprc:  0.9111862203513752
EarlyStopping counter: 4 out of 50
epoch:  18
epoch:  19 val_f1:  0.7745465218349855 val_auroc:  0.8227785959744722 val_auprc:  0.9114178831322405
Validation loss improved to 0.274897
epoch:  19
epoch:  20 val_f1:  0.6894622188638474 val_auroc:  0.8195876288659794 val_auprc:  0.9105052067062717
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7839141001375581 val_auroc:  0.8203240058910162 val_auprc:  0.9108480616821153
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.6655263974827678 val_auroc:  0.8208149239077074 val_auprc:  0.9145587332076377
EarlyStopping counter: 3 out of 50
epoch:  22
epoch:  23 val_f1:  0.3160235448005232 val_auroc:  0.8259695630829652 val_auprc:  0.9186862654559489
EarlyStopping counter: 4 out of 50
epoch:  23
epoch:  24 val_f1:  0.6441055155875299 val_auroc:  0.824251350024546 val_auprc:  0.9195094810174866
EarlyStopping counter: 5 out of 50
epoch:  24
epoch:  25 val_f1:  0.5901444900487328 val_auroc:  0.791728031418753 val_auprc:  0.9031966893000164
EarlyStopping counter: 6 out of 50
epoch:  25
epoch:  26 val_f1:  0.45877280866101766 val_auroc:  0.8215513009327442 val_auprc:  0.9204900565828127
EarlyStopping counter: 7 out of 50
epoch:  26
epoch:  27 val_f1:  0.6310465491302215 val_auroc:  0.8078055964653903 val_auprc:  0.9095830624532251
EarlyStopping counter: 8 out of 50
epoch:  27
epoch:  28 val_f1:  0.7757738305193033 val_auroc:  0.8247422680412372 val_auprc:  0.921686496788219
EarlyStopping counter: 9 out of 50
epoch:  28
epoch:  29 val_f1:  0.7185321510233673 val_auroc:  0.8281786941580757 val_auprc:  0.9205021187333591
EarlyStopping counter: 10 out of 50
epoch:  29
epoch:  30 val_f1:  0.6598406488264144 val_auroc:  0.8271968581246931 val_auprc:  0.920899742636271
EarlyStopping counter: 11 out of 50
epoch:  30
epoch:  31 val_f1:  0.8152318336718186 val_auroc:  0.8276877761413843 val_auprc:  0.9214803830995625
EarlyStopping counter: 12 out of 50
epoch:  31
epoch:  32 val_f1:  0.8152318336718186 val_auroc:  0.8294059891998037 val_auprc:  0.9212115919335332
EarlyStopping counter: 13 out of 50
epoch:  32
epoch:  33 val_f1:  0.8152318336718186 val_auroc:  0.8286696121747669 val_auprc:  0.9206315500627655
EarlyStopping counter: 14 out of 50
epoch:  33
epoch:  34 val_f1:  0.7500864926036699 val_auroc:  0.822287677957781 val_auprc:  0.9168802900447803
EarlyStopping counter: 15 out of 50
epoch:  34
epoch:  35 val_f1:  0.814150423846969 val_auroc:  0.8244968090328916 val_auprc:  0.9173332700097303
EarlyStopping counter: 16 out of 50
epoch:  35
epoch:  36 val_f1:  0.7765831291011147 val_auroc:  0.8217967599410898 val_auprc:  0.9135401308101853
EarlyStopping counter: 17 out of 50
epoch:  36
epoch:  37 val_f1:  0.7633550302615051 val_auroc:  0.8200785468826706 val_auprc:  0.9119267273016334
EarlyStopping counter: 18 out of 50
epoch:  37
epoch:  38 val_f1:  0.7823449348629204 val_auroc:  0.8134511536573392 val_auprc:  0.9075987458237069
EarlyStopping counter: 19 out of 50
epoch:  38
epoch:  39 val_f1:  0.8228169738152763 val_auroc:  0.8242513500245459 val_auprc:  0.9117294091177794
Validation loss improved to 0.256476
epoch:  39
epoch:  40 val_f1:  0.7685409504908388 val_auroc:  0.8197103583701522 val_auprc:  0.9068924675017912
Validation loss improved to 0.200588
epoch:  40
epoch:  41 val_f1:  0.7169009504644194 val_auroc:  0.814187530682376 val_auprc:  0.9074804117054776
EarlyStopping counter: 1 out of 50
epoch:  41
epoch:  42 val_f1:  0.7765831291011147 val_auroc:  0.8281786941580757 val_auprc:  0.9165622418103762
EarlyStopping counter: 2 out of 50
epoch:  42
epoch:  43 val_f1:  0.830338282565437 val_auroc:  0.8362788414334805 val_auprc:  0.9202042527535834
EarlyStopping counter: 3 out of 50
epoch:  43
epoch:  44 val_f1:  0.7617596949267598 val_auroc:  0.8055964653902798 val_auprc:  0.9035897436226992
EarlyStopping counter: 4 out of 50
epoch:  44
epoch:  45 val_f1:  0.7707245329923307 val_auroc:  0.8284241531664213 val_auprc:  0.9113254888190737
Validation loss improved to 0.183292
epoch:  45
epoch:  46 val_f1:  0.80508331055267 val_auroc:  0.8244968090328915 val_auprc:  0.9073409291324026
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.7573003855683703 val_auroc:  0.8156602847324497 val_auprc:  0.9044374350628854
EarlyStopping counter: 2 out of 50
epoch:  47
epoch:  48 val_f1:  0.777854660092151 val_auroc:  0.8257241040746196 val_auprc:  0.9059972907623848
EarlyStopping counter: 3 out of 50
epoch:  48
epoch:  49 val_f1:  0.7906450372602754 val_auroc:  0.817378497790869 val_auprc:  0.9075691220450359
EarlyStopping counter: 4 out of 50
epoch:  49
epoch:  50 val_f1:  0.682026026688228 val_auroc:  0.8173784977908689 val_auprc:  0.9080698524853944
EarlyStopping counter: 5 out of 50
epoch:  50
epoch:  51 val_f1:  0.681579990245092 val_auroc:  0.8264604810996563 val_auprc:  0.911740006147161
EarlyStopping counter: 6 out of 50
epoch:  51
epoch:  52 val_f1:  0.7029258641632973 val_auroc:  0.8271968581246931 val_auprc:  0.9099407528417062
EarlyStopping counter: 7 out of 50
epoch:  52
epoch:  53 val_f1:  0.7286063672426545 val_auroc:  0.82486499754541 val_auprc:  0.9093641797296581
EarlyStopping counter: 8 out of 50
epoch:  53
epoch:  54 val_f1:  0.6670420077516633 val_auroc:  0.8411880216003927 val_auprc:  0.9233716526853732
EarlyStopping counter: 9 out of 50
epoch:  54
epoch:  55 val_f1:  0.8161998061125568 val_auroc:  0.8416789396170841 val_auprc:  0.9250960168343871
EarlyStopping counter: 10 out of 50
epoch:  55
epoch:  56 val_f1:  0.6743799189283424 val_auroc:  0.8446244477172312 val_auprc:  0.9228516510921426
EarlyStopping counter: 11 out of 50
epoch:  56
epoch:  57 val_f1:  0.7545102379634754 val_auroc:  0.8276877761413844 val_auprc:  0.9093414989235605
EarlyStopping counter: 12 out of 50
epoch:  57
epoch:  58 val_f1:  0.8218323698145653 val_auroc:  0.8284241531664213 val_auprc:  0.907490901335799
EarlyStopping counter: 13 out of 50
epoch:  58
epoch:  59 val_f1:  0.7971323289800215 val_auroc:  0.8298969072164949 val_auprc:  0.9089824705679073
Validation loss improved to 0.158232
epoch:  59
epoch:  60 val_f1:  0.7971323289800215 val_auroc:  0.8247422680412372 val_auprc:  0.9066422819766113
EarlyStopping counter: 1 out of 50
epoch:  60
epoch:  61 val_f1:  0.7685409504908388 val_auroc:  0.8238831615120275 val_auprc:  0.9063283135622882
EarlyStopping counter: 2 out of 50
epoch:  61
epoch:  62 val_f1:  0.7765831291011147 val_auroc:  0.8278105056455571 val_auprc:  0.907480875910522
EarlyStopping counter: 3 out of 50
epoch:  62
epoch:  63 val_f1:  0.7685409504908388 val_auroc:  0.8274423171330388 val_auprc:  0.9077496777528522
Validation loss improved to 0.122532
epoch:  63
epoch:  64 val_f1:  0.7809570525397864 val_auroc:  0.8312469317623957 val_auprc:  0.9041621203045141
EarlyStopping counter: 1 out of 50
epoch:  64
epoch:  65 val_f1:  0.7607401077265918 val_auroc:  0.8281786941580755 val_auprc:  0.9085916388070783
EarlyStopping counter: 2 out of 50
epoch:  65
epoch:  66 val_f1:  0.7890919075230509 val_auroc:  0.822287677957781 val_auprc:  0.9010456795795513
EarlyStopping counter: 3 out of 50
epoch:  66
epoch:  67 val_f1:  0.80508331055267 val_auroc:  0.8236377025036818 val_auprc:  0.8951514004475833
EarlyStopping counter: 4 out of 50
epoch:  67
epoch:  68 val_f1:  0.7661589271850144 val_auroc:  0.8232695139911634 val_auprc:  0.9062862456832991
EarlyStopping counter: 5 out of 50
epoch:  68
epoch:  69 val_f1:  0.814150423846969 val_auroc:  0.8268286696121748 val_auprc:  0.8973571452831248
EarlyStopping counter: 6 out of 50
epoch:  69
epoch:  70 val_f1:  0.7809570525397864 val_auroc:  0.8322287677957781 val_auprc:  0.9071810409325352
EarlyStopping counter: 7 out of 50
epoch:  70
epoch:  71 val_f1:  0.7826417810500232 val_auroc:  0.8194648993618066 val_auprc:  0.8966789582817889
EarlyStopping counter: 8 out of 50
epoch:  71
epoch:  72 val_f1:  0.7639041425521674 val_auroc:  0.8302650957290133 val_auprc:  0.9067680149841514
Validation loss improved to 0.100925
epoch:  72
epoch:  73 val_f1:  0.7879228532067962 val_auroc:  0.8211831124202258 val_auprc:  0.8962091046947183
EarlyStopping counter: 1 out of 50
epoch:  73
epoch:  74 val_f1:  0.80508331055267 val_auroc:  0.8264604810996564 val_auprc:  0.9016897385216625
EarlyStopping counter: 2 out of 50
epoch:  74
epoch:  75 val_f1:  0.7812454480117876 val_auroc:  0.8364015709376534 val_auprc:  0.90762330125193
Validation loss improved to 0.097429
epoch:  75
epoch:  76 val_f1:  0.7791090204759269 val_auroc:  0.8286696121747668 val_auprc:  0.9058813900485095
EarlyStopping counter: 1 out of 50
epoch:  76
epoch:  77 val_f1:  0.7809570525397864 val_auroc:  0.8332106038291605 val_auprc:  0.9014545978579798
EarlyStopping counter: 2 out of 50
epoch:  77
epoch:  78 val_f1:  0.7971323289800215 val_auroc:  0.8263377515954835 val_auprc:  0.8993235569827522
EarlyStopping counter: 3 out of 50
epoch:  78
epoch:  79 val_f1:  0.7809570525397864 val_auroc:  0.8308787432498773 val_auprc:  0.9048517161415649
EarlyStopping counter: 4 out of 50
epoch:  79
epoch:  80 val_f1:  0.7788179744018625 val_auroc:  0.8355424644084437 val_auprc:  0.9135916893574595
EarlyStopping counter: 5 out of 50
epoch:  80
epoch:  81 val_f1:  0.7685409504908388 val_auroc:  0.8247422680412372 val_auprc:  0.907882926031114
EarlyStopping counter: 6 out of 50
epoch:  81
epoch:  82 val_f1:  0.7809570525397864 val_auroc:  0.8317378497790868 val_auprc:  0.907422770752309
EarlyStopping counter: 7 out of 50
epoch:  82
epoch:  83 val_f1:  0.7809570525397864 val_auroc:  0.8305105547373589 val_auprc:  0.9065500385896796
EarlyStopping counter: 8 out of 50
epoch:  83
epoch:  84 val_f1:  0.7809570525397864 val_auroc:  0.8260922925871379 val_auprc:  0.9030906489400168
EarlyStopping counter: 9 out of 50
epoch:  84
epoch:  85 val_f1:  0.7791090204759269 val_auroc:  0.8278105056455574 val_auprc:  0.9049590790074316
EarlyStopping counter: 10 out of 50
epoch:  85
epoch:  86 val_f1:  0.7809570525397864 val_auroc:  0.8296514482081492 val_auprc:  0.9057773501397435
EarlyStopping counter: 11 out of 50
epoch:  86
epoch:  87 val_f1:  0.7791090204759269 val_auroc:  0.8263377515954836 val_auprc:  0.9051094931163663
EarlyStopping counter: 12 out of 50
epoch:  87
epoch:  88 val_f1:  0.7809570525397864 val_auroc:  0.8275650466372116 val_auprc:  0.902801435370474
EarlyStopping counter: 13 out of 50
epoch:  88
epoch:  89 val_f1:  0.7809570525397864 val_auroc:  0.8271968581246932 val_auprc:  0.9021921912398496
EarlyStopping counter: 14 out of 50
epoch:  89
epoch:  90 val_f1:  0.7809570525397864 val_auroc:  0.8278105056455571 val_auprc:  0.9041200684974077
EarlyStopping counter: 15 out of 50
epoch:  90
epoch:  91 val_f1:  0.7809570525397864 val_auroc:  0.8281786941580755 val_auprc:  0.9049967807920307
EarlyStopping counter: 16 out of 50
epoch:  91
epoch:  92 val_f1:  0.7809570525397864 val_auroc:  0.826705940108002 val_auprc:  0.9034855766300207
EarlyStopping counter: 17 out of 50
epoch:  92
epoch:  93 val_f1:  0.7748796193569787 val_auroc:  0.8284241531664213 val_auprc:  0.9084761499496965
Validation loss improved to 0.088273
epoch:  93
epoch:  94 val_f1:  0.7855164986057286 val_auroc:  0.8286696121747668 val_auprc:  0.9069744089476975
EarlyStopping counter: 1 out of 50
epoch:  94
epoch:  95 val_f1:  0.7770871369605723 val_auroc:  0.8270741286205203 val_auprc:  0.9075563437388086
EarlyStopping counter: 2 out of 50
epoch:  95
epoch:  96 val_f1:  0.7748796193569787 val_auroc:  0.8295287187039765 val_auprc:  0.9080594191553323
EarlyStopping counter: 3 out of 50
epoch:  96
epoch:  97 val_f1:  0.7748796193569787 val_auroc:  0.8287923416789397 val_auprc:  0.9086214905988558
Validation loss improved to 0.088155
epoch:  97
epoch:  98 val_f1:  0.7809570525397864 val_auroc:  0.8281786941580755 val_auprc:  0.9051211355970794
EarlyStopping counter: 1 out of 50
epoch:  98
epoch:  99 val_f1:  0.7809570525397864 val_auroc:  0.8263377515954835 val_auprc:  0.9044541165942157
EarlyStopping counter: 2 out of 50
epoch:  99
epoch:  100 val_f1:  0.7770871369605723 val_auroc:  0.8301423662248404 val_auprc:  0.9086599417692002
Validation loss improved to 0.084879
epoch:  100
epoch:  101 val_f1:  0.787641731275174 val_auroc:  0.8305105547373589 val_auprc:  0.909421029293286
Validation loss improved to 0.078420
epoch:  101
epoch:  102 val_f1:  0.787641731275174 val_auroc:  0.8289150711831124 val_auprc:  0.9084192431560452
Validation loss improved to 0.077317
epoch:  102
epoch:  103 val_f1:  0.7748796193569787 val_auroc:  0.82793323514973 val_auprc:  0.908453609119233
EarlyStopping counter: 1 out of 50
epoch:  103
epoch:  104 val_f1:  0.7938350857775318 val_auroc:  0.8290378006872852 val_auprc:  0.9074214981390069
EarlyStopping counter: 2 out of 50
epoch:  104
epoch:  105 val_f1:  0.7809570525397864 val_auroc:  0.829160530191458 val_auprc:  0.9060924206464406
EarlyStopping counter: 3 out of 50
epoch:  105
epoch:  106 val_f1:  0.7809570525397864 val_auroc:  0.8269513991163476 val_auprc:  0.9042056592634491
EarlyStopping counter: 4 out of 50
epoch:  106
epoch:  107 val_f1:  0.7809570525397864 val_auroc:  0.8290378006872852 val_auprc:  0.9073231896720829
EarlyStopping counter: 5 out of 50
epoch:  107
epoch:  108 val_f1:  0.7770871369605723 val_auroc:  0.8279332351497299 val_auprc:  0.9073282654120443
EarlyStopping counter: 6 out of 50
epoch:  108
epoch:  109 val_f1:  0.7809570525397864 val_auroc:  0.8258468335787923 val_auprc:  0.9064933960755321
EarlyStopping counter: 7 out of 50
epoch:  109
epoch:  110 val_f1:  0.7855164986057286 val_auroc:  0.8276877761413843 val_auprc:  0.9077010363372897
EarlyStopping counter: 8 out of 50
epoch:  110
epoch:  111 val_f1:  0.7873856121514594 val_auroc:  0.82793323514973 val_auprc:  0.9077211086278375
EarlyStopping counter: 9 out of 50
epoch:  111
epoch:  112 val_f1:  0.7809570525397864 val_auroc:  0.8275650466372116 val_auprc:  0.9076455857036207
EarlyStopping counter: 10 out of 50
epoch:  112
epoch:  113 val_f1:  0.7809570525397864 val_auroc:  0.8278105056455572 val_auprc:  0.9073611755548557
EarlyStopping counter: 11 out of 50
epoch:  113
epoch:  114 val_f1:  0.7809570525397864 val_auroc:  0.8289150711831125 val_auprc:  0.9076680975494418
EarlyStopping counter: 12 out of 50
epoch:  114
epoch:  115 val_f1:  0.7748796193569787 val_auroc:  0.8270741286205204 val_auprc:  0.9082382690744657
EarlyStopping counter: 13 out of 50
epoch:  115
epoch:  116 val_f1:  0.7748796193569787 val_auroc:  0.8258468335787923 val_auprc:  0.9076867892102798
EarlyStopping counter: 14 out of 50
epoch:  116
epoch:  117 val_f1:  0.7809570525397864 val_auroc:  0.82793323514973 val_auprc:  0.9072534809473816
EarlyStopping counter: 15 out of 50
epoch:  117
epoch:  118 val_f1:  0.787641731275174 val_auroc:  0.8290378006872852 val_auprc:  0.9106432031473701
Validation loss improved to 0.070557
epoch:  118
epoch:  119 val_f1:  0.7855164986057286 val_auroc:  0.8290378006872852 val_auprc:  0.9093128100874803
EarlyStopping counter: 1 out of 50
epoch:  119
epoch:  120 val_f1:  0.7770871369605723 val_auroc:  0.8271968581246931 val_auprc:  0.9086749261057137
EarlyStopping counter: 2 out of 50
epoch:  120
epoch:  121 val_f1:  0.7809570525397864 val_auroc:  0.8275650466372115 val_auprc:  0.9077838678768346
EarlyStopping counter: 3 out of 50
epoch:  121
epoch:  122 val_f1:  0.787641731275174 val_auroc:  0.8287923416789397 val_auprc:  0.9103165237724427
EarlyStopping counter: 4 out of 50
epoch:  122
epoch:  123 val_f1:  0.787641731275174 val_auroc:  0.8278105056455572 val_auprc:  0.9098540626500844
Validation loss improved to 0.068784
epoch:  123
epoch:  124 val_f1:  0.7940719072017342 val_auroc:  0.8289150711831124 val_auprc:  0.9101367610030304
Validation loss improved to 0.060136
epoch:  124
epoch:  125 val_f1:  0.7770871369605723 val_auroc:  0.828546882670594 val_auprc:  0.9090519827186512
EarlyStopping counter: 1 out of 50
epoch:  125
epoch:  126 val_f1:  0.7873856121514594 val_auroc:  0.8296514482081493 val_auprc:  0.9090341398837243
EarlyStopping counter: 2 out of 50
epoch:  126
epoch:  127 val_f1:  0.7809570525397864 val_auroc:  0.8290378006872852 val_auprc:  0.9095564721239945
EarlyStopping counter: 3 out of 50
epoch:  127
epoch:  128 val_f1:  0.7873856121514594 val_auroc:  0.8306332842415316 val_auprc:  0.9101064702350549
EarlyStopping counter: 4 out of 50
epoch:  128
epoch:  129 val_f1:  0.7748796193569787 val_auroc:  0.829774177712322 val_auprc:  0.9105660734861578
EarlyStopping counter: 5 out of 50
epoch:  129
epoch:  130 val_f1:  0.7770871369605723 val_auroc:  0.828546882670594 val_auprc:  0.9097868383314982
EarlyStopping counter: 6 out of 50
epoch:  130
epoch:  131 val_f1:  0.787641731275174 val_auroc:  0.8290378006872852 val_auprc:  0.9104981251406732
EarlyStopping counter: 7 out of 50
epoch:  131
epoch:  132 val_f1:  0.787641731275174 val_auroc:  0.8295287187039764 val_auprc:  0.9107558878740343
EarlyStopping counter: 8 out of 50
epoch:  132
epoch:  133 val_f1:  0.7791090204759269 val_auroc:  0.8296514482081493 val_auprc:  0.909940662491365
EarlyStopping counter: 9 out of 50
epoch:  133
epoch:  134 val_f1:  0.7685409504908388 val_auroc:  0.8286696121747668 val_auprc:  0.9100187060466742
EarlyStopping counter: 10 out of 50
epoch:  134
epoch:  135 val_f1:  0.7748796193569787 val_auroc:  0.82793323514973 val_auprc:  0.9097490404237425
EarlyStopping counter: 11 out of 50
epoch:  135
epoch:  136 val_f1:  0.7809570525397864 val_auroc:  0.8286696121747668 val_auprc:  0.9085143560105481
EarlyStopping counter: 12 out of 50
epoch:  136
epoch:  137 val_f1:  0.7809570525397864 val_auroc:  0.8273195876288659 val_auprc:  0.9078064326123909
EarlyStopping counter: 13 out of 50
epoch:  137
epoch:  138 val_f1:  0.7791090204759269 val_auroc:  0.8274423171330387 val_auprc:  0.9092474699139266
EarlyStopping counter: 14 out of 50
epoch:  138
epoch:  139 val_f1:  0.7707245329923307 val_auroc:  0.8274423171330388 val_auprc:  0.9095318699360084
EarlyStopping counter: 15 out of 50
epoch:  139
epoch:  140 val_f1:  0.7770871369605723 val_auroc:  0.8300196367206676 val_auprc:  0.9108770592822699
EarlyStopping counter: 16 out of 50
epoch:  140
epoch:  141 val_f1:  0.7873856121514594 val_auroc:  0.8284241531664212 val_auprc:  0.9091959832703594
EarlyStopping counter: 17 out of 50
epoch:  141
epoch:  142 val_f1:  0.7809570525397864 val_auroc:  0.8300196367206677 val_auprc:  0.9085826308921118
EarlyStopping counter: 18 out of 50
epoch:  142
epoch:  143 val_f1:  0.7873856121514594 val_auroc:  0.8286696121747668 val_auprc:  0.9090760311976971
EarlyStopping counter: 19 out of 50
epoch:  143
epoch:  144 val_f1:  0.7707245329923307 val_auroc:  0.8286696121747668 val_auprc:  0.9102235794009632
EarlyStopping counter: 20 out of 50
epoch:  144
epoch:  145 val_f1:  0.7748796193569787 val_auroc:  0.8281786941580757 val_auprc:  0.9101516509516041
EarlyStopping counter: 21 out of 50
epoch:  145
epoch:  146 val_f1:  0.7812454480117876 val_auroc:  0.8294059891998036 val_auprc:  0.9107492277693832
EarlyStopping counter: 22 out of 50
epoch:  146
epoch:  147 val_f1:  0.7791090204759269 val_auroc:  0.8296514482081492 val_auprc:  0.910580833187079
EarlyStopping counter: 23 out of 50
epoch:  147
epoch:  148 val_f1:  0.7707245329923307 val_auroc:  0.8286696121747669 val_auprc:  0.9101001375018849
EarlyStopping counter: 24 out of 50
epoch:  148
epoch:  149 val_f1:  0.7873856121514594 val_auroc:  0.8284241531664213 val_auprc:  0.9098046927671661
EarlyStopping counter: 25 out of 50
epoch:  149
epoch:  150 val_f1:  0.7809570525397864 val_auroc:  0.8273195876288659 val_auprc:  0.9078265706352386
EarlyStopping counter: 26 out of 50
epoch:  150
epoch:  151 val_f1:  0.7873856121514594 val_auroc:  0.8292832596956308 val_auprc:  0.9105343012027025
EarlyStopping counter: 27 out of 50
epoch:  151
epoch:  152 val_f1:  0.7791090204759269 val_auroc:  0.8270741286205203 val_auprc:  0.9096962902144252
EarlyStopping counter: 28 out of 50
epoch:  152
epoch:  153 val_f1:  0.7791090204759269 val_auroc:  0.8280559646539029 val_auprc:  0.9099645692592844
EarlyStopping counter: 29 out of 50
epoch:  153
epoch:  154 val_f1:  0.7791090204759269 val_auroc:  0.82793323514973 val_auprc:  0.9097917710764429
EarlyStopping counter: 30 out of 50
epoch:  154
epoch:  155 val_f1:  0.7622262794246104 val_auroc:  0.8289150711831125 val_auprc:  0.910532638326822
EarlyStopping counter: 31 out of 50
epoch:  155
epoch:  156 val_f1:  0.7812454480117876 val_auroc:  0.8249877270495827 val_auprc:  0.9049964026183879
EarlyStopping counter: 32 out of 50
epoch:  156
epoch:  157 val_f1:  0.7809570525397864 val_auroc:  0.8265832106038291 val_auprc:  0.9087133736540645
EarlyStopping counter: 33 out of 50
epoch:  157
epoch:  158 val_f1:  0.7809570525397864 val_auroc:  0.8271968581246932 val_auprc:  0.9084385096960259
EarlyStopping counter: 34 out of 50
epoch:  158
epoch:  159 val_f1:  0.7809570525397864 val_auroc:  0.8269513991163476 val_auprc:  0.90849095574281
EarlyStopping counter: 35 out of 50
epoch:  159
epoch:  160 val_f1:  0.7873856121514594 val_auroc:  0.8265832106038292 val_auprc:  0.9091755634295415
EarlyStopping counter: 36 out of 50
epoch:  160
epoch:  161 val_f1:  0.7707245329923307 val_auroc:  0.8269513991163476 val_auprc:  0.9096964682280431
EarlyStopping counter: 37 out of 50
epoch:  161
epoch:  162 val_f1:  0.7748796193569787 val_auroc:  0.8274423171330387 val_auprc:  0.9100205319552663
EarlyStopping counter: 38 out of 50
epoch:  162
epoch:  163 val_f1:  0.7685409504908388 val_auroc:  0.8280559646539027 val_auprc:  0.910308974427932
EarlyStopping counter: 39 out of 50
epoch:  163
epoch:  164 val_f1:  0.7685409504908388 val_auroc:  0.8280559646539027 val_auprc:  0.9102803174225869
EarlyStopping counter: 40 out of 50
epoch:  164
epoch:  165 val_f1:  0.7873856121514594 val_auroc:  0.8269513991163475 val_auprc:  0.9094825109282378
EarlyStopping counter: 41 out of 50
epoch:  165
epoch:  166 val_f1:  0.7791090204759269 val_auroc:  0.8301423662248404 val_auprc:  0.9113437654377345
EarlyStopping counter: 42 out of 50
epoch:  166
epoch:  167 val_f1:  0.7770871369605723 val_auroc:  0.8278105056455572 val_auprc:  0.9103271834627873
EarlyStopping counter: 43 out of 50
epoch:  167
epoch:  168 val_f1:  0.787641731275174 val_auroc:  0.8263377515954835 val_auprc:  0.9080070572063923
EarlyStopping counter: 44 out of 50
epoch:  168
epoch:  169 val_f1:  0.7791090204759269 val_auroc:  0.8265832106038291 val_auprc:  0.9096712301869376
EarlyStopping counter: 45 out of 50
epoch:  169
epoch:  170 val_f1:  0.7791090204759269 val_auroc:  0.8284241531664213 val_auprc:  0.9105259212487458
EarlyStopping counter: 46 out of 50
epoch:  170
epoch:  171 val_f1:  0.7770871369605723 val_auroc:  0.8302650957290132 val_auprc:  0.9114648958287208
EarlyStopping counter: 47 out of 50
epoch:  171
epoch:  172 val_f1:  0.7873856121514594 val_auroc:  0.8289150711831125 val_auprc:  0.9107866131285682
EarlyStopping counter: 48 out of 50
epoch:  172
epoch:  173 val_f1:  0.7770871369605723 val_auroc:  0.8280559646539027 val_auprc:  0.9104493516718946
EarlyStopping counter: 49 out of 50
epoch:  173
epoch:  174 val_f1:  0.7770871369605723 val_auroc:  0.8273195876288659 val_auprc:  0.9102134582416084
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  2286.3137712478638
{'time_elapsed': [2286.3137712478638], 'epoch': [173], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7770871369605723], 'auroc_test': [0.8273195876288659], 'auprc_test': [0.9102134582416084]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1280]           2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 1280]           1,024
│    └─Tanh: 2-3                         [64, 512, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1278]           --
│    └─Dropout: 2-5                      [64, 512, 1278]           --
│    └─Flatten: 2-6                      [64, 654336]              --
│    └─Linear: 2-7                       [64, 1]                   654,337
==========================================================================================
Total params: 657,409
Trainable params: 657,409
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 671.09
Params size (MB): 2.63
Estimated Total Size (MB): 674.05
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6358450082039632 val_auroc:  0.6644575355915562 val_auprc:  0.8261203777783636
epoch:  1
epoch:  2 val_f1:  0.6667819901382266 val_auroc:  0.6357388316151202 val_auprc:  0.7912494363163276
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.663660745778955 val_auroc:  0.6261659302896417 val_auprc:  0.7883234385710862
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5213179975769904 val_auroc:  0.6361070201276386 val_auprc:  0.7763262997903704
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.4795145890028967 val_auroc:  0.6799214531173293 val_auprc:  0.807587049592321
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6809444902292597 val_auroc:  0.7023809523809523 val_auprc:  0.8496016968925572
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.5697197655491435 val_auroc:  0.7037309769268533 val_auprc:  0.8261737119333804
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.5035971223021583 val_auroc:  0.7079037800687286 val_auprc:  0.8260224042156075
EarlyStopping counter: 7 out of 50
epoch:  8
epoch:  9 val_f1:  0.7144317414801258 val_auroc:  0.7373588610702012 val_auprc:  0.8591510070248443
EarlyStopping counter: 8 out of 50
epoch:  9
epoch:  10 val_f1:  0.6743031235389048 val_auroc:  0.7347815414825724 val_auprc:  0.8701004185162646
EarlyStopping counter: 9 out of 50
epoch:  10
epoch:  11 val_f1:  0.7441671543148256 val_auroc:  0.756259204712813 val_auprc:  0.8660905452656102
EarlyStopping counter: 10 out of 50
epoch:  11
epoch:  12 val_f1:  0.48296430454703837 val_auroc:  0.7430044182621502 val_auprc:  0.8495613594098455
EarlyStopping counter: 11 out of 50
epoch:  12
epoch:  13 val_f1:  0.7208993647046947 val_auroc:  0.7522091310751104 val_auprc:  0.8646044481938575
EarlyStopping counter: 12 out of 50
epoch:  13
epoch:  14 val_f1:  0.6925918724479876 val_auroc:  0.7666912125675012 val_auprc:  0.8787043834053971
EarlyStopping counter: 13 out of 50
epoch:  14
epoch:  15 val_f1:  0.6614736591628271 val_auroc:  0.7676730486008836 val_auprc:  0.8674710574281999
EarlyStopping counter: 14 out of 50
epoch:  15
epoch:  16 val_f1:  0.682026026688228 val_auroc:  0.7727049582719686 val_auprc:  0.8732501950879008
EarlyStopping counter: 15 out of 50
epoch:  16
epoch:  17 val_f1:  0.7199392779354498 val_auroc:  0.7722140402552774 val_auprc:  0.8822511711300485
EarlyStopping counter: 16 out of 50
epoch:  17
epoch:  18 val_f1:  0.7100860488080124 val_auroc:  0.7690230731467845 val_auprc:  0.8749271230801734
EarlyStopping counter: 17 out of 50
epoch:  18
epoch:  19 val_f1:  0.7304139313011326 val_auroc:  0.7716003927344133 val_auprc:  0.8797324910544936
EarlyStopping counter: 18 out of 50
epoch:  19
epoch:  20 val_f1:  0.6057912921222274 val_auroc:  0.7623956799214531 val_auprc:  0.8781525597767224
EarlyStopping counter: 19 out of 50
epoch:  20
epoch:  21 val_f1:  0.7126420359039872 val_auroc:  0.756872852233677 val_auprc:  0.8760081383220061
EarlyStopping counter: 20 out of 50
epoch:  21
epoch:  22 val_f1:  0.7054786939679025 val_auroc:  0.768654884634266 val_auprc:  0.882506705363756
EarlyStopping counter: 21 out of 50
epoch:  22
epoch:  23 val_f1:  0.7142089711496735 val_auroc:  0.7623956799214531 val_auprc:  0.8771580381195336
EarlyStopping counter: 22 out of 50
epoch:  23
epoch:  24 val_f1:  0.6879219917448011 val_auroc:  0.7669366715758468 val_auprc:  0.8808010833658624
EarlyStopping counter: 23 out of 50
epoch:  24
epoch:  25 val_f1:  0.7057031525565856 val_auroc:  0.7572410407461955 val_auprc:  0.8753537003206252
EarlyStopping counter: 24 out of 50
epoch:  25
epoch:  26 val_f1:  0.7281499969472504 val_auroc:  0.7682866961217476 val_auprc:  0.8823945111699674
Validation loss improved to 0.685959
epoch:  26
epoch:  27 val_f1:  0.7090514753972222 val_auroc:  0.761168384879725 val_auprc:  0.8783948686324772
Validation loss improved to 0.618754
epoch:  27
epoch:  28 val_f1:  0.6393953191876878 val_auroc:  0.766813942071674 val_auprc:  0.8841946030385576
Validation loss improved to 0.529875
epoch:  28
epoch:  29 val_f1:  0.646667571603095 val_auroc:  0.7371134020618557 val_auprc:  0.8685179799414675
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.7090514753972222 val_auroc:  0.7474226804123711 val_auprc:  0.8739226972873347
EarlyStopping counter: 2 out of 50
epoch:  30
epoch:  31 val_f1:  0.6459565936764723 val_auroc:  0.7491408934707904 val_auprc:  0.8737034718517817
EarlyStopping counter: 3 out of 50
epoch:  31
epoch:  32 val_f1:  0.717230470942395 val_auroc:  0.7562592047128129 val_auprc:  0.8792507370984823
EarlyStopping counter: 4 out of 50
epoch:  32
epoch:  33 val_f1:  0.7235944791518311 val_auroc:  0.7646048109965636 val_auprc:  0.8821199419854712
EarlyStopping counter: 5 out of 50
epoch:  33
epoch:  34 val_f1:  0.6907263230511482 val_auroc:  0.7692685321551301 val_auprc:  0.886824585402886
EarlyStopping counter: 6 out of 50
epoch:  34
epoch:  35 val_f1:  0.6730611342088393 val_auroc:  0.7547864506627393 val_auprc:  0.8753507482971576
EarlyStopping counter: 7 out of 50
epoch:  35
epoch:  36 val_f1:  0.6847441835349226 val_auroc:  0.7766323024054982 val_auprc:  0.8905709018427361
EarlyStopping counter: 8 out of 50
epoch:  36
epoch:  37 val_f1:  0.743914028278071 val_auroc:  0.7682866961217477 val_auprc:  0.8828343609230032
Validation loss improved to 0.486107
epoch:  37
epoch:  38 val_f1:  0.702782849280763 val_auroc:  0.7712322042218949 val_auprc:  0.8829050736035032
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.6760265633646928 val_auroc:  0.7563819342169857 val_auprc:  0.8749675020767302
EarlyStopping counter: 2 out of 50
epoch:  39
epoch:  40 val_f1:  0.6787370103916865 val_auroc:  0.7648502700049091 val_auprc:  0.8810190165901444
EarlyStopping counter: 3 out of 50
epoch:  40
epoch:  41 val_f1:  0.6952451949622753 val_auroc:  0.7660775650466372 val_auprc:  0.8809261016020711
EarlyStopping counter: 4 out of 50
epoch:  41
epoch:  42 val_f1:  0.713247796930704 val_auroc:  0.7626411389297987 val_auprc:  0.8784900896722523
EarlyStopping counter: 5 out of 50
epoch:  42
epoch:  43 val_f1:  0.7018195933946583 val_auroc:  0.766813942071674 val_auprc:  0.8807031945954982
EarlyStopping counter: 6 out of 50
epoch:  43
epoch:  44 val_f1:  0.730071543320129 val_auroc:  0.7582228767795778 val_auprc:  0.8753372050665342
Validation loss improved to 0.479358
epoch:  44
epoch:  45 val_f1:  0.7156947373800909 val_auroc:  0.7719685812469317 val_auprc:  0.8834416515808743
EarlyStopping counter: 1 out of 50
epoch:  45
epoch:  46 val_f1:  0.693339873555701 val_auroc:  0.7606774668630338 val_auprc:  0.8731160475849364
EarlyStopping counter: 2 out of 50
epoch:  46
epoch:  47 val_f1:  0.6994072447658564 val_auroc:  0.7653411880216003 val_auprc:  0.8778858224282844
EarlyStopping counter: 3 out of 50
epoch:  47
epoch:  48 val_f1:  0.68520552340289 val_auroc:  0.7614138438880707 val_auprc:  0.8766493015713225
EarlyStopping counter: 4 out of 50
epoch:  48
epoch:  49 val_f1:  0.6966777045653197 val_auroc:  0.7572410407461954 val_auprc:  0.8742448515681336
EarlyStopping counter: 5 out of 50
epoch:  49
epoch:  50 val_f1:  0.6835594973158149 val_auroc:  0.7734413352970054 val_auprc:  0.8836656656444122
EarlyStopping counter: 6 out of 50
epoch:  50
epoch:  51 val_f1:  0.6963686193902022 val_auroc:  0.7592047128129602 val_auprc:  0.8730805418086492
EarlyStopping counter: 7 out of 50
epoch:  51
epoch:  52 val_f1:  0.7215941532488295 val_auroc:  0.7729504172803142 val_auprc:  0.8771103694564262
EarlyStopping counter: 8 out of 50
epoch:  52
epoch:  53 val_f1:  0.7108600244444511 val_auroc:  0.7790868924889544 val_auprc:  0.8879092105831295
EarlyStopping counter: 9 out of 50
epoch:  53
epoch:  54 val_f1:  0.6887363496684735 val_auroc:  0.7825233186057928 val_auprc:  0.8863660007324594
EarlyStopping counter: 10 out of 50
epoch:  54
epoch:  55 val_f1:  0.7039462975939799 val_auroc:  0.7635002454590084 val_auprc:  0.8650297107967259
EarlyStopping counter: 11 out of 50
epoch:  55
epoch:  56 val_f1:  0.7371937993371881 val_auroc:  0.7847324496809034 val_auprc:  0.8835953457615823
EarlyStopping counter: 12 out of 50
epoch:  56
epoch:  57 val_f1:  0.7166299330477814 val_auroc:  0.7658321060382915 val_auprc:  0.8697450249353964
EarlyStopping counter: 13 out of 50
epoch:  57
epoch:  58 val_f1:  0.6598406488264144 val_auroc:  0.7771232204221895 val_auprc:  0.8821433301788266
EarlyStopping counter: 14 out of 50
epoch:  58
epoch:  59 val_f1:  0.708480907581627 val_auroc:  0.7606774668630338 val_auprc:  0.8686481145113543
EarlyStopping counter: 15 out of 50
epoch:  59
epoch:  60 val_f1:  0.7054786939679025 val_auroc:  0.7592047128129602 val_auprc:  0.8732470201248519
EarlyStopping counter: 16 out of 50
epoch:  60
epoch:  61 val_f1:  0.7100860488080124 val_auroc:  0.7550319096710849 val_auprc:  0.8742434064189659
EarlyStopping counter: 17 out of 50
epoch:  61
epoch:  62 val_f1:  0.6926107129156205 val_auroc:  0.7628865979381444 val_auprc:  0.8728914087745439
EarlyStopping counter: 18 out of 50
epoch:  62
epoch:  63 val_f1:  0.7235944791518311 val_auroc:  0.7789641629847815 val_auprc:  0.8811046649445623
EarlyStopping counter: 19 out of 50
epoch:  63
epoch:  64 val_f1:  0.7148475178521729 val_auroc:  0.7679185076092293 val_auprc:  0.8674557065088488
EarlyStopping counter: 20 out of 50
epoch:  64
epoch:  65 val_f1:  0.7140775751491829 val_auroc:  0.7677957781050565 val_auprc:  0.8717914886470219
EarlyStopping counter: 21 out of 50
epoch:  65
epoch:  66 val_f1:  0.7225455998837295 val_auroc:  0.7638684339715268 val_auprc:  0.8648158992448159
EarlyStopping counter: 22 out of 50
epoch:  66
epoch:  67 val_f1:  0.7307106601978622 val_auroc:  0.771232204221895 val_auprc:  0.8750904818125627
EarlyStopping counter: 23 out of 50
epoch:  67
epoch:  68 val_f1:  0.687028943170779 val_auroc:  0.7638684339715268 val_auprc:  0.86732396730081
EarlyStopping counter: 24 out of 50
epoch:  68
epoch:  69 val_f1:  0.7215941532488295 val_auroc:  0.7729504172803142 val_auprc:  0.8798100384186578
EarlyStopping counter: 25 out of 50
epoch:  69
epoch:  70 val_f1:  0.7299542184434271 val_auroc:  0.7785959744722631 val_auprc:  0.8821854212298665
EarlyStopping counter: 26 out of 50
epoch:  70
epoch:  71 val_f1:  0.7088095828755714 val_auroc:  0.7766323024054982 val_auprc:  0.8805729026226095
EarlyStopping counter: 27 out of 50
epoch:  71
epoch:  72 val_f1:  0.7054786939679025 val_auroc:  0.7540500736377025 val_auprc:  0.8601499834010535
EarlyStopping counter: 28 out of 50
epoch:  72
epoch:  73 val_f1:  0.7108600244444511 val_auroc:  0.7685321551300932 val_auprc:  0.8778626732445429
EarlyStopping counter: 29 out of 50
epoch:  73
epoch:  74 val_f1:  0.7157412825720284 val_auroc:  0.7572410407461954 val_auprc:  0.8650573001956814
EarlyStopping counter: 30 out of 50
epoch:  74
epoch:  75 val_f1:  0.7108600244444511 val_auroc:  0.7633775159548356 val_auprc:  0.8697969086844429
EarlyStopping counter: 31 out of 50
epoch:  75
epoch:  76 val_f1:  0.7108600244444511 val_auroc:  0.7641138929798723 val_auprc:  0.8675691085650774
EarlyStopping counter: 32 out of 50
epoch:  76
epoch:  77 val_f1:  0.7203480251458693 val_auroc:  0.757486499754541 val_auprc:  0.8605425800081514
EarlyStopping counter: 33 out of 50
epoch:  77
epoch:  78 val_f1:  0.722058496910722 val_auroc:  0.7577319587628865 val_auprc:  0.8612327424748283
EarlyStopping counter: 34 out of 50
epoch:  78
epoch:  79 val_f1:  0.7283736963917239 val_auroc:  0.7617820324005892 val_auprc:  0.8644898403817206
EarlyStopping counter: 35 out of 50
epoch:  79
epoch:  80 val_f1:  0.7163649790827238 val_auroc:  0.7630093274423171 val_auprc:  0.8667945281384808
EarlyStopping counter: 36 out of 50
epoch:  80
epoch:  81 val_f1:  0.7391701372600277 val_auroc:  0.7654639175257733 val_auprc:  0.867080184534815
EarlyStopping counter: 37 out of 50
epoch:  81
epoch:  82 val_f1:  0.7176437068167247 val_auroc:  0.7608001963672067 val_auprc:  0.8611945399805557
EarlyStopping counter: 38 out of 50
epoch:  82
epoch:  83 val_f1:  0.717230470942395 val_auroc:  0.7635002454590084 val_auprc:  0.8663571195234009
EarlyStopping counter: 39 out of 50
epoch:  83
epoch:  84 val_f1:  0.7235944791518311 val_auroc:  0.7628865979381444 val_auprc:  0.8650410149307372
EarlyStopping counter: 40 out of 50
epoch:  84
epoch:  85 val_f1:  0.7108600244444511 val_auroc:  0.7637457044673539 val_auprc:  0.8647851493090313
EarlyStopping counter: 41 out of 50
epoch:  85
epoch:  86 val_f1:  0.7246795893300292 val_auroc:  0.764359351988218 val_auprc:  0.8663119293301944
EarlyStopping counter: 42 out of 50
epoch:  86
epoch:  87 val_f1:  0.717230470942395 val_auroc:  0.7644820814923907 val_auprc:  0.8647209626942578
EarlyStopping counter: 43 out of 50
epoch:  87
epoch:  88 val_f1:  0.7363119073255568 val_auroc:  0.7642366224840451 val_auprc:  0.8665071390754842
EarlyStopping counter: 44 out of 50
epoch:  88
epoch:  89 val_f1:  0.717230470942395 val_auroc:  0.7617820324005892 val_auprc:  0.865761948363615
EarlyStopping counter: 45 out of 50
epoch:  89
epoch:  90 val_f1:  0.7184536707983012 val_auroc:  0.7639911634756996 val_auprc:  0.8666904577281896
EarlyStopping counter: 46 out of 50
epoch:  90
epoch:  91 val_f1:  0.702782849280763 val_auroc:  0.7614138438880707 val_auprc:  0.8645476370854759
EarlyStopping counter: 47 out of 50
epoch:  91
epoch:  92 val_f1:  0.7328919440906961 val_auroc:  0.7658321060382917 val_auprc:  0.8688772376274272
EarlyStopping counter: 48 out of 50
epoch:  92
epoch:  93 val_f1:  0.7235944791518311 val_auroc:  0.7646048109965636 val_auprc:  0.8639702403494828
EarlyStopping counter: 49 out of 50
epoch:  93
epoch:  94 val_f1:  0.7122302158273381 val_auroc:  0.759941089837997 val_auprc:  0.8583794874871066
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1200.9869010448456
{'time_elapsed': [1200.9869010448456], 'epoch': [93], 'fold': [2], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [0.9999999999999999], 'f1_test': [0.7122302158273381], 'auroc_test': [0.759941089837997], 'auprc_test': [0.8583794874871066]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1280]           2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 1280]           1,024
│    └─Tanh: 2-3                         [64, 512, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1278]           --
│    └─Dropout: 2-5                      [64, 512, 1278]           --
│    └─Flatten: 2-6                      [64, 654336]              --
│    └─Linear: 2-7                       [64, 1]                   654,337
==========================================================================================
Total params: 657,409
Trainable params: 657,409
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 671.09
Params size (MB): 2.63
Estimated Total Size (MB): 674.05
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6083458705955681 val_auroc:  0.716812015503876 val_auprc:  0.8614356381727701
epoch:  1
epoch:  2 val_f1:  0.5572606292648284 val_auroc:  0.6919815891472868 val_auprc:  0.8727464602904298
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6322494278927895 val_auroc:  0.7868217054263567 val_auprc:  0.9085043594872708
Validation loss improved to 1.392140
epoch:  3
epoch:  4 val_f1:  0.709329623679697 val_auroc:  0.778827519379845 val_auprc:  0.8960926108418723
Validation loss improved to 0.751890
epoch:  4
epoch:  5 val_f1:  0.7576331204728416 val_auroc:  0.812015503875969 val_auprc:  0.9160122834597949
Validation loss improved to 0.600599
epoch:  5
epoch:  6 val_f1:  0.7644817479349855 val_auroc:  0.8250968992248062 val_auprc:  0.9199206018246111
Validation loss improved to 0.412991
epoch:  6
epoch:  7 val_f1:  0.7754499696945739 val_auroc:  0.8343023255813955 val_auprc:  0.9211010948995999
Validation loss improved to 0.221806
epoch:  7
epoch:  8 val_f1:  0.7827158008497472 val_auroc:  0.8420542635658914 val_auprc:  0.926320356225172
Validation loss improved to 0.212099
epoch:  8
epoch:  9 val_f1:  0.7711885993597467 val_auroc:  0.8372093023255814 val_auprc:  0.9287176526951013
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.8008946034661633 val_auroc:  0.8381782945736435 val_auprc:  0.9299389810050482
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.7157152443358262 val_auroc:  0.8408430232558138 val_auprc:  0.9315584754966153
EarlyStopping counter: 3 out of 50
epoch:  11
epoch:  12 val_f1:  0.7854893118997625 val_auroc:  0.8449612403100776 val_auprc:  0.9319827052095371
Validation loss improved to 0.135433
epoch:  12
epoch:  13 val_f1:  0.7835226993620948 val_auroc:  0.8481104651162792 val_auprc:  0.9352581960999407
Validation loss improved to 0.118429
epoch:  13
epoch:  14 val_f1:  0.7715550815537892 val_auroc:  0.8498062015503874 val_auprc:  0.9354831499413204
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.794309372388086 val_auroc:  0.8522286821705426 val_auprc:  0.9379337682744586
EarlyStopping counter: 2 out of 50
epoch:  15
epoch:  16 val_f1:  0.7335046248715313 val_auroc:  0.8604651162790697 val_auprc:  0.9394560130640122
EarlyStopping counter: 3 out of 50
epoch:  16
epoch:  17 val_f1:  0.6031983109164842 val_auroc:  0.8628875968992248 val_auprc:  0.9416386895322373
EarlyStopping counter: 4 out of 50
epoch:  17
epoch:  18 val_f1:  0.7912899626822607 val_auroc:  0.8616763565891472 val_auprc:  0.9427383335588976
EarlyStopping counter: 5 out of 50
epoch:  18
epoch:  19 val_f1:  0.7363492257041825 val_auroc:  0.8597383720930233 val_auprc:  0.9385515803972334
EarlyStopping counter: 6 out of 50
epoch:  19
epoch:  20 val_f1:  0.792019787311512 val_auroc:  0.8602228682170544 val_auprc:  0.9380610974615307
EarlyStopping counter: 7 out of 50
epoch:  20
epoch:  21 val_f1:  0.7793492478744277 val_auroc:  0.8650678294573644 val_auprc:  0.9430809597254983
EarlyStopping counter: 8 out of 50
epoch:  21
epoch:  22 val_f1:  0.794309372388086 val_auroc:  0.8667635658914729 val_auprc:  0.9447111565956714
Validation loss improved to 0.116109
epoch:  22
epoch:  23 val_f1:  0.8018807955038493 val_auroc:  0.8653100775193798 val_auprc:  0.9445721687684685
Validation loss improved to 0.102290
epoch:  23
epoch:  24 val_f1:  0.7906801532257888 val_auroc:  0.8737887596899224 val_auprc:  0.9465552282611984
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7793492478744277 val_auroc:  0.876453488372093 val_auprc:  0.9479401721811533
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.7866727894280321 val_auroc:  0.8779069767441859 val_auprc:  0.948969433812476
EarlyStopping counter: 3 out of 50
epoch:  26
epoch:  27 val_f1:  0.7793492478744277 val_auroc:  0.8766957364341085 val_auprc:  0.9489049352937025
EarlyStopping counter: 4 out of 50
epoch:  27
epoch:  28 val_f1:  0.7892012988311853 val_auroc:  0.876937984496124 val_auprc:  0.9499312150350877
EarlyStopping counter: 5 out of 50
epoch:  28
epoch:  29 val_f1:  0.8093907785715628 val_auroc:  0.878391472868217 val_auprc:  0.949717133404607
EarlyStopping counter: 6 out of 50
epoch:  29
epoch:  30 val_f1:  0.7414744243025527 val_auroc:  0.8752422480620156 val_auprc:  0.9479192346369198
EarlyStopping counter: 7 out of 50
epoch:  30
epoch:  31 val_f1:  0.8242406937262959 val_auroc:  0.872577519379845 val_auprc:  0.9469825039037594
EarlyStopping counter: 8 out of 50
epoch:  31
epoch:  32 val_f1:  0.8168429178951009 val_auroc:  0.8737887596899224 val_auprc:  0.9475112321846725
EarlyStopping counter: 9 out of 50
epoch:  32
epoch:  33 val_f1:  0.7429991933226874 val_auroc:  0.877422480620155 val_auprc:  0.9488856737174326
EarlyStopping counter: 10 out of 50
epoch:  33
epoch:  34 val_f1:  0.7713093666729185 val_auroc:  0.8742732558139535 val_auprc:  0.9453475467890387
EarlyStopping counter: 11 out of 50
epoch:  34
epoch:  35 val_f1:  0.7811109002295425 val_auroc:  0.8776647286821705 val_auprc:  0.9492963741342111
EarlyStopping counter: 12 out of 50
epoch:  35
epoch:  36 val_f1:  0.7997900244397783 val_auroc:  0.8752422480620156 val_auprc:  0.9491325916039282
EarlyStopping counter: 13 out of 50
epoch:  36
epoch:  37 val_f1:  0.7427571456348435 val_auroc:  0.8723352713178295 val_auprc:  0.9479216094212426
EarlyStopping counter: 14 out of 50
epoch:  37
epoch:  38 val_f1:  0.8191179676579591 val_auroc:  0.8733042635658914 val_auprc:  0.9469290421256309
EarlyStopping counter: 15 out of 50
epoch:  38
epoch:  39 val_f1:  0.7427571456348435 val_auroc:  0.8701550387596898 val_auprc:  0.9445783865811681
EarlyStopping counter: 16 out of 50
epoch:  39
epoch:  40 val_f1:  0.8207067131995794 val_auroc:  0.873546511627907 val_auprc:  0.9476440662335419
EarlyStopping counter: 17 out of 50
epoch:  40
epoch:  41 val_f1:  0.8093907785715628 val_auroc:  0.874031007751938 val_auprc:  0.9459096441456355
EarlyStopping counter: 18 out of 50
epoch:  41
epoch:  42 val_f1:  0.8051160047274586 val_auroc:  0.874515503875969 val_auprc:  0.9465801695856444
EarlyStopping counter: 19 out of 50
epoch:  42
epoch:  43 val_f1:  0.7952715769842713 val_auroc:  0.8740310077519381 val_auprc:  0.946889305378375
EarlyStopping counter: 20 out of 50
epoch:  43
epoch:  44 val_f1:  0.8022252248962252 val_auroc:  0.8771802325581395 val_auprc:  0.9481774932763127
EarlyStopping counter: 21 out of 50
epoch:  44
epoch:  45 val_f1:  0.7774211400110681 val_auroc:  0.8737887596899224 val_auprc:  0.9457756556588619
EarlyStopping counter: 22 out of 50
epoch:  45
epoch:  46 val_f1:  0.8108668046482106 val_auroc:  0.8747577519379846 val_auprc:  0.9465791188545315
EarlyStopping counter: 23 out of 50
epoch:  46
epoch:  47 val_f1:  0.8018807955038493 val_auroc:  0.877422480620155 val_auprc:  0.9468753217392889
Validation loss improved to 0.100779
epoch:  47
epoch:  48 val_f1:  0.7730210108542735 val_auroc:  0.8788759689922482 val_auprc:  0.9472677699016268
EarlyStopping counter: 1 out of 50
epoch:  48
epoch:  49 val_f1:  0.794309372388086 val_auroc:  0.8740310077519379 val_auprc:  0.9459493681252962
EarlyStopping counter: 2 out of 50
epoch:  49
epoch:  50 val_f1:  0.7968569383258559 val_auroc:  0.872093023255814 val_auprc:  0.9457301059157119
EarlyStopping counter: 3 out of 50
epoch:  50
epoch:  51 val_f1:  0.7666659578740948 val_auroc:  0.8737887596899225 val_auprc:  0.9453865920587297
EarlyStopping counter: 4 out of 50
epoch:  51
epoch:  52 val_f1:  0.764639197732723 val_auroc:  0.8640988372093024 val_auprc:  0.9411853224490605
EarlyStopping counter: 5 out of 50
epoch:  52
epoch:  53 val_f1:  0.7997900244397783 val_auroc:  0.8682170542635659 val_auprc:  0.9417750601516864
EarlyStopping counter: 6 out of 50
epoch:  53
epoch:  54 val_f1:  0.7877294237541244 val_auroc:  0.8723352713178295 val_auprc:  0.9453026149525015
EarlyStopping counter: 7 out of 50
epoch:  54
epoch:  55 val_f1:  0.8008946034661633 val_auroc:  0.8737887596899225 val_auprc:  0.9467753230376417
EarlyStopping counter: 8 out of 50
epoch:  55
epoch:  56 val_f1:  0.8093907785715628 val_auroc:  0.8747577519379846 val_auprc:  0.9473401572051031
EarlyStopping counter: 9 out of 50
epoch:  56
epoch:  57 val_f1:  0.8195518562291283 val_auroc:  0.8781492248062015 val_auprc:  0.9478597530074375
EarlyStopping counter: 10 out of 50
epoch:  57
epoch:  58 val_f1:  0.8093907785715628 val_auroc:  0.8749999999999999 val_auprc:  0.9472428159195048
EarlyStopping counter: 11 out of 50
epoch:  58
epoch:  59 val_f1:  0.8018807955038493 val_auroc:  0.8733042635658915 val_auprc:  0.9455082839639537
EarlyStopping counter: 12 out of 50
epoch:  59
epoch:  60 val_f1:  0.7875752415552048 val_auroc:  0.8728197674418604 val_auprc:  0.9453313570932916
EarlyStopping counter: 13 out of 50
epoch:  60
epoch:  61 val_f1:  0.7710202043822609 val_auroc:  0.8747577519379844 val_auprc:  0.9463489377033901
EarlyStopping counter: 14 out of 50
epoch:  61
epoch:  62 val_f1:  0.7985611510791367 val_auroc:  0.8742732558139535 val_auprc:  0.946368098197124
EarlyStopping counter: 15 out of 50
epoch:  62
epoch:  63 val_f1:  0.8037391402911035 val_auroc:  0.8776647286821705 val_auprc:  0.9478961161723946
EarlyStopping counter: 16 out of 50
epoch:  63
epoch:  64 val_f1:  0.7793492478744277 val_auroc:  0.8759689922480621 val_auprc:  0.9471231466292502
EarlyStopping counter: 17 out of 50
epoch:  64
epoch:  65 val_f1:  0.7793492478744277 val_auroc:  0.8779069767441859 val_auprc:  0.9483558084637079
EarlyStopping counter: 18 out of 50
epoch:  65
epoch:  66 val_f1:  0.768937708914086 val_auroc:  0.878391472868217 val_auprc:  0.9488354734205849
EarlyStopping counter: 19 out of 50
epoch:  66
epoch:  67 val_f1:  0.8037391402911035 val_auroc:  0.8757267441860465 val_auprc:  0.9463285017754716
EarlyStopping counter: 20 out of 50
epoch:  67
epoch:  68 val_f1:  0.7957035068809065 val_auroc:  0.8774224806201549 val_auprc:  0.9472149771057788
EarlyStopping counter: 21 out of 50
epoch:  68
epoch:  69 val_f1:  0.8037391402911035 val_auroc:  0.8745155038759689 val_auprc:  0.9463964373510925
EarlyStopping counter: 22 out of 50
epoch:  69
epoch:  70 val_f1:  0.7957035068809065 val_auroc:  0.8752422480620156 val_auprc:  0.946569889027015
EarlyStopping counter: 23 out of 50
epoch:  70
epoch:  71 val_f1:  0.8027539115793398 val_auroc:  0.8764534883720929 val_auprc:  0.9466283739896109
EarlyStopping counter: 24 out of 50
epoch:  71
epoch:  72 val_f1:  0.8084949329130455 val_auroc:  0.8774224806201549 val_auprc:  0.9472790588327403
EarlyStopping counter: 25 out of 50
epoch:  72
epoch:  73 val_f1:  0.8037391402911035 val_auroc:  0.875968992248062 val_auprc:  0.9472691611270709
EarlyStopping counter: 26 out of 50
epoch:  73
epoch:  74 val_f1:  0.7997900244397783 val_auroc:  0.8745155038759689 val_auprc:  0.9470617001249003
EarlyStopping counter: 27 out of 50
epoch:  74
epoch:  75 val_f1:  0.8063632502555458 val_auroc:  0.877422480620155 val_auprc:  0.9477767525844802
EarlyStopping counter: 28 out of 50
epoch:  75
epoch:  76 val_f1:  0.8037391402911035 val_auroc:  0.8781492248062016 val_auprc:  0.9478697004539115
EarlyStopping counter: 29 out of 50
epoch:  76
epoch:  77 val_f1:  0.7957035068809065 val_auroc:  0.8742732558139534 val_auprc:  0.946027828813153
EarlyStopping counter: 30 out of 50
epoch:  77
epoch:  78 val_f1:  0.8037391402911035 val_auroc:  0.877422480620155 val_auprc:  0.9478196859869154
EarlyStopping counter: 31 out of 50
epoch:  78
epoch:  79 val_f1:  0.7875752415552048 val_auroc:  0.8757267441860465 val_auprc:  0.9461771656160212
EarlyStopping counter: 32 out of 50
epoch:  79
epoch:  80 val_f1:  0.7875752415552048 val_auroc:  0.875 val_auprc:  0.9457814218521218
EarlyStopping counter: 33 out of 50
epoch:  80
epoch:  81 val_f1:  0.7940592980161325 val_auroc:  0.8752422480620156 val_auprc:  0.9457466326080145
EarlyStopping counter: 34 out of 50
epoch:  81
epoch:  82 val_f1:  0.7875752415552048 val_auroc:  0.875484496124031 val_auprc:  0.9467348375365998
EarlyStopping counter: 35 out of 50
epoch:  82
epoch:  83 val_f1:  0.8051160047274586 val_auroc:  0.875 val_auprc:  0.9467321199654621
EarlyStopping counter: 36 out of 50
epoch:  83
epoch:  84 val_f1:  0.8051160047274586 val_auroc:  0.874515503875969 val_auprc:  0.9459501279046196
EarlyStopping counter: 37 out of 50
epoch:  84
epoch:  85 val_f1:  0.7957035068809065 val_auroc:  0.8742732558139534 val_auprc:  0.9461218819143926
EarlyStopping counter: 38 out of 50
epoch:  85
epoch:  86 val_f1:  0.7875752415552048 val_auroc:  0.8701550387596899 val_auprc:  0.9432263960567948
EarlyStopping counter: 39 out of 50
epoch:  86
epoch:  87 val_f1:  0.8037391402911035 val_auroc:  0.8733042635658914 val_auprc:  0.9455543946817413
EarlyStopping counter: 40 out of 50
epoch:  87
epoch:  88 val_f1:  0.7875752415552048 val_auroc:  0.874031007751938 val_auprc:  0.9454539983518778
EarlyStopping counter: 41 out of 50
epoch:  88
epoch:  89 val_f1:  0.8037391402911035 val_auroc:  0.8742732558139534 val_auprc:  0.9460187941648179
EarlyStopping counter: 42 out of 50
epoch:  89
epoch:  90 val_f1:  0.8037391402911035 val_auroc:  0.8733042635658914 val_auprc:  0.9453947798931833
EarlyStopping counter: 43 out of 50
epoch:  90
epoch:  91 val_f1:  0.7932273763653603 val_auroc:  0.873546511627907 val_auprc:  0.9454076672906716
EarlyStopping counter: 44 out of 50
epoch:  91
epoch:  92 val_f1:  0.7985611510791367 val_auroc:  0.8752422480620156 val_auprc:  0.946197552959942
EarlyStopping counter: 45 out of 50
epoch:  92
epoch:  93 val_f1:  0.7875752415552048 val_auroc:  0.8711240310077519 val_auprc:  0.9435474351351395
EarlyStopping counter: 46 out of 50
epoch:  93
epoch:  94 val_f1:  0.8008946034661633 val_auroc:  0.872577519379845 val_auprc:  0.9450110465137486
EarlyStopping counter: 47 out of 50
epoch:  94
epoch:  95 val_f1:  0.7997900244397783 val_auroc:  0.8718507751937984 val_auprc:  0.9446534077723899
EarlyStopping counter: 48 out of 50
epoch:  95
epoch:  96 val_f1:  0.7957035068809065 val_auroc:  0.8708817829457364 val_auprc:  0.9434588577807613
EarlyStopping counter: 49 out of 50
epoch:  96
epoch:  97 val_f1:  0.8037391402911035 val_auroc:  0.8747577519379846 val_auprc:  0.946081003112168
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1239.0411095619202
{'time_elapsed': [1239.0411095619202], 'epoch': [96], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8037391402911035], 'auroc_test': [0.8747577519379846], 'auprc_test': [0.946081003112168]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1280]           2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 1280]           1,024
│    └─Tanh: 2-3                         [64, 512, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1278]           --
│    └─Dropout: 2-5                      [64, 512, 1278]           --
│    └─Flatten: 2-6                      [64, 654336]              --
│    └─Linear: 2-7                       [64, 1]                   654,337
==========================================================================================
Total params: 657,409
Trainable params: 657,409
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 671.09
Params size (MB): 2.63
Estimated Total Size (MB): 674.05
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5707915273132664 val_auroc:  0.679811507936508 val_auprc:  0.8624130336708151
epoch:  1
epoch:  2 val_f1:  0.7037557542168251 val_auroc:  0.6577380952380952 val_auprc:  0.8263060071505094
Validation loss improved to 3.286510
epoch:  2
epoch:  3 val_f1:  0.7081042078910257 val_auroc:  0.6376488095238095 val_auprc:  0.7926134977355108
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6641897233201581 val_auroc:  0.6578621031746031 val_auprc:  0.775210478264088
Validation loss improved to 2.390158
epoch:  4
epoch:  5 val_f1:  0.6242046659597029 val_auroc:  0.7253224206349206 val_auprc:  0.812963172310821
Validation loss improved to 1.497199
epoch:  5
epoch:  6 val_f1:  0.7746271791640412 val_auroc:  0.8092757936507936 val_auprc:  0.9012953555150065
Validation loss improved to 0.829077
epoch:  6
epoch:  7 val_f1:  0.7781291172595521 val_auroc:  0.839781746031746 val_auprc:  0.9281609650941909
Validation loss improved to 0.705586
epoch:  7
epoch:  8 val_f1:  0.5686230170966526 val_auroc:  0.8635912698412698 val_auprc:  0.9388179085663335
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7852367336641158 val_auroc:  0.867311507936508 val_auprc:  0.9394678805361767
Validation loss improved to 0.366576
epoch:  9
epoch:  10 val_f1:  0.763388123011665 val_auroc:  0.8697916666666667 val_auprc:  0.9406120754966916
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.7773608267060336 val_auroc:  0.8683035714285714 val_auprc:  0.9383265744233491
EarlyStopping counter: 2 out of 50
epoch:  11
epoch:  12 val_f1:  0.7564718869066693 val_auroc:  0.8623511904761905 val_auprc:  0.9307799208453863
EarlyStopping counter: 3 out of 50
epoch:  12
epoch:  13 val_f1:  0.6480090810304222 val_auroc:  0.8566468253968255 val_auprc:  0.9279338778100891
EarlyStopping counter: 4 out of 50
epoch:  13
epoch:  14 val_f1:  0.7729303439448368 val_auroc:  0.8675595238095238 val_auprc:  0.9369123956972147
Validation loss improved to 0.267548
epoch:  14
epoch:  15 val_f1:  0.7615325563542467 val_auroc:  0.8648313492063493 val_auprc:  0.9358367406326227
Validation loss improved to 0.252254
epoch:  15
epoch:  16 val_f1:  0.7786691885085516 val_auroc:  0.861359126984127 val_auprc:  0.9297518464061106
Validation loss improved to 0.230835
epoch:  16
epoch:  17 val_f1:  0.7905459035188288 val_auroc:  0.8581349206349207 val_auprc:  0.9287873097195678
Validation loss improved to 0.229997
epoch:  17
epoch:  18 val_f1:  0.7299698774465978 val_auroc:  0.863343253968254 val_auprc:  0.9335566095345346
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7564718869066693 val_auroc:  0.8616071428571429 val_auprc:  0.9335516751490496
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.795635738397158 val_auroc:  0.8608630952380952 val_auprc:  0.9293809332034979
Validation loss improved to 0.196966
epoch:  20
epoch:  21 val_f1:  0.792371879328401 val_auroc:  0.8598710317460319 val_auprc:  0.9281323881907875
Validation loss improved to 0.187393
epoch:  21
epoch:  22 val_f1:  0.8036150464093796 val_auroc:  0.8683035714285714 val_auprc:  0.9345565296468322
Validation loss improved to 0.165485
epoch:  22
epoch:  23 val_f1:  0.8170893719806764 val_auroc:  0.8673115079365079 val_auprc:  0.9331607910441322
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7619195555090884 val_auroc:  0.8675595238095238 val_auprc:  0.9310023447986373
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.4811076467790519 val_auroc:  0.8663194444444445 val_auprc:  0.9298524589013902
EarlyStopping counter: 3 out of 50
epoch:  25
epoch:  26 val_f1:  0.7189743268236106 val_auroc:  0.8700396825396826 val_auprc:  0.9347154772061246
EarlyStopping counter: 4 out of 50
epoch:  26
epoch:  27 val_f1:  0.7285782956786951 val_auroc:  0.8790922619047619 val_auprc:  0.9381831701522871
EarlyStopping counter: 5 out of 50
epoch:  27
epoch:  28 val_f1:  0.7781291172595521 val_auroc:  0.8774801587301587 val_auprc:  0.9343367476297783
EarlyStopping counter: 6 out of 50
epoch:  28
epoch:  29 val_f1:  0.7837062051498522 val_auroc:  0.8670634920634921 val_auprc:  0.9270643909781145
EarlyStopping counter: 7 out of 50
epoch:  29
epoch:  30 val_f1:  0.7775412992804297 val_auroc:  0.8722718253968255 val_auprc:  0.9297824658115627
EarlyStopping counter: 8 out of 50
epoch:  30
epoch:  31 val_f1:  0.7819511139952413 val_auroc:  0.8720238095238096 val_auprc:  0.9299959653514719
EarlyStopping counter: 9 out of 50
epoch:  31
epoch:  32 val_f1:  0.8113104975093783 val_auroc:  0.8660714285714285 val_auprc:  0.9257137468359615
EarlyStopping counter: 10 out of 50
epoch:  32
epoch:  33 val_f1:  0.7908726763630708 val_auroc:  0.8673115079365079 val_auprc:  0.9274201723065899
EarlyStopping counter: 11 out of 50
epoch:  33
epoch:  34 val_f1:  0.33850931677018636 val_auroc:  0.861359126984127 val_auprc:  0.9215330438187688
EarlyStopping counter: 12 out of 50
epoch:  34
epoch:  35 val_f1:  0.6618993135011443 val_auroc:  0.871031746031746 val_auprc:  0.9392315780082497
EarlyStopping counter: 13 out of 50
epoch:  35
epoch:  36 val_f1:  0.6447060979520777 val_auroc:  0.8821924603174603 val_auprc:  0.9398794872983067
EarlyStopping counter: 14 out of 50
epoch:  36
epoch:  37 val_f1:  0.7939770374552984 val_auroc:  0.8690476190476191 val_auprc:  0.9335668727755955
EarlyStopping counter: 15 out of 50
epoch:  37
epoch:  38 val_f1:  0.8014350667803353 val_auroc:  0.8660714285714285 val_auprc:  0.9306603258658032
EarlyStopping counter: 16 out of 50
epoch:  38
epoch:  39 val_f1:  0.8054462242562929 val_auroc:  0.884920634920635 val_auprc:  0.9426716059750545
EarlyStopping counter: 17 out of 50
epoch:  39
epoch:  40 val_f1:  0.8088065661047027 val_auroc:  0.876984126984127 val_auprc:  0.9320493626380845
EarlyStopping counter: 18 out of 50
epoch:  40
epoch:  41 val_f1:  0.7772795841859215 val_auroc:  0.8687996031746033 val_auprc:  0.9291133167515121
EarlyStopping counter: 19 out of 50
epoch:  41
epoch:  42 val_f1:  0.7755148741418765 val_auroc:  0.863343253968254 val_auprc:  0.9225927568046259
EarlyStopping counter: 20 out of 50
epoch:  42
epoch:  43 val_f1:  0.8036760694501368 val_auroc:  0.863467261904762 val_auprc:  0.9222565330959662
EarlyStopping counter: 21 out of 50
epoch:  43
epoch:  44 val_f1:  0.7839990466164816 val_auroc:  0.8643353174603174 val_auprc:  0.9247675186030295
EarlyStopping counter: 22 out of 50
epoch:  44
epoch:  45 val_f1:  0.7819511139952413 val_auroc:  0.863343253968254 val_auprc:  0.9225007235230188
EarlyStopping counter: 23 out of 50
epoch:  45
epoch:  46 val_f1:  0.7949078298424175 val_auroc:  0.8638392857142857 val_auprc:  0.9242931643670751
EarlyStopping counter: 24 out of 50
epoch:  46
epoch:  47 val_f1:  0.7949078298424175 val_auroc:  0.8621031746031746 val_auprc:  0.9209687702460794
EarlyStopping counter: 25 out of 50
epoch:  47
epoch:  48 val_f1:  0.7875799991742021 val_auroc:  0.8642113095238094 val_auprc:  0.9213263950176438
EarlyStopping counter: 26 out of 50
epoch:  48
epoch:  49 val_f1:  0.8022296544035674 val_auroc:  0.8660714285714286 val_auprc:  0.9222162109160381
EarlyStopping counter: 27 out of 50
epoch:  49
epoch:  50 val_f1:  0.7819511139952413 val_auroc:  0.8707837301587302 val_auprc:  0.9249081373899062
EarlyStopping counter: 28 out of 50
epoch:  50
epoch:  51 val_f1:  0.7819511139952413 val_auroc:  0.8699156746031746 val_auprc:  0.9245956999152083
EarlyStopping counter: 29 out of 50
epoch:  51
epoch:  52 val_f1:  0.7861608411480533 val_auroc:  0.8673115079365079 val_auprc:  0.9248276543203642
EarlyStopping counter: 30 out of 50
epoch:  52
epoch:  53 val_f1:  0.8290790088826556 val_auroc:  0.8718998015873016 val_auprc:  0.9227082542017595
EarlyStopping counter: 31 out of 50
epoch:  53
epoch:  54 val_f1:  0.822380909337431 val_auroc:  0.873139880952381 val_auprc:  0.9280987960292925
EarlyStopping counter: 32 out of 50
epoch:  54
epoch:  55 val_f1:  0.7839990466164816 val_auroc:  0.8690476190476191 val_auprc:  0.924597896123724
EarlyStopping counter: 33 out of 50
epoch:  55
epoch:  56 val_f1:  0.7884143290944841 val_auroc:  0.8690476190476191 val_auprc:  0.9257823582743949
EarlyStopping counter: 34 out of 50
epoch:  56
epoch:  57 val_f1:  0.7861608411480533 val_auroc:  0.8700396825396826 val_auprc:  0.92592227293502
EarlyStopping counter: 35 out of 50
epoch:  57
epoch:  58 val_f1:  0.7904805491990847 val_auroc:  0.8686755952380952 val_auprc:  0.9243311096974964
EarlyStopping counter: 36 out of 50
epoch:  58
epoch:  59 val_f1:  0.7949078298424175 val_auroc:  0.8658234126984128 val_auprc:  0.9227684774586781
EarlyStopping counter: 37 out of 50
epoch:  59
epoch:  60 val_f1:  0.7772795841859215 val_auroc:  0.8687996031746031 val_auprc:  0.926044646029329
EarlyStopping counter: 38 out of 50
epoch:  60
epoch:  61 val_f1:  0.7904805491990847 val_auroc:  0.8700396825396824 val_auprc:  0.9258033418981247
EarlyStopping counter: 39 out of 50
epoch:  61
epoch:  62 val_f1:  0.791810443984357 val_auroc:  0.8659474206349207 val_auprc:  0.9191099830218674
EarlyStopping counter: 40 out of 50
epoch:  62
epoch:  63 val_f1:  0.8061683443992288 val_auroc:  0.8709077380952381 val_auprc:  0.9234484707740972
EarlyStopping counter: 41 out of 50
epoch:  63
epoch:  64 val_f1:  0.8036760694501368 val_auroc:  0.8725198412698413 val_auprc:  0.9261423563449488
EarlyStopping counter: 42 out of 50
epoch:  64
epoch:  65 val_f1:  0.792371879328401 val_auroc:  0.8704117063492065 val_auprc:  0.9254270842093565
EarlyStopping counter: 43 out of 50
epoch:  65
epoch:  66 val_f1:  0.7904805491990847 val_auroc:  0.8685515873015874 val_auprc:  0.9240044868114963
EarlyStopping counter: 44 out of 50
epoch:  66
epoch:  67 val_f1:  0.7839990466164816 val_auroc:  0.8685515873015872 val_auprc:  0.9217432661113455
EarlyStopping counter: 45 out of 50
epoch:  67
epoch:  68 val_f1:  0.792371879328401 val_auroc:  0.8671875 val_auprc:  0.924198604001968
EarlyStopping counter: 46 out of 50
epoch:  68
epoch:  69 val_f1:  0.7904805491990847 val_auroc:  0.8685515873015872 val_auprc:  0.9232742819820037
EarlyStopping counter: 47 out of 50
epoch:  69
epoch:  70 val_f1:  0.7940993788819876 val_auroc:  0.8680555555555556 val_auprc:  0.924643302161435
EarlyStopping counter: 48 out of 50
epoch:  70
epoch:  71 val_f1:  0.7971014492753623 val_auroc:  0.8676835317460316 val_auprc:  0.9219607797998287
EarlyStopping counter: 49 out of 50
epoch:  71
epoch:  72 val_f1:  0.8102677351291666 val_auroc:  0.8694196428571428 val_auprc:  0.9253558246084922
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  918.1401629447937
{'time_elapsed': [918.1401629447937], 'epoch': [71], 'fold': [4], 'f1_train': [0.9982029282297181], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8102677351291666], 'auroc_test': [0.8694196428571428], 'auprc_test': [0.9253558246084922]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 1280]           2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 1280]           1,024
│    └─Tanh: 2-3                         [64, 512, 1280]           --
│    └─MaxPool1d: 2-4                    [64, 512, 1278]           --
│    └─Dropout: 2-5                      [64, 512, 1278]           --
│    └─Flatten: 2-6                      [64, 654336]              --
│    └─Linear: 2-7                       [64, 1]                   654,337
==========================================================================================
Total params: 657,409
Trainable params: 657,409
Non-trainable params: 0
Total mult-adds (M): 209.72
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 671.09
Params size (MB): 2.63
Estimated Total Size (MB): 674.05
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_29', 'config': {'hidden_channels': [512], 'epochs': 500, 'kernel_size': 3, 'pool_kernel_size': 3, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.6647029945999018 val_auprc:  0.7881471009404779
epoch:  1
epoch:  2 val_f1:  0.6341426858513189 val_auroc:  0.676485027000491 val_auprc:  0.8336339658076447
Validation loss improved to 1.725079
epoch:  2
epoch:  3 val_f1:  0.6616621115306476 val_auroc:  0.7160039273441335 val_auprc:  0.8639552663497625
Validation loss improved to 1.278401
epoch:  3
epoch:  4 val_f1:  0.7295632867761842 val_auroc:  0.7609229258713796 val_auprc:  0.890518612442414
Validation loss improved to 1.199883
epoch:  4
epoch:  5 val_f1:  0.7101890414000308 val_auroc:  0.7751595483554247 val_auprc:  0.893392497852276
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.7455074238481555 val_auroc:  0.783014236622484 val_auprc:  0.8968931429397262
Validation loss improved to 1.183244
epoch:  6
epoch:  7 val_f1:  0.7617596949267598 val_auroc:  0.7876779577810505 val_auprc:  0.9027298639870587
Validation loss improved to 1.131207
epoch:  7
epoch:  8 val_f1:  0.7542604103291037 val_auroc:  0.7984781541482572 val_auprc:  0.9105483040216705
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7325045643526866 val_auroc:  0.8051055473735886 val_auprc:  0.9152956199269628
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.7304528631430115 val_auroc:  0.8075601374570447 val_auprc:  0.9158435980854546
Validation loss improved to 1.077742
epoch:  10
epoch:  11 val_f1:  0.7346924658075737 val_auroc:  0.8092783505154639 val_auprc:  0.9181906469520591
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7580594896895918 val_auroc:  0.8075601374570446 val_auprc:  0.9154163292962766
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.708480907581627 val_auroc:  0.8058419243986255 val_auprc:  0.9145098245722103
EarlyStopping counter: 3 out of 50
epoch:  13
epoch:  14 val_f1:  0.7596459003010357 val_auroc:  0.8087874324987727 val_auprc:  0.9166455268859599
EarlyStopping counter: 4 out of 50
epoch:  14
epoch:  15 val_f1:  0.7569659388768054 val_auroc:  0.8139420716740305 val_auprc:  0.9194263013667128
EarlyStopping counter: 5 out of 50
epoch:  15
epoch:  16 val_f1:  0.7633714058926586 val_auroc:  0.810505645557192 val_auprc:  0.9154344795771879
EarlyStopping counter: 6 out of 50
epoch:  16
epoch:  17 val_f1:  0.7428255465713769 val_auroc:  0.8132056946489936 val_auprc:  0.9164009658134791
EarlyStopping counter: 7 out of 50
epoch:  17
epoch:  18 val_f1:  0.7367608586927249 val_auroc:  0.8186057928325969 val_auprc:  0.9221755952866436
EarlyStopping counter: 8 out of 50
epoch:  18
epoch:  19 val_f1:  0.710128282915836 val_auroc:  0.8215513009327443 val_auprc:  0.9245609784106698
EarlyStopping counter: 9 out of 50
epoch:  19
epoch:  20 val_f1:  0.7170452552783244 val_auroc:  0.8134511536573392 val_auprc:  0.9177317860616281
EarlyStopping counter: 10 out of 50
epoch:  20
epoch:  21 val_f1:  0.7371937993371881 val_auroc:  0.8136966126656847 val_auprc:  0.9201195973110914
EarlyStopping counter: 11 out of 50
epoch:  21
epoch:  22 val_f1:  0.7307106601978622 val_auroc:  0.812960235640648 val_auprc:  0.9165664438635969
EarlyStopping counter: 12 out of 50
epoch:  22
epoch:  23 val_f1:  0.7236892364125374 val_auroc:  0.822287677957781 val_auprc:  0.9248412209621442
EarlyStopping counter: 13 out of 50
epoch:  23
epoch:  24 val_f1:  0.730071543320129 val_auroc:  0.8119783996072656 val_auprc:  0.9174038029862828
EarlyStopping counter: 14 out of 50
epoch:  24
epoch:  25 val_f1:  0.7362024088594293 val_auroc:  0.8087874324987727 val_auprc:  0.9150209495338673
EarlyStopping counter: 15 out of 50
epoch:  25
epoch:  26 val_f1:  0.748656020238754 val_auroc:  0.8203240058910162 val_auprc:  0.9231239077835612
EarlyStopping counter: 16 out of 50
epoch:  26
epoch:  27 val_f1:  0.7466980132583976 val_auroc:  0.8097692685321551 val_auprc:  0.9143229375041575
EarlyStopping counter: 17 out of 50
epoch:  27
epoch:  28 val_f1:  0.7506155503404762 val_auroc:  0.8156602847324497 val_auprc:  0.9203765179855787
EarlyStopping counter: 18 out of 50
epoch:  28
epoch:  29 val_f1:  0.7337314237416728 val_auroc:  0.8146784486990672 val_auprc:  0.920015524778382
EarlyStopping counter: 19 out of 50
epoch:  29
epoch:  30 val_f1:  0.7426698176342648 val_auroc:  0.804860088365243 val_auprc:  0.9113529673623281
EarlyStopping counter: 20 out of 50
epoch:  30
epoch:  31 val_f1:  0.7441671543148256 val_auroc:  0.8112420225822288 val_auprc:  0.9168431235015728
EarlyStopping counter: 21 out of 50
epoch:  31
epoch:  32 val_f1:  0.7326256806616418 val_auroc:  0.8122238586156112 val_auprc:  0.9159356992209275
EarlyStopping counter: 22 out of 50
epoch:  32
epoch:  33 val_f1:  0.7426698176342648 val_auroc:  0.810505645557192 val_auprc:  0.9170794072750253
EarlyStopping counter: 23 out of 50
epoch:  33
epoch:  34 val_f1:  0.7328919440906961 val_auroc:  0.8033873343151694 val_auprc:  0.910379116241888
EarlyStopping counter: 24 out of 50
epoch:  34
epoch:  35 val_f1:  0.7496568898727172 val_auroc:  0.8006872852233677 val_auprc:  0.9082601474529687
EarlyStopping counter: 25 out of 50
epoch:  35
epoch:  36 val_f1:  0.7412236216203913 val_auroc:  0.8181148748159057 val_auprc:  0.920926932749575
EarlyStopping counter: 26 out of 50
epoch:  36
epoch:  37 val_f1:  0.7446689355102744 val_auroc:  0.8127147766323024 val_auprc:  0.9147886544236851
EarlyStopping counter: 27 out of 50
epoch:  37
epoch:  38 val_f1:  0.7390688025474315 val_auroc:  0.8146784486990672 val_auprc:  0.9178017502365231
EarlyStopping counter: 28 out of 50
epoch:  38
epoch:  39 val_f1:  0.751751326211758 val_auroc:  0.8085419734904271 val_auprc:  0.9152890490003543
EarlyStopping counter: 29 out of 50
epoch:  39
epoch:  40 val_f1:  0.7454557504588546 val_auroc:  0.8065783014236623 val_auprc:  0.9148229702279016
EarlyStopping counter: 30 out of 50
epoch:  40
epoch:  41 val_f1:  0.7454557504588546 val_auroc:  0.8102601865488464 val_auprc:  0.9165875581588855
EarlyStopping counter: 31 out of 50
epoch:  41
epoch:  42 val_f1:  0.7313689473952751 val_auroc:  0.8151693667157585 val_auprc:  0.9154366910829348
EarlyStopping counter: 32 out of 50
epoch:  42
epoch:  43 val_f1:  0.7410071942446043 val_auroc:  0.807314678448699 val_auprc:  0.9145162198708188
EarlyStopping counter: 33 out of 50
epoch:  43
epoch:  44 val_f1:  0.7617596949267598 val_auroc:  0.8178694158075602 val_auprc:  0.9185247653293379
EarlyStopping counter: 34 out of 50
epoch:  44
epoch:  45 val_f1:  0.7346891520614657 val_auroc:  0.8149239077074129 val_auprc:  0.9208486166555351
EarlyStopping counter: 35 out of 50
epoch:  45
epoch:  46 val_f1:  0.7363119073255568 val_auroc:  0.804860088365243 val_auprc:  0.911128102502698
EarlyStopping counter: 36 out of 50
epoch:  46
epoch:  47 val_f1:  0.7363119073255568 val_auroc:  0.8151693667157585 val_auprc:  0.9186573136170695
EarlyStopping counter: 37 out of 50
epoch:  47
epoch:  48 val_f1:  0.7410071942446043 val_auroc:  0.8127147766323024 val_auprc:  0.9166260688505685
EarlyStopping counter: 38 out of 50
epoch:  48
epoch:  49 val_f1:  0.7337314237416728 val_auroc:  0.8154148257241041 val_auprc:  0.9182012306226324
EarlyStopping counter: 39 out of 50
epoch:  49
epoch:  50 val_f1:  0.7410071942446043 val_auroc:  0.8092783505154639 val_auprc:  0.9158657158045327
EarlyStopping counter: 40 out of 50
epoch:  50
epoch:  51 val_f1:  0.7410071942446043 val_auroc:  0.8102601865488465 val_auprc:  0.9160336194955172
EarlyStopping counter: 41 out of 50
epoch:  51
epoch:  52 val_f1:  0.7473302173830908 val_auroc:  0.8119783996072656 val_auprc:  0.9160264268960109
EarlyStopping counter: 42 out of 50
epoch:  52
epoch:  53 val_f1:  0.76000113614692 val_auroc:  0.8046146293568973 val_auprc:  0.91209020888275
EarlyStopping counter: 43 out of 50
epoch:  53
epoch:  54 val_f1:  0.7346891520614657 val_auroc:  0.8068237604320079 val_auprc:  0.9134468868558876
EarlyStopping counter: 44 out of 50
epoch:  54
epoch:  55 val_f1:  0.7410071942446043 val_auroc:  0.810505645557192 val_auprc:  0.9156480073112
EarlyStopping counter: 45 out of 50
epoch:  55
epoch:  56 val_f1:  0.7410071942446043 val_auroc:  0.8087874324987727 val_auprc:  0.9151042027810297
EarlyStopping counter: 46 out of 50
epoch:  56
epoch:  57 val_f1:  0.7490302789770621 val_auroc:  0.8114874815905743 val_auprc:  0.9156827678727868
EarlyStopping counter: 47 out of 50
epoch:  57
epoch:  58 val_f1:  0.7473302173830908 val_auroc:  0.8063328424153167 val_auprc:  0.9130720040858551
EarlyStopping counter: 48 out of 50
epoch:  58
epoch:  59 val_f1:  0.7473302173830908 val_auroc:  0.8048600883652429 val_auprc:  0.9129183026766448
EarlyStopping counter: 49 out of 50
epoch:  59
epoch:  60 val_f1:  0.7313689473952751 val_auroc:  0.8136966126656848 val_auprc:  0.9166337089070291
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  175.2733027935028
{'time_elapsed': [175.2733027935028], 'epoch': [59], 'fold': [0], 'f1_train': [0.9892411295259068], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7313689473952751], 'auroc_test': [0.8136966126656848], 'auprc_test': [0.9166337089070291]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 427]            2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 427]            1,024
│    └─Tanh: 2-3                         [64, 512, 427]            --
│    └─MaxPool1d: 2-4                    [64, 512, 142]            --
│    └─Dropout: 2-5                      [64, 512, 142]            --
│    └─Flatten: 2-6                      [64, 72704]               --
│    └─Linear: 2-7                       [64, 1]                   72,705
==========================================================================================
Total params: 75,777
Trainable params: 75,777
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 223.87
Params size (MB): 0.30
Estimated Total Size (MB): 224.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5697197655491435 val_auroc:  0.6703485517918507 val_auprc:  0.8260230715891135
epoch:  1
epoch:  2 val_f1:  0.6202329823303186 val_auroc:  0.6740304369170349 val_auprc:  0.863486878933519
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6241521068859198 val_auroc:  0.6769759450171822 val_auprc:  0.8622955536411328
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.648642390567887 val_auroc:  0.7064310260186548 val_auprc:  0.877528470142454
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6674874004539683 val_auroc:  0.7496318114874816 val_auprc:  0.8971558181876862
Validation loss improved to 1.111948
epoch:  5
epoch:  6 val_f1:  0.7377351131143277 val_auroc:  0.7773686794305351 val_auprc:  0.9066365446257427
Validation loss improved to 1.070755
epoch:  6
epoch:  7 val_f1:  0.7044810154681304 val_auroc:  0.7862052037309769 val_auprc:  0.9090437714981217
Validation loss improved to 1.003491
epoch:  7
epoch:  8 val_f1:  0.7857445835239322 val_auroc:  0.7901325478645067 val_auprc:  0.9107156894527779
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7786895152313162 val_auroc:  0.7982326951399117 val_auprc:  0.9175042029763836
Validation loss improved to 1.000944
epoch:  9
epoch:  10 val_f1:  0.7337314237416728 val_auroc:  0.7989690721649485 val_auprc:  0.9192536283763979
Validation loss improved to 0.974869
epoch:  10
epoch:  11 val_f1:  0.7030919944895149 val_auroc:  0.7972508591065292 val_auprc:  0.9189104493178397
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.662106821819052 val_auroc:  0.7952871870397643 val_auprc:  0.918213655022011
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.7307106601978622 val_auroc:  0.7984781541482573 val_auprc:  0.9186683590925783
EarlyStopping counter: 3 out of 50
epoch:  13
epoch:  14 val_f1:  0.6262616863622784 val_auroc:  0.7999509081983308 val_auprc:  0.9176249389605159
EarlyStopping counter: 4 out of 50
epoch:  14
epoch:  15 val_f1:  0.702782849280763 val_auroc:  0.80166912125675 val_auprc:  0.9176232872978861
EarlyStopping counter: 5 out of 50
epoch:  15
epoch:  16 val_f1:  0.7304528631430115 val_auroc:  0.8033873343151694 val_auprc:  0.9196684713079429
EarlyStopping counter: 6 out of 50
epoch:  16
epoch:  17 val_f1:  0.7639705763479104 val_auroc:  0.8070692194403535 val_auprc:  0.9213928485578495
Validation loss improved to 0.941741
epoch:  17
epoch:  18 val_f1:  0.7313689473952751 val_auroc:  0.8075601374570447 val_auprc:  0.9209128071547473
Validation loss improved to 0.936817
epoch:  18
epoch:  19 val_f1:  0.7309103647707891 val_auroc:  0.8051055473735886 val_auprc:  0.9194815253568848
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7266187050359713 val_auroc:  0.8046146293568974 val_auprc:  0.9184156648097903
EarlyStopping counter: 2 out of 50
epoch:  20
epoch:  21 val_f1:  0.7477455593342162 val_auroc:  0.8051055473735886 val_auprc:  0.9191216766209147
EarlyStopping counter: 3 out of 50
epoch:  21
epoch:  22 val_f1:  0.7402181480621955 val_auroc:  0.8036327933235149 val_auprc:  0.9181456508493842
EarlyStopping counter: 4 out of 50
epoch:  22
epoch:  23 val_f1:  0.6894622188638474 val_auroc:  0.8038782523318606 val_auprc:  0.918377125480969
EarlyStopping counter: 5 out of 50
epoch:  23
epoch:  24 val_f1:  0.7170655771870609 val_auroc:  0.8092783505154639 val_auprc:  0.9204379801589566
EarlyStopping counter: 6 out of 50
epoch:  24
epoch:  25 val_f1:  0.7309103647707891 val_auroc:  0.8073146784486991 val_auprc:  0.9182344529124145
EarlyStopping counter: 7 out of 50
epoch:  25
epoch:  26 val_f1:  0.7390688025474315 val_auroc:  0.8068237604320078 val_auprc:  0.9181911319084374
EarlyStopping counter: 8 out of 50
epoch:  26
epoch:  27 val_f1:  0.7455074238481555 val_auroc:  0.8041237113402062 val_auprc:  0.9169888914949256
EarlyStopping counter: 9 out of 50
epoch:  27
epoch:  28 val_f1:  0.703263898025454 val_auroc:  0.8078055964653903 val_auprc:  0.9186237995614301
EarlyStopping counter: 10 out of 50
epoch:  28
epoch:  29 val_f1:  0.7569659388768054 val_auroc:  0.8055964653902797 val_auprc:  0.9174562985440557
EarlyStopping counter: 11 out of 50
epoch:  29
epoch:  30 val_f1:  0.7661184054361647 val_auroc:  0.8078055964653902 val_auprc:  0.9181691377100138
EarlyStopping counter: 12 out of 50
epoch:  30
epoch:  31 val_f1:  0.7490302789770621 val_auroc:  0.81173294059892 val_auprc:  0.9204135242363091
EarlyStopping counter: 13 out of 50
epoch:  31
epoch:  32 val_f1:  0.7349308245711123 val_auroc:  0.804860088365243 val_auprc:  0.9159687782330433
EarlyStopping counter: 14 out of 50
epoch:  32
epoch:  33 val_f1:  0.7473302173830908 val_auroc:  0.8068237604320079 val_auprc:  0.9166100467437949
EarlyStopping counter: 15 out of 50
epoch:  33
epoch:  34 val_f1:  0.7454557504588546 val_auroc:  0.8132056946489936 val_auprc:  0.9201952747201816
EarlyStopping counter: 16 out of 50
epoch:  34
epoch:  35 val_f1:  0.720403844991234 val_auroc:  0.8095238095238094 val_auprc:  0.9181014368963039
EarlyStopping counter: 17 out of 50
epoch:  35
epoch:  36 val_f1:  0.7208993647046947 val_auroc:  0.814187530682376 val_auprc:  0.9193010299626043
EarlyStopping counter: 18 out of 50
epoch:  36
epoch:  37 val_f1:  0.7683026725960121 val_auroc:  0.810505645557192 val_auprc:  0.9183006285402293
EarlyStopping counter: 19 out of 50
epoch:  37
epoch:  38 val_f1:  0.7455074238481555 val_auroc:  0.8097692685321551 val_auprc:  0.9179806219381796
EarlyStopping counter: 20 out of 50
epoch:  38
epoch:  39 val_f1:  0.7325045643526866 val_auroc:  0.8078055964653903 val_auprc:  0.9163614615632663
EarlyStopping counter: 21 out of 50
epoch:  39
epoch:  40 val_f1:  0.7325045643526866 val_auroc:  0.8119783996072657 val_auprc:  0.9179655064192865
EarlyStopping counter: 22 out of 50
epoch:  40
epoch:  41 val_f1:  0.7607703458551531 val_auroc:  0.8132056946489936 val_auprc:  0.9191470685467351
EarlyStopping counter: 23 out of 50
epoch:  41
epoch:  42 val_f1:  0.743396428458658 val_auroc:  0.8070692194403535 val_auprc:  0.915028812192743
EarlyStopping counter: 24 out of 50
epoch:  42
epoch:  43 val_f1:  0.7490302789770621 val_auroc:  0.8122238586156112 val_auprc:  0.9182295898306618
EarlyStopping counter: 25 out of 50
epoch:  43
epoch:  44 val_f1:  0.7371484630477437 val_auroc:  0.8080510554737359 val_auprc:  0.9154224055809643
EarlyStopping counter: 26 out of 50
epoch:  44
epoch:  45 val_f1:  0.7330561760022478 val_auroc:  0.8122238586156112 val_auprc:  0.9157163221159345
EarlyStopping counter: 27 out of 50
epoch:  45
epoch:  46 val_f1:  0.7391671278361928 val_auroc:  0.8065783014236623 val_auprc:  0.913173770117194
EarlyStopping counter: 28 out of 50
epoch:  46
epoch:  47 val_f1:  0.7386752666832053 val_auroc:  0.806823760432008 val_auprc:  0.913689318331769
EarlyStopping counter: 29 out of 50
epoch:  47
epoch:  48 val_f1:  0.7622262794246104 val_auroc:  0.810505645557192 val_auprc:  0.9153685104574749
EarlyStopping counter: 30 out of 50
epoch:  48
epoch:  49 val_f1:  0.7617684906754855 val_auroc:  0.8095238095238095 val_auprc:  0.9148111343009364
EarlyStopping counter: 31 out of 50
epoch:  49
epoch:  50 val_f1:  0.76000113614692 val_auroc:  0.8070692194403535 val_auprc:  0.9127066282226558
EarlyStopping counter: 32 out of 50
epoch:  50
epoch:  51 val_f1:  0.742136387976997 val_auroc:  0.8095238095238095 val_auprc:  0.9138007441649897
EarlyStopping counter: 33 out of 50
epoch:  51
epoch:  52 val_f1:  0.7536606851900262 val_auroc:  0.8100147275405009 val_auprc:  0.9156407784696807
EarlyStopping counter: 34 out of 50
epoch:  52
epoch:  53 val_f1:  0.7580594896895918 val_auroc:  0.8090328915071183 val_auprc:  0.9142200353552727
EarlyStopping counter: 35 out of 50
epoch:  53
epoch:  54 val_f1:  0.7536606851900262 val_auroc:  0.8065783014236623 val_auprc:  0.9132854818452644
EarlyStopping counter: 36 out of 50
epoch:  54
epoch:  55 val_f1:  0.7490302789770621 val_auroc:  0.802405498281787 val_auprc:  0.9109191124904841
EarlyStopping counter: 37 out of 50
epoch:  55
epoch:  56 val_f1:  0.7473302173830908 val_auroc:  0.8026509572901325 val_auprc:  0.9101358654532754
EarlyStopping counter: 38 out of 50
epoch:  56
epoch:  57 val_f1:  0.7473302173830908 val_auroc:  0.8016691212567502 val_auprc:  0.9088390347957858
EarlyStopping counter: 39 out of 50
epoch:  57
epoch:  58 val_f1:  0.7559325673789327 val_auroc:  0.8055964653902797 val_auprc:  0.9118439999708721
EarlyStopping counter: 40 out of 50
epoch:  58
epoch:  59 val_f1:  0.76000113614692 val_auroc:  0.8051055473735886 val_auprc:  0.9127685815660008
EarlyStopping counter: 41 out of 50
epoch:  59
epoch:  60 val_f1:  0.7707245329923307 val_auroc:  0.8058419243986256 val_auprc:  0.9111150398938868
EarlyStopping counter: 42 out of 50
epoch:  60
epoch:  61 val_f1:  0.766354189375772 val_auroc:  0.8038782523318606 val_auprc:  0.9108572650935557
EarlyStopping counter: 43 out of 50
epoch:  61
epoch:  62 val_f1:  0.7727225509205256 val_auroc:  0.8001963672066765 val_auprc:  0.9079757240400941
EarlyStopping counter: 44 out of 50
epoch:  62
epoch:  63 val_f1:  0.7643829551743221 val_auroc:  0.8006872852233677 val_auprc:  0.907867006970679
EarlyStopping counter: 45 out of 50
epoch:  63
epoch:  64 val_f1:  0.7770871369605723 val_auroc:  0.8073146784486992 val_auprc:  0.9105086922973816
EarlyStopping counter: 46 out of 50
epoch:  64
epoch:  65 val_f1:  0.7510724063582411 val_auroc:  0.8033873343151694 val_auprc:  0.9098575664060924
EarlyStopping counter: 47 out of 50
epoch:  65
epoch:  66 val_f1:  0.7559325673789327 val_auroc:  0.8051055473735886 val_auprc:  0.9110617889168281
EarlyStopping counter: 48 out of 50
epoch:  66
epoch:  67 val_f1:  0.7598715939807772 val_auroc:  0.8004418262150221 val_auprc:  0.9073462158571077
EarlyStopping counter: 49 out of 50
epoch:  67
epoch:  68 val_f1:  0.7643829551743221 val_auroc:  0.8055964653902798 val_auprc:  0.9102607701626702
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  189.52408504486084
{'time_elapsed': [189.52408504486084], 'epoch': [67], 'fold': [1], 'f1_train': [0.9981996872393208], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7643829551743221], 'auroc_test': [0.8055964653902798], 'auprc_test': [0.9102607701626702]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 427]            2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 427]            1,024
│    └─Tanh: 2-3                         [64, 512, 427]            --
│    └─MaxPool1d: 2-4                    [64, 512, 142]            --
│    └─Dropout: 2-5                      [64, 512, 142]            --
│    └─Flatten: 2-6                      [64, 72704]               --
│    └─Linear: 2-7                       [64, 1]                   72,705
==========================================================================================
Total params: 75,777
Trainable params: 75,777
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 223.87
Params size (MB): 0.30
Estimated Total Size (MB): 224.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5985139007438117 val_auroc:  0.680166912125675 val_auprc:  0.8428617186989935
epoch:  1
epoch:  2 val_f1:  0.648642390567887 val_auroc:  0.6224840451644574 val_auprc:  0.8182224835767337
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.649531284063658 val_auroc:  0.6300932744231713 val_auprc:  0.820164404440623
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6814625969127611 val_auroc:  0.6502209131075111 val_auprc:  0.8284898960558934
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6834532374100719 val_auroc:  0.6782032400589102 val_auprc:  0.8421217163818189
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6928018025140328 val_auroc:  0.7120765832106039 val_auprc:  0.8585923392175688
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.7229061670449737 val_auroc:  0.7407952871870398 val_auprc:  0.8713185056908301
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.5838273142196633 val_auroc:  0.7601865488463426 val_auprc:  0.8808034713636199
EarlyStopping counter: 7 out of 50
epoch:  8
epoch:  9 val_f1:  0.4795145890028967 val_auroc:  0.7614138438880707 val_auprc:  0.8810624079191851
EarlyStopping counter: 8 out of 50
epoch:  9
epoch:  10 val_f1:  0.600961958701277 val_auroc:  0.7584683357879234 val_auprc:  0.8774227955096805
EarlyStopping counter: 9 out of 50
epoch:  10
epoch:  11 val_f1:  0.7519437633413868 val_auroc:  0.7609229258713796 val_auprc:  0.8791253585929507
EarlyStopping counter: 10 out of 50
epoch:  11
epoch:  12 val_f1:  0.682026026688228 val_auroc:  0.7535591556210113 val_auprc:  0.8705783813135545
EarlyStopping counter: 11 out of 50
epoch:  12
epoch:  13 val_f1:  0.3817806514282245 val_auroc:  0.7528227785959745 val_auprc:  0.8714316844980723
EarlyStopping counter: 12 out of 50
epoch:  13
epoch:  14 val_f1:  0.41806291437438287 val_auroc:  0.7572410407461955 val_auprc:  0.877077685797591
EarlyStopping counter: 13 out of 50
epoch:  14
epoch:  15 val_f1:  0.5031855112924587 val_auroc:  0.7596956308296515 val_auprc:  0.8765001935750063
EarlyStopping counter: 14 out of 50
epoch:  15
epoch:  16 val_f1:  0.6810035515891084 val_auroc:  0.7695139911634757 val_auprc:  0.8852017519847757
EarlyStopping counter: 15 out of 50
epoch:  16
epoch:  17 val_f1:  0.696151679426677 val_auroc:  0.7746686303387335 val_auprc:  0.8863758083404352
EarlyStopping counter: 16 out of 50
epoch:  17
epoch:  18 val_f1:  0.730071543320129 val_auroc:  0.7778595974472263 val_auprc:  0.8846256972246248
Validation loss improved to 1.082583
epoch:  18
epoch:  19 val_f1:  0.7367608586927249 val_auroc:  0.7778595974472262 val_auprc:  0.8832460257312429
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7500864926036699 val_auroc:  0.7825233186057928 val_auprc:  0.8849225112377237
EarlyStopping counter: 2 out of 50
epoch:  20
epoch:  21 val_f1:  0.7349308245711123 val_auroc:  0.7839960726558665 val_auprc:  0.8843676684121851
EarlyStopping counter: 3 out of 50
epoch:  21
epoch:  22 val_f1:  0.735514445586388 val_auroc:  0.7842415316642121 val_auprc:  0.8844628096961396
EarlyStopping counter: 4 out of 50
epoch:  22
epoch:  23 val_f1:  0.7841726618705036 val_auroc:  0.792341678939617 val_auprc:  0.8913100250792351
EarlyStopping counter: 5 out of 50
epoch:  23
epoch:  24 val_f1:  0.7362024088594293 val_auroc:  0.7839960726558665 val_auprc:  0.8854085554146032
EarlyStopping counter: 6 out of 50
epoch:  24
epoch:  25 val_f1:  0.7371937993371881 val_auroc:  0.776141384388807 val_auprc:  0.8810258394210001
EarlyStopping counter: 7 out of 50
epoch:  25
epoch:  26 val_f1:  0.7307106601978622 val_auroc:  0.7844869906725577 val_auprc:  0.8873083603643297
EarlyStopping counter: 8 out of 50
epoch:  26
epoch:  27 val_f1:  0.7607703458551531 val_auroc:  0.7918507609229258 val_auprc:  0.8935838155491334
EarlyStopping counter: 9 out of 50
epoch:  27
epoch:  28 val_f1:  0.7428255465713769 val_auroc:  0.7751595483554247 val_auprc:  0.8799570667372973
EarlyStopping counter: 10 out of 50
epoch:  28
epoch:  29 val_f1:  0.726400389202679 val_auroc:  0.7874324987727049 val_auprc:  0.8910414850065247
EarlyStopping counter: 11 out of 50
epoch:  29
epoch:  30 val_f1:  0.7386752666832053 val_auroc:  0.7825233186057928 val_auprc:  0.8883126517501678
EarlyStopping counter: 12 out of 50
epoch:  30
epoch:  31 val_f1:  0.7309103647707891 val_auroc:  0.7842415316642122 val_auprc:  0.8910303010363618
EarlyStopping counter: 13 out of 50
epoch:  31
epoch:  32 val_f1:  0.7287333672277241 val_auroc:  0.7854688267059401 val_auprc:  0.8926731439060547
EarlyStopping counter: 14 out of 50
epoch:  32
epoch:  33 val_f1:  0.7371484630477437 val_auroc:  0.7766323024054982 val_auprc:  0.8847127301796782
EarlyStopping counter: 15 out of 50
epoch:  33
epoch:  34 val_f1:  0.7402181480621955 val_auroc:  0.7839960726558665 val_auprc:  0.8894789048117864
EarlyStopping counter: 16 out of 50
epoch:  34
epoch:  35 val_f1:  0.7410071942446043 val_auroc:  0.7866961217476681 val_auprc:  0.8925045738159425
EarlyStopping counter: 17 out of 50
epoch:  35
epoch:  36 val_f1:  0.7411406017655346 val_auroc:  0.7761413843888071 val_auprc:  0.8818519013251424
EarlyStopping counter: 18 out of 50
epoch:  36
epoch:  37 val_f1:  0.7510724063582411 val_auroc:  0.7881688757977418 val_auprc:  0.8911712061015091
EarlyStopping counter: 19 out of 50
epoch:  37
epoch:  38 val_f1:  0.7324246948924567 val_auroc:  0.7935689739813452 val_auprc:  0.896517858426866
EarlyStopping counter: 20 out of 50
epoch:  38
epoch:  39 val_f1:  0.7166849710626011 val_auroc:  0.7815414825724104 val_auprc:  0.881859654914111
EarlyStopping counter: 21 out of 50
epoch:  39
epoch:  40 val_f1:  0.7349308245711123 val_auroc:  0.7793323514973 val_auprc:  0.8811921669098868
EarlyStopping counter: 22 out of 50
epoch:  40
epoch:  41 val_f1:  0.7633550302615051 val_auroc:  0.7864506627393225 val_auprc:  0.8899827632854622
EarlyStopping counter: 23 out of 50
epoch:  41
epoch:  42 val_f1:  0.7500864926036699 val_auroc:  0.7783505154639175 val_auprc:  0.8823361256664882
EarlyStopping counter: 24 out of 50
epoch:  42
epoch:  43 val_f1:  0.7466980132583976 val_auroc:  0.7822778595974472 val_auprc:  0.8869344586785644
EarlyStopping counter: 25 out of 50
epoch:  43
epoch:  44 val_f1:  0.7477455593342162 val_auroc:  0.7869415807560137 val_auprc:  0.8945618037112663
EarlyStopping counter: 26 out of 50
epoch:  44
epoch:  45 val_f1:  0.7225455998837295 val_auroc:  0.7761413843888071 val_auprc:  0.8833783034279539
EarlyStopping counter: 27 out of 50
epoch:  45
epoch:  46 val_f1:  0.7184536707983012 val_auroc:  0.7812960235640648 val_auprc:  0.8870031365925095
EarlyStopping counter: 28 out of 50
epoch:  46
epoch:  47 val_f1:  0.7184536707983012 val_auroc:  0.7825233186057928 val_auprc:  0.888123908628724
EarlyStopping counter: 29 out of 50
epoch:  47
epoch:  48 val_f1:  0.722058496910722 val_auroc:  0.7731958762886598 val_auprc:  0.8801415959970034
EarlyStopping counter: 30 out of 50
epoch:  48
epoch:  49 val_f1:  0.7390688025474315 val_auroc:  0.7756504663721159 val_auprc:  0.8844819789565381
EarlyStopping counter: 31 out of 50
epoch:  49
epoch:  50 val_f1:  0.722058496910722 val_auroc:  0.7758959253804615 val_auprc:  0.882606418443913
EarlyStopping counter: 32 out of 50
epoch:  50
epoch:  51 val_f1:  0.7122302158273381 val_auroc:  0.7758959253804615 val_auprc:  0.8818209548769871
EarlyStopping counter: 33 out of 50
epoch:  51
epoch:  52 val_f1:  0.7283736963917239 val_auroc:  0.7783505154639175 val_auprc:  0.8829891338877671
EarlyStopping counter: 34 out of 50
epoch:  52
epoch:  53 val_f1:  0.7122302158273381 val_auroc:  0.7798232695139912 val_auprc:  0.8855378551116915
EarlyStopping counter: 35 out of 50
epoch:  53
epoch:  54 val_f1:  0.7184536707983012 val_auroc:  0.7781050564555719 val_auprc:  0.8837971203444459
EarlyStopping counter: 36 out of 50
epoch:  54
epoch:  55 val_f1:  0.7411406017655346 val_auroc:  0.7803141875306824 val_auprc:  0.8854446417578558
EarlyStopping counter: 37 out of 50
epoch:  55
epoch:  56 val_f1:  0.7184536707983012 val_auroc:  0.781786941580756 val_auprc:  0.8866470592464623
EarlyStopping counter: 38 out of 50
epoch:  56
epoch:  57 val_f1:  0.7203480251458693 val_auroc:  0.7771232204221895 val_auprc:  0.880715120627987
EarlyStopping counter: 39 out of 50
epoch:  57
epoch:  58 val_f1:  0.7441671543148256 val_auroc:  0.7781050564555719 val_auprc:  0.8828251823683888
EarlyStopping counter: 40 out of 50
epoch:  58
epoch:  59 val_f1:  0.7163649790827238 val_auroc:  0.7754050073637703 val_auprc:  0.8806927779983302
EarlyStopping counter: 41 out of 50
epoch:  59
epoch:  60 val_f1:  0.7122302158273381 val_auroc:  0.7781050564555718 val_auprc:  0.8825430036351551
EarlyStopping counter: 42 out of 50
epoch:  60
epoch:  61 val_f1:  0.7040153975059064 val_auroc:  0.7793323514973 val_auprc:  0.8829695574851897
EarlyStopping counter: 43 out of 50
epoch:  61
epoch:  62 val_f1:  0.7283736963917239 val_auroc:  0.7756504663721159 val_auprc:  0.8825139257574727
EarlyStopping counter: 44 out of 50
epoch:  62
epoch:  63 val_f1:  0.7531731915989216 val_auroc:  0.7714776632302405 val_auprc:  0.8779442977760062
EarlyStopping counter: 45 out of 50
epoch:  63
epoch:  64 val_f1:  0.7203480251458693 val_auroc:  0.7768777614138439 val_auprc:  0.8823560993475963
EarlyStopping counter: 46 out of 50
epoch:  64
epoch:  65 val_f1:  0.7283736963917239 val_auroc:  0.7766323024054983 val_auprc:  0.8830807074399603
EarlyStopping counter: 47 out of 50
epoch:  65
epoch:  66 val_f1:  0.7203480251458693 val_auroc:  0.7751595483554247 val_auprc:  0.8816089232682536
EarlyStopping counter: 48 out of 50
epoch:  66
epoch:  67 val_f1:  0.7287333672277241 val_auroc:  0.7758959253804615 val_auprc:  0.8817046171070269
EarlyStopping counter: 49 out of 50
epoch:  67
epoch:  68 val_f1:  0.7246795893300292 val_auroc:  0.7766323024054983 val_auprc:  0.882596556679036
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  188.87758660316467
{'time_elapsed': [188.87758660316467], 'epoch': [67], 'fold': [2], 'f1_train': [0.9928161714345926], 'auroc_train': [0.9999233528528069], 'auprc_train': [0.9999664851387277], 'f1_test': [0.7246795893300292], 'auroc_test': [0.7766323024054983], 'auprc_test': [0.882596556679036]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 427]            2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 427]            1,024
│    └─Tanh: 2-3                         [64, 512, 427]            --
│    └─MaxPool1d: 2-4                    [64, 512, 142]            --
│    └─Dropout: 2-5                      [64, 512, 142]            --
│    └─Flatten: 2-6                      [64, 72704]               --
│    └─Linear: 2-7                       [64, 1]                   72,705
==========================================================================================
Total params: 75,777
Trainable params: 75,777
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 223.87
Params size (MB): 0.30
Estimated Total Size (MB): 224.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6100773857584803 val_auroc:  0.682170542635659 val_auprc:  0.8309606284540653
epoch:  1
epoch:  2 val_f1:  0.6607574897107611 val_auroc:  0.6906492248062015 val_auprc:  0.8600357046639655
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6351848337159043 val_auroc:  0.7291666666666666 val_auprc:  0.8832884628479483
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6690647482014388 val_auroc:  0.7582364341085271 val_auprc:  0.8965191701879276
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.7105563674605215 val_auroc:  0.7950581395348837 val_auprc:  0.9116660518275561
Validation loss improved to 0.967714
epoch:  5
epoch:  6 val_f1:  0.7276252130251284 val_auroc:  0.8137112403100777 val_auprc:  0.921961396336096
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.71850089571744 val_auroc:  0.8202519379844961 val_auprc:  0.9239543770427064
Validation loss improved to 0.922983
epoch:  7
epoch:  8 val_f1:  0.738794770635105 val_auroc:  0.8258236434108527 val_auprc:  0.9250173960416366
Validation loss improved to 0.869153
epoch:  8
epoch:  9 val_f1:  0.7506277331076315 val_auroc:  0.8296996124031009 val_auprc:  0.9247130747545462
Validation loss improved to 0.860613
epoch:  9
epoch:  10 val_f1:  0.743864788408794 val_auroc:  0.8306686046511628 val_auprc:  0.9262850095317671
Validation loss improved to 0.854608
epoch:  10
epoch:  11 val_f1:  0.7735780520043992 val_auroc:  0.8318798449612402 val_auprc:  0.9267307705029488
Validation loss improved to 0.841965
epoch:  11
epoch:  12 val_f1:  0.7436964485493495 val_auroc:  0.8296996124031009 val_auprc:  0.9270479187604519
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7594266802546743 val_auroc:  0.8311531007751938 val_auprc:  0.9268581394720712
Validation loss improved to 0.832057
epoch:  13
epoch:  14 val_f1:  0.7238355598325329 val_auroc:  0.8301841085271318 val_auprc:  0.9263263596141468
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.7594266802546743 val_auroc:  0.8304263565891472 val_auprc:  0.9260229475608757
EarlyStopping counter: 2 out of 50
epoch:  15
epoch:  16 val_f1:  0.7713093666729185 val_auroc:  0.8333333333333333 val_auprc:  0.9285984607846813
Validation loss improved to 0.808289
epoch:  16
epoch:  17 val_f1:  0.7507041863300117 val_auroc:  0.8326065891472868 val_auprc:  0.9281917131256479
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.6770278776978418 val_auroc:  0.8311531007751938 val_auprc:  0.9266656565849309
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7363492257041825 val_auroc:  0.8321220930232559 val_auprc:  0.927733769107862
EarlyStopping counter: 3 out of 50
epoch:  19
epoch:  20 val_f1:  0.7634619577065621 val_auroc:  0.8323643410852714 val_auprc:  0.9284193233867989
Validation loss improved to 0.799806
epoch:  20
epoch:  21 val_f1:  0.764639197732723 val_auroc:  0.8352713178294574 val_auprc:  0.9293305802516117
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7276252130251284 val_auroc:  0.8355135658914729 val_auprc:  0.9291878299619978
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.7427571456348435 val_auroc:  0.8427810077519379 val_auprc:  0.9314431078822463
EarlyStopping counter: 3 out of 50
epoch:  23
epoch:  24 val_f1:  0.7841726618705036 val_auroc:  0.8459302325581395 val_auprc:  0.9331710329367353
EarlyStopping counter: 4 out of 50
epoch:  24
epoch:  25 val_f1:  0.7776763243674784 val_auroc:  0.8452034883720931 val_auprc:  0.9340310347756424
EarlyStopping counter: 5 out of 50
epoch:  25
epoch:  26 val_f1:  0.7506277331076315 val_auroc:  0.84859496124031 val_auprc:  0.9380225255475547
Validation loss improved to 0.778924
epoch:  26
epoch:  27 val_f1:  0.7801238118631262 val_auroc:  0.8473837209302325 val_auprc:  0.9348246122073391
Validation loss improved to 0.764883
epoch:  27
epoch:  28 val_f1:  0.7789671954250403 val_auroc:  0.846172480620155 val_auprc:  0.9359730638521901
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.7932273763653603 val_auroc:  0.8473837209302325 val_auprc:  0.9361679707436709
EarlyStopping counter: 2 out of 50
epoch:  29
epoch:  30 val_f1:  0.7854893118997625 val_auroc:  0.848110465116279 val_auprc:  0.937222351119982
EarlyStopping counter: 3 out of 50
epoch:  30
epoch:  31 val_f1:  0.7777989809743717 val_auroc:  0.8500484496124031 val_auprc:  0.9386784470915766
Validation loss improved to 0.754929
epoch:  31
epoch:  32 val_f1:  0.7369148836774737 val_auroc:  0.8500484496124031 val_auprc:  0.9385036189701296
EarlyStopping counter: 1 out of 50
epoch:  32
epoch:  33 val_f1:  0.7835226993620948 val_auroc:  0.8485949612403101 val_auprc:  0.938954435733022
Validation loss improved to 0.746246
epoch:  33
epoch:  34 val_f1:  0.7907929835906556 val_auroc:  0.8539244186046513 val_auprc:  0.9404207949046104
Validation loss improved to 0.745157
epoch:  34
epoch:  35 val_f1:  0.7980190776058461 val_auroc:  0.8546511627906977 val_auprc:  0.9397772560304931
EarlyStopping counter: 1 out of 50
epoch:  35
epoch:  36 val_f1:  0.7841726618705036 val_auroc:  0.8556201550387598 val_auprc:  0.9406011346256921
EarlyStopping counter: 2 out of 50
epoch:  36
epoch:  37 val_f1:  0.776244301724119 val_auroc:  0.8575581395348838 val_auprc:  0.941229684835054
EarlyStopping counter: 3 out of 50
epoch:  37
epoch:  38 val_f1:  0.792019787311512 val_auroc:  0.8609496124031006 val_auprc:  0.9427456606542517
Validation loss improved to 0.741426
epoch:  38
epoch:  39 val_f1:  0.7886649052635782 val_auroc:  0.8580426356589148 val_auprc:  0.9429991046594476
Validation loss improved to 0.727458
epoch:  39
epoch:  40 val_f1:  0.7841726618705036 val_auroc:  0.8626453488372093 val_auprc:  0.9439191016434353
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.7841726618705036 val_auroc:  0.8643410852713178 val_auprc:  0.9449771366038717
EarlyStopping counter: 2 out of 50
epoch:  41
epoch:  42 val_f1:  0.7841726618705036 val_auroc:  0.8636143410852714 val_auprc:  0.9448923503502934
EarlyStopping counter: 3 out of 50
epoch:  42
epoch:  43 val_f1:  0.792019787311512 val_auroc:  0.8650678294573645 val_auprc:  0.9453742450609092
EarlyStopping counter: 4 out of 50
epoch:  43
epoch:  44 val_f1:  0.7841726618705036 val_auroc:  0.8703972868217054 val_auprc:  0.9472813804383484
EarlyStopping counter: 5 out of 50
epoch:  44
epoch:  45 val_f1:  0.7841726618705036 val_auroc:  0.8689437984496124 val_auprc:  0.9473631142755218
EarlyStopping counter: 6 out of 50
epoch:  45
epoch:  46 val_f1:  0.792019787311512 val_auroc:  0.8723352713178295 val_auprc:  0.9479270321480529
EarlyStopping counter: 7 out of 50
epoch:  46
epoch:  47 val_f1:  0.792019787311512 val_auroc:  0.874515503875969 val_auprc:  0.9484431335891803
Validation loss improved to 0.714111
epoch:  47
epoch:  48 val_f1:  0.8027539115793398 val_auroc:  0.875 val_auprc:  0.9493037044859514
Validation loss improved to 0.706089
epoch:  48
epoch:  49 val_f1:  0.8175531003768415 val_auroc:  0.869670542635659 val_auprc:  0.947803012597464
Validation loss improved to 0.697567
epoch:  49
epoch:  50 val_f1:  0.7997900244397783 val_auroc:  0.8796027131782946 val_auprc:  0.9511773193388804
EarlyStopping counter: 1 out of 50
epoch:  50
epoch:  51 val_f1:  0.8051160047274586 val_auroc:  0.8815406976744186 val_auprc:  0.9524110735181647
EarlyStopping counter: 2 out of 50
epoch:  51
epoch:  52 val_f1:  0.783844953500274 val_auroc:  0.877906976744186 val_auprc:  0.9510563221491583
EarlyStopping counter: 3 out of 50
epoch:  52
epoch:  53 val_f1:  0.8022252248962252 val_auroc:  0.8798449612403101 val_auprc:  0.9508581248082795
EarlyStopping counter: 4 out of 50
epoch:  53
epoch:  54 val_f1:  0.7952715769842713 val_auroc:  0.8752422480620153 val_auprc:  0.9494396686647084
EarlyStopping counter: 5 out of 50
epoch:  54
epoch:  55 val_f1:  0.7932273763653603 val_auroc:  0.8793604651162791 val_auprc:  0.9512730049922978
EarlyStopping counter: 6 out of 50
epoch:  55
epoch:  56 val_f1:  0.8027539115793398 val_auroc:  0.8788759689922481 val_auprc:  0.9510866711206332
EarlyStopping counter: 7 out of 50
epoch:  56
epoch:  57 val_f1:  0.7801238118631262 val_auroc:  0.876453488372093 val_auprc:  0.9500981527203656
EarlyStopping counter: 8 out of 50
epoch:  57
epoch:  58 val_f1:  0.7997900244397783 val_auroc:  0.8812984496124031 val_auprc:  0.951988264681978
EarlyStopping counter: 9 out of 50
epoch:  58
epoch:  59 val_f1:  0.7997900244397783 val_auroc:  0.8805717054263565 val_auprc:  0.9511217730006949
EarlyStopping counter: 10 out of 50
epoch:  59
epoch:  60 val_f1:  0.8008946034661633 val_auroc:  0.8805717054263567 val_auprc:  0.9513192318940373
EarlyStopping counter: 11 out of 50
epoch:  60
epoch:  61 val_f1:  0.8140907369797942 val_auroc:  0.881298449612403 val_auprc:  0.9517325735547766
EarlyStopping counter: 12 out of 50
epoch:  61
epoch:  62 val_f1:  0.8108668046482106 val_auroc:  0.8812984496124031 val_auprc:  0.9521071691634247
EarlyStopping counter: 13 out of 50
epoch:  62
epoch:  63 val_f1:  0.8160321672535743 val_auroc:  0.8844476744186046 val_auprc:  0.9524432661624839
EarlyStopping counter: 14 out of 50
epoch:  63
epoch:  64 val_f1:  0.8151164175042944 val_auroc:  0.8829941860465116 val_auprc:  0.9524477663517085
EarlyStopping counter: 15 out of 50
epoch:  64
epoch:  65 val_f1:  0.7774211400110681 val_auroc:  0.8834786821705426 val_auprc:  0.951673974458807
EarlyStopping counter: 16 out of 50
epoch:  65
epoch:  66 val_f1:  0.8022252248962252 val_auroc:  0.8846899224806202 val_auprc:  0.9531392499710876
EarlyStopping counter: 17 out of 50
epoch:  66
epoch:  67 val_f1:  0.8116870274031143 val_auroc:  0.8873546511627907 val_auprc:  0.9533962281603137
EarlyStopping counter: 18 out of 50
epoch:  67
epoch:  68 val_f1:  0.8175531003768415 val_auroc:  0.8832364341085271 val_auprc:  0.9529851771548639
EarlyStopping counter: 19 out of 50
epoch:  68
epoch:  69 val_f1:  0.8074875573056803 val_auroc:  0.8834786821705426 val_auprc:  0.9525591659657202
EarlyStopping counter: 20 out of 50
epoch:  69
epoch:  70 val_f1:  0.8063632502555458 val_auroc:  0.8822674418604651 val_auprc:  0.9519555594771085
EarlyStopping counter: 21 out of 50
epoch:  70
epoch:  71 val_f1:  0.8116870274031143 val_auroc:  0.8888081395348837 val_auprc:  0.9544598543694175
EarlyStopping counter: 22 out of 50
epoch:  71
epoch:  72 val_f1:  0.8037391402911035 val_auroc:  0.8851744186046513 val_auprc:  0.9533256141567498
EarlyStopping counter: 23 out of 50
epoch:  72
epoch:  73 val_f1:  0.8101799492243995 val_auroc:  0.8846899224806201 val_auprc:  0.9529300384915516
EarlyStopping counter: 24 out of 50
epoch:  73
epoch:  74 val_f1:  0.8116870274031143 val_auroc:  0.8885658914728681 val_auprc:  0.95488635687289
EarlyStopping counter: 25 out of 50
epoch:  74
epoch:  75 val_f1:  0.8217477382460002 val_auroc:  0.8873546511627907 val_auprc:  0.9543633233748341
EarlyStopping counter: 26 out of 50
epoch:  75
epoch:  76 val_f1:  0.8217477382460002 val_auroc:  0.8880813953488372 val_auprc:  0.9546482294626183
EarlyStopping counter: 27 out of 50
epoch:  76
epoch:  77 val_f1:  0.8140907369797942 val_auroc:  0.8871124031007753 val_auprc:  0.9540040071931933
EarlyStopping counter: 28 out of 50
epoch:  77
epoch:  78 val_f1:  0.8140907369797942 val_auroc:  0.8871124031007752 val_auprc:  0.954140396279537
EarlyStopping counter: 29 out of 50
epoch:  78
epoch:  79 val_f1:  0.82839144951981 val_auroc:  0.8919573643410852 val_auprc:  0.9562162904914897
EarlyStopping counter: 30 out of 50
epoch:  79
epoch:  80 val_f1:  0.8129496402877698 val_auroc:  0.8909883720930234 val_auprc:  0.9557292371376264
EarlyStopping counter: 31 out of 50
epoch:  80
epoch:  81 val_f1:  0.7875752415552048 val_auroc:  0.8878391472868217 val_auprc:  0.9543944605136413
EarlyStopping counter: 32 out of 50
epoch:  81
epoch:  82 val_f1:  0.8309319242108626 val_auroc:  0.8856589147286821 val_auprc:  0.9537974655780472
EarlyStopping counter: 33 out of 50
epoch:  82
epoch:  83 val_f1:  0.8140907369797942 val_auroc:  0.8871124031007752 val_auprc:  0.9544836723574958
EarlyStopping counter: 34 out of 50
epoch:  83
epoch:  84 val_f1:  0.8037391402911035 val_auroc:  0.8914728682170542 val_auprc:  0.95647474426126
EarlyStopping counter: 35 out of 50
epoch:  84
epoch:  85 val_f1:  0.8037391402911035 val_auroc:  0.8914728682170543 val_auprc:  0.9562453822689714
EarlyStopping counter: 36 out of 50
epoch:  85
epoch:  86 val_f1:  0.8129496402877698 val_auroc:  0.8888081395348837 val_auprc:  0.955307683881019
EarlyStopping counter: 37 out of 50
epoch:  86
epoch:  87 val_f1:  0.8037391402911035 val_auroc:  0.8902616279069767 val_auprc:  0.9554026805189519
EarlyStopping counter: 38 out of 50
epoch:  87
epoch:  88 val_f1:  0.8129496402877698 val_auroc:  0.8892926356589148 val_auprc:  0.9551816200636188
EarlyStopping counter: 39 out of 50
epoch:  88
epoch:  89 val_f1:  0.8037391402911035 val_auroc:  0.8897771317829457 val_auprc:  0.9552174029424119
EarlyStopping counter: 40 out of 50
epoch:  89
epoch:  90 val_f1:  0.8037391402911035 val_auroc:  0.8890503875968992 val_auprc:  0.955395183349672
EarlyStopping counter: 41 out of 50
epoch:  90
epoch:  91 val_f1:  0.8293382315424257 val_auroc:  0.8878391472868217 val_auprc:  0.9548517225539127
EarlyStopping counter: 42 out of 50
epoch:  91
epoch:  92 val_f1:  0.8037391402911035 val_auroc:  0.8909883720930232 val_auprc:  0.9554380109885243
EarlyStopping counter: 43 out of 50
epoch:  92
epoch:  93 val_f1:  0.8207067131995794 val_auroc:  0.8895348837209303 val_auprc:  0.9553780421645544
EarlyStopping counter: 44 out of 50
epoch:  93
epoch:  94 val_f1:  0.8217477382460002 val_auroc:  0.8875968992248062 val_auprc:  0.9544613509194977
EarlyStopping counter: 45 out of 50
epoch:  94
epoch:  95 val_f1:  0.8037391402911035 val_auroc:  0.8905038759689922 val_auprc:  0.9554429566922786
EarlyStopping counter: 46 out of 50
epoch:  95
epoch:  96 val_f1:  0.8207067131995794 val_auroc:  0.8890503875968994 val_auprc:  0.9553373854925074
EarlyStopping counter: 47 out of 50
epoch:  96
epoch:  97 val_f1:  0.8207067131995794 val_auroc:  0.8890503875968992 val_auprc:  0.9547715410107649
EarlyStopping counter: 48 out of 50
epoch:  97
epoch:  98 val_f1:  0.8116870274031143 val_auroc:  0.8883236434108527 val_auprc:  0.9545502524672989
EarlyStopping counter: 49 out of 50
epoch:  98
epoch:  99 val_f1:  0.8129496402877698 val_auroc:  0.8880813953488373 val_auprc:  0.9551950324110217
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  278.315669298172
{'time_elapsed': [278.315669298172], 'epoch': [98], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8129496402877698], 'auroc_test': [0.8880813953488373], 'auprc_test': [0.9551950324110217]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 427]            2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 427]            1,024
│    └─Tanh: 2-3                         [64, 512, 427]            --
│    └─MaxPool1d: 2-4                    [64, 512, 142]            --
│    └─Dropout: 2-5                      [64, 512, 142]            --
│    └─Flatten: 2-6                      [64, 72704]               --
│    └─Linear: 2-7                       [64, 1]                   72,705
==========================================================================================
Total params: 75,777
Trainable params: 75,777
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 223.87
Params size (MB): 0.30
Estimated Total Size (MB): 224.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.577237851662404 val_auroc:  0.8643353174603174 val_auprc:  0.934639579724684
epoch:  1
epoch:  2 val_f1:  0.7493220093615789 val_auroc:  0.8720238095238095 val_auprc:  0.9404052178093193
Validation loss improved to 0.915007
epoch:  2
epoch:  3 val_f1:  0.6589178540339946 val_auroc:  0.8722718253968255 val_auprc:  0.940339678047989
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6820639249682351 val_auroc:  0.8794642857142858 val_auprc:  0.9413097891591338
EarlyStopping counter: 2 out of 50
epoch:  4
epoch:  5 val_f1:  0.6190290197690752 val_auroc:  0.8797123015873016 val_auprc:  0.9399074128012606
EarlyStopping counter: 3 out of 50
epoch:  5
epoch:  6 val_f1:  0.7067526095351808 val_auroc:  0.8804563492063492 val_auprc:  0.9387976617190342
Validation loss improved to 0.851989
epoch:  6
epoch:  7 val_f1:  0.7748792270531402 val_auroc:  0.8767361111111112 val_auprc:  0.9378005076188687
Validation loss improved to 0.797640
epoch:  7
epoch:  8 val_f1:  0.79396185483142 val_auroc:  0.8772321428571429 val_auprc:  0.938857154669529
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.8146053186998734 val_auroc:  0.8802083333333333 val_auprc:  0.940749423765917
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.81483559295621 val_auroc:  0.8819444444444444 val_auprc:  0.9414031339687957
Validation loss improved to 0.777303
epoch:  10
epoch:  11 val_f1:  0.6972047221422399 val_auroc:  0.8851686507936508 val_auprc:  0.9422235977269342
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.756376995929398 val_auroc:  0.8826884920634921 val_auprc:  0.9415386010123593
Validation loss improved to 0.765837
epoch:  12
epoch:  13 val_f1:  0.795635738397158 val_auroc:  0.8826884920634921 val_auprc:  0.9416222771754844
Validation loss improved to 0.757648
epoch:  13
epoch:  14 val_f1:  0.8146053186998734 val_auroc:  0.8829365079365079 val_auprc:  0.9412798424966358
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.8353775743707094 val_auroc:  0.8814484126984128 val_auprc:  0.9392431788167266
EarlyStopping counter: 2 out of 50
epoch:  15
epoch:  16 val_f1:  0.8005921770297647 val_auroc:  0.8836805555555556 val_auprc:  0.940760334249957
EarlyStopping counter: 3 out of 50
epoch:  16
epoch:  17 val_f1:  0.8286888990406578 val_auroc:  0.8839285714285714 val_auprc:  0.9408441401755878
EarlyStopping counter: 4 out of 50
epoch:  17
epoch:  18 val_f1:  0.8382209405501332 val_auroc:  0.8799603174603176 val_auprc:  0.9383624328308415
EarlyStopping counter: 5 out of 50
epoch:  18
epoch:  19 val_f1:  0.8220330394243437 val_auroc:  0.8752480158730159 val_auprc:  0.9361884891638934
EarlyStopping counter: 6 out of 50
epoch:  19
epoch:  20 val_f1:  0.8271938694055665 val_auroc:  0.8839285714285714 val_auprc:  0.9421349835121859
EarlyStopping counter: 7 out of 50
epoch:  20
epoch:  21 val_f1:  0.8137922815659323 val_auroc:  0.8737599206349207 val_auprc:  0.9374690101726608
EarlyStopping counter: 8 out of 50
epoch:  21
epoch:  22 val_f1:  0.8079996415395876 val_auroc:  0.8722718253968254 val_auprc:  0.9345632061859489
EarlyStopping counter: 9 out of 50
epoch:  22
epoch:  23 val_f1:  0.8168793096329329 val_auroc:  0.8725198412698413 val_auprc:  0.9357667808162271
EarlyStopping counter: 10 out of 50
epoch:  23
epoch:  24 val_f1:  0.8168793096329329 val_auroc:  0.8715277777777778 val_auprc:  0.9328158683217654
EarlyStopping counter: 11 out of 50
epoch:  24
epoch:  25 val_f1:  0.8115942028985508 val_auroc:  0.8745039682539683 val_auprc:  0.9366011689078331
EarlyStopping counter: 12 out of 50
epoch:  25
epoch:  26 val_f1:  0.8102677351291666 val_auroc:  0.8727678571428571 val_auprc:  0.9369893485157477
EarlyStopping counter: 13 out of 50
epoch:  26
epoch:  27 val_f1:  0.8102677351291666 val_auroc:  0.8752480158730159 val_auprc:  0.9364994524472209
EarlyStopping counter: 14 out of 50
epoch:  27
epoch:  28 val_f1:  0.8182185828242006 val_auroc:  0.8794642857142857 val_auprc:  0.9400743180595811
EarlyStopping counter: 15 out of 50
epoch:  28
epoch:  29 val_f1:  0.8102677351291666 val_auroc:  0.8772321428571428 val_auprc:  0.9384731119761369
EarlyStopping counter: 16 out of 50
epoch:  29
epoch:  30 val_f1:  0.7905459035188288 val_auroc:  0.8784722222222221 val_auprc:  0.9396460694498312
EarlyStopping counter: 17 out of 50
epoch:  30
epoch:  31 val_f1:  0.8433224248091008 val_auroc:  0.8809523809523809 val_auprc:  0.9411946999933452
EarlyStopping counter: 18 out of 50
epoch:  31
epoch:  32 val_f1:  0.8327610961982647 val_auroc:  0.8787202380952381 val_auprc:  0.9392876730590551
EarlyStopping counter: 19 out of 50
epoch:  32
epoch:  33 val_f1:  0.8182185828242006 val_auroc:  0.8782242063492064 val_auprc:  0.9388689642519423
EarlyStopping counter: 20 out of 50
epoch:  33
epoch:  34 val_f1:  0.8168793096329329 val_auroc:  0.8819444444444445 val_auprc:  0.9399357862806748
EarlyStopping counter: 21 out of 50
epoch:  34
epoch:  35 val_f1:  0.792371879328401 val_auroc:  0.8824404761904762 val_auprc:  0.940250305034343
EarlyStopping counter: 22 out of 50
epoch:  35
epoch:  36 val_f1:  0.8088065661047027 val_auroc:  0.8777281746031745 val_auprc:  0.9375596862379076
EarlyStopping counter: 23 out of 50
epoch:  36
epoch:  37 val_f1:  0.8260869565217391 val_auroc:  0.878720238095238 val_auprc:  0.9383009712145962
EarlyStopping counter: 24 out of 50
epoch:  37
epoch:  38 val_f1:  0.8054462242562929 val_auroc:  0.8799603174603174 val_auprc:  0.938814656857206
EarlyStopping counter: 25 out of 50
epoch:  38
epoch:  39 val_f1:  0.8014350667803353 val_auroc:  0.8742559523809523 val_auprc:  0.9359734685613537
EarlyStopping counter: 26 out of 50
epoch:  39
epoch:  40 val_f1:  0.8415943802884359 val_auroc:  0.8839285714285715 val_auprc:  0.941114691289599
EarlyStopping counter: 27 out of 50
epoch:  40
epoch:  41 val_f1:  0.8182185828242006 val_auroc:  0.8816964285714286 val_auprc:  0.9403709887133236
EarlyStopping counter: 28 out of 50
epoch:  41
epoch:  42 val_f1:  0.8290790088826556 val_auroc:  0.8849206349206349 val_auprc:  0.9409144434606301
EarlyStopping counter: 29 out of 50
epoch:  42
epoch:  43 val_f1:  0.8425069380203517 val_auroc:  0.8856646825396826 val_auprc:  0.9416293469811802
EarlyStopping counter: 30 out of 50
epoch:  43
epoch:  44 val_f1:  0.8014350667803353 val_auroc:  0.8782242063492064 val_auprc:  0.9389347492378349
EarlyStopping counter: 31 out of 50
epoch:  44
epoch:  45 val_f1:  0.8120268224096906 val_auroc:  0.8752480158730158 val_auprc:  0.9346208818499653
EarlyStopping counter: 32 out of 50
epoch:  45
epoch:  46 val_f1:  0.8205262448141007 val_auroc:  0.8816964285714286 val_auprc:  0.9405122092500877
EarlyStopping counter: 33 out of 50
epoch:  46
epoch:  47 val_f1:  0.8168793096329329 val_auroc:  0.8814484126984127 val_auprc:  0.9398872681240313
EarlyStopping counter: 34 out of 50
epoch:  47
epoch:  48 val_f1:  0.8088065661047027 val_auroc:  0.8759920634920636 val_auprc:  0.9364999998602528
EarlyStopping counter: 35 out of 50
epoch:  48
epoch:  49 val_f1:  0.8235137533274179 val_auroc:  0.8839285714285714 val_auprc:  0.9400282424134574
EarlyStopping counter: 36 out of 50
epoch:  49
epoch:  50 val_f1:  0.8115942028985508 val_auroc:  0.8816964285714285 val_auprc:  0.9387808391610474
EarlyStopping counter: 37 out of 50
epoch:  50
epoch:  51 val_f1:  0.8014350667803353 val_auroc:  0.8772321428571429 val_auprc:  0.9369901603900407
EarlyStopping counter: 38 out of 50
epoch:  51
epoch:  52 val_f1:  0.7956729455237178 val_auroc:  0.8829365079365079 val_auprc:  0.9398214412891197
EarlyStopping counter: 39 out of 50
epoch:  52
epoch:  53 val_f1:  0.8022296544035674 val_auroc:  0.8821924603174602 val_auprc:  0.9394573296805945
EarlyStopping counter: 40 out of 50
epoch:  53
epoch:  54 val_f1:  0.8072024593763724 val_auroc:  0.882688492063492 val_auprc:  0.9404920342910424
EarlyStopping counter: 41 out of 50
epoch:  54
epoch:  55 val_f1:  0.8088065661047027 val_auroc:  0.8812003968253969 val_auprc:  0.9392128751349982
EarlyStopping counter: 42 out of 50
epoch:  55
epoch:  56 val_f1:  0.8137922815659323 val_auroc:  0.8792162698412699 val_auprc:  0.9384017660208127
EarlyStopping counter: 43 out of 50
epoch:  56
epoch:  57 val_f1:  0.7940993788819876 val_auroc:  0.8844246031746031 val_auprc:  0.9409472630528766
EarlyStopping counter: 44 out of 50
epoch:  57
epoch:  58 val_f1:  0.8220330394243437 val_auroc:  0.8804563492063492 val_auprc:  0.9388133664859616
EarlyStopping counter: 45 out of 50
epoch:  58
epoch:  59 val_f1:  0.8022296544035674 val_auroc:  0.8859126984126985 val_auprc:  0.94235289059184
EarlyStopping counter: 46 out of 50
epoch:  59
epoch:  60 val_f1:  0.8115942028985508 val_auroc:  0.8871527777777779 val_auprc:  0.9423025376004248
EarlyStopping counter: 47 out of 50
epoch:  60
epoch:  61 val_f1:  0.8088065661047027 val_auroc:  0.8834325396825399 val_auprc:  0.9402600141403987
EarlyStopping counter: 48 out of 50
epoch:  61
epoch:  62 val_f1:  0.8022296544035674 val_auroc:  0.8851686507936508 val_auprc:  0.9418454915970604
EarlyStopping counter: 49 out of 50
epoch:  62
epoch:  63 val_f1:  0.8194319840387783 val_auroc:  0.8876488095238095 val_auprc:  0.9426904535456325
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  176.92945623397827
{'time_elapsed': [176.92945623397827], 'epoch': [62], 'fold': [4], 'f1_train': [0.9946175537860844], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8194319840387783], 'auroc_test': [0.8876488095238095], 'auprc_test': [0.9426904535456325]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 512, 427]            2,048
│    └─BatchNorm1d: 2-2                  [64, 512, 427]            1,024
│    └─Tanh: 2-3                         [64, 512, 427]            --
│    └─MaxPool1d: 2-4                    [64, 512, 142]            --
│    └─Dropout: 2-5                      [64, 512, 142]            --
│    └─Flatten: 2-6                      [64, 72704]               --
│    └─Linear: 2-7                       [64, 1]                   72,705
==========================================================================================
Total params: 75,777
Trainable params: 75,777
Non-trainable params: 0
Total mult-adds (M): 60.69
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 223.87
Params size (MB): 0.30
Estimated Total Size (MB): 224.50
==========================================================================================
