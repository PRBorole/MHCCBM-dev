config:  {'project': 'MHCCBM', 'name': 'CNN_4', 'config': {'hidden_channels': [1024], 'epochs': 500, 'kernel_size': 3, 'pool_kernel_size': 3, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6413571845226521 val_auroc:  0.632793323514973 val_auprc:  0.8257952587367698
epoch:  1
epoch:  2 val_f1:  0.5846695524935984 val_auroc:  0.6903534609720178 val_auprc:  0.8370178507475579
Validation loss improved to 8.161408
epoch:  2
epoch:  3 val_f1:  0.6680342728469744 val_auroc:  0.7293814432989691 val_auprc:  0.8527095962952667
Validation loss improved to 3.883821
epoch:  3
epoch:  4 val_f1:  0.6960581600537912 val_auroc:  0.7783505154639176 val_auprc:  0.9022911893988838
Validation loss improved to 1.931484
epoch:  4
epoch:  5 val_f1:  0.4384940749826838 val_auroc:  0.7871870397643594 val_auprc:  0.9091688268788976
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.7150229029574715 val_auroc:  0.7999509081983309 val_auprc:  0.9142444947255451
Validation loss improved to 1.296696
epoch:  6
epoch:  7 val_f1:  0.7289242247644242 val_auroc:  0.79553264604811 val_auprc:  0.9058370685202253
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.7748426784519089 val_auroc:  0.8095238095238095 val_auprc:  0.9178001476105642
Validation loss improved to 1.054036
epoch:  8
epoch:  9 val_f1:  0.7048707252685248 val_auroc:  0.8166421207658321 val_auprc:  0.9232819572201663
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.4384940749826838 val_auroc:  0.8095238095238095 val_auprc:  0.9168208895106541
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.5736495549323253 val_auroc:  0.7863279332351497 val_auprc:  0.8982171794019714
EarlyStopping counter: 3 out of 50
epoch:  11
epoch:  12 val_f1:  0.6977368320649064 val_auroc:  0.7810505645557191 val_auprc:  0.894039795076069
EarlyStopping counter: 4 out of 50
epoch:  12
epoch:  13 val_f1:  0.6869909576925616 val_auroc:  0.8013009327442318 val_auprc:  0.9092520813729457
EarlyStopping counter: 5 out of 50
epoch:  13
epoch:  14 val_f1:  0.72389147505525 val_auroc:  0.8267059401080019 val_auprc:  0.9289603281967458
EarlyStopping counter: 6 out of 50
epoch:  14
epoch:  15 val_f1:  0.7707245329923307 val_auroc:  0.8338242513500246 val_auprc:  0.9318404639526661
EarlyStopping counter: 7 out of 50
epoch:  15
epoch:  16 val_f1:  0.7681512331200245 val_auroc:  0.8240058910162004 val_auprc:  0.9236013770559753
EarlyStopping counter: 8 out of 50
epoch:  16
epoch:  17 val_f1:  0.7712620601193464 val_auroc:  0.8249877270495828 val_auprc:  0.9245093541294997
EarlyStopping counter: 9 out of 50
epoch:  17
epoch:  18 val_f1:  0.7412236216203913 val_auroc:  0.8205694648993618 val_auprc:  0.9210741545218557
EarlyStopping counter: 10 out of 50
epoch:  18
epoch:  19 val_f1:  0.5291995544286862 val_auroc:  0.8166421207658321 val_auprc:  0.9174267428399592
EarlyStopping counter: 11 out of 50
epoch:  19
epoch:  20 val_f1:  0.7672775806504117 val_auroc:  0.8328424153166422 val_auprc:  0.9296988029320252
Validation loss improved to 1.038703
epoch:  20
epoch:  21 val_f1:  0.7762067639678805 val_auroc:  0.8217967599410898 val_auprc:  0.9203846051207746
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7791090204759269 val_auroc:  0.8176239567992145 val_auprc:  0.9184405340214097
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.6103487445977881 val_auroc:  0.8149239077074129 val_auprc:  0.9147940937262017
EarlyStopping counter: 3 out of 50
epoch:  23
epoch:  24 val_f1:  0.7598715939807772 val_auroc:  0.818605792832597 val_auprc:  0.9188410566286626
EarlyStopping counter: 4 out of 50
epoch:  24
epoch:  25 val_f1:  0.7651358509506568 val_auroc:  0.8389788905252823 val_auprc:  0.9326366096403633
Validation loss improved to 0.914585
epoch:  25
epoch:  26 val_f1:  0.7446505962267806 val_auroc:  0.8181148748159057 val_auprc:  0.9171515675904798
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7107661257285465 val_auroc:  0.822287677957781 val_auprc:  0.9187088962894377
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7448635686045757 val_auroc:  0.8220422189494354 val_auprc:  0.9208705539531769
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.720403844991234 val_auroc:  0.8321060382916053 val_auprc:  0.9270662211721403
EarlyStopping counter: 4 out of 50
epoch:  29
epoch:  30 val_f1:  0.6701115887475777 val_auroc:  0.8321060382916053 val_auprc:  0.9256945221322173
EarlyStopping counter: 5 out of 50
epoch:  30
epoch:  31 val_f1:  0.7580594896895918 val_auroc:  0.8328424153166422 val_auprc:  0.9283986288717124
EarlyStopping counter: 6 out of 50
epoch:  31
epoch:  32 val_f1:  0.7096759374109908 val_auroc:  0.825478645066274 val_auprc:  0.9206721859581585
EarlyStopping counter: 7 out of 50
epoch:  32
epoch:  33 val_f1:  0.7633714058926586 val_auroc:  0.8264604810996564 val_auprc:  0.9225122478835476
EarlyStopping counter: 8 out of 50
epoch:  33
epoch:  34 val_f1:  0.7661184054361647 val_auroc:  0.8286696121747669 val_auprc:  0.9240546733757627
EarlyStopping counter: 9 out of 50
epoch:  34
epoch:  35 val_f1:  0.7473654218886486 val_auroc:  0.8308787432498773 val_auprc:  0.9266273400990183
EarlyStopping counter: 10 out of 50
epoch:  35
epoch:  36 val_f1:  0.7777125328082551 val_auroc:  0.8225331369661266 val_auprc:  0.9187036734137686
EarlyStopping counter: 11 out of 50
epoch:  36
epoch:  37 val_f1:  0.7643829551743221 val_auroc:  0.8225331369661266 val_auprc:  0.9186172879433979
EarlyStopping counter: 12 out of 50
epoch:  37
epoch:  38 val_f1:  0.7857445835239322 val_auroc:  0.8244968090328915 val_auprc:  0.92063191244057
EarlyStopping counter: 13 out of 50
epoch:  38
epoch:  39 val_f1:  0.7790721385700611 val_auroc:  0.8306332842415317 val_auprc:  0.9255598816994434
EarlyStopping counter: 14 out of 50
epoch:  39
epoch:  40 val_f1:  0.7697841726618705 val_auroc:  0.8257241040746195 val_auprc:  0.9222753396013684
EarlyStopping counter: 15 out of 50
epoch:  40
epoch:  41 val_f1:  0.7643829551743221 val_auroc:  0.8217967599410898 val_auprc:  0.9192027320378068
EarlyStopping counter: 16 out of 50
epoch:  41
epoch:  42 val_f1:  0.7596459003010357 val_auroc:  0.8252331860579283 val_auprc:  0.9187034035835501
EarlyStopping counter: 17 out of 50
epoch:  42
epoch:  43 val_f1:  0.7841726618705036 val_auroc:  0.8267059401080019 val_auprc:  0.9199923772655224
EarlyStopping counter: 18 out of 50
epoch:  43
epoch:  44 val_f1:  0.7553956834532374 val_auroc:  0.8308787432498772 val_auprc:  0.9237705631628825
EarlyStopping counter: 19 out of 50
epoch:  44
epoch:  45 val_f1:  0.766354189375772 val_auroc:  0.8357879234167894 val_auprc:  0.9280866864443201
EarlyStopping counter: 20 out of 50
epoch:  45
epoch:  46 val_f1:  0.7813819697019021 val_auroc:  0.8269513991163476 val_auprc:  0.9215476783325822
EarlyStopping counter: 21 out of 50
epoch:  46
epoch:  47 val_f1:  0.7661184054361647 val_auroc:  0.8276877761413843 val_auprc:  0.9213501582952754
EarlyStopping counter: 22 out of 50
epoch:  47
epoch:  48 val_f1:  0.7725930260576229 val_auroc:  0.8291605301914581 val_auprc:  0.9227604898799663
EarlyStopping counter: 23 out of 50
epoch:  48
epoch:  49 val_f1:  0.7762067639678805 val_auroc:  0.8267059401080019 val_auprc:  0.9217500149232238
EarlyStopping counter: 24 out of 50
epoch:  49
epoch:  50 val_f1:  0.7661184054361647 val_auroc:  0.8257241040746195 val_auprc:  0.9208716038437224
EarlyStopping counter: 25 out of 50
epoch:  50
epoch:  51 val_f1:  0.7737843767539161 val_auroc:  0.8262150220913107 val_auprc:  0.9202786749436197
EarlyStopping counter: 26 out of 50
epoch:  51
epoch:  52 val_f1:  0.7737843767539161 val_auroc:  0.8249877270495828 val_auprc:  0.9203072192593917
EarlyStopping counter: 27 out of 50
epoch:  52
epoch:  53 val_f1:  0.7531731915989216 val_auroc:  0.8311242022582228 val_auprc:  0.9258091978152445
EarlyStopping counter: 28 out of 50
epoch:  53
epoch:  54 val_f1:  0.7596459003010357 val_auroc:  0.8257241040746195 val_auprc:  0.9204571102973657
EarlyStopping counter: 29 out of 50
epoch:  54
epoch:  55 val_f1:  0.7790721385700611 val_auroc:  0.8279332351497299 val_auprc:  0.9216500032685327
EarlyStopping counter: 30 out of 50
epoch:  55
epoch:  56 val_f1:  0.7737843767539161 val_auroc:  0.830387825233186 val_auprc:  0.9243446360540271
EarlyStopping counter: 31 out of 50
epoch:  56
epoch:  57 val_f1:  0.7745465218349855 val_auroc:  0.8281786941580755 val_auprc:  0.9221801645931311
EarlyStopping counter: 32 out of 50
epoch:  57
epoch:  58 val_f1:  0.7762067639678805 val_auroc:  0.8284241531664212 val_auprc:  0.9230033436621317
EarlyStopping counter: 33 out of 50
epoch:  58
epoch:  59 val_f1:  0.7826417810500232 val_auroc:  0.8276877761413843 val_auprc:  0.9222301853594637
EarlyStopping counter: 34 out of 50
epoch:  59
epoch:  60 val_f1:  0.7745465218349855 val_auroc:  0.8276877761413843 val_auprc:  0.92245831877184
EarlyStopping counter: 35 out of 50
epoch:  60
epoch:  61 val_f1:  0.7745465218349855 val_auroc:  0.830387825233186 val_auprc:  0.9247485148988914
EarlyStopping counter: 36 out of 50
epoch:  61
epoch:  62 val_f1:  0.7920536597238516 val_auroc:  0.825478645066274 val_auprc:  0.9200446102759605
EarlyStopping counter: 37 out of 50
epoch:  62
epoch:  63 val_f1:  0.7725930260576229 val_auroc:  0.8259695630829651 val_auprc:  0.9208345631989887
EarlyStopping counter: 38 out of 50
epoch:  63
epoch:  64 val_f1:  0.7725930260576229 val_auroc:  0.8281786941580757 val_auprc:  0.922726403853873
EarlyStopping counter: 39 out of 50
epoch:  64
epoch:  65 val_f1:  0.7841726618705036 val_auroc:  0.82793323514973 val_auprc:  0.9235942378427354
EarlyStopping counter: 40 out of 50
epoch:  65
epoch:  66 val_f1:  0.7841726618705036 val_auroc:  0.8267059401080019 val_auprc:  0.9216906180396864
EarlyStopping counter: 41 out of 50
epoch:  66
epoch:  67 val_f1:  0.7841726618705036 val_auroc:  0.8276877761413843 val_auprc:  0.9225341209819972
EarlyStopping counter: 42 out of 50
epoch:  67
epoch:  68 val_f1:  0.7841726618705036 val_auroc:  0.82793323514973 val_auprc:  0.9225671975370806
EarlyStopping counter: 43 out of 50
epoch:  68
epoch:  69 val_f1:  0.7826417810500232 val_auroc:  0.8286696121747668 val_auprc:  0.9231426230873542
EarlyStopping counter: 44 out of 50
epoch:  69
epoch:  70 val_f1:  0.7826417810500232 val_auroc:  0.82793323514973 val_auprc:  0.9224825693458449
EarlyStopping counter: 45 out of 50
epoch:  70
epoch:  71 val_f1:  0.766354189375772 val_auroc:  0.8281786941580755 val_auprc:  0.9230787439341038
EarlyStopping counter: 46 out of 50
epoch:  71
epoch:  72 val_f1:  0.7920536597238516 val_auroc:  0.8286696121747669 val_auprc:  0.9234580174060305
EarlyStopping counter: 47 out of 50
epoch:  72
epoch:  73 val_f1:  0.7725930260576229 val_auroc:  0.8259695630829651 val_auprc:  0.9210731973126138
EarlyStopping counter: 48 out of 50
epoch:  73
epoch:  74 val_f1:  0.7725930260576229 val_auroc:  0.8274423171330387 val_auprc:  0.9221799074314856
EarlyStopping counter: 49 out of 50
epoch:  74
epoch:  75 val_f1:  0.7826417810500232 val_auroc:  0.8301423662248404 val_auprc:  0.9245988619178016
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  1978.7965412139893
{'time_elapsed': [1978.7965412139893], 'epoch': [74], 'fold': [0], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7826417810500232], 'auroc_test': [0.8301423662248404], 'auprc_test': [0.9245988619178016]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1278]          --
│    └─Dropout: 2-5                      [64, 1024, 1278]          --
│    └─Flatten: 2-6                      [64, 1308672]             --
│    └─Linear: 2-7                       [64, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 419.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1342.18
Params size (MB): 5.26
Estimated Total Size (MB): 1347.76
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6835594973158149 val_auroc:  0.6491163475699558 val_auprc:  0.8242412559983989
epoch:  1
epoch:  2 val_f1:  0.5470220838254769 val_auroc:  0.742513500245459 val_auprc:  0.8973747206216952
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6507914448365483 val_auroc:  0.732572410407462 val_auprc:  0.888148399634373
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6963686193902022 val_auroc:  0.7592047128129602 val_auprc:  0.8999908157086406
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.7235008927723722 val_auroc:  0.7933235149729996 val_auprc:  0.9158218887233246
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6709686326133335 val_auroc:  0.8134511536573392 val_auprc:  0.9240159971516112
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.7567268683783295 val_auroc:  0.8151693667157585 val_auprc:  0.9235476526674408
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.7712620601193464 val_auroc:  0.8205694648993618 val_auprc:  0.924154611620191
Validation loss improved to 0.620480
epoch:  8
epoch:  9 val_f1:  0.5291995544286862 val_auroc:  0.8186057928325969 val_auprc:  0.9217533581302245
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.667134140788635 val_auroc:  0.8154148257241041 val_auprc:  0.9164066049999239
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.720403844991234 val_auroc:  0.8150466372115858 val_auprc:  0.9110411054979239
Validation loss improved to 0.294857
epoch:  11
epoch:  12 val_f1:  0.770628190185282 val_auroc:  0.8136966126656848 val_auprc:  0.9128897662923494
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.549938011479797 val_auroc:  0.8132056946489936 val_auprc:  0.9145652276485173
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.5786297498732648 val_auroc:  0.7995827196858125 val_auprc:  0.9089000301593009
EarlyStopping counter: 3 out of 50
epoch:  14
epoch:  15 val_f1:  0.5936560505671176 val_auroc:  0.7974963181148749 val_auprc:  0.9080178511206729
EarlyStopping counter: 4 out of 50
epoch:  15
epoch:  16 val_f1:  0.5324098929811375 val_auroc:  0.8043691703485518 val_auprc:  0.9126505099941576
EarlyStopping counter: 5 out of 50
epoch:  16
epoch:  17 val_f1:  0.7359858855314679 val_auroc:  0.7981099656357389 val_auprc:  0.908283135871023
EarlyStopping counter: 6 out of 50
epoch:  17
epoch:  18 val_f1:  0.6276318729626881 val_auroc:  0.8087874324987727 val_auprc:  0.9141967569292053
EarlyStopping counter: 7 out of 50
epoch:  18
epoch:  19 val_f1:  0.6758292290898464 val_auroc:  0.8264604810996564 val_auprc:  0.9228471424518785
EarlyStopping counter: 8 out of 50
epoch:  19
epoch:  20 val_f1:  0.7823449348629204 val_auroc:  0.829160530191458 val_auprc:  0.9275164972625412
EarlyStopping counter: 9 out of 50
epoch:  20
epoch:  21 val_f1:  0.7855581813618873 val_auroc:  0.8199558173784979 val_auprc:  0.9206016642213346
EarlyStopping counter: 10 out of 50
epoch:  21
epoch:  22 val_f1:  0.7711689349644636 val_auroc:  0.8252331860579284 val_auprc:  0.9217683243551676
EarlyStopping counter: 11 out of 50
epoch:  22
epoch:  23 val_f1:  0.6636982464578685 val_auroc:  0.8253559155621011 val_auprc:  0.9189505982166186
EarlyStopping counter: 12 out of 50
epoch:  23
epoch:  24 val_f1:  0.7442757932382417 val_auroc:  0.8244968090328915 val_auprc:  0.9179792906427315
EarlyStopping counter: 13 out of 50
epoch:  24
epoch:  25 val_f1:  0.7698533480907581 val_auroc:  0.8317378497790869 val_auprc:  0.921411725103908
Validation loss improved to 0.237222
epoch:  25
epoch:  26 val_f1:  0.7841726618705036 val_auroc:  0.8301423662248405 val_auprc:  0.9201386636939072
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7699730743399811 val_auroc:  0.8264604810996564 val_auprc:  0.9207110623081285
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7298678635622811 val_auroc:  0.8267059401080019 val_auprc:  0.9200824617001961
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.4687124200932509 val_auroc:  0.8333333333333334 val_auprc:  0.9237462843204052
EarlyStopping counter: 4 out of 50
epoch:  29
epoch:  30 val_f1:  0.6954243384953055 val_auroc:  0.8321060382916053 val_auprc:  0.92661319341431
EarlyStopping counter: 5 out of 50
epoch:  30
epoch:  31 val_f1:  0.6125966307699182 val_auroc:  0.8330878743249878 val_auprc:  0.928569447696818
EarlyStopping counter: 6 out of 50
epoch:  31
epoch:  32 val_f1:  0.7446689355102744 val_auroc:  0.8316151202749141 val_auprc:  0.9275297559996227
EarlyStopping counter: 7 out of 50
epoch:  32
epoch:  33 val_f1:  0.6814979364470806 val_auroc:  0.842292587137948 val_auprc:  0.930133189460403
EarlyStopping counter: 8 out of 50
epoch:  33
epoch:  34 val_f1:  0.7826417810500232 val_auroc:  0.8328424153166422 val_auprc:  0.9238015669911707
EarlyStopping counter: 9 out of 50
epoch:  34
epoch:  35 val_f1:  0.7307708780682615 val_auroc:  0.8382425135002455 val_auprc:  0.9259783306721613
EarlyStopping counter: 10 out of 50
epoch:  35
epoch:  36 val_f1:  0.7359369647139431 val_auroc:  0.8346833578792342 val_auprc:  0.9203629281728539
EarlyStopping counter: 11 out of 50
epoch:  36
epoch:  37 val_f1:  0.799854302604428 val_auroc:  0.8313696612665685 val_auprc:  0.9208436751671677
EarlyStopping counter: 12 out of 50
epoch:  37
epoch:  38 val_f1:  0.726400389202679 val_auroc:  0.8233922434953364 val_auprc:  0.9137606387569677
Validation loss improved to 0.205270
epoch:  38
epoch:  39 val_f1:  0.7831873586549224 val_auroc:  0.8206921944035347 val_auprc:  0.9130162072178631
EarlyStopping counter: 1 out of 50
epoch:  39
epoch:  40 val_f1:  0.7699730743399811 val_auroc:  0.8259695630829652 val_auprc:  0.9157951957009652
EarlyStopping counter: 2 out of 50
epoch:  40
epoch:  41 val_f1:  0.6982612029498659 val_auroc:  0.8206921944035346 val_auprc:  0.9099005255178221
EarlyStopping counter: 3 out of 50
epoch:  41
epoch:  42 val_f1:  0.6919083601043694 val_auroc:  0.8294059891998037 val_auprc:  0.9120867111601442
EarlyStopping counter: 4 out of 50
epoch:  42
epoch:  43 val_f1:  0.7985611510791367 val_auroc:  0.8281786941580757 val_auprc:  0.9159826394579791
EarlyStopping counter: 5 out of 50
epoch:  43
epoch:  44 val_f1:  0.7024482739389885 val_auroc:  0.8290378006872853 val_auprc:  0.9171140903802804
EarlyStopping counter: 6 out of 50
epoch:  44
epoch:  45 val_f1:  0.7346160281077464 val_auroc:  0.8386107020127639 val_auprc:  0.9189174373809414
Validation loss improved to 0.144709
epoch:  45
epoch:  46 val_f1:  0.7954863587533922 val_auroc:  0.834806087383407 val_auprc:  0.9192210109608293
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.7685409504908388 val_auroc:  0.8295287187039765 val_auprc:  0.91231033179706
Validation loss improved to 0.058581
epoch:  47
epoch:  48 val_f1:  0.7510724063582411 val_auroc:  0.8343151693667158 val_auprc:  0.914053641437724
EarlyStopping counter: 1 out of 50
epoch:  48
epoch:  49 val_f1:  0.7635640416019908 val_auroc:  0.8489199803632793 val_auprc:  0.923214896721792
EarlyStopping counter: 2 out of 50
epoch:  49
epoch:  50 val_f1:  0.7670032041593616 val_auroc:  0.8345606283750613 val_auprc:  0.9135474157159253
EarlyStopping counter: 3 out of 50
epoch:  50
epoch:  51 val_f1:  0.7791090204759269 val_auroc:  0.8334560628375062 val_auprc:  0.9125869503579189
EarlyStopping counter: 4 out of 50
epoch:  51
epoch:  52 val_f1:  0.7685409504908388 val_auroc:  0.8328424153166423 val_auprc:  0.9127679379912345
EarlyStopping counter: 5 out of 50
epoch:  52
epoch:  53 val_f1:  0.7483101088021195 val_auroc:  0.8296514482081492 val_auprc:  0.9127910703485983
EarlyStopping counter: 6 out of 50
epoch:  53
epoch:  54 val_f1:  0.7607401077265918 val_auroc:  0.8302650957290132 val_auprc:  0.9130454883365556
EarlyStopping counter: 7 out of 50
epoch:  54
epoch:  55 val_f1:  0.7955599157038007 val_auroc:  0.8240058910162004 val_auprc:  0.906541636542623
EarlyStopping counter: 8 out of 50
epoch:  55
epoch:  56 val_f1:  0.7873856121514594 val_auroc:  0.8236377025036818 val_auprc:  0.9062047901809672
EarlyStopping counter: 9 out of 50
epoch:  56
epoch:  57 val_f1:  0.7607401077265918 val_auroc:  0.8211831124202258 val_auprc:  0.9029306966857369
EarlyStopping counter: 10 out of 50
epoch:  57
epoch:  58 val_f1:  0.7685409504908388 val_auroc:  0.8249877270495828 val_auprc:  0.9056442041504281
EarlyStopping counter: 11 out of 50
epoch:  58
epoch:  59 val_f1:  0.7791090204759269 val_auroc:  0.8247422680412372 val_auprc:  0.9050753617570761
EarlyStopping counter: 12 out of 50
epoch:  59
epoch:  60 val_f1:  0.7707245329923307 val_auroc:  0.8205694648993618 val_auprc:  0.9052917113196332
EarlyStopping counter: 13 out of 50
epoch:  60
epoch:  61 val_f1:  0.742136387976997 val_auroc:  0.8237604320078546 val_auprc:  0.907460001056218
EarlyStopping counter: 14 out of 50
epoch:  61
epoch:  62 val_f1:  0.7598715939807772 val_auroc:  0.8251104565537556 val_auprc:  0.9065964221639172
EarlyStopping counter: 15 out of 50
epoch:  62
epoch:  63 val_f1:  0.7707245329923307 val_auroc:  0.8227785959744722 val_auprc:  0.9039068125401253
EarlyStopping counter: 16 out of 50
epoch:  63
epoch:  64 val_f1:  0.7791090204759269 val_auroc:  0.8225331369661267 val_auprc:  0.9028909945401506
EarlyStopping counter: 17 out of 50
epoch:  64
epoch:  65 val_f1:  0.7707245329923307 val_auroc:  0.8231467844869906 val_auprc:  0.9033829758769376
EarlyStopping counter: 18 out of 50
epoch:  65
epoch:  66 val_f1:  0.7707245329923307 val_auroc:  0.8238831615120276 val_auprc:  0.9051338813784824
EarlyStopping counter: 19 out of 50
epoch:  66
epoch:  67 val_f1:  0.7707245329923307 val_auroc:  0.8225331369661267 val_auprc:  0.9062958551610919
EarlyStopping counter: 20 out of 50
epoch:  67
epoch:  68 val_f1:  0.7635640416019908 val_auroc:  0.8249877270495827 val_auprc:  0.9073365187589345
EarlyStopping counter: 21 out of 50
epoch:  68
epoch:  69 val_f1:  0.7707245329923307 val_auroc:  0.8231467844869906 val_auprc:  0.9050143984589636
EarlyStopping counter: 22 out of 50
epoch:  69
epoch:  70 val_f1:  0.7748796193569787 val_auroc:  0.8249877270495827 val_auprc:  0.9072729136811336
EarlyStopping counter: 23 out of 50
epoch:  70
epoch:  71 val_f1:  0.7748796193569787 val_auroc:  0.8242513500245459 val_auprc:  0.9065673845370307
EarlyStopping counter: 24 out of 50
epoch:  71
epoch:  72 val_f1:  0.7812454480117876 val_auroc:  0.8238831615120275 val_auprc:  0.9016679262005394
EarlyStopping counter: 25 out of 50
epoch:  72
epoch:  73 val_f1:  0.7724732835091151 val_auroc:  0.8243740795287187 val_auprc:  0.9067478098445657
EarlyStopping counter: 26 out of 50
epoch:  73
epoch:  74 val_f1:  0.7724732835091151 val_auroc:  0.8198330878743251 val_auprc:  0.9001202602525732
EarlyStopping counter: 27 out of 50
epoch:  74
epoch:  75 val_f1:  0.7770871369605723 val_auroc:  0.8243740795287187 val_auprc:  0.9055254171424948
EarlyStopping counter: 28 out of 50
epoch:  75
epoch:  76 val_f1:  0.7707245329923307 val_auroc:  0.8248649975454099 val_auprc:  0.9054158526750956
EarlyStopping counter: 29 out of 50
epoch:  76
epoch:  77 val_f1:  0.7707245329923307 val_auroc:  0.8248649975454099 val_auprc:  0.905188259140538
EarlyStopping counter: 30 out of 50
epoch:  77
epoch:  78 val_f1:  0.7707245329923307 val_auroc:  0.8231467844869907 val_auprc:  0.9028988172831485
EarlyStopping counter: 31 out of 50
epoch:  78
epoch:  79 val_f1:  0.7707245329923307 val_auroc:  0.8211831124202259 val_auprc:  0.902750156390043
EarlyStopping counter: 32 out of 50
epoch:  79
epoch:  80 val_f1:  0.7791090204759269 val_auroc:  0.8237604320078546 val_auprc:  0.9018127669352545
EarlyStopping counter: 33 out of 50
epoch:  80
epoch:  81 val_f1:  0.7770871369605723 val_auroc:  0.8248649975454099 val_auprc:  0.9030258626911628
EarlyStopping counter: 34 out of 50
epoch:  81
epoch:  82 val_f1:  0.7770871369605723 val_auroc:  0.8260922925871379 val_auprc:  0.9071384155212285
EarlyStopping counter: 35 out of 50
epoch:  82
epoch:  83 val_f1:  0.7707245329923307 val_auroc:  0.8246195385370643 val_auprc:  0.9053935357756353
EarlyStopping counter: 36 out of 50
epoch:  83
epoch:  84 val_f1:  0.7748796193569787 val_auroc:  0.8259695630829651 val_auprc:  0.9032979554183143
EarlyStopping counter: 37 out of 50
epoch:  84
epoch:  85 val_f1:  0.7635640416019908 val_auroc:  0.8226558664702994 val_auprc:  0.902595519336236
EarlyStopping counter: 38 out of 50
epoch:  85
epoch:  86 val_f1:  0.7545102379634754 val_auroc:  0.821060382916053 val_auprc:  0.9036019425424004
EarlyStopping counter: 39 out of 50
epoch:  86
epoch:  87 val_f1:  0.7635640416019908 val_auroc:  0.8219194894452626 val_auprc:  0.9002911797397521
EarlyStopping counter: 40 out of 50
epoch:  87
epoch:  88 val_f1:  0.7812454480117876 val_auroc:  0.8214285714285714 val_auprc:  0.8982961836148621
EarlyStopping counter: 41 out of 50
epoch:  88
epoch:  89 val_f1:  0.7834737923946559 val_auroc:  0.8262150220913107 val_auprc:  0.9075980044505495
EarlyStopping counter: 42 out of 50
epoch:  89
epoch:  90 val_f1:  0.7834737923946559 val_auroc:  0.8249877270495828 val_auprc:  0.906636085533297
EarlyStopping counter: 43 out of 50
epoch:  90
epoch:  91 val_f1:  0.7707245329923307 val_auroc:  0.8253559155621011 val_auprc:  0.9061927580419363
EarlyStopping counter: 44 out of 50
epoch:  91
epoch:  92 val_f1:  0.7661589271850144 val_auroc:  0.8197103583701522 val_auprc:  0.8989757473665925
EarlyStopping counter: 45 out of 50
epoch:  92
epoch:  93 val_f1:  0.7635640416019908 val_auroc:  0.8199558173784979 val_auprc:  0.9023074893181273
EarlyStopping counter: 46 out of 50
epoch:  93
epoch:  94 val_f1:  0.7770871369605723 val_auroc:  0.8217967599410898 val_auprc:  0.901029061256111
EarlyStopping counter: 47 out of 50
epoch:  94
epoch:  95 val_f1:  0.7707245329923307 val_auroc:  0.8243740795287187 val_auprc:  0.9031497113385907
EarlyStopping counter: 48 out of 50
epoch:  95
epoch:  96 val_f1:  0.7770871369605723 val_auroc:  0.8284241531664212 val_auprc:  0.9090313504892577
EarlyStopping counter: 49 out of 50
epoch:  96
epoch:  97 val_f1:  0.7607401077265918 val_auroc:  0.819833087874325 val_auprc:  0.903189270294412
Validation loss improved to 0.055541
epoch:  97
epoch:  98 val_f1:  0.7661589271850144 val_auroc:  0.8280559646539027 val_auprc:  0.9105023559641754
EarlyStopping counter: 1 out of 50
epoch:  98
epoch:  99 val_f1:  0.7834737923946559 val_auroc:  0.8280559646539027 val_auprc:  0.9094097096134519
EarlyStopping counter: 2 out of 50
epoch:  99
epoch:  100 val_f1:  0.7724732835091151 val_auroc:  0.8225331369661266 val_auprc:  0.901514495584299
EarlyStopping counter: 3 out of 50
epoch:  100
epoch:  101 val_f1:  0.7724732835091151 val_auroc:  0.8217967599410898 val_auprc:  0.903627975131124
EarlyStopping counter: 4 out of 50
epoch:  101
epoch:  102 val_f1:  0.7698533480907581 val_auroc:  0.8230240549828178 val_auprc:  0.9048948784304336
Validation loss improved to 0.053824
epoch:  102
epoch:  103 val_f1:  0.7724732835091151 val_auroc:  0.8226558664702995 val_auprc:  0.9040429754618142
EarlyStopping counter: 1 out of 50
epoch:  103
epoch:  104 val_f1:  0.7770871369605723 val_auroc:  0.8271968581246931 val_auprc:  0.9083642465226057
EarlyStopping counter: 2 out of 50
epoch:  104
epoch:  105 val_f1:  0.7770871369605723 val_auroc:  0.8269513991163476 val_auprc:  0.9094461649761785
EarlyStopping counter: 3 out of 50
epoch:  105
epoch:  106 val_f1:  0.7724732835091151 val_auroc:  0.821060382916053 val_auprc:  0.9041446550002037
EarlyStopping counter: 4 out of 50
epoch:  106
epoch:  107 val_f1:  0.7724732835091151 val_auroc:  0.8202012763868434 val_auprc:  0.902724974674336
EarlyStopping counter: 5 out of 50
epoch:  107
epoch:  108 val_f1:  0.7834737923946559 val_auroc:  0.8209376534118803 val_auprc:  0.9031890714052209
EarlyStopping counter: 6 out of 50
epoch:  108
epoch:  109 val_f1:  0.7834737923946559 val_auroc:  0.8203240058910162 val_auprc:  0.8987418031304053
EarlyStopping counter: 7 out of 50
epoch:  109
epoch:  110 val_f1:  0.7770871369605723 val_auroc:  0.8190967108492881 val_auprc:  0.8980840417505187
EarlyStopping counter: 8 out of 50
epoch:  110
epoch:  111 val_f1:  0.7834737923946559 val_auroc:  0.8197103583701523 val_auprc:  0.9026483499313658
EarlyStopping counter: 9 out of 50
epoch:  111
epoch:  112 val_f1:  0.7770871369605723 val_auroc:  0.8216740304369171 val_auprc:  0.9022187561098192
EarlyStopping counter: 10 out of 50
epoch:  112
epoch:  113 val_f1:  0.7724732835091151 val_auroc:  0.8206921944035346 val_auprc:  0.9031073089063162
EarlyStopping counter: 11 out of 50
epoch:  113
epoch:  114 val_f1:  0.7834737923946559 val_auroc:  0.8211831124202258 val_auprc:  0.903297234679654
EarlyStopping counter: 12 out of 50
epoch:  114
epoch:  115 val_f1:  0.7834737923946559 val_auroc:  0.821674030436917 val_auprc:  0.9035180294464715
EarlyStopping counter: 13 out of 50
epoch:  115
epoch:  116 val_f1:  0.7812454480117876 val_auroc:  0.8216740304369171 val_auprc:  0.9036338499398469
EarlyStopping counter: 14 out of 50
epoch:  116
epoch:  117 val_f1:  0.7770871369605723 val_auroc:  0.8194648993618067 val_auprc:  0.9025774517461673
EarlyStopping counter: 15 out of 50
epoch:  117
epoch:  118 val_f1:  0.7770871369605723 val_auroc:  0.8199558173784978 val_auprc:  0.902729437577358
EarlyStopping counter: 16 out of 50
epoch:  118
epoch:  119 val_f1:  0.7812454480117876 val_auroc:  0.8220422189494354 val_auprc:  0.9036656053840182
EarlyStopping counter: 17 out of 50
epoch:  119
epoch:  120 val_f1:  0.7898876447331801 val_auroc:  0.8209376534118802 val_auprc:  0.9033591925481108
EarlyStopping counter: 18 out of 50
epoch:  120
epoch:  121 val_f1:  0.7770871369605723 val_auroc:  0.8190967108492883 val_auprc:  0.9001731681482122
EarlyStopping counter: 19 out of 50
epoch:  121
epoch:  122 val_f1:  0.7770871369605723 val_auroc:  0.8197103583701522 val_auprc:  0.9028760059910468
EarlyStopping counter: 20 out of 50
epoch:  122
epoch:  123 val_f1:  0.7770871369605723 val_auroc:  0.8190967108492881 val_auprc:  0.9016117366912754
EarlyStopping counter: 21 out of 50
epoch:  123
epoch:  124 val_f1:  0.7770871369605723 val_auroc:  0.8194648993618066 val_auprc:  0.9010780903538291
EarlyStopping counter: 22 out of 50
epoch:  124
epoch:  125 val_f1:  0.7770871369605723 val_auroc:  0.8199558173784978 val_auprc:  0.9027888931579855
EarlyStopping counter: 23 out of 50
epoch:  125
epoch:  126 val_f1:  0.7834737923946559 val_auroc:  0.8206921944035346 val_auprc:  0.9034086250810591
EarlyStopping counter: 24 out of 50
epoch:  126
epoch:  127 val_f1:  0.7770871369605723 val_auroc:  0.8195876288659794 val_auprc:  0.9005203037807855
EarlyStopping counter: 25 out of 50
epoch:  127
epoch:  128 val_f1:  0.7724732835091151 val_auroc:  0.8217967599410898 val_auprc:  0.9044695256865283
EarlyStopping counter: 26 out of 50
epoch:  128
epoch:  129 val_f1:  0.7770871369605723 val_auroc:  0.8199558173784978 val_auprc:  0.903033322920791
EarlyStopping counter: 27 out of 50
epoch:  129
epoch:  130 val_f1:  0.7724732835091151 val_auroc:  0.8213058419243986 val_auprc:  0.9042554318297347
EarlyStopping counter: 28 out of 50
epoch:  130
epoch:  131 val_f1:  0.7770871369605723 val_auroc:  0.8186057928325969 val_auprc:  0.9007511911027237
EarlyStopping counter: 29 out of 50
epoch:  131
epoch:  132 val_f1:  0.7770871369605723 val_auroc:  0.8188512518409425 val_auprc:  0.9000851865333391
EarlyStopping counter: 30 out of 50
epoch:  132
epoch:  133 val_f1:  0.7770871369605723 val_auroc:  0.819219440353461 val_auprc:  0.9028506387782855
EarlyStopping counter: 31 out of 50
epoch:  133
epoch:  134 val_f1:  0.7724732835091151 val_auroc:  0.8195876288659794 val_auprc:  0.903719942099928
EarlyStopping counter: 32 out of 50
epoch:  134
epoch:  135 val_f1:  0.7707245329923307 val_auroc:  0.8208149239077074 val_auprc:  0.9027822828565463
EarlyStopping counter: 33 out of 50
epoch:  135
epoch:  136 val_f1:  0.7770871369605723 val_auroc:  0.8186057928325969 val_auprc:  0.8981609448806174
EarlyStopping counter: 34 out of 50
epoch:  136
epoch:  137 val_f1:  0.7724732835091151 val_auroc:  0.8217967599410898 val_auprc:  0.9043930273971046
EarlyStopping counter: 35 out of 50
epoch:  137
epoch:  138 val_f1:  0.7788179744018625 val_auroc:  0.8194648993618066 val_auprc:  0.904222771225756
Validation loss improved to 0.050869
epoch:  138
epoch:  139 val_f1:  0.7685409504908388 val_auroc:  0.819833087874325 val_auprc:  0.903490754814178
EarlyStopping counter: 1 out of 50
epoch:  139
epoch:  140 val_f1:  0.7770871369605723 val_auroc:  0.8200785468826706 val_auprc:  0.9006759281983315
EarlyStopping counter: 2 out of 50
epoch:  140
epoch:  141 val_f1:  0.7770871369605723 val_auroc:  0.8215513009327442 val_auprc:  0.9029238561243924
EarlyStopping counter: 3 out of 50
epoch:  141
epoch:  142 val_f1:  0.7724732835091151 val_auroc:  0.8205694648993618 val_auprc:  0.9039033756864565
EarlyStopping counter: 4 out of 50
epoch:  142
epoch:  143 val_f1:  0.7724732835091151 val_auroc:  0.8189739813451153 val_auprc:  0.90314346731346
EarlyStopping counter: 5 out of 50
epoch:  143
epoch:  144 val_f1:  0.7770871369605723 val_auroc:  0.8202012763868434 val_auprc:  0.9031400464878008
EarlyStopping counter: 6 out of 50
epoch:  144
epoch:  145 val_f1:  0.7812454480117876 val_auroc:  0.8205694648993618 val_auprc:  0.9040114042738838
EarlyStopping counter: 7 out of 50
epoch:  145
epoch:  146 val_f1:  0.7770871369605723 val_auroc:  0.8206921944035347 val_auprc:  0.9032855502222707
EarlyStopping counter: 8 out of 50
epoch:  146
epoch:  147 val_f1:  0.7748796193569787 val_auroc:  0.8195876288659794 val_auprc:  0.9034141682771657
EarlyStopping counter: 9 out of 50
epoch:  147
epoch:  148 val_f1:  0.7724732835091151 val_auroc:  0.8195876288659794 val_auprc:  0.903488722395049
EarlyStopping counter: 10 out of 50
epoch:  148
epoch:  149 val_f1:  0.7685409504908388 val_auroc:  0.8195876288659794 val_auprc:  0.903524698095854
EarlyStopping counter: 11 out of 50
epoch:  149
epoch:  150 val_f1:  0.7685409504908388 val_auroc:  0.8195876288659794 val_auprc:  0.9033990567376728
EarlyStopping counter: 12 out of 50
epoch:  150
epoch:  151 val_f1:  0.7685409504908388 val_auroc:  0.8200785468826706 val_auprc:  0.9036901883294517
EarlyStopping counter: 13 out of 50
epoch:  151
epoch:  152 val_f1:  0.7685409504908388 val_auroc:  0.8213058419243986 val_auprc:  0.904432583882153
EarlyStopping counter: 14 out of 50
epoch:  152
epoch:  153 val_f1:  0.7770871369605723 val_auroc:  0.8208149239077074 val_auprc:  0.9042543425182994
EarlyStopping counter: 15 out of 50
epoch:  153
epoch:  154 val_f1:  0.7770871369605723 val_auroc:  0.8200785468826706 val_auprc:  0.9038062513602939
EarlyStopping counter: 16 out of 50
epoch:  154
epoch:  155 val_f1:  0.7724732835091151 val_auroc:  0.821060382916053 val_auprc:  0.9042742182568947
EarlyStopping counter: 17 out of 50
epoch:  155
epoch:  156 val_f1:  0.7812454480117876 val_auroc:  0.8208149239077074 val_auprc:  0.9041594003886992
EarlyStopping counter: 18 out of 50
epoch:  156
epoch:  157 val_f1:  0.7770871369605723 val_auroc:  0.8209376534118802 val_auprc:  0.9034465518119075
EarlyStopping counter: 19 out of 50
epoch:  157
epoch:  158 val_f1:  0.7724732835091151 val_auroc:  0.8213058419243986 val_auprc:  0.9043544650305366
EarlyStopping counter: 20 out of 50
epoch:  158
epoch:  159 val_f1:  0.7724732835091151 val_auroc:  0.8213058419243987 val_auprc:  0.9042949768785404
EarlyStopping counter: 21 out of 50
epoch:  159
epoch:  160 val_f1:  0.7770871369605723 val_auroc:  0.8213058419243986 val_auprc:  0.9043614645399689
EarlyStopping counter: 22 out of 50
epoch:  160
epoch:  161 val_f1:  0.7685409504908388 val_auroc:  0.8213058419243987 val_auprc:  0.9043791438249653
EarlyStopping counter: 23 out of 50
epoch:  161
epoch:  162 val_f1:  0.7812454480117876 val_auroc:  0.8205694648993618 val_auprc:  0.9040974844027063
EarlyStopping counter: 24 out of 50
epoch:  162
epoch:  163 val_f1:  0.7770871369605723 val_auroc:  0.8200785468826706 val_auprc:  0.9038416967435403
EarlyStopping counter: 25 out of 50
epoch:  163
epoch:  164 val_f1:  0.7685409504908388 val_auroc:  0.8213058419243986 val_auprc:  0.9042972685570165
EarlyStopping counter: 26 out of 50
epoch:  164
epoch:  165 val_f1:  0.7685409504908388 val_auroc:  0.8203240058910162 val_auprc:  0.9035748497510847
EarlyStopping counter: 27 out of 50
epoch:  165
epoch:  166 val_f1:  0.7770871369605723 val_auroc:  0.8208149239077074 val_auprc:  0.904058584800953
EarlyStopping counter: 28 out of 50
epoch:  166
epoch:  167 val_f1:  0.7770871369605723 val_auroc:  0.8210603829160531 val_auprc:  0.9042494556171103
EarlyStopping counter: 29 out of 50
epoch:  167
epoch:  168 val_f1:  0.7788179744018625 val_auroc:  0.8209376534118802 val_auprc:  0.9049026619500592
EarlyStopping counter: 30 out of 50
epoch:  168
epoch:  169 val_f1:  0.7770871369605723 val_auroc:  0.8199558173784978 val_auprc:  0.9030547982047481
EarlyStopping counter: 31 out of 50
epoch:  169
epoch:  170 val_f1:  0.7748796193569787 val_auroc:  0.820446735395189 val_auprc:  0.9044821614783793
EarlyStopping counter: 32 out of 50
epoch:  170
epoch:  171 val_f1:  0.7685409504908388 val_auroc:  0.8205694648993618 val_auprc:  0.9040785242671276
EarlyStopping counter: 33 out of 50
epoch:  171
epoch:  172 val_f1:  0.7685409504908388 val_auroc:  0.8213058419243986 val_auprc:  0.9043736724686546
EarlyStopping counter: 34 out of 50
epoch:  172
epoch:  173 val_f1:  0.7748796193569787 val_auroc:  0.8200785468826706 val_auprc:  0.9038642508169052
EarlyStopping counter: 35 out of 50
epoch:  173
epoch:  174 val_f1:  0.7685409504908388 val_auroc:  0.8205694648993618 val_auprc:  0.904065015626925
EarlyStopping counter: 36 out of 50
epoch:  174
epoch:  175 val_f1:  0.7748796193569787 val_auroc:  0.8206921944035346 val_auprc:  0.904833730104907
EarlyStopping counter: 37 out of 50
epoch:  175
epoch:  176 val_f1:  0.7770871369605723 val_auroc:  0.819833087874325 val_auprc:  0.9037056763601385
EarlyStopping counter: 38 out of 50
epoch:  176
epoch:  177 val_f1:  0.7724732835091151 val_auroc:  0.8202012763868434 val_auprc:  0.9046208652418792
EarlyStopping counter: 39 out of 50
epoch:  177
epoch:  178 val_f1:  0.7770871369605723 val_auroc:  0.8199558173784978 val_auprc:  0.9037174428262955
EarlyStopping counter: 40 out of 50
epoch:  178
epoch:  179 val_f1:  0.7685409504908388 val_auroc:  0.820446735395189 val_auprc:  0.9046946513595986
EarlyStopping counter: 41 out of 50
epoch:  179
epoch:  180 val_f1:  0.7770871369605723 val_auroc:  0.8205694648993618 val_auprc:  0.9039943417005372
EarlyStopping counter: 42 out of 50
epoch:  180
epoch:  181 val_f1:  0.7685409504908388 val_auroc:  0.8206921944035346 val_auprc:  0.9048166049369575
EarlyStopping counter: 43 out of 50
epoch:  181
epoch:  182 val_f1:  0.7685409504908388 val_auroc:  0.8203240058910162 val_auprc:  0.9039547519253059
EarlyStopping counter: 44 out of 50
epoch:  182
epoch:  183 val_f1:  0.7685409504908388 val_auroc:  0.819833087874325 val_auprc:  0.9037133480671222
EarlyStopping counter: 45 out of 50
epoch:  183
epoch:  184 val_f1:  0.7724732835091151 val_auroc:  0.820446735395189 val_auprc:  0.9047146233774632
EarlyStopping counter: 46 out of 50
epoch:  184
epoch:  185 val_f1:  0.7770871369605723 val_auroc:  0.819833087874325 val_auprc:  0.9037299757060078
EarlyStopping counter: 47 out of 50
epoch:  185
epoch:  186 val_f1:  0.7685409504908388 val_auroc:  0.8202012763868434 val_auprc:  0.9046169719883598
EarlyStopping counter: 48 out of 50
epoch:  186
epoch:  187 val_f1:  0.7685409504908388 val_auroc:  0.8204467353951891 val_auprc:  0.9046904982637398
EarlyStopping counter: 49 out of 50
epoch:  187
epoch:  188 val_f1:  0.7685409504908388 val_auroc:  0.820446735395189 val_auprc:  0.90472870421873
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  4982.664652347565
{'time_elapsed': [4982.664652347565], 'epoch': [187], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7685409504908388], 'auroc_test': [0.820446735395189], 'auprc_test': [0.90472870421873]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1278]          --
│    └─Dropout: 2-5                      [64, 1024, 1278]          --
│    └─Flatten: 2-6                      [64, 1308672]             --
│    └─Linear: 2-7                       [64, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 419.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1342.18
Params size (MB): 5.26
Estimated Total Size (MB): 1347.76
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.4593489387594402 val_auroc:  0.6050564555719196 val_auprc:  0.7996827418427728
epoch:  1
epoch:  2 val_f1:  0.49186549683202907 val_auroc:  0.5980608738340697 val_auprc:  0.802469096780406
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.5780648295505975 val_auroc:  0.5926607756504664 val_auprc:  0.7926838191680446
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5922235621907098 val_auroc:  0.5938880706921944 val_auprc:  0.7962304124004211
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6243719844883857 val_auroc:  0.6075110456553755 val_auprc:  0.8055059037885033
Validation loss improved to 4.237964
epoch:  5
epoch:  6 val_f1:  0.6685468572899804 val_auroc:  0.662739322533137 val_auprc:  0.836697955574847
Validation loss improved to 3.436385
epoch:  6
epoch:  7 val_f1:  0.6275324702318319 val_auroc:  0.6529209621993126 val_auprc:  0.8407005026807255
Validation loss improved to 3.112018
epoch:  7
epoch:  8 val_f1:  0.6478524017972046 val_auroc:  0.7025036818851252 val_auprc:  0.8603505994819898
Validation loss improved to 2.667226
epoch:  8
epoch:  9 val_f1:  0.49614561988662703 val_auroc:  0.7108492881688758 val_auprc:  0.8648569777501027
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.6616621115306476 val_auroc:  0.7166175748649976 val_auprc:  0.8639113026555076
Validation loss improved to 1.921926
epoch:  10
epoch:  11 val_f1:  0.66505973282868 val_auroc:  0.6986990672557682 val_auprc:  0.853792697396847
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.6994072447658564 val_auroc:  0.7259450171821307 val_auprc:  0.8682557178934971
Validation loss improved to 1.400443
epoch:  12
epoch:  13 val_f1:  0.6956980834430598 val_auroc:  0.7357633775159548 val_auprc:  0.8683358966601081
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7009452472327455 val_auroc:  0.7229995090819834 val_auprc:  0.858957353734198
EarlyStopping counter: 2 out of 50
epoch:  14
epoch:  15 val_f1:  0.7028070029525513 val_auroc:  0.7443544428080511 val_auprc:  0.8711924844387534
Validation loss improved to 1.370976
epoch:  15
epoch:  16 val_f1:  0.6992598845858601 val_auroc:  0.7522091310751106 val_auprc:  0.8769581899199733
Validation loss improved to 1.151415
epoch:  16
epoch:  17 val_f1:  0.7313689473952751 val_auroc:  0.7507363770250368 val_auprc:  0.8746185873363002
Validation loss improved to 1.121602
epoch:  17
epoch:  18 val_f1:  0.713247796930704 val_auroc:  0.7556455571919489 val_auprc:  0.8778972672095191
Validation loss improved to 1.059580
epoch:  18
epoch:  19 val_f1:  0.3628922279378038 val_auroc:  0.7596956308296514 val_auprc:  0.883147469863172
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.4430530763359238 val_auroc:  0.7628865979381444 val_auprc:  0.8850034575881045
EarlyStopping counter: 2 out of 50
epoch:  20
epoch:  21 val_f1:  0.7176437068167247 val_auroc:  0.7606774668630338 val_auprc:  0.8831747880029023
EarlyStopping counter: 3 out of 50
epoch:  21
epoch:  22 val_f1:  0.6702805197702304 val_auroc:  0.7439862542955327 val_auprc:  0.862356081424549
EarlyStopping counter: 4 out of 50
epoch:  22
epoch:  23 val_f1:  0.6610684696390046 val_auroc:  0.761904761904762 val_auprc:  0.8835876129748401
EarlyStopping counter: 5 out of 50
epoch:  23
epoch:  24 val_f1:  0.6951318622544138 val_auroc:  0.7551546391752578 val_auprc:  0.8763780348721313
EarlyStopping counter: 6 out of 50
epoch:  24
epoch:  25 val_f1:  0.6701115887475777 val_auroc:  0.7563819342169857 val_auprc:  0.8772135515793507
EarlyStopping counter: 7 out of 50
epoch:  25
epoch:  26 val_f1:  0.6951318622544138 val_auroc:  0.759327442317133 val_auprc:  0.8810135622802509
EarlyStopping counter: 8 out of 50
epoch:  26
epoch:  27 val_f1:  0.6440587489164556 val_auroc:  0.7652184585174275 val_auprc:  0.8894235209543322
EarlyStopping counter: 9 out of 50
epoch:  27
epoch:  28 val_f1:  0.7466980132583976 val_auroc:  0.7707412862052038 val_auprc:  0.8882268881180998
Validation loss improved to 1.024875
epoch:  28
epoch:  29 val_f1:  0.6181884833765877 val_auroc:  0.7636229749631811 val_auprc:  0.8835064210093175
Validation loss improved to 0.998157
epoch:  29
epoch:  30 val_f1:  0.6222325944609255 val_auroc:  0.738095238095238 val_auprc:  0.8758641972598831
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.6169361362484226 val_auroc:  0.7028718703976435 val_auprc:  0.8741723707737936
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.7330561760022478 val_auroc:  0.7760186548846343 val_auprc:  0.8885948523568822
EarlyStopping counter: 3 out of 50
epoch:  32
epoch:  33 val_f1:  0.7391701372600277 val_auroc:  0.7790868924889544 val_auprc:  0.8883355460173674
EarlyStopping counter: 4 out of 50
epoch:  33
epoch:  34 val_f1:  0.5526639557918883 val_auroc:  0.7808051055473736 val_auprc:  0.890304593143588
EarlyStopping counter: 5 out of 50
epoch:  34
epoch:  35 val_f1:  0.7286063672426545 val_auroc:  0.7659548355424645 val_auprc:  0.8758670752694022
EarlyStopping counter: 6 out of 50
epoch:  35
epoch:  36 val_f1:  0.6538912937446653 val_auroc:  0.7714776632302405 val_auprc:  0.8877404548820431
Validation loss improved to 0.952065
epoch:  36
epoch:  37 val_f1:  0.6617377698806362 val_auroc:  0.7650957290132548 val_auprc:  0.8852753333034312
Validation loss improved to 0.897013
epoch:  37
epoch:  38 val_f1:  0.6584354138310973 val_auroc:  0.7513500245459008 val_auprc:  0.8714818697318603
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.6752910608296504 val_auroc:  0.7724594992636229 val_auprc:  0.8870329342110336
Validation loss improved to 0.786597
epoch:  39
epoch:  40 val_f1:  0.4719351099423255 val_auroc:  0.7731958762886597 val_auprc:  0.884020509040576
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.3398212583117671 val_auroc:  0.7790868924889544 val_auprc:  0.89110247596579
EarlyStopping counter: 2 out of 50
epoch:  41
epoch:  42 val_f1:  0.6041463217968589 val_auroc:  0.7761413843888071 val_auprc:  0.8942103482521151
EarlyStopping counter: 3 out of 50
epoch:  42
epoch:  43 val_f1:  0.7197172881491292 val_auroc:  0.7703730976926852 val_auprc:  0.8854465104124859
EarlyStopping counter: 4 out of 50
epoch:  43
epoch:  44 val_f1:  0.7238240177089098 val_auroc:  0.7648502700049092 val_auprc:  0.8765965809577501
EarlyStopping counter: 5 out of 50
epoch:  44
epoch:  45 val_f1:  0.6670420077516633 val_auroc:  0.7588365243004418 val_auprc:  0.8821583899751242
EarlyStopping counter: 6 out of 50
epoch:  45
epoch:  46 val_f1:  0.6618558114706329 val_auroc:  0.7707412862052038 val_auprc:  0.8895942125553846
EarlyStopping counter: 7 out of 50
epoch:  46
epoch:  47 val_f1:  0.65669788697344 val_auroc:  0.7798232695139912 val_auprc:  0.8999522507170433
EarlyStopping counter: 8 out of 50
epoch:  47
epoch:  48 val_f1:  0.6135802455273177 val_auroc:  0.7719685812469318 val_auprc:  0.8824172362737767
EarlyStopping counter: 9 out of 50
epoch:  48
epoch:  49 val_f1:  0.7363119073255568 val_auroc:  0.7704958271968582 val_auprc:  0.8758817590114965
EarlyStopping counter: 10 out of 50
epoch:  49
epoch:  50 val_f1:  0.7309103647707891 val_auroc:  0.7654639175257733 val_auprc:  0.872037213906645
EarlyStopping counter: 11 out of 50
epoch:  50
epoch:  51 val_f1:  0.7313689473952751 val_auroc:  0.7702503681885126 val_auprc:  0.879759725470165
EarlyStopping counter: 12 out of 50
epoch:  51
epoch:  52 val_f1:  0.5120930761218531 val_auroc:  0.7857142857142858 val_auprc:  0.8856534725439151
EarlyStopping counter: 13 out of 50
epoch:  52
epoch:  53 val_f1:  0.3469645336362489 val_auroc:  0.7913598429062346 val_auprc:  0.8910606085786204
EarlyStopping counter: 14 out of 50
epoch:  53
epoch:  54 val_f1:  0.7371484630477437 val_auroc:  0.7697594501718212 val_auprc:  0.8769077148208863
EarlyStopping counter: 15 out of 50
epoch:  54
epoch:  55 val_f1:  0.7371484630477437 val_auroc:  0.7704958271968582 val_auprc:  0.8853404613151648
EarlyStopping counter: 16 out of 50
epoch:  55
epoch:  56 val_f1:  0.710128282915836 val_auroc:  0.7788414334806087 val_auprc:  0.8877137500291019
EarlyStopping counter: 17 out of 50
epoch:  56
epoch:  57 val_f1:  0.687028943170779 val_auroc:  0.7403043691703486 val_auprc:  0.8765680995131955
EarlyStopping counter: 18 out of 50
epoch:  57
epoch:  58 val_f1:  0.6825214527173443 val_auroc:  0.7660775650466373 val_auprc:  0.8807023851438966
EarlyStopping counter: 19 out of 50
epoch:  58
epoch:  59 val_f1:  0.7359369647139431 val_auroc:  0.7669366715758468 val_auprc:  0.8808203025987085
EarlyStopping counter: 20 out of 50
epoch:  59
epoch:  60 val_f1:  0.7163649790827238 val_auroc:  0.7344133529700541 val_auprc:  0.8464863651339036
EarlyStopping counter: 21 out of 50
epoch:  60
epoch:  61 val_f1:  0.6977368320649064 val_auroc:  0.7785959744722631 val_auprc:  0.89101790328848
EarlyStopping counter: 22 out of 50
epoch:  61
epoch:  62 val_f1:  0.7349308245711123 val_auroc:  0.7391998036327933 val_auprc:  0.8536951081496023
EarlyStopping counter: 23 out of 50
epoch:  62
epoch:  63 val_f1:  0.7309103647707891 val_auroc:  0.7599410898379971 val_auprc:  0.8718816934447112
EarlyStopping counter: 24 out of 50
epoch:  63
epoch:  64 val_f1:  0.7371484630477437 val_auroc:  0.7517182130584192 val_auprc:  0.86619165433299
EarlyStopping counter: 25 out of 50
epoch:  64
epoch:  65 val_f1:  0.7140775751491829 val_auroc:  0.7503681885125184 val_auprc:  0.8630282608245491
EarlyStopping counter: 26 out of 50
epoch:  65
epoch:  66 val_f1:  0.7107661257285465 val_auroc:  0.76313205694649 val_auprc:  0.8751595155347216
EarlyStopping counter: 27 out of 50
epoch:  66
epoch:  67 val_f1:  0.7580594896895918 val_auroc:  0.7608001963672067 val_auprc:  0.8713459058270924
EarlyStopping counter: 28 out of 50
epoch:  67
epoch:  68 val_f1:  0.7454557504588546 val_auroc:  0.7498772704958272 val_auprc:  0.8598051534109363
EarlyStopping counter: 29 out of 50
epoch:  68
epoch:  69 val_f1:  0.684049098994562 val_auroc:  0.751227295041728 val_auprc:  0.859116987935532
EarlyStopping counter: 30 out of 50
epoch:  69
epoch:  70 val_f1:  0.7107661257285465 val_auroc:  0.7491408934707904 val_auprc:  0.8651127582904612
EarlyStopping counter: 31 out of 50
epoch:  70
epoch:  71 val_f1:  0.6752910608296504 val_auroc:  0.7445999018163967 val_auprc:  0.8581831885246975
Validation loss improved to 0.623395
epoch:  71
epoch:  72 val_f1:  0.6977368320649064 val_auroc:  0.7436180657830143 val_auprc:  0.8629093370129735
EarlyStopping counter: 1 out of 50
epoch:  72
epoch:  73 val_f1:  0.6889840728573212 val_auroc:  0.7410407461953854 val_auprc:  0.8558248832581288
EarlyStopping counter: 2 out of 50
epoch:  73
epoch:  74 val_f1:  0.7107661257285465 val_auroc:  0.7414089347079037 val_auprc:  0.8601671843250684
EarlyStopping counter: 3 out of 50
epoch:  74
epoch:  75 val_f1:  0.7015283467006299 val_auroc:  0.7422680412371134 val_auprc:  0.8545662865661052
EarlyStopping counter: 4 out of 50
epoch:  75
epoch:  76 val_f1:  0.7039462975939799 val_auroc:  0.7158811978399608 val_auprc:  0.8491303680664524
EarlyStopping counter: 5 out of 50
epoch:  76
epoch:  77 val_f1:  0.722058496910722 val_auroc:  0.751840942562592 val_auprc:  0.8613669024540429
EarlyStopping counter: 6 out of 50
epoch:  77
epoch:  78 val_f1:  0.726967940210938 val_auroc:  0.7417771232204221 val_auprc:  0.8579197595308898
EarlyStopping counter: 7 out of 50
epoch:  78
epoch:  79 val_f1:  0.7246795893300292 val_auroc:  0.7492636229749632 val_auprc:  0.8526854519501973
EarlyStopping counter: 8 out of 50
epoch:  79
epoch:  80 val_f1:  0.7140775751491829 val_auroc:  0.7563819342169857 val_auprc:  0.8620175675536523
EarlyStopping counter: 9 out of 50
epoch:  80
epoch:  81 val_f1:  0.7144317414801258 val_auroc:  0.7547864506627394 val_auprc:  0.8659784796316068
EarlyStopping counter: 10 out of 50
epoch:  81
epoch:  82 val_f1:  0.7371484630477437 val_auroc:  0.7519636720667648 val_auprc:  0.8569617134501263
EarlyStopping counter: 11 out of 50
epoch:  82
epoch:  83 val_f1:  0.726175885795287 val_auroc:  0.7579774177712322 val_auprc:  0.8626916927143801
EarlyStopping counter: 12 out of 50
epoch:  83
epoch:  84 val_f1:  0.698190734000651 val_auroc:  0.7389543446244476 val_auprc:  0.8651751564566068
EarlyStopping counter: 13 out of 50
epoch:  84
epoch:  85 val_f1:  0.6019040561542183 val_auroc:  0.6839715267550319 val_auprc:  0.871934242684184
EarlyStopping counter: 14 out of 50
epoch:  85
epoch:  86 val_f1:  0.7096701017564327 val_auroc:  0.7417771232204222 val_auprc:  0.8807733950026212
EarlyStopping counter: 15 out of 50
epoch:  86
epoch:  87 val_f1:  0.7573003855683703 val_auroc:  0.7714776632302405 val_auprc:  0.875651781193986
EarlyStopping counter: 16 out of 50
epoch:  87
epoch:  88 val_f1:  0.7082463061808618 val_auroc:  0.7695139911634757 val_auprc:  0.8899651757811498
EarlyStopping counter: 17 out of 50
epoch:  88
epoch:  89 val_f1:  0.7346891520614657 val_auroc:  0.7639911634756996 val_auprc:  0.8746630136915581
EarlyStopping counter: 18 out of 50
epoch:  89
epoch:  90 val_f1:  0.7412236216203913 val_auroc:  0.7594501718213058 val_auprc:  0.8670702141864013
EarlyStopping counter: 19 out of 50
epoch:  90
epoch:  91 val_f1:  0.7238240177089098 val_auroc:  0.7540500736377025 val_auprc:  0.8734190134504375
EarlyStopping counter: 20 out of 50
epoch:  91
epoch:  92 val_f1:  0.7266187050359713 val_auroc:  0.7496318114874816 val_auprc:  0.8648172399298747
EarlyStopping counter: 21 out of 50
epoch:  92
epoch:  93 val_f1:  0.7580594896895918 val_auroc:  0.7659548355424644 val_auprc:  0.877672472900977
EarlyStopping counter: 22 out of 50
epoch:  93
epoch:  94 val_f1:  0.698190734000651 val_auroc:  0.7745459008345607 val_auprc:  0.8978630065402262
EarlyStopping counter: 23 out of 50
epoch:  94
epoch:  95 val_f1:  0.6451024231755431 val_auroc:  0.7708640157093766 val_auprc:  0.8708263183557077
EarlyStopping counter: 24 out of 50
epoch:  95
epoch:  96 val_f1:  0.7286063672426545 val_auroc:  0.7438635247913599 val_auprc:  0.8750242801145096
EarlyStopping counter: 25 out of 50
epoch:  96
epoch:  97 val_f1:  0.7410071942446043 val_auroc:  0.7744231713303878 val_auprc:  0.8847789367013559
EarlyStopping counter: 26 out of 50
epoch:  97
epoch:  98 val_f1:  0.7107661257285465 val_auroc:  0.7630093274423171 val_auprc:  0.8833916270765698
EarlyStopping counter: 27 out of 50
epoch:  98
epoch:  99 val_f1:  0.7126420359039872 val_auroc:  0.7696367206676485 val_auprc:  0.8888797051457116
EarlyStopping counter: 28 out of 50
epoch:  99
epoch:  100 val_f1:  0.7359858855314679 val_auroc:  0.7673048600883653 val_auprc:  0.8855741437616704
EarlyStopping counter: 29 out of 50
epoch:  100
epoch:  101 val_f1:  0.7208993647046947 val_auroc:  0.759327442317133 val_auprc:  0.878183975276228
EarlyStopping counter: 30 out of 50
epoch:  101
epoch:  102 val_f1:  0.7496568898727172 val_auroc:  0.7491408934707904 val_auprc:  0.8653716892971306
EarlyStopping counter: 31 out of 50
epoch:  102
epoch:  103 val_f1:  0.743396428458658 val_auroc:  0.7495090819833088 val_auprc:  0.8667091556353688
EarlyStopping counter: 32 out of 50
epoch:  103
epoch:  104 val_f1:  0.751751326211758 val_auroc:  0.752454590083456 val_auprc:  0.8697322650581496
EarlyStopping counter: 33 out of 50
epoch:  104
epoch:  105 val_f1:  0.743396428458658 val_auroc:  0.7522091310751106 val_auprc:  0.8707075273416958
EarlyStopping counter: 34 out of 50
epoch:  105
epoch:  106 val_f1:  0.743396428458658 val_auroc:  0.7503681885125184 val_auprc:  0.8687222076524714
EarlyStopping counter: 35 out of 50
epoch:  106
epoch:  107 val_f1:  0.743396428458658 val_auroc:  0.7491408934707904 val_auprc:  0.8678248978929373
EarlyStopping counter: 36 out of 50
epoch:  107
epoch:  108 val_f1:  0.743396428458658 val_auroc:  0.7486499754540993 val_auprc:  0.8673973180656911
EarlyStopping counter: 37 out of 50
epoch:  108
epoch:  109 val_f1:  0.7496568898727172 val_auroc:  0.7492636229749633 val_auprc:  0.8677559688374472
EarlyStopping counter: 38 out of 50
epoch:  109
epoch:  110 val_f1:  0.751751326211758 val_auroc:  0.7490181639666176 val_auprc:  0.8667569524889832
EarlyStopping counter: 39 out of 50
epoch:  110
epoch:  111 val_f1:  0.7496568898727172 val_auroc:  0.7486499754540993 val_auprc:  0.8673403939917081
EarlyStopping counter: 40 out of 50
epoch:  111
epoch:  112 val_f1:  0.743396428458658 val_auroc:  0.7491408934707905 val_auprc:  0.8668621022401453
EarlyStopping counter: 41 out of 50
epoch:  112
epoch:  113 val_f1:  0.743396428458658 val_auroc:  0.7492636229749633 val_auprc:  0.8668551071750725
EarlyStopping counter: 42 out of 50
epoch:  113
epoch:  114 val_f1:  0.743396428458658 val_auroc:  0.7492636229749632 val_auprc:  0.8679392939845629
EarlyStopping counter: 43 out of 50
epoch:  114
epoch:  115 val_f1:  0.743396428458658 val_auroc:  0.7495090819833088 val_auprc:  0.8680457243606614
EarlyStopping counter: 44 out of 50
epoch:  115
epoch:  116 val_f1:  0.7371484630477437 val_auroc:  0.748036327933235 val_auprc:  0.8663898456565436
EarlyStopping counter: 45 out of 50
epoch:  116
epoch:  117 val_f1:  0.7496568898727172 val_auroc:  0.7480363279332352 val_auprc:  0.8671037111013395
EarlyStopping counter: 46 out of 50
epoch:  117
epoch:  118 val_f1:  0.7371484630477437 val_auroc:  0.7482817869415808 val_auprc:  0.8675193628894733
EarlyStopping counter: 47 out of 50
epoch:  118
epoch:  119 val_f1:  0.7496568898727172 val_auroc:  0.7476681394207169 val_auprc:  0.8668759353105449
EarlyStopping counter: 48 out of 50
epoch:  119
epoch:  120 val_f1:  0.7371484630477437 val_auroc:  0.7470544918998528 val_auprc:  0.8658029121726571
EarlyStopping counter: 49 out of 50
epoch:  120
epoch:  121 val_f1:  0.7371484630477437 val_auroc:  0.7474226804123711 val_auprc:  0.8660128644248709
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  3175.9533224105835
{'time_elapsed': [3175.9533224105835], 'epoch': [120], 'fold': [2], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7371484630477437], 'auroc_test': [0.7474226804123711], 'auprc_test': [0.8660128644248709]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1278]          --
│    └─Dropout: 2-5                      [64, 1024, 1278]          --
│    └─Flatten: 2-6                      [64, 1308672]             --
│    └─Linear: 2-7                       [64, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 419.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1342.18
Params size (MB): 5.26
Estimated Total Size (MB): 1347.76
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6037778354579779 val_auroc:  0.6325096899224807 val_auprc:  0.8374825953983936
epoch:  1
epoch:  2 val_f1:  0.6736650951951298 val_auroc:  0.7556928294573644 val_auprc:  0.8948196360753538
Validation loss improved to 0.394311
epoch:  2
epoch:  3 val_f1:  0.7150508386633273 val_auroc:  0.7719234496124031 val_auprc:  0.8987952547954952
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6916155467032765 val_auroc:  0.77046996124031 val_auprc:  0.8958202549402614
EarlyStopping counter: 2 out of 50
epoch:  4
epoch:  5 val_f1:  0.7144407648910238 val_auroc:  0.8049903100775193 val_auprc:  0.9176252033509017
EarlyStopping counter: 3 out of 50
epoch:  5
epoch:  6 val_f1:  0.6598550592872624 val_auroc:  0.747093023255814 val_auprc:  0.8879744308708523
EarlyStopping counter: 4 out of 50
epoch:  6
epoch:  7 val_f1:  0.1904848898940776 val_auroc:  0.8234011627906976 val_auprc:  0.9169960046411643
EarlyStopping counter: 5 out of 50
epoch:  7
epoch:  8 val_f1:  0.6462979056356409 val_auroc:  0.8180717054263567 val_auprc:  0.913144075280179
EarlyStopping counter: 6 out of 50
epoch:  8
epoch:  9 val_f1:  0.6217879338462519 val_auroc:  0.7267441860465117 val_auprc:  0.884791726561029
EarlyStopping counter: 7 out of 50
epoch:  9
epoch:  10 val_f1:  0.6217879338462519 val_auroc:  0.6843507751937985 val_auprc:  0.8725874805460575
EarlyStopping counter: 8 out of 50
epoch:  10
epoch:  11 val_f1:  0.7429991933226874 val_auroc:  0.7787063953488371 val_auprc:  0.9004197647737581
EarlyStopping counter: 9 out of 50
epoch:  11
epoch:  12 val_f1:  0.7618084502224494 val_auroc:  0.8264292635658914 val_auprc:  0.9227995528081041
Validation loss improved to 0.315013
epoch:  12
epoch:  13 val_f1:  0.7724509753899008 val_auroc:  0.8335755813953488 val_auprc:  0.9249469279090077
Validation loss improved to 0.277427
epoch:  13
epoch:  14 val_f1:  0.7639114172852699 val_auroc:  0.8346656976744186 val_auprc:  0.9218366748162675
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.7601256159113488 val_auroc:  0.8304263565891473 val_auprc:  0.9209742920434016
EarlyStopping counter: 2 out of 50
epoch:  15
epoch:  16 val_f1:  0.7679977157187104 val_auroc:  0.8311531007751938 val_auprc:  0.9196554468140203
Validation loss improved to 0.168328
epoch:  16
epoch:  17 val_f1:  0.7711885993597467 val_auroc:  0.8349079457364341 val_auprc:  0.9275124704045674
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.767033173809688 val_auroc:  0.8361191860465116 val_auprc:  0.9279109945950479
Validation loss improved to 0.121508
epoch:  18
epoch:  19 val_f1:  0.767033173809688 val_auroc:  0.842781007751938 val_auprc:  0.9293431758321442
Validation loss improved to 0.112921
epoch:  19
epoch:  20 val_f1:  0.7697841726618705 val_auroc:  0.8472625968992248 val_auprc:  0.9316387824762167
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7827158008497472 val_auroc:  0.8485949612403101 val_auprc:  0.9343766517258362
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7886649052635782 val_auroc:  0.8541666666666667 val_auprc:  0.9363825226312236
Validation loss improved to 0.102192
epoch:  22
epoch:  23 val_f1:  0.7713093666729185 val_auroc:  0.8568313953488371 val_auprc:  0.9365792002639663
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7714049405980684 val_auroc:  0.8519864341085271 val_auprc:  0.9351994686172108
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.8074875573056803 val_auroc:  0.8546511627906976 val_auprc:  0.9367310295616829
Validation loss improved to 0.090034
epoch:  25
epoch:  26 val_f1:  0.7710202043822609 val_auroc:  0.8628875968992248 val_auprc:  0.9398278467265194
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7399265053976237 val_auroc:  0.8563468992248061 val_auprc:  0.9379177416543175
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7625825493451395 val_auroc:  0.8563468992248062 val_auprc:  0.9401428941414164
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.7877294237541244 val_auroc:  0.8609496124031008 val_auprc:  0.9423428886309108
EarlyStopping counter: 4 out of 50
epoch:  29
epoch:  30 val_f1:  0.7646080538166868 val_auroc:  0.8631298449612402 val_auprc:  0.9419403765222676
EarlyStopping counter: 5 out of 50
epoch:  30
epoch:  31 val_f1:  0.8175531003768415 val_auroc:  0.8655523255813954 val_auprc:  0.9418806074962889
EarlyStopping counter: 6 out of 50
epoch:  31
epoch:  32 val_f1:  0.7841726618705036 val_auroc:  0.865794573643411 val_auprc:  0.9404022070633902
EarlyStopping counter: 7 out of 50
epoch:  32
epoch:  33 val_f1:  0.6920478654670249 val_auroc:  0.8667635658914729 val_auprc:  0.9419206543568386
EarlyStopping counter: 8 out of 50
epoch:  33
epoch:  34 val_f1:  0.7427571456348435 val_auroc:  0.8590116279069767 val_auprc:  0.9396189872349048
EarlyStopping counter: 9 out of 50
epoch:  34
epoch:  35 val_f1:  0.7753157557330894 val_auroc:  0.8631298449612405 val_auprc:  0.9418605716811981
EarlyStopping counter: 10 out of 50
epoch:  35
epoch:  36 val_f1:  0.8093907785715628 val_auroc:  0.8679748062015503 val_auprc:  0.945166364444926
Validation loss improved to 0.076334
epoch:  36
epoch:  37 val_f1:  0.8027539115793398 val_auroc:  0.8737887596899225 val_auprc:  0.9472096196802862
EarlyStopping counter: 1 out of 50
epoch:  37
epoch:  38 val_f1:  0.7705233871155502 val_auroc:  0.8713662790697674 val_auprc:  0.946145532430364
EarlyStopping counter: 2 out of 50
epoch:  38
epoch:  39 val_f1:  0.6265623417306581 val_auroc:  0.8624031007751939 val_auprc:  0.942878821827454
EarlyStopping counter: 3 out of 50
epoch:  39
epoch:  40 val_f1:  0.5705265158502567 val_auroc:  0.8614341085271316 val_auprc:  0.9386626948180556
EarlyStopping counter: 4 out of 50
epoch:  40
epoch:  41 val_f1:  0.7641917471702557 val_auroc:  0.856952519379845 val_auprc:  0.9358806660704742
EarlyStopping counter: 5 out of 50
epoch:  41
epoch:  42 val_f1:  0.7892012988311853 val_auroc:  0.8575581395348838 val_auprc:  0.9393262571362855
EarlyStopping counter: 6 out of 50
epoch:  42
epoch:  43 val_f1:  0.7968569383258559 val_auroc:  0.8585271317829457 val_auprc:  0.9404000520903285
EarlyStopping counter: 7 out of 50
epoch:  43
epoch:  44 val_f1:  0.7840893588200424 val_auroc:  0.8607073643410853 val_auprc:  0.9417065296635501
EarlyStopping counter: 8 out of 50
epoch:  44
epoch:  45 val_f1:  0.7682301875730638 val_auroc:  0.8643410852713178 val_auprc:  0.9417579537501677
EarlyStopping counter: 9 out of 50
epoch:  45
epoch:  46 val_f1:  0.7985611510791367 val_auroc:  0.8605862403100776 val_auprc:  0.9396935848693662
EarlyStopping counter: 10 out of 50
epoch:  46
epoch:  47 val_f1:  0.7952715769842713 val_auroc:  0.8674903100775193 val_auprc:  0.9429945339916632
EarlyStopping counter: 11 out of 50
epoch:  47
epoch:  48 val_f1:  0.8101799492243995 val_auroc:  0.872093023255814 val_auprc:  0.945951543687093
EarlyStopping counter: 12 out of 50
epoch:  48
epoch:  49 val_f1:  0.7980190776058461 val_auroc:  0.8742732558139534 val_auprc:  0.9455750485982083
EarlyStopping counter: 13 out of 50
epoch:  49
epoch:  50 val_f1:  0.8093907785715628 val_auroc:  0.8737887596899224 val_auprc:  0.9459556529760945
EarlyStopping counter: 14 out of 50
epoch:  50
epoch:  51 val_f1:  0.8037391402911035 val_auroc:  0.8786337209302325 val_auprc:  0.9476628409697142
EarlyStopping counter: 15 out of 50
epoch:  51
epoch:  52 val_f1:  0.7603368061152953 val_auroc:  0.8809350775193798 val_auprc:  0.9478684736957209
EarlyStopping counter: 16 out of 50
epoch:  52
epoch:  53 val_f1:  0.7985611510791367 val_auroc:  0.8810562015503876 val_auprc:  0.9482284366115952
EarlyStopping counter: 17 out of 50
epoch:  53
epoch:  54 val_f1:  0.8063632502555458 val_auroc:  0.8805717054263565 val_auprc:  0.9482964050428168
EarlyStopping counter: 18 out of 50
epoch:  54
epoch:  55 val_f1:  0.8063632502555458 val_auroc:  0.882267441860465 val_auprc:  0.9494113657737834
EarlyStopping counter: 19 out of 50
epoch:  55
epoch:  56 val_f1:  0.7774211400110681 val_auroc:  0.8817829457364341 val_auprc:  0.948974003920021
EarlyStopping counter: 20 out of 50
epoch:  56
epoch:  57 val_f1:  0.8182769817510218 val_auroc:  0.8825096899224806 val_auprc:  0.9490641341287958
EarlyStopping counter: 21 out of 50
epoch:  57
epoch:  58 val_f1:  0.7857930944221151 val_auroc:  0.884205426356589 val_auprc:  0.9492780864048845
EarlyStopping counter: 22 out of 50
epoch:  58
epoch:  59 val_f1:  0.8051160047274586 val_auroc:  0.8851744186046512 val_auprc:  0.9498104555503565
EarlyStopping counter: 23 out of 50
epoch:  59
epoch:  60 val_f1:  0.7940592980161325 val_auroc:  0.8817829457364341 val_auprc:  0.9484686647774521
EarlyStopping counter: 24 out of 50
epoch:  60
epoch:  61 val_f1:  0.8182769817510218 val_auroc:  0.8820251937984496 val_auprc:  0.9491821028749297
EarlyStopping counter: 25 out of 50
epoch:  61
epoch:  62 val_f1:  0.7857930944221151 val_auroc:  0.8825096899224806 val_auprc:  0.9492611527060248
EarlyStopping counter: 26 out of 50
epoch:  62
epoch:  63 val_f1:  0.7857930944221151 val_auroc:  0.8839631782945736 val_auprc:  0.9498155649610066
EarlyStopping counter: 27 out of 50
epoch:  63
epoch:  64 val_f1:  0.8129496402877698 val_auroc:  0.8832364341085271 val_auprc:  0.9494081957641142
EarlyStopping counter: 28 out of 50
epoch:  64
epoch:  65 val_f1:  0.8140907369797942 val_auroc:  0.8827519379844961 val_auprc:  0.9493523550443292
EarlyStopping counter: 29 out of 50
epoch:  65
epoch:  66 val_f1:  0.7857930944221151 val_auroc:  0.8837209302325582 val_auprc:  0.9496674444011021
EarlyStopping counter: 30 out of 50
epoch:  66
epoch:  67 val_f1:  0.8022252248962252 val_auroc:  0.8839631782945736 val_auprc:  0.9497644796064615
EarlyStopping counter: 31 out of 50
epoch:  67
epoch:  68 val_f1:  0.8182769817510218 val_auroc:  0.882267441860465 val_auprc:  0.948830231764184
EarlyStopping counter: 32 out of 50
epoch:  68
epoch:  69 val_f1:  0.8195518562291283 val_auroc:  0.8834786821705427 val_auprc:  0.9493165462980616
EarlyStopping counter: 33 out of 50
epoch:  69
epoch:  70 val_f1:  0.8129496402877698 val_auroc:  0.8834786821705427 val_auprc:  0.9492858344260339
EarlyStopping counter: 34 out of 50
epoch:  70
epoch:  71 val_f1:  0.8182769817510218 val_auroc:  0.8833575581395349 val_auprc:  0.9493836716722367
EarlyStopping counter: 35 out of 50
epoch:  71
epoch:  72 val_f1:  0.768937708914086 val_auroc:  0.8851744186046512 val_auprc:  0.9502992493779044
EarlyStopping counter: 36 out of 50
epoch:  72
epoch:  73 val_f1:  0.8116870274031143 val_auroc:  0.884205426356589 val_auprc:  0.9500946118114014
EarlyStopping counter: 37 out of 50
epoch:  73
epoch:  74 val_f1:  0.8051160047274586 val_auroc:  0.883236434108527 val_auprc:  0.9493376817232039
EarlyStopping counter: 38 out of 50
epoch:  74
epoch:  75 val_f1:  0.768937708914086 val_auroc:  0.8837209302325582 val_auprc:  0.9496715583250972
EarlyStopping counter: 39 out of 50
epoch:  75
epoch:  76 val_f1:  0.8182769817510218 val_auroc:  0.884205426356589 val_auprc:  0.9496551485562016
EarlyStopping counter: 40 out of 50
epoch:  76
epoch:  77 val_f1:  0.8182769817510218 val_auroc:  0.883720930232558 val_auprc:  0.9495715893457145
EarlyStopping counter: 41 out of 50
epoch:  77
epoch:  78 val_f1:  0.8182769817510218 val_auroc:  0.8829941860465116 val_auprc:  0.9493039366510017
EarlyStopping counter: 42 out of 50
epoch:  78
epoch:  79 val_f1:  0.8116870274031143 val_auroc:  0.8834786821705427 val_auprc:  0.9495494718717675
EarlyStopping counter: 43 out of 50
epoch:  79
epoch:  80 val_f1:  0.8129496402877698 val_auroc:  0.8842054263565892 val_auprc:  0.949605367509491
EarlyStopping counter: 44 out of 50
epoch:  80
epoch:  81 val_f1:  0.8102961135322703 val_auroc:  0.8839631782945736 val_auprc:  0.9498607861115252
EarlyStopping counter: 45 out of 50
epoch:  81
epoch:  82 val_f1:  0.7857930944221151 val_auroc:  0.8834786821705427 val_auprc:  0.9493958383755778
EarlyStopping counter: 46 out of 50
epoch:  82
epoch:  83 val_f1:  0.8129496402877698 val_auroc:  0.8839631782945736 val_auprc:  0.949691955589966
EarlyStopping counter: 47 out of 50
epoch:  83
epoch:  84 val_f1:  0.8102961135322703 val_auroc:  0.8832364341085271 val_auprc:  0.9494636847024279
EarlyStopping counter: 48 out of 50
epoch:  84
epoch:  85 val_f1:  0.8195518562291283 val_auroc:  0.8827519379844961 val_auprc:  0.9494700382338991
EarlyStopping counter: 49 out of 50
epoch:  85
epoch:  86 val_f1:  0.7774211400110681 val_auroc:  0.8822674418604651 val_auprc:  0.9490485688050581
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  2250.91680765152
{'time_elapsed': [2250.91680765152], 'epoch': [85], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7774211400110681], 'auroc_test': [0.8822674418604651], 'auprc_test': [0.9490485688050581]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1278]          --
│    └─Dropout: 2-5                      [64, 1024, 1278]          --
│    └─Flatten: 2-6                      [64, 1308672]             --
│    └─Linear: 2-7                       [64, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 419.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1342.18
Params size (MB): 5.26
Estimated Total Size (MB): 1347.76
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6988895162808206 val_auroc:  0.8029513888888888 val_auprc:  0.903880468638065
epoch:  1
epoch:  2 val_f1:  0.7616502189311872 val_auroc:  0.7604166666666666 val_auprc:  0.8502520788959881
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.7556123898834897 val_auroc:  0.7486359126984127 val_auprc:  0.8520618412838593
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6289825448699046 val_auroc:  0.8115079365079365 val_auprc:  0.9010257437405355
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.7356159817134149 val_auroc:  0.8561507936507937 val_auprc:  0.9322100531691591
Validation loss improved to 0.637995
epoch:  5
epoch:  6 val_f1:  0.8260869565217391 val_auroc:  0.8821924603174603 val_auprc:  0.9459254787493917
Validation loss improved to 0.405858
epoch:  6
epoch:  7 val_f1:  0.8088065661047027 val_auroc:  0.886780753968254 val_auprc:  0.9467054244838607
Validation loss improved to 0.373585
epoch:  7
epoch:  8 val_f1:  0.7781291172595521 val_auroc:  0.8878968253968255 val_auprc:  0.9449428432157444
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7360061858039977 val_auroc:  0.8826884920634921 val_auprc:  0.9437178674391804
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.7559994907923457 val_auroc:  0.8835565476190476 val_auprc:  0.9423398222564667
EarlyStopping counter: 3 out of 50
epoch:  10
epoch:  11 val_f1:  0.7350824587706147 val_auroc:  0.8883928571428571 val_auprc:  0.945610349614179
EarlyStopping counter: 4 out of 50
epoch:  11
epoch:  12 val_f1:  0.7983928476398275 val_auroc:  0.878968253968254 val_auprc:  0.9393258951913943
EarlyStopping counter: 5 out of 50
epoch:  12
epoch:  13 val_f1:  0.7010400682011935 val_auroc:  0.8683035714285714 val_auprc:  0.9373323485711218
EarlyStopping counter: 6 out of 50
epoch:  13
epoch:  14 val_f1:  0.7749692370795734 val_auroc:  0.8643353174603176 val_auprc:  0.9305804003221589
EarlyStopping counter: 7 out of 50
epoch:  14
epoch:  15 val_f1:  0.7450280959405923 val_auroc:  0.8529265873015872 val_auprc:  0.9250698616465025
EarlyStopping counter: 8 out of 50
epoch:  15
epoch:  16 val_f1:  0.7590842260029405 val_auroc:  0.8630952380952381 val_auprc:  0.935833949159782
EarlyStopping counter: 9 out of 50
epoch:  16
epoch:  17 val_f1:  0.7653944520952194 val_auroc:  0.8707837301587302 val_auprc:  0.9366952760545408
EarlyStopping counter: 10 out of 50
epoch:  17
epoch:  18 val_f1:  0.7709191825750569 val_auroc:  0.8638392857142857 val_auprc:  0.9313374644940925
EarlyStopping counter: 11 out of 50
epoch:  18
epoch:  19 val_f1:  0.7884143290944841 val_auroc:  0.8607390873015873 val_auprc:  0.924960060495625
EarlyStopping counter: 12 out of 50
epoch:  19
epoch:  20 val_f1:  0.7239811321395462 val_auroc:  0.8666914682539683 val_auprc:  0.9326223750674696
EarlyStopping counter: 13 out of 50
epoch:  20
epoch:  21 val_f1:  0.6602526439482962 val_auroc:  0.8727678571428572 val_auprc:  0.9340079094206283
EarlyStopping counter: 14 out of 50
epoch:  21
epoch:  22 val_f1:  0.7837062051498522 val_auroc:  0.857390873015873 val_auprc:  0.9235911395426136
EarlyStopping counter: 15 out of 50
epoch:  22
epoch:  23 val_f1:  0.7614778962024896 val_auroc:  0.8782242063492064 val_auprc:  0.9409530446250658
EarlyStopping counter: 16 out of 50
epoch:  23
epoch:  24 val_f1:  0.7773176903611687 val_auroc:  0.8645833333333334 val_auprc:  0.9326380846287936
EarlyStopping counter: 17 out of 50
epoch:  24
epoch:  25 val_f1:  0.7682566483748418 val_auroc:  0.880704365079365 val_auprc:  0.9391530740695361
EarlyStopping counter: 18 out of 50
epoch:  25
epoch:  26 val_f1:  0.81483559295621 val_auroc:  0.8836805555555556 val_auprc:  0.9422465855633023
Validation loss improved to 0.252792
epoch:  26
epoch:  27 val_f1:  0.7839990466164816 val_auroc:  0.8823164682539683 val_auprc:  0.9371875706950834
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7682566483748418 val_auroc:  0.8743799603174603 val_auprc:  0.9390582413536602
EarlyStopping counter: 2 out of 50
epoch:  28
epoch:  29 val_f1:  0.8156899810964081 val_auroc:  0.875124007936508 val_auprc:  0.9323394093939008
Validation loss improved to 0.235806
epoch:  29
epoch:  30 val_f1:  0.8088065661047027 val_auroc:  0.873263888888889 val_auprc:  0.9329030150968461
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7819511139952413 val_auroc:  0.8789682539682541 val_auprc:  0.9345168970789651
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.7884143290944841 val_auroc:  0.8720238095238095 val_auprc:  0.9248689401367585
EarlyStopping counter: 3 out of 50
epoch:  32
epoch:  33 val_f1:  0.8115942028985508 val_auroc:  0.8634672619047619 val_auprc:  0.923925199752575
EarlyStopping counter: 4 out of 50
epoch:  33
epoch:  34 val_f1:  0.8115942028985508 val_auroc:  0.8753720238095237 val_auprc:  0.9251193075927576
EarlyStopping counter: 5 out of 50
epoch:  34
epoch:  35 val_f1:  0.8154066640778435 val_auroc:  0.871279761904762 val_auprc:  0.9244464219634582
EarlyStopping counter: 6 out of 50
epoch:  35
epoch:  36 val_f1:  0.8220330394243437 val_auroc:  0.875 val_auprc:  0.9239328520876977
EarlyStopping counter: 7 out of 50
epoch:  36
epoch:  37 val_f1:  0.7988956640912072 val_auroc:  0.8725198412698413 val_auprc:  0.9251644414016935
EarlyStopping counter: 8 out of 50
epoch:  37
epoch:  38 val_f1:  0.8248625247346153 val_auroc:  0.8772321428571429 val_auprc:  0.9266442954348624
EarlyStopping counter: 9 out of 50
epoch:  38
epoch:  39 val_f1:  0.7837062051498522 val_auroc:  0.8690476190476191 val_auprc:  0.9252819807878865
EarlyStopping counter: 10 out of 50
epoch:  39
epoch:  40 val_f1:  0.8194319840387783 val_auroc:  0.876984126984127 val_auprc:  0.9242111992509289
EarlyStopping counter: 11 out of 50
epoch:  40
epoch:  41 val_f1:  0.7781291172595521 val_auroc:  0.8834325396825397 val_auprc:  0.9306295945822494
EarlyStopping counter: 12 out of 50
epoch:  41
epoch:  42 val_f1:  0.8238239124113431 val_auroc:  0.8762400793650794 val_auprc:  0.9225880873060346
EarlyStopping counter: 13 out of 50
epoch:  42
epoch:  43 val_f1:  0.7653944520952194 val_auroc:  0.8779761904761905 val_auprc:  0.9314185984180591
EarlyStopping counter: 14 out of 50
epoch:  43
epoch:  44 val_f1:  0.8305598194589869 val_auroc:  0.8763640873015873 val_auprc:  0.9255763541618703
EarlyStopping counter: 15 out of 50
epoch:  44
epoch:  45 val_f1:  0.7428219852337982 val_auroc:  0.8643353174603174 val_auprc:  0.9251171079546534
EarlyStopping counter: 16 out of 50
epoch:  45
epoch:  46 val_f1:  0.8194319840387783 val_auroc:  0.878968253968254 val_auprc:  0.9281777150262243
EarlyStopping counter: 17 out of 50
epoch:  46
epoch:  47 val_f1:  0.8103538508923273 val_auroc:  0.8781001984126984 val_auprc:  0.9323876012306156
EarlyStopping counter: 18 out of 50
epoch:  47
epoch:  48 val_f1:  0.7559994907923457 val_auroc:  0.875 val_auprc:  0.9322277121834146
EarlyStopping counter: 19 out of 50
epoch:  48
epoch:  49 val_f1:  0.8205262448141007 val_auroc:  0.8727678571428572 val_auprc:  0.9242825201956145
EarlyStopping counter: 20 out of 50
epoch:  49
epoch:  50 val_f1:  0.8281893869312926 val_auroc:  0.876736111111111 val_auprc:  0.9278092457548955
EarlyStopping counter: 21 out of 50
epoch:  50
epoch:  51 val_f1:  0.8049865427618805 val_auroc:  0.8784722222222222 val_auprc:  0.9313342316242743
EarlyStopping counter: 22 out of 50
epoch:  51
epoch:  52 val_f1:  0.8168793096329329 val_auroc:  0.875 val_auprc:  0.9294932577231776
EarlyStopping counter: 23 out of 50
epoch:  52
epoch:  53 val_f1:  0.7839990466164816 val_auroc:  0.8722718253968255 val_auprc:  0.9282934328133434
EarlyStopping counter: 24 out of 50
epoch:  53
epoch:  54 val_f1:  0.7884143290944841 val_auroc:  0.8722718253968254 val_auprc:  0.9294976818618261
EarlyStopping counter: 25 out of 50
epoch:  54
epoch:  55 val_f1:  0.8168793096329329 val_auroc:  0.8740079365079365 val_auprc:  0.9272337011305644
EarlyStopping counter: 26 out of 50
epoch:  55
epoch:  56 val_f1:  0.8168793096329329 val_auroc:  0.8752480158730159 val_auprc:  0.9284993766320225
EarlyStopping counter: 27 out of 50
epoch:  56
epoch:  57 val_f1:  0.8168793096329329 val_auroc:  0.8754960317460317 val_auprc:  0.928700417291632
EarlyStopping counter: 28 out of 50
epoch:  57
epoch:  58 val_f1:  0.792371879328401 val_auroc:  0.8757440476190476 val_auprc:  0.9295501063687728
EarlyStopping counter: 29 out of 50
epoch:  58
epoch:  59 val_f1:  0.800639197204071 val_auroc:  0.8754960317460316 val_auprc:  0.9287103201775112
EarlyStopping counter: 30 out of 50
epoch:  59
epoch:  60 val_f1:  0.792371879328401 val_auroc:  0.8754960317460317 val_auprc:  0.9294236983524653
EarlyStopping counter: 31 out of 50
epoch:  60
epoch:  61 val_f1:  0.8088065661047027 val_auroc:  0.8752480158730158 val_auprc:  0.9294058792397537
EarlyStopping counter: 32 out of 50
epoch:  61
epoch:  62 val_f1:  0.8182185828242006 val_auroc:  0.876984126984127 val_auprc:  0.9283444952857838
EarlyStopping counter: 33 out of 50
epoch:  62
epoch:  63 val_f1:  0.8088065661047027 val_auroc:  0.8745039682539684 val_auprc:  0.9285175219245873
EarlyStopping counter: 34 out of 50
epoch:  63
epoch:  64 val_f1:  0.8182185828242006 val_auroc:  0.8752480158730158 val_auprc:  0.9279301489140398
EarlyStopping counter: 35 out of 50
epoch:  64
epoch:  65 val_f1:  0.8182185828242006 val_auroc:  0.8767361111111112 val_auprc:  0.9291955729201029
EarlyStopping counter: 36 out of 50
epoch:  65
epoch:  66 val_f1:  0.8182185828242006 val_auroc:  0.873015873015873 val_auprc:  0.9277936019509438
EarlyStopping counter: 37 out of 50
epoch:  66
epoch:  67 val_f1:  0.7988956640912072 val_auroc:  0.8767361111111112 val_auprc:  0.9319743791300168
EarlyStopping counter: 38 out of 50
epoch:  67
epoch:  68 val_f1:  0.8088065661047027 val_auroc:  0.8774801587301587 val_auprc:  0.9308182989883791
EarlyStopping counter: 39 out of 50
epoch:  68
epoch:  69 val_f1:  0.8248625247346153 val_auroc:  0.875 val_auprc:  0.928434430871827
EarlyStopping counter: 40 out of 50
epoch:  69
epoch:  70 val_f1:  0.792371879328401 val_auroc:  0.8740079365079365 val_auprc:  0.9302873916417151
EarlyStopping counter: 41 out of 50
epoch:  70
epoch:  71 val_f1:  0.800639197204071 val_auroc:  0.8772321428571429 val_auprc:  0.9326534188078919
EarlyStopping counter: 42 out of 50
epoch:  71
epoch:  72 val_f1:  0.792371879328401 val_auroc:  0.8742559523809523 val_auprc:  0.9310002695860649
EarlyStopping counter: 43 out of 50
epoch:  72
epoch:  73 val_f1:  0.8248625247346153 val_auroc:  0.8745039682539684 val_auprc:  0.9290636593820956
EarlyStopping counter: 44 out of 50
epoch:  73
epoch:  74 val_f1:  0.8248625247346153 val_auroc:  0.8767361111111112 val_auprc:  0.9305350630978042
EarlyStopping counter: 45 out of 50
epoch:  74
epoch:  75 val_f1:  0.8168793096329329 val_auroc:  0.8777281746031746 val_auprc:  0.9316342907706749
EarlyStopping counter: 46 out of 50
epoch:  75
epoch:  76 val_f1:  0.792371879328401 val_auroc:  0.8762400793650793 val_auprc:  0.931688197552906
EarlyStopping counter: 47 out of 50
epoch:  76
epoch:  77 val_f1:  0.8248625247346153 val_auroc:  0.8764880952380952 val_auprc:  0.931041994884836
EarlyStopping counter: 48 out of 50
epoch:  77
epoch:  78 val_f1:  0.8248625247346153 val_auroc:  0.876984126984127 val_auprc:  0.9312584009125402
EarlyStopping counter: 49 out of 50
epoch:  78
epoch:  79 val_f1:  0.8248625247346153 val_auroc:  0.8762400793650794 val_auprc:  0.9309627514555505
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  2051.475073814392
{'time_elapsed': [2051.475073814392], 'epoch': [78], 'fold': [4], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8248625247346153], 'auroc_test': [0.8762400793650794], 'auprc_test': [0.9309627514555505]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1278]          --
│    └─Dropout: 2-5                      [64, 1024, 1278]          --
│    └─Flatten: 2-6                      [64, 1308672]             --
│    └─Linear: 2-7                       [64, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 419.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1342.18
Params size (MB): 5.26
Estimated Total Size (MB): 1347.76
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_4', 'config': {'hidden_channels': [1024], 'epochs': 500, 'kernel_size': 3, 'pool_kernel_size': 3, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5292704809150962 val_auroc:  0.648993618065783 val_auprc:  0.7467534056372878
epoch:  1
epoch:  2 val_f1:  0.6272534913245873 val_auroc:  0.7243495336278841 val_auprc:  0.8740111440995939
Validation loss improved to 1.471426
epoch:  2
epoch:  3 val_f1:  0.7060068982302729 val_auroc:  0.7417771232204222 val_auprc:  0.8842591627235226
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6659129838985954 val_auroc:  0.7511045655375552 val_auprc:  0.8885533214795088
EarlyStopping counter: 2 out of 50
epoch:  4
epoch:  5 val_f1:  0.6328113979404711 val_auroc:  0.7528227785959745 val_auprc:  0.8895209051796619
Validation loss improved to 1.383052
epoch:  5
epoch:  6 val_f1:  0.7140775751491829 val_auroc:  0.7633775159548355 val_auprc:  0.8919359625372637
Validation loss improved to 1.338230
epoch:  6
epoch:  7 val_f1:  0.6813420921017198 val_auroc:  0.7619047619047619 val_auprc:  0.8904421972199792
Validation loss improved to 1.247831
epoch:  7
epoch:  8 val_f1:  0.6476562574960038 val_auroc:  0.7714776632302405 val_auprc:  0.8935371140328414
Validation loss improved to 1.236064
epoch:  8
epoch:  9 val_f1:  0.6451024231755431 val_auroc:  0.7727049582719686 val_auprc:  0.8932562411558831
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7249644134959412 val_auroc:  0.7827687776141384 val_auprc:  0.8994030148041217
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.7328919440906961 val_auroc:  0.788659793814433 val_auprc:  0.9045315124031855
EarlyStopping counter: 3 out of 50
epoch:  11
epoch:  12 val_f1:  0.7402181480621955 val_auroc:  0.7962690230731468 val_auprc:  0.9100692150019546
Validation loss improved to 1.187324
epoch:  12
epoch:  13 val_f1:  0.7531731915989216 val_auroc:  0.8046146293568974 val_auprc:  0.9151656818850278
Validation loss improved to 1.157647
epoch:  13
epoch:  14 val_f1:  0.7725930260576229 val_auroc:  0.8085419734904271 val_auprc:  0.9165537345086796
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.6465592158900526 val_auroc:  0.8132056946489935 val_auprc:  0.9195519611587586
EarlyStopping counter: 2 out of 50
epoch:  15
epoch:  16 val_f1:  0.6824751963135375 val_auroc:  0.8163966617574865 val_auprc:  0.9205090739355543
Validation loss improved to 1.090451
epoch:  16
epoch:  17 val_f1:  0.6892815309975336 val_auroc:  0.8193421698576339 val_auprc:  0.9228593167915631
Validation loss improved to 1.074727
epoch:  17
epoch:  18 val_f1:  0.7777125328082551 val_auroc:  0.8176239567992145 val_auprc:  0.9215824529441314
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.6737247039763566 val_auroc:  0.8208149239077074 val_auprc:  0.9239724146393129
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7545102379634754 val_auroc:  0.8230240549828178 val_auprc:  0.9251563623260988
EarlyStopping counter: 3 out of 50
epoch:  20
epoch:  21 val_f1:  0.7028070029525513 val_auroc:  0.8217967599410899 val_auprc:  0.924141543787455
EarlyStopping counter: 4 out of 50
epoch:  21
epoch:  22 val_f1:  0.7244548447263693 val_auroc:  0.8240058910162003 val_auprc:  0.9245599352273399
EarlyStopping counter: 5 out of 50
epoch:  22
epoch:  23 val_f1:  0.702570289683208 val_auroc:  0.8249877270495828 val_auprc:  0.9247663512941674
EarlyStopping counter: 6 out of 50
epoch:  23
epoch:  24 val_f1:  0.7802930475309426 val_auroc:  0.8249877270495827 val_auprc:  0.9255629044032371
EarlyStopping counter: 7 out of 50
epoch:  24
epoch:  25 val_f1:  0.6543650575722627 val_auroc:  0.8249877270495827 val_auprc:  0.9251187887056446
EarlyStopping counter: 8 out of 50
epoch:  25
epoch:  26 val_f1:  0.7633714058926586 val_auroc:  0.8235149729995092 val_auprc:  0.9251762582124238
EarlyStopping counter: 9 out of 50
epoch:  26
epoch:  27 val_f1:  0.7233618940391454 val_auroc:  0.8213058419243987 val_auprc:  0.9237983104278296
EarlyStopping counter: 10 out of 50
epoch:  27
epoch:  28 val_f1:  0.7233618940391454 val_auroc:  0.8195876288659794 val_auprc:  0.9221683416448548
EarlyStopping counter: 11 out of 50
epoch:  28
epoch:  29 val_f1:  0.7737843767539161 val_auroc:  0.81786941580756 val_auprc:  0.9204709815787371
EarlyStopping counter: 12 out of 50
epoch:  29
epoch:  30 val_f1:  0.6963686193902022 val_auroc:  0.818605792832597 val_auprc:  0.9201610332683747
EarlyStopping counter: 13 out of 50
epoch:  30
epoch:  31 val_f1:  0.7552115339652351 val_auroc:  0.8271968581246931 val_auprc:  0.9272741078360176
EarlyStopping counter: 14 out of 50
epoch:  31
epoch:  32 val_f1:  0.7745465218349855 val_auroc:  0.8291605301914581 val_auprc:  0.9276969721098817
EarlyStopping counter: 15 out of 50
epoch:  32
epoch:  33 val_f1:  0.7567268683783295 val_auroc:  0.8249877270495827 val_auprc:  0.924672036023803
EarlyStopping counter: 16 out of 50
epoch:  33
epoch:  34 val_f1:  0.7560320485424044 val_auroc:  0.8154148257241041 val_auprc:  0.917164299684738
EarlyStopping counter: 17 out of 50
epoch:  34
epoch:  35 val_f1:  0.743914028278071 val_auroc:  0.821060382916053 val_auprc:  0.9227762399613431
EarlyStopping counter: 18 out of 50
epoch:  35
epoch:  36 val_f1:  0.766354189375772 val_auroc:  0.8195876288659795 val_auprc:  0.9215188640848749
EarlyStopping counter: 19 out of 50
epoch:  36
epoch:  37 val_f1:  0.730071543320129 val_auroc:  0.8173784977908689 val_auprc:  0.9195420844522026
EarlyStopping counter: 20 out of 50
epoch:  37
epoch:  38 val_f1:  0.7661589271850144 val_auroc:  0.8168875797741778 val_auprc:  0.9196261494591822
EarlyStopping counter: 21 out of 50
epoch:  38
epoch:  39 val_f1:  0.6697867552687988 val_auroc:  0.8249877270495827 val_auprc:  0.9262170676390734
EarlyStopping counter: 22 out of 50
epoch:  39
epoch:  40 val_f1:  0.757304835743056 val_auroc:  0.810505645557192 val_auprc:  0.915285439972597
EarlyStopping counter: 23 out of 50
epoch:  40
epoch:  41 val_f1:  0.7236892364125374 val_auroc:  0.8151693667157585 val_auprc:  0.9187833416285096
EarlyStopping counter: 24 out of 50
epoch:  41
epoch:  42 val_f1:  0.7402181480621955 val_auroc:  0.8173784977908689 val_auprc:  0.9225533276871789
EarlyStopping counter: 25 out of 50
epoch:  42
epoch:  43 val_f1:  0.7391701372600277 val_auroc:  0.8154148257241041 val_auprc:  0.9190032164687172
EarlyStopping counter: 26 out of 50
epoch:  43
epoch:  44 val_f1:  0.7410071942446043 val_auroc:  0.8134511536573392 val_auprc:  0.9181118213897257
EarlyStopping counter: 27 out of 50
epoch:  44
epoch:  45 val_f1:  0.7483101088021195 val_auroc:  0.809278350515464 val_auprc:  0.9146124081622843
EarlyStopping counter: 28 out of 50
epoch:  45
epoch:  46 val_f1:  0.7362024088594293 val_auroc:  0.822287677957781 val_auprc:  0.9248892558493856
EarlyStopping counter: 29 out of 50
epoch:  46
epoch:  47 val_f1:  0.7412236216203913 val_auroc:  0.8129602356406481 val_auprc:  0.9171273801571768
EarlyStopping counter: 30 out of 50
epoch:  47
epoch:  48 val_f1:  0.7536606851900262 val_auroc:  0.8073146784486991 val_auprc:  0.9128777128602266
EarlyStopping counter: 31 out of 50
epoch:  48
epoch:  49 val_f1:  0.7377691212466089 val_auroc:  0.819833087874325 val_auprc:  0.9232266731295179
EarlyStopping counter: 32 out of 50
epoch:  49
epoch:  50 val_f1:  0.7283736963917239 val_auroc:  0.8070692194403535 val_auprc:  0.9138898117303011
EarlyStopping counter: 33 out of 50
epoch:  50
epoch:  51 val_f1:  0.7346891520614657 val_auroc:  0.8136966126656848 val_auprc:  0.9191936848864732
EarlyStopping counter: 34 out of 50
epoch:  51
epoch:  52 val_f1:  0.7536606851900262 val_auroc:  0.8097692685321551 val_auprc:  0.9164327334517035
EarlyStopping counter: 35 out of 50
epoch:  52
epoch:  53 val_f1:  0.7536606851900262 val_auroc:  0.8075601374570447 val_auprc:  0.9140891889418943
EarlyStopping counter: 36 out of 50
epoch:  53
epoch:  54 val_f1:  0.7473302173830908 val_auroc:  0.8085419734904271 val_auprc:  0.9144860409914635
EarlyStopping counter: 37 out of 50
epoch:  54
epoch:  55 val_f1:  0.7410071942446043 val_auroc:  0.8078055964653903 val_auprc:  0.9170499933616315
EarlyStopping counter: 38 out of 50
epoch:  55
epoch:  56 val_f1:  0.7299542184434271 val_auroc:  0.8124693176239568 val_auprc:  0.9162622630158926
EarlyStopping counter: 39 out of 50
epoch:  56
epoch:  57 val_f1:  0.7536606851900262 val_auroc:  0.8092783505154639 val_auprc:  0.9152118832084228
EarlyStopping counter: 40 out of 50
epoch:  57
epoch:  58 val_f1:  0.7308672563486676 val_auroc:  0.8168875797741777 val_auprc:  0.9205786623863369
EarlyStopping counter: 41 out of 50
epoch:  58
epoch:  59 val_f1:  0.7506155503404762 val_auroc:  0.8163966617574865 val_auprc:  0.9176210822090769
EarlyStopping counter: 42 out of 50
epoch:  59
epoch:  60 val_f1:  0.751751326211758 val_auroc:  0.8190967108492881 val_auprc:  0.9207765268664538
EarlyStopping counter: 43 out of 50
epoch:  60
epoch:  61 val_f1:  0.76000113614692 val_auroc:  0.8114874815905743 val_auprc:  0.9161202466989856
EarlyStopping counter: 44 out of 50
epoch:  61
epoch:  62 val_f1:  0.7410071942446043 val_auroc:  0.8095238095238095 val_auprc:  0.9144528720482862
EarlyStopping counter: 45 out of 50
epoch:  62
epoch:  63 val_f1:  0.751751326211758 val_auroc:  0.8149239077074129 val_auprc:  0.9186474065504335
EarlyStopping counter: 46 out of 50
epoch:  63
epoch:  64 val_f1:  0.76000113614692 val_auroc:  0.8171330387825234 val_auprc:  0.9179822511913304
EarlyStopping counter: 47 out of 50
epoch:  64
epoch:  65 val_f1:  0.7473302173830908 val_auroc:  0.8200785468826706 val_auprc:  0.9220000133921551
EarlyStopping counter: 48 out of 50
epoch:  65
epoch:  66 val_f1:  0.7473302173830908 val_auroc:  0.8080510554737359 val_auprc:  0.9141616998356179
EarlyStopping counter: 49 out of 50
epoch:  66
epoch:  67 val_f1:  0.7596459003010357 val_auroc:  0.8119783996072655 val_auprc:  0.9154523008454221
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  459.5421814918518
{'time_elapsed': [459.5421814918518], 'epoch': [66], 'fold': [0], 'f1_train': [0.9821226330865213], 'auroc_train': [0.9999540117116841], 'auprc_train': [0.9999798389917878], 'f1_test': [0.7596459003010357], 'auroc_test': [0.8119783996072655], 'auprc_test': [0.9154523008454221]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 427]           2,048
│    └─Tanh: 2-3                         [64, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 142]           --
│    └─Dropout: 2-5                      [64, 1024, 142]           --
│    └─Flatten: 2-6                      [64, 145408]              --
│    └─Linear: 2-7                       [64, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 121.37
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 447.74
Params size (MB): 0.61
Estimated Total Size (MB): 448.68
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6358450082039632 val_auroc:  0.654639175257732 val_auprc:  0.7696081887782198
epoch:  1
epoch:  2 val_f1:  0.6740890891918117 val_auroc:  0.6917034855179185 val_auprc:  0.8325278627348384
Validation loss improved to 1.262062
epoch:  2
epoch:  3 val_f1:  0.6480279393948458 val_auroc:  0.7577319587628867 val_auprc:  0.8983385741643091
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6848314670997702 val_auroc:  0.7933235149729995 val_auprc:  0.9141782251518865
Validation loss improved to 1.108524
epoch:  4
epoch:  5 val_f1:  0.6755136431395424 val_auroc:  0.8041237113402062 val_auprc:  0.9184932396822485
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.7040153975059064 val_auroc:  0.8109965635738832 val_auprc:  0.9226011540624774
Validation loss improved to 1.016611
epoch:  6
epoch:  7 val_f1:  0.7466980132583976 val_auroc:  0.8026509572901325 val_auprc:  0.9174731573018657
Validation loss improved to 0.977657
epoch:  7
epoch:  8 val_f1:  0.7115566705387387 val_auroc:  0.8119783996072657 val_auprc:  0.9233027445370581
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.3962261628824031 val_auroc:  0.8092783505154639 val_auprc:  0.9226237484778071
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.6907263230511482 val_auroc:  0.812960235640648 val_auprc:  0.9240812891336897
EarlyStopping counter: 3 out of 50
epoch:  10
epoch:  11 val_f1:  0.7203480251458693 val_auroc:  0.810505645557192 val_auprc:  0.9218178778114038
Validation loss improved to 0.969685
epoch:  11
epoch:  12 val_f1:  0.7711689349644636 val_auroc:  0.8004418262150221 val_auprc:  0.9173708341222327
Validation loss improved to 0.969083
epoch:  12
epoch:  13 val_f1:  0.7225455998837295 val_auroc:  0.8026509572901326 val_auprc:  0.9172448222862883
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.6697867552687988 val_auroc:  0.8063328424153167 val_auprc:  0.9197169889924699
EarlyStopping counter: 2 out of 50
epoch:  14
epoch:  15 val_f1:  0.6977368320649064 val_auroc:  0.8014236622484046 val_auprc:  0.9156925763281399
EarlyStopping counter: 3 out of 50
epoch:  15
epoch:  16 val_f1:  0.7510257046352308 val_auroc:  0.8016691212567502 val_auprc:  0.9159495034747132
EarlyStopping counter: 4 out of 50
epoch:  16
epoch:  17 val_f1:  0.681579990245092 val_auroc:  0.7982326951399117 val_auprc:  0.9139727269376732
EarlyStopping counter: 5 out of 50
epoch:  17
epoch:  18 val_f1:  0.726967940210938 val_auroc:  0.7982326951399116 val_auprc:  0.91395910477447
EarlyStopping counter: 6 out of 50
epoch:  18
epoch:  19 val_f1:  0.7477455593342162 val_auroc:  0.7972508591065292 val_auprc:  0.9132632243561494
EarlyStopping counter: 7 out of 50
epoch:  19
epoch:  20 val_f1:  0.7490302789770621 val_auroc:  0.7997054491899853 val_auprc:  0.9131391956296694
EarlyStopping counter: 8 out of 50
epoch:  20
epoch:  21 val_f1:  0.7375047745919104 val_auroc:  0.8090328915071183 val_auprc:  0.9204214555658254
EarlyStopping counter: 9 out of 50
epoch:  21
epoch:  22 val_f1:  0.7386752666832053 val_auroc:  0.8087874324987727 val_auprc:  0.9192141108587761
EarlyStopping counter: 10 out of 50
epoch:  22
epoch:  23 val_f1:  0.7442757932382417 val_auroc:  0.8122238586156112 val_auprc:  0.921130617303044
EarlyStopping counter: 11 out of 50
epoch:  23
epoch:  24 val_f1:  0.7519437633413868 val_auroc:  0.8102601865488464 val_auprc:  0.9194522090753257
EarlyStopping counter: 12 out of 50
epoch:  24
epoch:  25 val_f1:  0.748656020238754 val_auroc:  0.8146784486990672 val_auprc:  0.9214952251321422
Validation loss improved to 0.957236
epoch:  25
epoch:  26 val_f1:  0.7325045643526866 val_auroc:  0.8085419734904271 val_auprc:  0.9180769795960143
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7170452552783244 val_auroc:  0.810505645557192 val_auprc:  0.9191846264574025
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7697841726618705 val_auroc:  0.8146784486990672 val_auprc:  0.9204662838896334
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.7024482739389885 val_auroc:  0.8132056946489937 val_auprc:  0.9191903654761261
EarlyStopping counter: 4 out of 50
epoch:  29
epoch:  30 val_f1:  0.7289242247644242 val_auroc:  0.809769268532155 val_auprc:  0.9184577472159685
EarlyStopping counter: 5 out of 50
epoch:  30
epoch:  31 val_f1:  0.6963248678165901 val_auroc:  0.810505645557192 val_auprc:  0.9176448555901393
EarlyStopping counter: 6 out of 50
epoch:  31
epoch:  32 val_f1:  0.730071543320129 val_auroc:  0.8134511536573392 val_auprc:  0.9198721833991966
EarlyStopping counter: 7 out of 50
epoch:  32
epoch:  33 val_f1:  0.7298678635622811 val_auroc:  0.8073146784486991 val_auprc:  0.9169031185142732
EarlyStopping counter: 8 out of 50
epoch:  33
epoch:  34 val_f1:  0.7583800901862243 val_auroc:  0.8085419734904271 val_auprc:  0.9178555961434453
EarlyStopping counter: 9 out of 50
epoch:  34
epoch:  35 val_f1:  0.7542604103291037 val_auroc:  0.8014236622484044 val_auprc:  0.9125452166738846
EarlyStopping counter: 10 out of 50
epoch:  35
epoch:  36 val_f1:  0.7685409504908388 val_auroc:  0.8100147275405007 val_auprc:  0.9156360582078615
EarlyStopping counter: 11 out of 50
epoch:  36
epoch:  37 val_f1:  0.7496568898727172 val_auroc:  0.8065783014236622 val_auprc:  0.9142038166008929
EarlyStopping counter: 12 out of 50
epoch:  37
epoch:  38 val_f1:  0.7553956834532374 val_auroc:  0.8100147275405007 val_auprc:  0.916877317977818
EarlyStopping counter: 13 out of 50
epoch:  38
epoch:  39 val_f1:  0.7672775806504117 val_auroc:  0.8090328915071183 val_auprc:  0.9157629630548201
EarlyStopping counter: 14 out of 50
epoch:  39
epoch:  40 val_f1:  0.7289242247644242 val_auroc:  0.8055964653902798 val_auprc:  0.9136527603888842
EarlyStopping counter: 15 out of 50
epoch:  40
epoch:  41 val_f1:  0.7496568898727172 val_auroc:  0.8006872852233677 val_auprc:  0.909474710650504
EarlyStopping counter: 16 out of 50
epoch:  41
epoch:  42 val_f1:  0.7643829551743221 val_auroc:  0.8026509572901326 val_auprc:  0.9096730596130682
EarlyStopping counter: 17 out of 50
epoch:  42
epoch:  43 val_f1:  0.7661589271850144 val_auroc:  0.8038782523318606 val_auprc:  0.9095300476495032
EarlyStopping counter: 18 out of 50
epoch:  43
epoch:  44 val_f1:  0.7448635686045757 val_auroc:  0.8031418753068238 val_auprc:  0.9110400737986671
EarlyStopping counter: 19 out of 50
epoch:  44
epoch:  45 val_f1:  0.766354189375772 val_auroc:  0.8043691703485518 val_auprc:  0.9116647398058595
EarlyStopping counter: 20 out of 50
epoch:  45
epoch:  46 val_f1:  0.7496568898727172 val_auroc:  0.8021600392734413 val_auprc:  0.9106925500559151
EarlyStopping counter: 21 out of 50
epoch:  46
epoch:  47 val_f1:  0.7559325673789327 val_auroc:  0.8019145802650958 val_auprc:  0.910403915709415
EarlyStopping counter: 22 out of 50
epoch:  47
epoch:  48 val_f1:  0.7483101088021195 val_auroc:  0.7997054491899853 val_auprc:  0.9082957093390871
EarlyStopping counter: 23 out of 50
epoch:  48
epoch:  49 val_f1:  0.7178022432023763 val_auroc:  0.796759941089838 val_auprc:  0.9069388387542175
EarlyStopping counter: 24 out of 50
epoch:  49
epoch:  50 val_f1:  0.7473654218886486 val_auroc:  0.7972508591065293 val_auprc:  0.9067143085951086
EarlyStopping counter: 25 out of 50
epoch:  50
epoch:  51 val_f1:  0.7359858855314679 val_auroc:  0.7965144820814924 val_auprc:  0.9048824031586522
EarlyStopping counter: 26 out of 50
epoch:  51
epoch:  52 val_f1:  0.7496568898727172 val_auroc:  0.7970054000981837 val_auprc:  0.9073886078157853
EarlyStopping counter: 27 out of 50
epoch:  52
epoch:  53 val_f1:  0.76000113614692 val_auroc:  0.7992145311732941 val_auprc:  0.9083733273180856
EarlyStopping counter: 28 out of 50
epoch:  53
epoch:  54 val_f1:  0.7727225509205256 val_auroc:  0.7950417280314187 val_auprc:  0.9061779822110384
EarlyStopping counter: 29 out of 50
epoch:  54
epoch:  55 val_f1:  0.7643829551743221 val_auroc:  0.7933235149729995 val_auprc:  0.905028625813826
EarlyStopping counter: 30 out of 50
epoch:  55
epoch:  56 val_f1:  0.7643829551743221 val_auroc:  0.7938144329896907 val_auprc:  0.9039649318106521
EarlyStopping counter: 31 out of 50
epoch:  56
epoch:  57 val_f1:  0.7643829551743221 val_auroc:  0.7930780559646539 val_auprc:  0.9025943681944816
EarlyStopping counter: 32 out of 50
epoch:  57
epoch:  58 val_f1:  0.7707245329923307 val_auroc:  0.7930780559646539 val_auprc:  0.9011148164082101
EarlyStopping counter: 33 out of 50
epoch:  58
epoch:  59 val_f1:  0.7238240177089098 val_auroc:  0.7920962199312714 val_auprc:  0.900254349748451
EarlyStopping counter: 34 out of 50
epoch:  59
epoch:  60 val_f1:  0.7643829551743221 val_auroc:  0.7970054000981835 val_auprc:  0.9044685148280881
EarlyStopping counter: 35 out of 50
epoch:  60
epoch:  61 val_f1:  0.7707245329923307 val_auroc:  0.7957781050564556 val_auprc:  0.9040471700039632
EarlyStopping counter: 36 out of 50
epoch:  61
epoch:  62 val_f1:  0.7727225509205256 val_auroc:  0.8001963672066764 val_auprc:  0.9061930682581486
EarlyStopping counter: 37 out of 50
epoch:  62
epoch:  63 val_f1:  0.7473654218886486 val_auroc:  0.791850760922926 val_auprc:  0.9002446036898205
EarlyStopping counter: 38 out of 50
epoch:  63
epoch:  64 val_f1:  0.7643829551743221 val_auroc:  0.7977417771232205 val_auprc:  0.9038608435945601
EarlyStopping counter: 39 out of 50
epoch:  64
epoch:  65 val_f1:  0.7473654218886486 val_auroc:  0.7940598919980363 val_auprc:  0.9022849739899577
EarlyStopping counter: 40 out of 50
epoch:  65
epoch:  66 val_f1:  0.7510724063582411 val_auroc:  0.793078055964654 val_auprc:  0.9008018926269593
EarlyStopping counter: 41 out of 50
epoch:  66
epoch:  67 val_f1:  0.7643829551743221 val_auroc:  0.7945508100147276 val_auprc:  0.9023877786203911
EarlyStopping counter: 42 out of 50
epoch:  67
epoch:  68 val_f1:  0.76000113614692 val_auroc:  0.7911143838978891 val_auprc:  0.9004099951900029
EarlyStopping counter: 43 out of 50
epoch:  68
epoch:  69 val_f1:  0.7473302173830908 val_auroc:  0.7933235149729995 val_auprc:  0.9026077910778759
EarlyStopping counter: 44 out of 50
epoch:  69
epoch:  70 val_f1:  0.7643829551743221 val_auroc:  0.7898870888561611 val_auprc:  0.900423990760953
EarlyStopping counter: 45 out of 50
epoch:  70
epoch:  71 val_f1:  0.7707245329923307 val_auroc:  0.7901325478645066 val_auprc:  0.8993893547166338
EarlyStopping counter: 46 out of 50
epoch:  71
epoch:  72 val_f1:  0.7643829551743221 val_auroc:  0.7935689739813451 val_auprc:  0.900480791408716
EarlyStopping counter: 47 out of 50
epoch:  72
epoch:  73 val_f1:  0.7559325673789327 val_auroc:  0.791850760922926 val_auprc:  0.9013473705975037
EarlyStopping counter: 48 out of 50
epoch:  73
epoch:  74 val_f1:  0.76000113614692 val_auroc:  0.7943053510063819 val_auprc:  0.9022408779160004
EarlyStopping counter: 49 out of 50
epoch:  74
epoch:  75 val_f1:  0.7643829551743221 val_auroc:  0.7886597938144331 val_auprc:  0.8990307880193051
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  509.3374412059784
{'time_elapsed': [509.3374412059784], 'epoch': [74], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7643829551743221], 'auroc_test': [0.7886597938144331], 'auprc_test': [0.8990307880193051]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 427]           2,048
│    └─Tanh: 2-3                         [64, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 142]           --
│    └─Dropout: 2-5                      [64, 1024, 142]           --
│    └─Flatten: 2-6                      [64, 145408]              --
│    └─Linear: 2-7                       [64, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 121.37
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 447.74
Params size (MB): 0.61
Estimated Total Size (MB): 448.68
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.19551097090242242 val_auroc:  0.5451644575355915 val_auprc:  0.7311676309971274
epoch:  1
epoch:  2 val_f1:  0.5231089117145591 val_auroc:  0.5432007854688267 val_auprc:  0.7340755460125679
Validation loss improved to 2.056981
epoch:  2
epoch:  3 val_f1:  0.6272051266549784 val_auroc:  0.5827196858124692 val_auprc:  0.7683836781014377
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.564230889535863 val_auroc:  0.6244477172312224 val_auprc:  0.8097654556945333
Validation loss improved to 1.718675
epoch:  4
epoch:  5 val_f1:  0.575871059068063 val_auroc:  0.6624938635247913 val_auprc:  0.8350432543958625
Validation loss improved to 1.589657
epoch:  5
epoch:  6 val_f1:  0.6301488691399822 val_auroc:  0.6855670103092782 val_auprc:  0.8445989494328286
Validation loss improved to 1.424155
epoch:  6
epoch:  7 val_f1:  0.6671807736985447 val_auroc:  0.698821796759941 val_auprc:  0.845370983846168
Validation loss improved to 1.396297
epoch:  7
epoch:  8 val_f1:  0.5575599172691673 val_auroc:  0.7088856161021109 val_auprc:  0.842720940768044
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.6938767409717547 val_auroc:  0.7265586647029946 val_auprc:  0.8534053041909044
Validation loss improved to 1.339667
epoch:  9
epoch:  10 val_f1:  0.5597357934547883 val_auroc:  0.7312223858615611 val_auprc:  0.8550539991428047
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.6756398022243748 val_auroc:  0.7439862542955327 val_auprc:  0.863455093986321
EarlyStopping counter: 2 out of 50
epoch:  11
epoch:  12 val_f1:  0.6149632934836883 val_auroc:  0.7464408443789887 val_auprc:  0.865044713929193
Validation loss improved to 1.256272
epoch:  12
epoch:  13 val_f1:  0.6756398022243748 val_auroc:  0.7466863033873343 val_auprc:  0.8635393939265389
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7223183251151889 val_auroc:  0.7420225822287678 val_auprc:  0.858796960989168
Validation loss improved to 1.222829
epoch:  14
epoch:  15 val_f1:  0.6823403921278894 val_auroc:  0.7476681394207169 val_auprc:  0.8622475564448462
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.6593794386362282 val_auroc:  0.7623956799214531 val_auprc:  0.8725384300145517
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.7236892364125374 val_auroc:  0.7685321551300932 val_auprc:  0.8771042876385112
Validation loss improved to 1.165015
epoch:  17
epoch:  18 val_f1:  0.7169009504644194 val_auroc:  0.7643593519882179 val_auprc:  0.8727080611390838
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7203480251458693 val_auroc:  0.761904761904762 val_auprc:  0.8720348585007839
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7304528631430115 val_auroc:  0.7589592538046147 val_auprc:  0.8726776679654549
EarlyStopping counter: 3 out of 50
epoch:  20
epoch:  21 val_f1:  0.7249644134959412 val_auroc:  0.7675503190967108 val_auprc:  0.8782012805737469
EarlyStopping counter: 4 out of 50
epoch:  21
epoch:  22 val_f1:  0.6963248678165901 val_auroc:  0.7616593028964164 val_auprc:  0.8728389054611123
EarlyStopping counter: 5 out of 50
epoch:  22
epoch:  23 val_f1:  0.7107661257285465 val_auroc:  0.7731958762886597 val_auprc:  0.8804723600852267
EarlyStopping counter: 6 out of 50
epoch:  23
epoch:  24 val_f1:  0.682026026688228 val_auroc:  0.7768777614138439 val_auprc:  0.8825881350484033
EarlyStopping counter: 7 out of 50
epoch:  24
epoch:  25 val_f1:  0.7454557504588546 val_auroc:  0.7773686794305351 val_auprc:  0.8831492610396565
EarlyStopping counter: 8 out of 50
epoch:  25
epoch:  26 val_f1:  0.7346924658075737 val_auroc:  0.7736867943053509 val_auprc:  0.8799012292344585
EarlyStopping counter: 9 out of 50
epoch:  26
epoch:  27 val_f1:  0.7032425848040964 val_auroc:  0.7702503681885124 val_auprc:  0.878826692188329
EarlyStopping counter: 10 out of 50
epoch:  27
epoch:  28 val_f1:  0.7359369647139431 val_auroc:  0.7663230240549828 val_auprc:  0.8753532614115122
EarlyStopping counter: 11 out of 50
epoch:  28
epoch:  29 val_f1:  0.5088377107492125 val_auroc:  0.7741777123220422 val_auprc:  0.8826382232881811
EarlyStopping counter: 12 out of 50
epoch:  29
epoch:  30 val_f1:  0.6759950757759244 val_auroc:  0.7849779086892489 val_auprc:  0.8888670296716397
EarlyStopping counter: 13 out of 50
epoch:  30
epoch:  31 val_f1:  0.7233618940391454 val_auroc:  0.7589592538046146 val_auprc:  0.872107714813652
EarlyStopping counter: 14 out of 50
epoch:  31
epoch:  32 val_f1:  0.7060068982302729 val_auroc:  0.7702503681885126 val_auprc:  0.8809720065912976
EarlyStopping counter: 15 out of 50
epoch:  32
epoch:  33 val_f1:  0.7140775751491829 val_auroc:  0.7714776632302406 val_auprc:  0.8795723513661682
EarlyStopping counter: 16 out of 50
epoch:  33
epoch:  34 val_f1:  0.7150229029574715 val_auroc:  0.7717231222385861 val_auprc:  0.8800822942715822
EarlyStopping counter: 17 out of 50
epoch:  34
epoch:  35 val_f1:  0.7142089711496735 val_auroc:  0.7690230731467844 val_auprc:  0.8794615214180704
EarlyStopping counter: 18 out of 50
epoch:  35
epoch:  36 val_f1:  0.7313689473952751 val_auroc:  0.7729504172803142 val_auprc:  0.8817666456865473
EarlyStopping counter: 19 out of 50
epoch:  36
epoch:  37 val_f1:  0.7184536707983012 val_auroc:  0.7690230731467845 val_auprc:  0.8787698614959276
EarlyStopping counter: 20 out of 50
epoch:  37
epoch:  38 val_f1:  0.7144317414801258 val_auroc:  0.7727049582719685 val_auprc:  0.882672727066582
EarlyStopping counter: 21 out of 50
epoch:  38
epoch:  39 val_f1:  0.722058496910722 val_auroc:  0.771232204221895 val_auprc:  0.8821057127377782
EarlyStopping counter: 22 out of 50
epoch:  39
epoch:  40 val_f1:  0.7283736963917239 val_auroc:  0.7663230240549829 val_auprc:  0.8738741074015384
EarlyStopping counter: 23 out of 50
epoch:  40
epoch:  41 val_f1:  0.7363119073255568 val_auroc:  0.7734413352970054 val_auprc:  0.8837917317058331
EarlyStopping counter: 24 out of 50
epoch:  41
epoch:  42 val_f1:  0.7272357092755477 val_auroc:  0.7663230240549828 val_auprc:  0.8748364816189941
EarlyStopping counter: 25 out of 50
epoch:  42
epoch:  43 val_f1:  0.7299542184434271 val_auroc:  0.766813942071674 val_auprc:  0.8783838390643439
EarlyStopping counter: 26 out of 50
epoch:  43
epoch:  44 val_f1:  0.7384802450563926 val_auroc:  0.7741777123220424 val_auprc:  0.8819285248144622
EarlyStopping counter: 27 out of 50
epoch:  44
epoch:  45 val_f1:  0.7034651178140057 val_auroc:  0.7751595483554247 val_auprc:  0.8874720912648495
EarlyStopping counter: 28 out of 50
epoch:  45
epoch:  46 val_f1:  0.708480907581627 val_auroc:  0.7569955817378498 val_auprc:  0.8712672475141253
EarlyStopping counter: 29 out of 50
epoch:  46
epoch:  47 val_f1:  0.7140775751491829 val_auroc:  0.7628865979381443 val_auprc:  0.8743334894190984
EarlyStopping counter: 30 out of 50
epoch:  47
epoch:  48 val_f1:  0.7235944791518311 val_auroc:  0.7682866961217476 val_auprc:  0.8764679175688181
EarlyStopping counter: 31 out of 50
epoch:  48
epoch:  49 val_f1:  0.7295632867761842 val_auroc:  0.7719685812469318 val_auprc:  0.8807472984288607
EarlyStopping counter: 32 out of 50
epoch:  49
epoch:  50 val_f1:  0.7122302158273381 val_auroc:  0.7660775650466372 val_auprc:  0.8770182967722151
EarlyStopping counter: 33 out of 50
epoch:  50
epoch:  51 val_f1:  0.7122302158273381 val_auroc:  0.7641138929798724 val_auprc:  0.8734611899481552
EarlyStopping counter: 34 out of 50
epoch:  51
epoch:  52 val_f1:  0.7163649790827238 val_auroc:  0.7695139911634757 val_auprc:  0.8782730016873592
EarlyStopping counter: 35 out of 50
epoch:  52
epoch:  53 val_f1:  0.7184536707983012 val_auroc:  0.7709867452135494 val_auprc:  0.8782022622035484
EarlyStopping counter: 36 out of 50
epoch:  53
epoch:  54 val_f1:  0.7122302158273381 val_auroc:  0.7714776632302406 val_auprc:  0.8785223746039685
EarlyStopping counter: 37 out of 50
epoch:  54
epoch:  55 val_f1:  0.7122302158273381 val_auroc:  0.7685321551300933 val_auprc:  0.8759891495707763
EarlyStopping counter: 38 out of 50
epoch:  55
epoch:  56 val_f1:  0.7184536707983012 val_auroc:  0.771232204221895 val_auprc:  0.8780513501234491
EarlyStopping counter: 39 out of 50
epoch:  56
epoch:  57 val_f1:  0.7122302158273381 val_auroc:  0.7692685321551301 val_auprc:  0.8780201913337582
EarlyStopping counter: 40 out of 50
epoch:  57
epoch:  58 val_f1:  0.7203480251458693 val_auroc:  0.7727049582719686 val_auprc:  0.8823307047980918
EarlyStopping counter: 41 out of 50
epoch:  58
epoch:  59 val_f1:  0.7163649790827238 val_auroc:  0.770004909180167 val_auprc:  0.8784639640788133
EarlyStopping counter: 42 out of 50
epoch:  59
epoch:  60 val_f1:  0.7203480251458693 val_auroc:  0.7702503681885126 val_auprc:  0.8798215922215382
EarlyStopping counter: 43 out of 50
epoch:  60
epoch:  61 val_f1:  0.7386752666832053 val_auroc:  0.7704958271968582 val_auprc:  0.8796640419071705
EarlyStopping counter: 44 out of 50
epoch:  61
epoch:  62 val_f1:  0.7163649790827238 val_auroc:  0.7717231222385862 val_auprc:  0.8793805025905818
EarlyStopping counter: 45 out of 50
epoch:  62
epoch:  63 val_f1:  0.7283736963917239 val_auroc:  0.7704958271968582 val_auprc:  0.8788726848729269
EarlyStopping counter: 46 out of 50
epoch:  63
epoch:  64 val_f1:  0.7246795893300292 val_auroc:  0.7704958271968582 val_auprc:  0.8793618477376541
EarlyStopping counter: 47 out of 50
epoch:  64
epoch:  65 val_f1:  0.7203480251458693 val_auroc:  0.7697594501718212 val_auprc:  0.878287307292015
EarlyStopping counter: 48 out of 50
epoch:  65
epoch:  66 val_f1:  0.7163649790827238 val_auroc:  0.7665684830633284 val_auprc:  0.8755914035073393
EarlyStopping counter: 49 out of 50
epoch:  66
epoch:  67 val_f1:  0.7411406017655346 val_auroc:  0.7691458026509573 val_auprc:  0.8770059169082631
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  455.4245388507843
{'time_elapsed': [455.4245388507843], 'epoch': [66], 'fold': [2], 'f1_train': [0.9964023152258445], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7411406017655346], 'auroc_test': [0.7691458026509573], 'auprc_test': [0.8770059169082631]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 427]           2,048
│    └─Tanh: 2-3                         [64, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 142]           --
│    └─Dropout: 2-5                      [64, 1024, 142]           --
│    └─Flatten: 2-6                      [64, 145408]              --
│    └─Linear: 2-7                       [64, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 121.37
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 447.74
Params size (MB): 0.61
Estimated Total Size (MB): 448.68
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.3975201110014998 val_auroc:  0.7546027131782946 val_auprc:  0.8798038861530519
epoch:  1
epoch:  2 val_f1:  0.5057706755611244 val_auroc:  0.7383720930232558 val_auprc:  0.8747510964982477
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.673350961394546 val_auroc:  0.7308624031007751 val_auprc:  0.8644457085565513
Validation loss improved to 1.283091
epoch:  3
epoch:  4 val_f1:  0.7153390575965436 val_auroc:  0.7589631782945736 val_auprc:  0.8806165217181243
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.7227964754633075 val_auroc:  0.7887596899224806 val_auprc:  0.8992495081617956
Validation loss improved to 1.033775
epoch:  5
epoch:  6 val_f1:  0.6476914102813383 val_auroc:  0.8112887596899225 val_auprc:  0.9152093799499201
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.7577099349812915 val_auroc:  0.8214631782945736 val_auprc:  0.9207336635485076
Validation loss improved to 0.901142
epoch:  7
epoch:  8 val_f1:  0.7247733477430133 val_auroc:  0.8221899224806202 val_auprc:  0.9177780034168785
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7594266802546743 val_auroc:  0.8277616279069766 val_auprc:  0.9188320719354248
Validation loss improved to 0.854245
epoch:  9
epoch:  10 val_f1:  0.7901923359271766 val_auroc:  0.8318798449612403 val_auprc:  0.9209993246509904
Validation loss improved to 0.820389
epoch:  10
epoch:  11 val_f1:  0.7276160185397049 val_auroc:  0.8355135658914729 val_auprc:  0.9222665745460756
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7363492257041825 val_auroc:  0.8406007751937985 val_auprc:  0.9287760897765284
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.7414744243025527 val_auroc:  0.8384205426356589 val_auprc:  0.9282094297692264
EarlyStopping counter: 3 out of 50
epoch:  13
epoch:  14 val_f1:  0.7777989809743717 val_auroc:  0.8367248062015503 val_auprc:  0.9279059377864156
Validation loss improved to 0.795059
epoch:  14
epoch:  15 val_f1:  0.7754499696945739 val_auroc:  0.8393895348837209 val_auprc:  0.9285710203135715
Validation loss improved to 0.787600
epoch:  15
epoch:  16 val_f1:  0.7776763243674784 val_auroc:  0.8410852713178295 val_auprc:  0.9298750878653709
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7562473143424068 val_auroc:  0.841327519379845 val_auprc:  0.9306153942740868
EarlyStopping counter: 2 out of 50
epoch:  17
epoch:  18 val_f1:  0.7714826564458221 val_auroc:  0.8410852713178295 val_auprc:  0.9315483261796147
EarlyStopping counter: 3 out of 50
epoch:  18
epoch:  19 val_f1:  0.7746634573712671 val_auroc:  0.8403585271317829 val_auprc:  0.931583504232559
EarlyStopping counter: 4 out of 50
epoch:  19
epoch:  20 val_f1:  0.7359332786935009 val_auroc:  0.844234496124031 val_auprc:  0.9326242211022281
EarlyStopping counter: 5 out of 50
epoch:  20
epoch:  21 val_f1:  0.7238355598325329 val_auroc:  0.8468992248062016 val_auprc:  0.9337762005724666
EarlyStopping counter: 6 out of 50
epoch:  21
epoch:  22 val_f1:  0.7575506945737088 val_auroc:  0.8473837209302325 val_auprc:  0.9342696674643958
EarlyStopping counter: 7 out of 50
epoch:  22
epoch:  23 val_f1:  0.7840893588200424 val_auroc:  0.8456879844961239 val_auprc:  0.9334447762948703
Validation loss improved to 0.777542
epoch:  23
epoch:  24 val_f1:  0.7697841726618705 val_auroc:  0.849563953488372 val_auprc:  0.9361594794443058
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7287292238115599 val_auroc:  0.8493217054263565 val_auprc:  0.9352361367393383
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.7746634573712671 val_auroc:  0.8502906976744186 val_auprc:  0.9346209962826784
EarlyStopping counter: 3 out of 50
epoch:  26
epoch:  27 val_f1:  0.7906801532257888 val_auroc:  0.8488372093023255 val_auprc:  0.9364456066036886
EarlyStopping counter: 4 out of 50
epoch:  27
epoch:  28 val_f1:  0.7695564219015847 val_auroc:  0.8510174418604651 val_auprc:  0.9369895758033069
Validation loss improved to 0.763952
epoch:  28
epoch:  29 val_f1:  0.7811109002295425 val_auroc:  0.8529554263565892 val_auprc:  0.9383936402415696
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.7835226993620948 val_auroc:  0.8531976744186046 val_auprc:  0.9397378833745523
Validation loss improved to 0.730990
epoch:  30
epoch:  31 val_f1:  0.7746634573712671 val_auroc:  0.8546511627906976 val_auprc:  0.9393048417523537
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.7851694050563778 val_auroc:  0.8558624031007752 val_auprc:  0.9416326021092826
EarlyStopping counter: 2 out of 50
epoch:  32
epoch:  33 val_f1:  0.7811523753969797 val_auroc:  0.8544089147286821 val_auprc:  0.9411401023587133
EarlyStopping counter: 3 out of 50
epoch:  33
epoch:  34 val_f1:  0.7811109002295425 val_auroc:  0.8582848837209303 val_auprc:  0.9413289704656653
EarlyStopping counter: 4 out of 50
epoch:  34
epoch:  35 val_f1:  0.8027539115793398 val_auroc:  0.8594961240310077 val_auprc:  0.9426662799453118
Validation loss improved to 0.718290
epoch:  35
epoch:  36 val_f1:  0.783844953500274 val_auroc:  0.8619186046511628 val_auprc:  0.9432916924425667
EarlyStopping counter: 1 out of 50
epoch:  36
epoch:  37 val_f1:  0.7974889768226049 val_auroc:  0.8626453488372093 val_auprc:  0.945028609155198
EarlyStopping counter: 2 out of 50
epoch:  37
epoch:  38 val_f1:  0.7178284263345626 val_auroc:  0.8594961240310078 val_auprc:  0.9430351677680362
EarlyStopping counter: 3 out of 50
epoch:  38
epoch:  39 val_f1:  0.7912899626822607 val_auroc:  0.8624031007751938 val_auprc:  0.9446262832993726
EarlyStopping counter: 4 out of 50
epoch:  39
epoch:  40 val_f1:  0.7997900244397783 val_auroc:  0.865794573643411 val_auprc:  0.94610027154652
EarlyStopping counter: 5 out of 50
epoch:  40
epoch:  41 val_f1:  0.8101799492243995 val_auroc:  0.8696705426356589 val_auprc:  0.9478940768723568
Validation loss improved to 0.708971
epoch:  41
epoch:  42 val_f1:  0.792019787311512 val_auroc:  0.8711240310077518 val_auprc:  0.948431175071643
EarlyStopping counter: 1 out of 50
epoch:  42
epoch:  43 val_f1:  0.8151164175042944 val_auroc:  0.8694282945736433 val_auprc:  0.9481472870903451
EarlyStopping counter: 2 out of 50
epoch:  43
epoch:  44 val_f1:  0.7907929835906556 val_auroc:  0.8742732558139535 val_auprc:  0.9495876628968377
Validation loss improved to 0.699977
epoch:  44
epoch:  45 val_f1:  0.792259730676997 val_auroc:  0.8757267441860465 val_auprc:  0.9490553596197344
EarlyStopping counter: 1 out of 50
epoch:  45
epoch:  46 val_f1:  0.8051160047274586 val_auroc:  0.8745155038759691 val_auprc:  0.9499843803621921
EarlyStopping counter: 2 out of 50
epoch:  46
epoch:  47 val_f1:  0.8160321672535743 val_auroc:  0.8786337209302325 val_auprc:  0.9518984243316517
Validation loss improved to 0.688933
epoch:  47
epoch:  48 val_f1:  0.8022252248962252 val_auroc:  0.8779069767441859 val_auprc:  0.9508121009093466
EarlyStopping counter: 1 out of 50
epoch:  48
epoch:  49 val_f1:  0.7857930944221151 val_auroc:  0.8774224806201552 val_auprc:  0.9508996427734582
EarlyStopping counter: 2 out of 50
epoch:  49
epoch:  50 val_f1:  0.8055741083525751 val_auroc:  0.8783914728682171 val_auprc:  0.9505894822550808
EarlyStopping counter: 3 out of 50
epoch:  50
epoch:  51 val_f1:  0.7957035068809065 val_auroc:  0.8769379844961239 val_auprc:  0.951307380952656
EarlyStopping counter: 4 out of 50
epoch:  51
epoch:  52 val_f1:  0.7961192047225032 val_auroc:  0.8805717054263567 val_auprc:  0.9528344460205411
Validation loss improved to 0.681726
epoch:  52
epoch:  53 val_f1:  0.8005659844619692 val_auroc:  0.8825096899224806 val_auprc:  0.9527936411134245
EarlyStopping counter: 1 out of 50
epoch:  53
epoch:  54 val_f1:  0.7841726618705036 val_auroc:  0.8827519379844961 val_auprc:  0.9530872849819456
EarlyStopping counter: 2 out of 50
epoch:  54
epoch:  55 val_f1:  0.8018807955038493 val_auroc:  0.8842054263565892 val_auprc:  0.9533419623888858
EarlyStopping counter: 3 out of 50
epoch:  55
epoch:  56 val_f1:  0.8051160047274586 val_auroc:  0.8854166666666665 val_auprc:  0.9542500829178375
EarlyStopping counter: 4 out of 50
epoch:  56
epoch:  57 val_f1:  0.7875752415552048 val_auroc:  0.8846899224806202 val_auprc:  0.9537145411788963
EarlyStopping counter: 5 out of 50
epoch:  57
epoch:  58 val_f1:  0.8051160047274586 val_auroc:  0.8849321705426356 val_auprc:  0.9537791535113627
EarlyStopping counter: 6 out of 50
epoch:  58
epoch:  59 val_f1:  0.8108668046482106 val_auroc:  0.8849321705426357 val_auprc:  0.9538937043668844
Validation loss improved to 0.681130
epoch:  59
epoch:  60 val_f1:  0.792259730676997 val_auroc:  0.883720930232558 val_auprc:  0.9532201463383799
EarlyStopping counter: 1 out of 50
epoch:  60
epoch:  61 val_f1:  0.8074875573056803 val_auroc:  0.8873546511627907 val_auprc:  0.9547689062001385
EarlyStopping counter: 2 out of 50
epoch:  61
epoch:  62 val_f1:  0.8074875573056803 val_auroc:  0.8854166666666666 val_auprc:  0.9541751665349874
EarlyStopping counter: 3 out of 50
epoch:  62
epoch:  63 val_f1:  0.8151164175042944 val_auroc:  0.8890503875968992 val_auprc:  0.9557929491931066
EarlyStopping counter: 4 out of 50
epoch:  63
epoch:  64 val_f1:  0.8051160047274586 val_auroc:  0.8888081395348837 val_auprc:  0.9551802010980821
EarlyStopping counter: 5 out of 50
epoch:  64
epoch:  65 val_f1:  0.8018807955038493 val_auroc:  0.8868701550387597 val_auprc:  0.9546923508564871
EarlyStopping counter: 6 out of 50
epoch:  65
epoch:  66 val_f1:  0.8027539115793398 val_auroc:  0.8878391472868217 val_auprc:  0.9550102037559105
EarlyStopping counter: 7 out of 50
epoch:  66
epoch:  67 val_f1:  0.8151164175042944 val_auroc:  0.8873546511627907 val_auprc:  0.9555486183136871
EarlyStopping counter: 8 out of 50
epoch:  67
epoch:  68 val_f1:  0.8129496402877698 val_auroc:  0.8880813953488371 val_auprc:  0.9551988486074611
EarlyStopping counter: 9 out of 50
epoch:  68
epoch:  69 val_f1:  0.8140907369797942 val_auroc:  0.8880813953488372 val_auprc:  0.955206422631691
EarlyStopping counter: 10 out of 50
epoch:  69
epoch:  70 val_f1:  0.8140907369797942 val_auroc:  0.8917151162790697 val_auprc:  0.956685840145231
EarlyStopping counter: 11 out of 50
epoch:  70
epoch:  71 val_f1:  0.8093907785715628 val_auroc:  0.8917151162790697 val_auprc:  0.9566046061360891
EarlyStopping counter: 12 out of 50
epoch:  71
epoch:  72 val_f1:  0.8168429178951009 val_auroc:  0.8866279069767442 val_auprc:  0.9550045454273606
EarlyStopping counter: 13 out of 50
epoch:  72
epoch:  73 val_f1:  0.8151164175042944 val_auroc:  0.8875968992248062 val_auprc:  0.9554978261748962
EarlyStopping counter: 14 out of 50
epoch:  73
epoch:  74 val_f1:  0.8027539115793398 val_auroc:  0.8880813953488373 val_auprc:  0.9551438432479209
EarlyStopping counter: 15 out of 50
epoch:  74
epoch:  75 val_f1:  0.8129496402877698 val_auroc:  0.8912306201550388 val_auprc:  0.9560623352212096
EarlyStopping counter: 16 out of 50
epoch:  75
epoch:  76 val_f1:  0.8140907369797942 val_auroc:  0.8900193798449613 val_auprc:  0.9563612048327751
EarlyStopping counter: 17 out of 50
epoch:  76
epoch:  77 val_f1:  0.8129496402877698 val_auroc:  0.8914728682170541 val_auprc:  0.9563322324150473
EarlyStopping counter: 18 out of 50
epoch:  77
epoch:  78 val_f1:  0.8160321672535743 val_auroc:  0.8909883720930233 val_auprc:  0.9566610296625904
EarlyStopping counter: 19 out of 50
epoch:  78
epoch:  79 val_f1:  0.8226804934380051 val_auroc:  0.8902616279069767 val_auprc:  0.9558617032064757
EarlyStopping counter: 20 out of 50
epoch:  79
epoch:  80 val_f1:  0.8140907369797942 val_auroc:  0.8888081395348837 val_auprc:  0.9557675338404732
EarlyStopping counter: 21 out of 50
epoch:  80
epoch:  81 val_f1:  0.8217477382460002 val_auroc:  0.8905038759689923 val_auprc:  0.956024144596654
EarlyStopping counter: 22 out of 50
epoch:  81
epoch:  82 val_f1:  0.8140907369797942 val_auroc:  0.8907461240310078 val_auprc:  0.9568617128113788
EarlyStopping counter: 23 out of 50
epoch:  82
epoch:  83 val_f1:  0.8235099801588546 val_auroc:  0.8907461240310077 val_auprc:  0.9561319518828182
EarlyStopping counter: 24 out of 50
epoch:  83
epoch:  84 val_f1:  0.8217477382460002 val_auroc:  0.8919573643410853 val_auprc:  0.9568500682765344
EarlyStopping counter: 25 out of 50
epoch:  84
epoch:  85 val_f1:  0.7892012988311853 val_auroc:  0.8909883720930233 val_auprc:  0.9561373167858455
EarlyStopping counter: 26 out of 50
epoch:  85
epoch:  86 val_f1:  0.7892012988311853 val_auroc:  0.8919573643410852 val_auprc:  0.9564912703706608
EarlyStopping counter: 27 out of 50
epoch:  86
epoch:  87 val_f1:  0.7892012988311853 val_auroc:  0.8917151162790696 val_auprc:  0.9560688135921072
EarlyStopping counter: 28 out of 50
epoch:  87
epoch:  88 val_f1:  0.7892012988311853 val_auroc:  0.8912306201550387 val_auprc:  0.9557011299245954
EarlyStopping counter: 29 out of 50
epoch:  88
epoch:  89 val_f1:  0.7892012988311853 val_auroc:  0.8936531007751938 val_auprc:  0.9567689314844583
EarlyStopping counter: 30 out of 50
epoch:  89
epoch:  90 val_f1:  0.8207067131995794 val_auroc:  0.8921996124031006 val_auprc:  0.956793029126662
EarlyStopping counter: 31 out of 50
epoch:  90
epoch:  91 val_f1:  0.8140907369797942 val_auroc:  0.8914728682170542 val_auprc:  0.95665443779602
EarlyStopping counter: 32 out of 50
epoch:  91
epoch:  92 val_f1:  0.8217477382460002 val_auroc:  0.8924418604651163 val_auprc:  0.956681685137454
EarlyStopping counter: 33 out of 50
epoch:  92
epoch:  93 val_f1:  0.8217477382460002 val_auroc:  0.8948643410852712 val_auprc:  0.95799928380947
EarlyStopping counter: 34 out of 50
epoch:  93
epoch:  94 val_f1:  0.7972014141264308 val_auroc:  0.8929263565891473 val_auprc:  0.9572940688220835
EarlyStopping counter: 35 out of 50
epoch:  94
epoch:  95 val_f1:  0.7957035068809065 val_auroc:  0.8919573643410853 val_auprc:  0.9561241916842818
EarlyStopping counter: 36 out of 50
epoch:  95
epoch:  96 val_f1:  0.7957035068809065 val_auroc:  0.8917151162790699 val_auprc:  0.955834272465536
EarlyStopping counter: 37 out of 50
epoch:  96
epoch:  97 val_f1:  0.8116870274031143 val_auroc:  0.8921996124031008 val_auprc:  0.9561675071424182
EarlyStopping counter: 38 out of 50
epoch:  97
epoch:  98 val_f1:  0.8293382315424257 val_auroc:  0.8929263565891473 val_auprc:  0.9572954891391868
EarlyStopping counter: 39 out of 50
epoch:  98
epoch:  99 val_f1:  0.8217477382460002 val_auroc:  0.8931686046511628 val_auprc:  0.9572850810264958
EarlyStopping counter: 40 out of 50
epoch:  99
epoch:  100 val_f1:  0.8051160047274586 val_auroc:  0.8926841085271318 val_auprc:  0.9566853361517645
EarlyStopping counter: 41 out of 50
epoch:  100
epoch:  101 val_f1:  0.8217477382460002 val_auroc:  0.8912306201550386 val_auprc:  0.956543344629189
EarlyStopping counter: 42 out of 50
epoch:  101
epoch:  102 val_f1:  0.8063632502555458 val_auroc:  0.8909883720930232 val_auprc:  0.9564112138098073
EarlyStopping counter: 43 out of 50
epoch:  102
epoch:  103 val_f1:  0.8217477382460002 val_auroc:  0.8919573643410853 val_auprc:  0.9570976251693335
EarlyStopping counter: 44 out of 50
epoch:  103
epoch:  104 val_f1:  0.7957035068809065 val_auroc:  0.892199612403101 val_auprc:  0.9564121010091825
EarlyStopping counter: 45 out of 50
epoch:  104
epoch:  105 val_f1:  0.7957035068809065 val_auroc:  0.8919573643410852 val_auprc:  0.9564512196076558
EarlyStopping counter: 46 out of 50
epoch:  105
epoch:  106 val_f1:  0.7957035068809065 val_auroc:  0.8924418604651163 val_auprc:  0.9570791319608343
EarlyStopping counter: 47 out of 50
epoch:  106
epoch:  107 val_f1:  0.8217477382460002 val_auroc:  0.8919573643410852 val_auprc:  0.9559987688670148
EarlyStopping counter: 48 out of 50
epoch:  107
epoch:  108 val_f1:  0.8235099801588546 val_auroc:  0.8917151162790697 val_auprc:  0.9567603107747549
EarlyStopping counter: 49 out of 50
epoch:  108
epoch:  109 val_f1:  0.8140907369797942 val_auroc:  0.8924418604651163 val_auprc:  0.9570047727558372
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  738.5893666744232
{'time_elapsed': [738.5893666744232], 'epoch': [108], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8140907369797942], 'auroc_test': [0.8924418604651163], 'auprc_test': [0.9570047727558372]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 427]           2,048
│    └─Tanh: 2-3                         [64, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 142]           --
│    └─Dropout: 2-5                      [64, 1024, 142]           --
│    └─Flatten: 2-6                      [64, 145408]              --
│    └─Linear: 2-7                       [64, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 121.37
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 447.74
Params size (MB): 0.61
Estimated Total Size (MB): 448.68
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6196951870194545 val_auroc:  0.7088293650793651 val_auprc:  0.7898325045286214
epoch:  1
epoch:  2 val_f1:  0.7289813782567406 val_auroc:  0.7966269841269842 val_auprc:  0.8855109317987008
Validation loss improved to 0.967872
epoch:  2
epoch:  3 val_f1:  0.6473429951690821 val_auroc:  0.8120039682539683 val_auprc:  0.8986598073646488
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.7194500662991138 val_auroc:  0.8045634920634921 val_auprc:  0.8945001969076968
Validation loss improved to 0.892927
epoch:  4
epoch:  5 val_f1:  0.7317197141433959 val_auroc:  0.8132440476190476 val_auprc:  0.8973755199281546
Validation loss improved to 0.865003
epoch:  5
epoch:  6 val_f1:  0.7599597442335648 val_auroc:  0.8296130952380953 val_auprc:  0.9057354463261567
Validation loss improved to 0.838400
epoch:  6
epoch:  7 val_f1:  0.7211635684840941 val_auroc:  0.837797619047619 val_auprc:  0.9089410660078266
Validation loss improved to 0.833934
epoch:  7
epoch:  8 val_f1:  0.7929485957015485 val_auroc:  0.8395337301587301 val_auprc:  0.9104098447490493
Validation loss improved to 0.821800
epoch:  8
epoch:  9 val_f1:  0.740835026759861 val_auroc:  0.8452380952380952 val_auprc:  0.9192485404134866
Validation loss improved to 0.815592
epoch:  9
epoch:  10 val_f1:  0.7425627404942808 val_auroc:  0.8531746031746031 val_auprc:  0.9219006777793193
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.773156899810964 val_auroc:  0.8578869047619047 val_auprc:  0.9255595763522899
Validation loss improved to 0.787963
epoch:  11
epoch:  12 val_f1:  0.7055011987299942 val_auroc:  0.8603670634920635 val_auprc:  0.9270739780614851
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7863487611033193 val_auroc:  0.8625992063492063 val_auprc:  0.9289939073373683
Validation loss improved to 0.782510
epoch:  13
epoch:  14 val_f1:  0.7622811970638058 val_auroc:  0.8640873015873016 val_auprc:  0.929347831217523
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.7761264822134387 val_auroc:  0.8640873015873016 val_auprc:  0.929513392005457
Validation loss improved to 0.773844
epoch:  15
epoch:  16 val_f1:  0.820411899313501 val_auroc:  0.8645833333333334 val_auprc:  0.9299894696369364
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7356159817134149 val_auroc:  0.8650793650793651 val_auprc:  0.9300776634090238
EarlyStopping counter: 2 out of 50
epoch:  17
epoch:  18 val_f1:  0.7697938448700337 val_auroc:  0.8645833333333335 val_auprc:  0.9297209151157946
EarlyStopping counter: 3 out of 50
epoch:  18
epoch:  19 val_f1:  0.7852367336641158 val_auroc:  0.8655753968253969 val_auprc:  0.9303076539897797
EarlyStopping counter: 4 out of 50
epoch:  19
epoch:  20 val_f1:  0.770099160945843 val_auroc:  0.8678075396825397 val_auprc:  0.9313595724516103
Validation loss improved to 0.769777
epoch:  20
epoch:  21 val_f1:  0.8368636194723152 val_auroc:  0.8665674603174602 val_auprc:  0.9331022794490573
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7589792060491495 val_auroc:  0.8623511904761905 val_auprc:  0.9302371798214312
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.6896618357487924 val_auroc:  0.8670634920634921 val_auprc:  0.9333470176001291
EarlyStopping counter: 3 out of 50
epoch:  23
epoch:  24 val_f1:  0.7346215780998389 val_auroc:  0.8687996031746031 val_auprc:  0.9345525372646803
EarlyStopping counter: 4 out of 50
epoch:  24
epoch:  25 val_f1:  0.7418719280901397 val_auroc:  0.8678075396825398 val_auprc:  0.9323597541107373
EarlyStopping counter: 5 out of 50
epoch:  25
epoch:  26 val_f1:  0.8072024593763724 val_auroc:  0.8638392857142858 val_auprc:  0.9293694690644633
EarlyStopping counter: 6 out of 50
epoch:  26
epoch:  27 val_f1:  0.7901701323251418 val_auroc:  0.8690476190476191 val_auprc:  0.9330548661401846
EarlyStopping counter: 7 out of 50
epoch:  27
epoch:  28 val_f1:  0.8049865427618805 val_auroc:  0.8697916666666667 val_auprc:  0.9335104133658869
EarlyStopping counter: 8 out of 50
epoch:  28
epoch:  29 val_f1:  0.7863487611033193 val_auroc:  0.8643353174603176 val_auprc:  0.9292784028050132
EarlyStopping counter: 9 out of 50
epoch:  29
epoch:  30 val_f1:  0.8054462242562929 val_auroc:  0.8680555555555555 val_auprc:  0.931835063028799
EarlyStopping counter: 10 out of 50
epoch:  30
epoch:  31 val_f1:  0.8054462242562929 val_auroc:  0.8640873015873015 val_auprc:  0.9303344141880019
EarlyStopping counter: 11 out of 50
epoch:  31
epoch:  32 val_f1:  0.8035275913020209 val_auroc:  0.8643353174603174 val_auprc:  0.9311908969934597
EarlyStopping counter: 12 out of 50
epoch:  32
epoch:  33 val_f1:  0.7988956640912072 val_auroc:  0.8678075396825395 val_auprc:  0.9321654031871979
EarlyStopping counter: 13 out of 50
epoch:  33
epoch:  34 val_f1:  0.8194319840387783 val_auroc:  0.873263888888889 val_auprc:  0.9353186997350245
EarlyStopping counter: 14 out of 50
epoch:  34
epoch:  35 val_f1:  0.8072024593763724 val_auroc:  0.8725198412698413 val_auprc:  0.9333895226262414
EarlyStopping counter: 15 out of 50
epoch:  35
epoch:  36 val_f1:  0.800639197204071 val_auroc:  0.8653273809523809 val_auprc:  0.9282956316748364
EarlyStopping counter: 16 out of 50
epoch:  36
epoch:  37 val_f1:  0.7963059879954627 val_auroc:  0.8742559523809523 val_auprc:  0.9360144615790562
EarlyStopping counter: 17 out of 50
epoch:  37
epoch:  38 val_f1:  0.8072024593763724 val_auroc:  0.873015873015873 val_auprc:  0.9327769427349616
EarlyStopping counter: 18 out of 50
epoch:  38
epoch:  39 val_f1:  0.8137922815659323 val_auroc:  0.8668154761904762 val_auprc:  0.9316288248689035
EarlyStopping counter: 19 out of 50
epoch:  39
epoch:  40 val_f1:  0.8137922815659323 val_auroc:  0.871279761904762 val_auprc:  0.9323056703841823
EarlyStopping counter: 20 out of 50
epoch:  40
epoch:  41 val_f1:  0.8102677351291666 val_auroc:  0.8757440476190477 val_auprc:  0.9356164492440249
EarlyStopping counter: 21 out of 50
epoch:  41
epoch:  42 val_f1:  0.8127933585226971 val_auroc:  0.8784722222222222 val_auprc:  0.9383821900578114
EarlyStopping counter: 22 out of 50
epoch:  42
epoch:  43 val_f1:  0.8072024593763724 val_auroc:  0.8772321428571428 val_auprc:  0.9362264059255608
EarlyStopping counter: 23 out of 50
epoch:  43
epoch:  44 val_f1:  0.8120268224096906 val_auroc:  0.8722718253968254 val_auprc:  0.9344252534957864
EarlyStopping counter: 24 out of 50
epoch:  44
epoch:  45 val_f1:  0.8137922815659323 val_auroc:  0.8752480158730159 val_auprc:  0.9351687911703692
EarlyStopping counter: 25 out of 50
epoch:  45
epoch:  46 val_f1:  0.8137922815659323 val_auroc:  0.8715277777777777 val_auprc:  0.9320978552679708
EarlyStopping counter: 26 out of 50
epoch:  46
epoch:  47 val_f1:  0.8036760694501368 val_auroc:  0.8720238095238095 val_auprc:  0.9331427009507812
EarlyStopping counter: 27 out of 50
epoch:  47
epoch:  48 val_f1:  0.800639197204071 val_auroc:  0.877232142857143 val_auprc:  0.9356287445713687
EarlyStopping counter: 28 out of 50
epoch:  48
epoch:  49 val_f1:  0.8167092924126172 val_auroc:  0.8720238095238095 val_auprc:  0.933262354432995
EarlyStopping counter: 29 out of 50
epoch:  49
epoch:  50 val_f1:  0.8137922815659323 val_auroc:  0.8727678571428571 val_auprc:  0.9326200815372769
EarlyStopping counter: 30 out of 50
epoch:  50
epoch:  51 val_f1:  0.8154066640778435 val_auroc:  0.8754960317460317 val_auprc:  0.935253332387843
EarlyStopping counter: 31 out of 50
epoch:  51
epoch:  52 val_f1:  0.8137922815659323 val_auroc:  0.8799603174603174 val_auprc:  0.9378175413794447
EarlyStopping counter: 32 out of 50
epoch:  52
epoch:  53 val_f1:  0.800639197204071 val_auroc:  0.8737599206349207 val_auprc:  0.9349620806757681
EarlyStopping counter: 33 out of 50
epoch:  53
epoch:  54 val_f1:  0.8061683443992288 val_auroc:  0.8752480158730158 val_auprc:  0.9355880330772973
EarlyStopping counter: 34 out of 50
epoch:  54
epoch:  55 val_f1:  0.807228002894545 val_auroc:  0.8767361111111112 val_auprc:  0.9369480503957325
EarlyStopping counter: 35 out of 50
epoch:  55
epoch:  56 val_f1:  0.8102677351291666 val_auroc:  0.8774801587301587 val_auprc:  0.9367625540284242
EarlyStopping counter: 36 out of 50
epoch:  56
epoch:  57 val_f1:  0.8137922815659323 val_auroc:  0.8735119047619048 val_auprc:  0.9338709791396173
EarlyStopping counter: 37 out of 50
epoch:  57
epoch:  58 val_f1:  0.820411899313501 val_auroc:  0.8752480158730159 val_auprc:  0.9358561127597437
EarlyStopping counter: 38 out of 50
epoch:  58
epoch:  59 val_f1:  0.8022296544035674 val_auroc:  0.878968253968254 val_auprc:  0.9375898901679431
EarlyStopping counter: 39 out of 50
epoch:  59
epoch:  60 val_f1:  0.8248625247346153 val_auroc:  0.8804563492063492 val_auprc:  0.938462249290744
EarlyStopping counter: 40 out of 50
epoch:  60
epoch:  61 val_f1:  0.8248625247346153 val_auroc:  0.8804563492063493 val_auprc:  0.937219192469336
EarlyStopping counter: 41 out of 50
epoch:  61
epoch:  62 val_f1:  0.8088065661047027 val_auroc:  0.8764880952380952 val_auprc:  0.9354152724944318
EarlyStopping counter: 42 out of 50
epoch:  62
epoch:  63 val_f1:  0.8102677351291666 val_auroc:  0.8779761904761905 val_auprc:  0.9379752657732076
EarlyStopping counter: 43 out of 50
epoch:  63
epoch:  64 val_f1:  0.8102677351291666 val_auroc:  0.8787202380952381 val_auprc:  0.9379176152395083
EarlyStopping counter: 44 out of 50
epoch:  64
epoch:  65 val_f1:  0.8022296544035674 val_auroc:  0.8779761904761905 val_auprc:  0.9360554895171507
EarlyStopping counter: 45 out of 50
epoch:  65
epoch:  66 val_f1:  0.800639197204071 val_auroc:  0.8824404761904763 val_auprc:  0.9400649676932114
EarlyStopping counter: 46 out of 50
epoch:  66
epoch:  67 val_f1:  0.8072024593763724 val_auroc:  0.8784722222222222 val_auprc:  0.9366895198869657
EarlyStopping counter: 47 out of 50
epoch:  67
epoch:  68 val_f1:  0.8072024593763724 val_auroc:  0.876736111111111 val_auprc:  0.9355421752673897
EarlyStopping counter: 48 out of 50
epoch:  68
epoch:  69 val_f1:  0.8088065661047027 val_auroc:  0.8804563492063492 val_auprc:  0.9388338431593776
EarlyStopping counter: 49 out of 50
epoch:  69
epoch:  70 val_f1:  0.8168793096329329 val_auroc:  0.8819444444444444 val_auprc:  0.9400923912557726
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  479.88320660591125
{'time_elapsed': [479.88320660591125], 'epoch': [69], 'fold': [4], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [0.9999999999999999], 'f1_test': [0.8168793096329329], 'auroc_test': [0.8819444444444444], 'auprc_test': [0.9400923912557726]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 427]           2,048
│    └─Tanh: 2-3                         [64, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 142]           --
│    └─Dropout: 2-5                      [64, 1024, 142]           --
│    └─Flatten: 2-6                      [64, 145408]              --
│    └─Linear: 2-7                       [64, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 121.37
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 447.74
Params size (MB): 0.61
Estimated Total Size (MB): 448.68
==========================================================================================
