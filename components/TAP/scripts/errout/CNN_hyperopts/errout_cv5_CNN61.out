config:  {'project': 'MHCCBM', 'name': 'CNN_61', 'config': {'hidden_channels': [256], 'epochs': 500, 'kernel_size': 5, 'pool_kernel_size': 5, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.5284732449680903 val_auprc:  0.8490500028668606
epoch:  1
epoch:  2 val_f1:  0.2553626929510293 val_auroc:  0.643348060873834 val_auprc:  0.7328357244949177
Validation loss improved to 3.391477
epoch:  2
epoch:  3 val_f1:  0.5858975470226229 val_auroc:  0.6575846833578792 val_auprc:  0.7797474052644475
Validation loss improved to 2.665946
epoch:  3
epoch:  4 val_f1:  0.7325045643526866 val_auroc:  0.7231222385861562 val_auprc:  0.8359592939892222
Validation loss improved to 1.212362
epoch:  4
epoch:  5 val_f1:  0.735514445586388 val_auroc:  0.7781050564555719 val_auprc:  0.8981245495210874
Validation loss improved to 0.596342
epoch:  5
epoch:  6 val_f1:  0.7519437633413868 val_auroc:  0.8095238095238094 val_auprc:  0.9158255228998538
Validation loss improved to 0.475499
epoch:  6
epoch:  7 val_f1:  0.7090514753972222 val_auroc:  0.7920962199312714 val_auprc:  0.8978019560496235
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.7725930260576229 val_auroc:  0.8031418753068238 val_auprc:  0.9068067272102556
EarlyStopping counter: 2 out of 50
epoch:  8
epoch:  9 val_f1:  0.7757738305193033 val_auroc:  0.821060382916053 val_auprc:  0.9226238547797716
EarlyStopping counter: 3 out of 50
epoch:  9
epoch:  10 val_f1:  0.7748426784519089 val_auroc:  0.8087874324987727 val_auprc:  0.9138672337111347
EarlyStopping counter: 4 out of 50
epoch:  10
epoch:  11 val_f1:  0.7661184054361647 val_auroc:  0.802405498281787 val_auprc:  0.9057244668875555
EarlyStopping counter: 5 out of 50
epoch:  11
epoch:  12 val_f1:  0.6958509820496094 val_auroc:  0.8132056946489936 val_auprc:  0.9150570537414497
EarlyStopping counter: 6 out of 50
epoch:  12
epoch:  13 val_f1:  0.7169642564307364 val_auroc:  0.8168875797741777 val_auprc:  0.9184266797188261
EarlyStopping counter: 7 out of 50
epoch:  13
epoch:  14 val_f1:  0.7855581813618873 val_auroc:  0.8087874324987727 val_auprc:  0.9076056189693796
EarlyStopping counter: 8 out of 50
epoch:  14
epoch:  15 val_f1:  0.7697841726618705 val_auroc:  0.8190967108492881 val_auprc:  0.9206589167017054
EarlyStopping counter: 9 out of 50
epoch:  15
epoch:  16 val_f1:  0.7573003855683703 val_auroc:  0.8154148257241042 val_auprc:  0.9147854866180016
EarlyStopping counter: 10 out of 50
epoch:  16
epoch:  17 val_f1:  0.7446505962267806 val_auroc:  0.8227785959744723 val_auprc:  0.9205345786678749
EarlyStopping counter: 11 out of 50
epoch:  17
epoch:  18 val_f1:  0.7712620601193464 val_auroc:  0.8058419243986253 val_auprc:  0.9081261908099596
EarlyStopping counter: 12 out of 50
epoch:  18
epoch:  19 val_f1:  0.7560320485424044 val_auroc:  0.8198330878743251 val_auprc:  0.9194722075365842
EarlyStopping counter: 13 out of 50
epoch:  19
epoch:  20 val_f1:  0.7583300796647482 val_auroc:  0.8286696121747669 val_auprc:  0.9266005837929392
EarlyStopping counter: 14 out of 50
epoch:  20
epoch:  21 val_f1:  0.7639705763479104 val_auroc:  0.8154148257241042 val_auprc:  0.9161277445094314
EarlyStopping counter: 15 out of 50
epoch:  21
epoch:  22 val_f1:  0.7644702419882276 val_auroc:  0.8220422189494355 val_auprc:  0.9213266918591602
EarlyStopping counter: 16 out of 50
epoch:  22
epoch:  23 val_f1:  0.770628190185282 val_auroc:  0.8259695630829652 val_auprc:  0.923193859812595
EarlyStopping counter: 17 out of 50
epoch:  23
epoch:  24 val_f1:  0.7099629667254643 val_auroc:  0.8301423662248405 val_auprc:  0.9273515463422584
EarlyStopping counter: 18 out of 50
epoch:  24
epoch:  25 val_f1:  0.7545102379634754 val_auroc:  0.8107511045655376 val_auprc:  0.9113556095806026
EarlyStopping counter: 19 out of 50
epoch:  25
epoch:  26 val_f1:  0.7307708780682615 val_auroc:  0.8289150711831125 val_auprc:  0.9251626730669642
EarlyStopping counter: 20 out of 50
epoch:  26
epoch:  27 val_f1:  0.7906450372602754 val_auroc:  0.8205694648993618 val_auprc:  0.919485250559142
EarlyStopping counter: 21 out of 50
epoch:  27
epoch:  28 val_f1:  0.7715989981939552 val_auroc:  0.8269513991163475 val_auprc:  0.9244347677232865
EarlyStopping counter: 22 out of 50
epoch:  28
epoch:  29 val_f1:  0.7745465218349855 val_auroc:  0.8215513009327442 val_auprc:  0.9192811438911473
EarlyStopping counter: 23 out of 50
epoch:  29
epoch:  30 val_f1:  0.7307708780682615 val_auroc:  0.8377515954835543 val_auprc:  0.9323930268509156
EarlyStopping counter: 24 out of 50
epoch:  30
epoch:  31 val_f1:  0.7633550302615051 val_auroc:  0.8242513500245459 val_auprc:  0.9237130366478445
EarlyStopping counter: 25 out of 50
epoch:  31
epoch:  32 val_f1:  0.7855164986057286 val_auroc:  0.8149239077074129 val_auprc:  0.9126445523062592
EarlyStopping counter: 26 out of 50
epoch:  32
epoch:  33 val_f1:  0.7715989981939552 val_auroc:  0.8463426607756505 val_auprc:  0.9359331682362906
EarlyStopping counter: 27 out of 50
epoch:  33
epoch:  34 val_f1:  0.7307708780682615 val_auroc:  0.8382425135002455 val_auprc:  0.9316204304238122
EarlyStopping counter: 28 out of 50
epoch:  34
epoch:  35 val_f1:  0.7933255489848959 val_auroc:  0.8107511045655376 val_auprc:  0.9105943843213122
EarlyStopping counter: 29 out of 50
epoch:  35
epoch:  36 val_f1:  0.7727225509205256 val_auroc:  0.812960235640648 val_auprc:  0.9147327549507978
EarlyStopping counter: 30 out of 50
epoch:  36
epoch:  37 val_f1:  0.7911956149366222 val_auroc:  0.8313696612665684 val_auprc:  0.9292200388779274
EarlyStopping counter: 31 out of 50
epoch:  37
epoch:  38 val_f1:  0.7823449348629204 val_auroc:  0.8217967599410898 val_auprc:  0.9192294133122266
EarlyStopping counter: 32 out of 50
epoch:  38
epoch:  39 val_f1:  0.7777125328082551 val_auroc:  0.819833087874325 val_auprc:  0.9181905361501065
EarlyStopping counter: 33 out of 50
epoch:  39
epoch:  40 val_f1:  0.751502327549725 val_auroc:  0.8264604810996564 val_auprc:  0.9245123448193062
EarlyStopping counter: 34 out of 50
epoch:  40
epoch:  41 val_f1:  0.7737843767539161 val_auroc:  0.8279332351497299 val_auprc:  0.9262257336455066
EarlyStopping counter: 35 out of 50
epoch:  41
epoch:  42 val_f1:  0.7920536597238516 val_auroc:  0.8257241040746196 val_auprc:  0.9241753367922753
EarlyStopping counter: 36 out of 50
epoch:  42
epoch:  43 val_f1:  0.778324933635979 val_auroc:  0.8235149729995092 val_auprc:  0.9232354660284867
EarlyStopping counter: 37 out of 50
epoch:  43
epoch:  44 val_f1:  0.777854660092151 val_auroc:  0.8259695630829651 val_auprc:  0.9254762635591466
EarlyStopping counter: 38 out of 50
epoch:  44
epoch:  45 val_f1:  0.7725930260576229 val_auroc:  0.8244968090328916 val_auprc:  0.9243853447869875
EarlyStopping counter: 39 out of 50
epoch:  45
epoch:  46 val_f1:  0.799854302604428 val_auroc:  0.8215513009327442 val_auprc:  0.9195905616692417
EarlyStopping counter: 40 out of 50
epoch:  46
epoch:  47 val_f1:  0.7845295119922345 val_auroc:  0.8286696121747669 val_auprc:  0.9264485715276746
EarlyStopping counter: 41 out of 50
epoch:  47
epoch:  48 val_f1:  0.7809570525397864 val_auroc:  0.8220422189494354 val_auprc:  0.9210290644290787
EarlyStopping counter: 42 out of 50
epoch:  48
epoch:  49 val_f1:  0.7748426784519089 val_auroc:  0.8269513991163476 val_auprc:  0.9256214716361735
EarlyStopping counter: 43 out of 50
epoch:  49
epoch:  50 val_f1:  0.770628190185282 val_auroc:  0.8269513991163476 val_auprc:  0.9250819790672119
EarlyStopping counter: 44 out of 50
epoch:  50
epoch:  51 val_f1:  0.7911956149366222 val_auroc:  0.832351497299951 val_auprc:  0.929385597243839
EarlyStopping counter: 45 out of 50
epoch:  51
epoch:  52 val_f1:  0.7813819697019021 val_auroc:  0.8235149729995092 val_auprc:  0.9214174325796463
EarlyStopping counter: 46 out of 50
epoch:  52
epoch:  53 val_f1:  0.7748426784519089 val_auroc:  0.82793323514973 val_auprc:  0.926081571551261
EarlyStopping counter: 47 out of 50
epoch:  53
epoch:  54 val_f1:  0.7813819697019021 val_auroc:  0.8264604810996564 val_auprc:  0.9248479060319982
EarlyStopping counter: 48 out of 50
epoch:  54
epoch:  55 val_f1:  0.7748426784519089 val_auroc:  0.8244968090328916 val_auprc:  0.9233259229312354
EarlyStopping counter: 49 out of 50
epoch:  55
epoch:  56 val_f1:  0.7748426784519089 val_auroc:  0.8274423171330387 val_auprc:  0.9257920852467132
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  406.840758562088
{'time_elapsed': [406.840758562088], 'epoch': [55], 'fold': [0], 'f1_train': [0.9946078283340751], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7748426784519089], 'auroc_test': [0.8274423171330387], 'auprc_test': [0.9257920852467132]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1278]           1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 1278]           512
│    └─Tanh: 2-3                         [64, 256, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1274]           --
│    └─Dropout: 2-5                      [64, 256, 1274]           --
│    └─Flatten: 2-6                      [64, 326144]              --
│    └─Linear: 2-7                       [64, 1]                   326,145
==========================================================================================
Total params: 328,193
Trainable params: 328,193
Non-trainable params: 0
Total mult-adds (M): 146.54
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.02
Params size (MB): 1.31
Estimated Total Size (MB): 336.66
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5901444900487328 val_auroc:  0.657707412862052 val_auprc:  0.771081922521919
epoch:  1
epoch:  2 val_f1:  0.5812217594345576 val_auroc:  0.6995581737849779 val_auprc:  0.8816169499480224
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6218150089871936 val_auroc:  0.7064310260186549 val_auprc:  0.880821992855958
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.7011215811505187 val_auroc:  0.7439862542955327 val_auprc:  0.89313607405698
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.7633550302615051 val_auroc:  0.8109965635738832 val_auprc:  0.922978188704021
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.72389147505525 val_auroc:  0.8183603338242512 val_auprc:  0.9168120061325693
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.7496568898727172 val_auroc:  0.8213058419243986 val_auprc:  0.9216013600804989
Validation loss improved to 0.261296
epoch:  7
epoch:  8 val_f1:  0.7454557504588546 val_auroc:  0.8080510554737358 val_auprc:  0.9196316340075242
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7376969013024874 val_auroc:  0.814187530682376 val_auprc:  0.921952438116638
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.6810035515891084 val_auroc:  0.8159057437407954 val_auprc:  0.9201554126350513
EarlyStopping counter: 3 out of 50
epoch:  10
epoch:  11 val_f1:  0.7371937993371881 val_auroc:  0.8132056946489936 val_auprc:  0.9173605830191907
EarlyStopping counter: 4 out of 50
epoch:  11
epoch:  12 val_f1:  0.720403844991234 val_auroc:  0.8078055964653903 val_auprc:  0.910512583659914
Validation loss improved to 0.228580
epoch:  12
epoch:  13 val_f1:  0.7868059619290214 val_auroc:  0.818605792832597 val_auprc:  0.9211339967570719
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.6580621620350778 val_auroc:  0.8159057437407953 val_auprc:  0.922338831876088
EarlyStopping counter: 2 out of 50
epoch:  14
epoch:  15 val_f1:  0.6958509820496094 val_auroc:  0.822287677957781 val_auprc:  0.9213551554964792
EarlyStopping counter: 3 out of 50
epoch:  15
epoch:  16 val_f1:  0.6869909576925616 val_auroc:  0.823514972999509 val_auprc:  0.92002889665983
EarlyStopping counter: 4 out of 50
epoch:  16
epoch:  17 val_f1:  0.7580594896895918 val_auroc:  0.822287677957781 val_auprc:  0.920558467962423
EarlyStopping counter: 5 out of 50
epoch:  17
epoch:  18 val_f1:  0.7598715939807772 val_auroc:  0.8208149239077075 val_auprc:  0.91673488945495
EarlyStopping counter: 6 out of 50
epoch:  18
epoch:  19 val_f1:  0.8104294593967373 val_auroc:  0.8284241531664212 val_auprc:  0.9215933640822981
EarlyStopping counter: 7 out of 50
epoch:  19
epoch:  20 val_f1:  0.7944676896257205 val_auroc:  0.8262150220913108 val_auprc:  0.9208098519099666
EarlyStopping counter: 8 out of 50
epoch:  20
epoch:  21 val_f1:  0.7809570525397864 val_auroc:  0.8296514482081493 val_auprc:  0.920955781096955
EarlyStopping counter: 9 out of 50
epoch:  21
epoch:  22 val_f1:  0.81162287691002 val_auroc:  0.8311242022582228 val_auprc:  0.9211653878415892
EarlyStopping counter: 10 out of 50
epoch:  22
epoch:  23 val_f1:  0.726400389202679 val_auroc:  0.8281786941580757 val_auprc:  0.9192357353549799
Validation loss improved to 0.222667
epoch:  23
epoch:  24 val_f1:  0.7841726618705036 val_auroc:  0.8271968581246931 val_auprc:  0.9186735842011118
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7823449348629204 val_auroc:  0.8227785959744723 val_auprc:  0.916211126049957
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.7727225509205256 val_auroc:  0.8271968581246932 val_auprc:  0.9185296887491954
EarlyStopping counter: 3 out of 50
epoch:  26
epoch:  27 val_f1:  0.7873856121514594 val_auroc:  0.8345606283750614 val_auprc:  0.9195040728630861
Validation loss improved to 0.208159
epoch:  27
epoch:  28 val_f1:  0.7598715939807772 val_auroc:  0.8267059401080019 val_auprc:  0.9177835770061558
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.7823449348629204 val_auroc:  0.8306332842415316 val_auprc:  0.9198579876552689
EarlyStopping counter: 2 out of 50
epoch:  29
epoch:  30 val_f1:  0.7890919075230509 val_auroc:  0.8242513500245459 val_auprc:  0.9162386845796244
EarlyStopping counter: 3 out of 50
epoch:  30
epoch:  31 val_f1:  0.7762067639678805 val_auroc:  0.8259695630829652 val_auprc:  0.9187864503511388
EarlyStopping counter: 4 out of 50
epoch:  31
epoch:  32 val_f1:  0.7826417810500232 val_auroc:  0.8247422680412372 val_auprc:  0.9171219975407539
EarlyStopping counter: 5 out of 50
epoch:  32
epoch:  33 val_f1:  0.7920536597238516 val_auroc:  0.8240058910162004 val_auprc:  0.916025349737847
EarlyStopping counter: 6 out of 50
epoch:  33
epoch:  34 val_f1:  0.8010188978004199 val_auroc:  0.825478645066274 val_auprc:  0.9169453536429379
EarlyStopping counter: 7 out of 50
epoch:  34
epoch:  35 val_f1:  0.7622262794246104 val_auroc:  0.8289150711831124 val_auprc:  0.9164799242903003
Validation loss improved to 0.203648
epoch:  35
epoch:  36 val_f1:  0.7510724063582411 val_auroc:  0.8213058419243986 val_auprc:  0.9106723534020471
EarlyStopping counter: 1 out of 50
epoch:  36
epoch:  37 val_f1:  0.7500864926036699 val_auroc:  0.8225331369661267 val_auprc:  0.917419419522399
EarlyStopping counter: 2 out of 50
epoch:  37
epoch:  38 val_f1:  0.7855581813618873 val_auroc:  0.8262150220913108 val_auprc:  0.9179872375127394
EarlyStopping counter: 3 out of 50
epoch:  38
epoch:  39 val_f1:  0.7685409504908388 val_auroc:  0.8262150220913108 val_auprc:  0.9143860087648359
Validation loss improved to 0.189281
epoch:  39
epoch:  40 val_f1:  0.7685409504908388 val_auroc:  0.8281786941580757 val_auprc:  0.9150179908742095
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.757304835743056 val_auroc:  0.8276877761413844 val_auprc:  0.912412525451033
Validation loss improved to 0.184805
epoch:  41
epoch:  42 val_f1:  0.7890919075230509 val_auroc:  0.8215513009327442 val_auprc:  0.9107776468443628
EarlyStopping counter: 1 out of 50
epoch:  42
epoch:  43 val_f1:  0.7920536597238516 val_auroc:  0.8200785468826706 val_auprc:  0.9080075317622044
EarlyStopping counter: 2 out of 50
epoch:  43
epoch:  44 val_f1:  0.7841726618705036 val_auroc:  0.8215513009327442 val_auprc:  0.9112168261150179
EarlyStopping counter: 3 out of 50
epoch:  44
epoch:  45 val_f1:  0.8029873436454202 val_auroc:  0.819833087874325 val_auprc:  0.912545085140464
EarlyStopping counter: 4 out of 50
epoch:  45
epoch:  46 val_f1:  0.7826417810500232 val_auroc:  0.8230240549828178 val_auprc:  0.9095595516750029
EarlyStopping counter: 5 out of 50
epoch:  46
epoch:  47 val_f1:  0.7933255489848959 val_auroc:  0.8220422189494354 val_auprc:  0.9097359194136775
EarlyStopping counter: 6 out of 50
epoch:  47
epoch:  48 val_f1:  0.7971323289800215 val_auroc:  0.8208149239077074 val_auprc:  0.9095941342863997
EarlyStopping counter: 7 out of 50
epoch:  48
epoch:  49 val_f1:  0.7809570525397864 val_auroc:  0.8240058910162004 val_auprc:  0.9115124853046754
EarlyStopping counter: 8 out of 50
epoch:  49
epoch:  50 val_f1:  0.7826417810500232 val_auroc:  0.8217967599410898 val_auprc:  0.9105261501191269
EarlyStopping counter: 9 out of 50
epoch:  50
epoch:  51 val_f1:  0.7826417810500232 val_auroc:  0.8188512518409425 val_auprc:  0.9053153860892245
EarlyStopping counter: 10 out of 50
epoch:  51
epoch:  52 val_f1:  0.7841726618705036 val_auroc:  0.8188512518409425 val_auprc:  0.9071448365534627
EarlyStopping counter: 11 out of 50
epoch:  52
epoch:  53 val_f1:  0.7809570525397864 val_auroc:  0.8193421698576338 val_auprc:  0.9067262494522493
EarlyStopping counter: 12 out of 50
epoch:  53
epoch:  54 val_f1:  0.7536081085870222 val_auroc:  0.8213058419243986 val_auprc:  0.9061642505522631
Validation loss improved to 0.184020
epoch:  54
epoch:  55 val_f1:  0.7707245329923307 val_auroc:  0.8193421698576338 val_auprc:  0.9051514890983585
EarlyStopping counter: 1 out of 50
epoch:  55
epoch:  56 val_f1:  0.7536081085870222 val_auroc:  0.8200785468826706 val_auprc:  0.9036410274844329
Validation loss improved to 0.176770
epoch:  56
epoch:  57 val_f1:  0.7536081085870222 val_auroc:  0.8200785468826706 val_auprc:  0.9061262527336239
EarlyStopping counter: 1 out of 50
epoch:  57
epoch:  58 val_f1:  0.7622262794246104 val_auroc:  0.8193421698576338 val_auprc:  0.9065994928265309
EarlyStopping counter: 2 out of 50
epoch:  58
epoch:  59 val_f1:  0.757304835743056 val_auroc:  0.822287677957781 val_auprc:  0.9063730929659839
Validation loss improved to 0.164680
epoch:  59
epoch:  60 val_f1:  0.7622262794246104 val_auroc:  0.8220422189494355 val_auprc:  0.9079574259284605
EarlyStopping counter: 1 out of 50
epoch:  60
epoch:  61 val_f1:  0.7536081085870222 val_auroc:  0.8205694648993618 val_auprc:  0.9067919108609465
EarlyStopping counter: 2 out of 50
epoch:  61
epoch:  62 val_f1:  0.7707245329923307 val_auroc:  0.8163966617574866 val_auprc:  0.8995135687062615
EarlyStopping counter: 3 out of 50
epoch:  62
epoch:  63 val_f1:  0.7707245329923307 val_auroc:  0.8205694648993619 val_auprc:  0.9046699061334011
EarlyStopping counter: 4 out of 50
epoch:  63
epoch:  64 val_f1:  0.7791090204759269 val_auroc:  0.8178694158075602 val_auprc:  0.9040224835027084
EarlyStopping counter: 5 out of 50
epoch:  64
epoch:  65 val_f1:  0.7622262794246104 val_auroc:  0.8166421207658321 val_auprc:  0.900066920794608
EarlyStopping counter: 6 out of 50
epoch:  65
epoch:  66 val_f1:  0.7448635686045757 val_auroc:  0.817378497790869 val_auprc:  0.8979382473543985
EarlyStopping counter: 7 out of 50
epoch:  66
epoch:  67 val_f1:  0.7622262794246104 val_auroc:  0.819833087874325 val_auprc:  0.9053047940762831
EarlyStopping counter: 8 out of 50
epoch:  67
epoch:  68 val_f1:  0.7873856121514594 val_auroc:  0.8159057437407953 val_auprc:  0.903115941165057
EarlyStopping counter: 9 out of 50
epoch:  68
epoch:  69 val_f1:  0.7791090204759269 val_auroc:  0.8136966126656848 val_auprc:  0.8986949929862392
EarlyStopping counter: 10 out of 50
epoch:  69
epoch:  70 val_f1:  0.7809570525397864 val_auroc:  0.8139420716740305 val_auprc:  0.8990511498994508
EarlyStopping counter: 11 out of 50
epoch:  70
epoch:  71 val_f1:  0.7826417810500232 val_auroc:  0.8161512027491408 val_auprc:  0.9007677146774358
EarlyStopping counter: 12 out of 50
epoch:  71
epoch:  72 val_f1:  0.7791090204759269 val_auroc:  0.8172557682866961 val_auprc:  0.8998763531271494
EarlyStopping counter: 13 out of 50
epoch:  72
epoch:  73 val_f1:  0.7826417810500232 val_auroc:  0.8154148257241041 val_auprc:  0.9000263605811021
EarlyStopping counter: 14 out of 50
epoch:  73
epoch:  74 val_f1:  0.7906450372602754 val_auroc:  0.8156602847324497 val_auprc:  0.9019475475031037
EarlyStopping counter: 15 out of 50
epoch:  74
epoch:  75 val_f1:  0.7890919075230509 val_auroc:  0.8122238586156113 val_auprc:  0.8988983490033622
EarlyStopping counter: 16 out of 50
epoch:  75
epoch:  76 val_f1:  0.7791090204759269 val_auroc:  0.8146784486990672 val_auprc:  0.8974782900019025
EarlyStopping counter: 17 out of 50
epoch:  76
epoch:  77 val_f1:  0.7745465218349855 val_auroc:  0.8143102601865488 val_auprc:  0.8996412698782683
EarlyStopping counter: 18 out of 50
epoch:  77
epoch:  78 val_f1:  0.7707245329923307 val_auroc:  0.8159057437407953 val_auprc:  0.8984875266894188
EarlyStopping counter: 19 out of 50
epoch:  78
epoch:  79 val_f1:  0.7622262794246104 val_auroc:  0.8149239077074129 val_auprc:  0.8941585793129474
EarlyStopping counter: 20 out of 50
epoch:  79
epoch:  80 val_f1:  0.7707245329923307 val_auroc:  0.8138193421698576 val_auprc:  0.8952900772430703
EarlyStopping counter: 21 out of 50
epoch:  80
epoch:  81 val_f1:  0.7826417810500232 val_auroc:  0.81480117820324 val_auprc:  0.898112184086789
EarlyStopping counter: 22 out of 50
epoch:  81
epoch:  82 val_f1:  0.7745465218349855 val_auroc:  0.81480117820324 val_auprc:  0.8984782494574513
EarlyStopping counter: 23 out of 50
epoch:  82
epoch:  83 val_f1:  0.7906450372602754 val_auroc:  0.8114874815905744 val_auprc:  0.8933056075900785
EarlyStopping counter: 24 out of 50
epoch:  83
epoch:  84 val_f1:  0.766354189375772 val_auroc:  0.8139420716740304 val_auprc:  0.8934598993107793
EarlyStopping counter: 25 out of 50
epoch:  84
epoch:  85 val_f1:  0.7809570525397864 val_auroc:  0.8124693176239568 val_auprc:  0.8933956693429547
EarlyStopping counter: 26 out of 50
epoch:  85
epoch:  86 val_f1:  0.7622262794246104 val_auroc:  0.8151693667157585 val_auprc:  0.8938602422735673
EarlyStopping counter: 27 out of 50
epoch:  86
epoch:  87 val_f1:  0.7598715939807772 val_auroc:  0.8143102601865488 val_auprc:  0.8923871051593658
EarlyStopping counter: 28 out of 50
epoch:  87
epoch:  88 val_f1:  0.7727225509205256 val_auroc:  0.8139420716740304 val_auprc:  0.897915587129549
EarlyStopping counter: 29 out of 50
epoch:  88
epoch:  89 val_f1:  0.7809570525397864 val_auroc:  0.8140648011782032 val_auprc:  0.8974943834312502
EarlyStopping counter: 30 out of 50
epoch:  89
epoch:  90 val_f1:  0.7826417810500232 val_auroc:  0.8114874815905744 val_auprc:  0.8954263733932133
EarlyStopping counter: 31 out of 50
epoch:  90
epoch:  91 val_f1:  0.7622262794246104 val_auroc:  0.8113647520864017 val_auprc:  0.8909835752364031
EarlyStopping counter: 32 out of 50
epoch:  91
epoch:  92 val_f1:  0.7643829551743221 val_auroc:  0.813573883161512 val_auprc:  0.8934571462482802
EarlyStopping counter: 33 out of 50
epoch:  92
epoch:  93 val_f1:  0.7727225509205256 val_auroc:  0.8132056946489936 val_auprc:  0.8911642868870133
EarlyStopping counter: 34 out of 50
epoch:  93
epoch:  94 val_f1:  0.7809570525397864 val_auroc:  0.8141875306823761 val_auprc:  0.8966486865083505
EarlyStopping counter: 35 out of 50
epoch:  94
epoch:  95 val_f1:  0.7809570525397864 val_auroc:  0.8145557191948944 val_auprc:  0.8960973333276742
EarlyStopping counter: 36 out of 50
epoch:  95
epoch:  96 val_f1:  0.7791090204759269 val_auroc:  0.8132056946489936 val_auprc:  0.8936371026511107
EarlyStopping counter: 37 out of 50
epoch:  96
epoch:  97 val_f1:  0.7727225509205256 val_auroc:  0.8145557191948943 val_auprc:  0.8956682842846713
EarlyStopping counter: 38 out of 50
epoch:  97
epoch:  98 val_f1:  0.7707245329923307 val_auroc:  0.8130829651448208 val_auprc:  0.8928244200962938
EarlyStopping counter: 39 out of 50
epoch:  98
epoch:  99 val_f1:  0.7622262794246104 val_auroc:  0.8132056946489936 val_auprc:  0.891088791686771
EarlyStopping counter: 40 out of 50
epoch:  99
epoch:  100 val_f1:  0.7707245329923307 val_auroc:  0.8146784486990672 val_auprc:  0.8981609793943905
EarlyStopping counter: 41 out of 50
epoch:  100
epoch:  101 val_f1:  0.7727225509205256 val_auroc:  0.8135738831615121 val_auprc:  0.8955520624108275
EarlyStopping counter: 42 out of 50
epoch:  101
epoch:  102 val_f1:  0.7791090204759269 val_auroc:  0.8118556701030928 val_auprc:  0.889540759111553
EarlyStopping counter: 43 out of 50
epoch:  102
epoch:  103 val_f1:  0.7727225509205256 val_auroc:  0.8127147766323024 val_auprc:  0.8914175820198675
EarlyStopping counter: 44 out of 50
epoch:  103
epoch:  104 val_f1:  0.7745465218349855 val_auroc:  0.8125920471281297 val_auprc:  0.8941581950755195
EarlyStopping counter: 45 out of 50
epoch:  104
epoch:  105 val_f1:  0.7745465218349855 val_auroc:  0.8125920471281296 val_auprc:  0.8924040596959223
EarlyStopping counter: 46 out of 50
epoch:  105
epoch:  106 val_f1:  0.7707245329923307 val_auroc:  0.812346588119784 val_auprc:  0.8943633599627414
EarlyStopping counter: 47 out of 50
epoch:  106
epoch:  107 val_f1:  0.7685409504908388 val_auroc:  0.8127147766323024 val_auprc:  0.8949434551163387
EarlyStopping counter: 48 out of 50
epoch:  107
epoch:  108 val_f1:  0.7727225509205256 val_auroc:  0.8127147766323023 val_auprc:  0.8911543613383248
EarlyStopping counter: 49 out of 50
epoch:  108
epoch:  109 val_f1:  0.7826417810500232 val_auroc:  0.8119783996072656 val_auprc:  0.8912038405950781
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  788.350971698761
{'time_elapsed': [788.350971698761], 'epoch': [108], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7826417810500232], 'auroc_test': [0.8119783996072656], 'auprc_test': [0.8912038405950781]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1278]           1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 1278]           512
│    └─Tanh: 2-3                         [64, 256, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1274]           --
│    └─Dropout: 2-5                      [64, 256, 1274]           --
│    └─Flatten: 2-6                      [64, 326144]              --
│    └─Linear: 2-7                       [64, 1]                   326,145
==========================================================================================
Total params: 328,193
Trainable params: 328,193
Non-trainable params: 0
Total mult-adds (M): 146.54
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.02
Params size (MB): 1.31
Estimated Total Size (MB): 336.66
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.7096701017564327 val_auroc:  0.6631075110456554 val_auprc:  0.7845520970206161
epoch:  1
epoch:  2 val_f1:  0.34917885089921374 val_auroc:  0.6742758959253805 val_auprc:  0.7901122878484704
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.49186549683202907 val_auroc:  0.6929307805596465 val_auprc:  0.8037425723560256
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.4501914672565811 val_auroc:  0.721404025527737 val_auprc:  0.8172048257185788
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6022355762448864 val_auroc:  0.6931762395679922 val_auprc:  0.8029065536636166
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.675161142762091 val_auroc:  0.731958762886598 val_auprc:  0.8535117636672214
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.6538912937446653 val_auroc:  0.7589592538046146 val_auprc:  0.8712273574976406
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.7225455998837295 val_auroc:  0.7655866470299459 val_auprc:  0.8656013365836764
EarlyStopping counter: 7 out of 50
epoch:  8
epoch:  9 val_f1:  0.7030919944895149 val_auroc:  0.7606774668630338 val_auprc:  0.8633027835435558
EarlyStopping counter: 8 out of 50
epoch:  9
epoch:  10 val_f1:  0.7441671543148256 val_auroc:  0.783014236622484 val_auprc:  0.8842870328849242
EarlyStopping counter: 9 out of 50
epoch:  10
epoch:  11 val_f1:  0.7121336235283787 val_auroc:  0.7773686794305351 val_auprc:  0.880591214952713
EarlyStopping counter: 10 out of 50
epoch:  11
epoch:  12 val_f1:  0.7349308245711123 val_auroc:  0.7837506136475209 val_auprc:  0.8835103641256542
EarlyStopping counter: 11 out of 50
epoch:  12
epoch:  13 val_f1:  0.723931698015082 val_auroc:  0.7857142857142857 val_auprc:  0.8865950694236399
EarlyStopping counter: 12 out of 50
epoch:  13
epoch:  14 val_f1:  0.6982612029498659 val_auroc:  0.7862052037309769 val_auprc:  0.8916152707636378
EarlyStopping counter: 13 out of 50
epoch:  14
epoch:  15 val_f1:  0.6889840728573212 val_auroc:  0.7795778105056456 val_auprc:  0.8892202391669317
EarlyStopping counter: 14 out of 50
epoch:  15
epoch:  16 val_f1:  0.7184536707983012 val_auroc:  0.7857142857142857 val_auprc:  0.8920012190697078
EarlyStopping counter: 15 out of 50
epoch:  16
epoch:  17 val_f1:  0.7030919944895149 val_auroc:  0.7714776632302405 val_auprc:  0.8820556596967871
EarlyStopping counter: 16 out of 50
epoch:  17
epoch:  18 val_f1:  0.7163649790827238 val_auroc:  0.7852233676975945 val_auprc:  0.8926920482265048
EarlyStopping counter: 17 out of 50
epoch:  18
epoch:  19 val_f1:  0.6812079455400337 val_auroc:  0.772459499263623 val_auprc:  0.8841327450740161
EarlyStopping counter: 18 out of 50
epoch:  19
epoch:  20 val_f1:  0.7412236216203913 val_auroc:  0.7798232695139911 val_auprc:  0.8907772614569683
EarlyStopping counter: 19 out of 50
epoch:  20
epoch:  21 val_f1:  0.6895771242135116 val_auroc:  0.770004909180167 val_auprc:  0.882310596723763
EarlyStopping counter: 20 out of 50
epoch:  21
epoch:  22 val_f1:  0.726175885795287 val_auroc:  0.7758959253804614 val_auprc:  0.88802752711857
EarlyStopping counter: 21 out of 50
epoch:  22
epoch:  23 val_f1:  0.7024482739389885 val_auroc:  0.7758959253804615 val_auprc:  0.8871842636299208
EarlyStopping counter: 22 out of 50
epoch:  23
epoch:  24 val_f1:  0.7100860488080124 val_auroc:  0.7697594501718212 val_auprc:  0.8840754805984987
EarlyStopping counter: 23 out of 50
epoch:  24
epoch:  25 val_f1:  0.6907263230511482 val_auroc:  0.7741777123220422 val_auprc:  0.8848351767767574
EarlyStopping counter: 24 out of 50
epoch:  25
epoch:  26 val_f1:  0.6952451949622753 val_auroc:  0.7668139420716741 val_auprc:  0.8804227321962601
EarlyStopping counter: 25 out of 50
epoch:  26
epoch:  27 val_f1:  0.7048707252685248 val_auroc:  0.7700049091801668 val_auprc:  0.8802226614529743
EarlyStopping counter: 26 out of 50
epoch:  27
epoch:  28 val_f1:  0.6887363496684735 val_auroc:  0.7577319587628866 val_auprc:  0.8747909791494383
EarlyStopping counter: 27 out of 50
epoch:  28
epoch:  29 val_f1:  0.6863643968546093 val_auroc:  0.7673048600883653 val_auprc:  0.8823024690598809
EarlyStopping counter: 28 out of 50
epoch:  29
epoch:  30 val_f1:  0.713247796930704 val_auroc:  0.7685321551300932 val_auprc:  0.8836944743100819
EarlyStopping counter: 29 out of 50
epoch:  30
epoch:  31 val_f1:  0.7094198370570532 val_auroc:  0.7707412862052037 val_auprc:  0.8803642816253887
EarlyStopping counter: 30 out of 50
epoch:  31
epoch:  32 val_f1:  0.7060068982302729 val_auroc:  0.7663230240549829 val_auprc:  0.8796946565124465
EarlyStopping counter: 31 out of 50
epoch:  32
epoch:  33 val_f1:  0.7030919944895149 val_auroc:  0.7594501718213058 val_auprc:  0.875010714010668
EarlyStopping counter: 32 out of 50
epoch:  33
epoch:  34 val_f1:  0.6967647049253406 val_auroc:  0.764359351988218 val_auprc:  0.8752212177617529
EarlyStopping counter: 33 out of 50
epoch:  34
epoch:  35 val_f1:  0.708480907581627 val_auroc:  0.761904761904762 val_auprc:  0.8762083834101093
EarlyStopping counter: 34 out of 50
epoch:  35
epoch:  36 val_f1:  0.693339873555701 val_auroc:  0.7621502209131075 val_auprc:  0.8748083220659082
EarlyStopping counter: 35 out of 50
epoch:  36
epoch:  37 val_f1:  0.6980913612614702 val_auroc:  0.7520864015709376 val_auprc:  0.8659542612292942
EarlyStopping counter: 36 out of 50
epoch:  37
epoch:  38 val_f1:  0.6951967837494709 val_auroc:  0.7491408934707904 val_auprc:  0.867163491976314
EarlyStopping counter: 37 out of 50
epoch:  38
epoch:  39 val_f1:  0.7048707252685248 val_auroc:  0.7601865488463426 val_auprc:  0.87376452606882
EarlyStopping counter: 38 out of 50
epoch:  39
epoch:  40 val_f1:  0.68520552340289 val_auroc:  0.7653411880216004 val_auprc:  0.8765631005208364
EarlyStopping counter: 39 out of 50
epoch:  40
epoch:  41 val_f1:  0.6967647049253406 val_auroc:  0.7552773686794305 val_auprc:  0.8677825773720803
EarlyStopping counter: 40 out of 50
epoch:  41
epoch:  42 val_f1:  0.703263898025454 val_auroc:  0.7533136966126657 val_auprc:  0.8674456460458099
EarlyStopping counter: 41 out of 50
epoch:  42
epoch:  43 val_f1:  0.6967647049253406 val_auroc:  0.7599410898379971 val_auprc:  0.8708477334697735
EarlyStopping counter: 42 out of 50
epoch:  43
epoch:  44 val_f1:  0.7048707252685248 val_auroc:  0.7648502700049091 val_auprc:  0.8717158897087196
EarlyStopping counter: 43 out of 50
epoch:  44
epoch:  45 val_f1:  0.7115566705387387 val_auroc:  0.7668139420716741 val_auprc:  0.8728669228382033
EarlyStopping counter: 44 out of 50
epoch:  45
epoch:  46 val_f1:  0.7040153975059064 val_auroc:  0.7623956799214532 val_auprc:  0.8709798505059613
EarlyStopping counter: 45 out of 50
epoch:  46
epoch:  47 val_f1:  0.7108600244444511 val_auroc:  0.7641138929798723 val_auprc:  0.8747959152304412
EarlyStopping counter: 46 out of 50
epoch:  47
epoch:  48 val_f1:  0.6810705528674974 val_auroc:  0.751840942562592 val_auprc:  0.86576870787125
EarlyStopping counter: 47 out of 50
epoch:  48
epoch:  49 val_f1:  0.6980913612614702 val_auroc:  0.7525773195876289 val_auprc:  0.8676675098946334
EarlyStopping counter: 48 out of 50
epoch:  49
epoch:  50 val_f1:  0.7140703059967902 val_auroc:  0.7545409916543937 val_auprc:  0.8685766799701307
EarlyStopping counter: 49 out of 50
epoch:  50
epoch:  51 val_f1:  0.726175885795287 val_auroc:  0.7572410407461954 val_auprc:  0.8699438674269314
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  368.6334066390991
{'time_elapsed': [368.6334066390991], 'epoch': [50], 'fold': [2], 'f1_train': [0.9910272898858162], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.726175885795287], 'auroc_test': [0.7572410407461954], 'auprc_test': [0.8699438674269314]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1278]           1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 1278]           512
│    └─Tanh: 2-3                         [64, 256, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1274]           --
│    └─Dropout: 2-5                      [64, 256, 1274]           --
│    └─Flatten: 2-6                      [64, 326144]              --
│    └─Linear: 2-7                       [64, 1]                   326,145
==========================================================================================
Total params: 328,193
Trainable params: 328,193
Non-trainable params: 0
Total mult-adds (M): 146.54
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.02
Params size (MB): 1.31
Estimated Total Size (MB): 336.66
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5057706755611244 val_auroc:  0.6761143410852714 val_auprc:  0.8493567970349756
epoch:  1
epoch:  2 val_f1:  0.6122720870922309 val_auroc:  0.6522529069767442 val_auprc:  0.837990767991128
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6538698473235182 val_auroc:  0.6838662790697674 val_auprc:  0.8449839966025474
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6320053201136571 val_auroc:  0.7165697674418605 val_auprc:  0.8609553502936752
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.7562473143424068 val_auroc:  0.7948158914728682 val_auprc:  0.9072046818241191
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.7139857491996833 val_auroc:  0.8180717054263565 val_auprc:  0.9189085182745343
Validation loss improved to 0.327933
epoch:  6
epoch:  7 val_f1:  0.7553956834532374 val_auroc:  0.8204941860465117 val_auprc:  0.908015937057449
Validation loss improved to 0.298833
epoch:  7
epoch:  8 val_f1:  0.7440073473136385 val_auroc:  0.8335755813953488 val_auprc:  0.9275597430753377
Validation loss improved to 0.195553
epoch:  8
epoch:  9 val_f1:  0.7567507159321089 val_auroc:  0.8304263565891473 val_auprc:  0.9284940293898176
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.7548273393587915 val_auroc:  0.8364825581395349 val_auprc:  0.9303604637897643
Validation loss improved to 0.190597
epoch:  10
epoch:  11 val_f1:  0.7705233871155502 val_auroc:  0.8461724806201549 val_auprc:  0.9331281759125989
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7562299212484351 val_auroc:  0.8398740310077519 val_auprc:  0.9329576298019759
Validation loss improved to 0.173196
epoch:  12
epoch:  13 val_f1:  0.7625825493451395 val_auroc:  0.8384205426356589 val_auprc:  0.9329005794073297
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7695564219015847 val_auroc:  0.8430232558139534 val_auprc:  0.9330838732955216
EarlyStopping counter: 2 out of 50
epoch:  14
epoch:  15 val_f1:  0.7679977157187104 val_auroc:  0.8468992248062015 val_auprc:  0.9360223496995344
Validation loss improved to 0.164144
epoch:  15
epoch:  16 val_f1:  0.7697841726618705 val_auroc:  0.8493217054263565 val_auprc:  0.9380756646146389
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.7628987147360764 val_auroc:  0.8483527131782945 val_auprc:  0.937570977137771
Validation loss improved to 0.156319
epoch:  17
epoch:  18 val_f1:  0.7711885993597467 val_auroc:  0.8502906976744186 val_auprc:  0.9382953052690605
Validation loss improved to 0.154815
epoch:  18
epoch:  19 val_f1:  0.7811109002295425 val_auroc:  0.8553779069767442 val_auprc:  0.9389569358417832
Validation loss improved to 0.152549
epoch:  19
epoch:  20 val_f1:  0.7773759601944114 val_auroc:  0.8563468992248062 val_auprc:  0.941559562742662
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7774211400110681 val_auroc:  0.8638565891472867 val_auprc:  0.9439895430521226
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7578890782445586 val_auroc:  0.8662790697674418 val_auprc:  0.9444603764138906
EarlyStopping counter: 3 out of 50
epoch:  22
epoch:  23 val_f1:  0.7912899626822607 val_auroc:  0.8611918604651163 val_auprc:  0.9440329744423074
Validation loss improved to 0.142454
epoch:  23
epoch:  24 val_f1:  0.776244301724119 val_auroc:  0.8621608527131782 val_auprc:  0.9442848616205488
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7840893588200424 val_auroc:  0.8621608527131783 val_auprc:  0.944410078701162
Validation loss improved to 0.134695
epoch:  25
epoch:  26 val_f1:  0.7827158008497472 val_auroc:  0.8626453488372094 val_auprc:  0.9442935938039426
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7811109002295425 val_auroc:  0.8655523255813954 val_auprc:  0.9449051043813658
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.7647070144847204 val_auroc:  0.8633720930232559 val_auprc:  0.9449204597349548
Validation loss improved to 0.129843
epoch:  28
epoch:  29 val_f1:  0.7735780520043992 val_auroc:  0.8670058139534884 val_auprc:  0.9456624026428411
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.7665182935781787 val_auroc:  0.8648255813953489 val_auprc:  0.9449268335723844
EarlyStopping counter: 2 out of 50
epoch:  30
epoch:  31 val_f1:  0.7851694050563778 val_auroc:  0.8582848837209303 val_auprc:  0.9433173442158158
EarlyStopping counter: 3 out of 50
epoch:  31
epoch:  32 val_f1:  0.7875752415552048 val_auroc:  0.8670058139534883 val_auprc:  0.9464078698007627
EarlyStopping counter: 4 out of 50
epoch:  32
epoch:  33 val_f1:  0.7901923359271766 val_auroc:  0.8624031007751938 val_auprc:  0.9448987181996926
Validation loss improved to 0.123013
epoch:  33
epoch:  34 val_f1:  0.7540304643278981 val_auroc:  0.869670542635659 val_auprc:  0.947742443345492
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.7901923359271766 val_auroc:  0.8694282945736435 val_auprc:  0.9465125975368266
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.764639197732723 val_auroc:  0.8706395348837209 val_auprc:  0.9468166212044297
EarlyStopping counter: 3 out of 50
epoch:  36
epoch:  37 val_f1:  0.7901923359271766 val_auroc:  0.8687015503875969 val_auprc:  0.9472600440400906
Validation loss improved to 0.116673
epoch:  37
epoch:  38 val_f1:  0.7827158008497472 val_auroc:  0.8703972868217054 val_auprc:  0.9477128783134847
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.7952715769842713 val_auroc:  0.8691860465116279 val_auprc:  0.9476115378457872
EarlyStopping counter: 2 out of 50
epoch:  39
epoch:  40 val_f1:  0.8008946034661633 val_auroc:  0.8706395348837209 val_auprc:  0.9475704773912215
EarlyStopping counter: 3 out of 50
epoch:  40
epoch:  41 val_f1:  0.8035187234827523 val_auroc:  0.8694282945736433 val_auprc:  0.9470515813670367
EarlyStopping counter: 4 out of 50
epoch:  41
epoch:  42 val_f1:  0.776244301724119 val_auroc:  0.8728197674418604 val_auprc:  0.9484633171258255
EarlyStopping counter: 5 out of 50
epoch:  42
epoch:  43 val_f1:  0.8084949329130455 val_auroc:  0.876453488372093 val_auprc:  0.9494387568550307
EarlyStopping counter: 6 out of 50
epoch:  43
epoch:  44 val_f1:  0.7906801532257888 val_auroc:  0.876453488372093 val_auprc:  0.9495643894471661
EarlyStopping counter: 7 out of 50
epoch:  44
epoch:  45 val_f1:  0.8041795135320315 val_auroc:  0.8723352713178294 val_auprc:  0.9489388723663756
Validation loss improved to 0.109142
epoch:  45
epoch:  46 val_f1:  0.7516121487046815 val_auroc:  0.8742732558139534 val_auprc:  0.9487022246609822
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.8047401180179452 val_auroc:  0.8696705426356589 val_auprc:  0.9476919749294412
Validation loss improved to 0.106843
epoch:  47
epoch:  48 val_f1:  0.7540304643278981 val_auroc:  0.8745155038759689 val_auprc:  0.947951028269049
EarlyStopping counter: 1 out of 50
epoch:  48
epoch:  49 val_f1:  0.7625825493451395 val_auroc:  0.8689437984496123 val_auprc:  0.9474549728170053
EarlyStopping counter: 2 out of 50
epoch:  49
epoch:  50 val_f1:  0.7974889768226049 val_auroc:  0.8684593023255814 val_auprc:  0.9472450285009073
Validation loss improved to 0.103697
epoch:  50
epoch:  51 val_f1:  0.7952715769842713 val_auroc:  0.8687015503875969 val_auprc:  0.9472248361264428
EarlyStopping counter: 1 out of 50
epoch:  51
epoch:  52 val_f1:  0.7811109002295425 val_auroc:  0.875968992248062 val_auprc:  0.948653130643939
EarlyStopping counter: 2 out of 50
epoch:  52
epoch:  53 val_f1:  0.7710202043822609 val_auroc:  0.8737887596899224 val_auprc:  0.9490328085943082
EarlyStopping counter: 3 out of 50
epoch:  53
epoch:  54 val_f1:  0.7854893118997625 val_auroc:  0.874031007751938 val_auprc:  0.9493182161931968
EarlyStopping counter: 4 out of 50
epoch:  54
epoch:  55 val_f1:  0.7866727894280321 val_auroc:  0.8747577519379844 val_auprc:  0.9492071650452509
EarlyStopping counter: 5 out of 50
epoch:  55
epoch:  56 val_f1:  0.7710202043822609 val_auroc:  0.878391472868217 val_auprc:  0.9504079365229938
EarlyStopping counter: 6 out of 50
epoch:  56
epoch:  57 val_f1:  0.764639197732723 val_auroc:  0.8766957364341086 val_auprc:  0.9498938807706198
EarlyStopping counter: 7 out of 50
epoch:  57
epoch:  58 val_f1:  0.7877294237541244 val_auroc:  0.8788759689922481 val_auprc:  0.9507928977043542
EarlyStopping counter: 8 out of 50
epoch:  58
epoch:  59 val_f1:  0.7603368061152953 val_auroc:  0.8781492248062015 val_auprc:  0.950334371682078
EarlyStopping counter: 9 out of 50
epoch:  59
epoch:  60 val_f1:  0.7906801532257888 val_auroc:  0.8742732558139535 val_auprc:  0.9488115970887496
EarlyStopping counter: 10 out of 50
epoch:  60
epoch:  61 val_f1:  0.792019787311512 val_auroc:  0.8737887596899225 val_auprc:  0.9489553017714825
EarlyStopping counter: 11 out of 50
epoch:  61
epoch:  62 val_f1:  0.792019787311512 val_auroc:  0.8764534883720931 val_auprc:  0.9500324010856829
EarlyStopping counter: 12 out of 50
epoch:  62
epoch:  63 val_f1:  0.792019787311512 val_auroc:  0.8745155038759689 val_auprc:  0.9489689554516052
EarlyStopping counter: 13 out of 50
epoch:  63
epoch:  64 val_f1:  0.7710202043822609 val_auroc:  0.8733042635658915 val_auprc:  0.9488809435156819
EarlyStopping counter: 14 out of 50
epoch:  64
epoch:  65 val_f1:  0.7427571456348435 val_auroc:  0.8783914728682171 val_auprc:  0.9499354412746195
EarlyStopping counter: 15 out of 50
epoch:  65
epoch:  66 val_f1:  0.7841726618705036 val_auroc:  0.874515503875969 val_auprc:  0.9481869461268428
EarlyStopping counter: 16 out of 50
epoch:  66
epoch:  67 val_f1:  0.8041795135320315 val_auroc:  0.8655523255813954 val_auprc:  0.945666887369514
EarlyStopping counter: 17 out of 50
epoch:  67
epoch:  68 val_f1:  0.776244301724119 val_auroc:  0.8725775193798451 val_auprc:  0.9479693678543875
EarlyStopping counter: 18 out of 50
epoch:  68
epoch:  69 val_f1:  0.7489783115038208 val_auroc:  0.8786337209302325 val_auprc:  0.950672699121472
EarlyStopping counter: 19 out of 50
epoch:  69
epoch:  70 val_f1:  0.7427571456348435 val_auroc:  0.8759689922480621 val_auprc:  0.949583665046859
EarlyStopping counter: 20 out of 50
epoch:  70
epoch:  71 val_f1:  0.7801238118631262 val_auroc:  0.8706395348837209 val_auprc:  0.947888985365442
EarlyStopping counter: 21 out of 50
epoch:  71
epoch:  72 val_f1:  0.7961192047225032 val_auroc:  0.8703972868217055 val_auprc:  0.947501745100188
EarlyStopping counter: 22 out of 50
epoch:  72
epoch:  73 val_f1:  0.7952715769842713 val_auroc:  0.8718507751937985 val_auprc:  0.9482660600695281
EarlyStopping counter: 23 out of 50
epoch:  73
epoch:  74 val_f1:  0.7776763243674784 val_auroc:  0.8725775193798448 val_auprc:  0.9473122114631244
EarlyStopping counter: 24 out of 50
epoch:  74
epoch:  75 val_f1:  0.7841726618705036 val_auroc:  0.8696705426356589 val_auprc:  0.9477017154320359
EarlyStopping counter: 25 out of 50
epoch:  75
epoch:  76 val_f1:  0.7710202043822609 val_auroc:  0.873062015503876 val_auprc:  0.9477764568626019
EarlyStopping counter: 26 out of 50
epoch:  76
epoch:  77 val_f1:  0.7710202043822609 val_auroc:  0.8747577519379844 val_auprc:  0.9490844729722552
EarlyStopping counter: 27 out of 50
epoch:  77
epoch:  78 val_f1:  0.7892012988311853 val_auroc:  0.8735465116279071 val_auprc:  0.9486415200731865
EarlyStopping counter: 28 out of 50
epoch:  78
epoch:  79 val_f1:  0.7892012988311853 val_auroc:  0.8733042635658914 val_auprc:  0.9479721767682922
EarlyStopping counter: 29 out of 50
epoch:  79
epoch:  80 val_f1:  0.7972014141264308 val_auroc:  0.8733042635658914 val_auprc:  0.9479380237118996
EarlyStopping counter: 30 out of 50
epoch:  80
epoch:  81 val_f1:  0.7892012988311853 val_auroc:  0.8718507751937985 val_auprc:  0.9476504209984863
EarlyStopping counter: 31 out of 50
epoch:  81
epoch:  82 val_f1:  0.768937708914086 val_auroc:  0.871608527131783 val_auprc:  0.947000630682235
EarlyStopping counter: 32 out of 50
epoch:  82
epoch:  83 val_f1:  0.7892012988311853 val_auroc:  0.872093023255814 val_auprc:  0.9480827910527586
EarlyStopping counter: 33 out of 50
epoch:  83
epoch:  84 val_f1:  0.7892012988311853 val_auroc:  0.8723352713178294 val_auprc:  0.9475275750411155
EarlyStopping counter: 34 out of 50
epoch:  84
epoch:  85 val_f1:  0.7892012988311853 val_auroc:  0.8725775193798451 val_auprc:  0.9479670372385264
EarlyStopping counter: 35 out of 50
epoch:  85
epoch:  86 val_f1:  0.7906801532257888 val_auroc:  0.8716085271317829 val_auprc:  0.9474411666550158
EarlyStopping counter: 36 out of 50
epoch:  86
epoch:  87 val_f1:  0.768937708914086 val_auroc:  0.8716085271317828 val_auprc:  0.9470014970680828
EarlyStopping counter: 37 out of 50
epoch:  87
epoch:  88 val_f1:  0.7811109002295425 val_auroc:  0.8723352713178295 val_auprc:  0.9477463274121642
EarlyStopping counter: 38 out of 50
epoch:  88
epoch:  89 val_f1:  0.7827158008497472 val_auroc:  0.8694282945736433 val_auprc:  0.9465372395570761
EarlyStopping counter: 39 out of 50
epoch:  89
epoch:  90 val_f1:  0.7562473143424068 val_auroc:  0.8706395348837209 val_auprc:  0.946870379314965
EarlyStopping counter: 40 out of 50
epoch:  90
epoch:  91 val_f1:  0.7841726618705036 val_auroc:  0.8699127906976745 val_auprc:  0.9467917323281452
EarlyStopping counter: 41 out of 50
epoch:  91
epoch:  92 val_f1:  0.776244301724119 val_auroc:  0.87015503875969 val_auprc:  0.9465325811883876
EarlyStopping counter: 42 out of 50
epoch:  92
epoch:  93 val_f1:  0.7827158008497472 val_auroc:  0.8718507751937984 val_auprc:  0.947457427958176
EarlyStopping counter: 43 out of 50
epoch:  93
epoch:  94 val_f1:  0.7841726618705036 val_auroc:  0.8708817829457365 val_auprc:  0.9471366274957365
EarlyStopping counter: 44 out of 50
epoch:  94
epoch:  95 val_f1:  0.7841726618705036 val_auroc:  0.8728197674418605 val_auprc:  0.9477393375211416
EarlyStopping counter: 45 out of 50
epoch:  95
epoch:  96 val_f1:  0.7892012988311853 val_auroc:  0.8742732558139534 val_auprc:  0.9481592350809072
EarlyStopping counter: 46 out of 50
epoch:  96
epoch:  97 val_f1:  0.7827158008497472 val_auroc:  0.872093023255814 val_auprc:  0.947069135949983
EarlyStopping counter: 47 out of 50
epoch:  97
epoch:  98 val_f1:  0.7811109002295425 val_auroc:  0.872093023255814 val_auprc:  0.9473546473431267
EarlyStopping counter: 48 out of 50
epoch:  98
epoch:  99 val_f1:  0.7906801532257888 val_auroc:  0.8723352713178294 val_auprc:  0.947569927097651
EarlyStopping counter: 49 out of 50
epoch:  99
epoch:  100 val_f1:  0.7811109002295425 val_auroc:  0.8713662790697674 val_auprc:  0.9470755554949459
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  720.3619339466095
{'time_elapsed': [720.3619339466095], 'epoch': [99], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7811109002295425], 'auroc_test': [0.8713662790697674], 'auprc_test': [0.9470755554949459]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1278]           1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 1278]           512
│    └─Tanh: 2-3                         [64, 256, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1274]           --
│    └─Dropout: 2-5                      [64, 256, 1274]           --
│    └─Flatten: 2-6                      [64, 326144]              --
│    └─Linear: 2-7                       [64, 1]                   326,145
==========================================================================================
Total params: 328,193
Trainable params: 328,193
Non-trainable params: 0
Total mult-adds (M): 146.54
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.02
Params size (MB): 1.31
Estimated Total Size (MB): 336.66
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5707915273132664 val_auroc:  0.5301339285714286 val_auprc:  0.8270668440655575
epoch:  1
epoch:  2 val_f1:  0.20827792512633067 val_auroc:  0.7333829365079365 val_auprc:  0.8060708113588324
Validation loss improved to 2.163673
epoch:  2
epoch:  3 val_f1:  0.5126811594202898 val_auroc:  0.7703373015873016 val_auprc:  0.8651597395173106
Validation loss improved to 1.218565
epoch:  3
epoch:  4 val_f1:  0.7874834274643012 val_auroc:  0.8358134920634921 val_auprc:  0.9082583529755835
Validation loss improved to 0.339266
epoch:  4
epoch:  5 val_f1:  0.7130929947870102 val_auroc:  0.8487103174603173 val_auprc:  0.9288642109756706
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.7988956640912072 val_auroc:  0.875 val_auprc:  0.9410064259514335
Validation loss improved to 0.175867
epoch:  6
epoch:  7 val_f1:  0.7837457330597287 val_auroc:  0.8807043650793651 val_auprc:  0.9411005220751971
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.770099160945843 val_auroc:  0.8814484126984127 val_auprc:  0.9412096782830308
EarlyStopping counter: 2 out of 50
epoch:  8
epoch:  9 val_f1:  0.7703937955759801 val_auroc:  0.8846726190476191 val_auprc:  0.9448276565741421
EarlyStopping counter: 3 out of 50
epoch:  9
epoch:  10 val_f1:  0.7634458783751606 val_auroc:  0.886904761904762 val_auprc:  0.9424789581441531
EarlyStopping counter: 4 out of 50
epoch:  10
epoch:  11 val_f1:  0.7895875497243353 val_auroc:  0.8712797619047619 val_auprc:  0.9336045742283717
EarlyStopping counter: 5 out of 50
epoch:  11
epoch:  12 val_f1:  0.8081713820844254 val_auroc:  0.8707837301587301 val_auprc:  0.9334410503872757
EarlyStopping counter: 6 out of 50
epoch:  12
epoch:  13 val_f1:  0.8041106719367591 val_auroc:  0.8802083333333334 val_auprc:  0.9386897181155887
EarlyStopping counter: 7 out of 50
epoch:  13
epoch:  14 val_f1:  0.8023197893688181 val_auroc:  0.8695436507936508 val_auprc:  0.9326733680483317
EarlyStopping counter: 8 out of 50
epoch:  14
epoch:  15 val_f1:  0.79396185483142 val_auroc:  0.8628472222222223 val_auprc:  0.9278485758979073
EarlyStopping counter: 9 out of 50
epoch:  15
epoch:  16 val_f1:  0.7797158172381521 val_auroc:  0.8640873015873016 val_auprc:  0.9293426176446324
EarlyStopping counter: 10 out of 50
epoch:  16
epoch:  17 val_f1:  0.8032253958002789 val_auroc:  0.8529265873015873 val_auprc:  0.9175254948198847
EarlyStopping counter: 11 out of 50
epoch:  17
epoch:  18 val_f1:  0.7940993788819876 val_auroc:  0.8606150793650793 val_auprc:  0.924679626045324
EarlyStopping counter: 12 out of 50
epoch:  18
epoch:  19 val_f1:  0.8005921770297647 val_auroc:  0.8630952380952381 val_auprc:  0.9249837719182121
EarlyStopping counter: 13 out of 50
epoch:  19
epoch:  20 val_f1:  0.7995542847531747 val_auroc:  0.8660714285714286 val_auprc:  0.9293225879352887
EarlyStopping counter: 14 out of 50
epoch:  20
epoch:  21 val_f1:  0.8081713820844254 val_auroc:  0.8655753968253969 val_auprc:  0.9259232796575194
EarlyStopping counter: 15 out of 50
epoch:  21
epoch:  22 val_f1:  0.7819511139952413 val_auroc:  0.8591269841269842 val_auprc:  0.9207981192951507
EarlyStopping counter: 16 out of 50
epoch:  22
epoch:  23 val_f1:  0.8036760694501368 val_auroc:  0.8603670634920636 val_auprc:  0.9221617698553485
EarlyStopping counter: 17 out of 50
epoch:  23
epoch:  24 val_f1:  0.7775412992804297 val_auroc:  0.8638392857142857 val_auprc:  0.9240855713225827
EarlyStopping counter: 18 out of 50
epoch:  24
epoch:  25 val_f1:  0.8115942028985508 val_auroc:  0.8673115079365078 val_auprc:  0.9267740478764459
EarlyStopping counter: 19 out of 50
epoch:  25
epoch:  26 val_f1:  0.8115942028985508 val_auroc:  0.8690476190476191 val_auprc:  0.9276251195074141
EarlyStopping counter: 20 out of 50
epoch:  26
epoch:  27 val_f1:  0.7995542847531747 val_auroc:  0.8650793650793651 val_auprc:  0.9263803189918753
EarlyStopping counter: 21 out of 50
epoch:  27
epoch:  28 val_f1:  0.7971014492753623 val_auroc:  0.8625992063492063 val_auprc:  0.922244619926686
EarlyStopping counter: 22 out of 50
epoch:  28
epoch:  29 val_f1:  0.7858717303302986 val_auroc:  0.8618551587301587 val_auprc:  0.9223196789915011
EarlyStopping counter: 23 out of 50
epoch:  29
epoch:  30 val_f1:  0.7819511139952413 val_auroc:  0.8571428571428571 val_auprc:  0.9136339651980059
EarlyStopping counter: 24 out of 50
epoch:  30
epoch:  31 val_f1:  0.7949078298424175 val_auroc:  0.8606150793650794 val_auprc:  0.9176278182916777
EarlyStopping counter: 25 out of 50
epoch:  31
epoch:  32 val_f1:  0.7949078298424175 val_auroc:  0.8593749999999999 val_auprc:  0.9160233427791205
EarlyStopping counter: 26 out of 50
epoch:  32
epoch:  33 val_f1:  0.7839990466164816 val_auroc:  0.8670634920634921 val_auprc:  0.922839863863238
EarlyStopping counter: 27 out of 50
epoch:  33
epoch:  34 val_f1:  0.822380909337431 val_auroc:  0.8722718253968255 val_auprc:  0.9293903121608209
EarlyStopping counter: 28 out of 50
epoch:  34
epoch:  35 val_f1:  0.8036760694501368 val_auroc:  0.8611111111111112 val_auprc:  0.9188063939660691
EarlyStopping counter: 29 out of 50
epoch:  35
epoch:  36 val_f1:  0.7884143290944841 val_auroc:  0.8566468253968254 val_auprc:  0.9060247243463262
EarlyStopping counter: 30 out of 50
epoch:  36
epoch:  37 val_f1:  0.7819511139952413 val_auroc:  0.8625992063492063 val_auprc:  0.9120868294653204
EarlyStopping counter: 31 out of 50
epoch:  37
epoch:  38 val_f1:  0.7904805491990847 val_auroc:  0.8606150793650793 val_auprc:  0.9094851509624047
EarlyStopping counter: 32 out of 50
epoch:  38
epoch:  39 val_f1:  0.7858717303302986 val_auroc:  0.8663194444444445 val_auprc:  0.9178865640575649
EarlyStopping counter: 33 out of 50
epoch:  39
epoch:  40 val_f1:  0.7858717303302986 val_auroc:  0.8675595238095238 val_auprc:  0.9214437599380759
EarlyStopping counter: 34 out of 50
epoch:  40
epoch:  41 val_f1:  0.7839990466164816 val_auroc:  0.8613591269841269 val_auprc:  0.9087569094244172
EarlyStopping counter: 35 out of 50
epoch:  41
epoch:  42 val_f1:  0.792371879328401 val_auroc:  0.8687996031746033 val_auprc:  0.922198693022821
EarlyStopping counter: 36 out of 50
epoch:  42
epoch:  43 val_f1:  0.7839990466164816 val_auroc:  0.8690476190476191 val_auprc:  0.9240406313884686
EarlyStopping counter: 37 out of 50
epoch:  43
epoch:  44 val_f1:  0.8036760694501368 val_auroc:  0.8660714285714285 val_auprc:  0.9166952101544217
EarlyStopping counter: 38 out of 50
epoch:  44
epoch:  45 val_f1:  0.792371879328401 val_auroc:  0.8660714285714285 val_auprc:  0.9165434328885951
EarlyStopping counter: 39 out of 50
epoch:  45
epoch:  46 val_f1:  0.7755148741418765 val_auroc:  0.8629712301587302 val_auprc:  0.9080091472531637
EarlyStopping counter: 40 out of 50
epoch:  46
epoch:  47 val_f1:  0.7949078298424175 val_auroc:  0.8603670634920635 val_auprc:  0.9087988329715475
EarlyStopping counter: 41 out of 50
epoch:  47
epoch:  48 val_f1:  0.7949078298424175 val_auroc:  0.8566468253968254 val_auprc:  0.9026036829673147
EarlyStopping counter: 42 out of 50
epoch:  48
epoch:  49 val_f1:  0.7775412992804297 val_auroc:  0.8635912698412699 val_auprc:  0.9105072863132065
EarlyStopping counter: 43 out of 50
epoch:  49
epoch:  50 val_f1:  0.7884143290944841 val_auroc:  0.8625992063492064 val_auprc:  0.9097050950736493
EarlyStopping counter: 44 out of 50
epoch:  50
epoch:  51 val_f1:  0.7884143290944841 val_auroc:  0.865327380952381 val_auprc:  0.915010599625078
EarlyStopping counter: 45 out of 50
epoch:  51
epoch:  52 val_f1:  0.8260869565217391 val_auroc:  0.8663194444444445 val_auprc:  0.9175634108931041
EarlyStopping counter: 46 out of 50
epoch:  52
epoch:  53 val_f1:  0.8260869565217391 val_auroc:  0.863343253968254 val_auprc:  0.9138838694148506
EarlyStopping counter: 47 out of 50
epoch:  53
epoch:  54 val_f1:  0.8127933585226971 val_auroc:  0.8635912698412698 val_auprc:  0.9155133345272297
EarlyStopping counter: 48 out of 50
epoch:  54
epoch:  55 val_f1:  0.8260869565217391 val_auroc:  0.8648313492063491 val_auprc:  0.9218510772210833
EarlyStopping counter: 49 out of 50
epoch:  55
epoch:  56 val_f1:  0.8102677351291666 val_auroc:  0.8673115079365079 val_auprc:  0.9176956964071775
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  402.8647656440735
{'time_elapsed': [402.8647656440735], 'epoch': [55], 'fold': [4], 'f1_train': [0.9946175537860844], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8102677351291666], 'auroc_test': [0.8673115079365079], 'auprc_test': [0.9176956964071775]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 1278]           1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 1278]           512
│    └─Tanh: 2-3                         [64, 256, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 256, 1274]           --
│    └─Dropout: 2-5                      [64, 256, 1274]           --
│    └─Flatten: 2-6                      [64, 326144]              --
│    └─Linear: 2-7                       [64, 1]                   326,145
==========================================================================================
Total params: 328,193
Trainable params: 328,193
Non-trainable params: 0
Total mult-adds (M): 146.54
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 335.02
Params size (MB): 1.31
Estimated Total Size (MB): 336.66
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_61', 'config': {'hidden_channels': [256], 'epochs': 500, 'kernel_size': 5, 'pool_kernel_size': 5, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.6728031418753069 val_auprc:  0.8063584250299642
epoch:  1
epoch:  2 val_f1:  0.6636982464578685 val_auroc:  0.5989199803632793 val_auprc:  0.7347245500757772
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.4920115468426625 val_auroc:  0.6357388316151202 val_auprc:  0.7587352238844716
Validation loss improved to 1.272768
epoch:  3
epoch:  4 val_f1:  0.634119352484352 val_auroc:  0.6372115856651939 val_auprc:  0.7637640201465643
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.5985139007438117 val_auroc:  0.6791850760922926 val_auprc:  0.8077813447314067
Validation loss improved to 1.248741
epoch:  5
epoch:  6 val_f1:  0.6334005896095354 val_auroc:  0.7052037309769269 val_auprc:  0.8365563546722175
Validation loss improved to 1.222924
epoch:  6
epoch:  7 val_f1:  0.6916890169640421 val_auroc:  0.7199312714776632 val_auprc:  0.8490886730799612
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.5979348628901833 val_auroc:  0.7464408443789887 val_auprc:  0.8660137542362056
Validation loss improved to 1.167479
epoch:  8
epoch:  9 val_f1:  0.7148475178521729 val_auroc:  0.7407952871870398 val_auprc:  0.8619217374321526
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.6213039568345323 val_auroc:  0.7675503190967109 val_auprc:  0.8809752939845716
Validation loss improved to 1.138081
epoch:  10
epoch:  11 val_f1:  0.7309103647707891 val_auroc:  0.7567501227295041 val_auprc:  0.8742344583101413
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.6459565936764723 val_auroc:  0.7739322533136966 val_auprc:  0.8860648602173333
Validation loss improved to 1.115717
epoch:  12
epoch:  13 val_f1:  0.6894622188638474 val_auroc:  0.7746686303387335 val_auprc:  0.8875413498686393
Validation loss improved to 1.115505
epoch:  13
epoch:  14 val_f1:  0.7466980132583976 val_auroc:  0.7677957781050565 val_auprc:  0.8841446651392766
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.7233618940391454 val_auroc:  0.7771232204221895 val_auprc:  0.8908789005226949
Validation loss improved to 1.106850
epoch:  15
epoch:  16 val_f1:  0.7233618940391454 val_auroc:  0.7758959253804615 val_auprc:  0.890825323872872
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.6963248678165901 val_auroc:  0.7832596956308298 val_auprc:  0.8966060705805755
Validation loss improved to 1.088217
epoch:  17
epoch:  18 val_f1:  0.7560320485424044 val_auroc:  0.783750613647521 val_auprc:  0.8974382188175645
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7560320485424044 val_auroc:  0.7859597447226314 val_auprc:  0.8990921864315699
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7428255465713769 val_auroc:  0.7889052528227786 val_auprc:  0.9009896889605313
EarlyStopping counter: 3 out of 50
epoch:  20
epoch:  21 val_f1:  0.6963248678165901 val_auroc:  0.7947962690230732 val_auprc:  0.9063932549569247
Validation loss improved to 1.066919
epoch:  21
epoch:  22 val_f1:  0.7560320485424044 val_auroc:  0.7992145311732941 val_auprc:  0.9102609041381045
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.6682010713268466 val_auroc:  0.8051055473735885 val_auprc:  0.9147790886387508
Validation loss improved to 1.052160
epoch:  23
epoch:  24 val_f1:  0.7494347379239465 val_auroc:  0.8006872852233677 val_auprc:  0.9115148408098271
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7098736982331642 val_auroc:  0.803632793323515 val_auprc:  0.912892930379879
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.7494347379239465 val_auroc:  0.7997054491899854 val_auprc:  0.9107881740742046
EarlyStopping counter: 3 out of 50
epoch:  26
epoch:  27 val_f1:  0.7229061670449737 val_auroc:  0.8078055964653903 val_auprc:  0.9161489072986834
EarlyStopping counter: 4 out of 50
epoch:  27
epoch:  28 val_f1:  0.7098736982331642 val_auroc:  0.8114874815905745 val_auprc:  0.9183033292275582
EarlyStopping counter: 5 out of 50
epoch:  28
epoch:  29 val_f1:  0.7494347379239465 val_auroc:  0.8132056946489936 val_auprc:  0.9195976885818533
EarlyStopping counter: 6 out of 50
epoch:  29
epoch:  30 val_f1:  0.7560320485424044 val_auroc:  0.8132056946489936 val_auprc:  0.9193847193914888
EarlyStopping counter: 7 out of 50
epoch:  30
epoch:  31 val_f1:  0.6743799189283424 val_auroc:  0.8195876288659794 val_auprc:  0.9232216946150092
EarlyStopping counter: 8 out of 50
epoch:  31
epoch:  32 val_f1:  0.7362024088594293 val_auroc:  0.8163966617574865 val_auprc:  0.9215026832832586
EarlyStopping counter: 9 out of 50
epoch:  32
epoch:  33 val_f1:  0.7672775806504117 val_auroc:  0.8149239077074129 val_auprc:  0.9201005061583467
EarlyStopping counter: 10 out of 50
epoch:  33
epoch:  34 val_f1:  0.7626195746699344 val_auroc:  0.8188512518409425 val_auprc:  0.9232220691438147
EarlyStopping counter: 11 out of 50
epoch:  34
epoch:  35 val_f1:  0.7494347379239465 val_auroc:  0.8183603338242513 val_auprc:  0.9227101670554663
EarlyStopping counter: 12 out of 50
epoch:  35
epoch:  36 val_f1:  0.7428255465713769 val_auroc:  0.8203240058910162 val_auprc:  0.923878638890913
EarlyStopping counter: 13 out of 50
epoch:  36
epoch:  37 val_f1:  0.7672775806504117 val_auroc:  0.8139420716740304 val_auprc:  0.9200295824968258
EarlyStopping counter: 14 out of 50
epoch:  37
epoch:  38 val_f1:  0.702570289683208 val_auroc:  0.8242513500245459 val_auprc:  0.9264680895140754
EarlyStopping counter: 15 out of 50
epoch:  38
epoch:  39 val_f1:  0.7239714721729109 val_auroc:  0.8247422680412372 val_auprc:  0.9262363007491266
EarlyStopping counter: 16 out of 50
epoch:  39
epoch:  40 val_f1:  0.7648187281552264 val_auroc:  0.8181148748159057 val_auprc:  0.9217109866890526
EarlyStopping counter: 17 out of 50
epoch:  40
epoch:  41 val_f1:  0.7560320485424044 val_auroc:  0.8240058910162003 val_auprc:  0.9258989260000008
EarlyStopping counter: 18 out of 50
epoch:  41
epoch:  42 val_f1:  0.7552115339652351 val_auroc:  0.8210603829160531 val_auprc:  0.924041390863886
EarlyStopping counter: 19 out of 50
epoch:  42
epoch:  43 val_f1:  0.7552115339652351 val_auroc:  0.8163966617574865 val_auprc:  0.9210425029228579
EarlyStopping counter: 20 out of 50
epoch:  43
epoch:  44 val_f1:  0.7661184054361647 val_auroc:  0.8217967599410898 val_auprc:  0.9238758664455002
EarlyStopping counter: 21 out of 50
epoch:  44
epoch:  45 val_f1:  0.7412236216203913 val_auroc:  0.8210603829160531 val_auprc:  0.9236752667736274
EarlyStopping counter: 22 out of 50
epoch:  45
epoch:  46 val_f1:  0.7442757932382417 val_auroc:  0.8281786941580755 val_auprc:  0.9279384895087563
EarlyStopping counter: 23 out of 50
epoch:  46
epoch:  47 val_f1:  0.7725930260576229 val_auroc:  0.8244968090328915 val_auprc:  0.9257479655629018
EarlyStopping counter: 24 out of 50
epoch:  47
epoch:  48 val_f1:  0.7596459003010357 val_auroc:  0.8247422680412372 val_auprc:  0.9256436546936829
EarlyStopping counter: 25 out of 50
epoch:  48
epoch:  49 val_f1:  0.7510257046352308 val_auroc:  0.8271968581246932 val_auprc:  0.9275885437226945
EarlyStopping counter: 26 out of 50
epoch:  49
epoch:  50 val_f1:  0.7442757932382417 val_auroc:  0.8279332351497299 val_auprc:  0.9280509359221134
EarlyStopping counter: 27 out of 50
epoch:  50
epoch:  51 val_f1:  0.7490302789770621 val_auroc:  0.8232695139911635 val_auprc:  0.9248863572044773
EarlyStopping counter: 28 out of 50
epoch:  51
epoch:  52 val_f1:  0.7607703458551531 val_auroc:  0.8257241040746196 val_auprc:  0.9253441106209229
EarlyStopping counter: 29 out of 50
epoch:  52
epoch:  53 val_f1:  0.7765831291011147 val_auroc:  0.8259695630829651 val_auprc:  0.9254844286618081
EarlyStopping counter: 30 out of 50
epoch:  53
epoch:  54 val_f1:  0.7699730743399811 val_auroc:  0.8264604810996564 val_auprc:  0.9264488421555791
EarlyStopping counter: 31 out of 50
epoch:  54
epoch:  55 val_f1:  0.7765831291011147 val_auroc:  0.8257241040746196 val_auprc:  0.9261471476849978
EarlyStopping counter: 32 out of 50
epoch:  55
epoch:  56 val_f1:  0.7490302789770621 val_auroc:  0.8213058419243986 val_auprc:  0.9232756582300743
EarlyStopping counter: 33 out of 50
epoch:  56
epoch:  57 val_f1:  0.7683026725960121 val_auroc:  0.8252331860579284 val_auprc:  0.925786495115006
EarlyStopping counter: 34 out of 50
epoch:  57
epoch:  58 val_f1:  0.7519437633413868 val_auroc:  0.8252331860579284 val_auprc:  0.9257002887583449
EarlyStopping counter: 35 out of 50
epoch:  58
epoch:  59 val_f1:  0.7711689349644636 val_auroc:  0.8301423662248404 val_auprc:  0.9293659582292289
EarlyStopping counter: 36 out of 50
epoch:  59
epoch:  60 val_f1:  0.7553956834532374 val_auroc:  0.819833087874325 val_auprc:  0.9221426729911415
EarlyStopping counter: 37 out of 50
epoch:  60
epoch:  61 val_f1:  0.7672775806504117 val_auroc:  0.825478645066274 val_auprc:  0.9254598313993756
EarlyStopping counter: 38 out of 50
epoch:  61
epoch:  62 val_f1:  0.777854660092151 val_auroc:  0.8286696121747669 val_auprc:  0.9279074866917977
EarlyStopping counter: 39 out of 50
epoch:  62
epoch:  63 val_f1:  0.7617596949267598 val_auroc:  0.8281786941580755 val_auprc:  0.9279206784670834
EarlyStopping counter: 40 out of 50
epoch:  63
epoch:  64 val_f1:  0.7839141001375581 val_auroc:  0.8267059401080019 val_auprc:  0.9273496933926255
EarlyStopping counter: 41 out of 50
epoch:  64
epoch:  65 val_f1:  0.7839141001375581 val_auroc:  0.8281786941580758 val_auprc:  0.9281250093959694
EarlyStopping counter: 42 out of 50
epoch:  65
epoch:  66 val_f1:  0.7697841726618705 val_auroc:  0.8193421698576338 val_auprc:  0.9219919824828784
EarlyStopping counter: 43 out of 50
epoch:  66
epoch:  67 val_f1:  0.7683026725960121 val_auroc:  0.8259695630829651 val_auprc:  0.9264389047669107
EarlyStopping counter: 44 out of 50
epoch:  67
epoch:  68 val_f1:  0.7441671543148256 val_auroc:  0.8230240549828179 val_auprc:  0.9244327135159496
EarlyStopping counter: 45 out of 50
epoch:  68
epoch:  69 val_f1:  0.743396428458658 val_auroc:  0.8149239077074129 val_auprc:  0.9193981111691023
EarlyStopping counter: 46 out of 50
epoch:  69
epoch:  70 val_f1:  0.777854660092151 val_auroc:  0.8279332351497299 val_auprc:  0.9277458068609596
EarlyStopping counter: 47 out of 50
epoch:  70
epoch:  71 val_f1:  0.7441671543148256 val_auroc:  0.8247422680412372 val_auprc:  0.9254713216603342
EarlyStopping counter: 48 out of 50
epoch:  71
epoch:  72 val_f1:  0.7531731915989216 val_auroc:  0.8254786450662739 val_auprc:  0.9254128724133213
EarlyStopping counter: 49 out of 50
epoch:  72
epoch:  73 val_f1:  0.7911956149366222 val_auroc:  0.8269513991163475 val_auprc:  0.9265293689666603
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  62.99445199966431
{'time_elapsed': [62.99445199966431], 'epoch': [72], 'fold': [0], 'f1_train': [0.9592424314665234], 'auroc_train': [0.9995707759757182], 'auprc_train': [0.9998110700421436], 'f1_test': [0.7911956149366222], 'auroc_test': [0.8269513991163475], 'auprc_test': [0.9265293689666603]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 256]            1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 256]            512
│    └─Tanh: 2-3                         [64, 256, 256]            --
│    └─MaxPool1d: 2-4                    [64, 256, 51]             --
│    └─Dropout: 2-5                      [64, 256, 51]             --
│    └─Flatten: 2-6                      [64, 13056]               --
│    └─Linear: 2-7                       [64, 1]                   13,057
==========================================================================================
Total params: 15,105
Trainable params: 15,105
Non-trainable params: 0
Total mult-adds (M): 26.03
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 67.11
Params size (MB): 0.06
Estimated Total Size (MB): 67.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.41806291437438287 val_auroc:  0.6804123711340205 val_auprc:  0.7904775945353668
epoch:  1
epoch:  2 val_f1:  0.6892815309975336 val_auroc:  0.7061855670103093 val_auprc:  0.8825596375870643
Validation loss improved to 1.170667
epoch:  2
epoch:  3 val_f1:  0.5784289800181565 val_auroc:  0.7118311242022584 val_auprc:  0.8875558826940129
Validation loss improved to 1.152599
epoch:  3
epoch:  4 val_f1:  0.6806660738824671 val_auroc:  0.7187039764359352 val_auprc:  0.8918333833963119
Validation loss improved to 1.145583
epoch:  4
epoch:  5 val_f1:  0.6928018025140328 val_auroc:  0.7353951890034364 val_auprc:  0.8984916180173965
Validation loss improved to 1.112310
epoch:  5
epoch:  6 val_f1:  0.7032425848040964 val_auroc:  0.7459499263622975 val_auprc:  0.903600924068846
Validation loss improved to 1.097097
epoch:  6
epoch:  7 val_f1:  0.751502327549725 val_auroc:  0.7646048109965635 val_auprc:  0.910069948671541
Validation loss improved to 1.072359
epoch:  7
epoch:  8 val_f1:  0.7584532667010088 val_auroc:  0.7734413352970053 val_auprc:  0.9123075319881662
Validation loss improved to 1.055717
epoch:  8
epoch:  9 val_f1:  0.7337314237416728 val_auroc:  0.783014236622484 val_auprc:  0.9147102584604861
Validation loss improved to 1.027962
epoch:  9
epoch:  10 val_f1:  0.7786895152313162 val_auroc:  0.7889052528227786 val_auprc:  0.917080464502434
Validation loss improved to 1.021454
epoch:  10
epoch:  11 val_f1:  0.7639705763479104 val_auroc:  0.797987236131566 val_auprc:  0.9198099089109555
Validation loss improved to 1.000821
epoch:  11
epoch:  12 val_f1:  0.7854414831518974 val_auroc:  0.8063328424153167 val_auprc:  0.9230798035606649
Validation loss improved to 0.996550
epoch:  12
epoch:  13 val_f1:  0.7644702419882276 val_auroc:  0.812960235640648 val_auprc:  0.9251719920888752
Validation loss improved to 0.980331
epoch:  13
epoch:  14 val_f1:  0.7573003855683703 val_auroc:  0.8171330387825233 val_auprc:  0.9259790366969771
Validation loss improved to 0.968867
epoch:  14
epoch:  15 val_f1:  0.7644702419882276 val_auroc:  0.8203240058910162 val_auprc:  0.9270465245486912
Validation loss improved to 0.961925
epoch:  15
epoch:  16 val_f1:  0.7567268683783295 val_auroc:  0.8205694648993618 val_auprc:  0.9262159995718332
Validation loss improved to 0.950558
epoch:  16
epoch:  17 val_f1:  0.748656020238754 val_auroc:  0.8220422189494354 val_auprc:  0.926595784294623
Validation loss improved to 0.945520
epoch:  17
epoch:  18 val_f1:  0.7791131800441999 val_auroc:  0.822287677957781 val_auprc:  0.9275919839088986
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7681512331200245 val_auroc:  0.8249877270495828 val_auprc:  0.9265518836145497
Validation loss improved to 0.941696
epoch:  19
epoch:  20 val_f1:  0.758098723333472 val_auroc:  0.8240058910162004 val_auprc:  0.9273568483865147
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7712620601193464 val_auroc:  0.8232695139911635 val_auprc:  0.9255237709893658
Validation loss improved to 0.932078
epoch:  21
epoch:  22 val_f1:  0.7560320485424044 val_auroc:  0.8269513991163476 val_auprc:  0.92748905851241
Validation loss improved to 0.928669
epoch:  22
epoch:  23 val_f1:  0.7762067639678805 val_auroc:  0.8249877270495828 val_auprc:  0.9258244840728698
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7651358509506568 val_auroc:  0.8269513991163476 val_auprc:  0.9281543248638577
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.7428255465713769 val_auroc:  0.8294059891998037 val_auprc:  0.9290210103640524
EarlyStopping counter: 3 out of 50
epoch:  25
epoch:  26 val_f1:  0.7762067639678805 val_auroc:  0.8259695630829652 val_auprc:  0.9260365760014211
EarlyStopping counter: 4 out of 50
epoch:  26
epoch:  27 val_f1:  0.7560320485424044 val_auroc:  0.8269513991163476 val_auprc:  0.9271099100868291
EarlyStopping counter: 5 out of 50
epoch:  27
epoch:  28 val_f1:  0.7868059619290214 val_auroc:  0.824251350024546 val_auprc:  0.9249708959028836
Validation loss improved to 0.928160
epoch:  28
epoch:  29 val_f1:  0.7560320485424044 val_auroc:  0.8294059891998037 val_auprc:  0.9287174014972073
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.7823449348629204 val_auroc:  0.8301423662248404 val_auprc:  0.9287240370005145
Validation loss improved to 0.925457
epoch:  30
epoch:  31 val_f1:  0.7567268683783295 val_auroc:  0.8298969072164948 val_auprc:  0.9292431495693014
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.7727225509205256 val_auroc:  0.8262150220913108 val_auprc:  0.9251276985313674
EarlyStopping counter: 2 out of 50
epoch:  32
epoch:  33 val_f1:  0.7790721385700611 val_auroc:  0.8291605301914581 val_auprc:  0.9275009423336482
EarlyStopping counter: 3 out of 50
epoch:  33
epoch:  34 val_f1:  0.7661184054361647 val_auroc:  0.8274423171330388 val_auprc:  0.9264660231657507
EarlyStopping counter: 4 out of 50
epoch:  34
epoch:  35 val_f1:  0.7748426784519089 val_auroc:  0.8249877270495828 val_auprc:  0.9254192253368296
EarlyStopping counter: 5 out of 50
epoch:  35
epoch:  36 val_f1:  0.7823449348629204 val_auroc:  0.82793323514973 val_auprc:  0.926785606573305
EarlyStopping counter: 6 out of 50
epoch:  36
epoch:  37 val_f1:  0.7661184054361647 val_auroc:  0.8274423171330388 val_auprc:  0.9257307879556506
EarlyStopping counter: 7 out of 50
epoch:  37
epoch:  38 val_f1:  0.7672775806504117 val_auroc:  0.8286696121747669 val_auprc:  0.9267169295553637
EarlyStopping counter: 8 out of 50
epoch:  38
epoch:  39 val_f1:  0.7823449348629204 val_auroc:  0.8291605301914581 val_auprc:  0.9271196787033062
EarlyStopping counter: 9 out of 50
epoch:  39
epoch:  40 val_f1:  0.7648187281552264 val_auroc:  0.8271968581246931 val_auprc:  0.9260476027645911
EarlyStopping counter: 10 out of 50
epoch:  40
epoch:  41 val_f1:  0.7727225509205256 val_auroc:  0.8247422680412371 val_auprc:  0.9238648867870094
EarlyStopping counter: 11 out of 50
epoch:  41
epoch:  42 val_f1:  0.7823449348629204 val_auroc:  0.8271968581246932 val_auprc:  0.9257020219229992
EarlyStopping counter: 12 out of 50
epoch:  42
epoch:  43 val_f1:  0.7672775806504117 val_auroc:  0.8289150711831124 val_auprc:  0.9260429208815651
EarlyStopping counter: 13 out of 50
epoch:  43
epoch:  44 val_f1:  0.7748796193569787 val_auroc:  0.8249877270495827 val_auprc:  0.9227749345395664
EarlyStopping counter: 14 out of 50
epoch:  44
epoch:  45 val_f1:  0.7685409504908388 val_auroc:  0.8267059401080019 val_auprc:  0.9241791371373566
EarlyStopping counter: 15 out of 50
epoch:  45
epoch:  46 val_f1:  0.7737843767539161 val_auroc:  0.8308787432498773 val_auprc:  0.9271116679023883
EarlyStopping counter: 16 out of 50
epoch:  46
epoch:  47 val_f1:  0.7727225509205256 val_auroc:  0.825478645066274 val_auprc:  0.9232502456308284
EarlyStopping counter: 17 out of 50
epoch:  47
epoch:  48 val_f1:  0.7617684906754855 val_auroc:  0.824251350024546 val_auprc:  0.922650747154443
EarlyStopping counter: 18 out of 50
epoch:  48
epoch:  49 val_f1:  0.7455074238481555 val_auroc:  0.829160530191458 val_auprc:  0.9255271407772193
EarlyStopping counter: 19 out of 50
epoch:  49
epoch:  50 val_f1:  0.7643829551743221 val_auroc:  0.8232695139911634 val_auprc:  0.9217306138023197
EarlyStopping counter: 20 out of 50
epoch:  50
epoch:  51 val_f1:  0.7643829551743221 val_auroc:  0.822287677957781 val_auprc:  0.9204995281486633
EarlyStopping counter: 21 out of 50
epoch:  51
epoch:  52 val_f1:  0.7643829551743221 val_auroc:  0.8227785959744722 val_auprc:  0.9210934051269837
EarlyStopping counter: 22 out of 50
epoch:  52
epoch:  53 val_f1:  0.7617684906754855 val_auroc:  0.821060382916053 val_auprc:  0.9200077581013775
EarlyStopping counter: 23 out of 50
epoch:  53
epoch:  54 val_f1:  0.7777125328082551 val_auroc:  0.8249877270495827 val_auprc:  0.9227412573447307
EarlyStopping counter: 24 out of 50
epoch:  54
epoch:  55 val_f1:  0.7697841726618705 val_auroc:  0.8247422680412371 val_auprc:  0.9226517642570515
EarlyStopping counter: 25 out of 50
epoch:  55
epoch:  56 val_f1:  0.7707245329923307 val_auroc:  0.8183603338242513 val_auprc:  0.9187720116250604
EarlyStopping counter: 26 out of 50
epoch:  56
epoch:  57 val_f1:  0.7712620601193464 val_auroc:  0.8259695630829651 val_auprc:  0.9232696375097842
EarlyStopping counter: 27 out of 50
epoch:  57
epoch:  58 val_f1:  0.7898876447331801 val_auroc:  0.8205694648993618 val_auprc:  0.9185778693660578
EarlyStopping counter: 28 out of 50
epoch:  58
epoch:  59 val_f1:  0.7770871369605723 val_auroc:  0.8203240058910162 val_auprc:  0.9187626556984652
EarlyStopping counter: 29 out of 50
epoch:  59
epoch:  60 val_f1:  0.7712620601193464 val_auroc:  0.8210603829160531 val_auprc:  0.9193988386386756
EarlyStopping counter: 30 out of 50
epoch:  60
epoch:  61 val_f1:  0.7643829551743221 val_auroc:  0.8163966617574866 val_auprc:  0.9168410489053138
EarlyStopping counter: 31 out of 50
epoch:  61
epoch:  62 val_f1:  0.7834737923946559 val_auroc:  0.8163966617574864 val_auprc:  0.9164531551258865
EarlyStopping counter: 32 out of 50
epoch:  62
epoch:  63 val_f1:  0.7727225509205256 val_auroc:  0.8181148748159057 val_auprc:  0.9173326155086652
EarlyStopping counter: 33 out of 50
epoch:  63
epoch:  64 val_f1:  0.7707245329923307 val_auroc:  0.814187530682376 val_auprc:  0.9145986911421349
EarlyStopping counter: 34 out of 50
epoch:  64
epoch:  65 val_f1:  0.7791090204759269 val_auroc:  0.8149239077074127 val_auprc:  0.9147659172862339
EarlyStopping counter: 35 out of 50
epoch:  65
epoch:  66 val_f1:  0.7748796193569787 val_auroc:  0.8136966126656848 val_auprc:  0.9142063740708659
EarlyStopping counter: 36 out of 50
epoch:  66
epoch:  67 val_f1:  0.766354189375772 val_auroc:  0.8161512027491409 val_auprc:  0.9166230378237115
EarlyStopping counter: 37 out of 50
epoch:  67
epoch:  68 val_f1:  0.7617684906754855 val_auroc:  0.8198330878743251 val_auprc:  0.9190298476988759
EarlyStopping counter: 38 out of 50
epoch:  68
epoch:  69 val_f1:  0.7748796193569787 val_auroc:  0.8168875797741778 val_auprc:  0.9161674999758196
EarlyStopping counter: 39 out of 50
epoch:  69
epoch:  70 val_f1:  0.7685409504908388 val_auroc:  0.8127147766323024 val_auprc:  0.9139653643239127
EarlyStopping counter: 40 out of 50
epoch:  70
epoch:  71 val_f1:  0.7791090204759269 val_auroc:  0.8144329896907216 val_auprc:  0.9151636070059621
EarlyStopping counter: 41 out of 50
epoch:  71
epoch:  72 val_f1:  0.7748796193569787 val_auroc:  0.8127147766323025 val_auprc:  0.913596381149327
EarlyStopping counter: 42 out of 50
epoch:  72
epoch:  73 val_f1:  0.7855164986057286 val_auroc:  0.8151693667157585 val_auprc:  0.9144708387616851
EarlyStopping counter: 43 out of 50
epoch:  73
epoch:  74 val_f1:  0.7707245329923307 val_auroc:  0.8124693176239568 val_auprc:  0.9129578441819339
EarlyStopping counter: 44 out of 50
epoch:  74
epoch:  75 val_f1:  0.7791090204759269 val_auroc:  0.8134511536573392 val_auprc:  0.9136275954097282
EarlyStopping counter: 45 out of 50
epoch:  75
epoch:  76 val_f1:  0.7748796193569787 val_auroc:  0.8139420716740304 val_auprc:  0.9144070968134648
EarlyStopping counter: 46 out of 50
epoch:  76
epoch:  77 val_f1:  0.7770871369605723 val_auroc:  0.8146784486990672 val_auprc:  0.9148786118306197
EarlyStopping counter: 47 out of 50
epoch:  77
epoch:  78 val_f1:  0.7770871369605723 val_auroc:  0.8132056946489935 val_auprc:  0.9138334158393043
EarlyStopping counter: 48 out of 50
epoch:  78
epoch:  79 val_f1:  0.76000113614692 val_auroc:  0.8141875306823759 val_auprc:  0.913872974953049
EarlyStopping counter: 49 out of 50
epoch:  79
epoch:  80 val_f1:  0.7770871369605723 val_auroc:  0.8132056946489936 val_auprc:  0.9136350261514683
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  64.30878925323486
{'time_elapsed': [64.30878925323486], 'epoch': [79], 'fold': [1], 'f1_train': [0.9910272898858162], 'auroc_train': [0.9999846705705613], 'auprc_train': [0.9999932970817315], 'f1_test': [0.7770871369605723], 'auroc_test': [0.8132056946489936], 'auprc_test': [0.9136350261514683]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 256]            1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 256]            512
│    └─Tanh: 2-3                         [64, 256, 256]            --
│    └─MaxPool1d: 2-4                    [64, 256, 51]             --
│    └─Dropout: 2-5                      [64, 256, 51]             --
│    └─Flatten: 2-6                      [64, 13056]               --
│    └─Linear: 2-7                       [64, 1]                   13,057
==========================================================================================
Total params: 15,105
Trainable params: 15,105
Non-trainable params: 0
Total mult-adds (M): 26.03
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 67.11
Params size (MB): 0.06
Estimated Total Size (MB): 67.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.5510554737358861 val_auprc:  0.7569104880566624
epoch:  1
epoch:  2 val_f1:  0.2914546793937399 val_auroc:  0.5859106529209622 val_auprc:  0.8031650087178782
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6119595151436944 val_auroc:  0.6080019636720668 val_auprc:  0.8181137538850525
Validation loss improved to 1.175359
epoch:  3
epoch:  4 val_f1:  0.4885733204481192 val_auroc:  0.6188021600392735 val_auprc:  0.8242659258097934
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.615332410516798 val_auroc:  0.6396661757486499 val_auprc:  0.8336920919022766
Validation loss improved to 1.141193
epoch:  5
epoch:  6 val_f1:  0.5652008393285373 val_auroc:  0.65586647029946 val_auprc:  0.8422130913701953
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.580651268458917 val_auroc:  0.6774668630338734 val_auprc:  0.8512779481585311
Validation loss improved to 1.129181
epoch:  7
epoch:  8 val_f1:  0.6687657666074932 val_auroc:  0.693912616593029 val_auprc:  0.8583353221143342
Validation loss improved to 1.108506
epoch:  8
epoch:  9 val_f1:  0.5678413349175468 val_auroc:  0.7074128620520372 val_auprc:  0.8648239793291717
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.6895771242135116 val_auroc:  0.7282768777614138 val_auprc:  0.8739962579859609
Validation loss improved to 1.080751
epoch:  10
epoch:  11 val_f1:  0.5739378646336663 val_auroc:  0.7295041728031418 val_auprc:  0.873068313860488
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7140775751491829 val_auroc:  0.7491408934707904 val_auprc:  0.8821289699265675
Validation loss improved to 1.063754
epoch:  12
epoch:  13 val_f1:  0.6237171971681137 val_auroc:  0.7415316642120766 val_auprc:  0.8773067053255043
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.6823403921278894 val_auroc:  0.7508591065292096 val_auprc:  0.8817263281356646
Validation loss improved to 1.058859
epoch:  14
epoch:  15 val_f1:  0.6823403921278894 val_auroc:  0.7513500245459008 val_auprc:  0.8804465480112924
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.730071543320129 val_auroc:  0.7577319587628866 val_auprc:  0.884108801603392
Validation loss improved to 1.041019
epoch:  16
epoch:  17 val_f1:  0.735514445586388 val_auroc:  0.7643593519882179 val_auprc:  0.8882383168234341
Validation loss improved to 1.032868
epoch:  17
epoch:  18 val_f1:  0.6376535972729985 val_auroc:  0.7579774177712322 val_auprc:  0.8846419818959641
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7233618940391454 val_auroc:  0.7626411389297987 val_auprc:  0.8868518126340305
Validation loss improved to 1.031315
epoch:  19
epoch:  20 val_f1:  0.730071543320129 val_auroc:  0.7636229749631812 val_auprc:  0.887524622966908
Validation loss improved to 1.030761
epoch:  20
epoch:  21 val_f1:  0.7166299330477814 val_auroc:  0.766813942071674 val_auprc:  0.888335130366712
Validation loss improved to 1.026716
epoch:  21
epoch:  22 val_f1:  0.7166299330477814 val_auroc:  0.768041237113402 val_auprc:  0.8882564113904082
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7098736982331642 val_auroc:  0.7673048600883653 val_auprc:  0.8868478151175272
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.7101700457815566 val_auroc:  0.7682866961217477 val_auprc:  0.8872726517683859
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.7094198370570532 val_auroc:  0.7729504172803142 val_auprc:  0.8874251369178175
EarlyStopping counter: 4 out of 50
epoch:  25
epoch:  26 val_f1:  0.7249644134959412 val_auroc:  0.7709867452135494 val_auprc:  0.8847287787270649
EarlyStopping counter: 5 out of 50
epoch:  26
epoch:  27 val_f1:  0.6365644326643948 val_auroc:  0.7614138438880708 val_auprc:  0.8821025555736239
EarlyStopping counter: 6 out of 50
epoch:  27
epoch:  28 val_f1:  0.6963248678165901 val_auroc:  0.7729504172803142 val_auprc:  0.8893798715301139
EarlyStopping counter: 7 out of 50
epoch:  28
epoch:  29 val_f1:  0.69663104467882 val_auroc:  0.7874324987727049 val_auprc:  0.8955536469696281
EarlyStopping counter: 8 out of 50
epoch:  29
epoch:  30 val_f1:  0.6893510131556864 val_auroc:  0.7719685812469318 val_auprc:  0.8894615070663067
EarlyStopping counter: 9 out of 50
epoch:  30
epoch:  31 val_f1:  0.7295632867761842 val_auroc:  0.7729504172803142 val_auprc:  0.8878188993606048
EarlyStopping counter: 10 out of 50
epoch:  31
epoch:  32 val_f1:  0.7346891520614657 val_auroc:  0.7781050564555719 val_auprc:  0.8890176089062581
EarlyStopping counter: 11 out of 50
epoch:  32
epoch:  33 val_f1:  0.682026026688228 val_auroc:  0.764359351988218 val_auprc:  0.8820619474387341
EarlyStopping counter: 12 out of 50
epoch:  33
epoch:  34 val_f1:  0.7328919440906961 val_auroc:  0.7754050073637703 val_auprc:  0.886308664735109
EarlyStopping counter: 13 out of 50
epoch:  34
epoch:  35 val_f1:  0.7166299330477814 val_auroc:  0.7668139420716741 val_auprc:  0.8837623220117046
EarlyStopping counter: 14 out of 50
epoch:  35
epoch:  36 val_f1:  0.7162290583621869 val_auroc:  0.766813942071674 val_auprc:  0.8848827454765884
EarlyStopping counter: 15 out of 50
epoch:  36
epoch:  37 val_f1:  0.7095299887411026 val_auroc:  0.7663230240549828 val_auprc:  0.8849001464571368
EarlyStopping counter: 16 out of 50
epoch:  37
epoch:  38 val_f1:  0.7090514753972222 val_auroc:  0.7682866961217476 val_auprc:  0.8852474986802865
EarlyStopping counter: 17 out of 50
epoch:  38
epoch:  39 val_f1:  0.713247796930704 val_auroc:  0.7714776632302406 val_auprc:  0.887799577086249
EarlyStopping counter: 18 out of 50
epoch:  39
epoch:  40 val_f1:  0.7473302173830908 val_auroc:  0.7685321551300933 val_auprc:  0.8846074780702096
EarlyStopping counter: 19 out of 50
epoch:  40
epoch:  41 val_f1:  0.7098736982331642 val_auroc:  0.7638684339715268 val_auprc:  0.883052407278103
EarlyStopping counter: 20 out of 50
epoch:  41
epoch:  42 val_f1:  0.7185533480648861 val_auroc:  0.771232204221895 val_auprc:  0.8876231052063879
EarlyStopping counter: 21 out of 50
epoch:  42
epoch:  43 val_f1:  0.7185533480648861 val_auroc:  0.7685321551300932 val_auprc:  0.8853455349947226
EarlyStopping counter: 22 out of 50
epoch:  43
epoch:  44 val_f1:  0.7313689473952751 val_auroc:  0.7687776141384389 val_auprc:  0.8855511332491641
EarlyStopping counter: 23 out of 50
epoch:  44
epoch:  45 val_f1:  0.7030912407309765 val_auroc:  0.7601865488463427 val_auprc:  0.8805546892586095
EarlyStopping counter: 24 out of 50
epoch:  45
epoch:  46 val_f1:  0.7225455998837295 val_auroc:  0.7680412371134021 val_auprc:  0.8849293834261343
EarlyStopping counter: 25 out of 50
epoch:  46
epoch:  47 val_f1:  0.7121336235283787 val_auroc:  0.7636229749631812 val_auprc:  0.8832220873584441
EarlyStopping counter: 26 out of 50
epoch:  47
epoch:  48 val_f1:  0.6928018025140328 val_auroc:  0.759941089837997 val_auprc:  0.8802121069394961
EarlyStopping counter: 27 out of 50
epoch:  48
epoch:  49 val_f1:  0.7121336235283787 val_auroc:  0.7592047128129602 val_auprc:  0.8806377672620368
EarlyStopping counter: 28 out of 50
epoch:  49
epoch:  50 val_f1:  0.706765356945213 val_auroc:  0.760677466863034 val_auprc:  0.8827046074281815
EarlyStopping counter: 29 out of 50
epoch:  50
epoch:  51 val_f1:  0.6992598845858601 val_auroc:  0.7572410407461955 val_auprc:  0.8787141366690148
EarlyStopping counter: 30 out of 50
epoch:  51
epoch:  52 val_f1:  0.7140775751491829 val_auroc:  0.7587137947962691 val_auprc:  0.8793211773708278
EarlyStopping counter: 31 out of 50
epoch:  52
epoch:  53 val_f1:  0.7140775751491829 val_auroc:  0.7582228767795778 val_auprc:  0.8799053213037532
EarlyStopping counter: 32 out of 50
epoch:  53
epoch:  54 val_f1:  0.6945501576267077 val_auroc:  0.7530682376043201 val_auprc:  0.8774054784461972
EarlyStopping counter: 33 out of 50
epoch:  54
epoch:  55 val_f1:  0.7078050864958872 val_auroc:  0.7577319587628867 val_auprc:  0.8796807530931524
EarlyStopping counter: 34 out of 50
epoch:  55
epoch:  56 val_f1:  0.6937535685737124 val_auroc:  0.7528227785959746 val_auprc:  0.877423376373949
EarlyStopping counter: 35 out of 50
epoch:  56
epoch:  57 val_f1:  0.7044810154681304 val_auroc:  0.7547864506627394 val_auprc:  0.8770485031806944
EarlyStopping counter: 36 out of 50
epoch:  57
epoch:  58 val_f1:  0.7044810154681304 val_auroc:  0.7567501227295041 val_auprc:  0.8797904367455489
EarlyStopping counter: 37 out of 50
epoch:  58
epoch:  59 val_f1:  0.706765356945213 val_auroc:  0.7560137457044673 val_auprc:  0.8790344439028259
EarlyStopping counter: 38 out of 50
epoch:  59
epoch:  60 val_f1:  0.7011215811505187 val_auroc:  0.749386352479136 val_auprc:  0.8748919483122396
EarlyStopping counter: 39 out of 50
epoch:  60
epoch:  61 val_f1:  0.7044810154681304 val_auroc:  0.7533136966126657 val_auprc:  0.8760143872770474
EarlyStopping counter: 40 out of 50
epoch:  61
epoch:  62 val_f1:  0.6967556353929608 val_auroc:  0.7508591065292096 val_auprc:  0.8762245027305315
EarlyStopping counter: 41 out of 50
epoch:  62
epoch:  63 val_f1:  0.7079427367197151 val_auroc:  0.7530682376043201 val_auprc:  0.8771740265841891
EarlyStopping counter: 42 out of 50
epoch:  63
epoch:  64 val_f1:  0.6967556353929608 val_auroc:  0.7520864015709378 val_auprc:  0.8766998936630247
EarlyStopping counter: 43 out of 50
epoch:  64
epoch:  65 val_f1:  0.6980913612614702 val_auroc:  0.7471772214040255 val_auprc:  0.8729300335004315
EarlyStopping counter: 44 out of 50
epoch:  65
epoch:  66 val_f1:  0.708480907581627 val_auroc:  0.7535591556210113 val_auprc:  0.8778623811816931
EarlyStopping counter: 45 out of 50
epoch:  66
epoch:  67 val_f1:  0.7115566705387387 val_auroc:  0.7442317133038783 val_auprc:  0.8710439339218964
EarlyStopping counter: 46 out of 50
epoch:  67
epoch:  68 val_f1:  0.6928018025140328 val_auroc:  0.7407952871870398 val_auprc:  0.8679672008256613
EarlyStopping counter: 47 out of 50
epoch:  68
epoch:  69 val_f1:  0.6937535685737124 val_auroc:  0.741286205203731 val_auprc:  0.8678812707142901
EarlyStopping counter: 48 out of 50
epoch:  69
epoch:  70 val_f1:  0.7040153975059064 val_auroc:  0.7457044673539518 val_auprc:  0.8699378853398129
EarlyStopping counter: 49 out of 50
epoch:  70
epoch:  71 val_f1:  0.7078050864958872 val_auroc:  0.7454590083456064 val_auprc:  0.8706554177790364
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  58.98522138595581
{'time_elapsed': [58.98522138595581], 'epoch': [70], 'fold': [2], 'f1_train': [0.9785471597038256], 'auroc_train': [0.9994174816813317], 'auprc_train': [0.9997427135321356], 'f1_test': [0.7078050864958872], 'auroc_test': [0.7454590083456064], 'auprc_test': [0.8706554177790364]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 256]            1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 256]            512
│    └─Tanh: 2-3                         [64, 256, 256]            --
│    └─MaxPool1d: 2-4                    [64, 256, 51]             --
│    └─Dropout: 2-5                      [64, 256, 51]             --
│    └─Flatten: 2-6                      [64, 13056]               --
│    └─Linear: 2-7                       [64, 1]                   13,057
==========================================================================================
Total params: 15,105
Trainable params: 15,105
Non-trainable params: 0
Total mult-adds (M): 26.03
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 67.11
Params size (MB): 0.06
Estimated Total Size (MB): 67.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5607821435159565 val_auroc:  0.6623062015503876 val_auprc:  0.7861584709032285
epoch:  1
epoch:  2 val_f1:  0.5500765915850584 val_auroc:  0.7260174418604651 val_auprc:  0.8531905360634991
Validation loss improved to 1.146907
epoch:  2
epoch:  3 val_f1:  0.672520725003466 val_auroc:  0.7516957364341086 val_auprc:  0.8683459874341118
Validation loss improved to 1.118446
epoch:  3
epoch:  4 val_f1:  0.6002515303415925 val_auroc:  0.778827519379845 val_auprc:  0.897503941526768
Validation loss improved to 1.086674
epoch:  4
epoch:  5 val_f1:  0.7323088800005325 val_auroc:  0.7984496124031008 val_auprc:  0.9073517889620676
Validation loss improved to 1.059346
epoch:  5
epoch:  6 val_f1:  0.664052216873118 val_auroc:  0.8125 val_auprc:  0.9172961047124133
Validation loss improved to 1.043896
epoch:  6
epoch:  7 val_f1:  0.7735780520043992 val_auroc:  0.8209786821705426 val_auprc:  0.9200891129811279
Validation loss improved to 1.016772
epoch:  7
epoch:  8 val_f1:  0.7968569383258559 val_auroc:  0.8296996124031009 val_auprc:  0.9250596614760702
Validation loss improved to 0.993452
epoch:  8
epoch:  9 val_f1:  0.7300196418362964 val_auroc:  0.8330910852713178 val_auprc:  0.9274052632539707
Validation loss improved to 0.977688
epoch:  9
epoch:  10 val_f1:  0.7801238118631262 val_auroc:  0.8386627906976745 val_auprc:  0.9280342699060593
Validation loss improved to 0.961831
epoch:  10
epoch:  11 val_f1:  0.7576331204728416 val_auroc:  0.8357558139534884 val_auprc:  0.9284368696580936
Validation loss improved to 0.945073
epoch:  11
epoch:  12 val_f1:  0.7901923359271766 val_auroc:  0.8401162790697675 val_auprc:  0.9292687567833029
Validation loss improved to 0.922660
epoch:  12
epoch:  13 val_f1:  0.7697841726618705 val_auroc:  0.8415697674418604 val_auprc:  0.9299511766805402
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7644817479349855 val_auroc:  0.8391472868217054 val_auprc:  0.9293968551620035
Validation loss improved to 0.896773
epoch:  14
epoch:  15 val_f1:  0.7827158008497472 val_auroc:  0.84375 val_auprc:  0.9309543789445585
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7907929835906556 val_auroc:  0.841327519379845 val_auprc:  0.9301942644402481
Validation loss improved to 0.868032
epoch:  16
epoch:  17 val_f1:  0.7820584602206068 val_auroc:  0.8430232558139534 val_auprc:  0.9310413905529327
Validation loss improved to 0.866840
epoch:  17
epoch:  18 val_f1:  0.8008946034661633 val_auroc:  0.8461724806201552 val_auprc:  0.9316376843806057
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7773759601944114 val_auroc:  0.8459302325581395 val_auprc:  0.9331789599173076
Validation loss improved to 0.839070
epoch:  19
epoch:  20 val_f1:  0.7828470720035011 val_auroc:  0.8473837209302325 val_auprc:  0.9335138109241383
Validation loss improved to 0.828829
epoch:  20
epoch:  21 val_f1:  0.7828470720035011 val_auroc:  0.8476259689922481 val_auprc:  0.9340267544266748
Validation loss improved to 0.819591
epoch:  21
epoch:  22 val_f1:  0.8018807955038493 val_auroc:  0.8478682170542634 val_auprc:  0.9340042515550947
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7639114172852699 val_auroc:  0.8507751937984497 val_auprc:  0.9363002486379152
Validation loss improved to 0.805694
epoch:  23
epoch:  24 val_f1:  0.771032917679069 val_auroc:  0.8490794573643411 val_auprc:  0.9353927020608042
Validation loss improved to 0.802252
epoch:  24
epoch:  25 val_f1:  0.8217477382460002 val_auroc:  0.8529554263565892 val_auprc:  0.9348599371742068
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.8151164175042944 val_auroc:  0.8527131782945736 val_auprc:  0.9363370255811191
EarlyStopping counter: 2 out of 50
epoch:  26
epoch:  27 val_f1:  0.8018807955038493 val_auroc:  0.8544089147286821 val_auprc:  0.9377569285509431
Validation loss improved to 0.794263
epoch:  27
epoch:  28 val_f1:  0.7644817479349855 val_auroc:  0.852470930232558 val_auprc:  0.9384749303734687
Validation loss improved to 0.790676
epoch:  28
epoch:  29 val_f1:  0.8151164175042944 val_auroc:  0.8573158914728682 val_auprc:  0.9396219100757246
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.8018807955038493 val_auroc:  0.8563468992248062 val_auprc:  0.9390676025489559
Validation loss improved to 0.778058
epoch:  30
epoch:  31 val_f1:  0.7571561248111338 val_auroc:  0.8546511627906975 val_auprc:  0.9397908889933486
Validation loss improved to 0.773537
epoch:  31
epoch:  32 val_f1:  0.7952715769842713 val_auroc:  0.8551356589147286 val_auprc:  0.938963069547107
Validation loss improved to 0.770507
epoch:  32
epoch:  33 val_f1:  0.8018807955038493 val_auroc:  0.8558624031007752 val_auprc:  0.9394144797834492
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.8035187234827523 val_auroc:  0.8570736434108527 val_auprc:  0.9405584138146733
Validation loss improved to 0.755317
epoch:  34
epoch:  35 val_f1:  0.8063632502555458 val_auroc:  0.8616763565891473 val_auprc:  0.9417441787283368
EarlyStopping counter: 1 out of 50
epoch:  35
epoch:  36 val_f1:  0.7886649052635782 val_auroc:  0.8626453488372093 val_auprc:  0.9425489513866145
EarlyStopping counter: 2 out of 50
epoch:  36
epoch:  37 val_f1:  0.7974889768226049 val_auroc:  0.8565891472868217 val_auprc:  0.9409028379233422
Validation loss improved to 0.751560
epoch:  37
epoch:  38 val_f1:  0.7961192047225032 val_auroc:  0.8575581395348837 val_auprc:  0.9409157699179949
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.8182769817510218 val_auroc:  0.8633720930232559 val_auprc:  0.9424530847987247
EarlyStopping counter: 2 out of 50
epoch:  39
epoch:  40 val_f1:  0.8027539115793398 val_auroc:  0.8599806201550387 val_auprc:  0.942126702224205
EarlyStopping counter: 3 out of 50
epoch:  40
epoch:  41 val_f1:  0.7968569383258559 val_auroc:  0.8578003875968992 val_auprc:  0.9422204044176159
Validation loss improved to 0.742583
epoch:  41
epoch:  42 val_f1:  0.7968569383258559 val_auroc:  0.8604651162790697 val_auprc:  0.9430685477793921
EarlyStopping counter: 1 out of 50
epoch:  42
epoch:  43 val_f1:  0.8182769817510218 val_auroc:  0.8660368217054264 val_auprc:  0.9440797887735675
EarlyStopping counter: 2 out of 50
epoch:  43
epoch:  44 val_f1:  0.7968569383258559 val_auroc:  0.8611918604651162 val_auprc:  0.9430671721426466
Validation loss improved to 0.735470
epoch:  44
epoch:  45 val_f1:  0.8129496402877698 val_auroc:  0.8636143410852712 val_auprc:  0.9436509183751216
EarlyStopping counter: 1 out of 50
epoch:  45
epoch:  46 val_f1:  0.8129496402877698 val_auroc:  0.8689437984496124 val_auprc:  0.9455561300020309
EarlyStopping counter: 2 out of 50
epoch:  46
epoch:  47 val_f1:  0.7961192047225032 val_auroc:  0.8628875968992248 val_auprc:  0.9437525127385378
Validation loss improved to 0.734363
epoch:  47
epoch:  48 val_f1:  0.8093907785715628 val_auroc:  0.8633720930232557 val_auprc:  0.944029743787846
EarlyStopping counter: 1 out of 50
epoch:  48
epoch:  49 val_f1:  0.7932273763653603 val_auroc:  0.8662790697674418 val_auprc:  0.9460140890180215
EarlyStopping counter: 2 out of 50
epoch:  49
epoch:  50 val_f1:  0.8035187234827523 val_auroc:  0.8650678294573644 val_auprc:  0.9463600408562536
EarlyStopping counter: 3 out of 50
epoch:  50
epoch:  51 val_f1:  0.7877294237541244 val_auroc:  0.8660368217054264 val_auprc:  0.9460949894242546
EarlyStopping counter: 4 out of 50
epoch:  51
epoch:  52 val_f1:  0.7877294237541244 val_auroc:  0.8674903100775193 val_auprc:  0.9466078160137418
EarlyStopping counter: 5 out of 50
epoch:  52
epoch:  53 val_f1:  0.8063632502555458 val_auroc:  0.8703972868217055 val_auprc:  0.9469789163156851
EarlyStopping counter: 6 out of 50
epoch:  53
epoch:  54 val_f1:  0.7997900244397783 val_auroc:  0.8708817829457365 val_auprc:  0.9480016446608827
EarlyStopping counter: 7 out of 50
epoch:  54
epoch:  55 val_f1:  0.794309372388086 val_auroc:  0.8694282945736435 val_auprc:  0.9485149192534338
EarlyStopping counter: 8 out of 50
epoch:  55
epoch:  56 val_f1:  0.7877294237541244 val_auroc:  0.8682170542635659 val_auprc:  0.9479498149841057
EarlyStopping counter: 9 out of 50
epoch:  56
epoch:  57 val_f1:  0.8051160047274586 val_auroc:  0.874031007751938 val_auprc:  0.9490320479672336
EarlyStopping counter: 10 out of 50
epoch:  57
epoch:  58 val_f1:  0.7932273763653603 val_auroc:  0.8691860465116279 val_auprc:  0.9476572847632014
EarlyStopping counter: 11 out of 50
epoch:  58
epoch:  59 val_f1:  0.7952715769842713 val_auroc:  0.8682170542635659 val_auprc:  0.9478980094139924
Validation loss improved to 0.728907
epoch:  59
epoch:  60 val_f1:  0.8063632502555458 val_auroc:  0.8716085271317828 val_auprc:  0.9488454070301473
EarlyStopping counter: 1 out of 50
epoch:  60
epoch:  61 val_f1:  0.794309372388086 val_auroc:  0.871608527131783 val_auprc:  0.9490764802572507
EarlyStopping counter: 2 out of 50
epoch:  61
epoch:  62 val_f1:  0.794309372388086 val_auroc:  0.8718507751937985 val_auprc:  0.9495019524492001
EarlyStopping counter: 3 out of 50
epoch:  62
epoch:  63 val_f1:  0.7985611510791367 val_auroc:  0.8708817829457365 val_auprc:  0.9489332369968085
EarlyStopping counter: 4 out of 50
epoch:  63
epoch:  64 val_f1:  0.7932273763653603 val_auroc:  0.8728197674418605 val_auprc:  0.9497275194068129
EarlyStopping counter: 5 out of 50
epoch:  64
epoch:  65 val_f1:  0.794309372388086 val_auroc:  0.8708817829457364 val_auprc:  0.9490962537011283
EarlyStopping counter: 6 out of 50
epoch:  65
epoch:  66 val_f1:  0.794309372388086 val_auroc:  0.870639534883721 val_auprc:  0.9488820833416148
EarlyStopping counter: 7 out of 50
epoch:  66
epoch:  67 val_f1:  0.7932273763653603 val_auroc:  0.8737887596899225 val_auprc:  0.9501149708987962
EarlyStopping counter: 8 out of 50
epoch:  67
epoch:  68 val_f1:  0.7957035068809065 val_auroc:  0.8733042635658914 val_auprc:  0.9496376604271235
EarlyStopping counter: 9 out of 50
epoch:  68
epoch:  69 val_f1:  0.7932273763653603 val_auroc:  0.8706395348837209 val_auprc:  0.948801238319332
EarlyStopping counter: 10 out of 50
epoch:  69
epoch:  70 val_f1:  0.7932273763653603 val_auroc:  0.8723352713178294 val_auprc:  0.9496775413437202
EarlyStopping counter: 11 out of 50
epoch:  70
epoch:  71 val_f1:  0.792019787311512 val_auroc:  0.8718507751937985 val_auprc:  0.9493286551938741
EarlyStopping counter: 12 out of 50
epoch:  71
epoch:  72 val_f1:  0.7892012988311853 val_auroc:  0.8737887596899225 val_auprc:  0.9500792034240659
EarlyStopping counter: 13 out of 50
epoch:  72
epoch:  73 val_f1:  0.794309372388086 val_auroc:  0.8723352713178294 val_auprc:  0.9498234756644511
EarlyStopping counter: 14 out of 50
epoch:  73
epoch:  74 val_f1:  0.7906801532257888 val_auroc:  0.8737887596899223 val_auprc:  0.9497737615444124
EarlyStopping counter: 15 out of 50
epoch:  74
epoch:  75 val_f1:  0.7892012988311853 val_auroc:  0.8733042635658914 val_auprc:  0.9499490254809011
EarlyStopping counter: 16 out of 50
epoch:  75
epoch:  76 val_f1:  0.7827158008497472 val_auroc:  0.8728197674418605 val_auprc:  0.9498640436151429
EarlyStopping counter: 17 out of 50
epoch:  76
epoch:  77 val_f1:  0.8175531003768415 val_auroc:  0.8694282945736432 val_auprc:  0.9486712492471967
EarlyStopping counter: 18 out of 50
epoch:  77
epoch:  78 val_f1:  0.7952715769842713 val_auroc:  0.8699127906976745 val_auprc:  0.9489756804419823
EarlyStopping counter: 19 out of 50
epoch:  78
epoch:  79 val_f1:  0.7841726618705036 val_auroc:  0.8728197674418605 val_auprc:  0.9498331727588686
EarlyStopping counter: 20 out of 50
epoch:  79
epoch:  80 val_f1:  0.8018807955038493 val_auroc:  0.871124031007752 val_auprc:  0.9492785600406728
EarlyStopping counter: 21 out of 50
epoch:  80
epoch:  81 val_f1:  0.7854893118997625 val_auroc:  0.8733042635658914 val_auprc:  0.9502911381516779
EarlyStopping counter: 22 out of 50
epoch:  81
epoch:  82 val_f1:  0.7811109002295425 val_auroc:  0.8735465116279069 val_auprc:  0.9500484005896113
EarlyStopping counter: 23 out of 50
epoch:  82
epoch:  83 val_f1:  0.7866727894280321 val_auroc:  0.8691860465116279 val_auprc:  0.9485471179959999
EarlyStopping counter: 24 out of 50
epoch:  83
epoch:  84 val_f1:  0.7854893118997625 val_auroc:  0.8708817829457365 val_auprc:  0.9490345534134244
EarlyStopping counter: 25 out of 50
epoch:  84
epoch:  85 val_f1:  0.7854893118997625 val_auroc:  0.872093023255814 val_auprc:  0.9494596977158115
EarlyStopping counter: 26 out of 50
epoch:  85
epoch:  86 val_f1:  0.7906801532257888 val_auroc:  0.8742732558139534 val_auprc:  0.9502460348683739
EarlyStopping counter: 27 out of 50
epoch:  86
epoch:  87 val_f1:  0.7972014141264308 val_auroc:  0.8735465116279069 val_auprc:  0.9501705839709349
EarlyStopping counter: 28 out of 50
epoch:  87
epoch:  88 val_f1:  0.7854893118997625 val_auroc:  0.8713662790697674 val_auprc:  0.9494560824402479
EarlyStopping counter: 29 out of 50
epoch:  88
epoch:  89 val_f1:  0.7906801532257888 val_auroc:  0.8733042635658914 val_auprc:  0.9498082391965168
EarlyStopping counter: 30 out of 50
epoch:  89
epoch:  90 val_f1:  0.7957035068809065 val_auroc:  0.873062015503876 val_auprc:  0.9498795581193518
EarlyStopping counter: 31 out of 50
epoch:  90
epoch:  91 val_f1:  0.7906801532257888 val_auroc:  0.872093023255814 val_auprc:  0.9497159704123224
EarlyStopping counter: 32 out of 50
epoch:  91
epoch:  92 val_f1:  0.7892012988311853 val_auroc:  0.873062015503876 val_auprc:  0.949642658638053
EarlyStopping counter: 33 out of 50
epoch:  92
epoch:  93 val_f1:  0.7906801532257888 val_auroc:  0.8723352713178294 val_auprc:  0.9494479197338102
EarlyStopping counter: 34 out of 50
epoch:  93
epoch:  94 val_f1:  0.7957035068809065 val_auroc:  0.8713662790697676 val_auprc:  0.9492784654832795
EarlyStopping counter: 35 out of 50
epoch:  94
epoch:  95 val_f1:  0.7972014141264308 val_auroc:  0.8733042635658916 val_auprc:  0.9501342013684135
EarlyStopping counter: 36 out of 50
epoch:  95
epoch:  96 val_f1:  0.7666659578740948 val_auroc:  0.8742732558139534 val_auprc:  0.9502376386179687
EarlyStopping counter: 37 out of 50
epoch:  96
epoch:  97 val_f1:  0.792019787311512 val_auroc:  0.8747577519379846 val_auprc:  0.9504238259262787
EarlyStopping counter: 38 out of 50
epoch:  97
epoch:  98 val_f1:  0.7906801532257888 val_auroc:  0.874031007751938 val_auprc:  0.95040532848618
EarlyStopping counter: 39 out of 50
epoch:  98
epoch:  99 val_f1:  0.7957035068809065 val_auroc:  0.874031007751938 val_auprc:  0.9503952311002561
EarlyStopping counter: 40 out of 50
epoch:  99
epoch:  100 val_f1:  0.7906801532257888 val_auroc:  0.8742732558139534 val_auprc:  0.9504259395708309
EarlyStopping counter: 41 out of 50
epoch:  100
epoch:  101 val_f1:  0.7841726618705036 val_auroc:  0.874031007751938 val_auprc:  0.9504867141960444
EarlyStopping counter: 42 out of 50
epoch:  101
epoch:  102 val_f1:  0.7892012988311853 val_auroc:  0.8737887596899225 val_auprc:  0.9506114116652964
EarlyStopping counter: 43 out of 50
epoch:  102
epoch:  103 val_f1:  0.8037391402911035 val_auroc:  0.8742732558139534 val_auprc:  0.9506680887683119
EarlyStopping counter: 44 out of 50
epoch:  103
epoch:  104 val_f1:  0.7972014141264308 val_auroc:  0.8747577519379846 val_auprc:  0.9506560142426329
EarlyStopping counter: 45 out of 50
epoch:  104
epoch:  105 val_f1:  0.7957035068809065 val_auroc:  0.8733042635658914 val_auprc:  0.9500476753419461
EarlyStopping counter: 46 out of 50
epoch:  105
epoch:  106 val_f1:  0.7972014141264308 val_auroc:  0.8757267441860465 val_auprc:  0.9509988974666008
EarlyStopping counter: 47 out of 50
epoch:  106
epoch:  107 val_f1:  0.7957035068809065 val_auroc:  0.875 val_auprc:  0.9508164214159402
EarlyStopping counter: 48 out of 50
epoch:  107
epoch:  108 val_f1:  0.7625825493451395 val_auroc:  0.8752422480620154 val_auprc:  0.9507617364227547
EarlyStopping counter: 49 out of 50
epoch:  108
epoch:  109 val_f1:  0.7952715769842713 val_auroc:  0.8737887596899224 val_auprc:  0.9506105667347173
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  89.17349100112915
{'time_elapsed': [89.17349100112915], 'epoch': [108], 'fold': [3], 'f1_train': [0.9964023900652038], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7952715769842713], 'auroc_test': [0.8737887596899224], 'auprc_test': [0.9506105667347173]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 256]            1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 256]            512
│    └─Tanh: 2-3                         [64, 256, 256]            --
│    └─MaxPool1d: 2-4                    [64, 256, 51]             --
│    └─Dropout: 2-5                      [64, 256, 51]             --
│    └─Flatten: 2-6                      [64, 13056]               --
│    └─Linear: 2-7                       [64, 1]                   13,057
==========================================================================================
Total params: 15,105
Trainable params: 15,105
Non-trainable params: 0
Total mult-adds (M): 26.03
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 67.11
Params size (MB): 0.06
Estimated Total Size (MB): 67.50
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5707915273132664 val_auroc:  0.6512896825396826 val_auprc:  0.7527109314662477
epoch:  1
epoch:  2 val_f1:  0.20090909090909093 val_auroc:  0.8023313492063492 val_auprc:  0.9105649771570021
Validation loss improved to 1.226799
epoch:  2
epoch:  3 val_f1:  0.6667537102319712 val_auroc:  0.8206845238095237 val_auprc:  0.916578454031188
Validation loss improved to 1.157632
epoch:  3
epoch:  4 val_f1:  0.7425559947299077 val_auroc:  0.8330853174603174 val_auprc:  0.922491032821886
Validation loss improved to 1.102445
epoch:  4
epoch:  5 val_f1:  0.7697938448700337 val_auroc:  0.8427579365079365 val_auprc:  0.9255627338568767
Validation loss improved to 1.078552
epoch:  5
epoch:  6 val_f1:  0.74930078820239 val_auroc:  0.8559027777777777 val_auprc:  0.930715272717641
Validation loss improved to 1.057570
epoch:  6
epoch:  7 val_f1:  0.734169453734671 val_auroc:  0.8635912698412699 val_auprc:  0.9339020217823819
Validation loss improved to 1.040508
epoch:  7
epoch:  8 val_f1:  0.8182185828242006 val_auroc:  0.8720238095238095 val_auprc:  0.9363100280221243
Validation loss improved to 1.034872
epoch:  8
epoch:  9 val_f1:  0.719524951171423 val_auroc:  0.8742559523809522 val_auprc:  0.9375027102813589
Validation loss improved to 1.006677
epoch:  9
epoch:  10 val_f1:  0.8138718358422335 val_auroc:  0.8777281746031746 val_auprc:  0.9388435255533937
Validation loss improved to 0.995901
epoch:  10
epoch:  11 val_f1:  0.7703937955759801 val_auroc:  0.8792162698412699 val_auprc:  0.9395940954210495
Validation loss improved to 0.966949
epoch:  11
epoch:  12 val_f1:  0.8138718358422335 val_auroc:  0.876736111111111 val_auprc:  0.9383602937754125
Validation loss improved to 0.963305
epoch:  12
epoch:  13 val_f1:  0.7703937955759801 val_auroc:  0.8809523809523809 val_auprc:  0.9405029799083319
Validation loss improved to 0.933723
epoch:  13
epoch:  14 val_f1:  0.7773608267060336 val_auroc:  0.8804563492063492 val_auprc:  0.9404105240482591
Validation loss improved to 0.924705
epoch:  14
epoch:  15 val_f1:  0.7988956640912072 val_auroc:  0.8764880952380952 val_auprc:  0.938403382121052
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.79396185483142 val_auroc:  0.8779761904761905 val_auprc:  0.9392787732667344
Validation loss improved to 0.906303
epoch:  16
epoch:  17 val_f1:  0.7773176903611687 val_auroc:  0.8802083333333334 val_auprc:  0.9406709133652496
Validation loss improved to 0.883509
epoch:  17
epoch:  18 val_f1:  0.8205262448141007 val_auroc:  0.8787202380952381 val_auprc:  0.9401411757930841
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7702983104477182 val_auroc:  0.8774801587301587 val_auprc:  0.9408480898533926
Validation loss improved to 0.862781
epoch:  19
epoch:  20 val_f1:  0.7773176903611687 val_auroc:  0.876984126984127 val_auprc:  0.9407198269700408
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.8061683443992288 val_auroc:  0.8745039682539681 val_auprc:  0.9387217259454924
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7837457330597287 val_auroc:  0.876736111111111 val_auprc:  0.9404494412616256
Validation loss improved to 0.840093
epoch:  22
epoch:  23 val_f1:  0.8081713820844254 val_auroc:  0.875 val_auprc:  0.9396767940201842
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7837457330597287 val_auroc:  0.876984126984127 val_auprc:  0.9406801249183518
Validation loss improved to 0.828950
epoch:  24
epoch:  25 val_f1:  0.7765822970867508 val_auroc:  0.876984126984127 val_auprc:  0.9408769640113107
Validation loss improved to 0.824824
epoch:  25
epoch:  26 val_f1:  0.7875799991742021 val_auroc:  0.8735119047619048 val_auprc:  0.9387172556954649
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7905411014849827 val_auroc:  0.8787202380952381 val_auprc:  0.9411239659238861
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.770099160945843 val_auroc:  0.882936507936508 val_auprc:  0.9435625850859367
Validation loss improved to 0.812164
epoch:  28
epoch:  29 val_f1:  0.8030193236714975 val_auroc:  0.880704365079365 val_auprc:  0.942596462299528
Validation loss improved to 0.809031
epoch:  29
epoch:  30 val_f1:  0.7875799991742021 val_auroc:  0.876736111111111 val_auprc:  0.9401767740171845
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.8164398044139025 val_auroc:  0.8802083333333333 val_auprc:  0.9426538230425997
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.8156899810964081 val_auroc:  0.8782242063492064 val_auprc:  0.9410884942768278
EarlyStopping counter: 3 out of 50
epoch:  32
epoch:  33 val_f1:  0.7968706966496207 val_auroc:  0.8812003968253967 val_auprc:  0.9437625095171057
Validation loss improved to 0.800140
epoch:  33
epoch:  34 val_f1:  0.8081713820844254 val_auroc:  0.8772321428571429 val_auprc:  0.9416313554684532
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.7875799991742021 val_auroc:  0.8749999999999999 val_auprc:  0.9408771717181086
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.8164398044139025 val_auroc:  0.878968253968254 val_auprc:  0.9428584945920153
EarlyStopping counter: 3 out of 50
epoch:  36
epoch:  37 val_f1:  0.7995542847531747 val_auroc:  0.8777281746031745 val_auprc:  0.9424077599225787
EarlyStopping counter: 4 out of 50
epoch:  37
epoch:  38 val_f1:  0.8030193236714975 val_auroc:  0.8779761904761904 val_auprc:  0.941815933201444
EarlyStopping counter: 5 out of 50
epoch:  38
epoch:  39 val_f1:  0.7765822970867508 val_auroc:  0.8787202380952381 val_auprc:  0.9429311225557009
Validation loss improved to 0.790615
epoch:  39
epoch:  40 val_f1:  0.7905411014849827 val_auroc:  0.8754960317460319 val_auprc:  0.9408582339644451
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.8030193236714975 val_auroc:  0.8777281746031746 val_auprc:  0.9427782427855973
EarlyStopping counter: 2 out of 50
epoch:  41
epoch:  42 val_f1:  0.756376995929398 val_auroc:  0.8777281746031746 val_auprc:  0.9429321446996437
EarlyStopping counter: 3 out of 50
epoch:  42
epoch:  43 val_f1:  0.8030193236714975 val_auroc:  0.8769841269841271 val_auprc:  0.9417291054577116
EarlyStopping counter: 4 out of 50
epoch:  43
epoch:  44 val_f1:  0.7861608411480533 val_auroc:  0.8591269841269842 val_auprc:  0.9316191760662837
EarlyStopping counter: 5 out of 50
epoch:  44
epoch:  45 val_f1:  0.79396185483142 val_auroc:  0.8707837301587301 val_auprc:  0.9375601870162352
EarlyStopping counter: 6 out of 50
epoch:  45
epoch:  46 val_f1:  0.7895875497243353 val_auroc:  0.8757440476190477 val_auprc:  0.941657354583673
EarlyStopping counter: 7 out of 50
epoch:  46
epoch:  47 val_f1:  0.7956729455237178 val_auroc:  0.873015873015873 val_auprc:  0.9400770108746839
EarlyStopping counter: 8 out of 50
epoch:  47
epoch:  48 val_f1:  0.792371879328401 val_auroc:  0.871031746031746 val_auprc:  0.9389867368321497
EarlyStopping counter: 9 out of 50
epoch:  48
epoch:  49 val_f1:  0.7929485957015485 val_auroc:  0.8752480158730159 val_auprc:  0.9422942689899159
EarlyStopping counter: 10 out of 50
epoch:  49
epoch:  50 val_f1:  0.7929485957015485 val_auroc:  0.8754960317460319 val_auprc:  0.9415959930685363
EarlyStopping counter: 11 out of 50
epoch:  50
epoch:  51 val_f1:  0.800639197204071 val_auroc:  0.8705357142857144 val_auprc:  0.9387619100190945
EarlyStopping counter: 12 out of 50
epoch:  51
epoch:  52 val_f1:  0.8061683443992288 val_auroc:  0.8745039682539681 val_auprc:  0.9412445024090634
EarlyStopping counter: 13 out of 50
epoch:  52
epoch:  53 val_f1:  0.7969889682024659 val_auroc:  0.8678075396825397 val_auprc:  0.9375562371003483
EarlyStopping counter: 14 out of 50
epoch:  53
epoch:  54 val_f1:  0.7815416513900654 val_auroc:  0.8779761904761905 val_auprc:  0.9429069690005838
EarlyStopping counter: 15 out of 50
epoch:  54
epoch:  55 val_f1:  0.7929485957015485 val_auroc:  0.8764880952380952 val_auprc:  0.9422028134353018
EarlyStopping counter: 16 out of 50
epoch:  55
epoch:  56 val_f1:  0.8168793096329329 val_auroc:  0.8764880952380952 val_auprc:  0.9417730649353421
EarlyStopping counter: 17 out of 50
epoch:  56
epoch:  57 val_f1:  0.8088065661047027 val_auroc:  0.876984126984127 val_auprc:  0.9416148734958193
EarlyStopping counter: 18 out of 50
epoch:  57
epoch:  58 val_f1:  0.8194319840387783 val_auroc:  0.8762400793650794 val_auprc:  0.9413981927994008
EarlyStopping counter: 19 out of 50
epoch:  58
epoch:  59 val_f1:  0.7995542847531747 val_auroc:  0.8789682539682538 val_auprc:  0.9426906200614955
EarlyStopping counter: 20 out of 50
epoch:  59
epoch:  60 val_f1:  0.8220330394243437 val_auroc:  0.8774801587301587 val_auprc:  0.9418664760930062
EarlyStopping counter: 21 out of 50
epoch:  60
epoch:  61 val_f1:  0.8120268224096906 val_auroc:  0.8717757936507936 val_auprc:  0.9396617519166891
EarlyStopping counter: 22 out of 50
epoch:  61
epoch:  62 val_f1:  0.7863487611033193 val_auroc:  0.878968253968254 val_auprc:  0.9426590373894288
EarlyStopping counter: 23 out of 50
epoch:  62
epoch:  63 val_f1:  0.8154066640778435 val_auroc:  0.8784722222222222 val_auprc:  0.9429266096338187
EarlyStopping counter: 24 out of 50
epoch:  63
epoch:  64 val_f1:  0.8137922815659323 val_auroc:  0.8745039682539683 val_auprc:  0.940935386555677
EarlyStopping counter: 25 out of 50
epoch:  64
epoch:  65 val_f1:  0.8220330394243437 val_auroc:  0.8774801587301587 val_auprc:  0.9420796694699254
EarlyStopping counter: 26 out of 50
epoch:  65
epoch:  66 val_f1:  0.8137922815659323 val_auroc:  0.8767361111111112 val_auprc:  0.9422320456665573
EarlyStopping counter: 27 out of 50
epoch:  66
epoch:  67 val_f1:  0.8137922815659323 val_auroc:  0.8762400793650794 val_auprc:  0.9420970762764306
EarlyStopping counter: 28 out of 50
epoch:  67
epoch:  68 val_f1:  0.7740797592786492 val_auroc:  0.8812003968253969 val_auprc:  0.9439490461120503
EarlyStopping counter: 29 out of 50
epoch:  68
epoch:  69 val_f1:  0.8137922815659323 val_auroc:  0.8772321428571429 val_auprc:  0.9421753982064679
EarlyStopping counter: 30 out of 50
epoch:  69
epoch:  70 val_f1:  0.8137922815659323 val_auroc:  0.8762400793650794 val_auprc:  0.9416876092773565
EarlyStopping counter: 31 out of 50
epoch:  70
epoch:  71 val_f1:  0.8154066640778435 val_auroc:  0.8792162698412699 val_auprc:  0.9432109877125368
EarlyStopping counter: 32 out of 50
epoch:  71
epoch:  72 val_f1:  0.8182185828242006 val_auroc:  0.878968253968254 val_auprc:  0.9432013921438235
EarlyStopping counter: 33 out of 50
epoch:  72
epoch:  73 val_f1:  0.820411899313501 val_auroc:  0.8782242063492063 val_auprc:  0.9427585893147674
EarlyStopping counter: 34 out of 50
epoch:  73
epoch:  74 val_f1:  0.8137922815659323 val_auroc:  0.8774801587301587 val_auprc:  0.9424246605202407
EarlyStopping counter: 35 out of 50
epoch:  74
epoch:  75 val_f1:  0.8235137533274179 val_auroc:  0.8804563492063492 val_auprc:  0.9437530833184886
EarlyStopping counter: 36 out of 50
epoch:  75
epoch:  76 val_f1:  0.8115942028985508 val_auroc:  0.8807043650793651 val_auprc:  0.9440934003428548
EarlyStopping counter: 37 out of 50
epoch:  76
epoch:  77 val_f1:  0.8168793096329329 val_auroc:  0.8802083333333334 val_auprc:  0.9438020611160756
EarlyStopping counter: 38 out of 50
epoch:  77
epoch:  78 val_f1:  0.820411899313501 val_auroc:  0.8759920634920634 val_auprc:  0.9414727228976278
EarlyStopping counter: 39 out of 50
epoch:  78
epoch:  79 val_f1:  0.8102677351291666 val_auroc:  0.8821924603174603 val_auprc:  0.9445413590845637
EarlyStopping counter: 40 out of 50
epoch:  79
epoch:  80 val_f1:  0.820411899313501 val_auroc:  0.8759920634920635 val_auprc:  0.9411748368860714
EarlyStopping counter: 41 out of 50
epoch:  80
epoch:  81 val_f1:  0.820411899313501 val_auroc:  0.8747519841269841 val_auprc:  0.9407536043304288
EarlyStopping counter: 42 out of 50
epoch:  81
epoch:  82 val_f1:  0.8137922815659323 val_auroc:  0.8804563492063492 val_auprc:  0.9441151206194296
EarlyStopping counter: 43 out of 50
epoch:  82
epoch:  83 val_f1:  0.7797523275784146 val_auroc:  0.8844246031746031 val_auprc:  0.9454547463222953
EarlyStopping counter: 44 out of 50
epoch:  83
epoch:  84 val_f1:  0.8088065661047027 val_auroc:  0.8831845238095238 val_auprc:  0.9449332738667833
EarlyStopping counter: 45 out of 50
epoch:  84
epoch:  85 val_f1:  0.820411899313501 val_auroc:  0.8784722222222222 val_auprc:  0.9429353086992777
EarlyStopping counter: 46 out of 50
epoch:  85
epoch:  86 val_f1:  0.8022296544035674 val_auroc:  0.8809523809523809 val_auprc:  0.9441976902707081
EarlyStopping counter: 47 out of 50
epoch:  86
epoch:  87 val_f1:  0.8102677351291666 val_auroc:  0.8846726190476191 val_auprc:  0.9455086539876735
EarlyStopping counter: 48 out of 50
epoch:  87
epoch:  88 val_f1:  0.820411899313501 val_auroc:  0.8799603174603176 val_auprc:  0.943890632372852
EarlyStopping counter: 49 out of 50
epoch:  88
epoch:  89 val_f1:  0.8102677351291666 val_auroc:  0.882688492063492 val_auprc:  0.9451515216653316
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  71.27280831336975
{'time_elapsed': [71.27280831336975], 'epoch': [88], 'fold': [4], 'f1_train': [0.9874803450703525], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8102677351291666], 'auroc_test': [0.882688492063492], 'auprc_test': [0.9451515216653316]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 256, 256]            1,536
│    └─BatchNorm1d: 2-2                  [64, 256, 256]            512
│    └─Tanh: 2-3                         [64, 256, 256]            --
│    └─MaxPool1d: 2-4                    [64, 256, 51]             --
│    └─Dropout: 2-5                      [64, 256, 51]             --
│    └─Flatten: 2-6                      [64, 13056]               --
│    └─Linear: 2-7                       [64, 1]                   13,057
==========================================================================================
Total params: 15,105
Trainable params: 15,105
Non-trainable params: 0
Total mult-adds (M): 26.03
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 67.11
Params size (MB): 0.06
Estimated Total Size (MB): 67.50
==========================================================================================
