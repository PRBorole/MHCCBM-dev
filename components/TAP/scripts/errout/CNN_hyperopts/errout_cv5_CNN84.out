config:  {'project': 'MHCCBM', 'name': 'CNN_84', 'config': {'hidden_channels': [128], 'epochs': 500, 'kernel_size': 5, 'pool_kernel_size': 5, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5476795589492214 val_auroc:  0.6659302896416298 val_auprc:  0.7689848002997677
epoch:  1
epoch:  2 val_f1:  0.566623624177581 val_auroc:  0.6966126656848307 val_auprc:  0.8434269556785429
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.7094198370570532 val_auroc:  0.7221404025527737 val_auprc:  0.863763688613612
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5492496824096865 val_auroc:  0.7601865488463427 val_auprc:  0.8856955703440637
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6451024231755431 val_auroc:  0.7714776632302405 val_auprc:  0.8963908275812714
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6756372438556401 val_auroc:  0.7741777123220422 val_auprc:  0.8993196262104964
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.7362024088594293 val_auroc:  0.7896416298478155 val_auprc:  0.908756789753566
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.7375047745919104 val_auroc:  0.8043691703485518 val_auprc:  0.9157227343814589
Validation loss improved to 0.632487
epoch:  8
epoch:  9 val_f1:  0.7477455593342162 val_auroc:  0.8082965144820815 val_auprc:  0.9173213120385189
Validation loss improved to 0.612645
epoch:  9
epoch:  10 val_f1:  0.7542604103291037 val_auroc:  0.8055964653902798 val_auprc:  0.9146692283677323
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.7626195746699344 val_auroc:  0.8097692685321551 val_auprc:  0.9162521885518401
EarlyStopping counter: 2 out of 50
epoch:  11
epoch:  12 val_f1:  0.7371937993371881 val_auroc:  0.819833087874325 val_auprc:  0.9203188534727986
EarlyStopping counter: 3 out of 50
epoch:  12
epoch:  13 val_f1:  0.751502327549725 val_auroc:  0.8269513991163476 val_auprc:  0.9275221252484619
Validation loss improved to 0.578510
epoch:  13
epoch:  14 val_f1:  0.7737843767539161 val_auroc:  0.8136966126656848 val_auprc:  0.9169489296589319
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.7583800901862243 val_auroc:  0.8124693176239568 val_auprc:  0.9169263885543726
EarlyStopping counter: 2 out of 50
epoch:  15
epoch:  16 val_f1:  0.7442757932382417 val_auroc:  0.8333333333333333 val_auprc:  0.9296433664130587
Validation loss improved to 0.551156
epoch:  16
epoch:  17 val_f1:  0.7823449348629204 val_auroc:  0.8252331860579283 val_auprc:  0.9244189137166834
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.770628190185282 val_auroc:  0.8298969072164949 val_auprc:  0.9270507756676152
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7648187281552264 val_auroc:  0.82793323514973 val_auprc:  0.9267544212817453
EarlyStopping counter: 3 out of 50
epoch:  19
epoch:  20 val_f1:  0.702570289683208 val_auroc:  0.8370152184585176 val_auprc:  0.9322261145127986
Validation loss improved to 0.545902
epoch:  20
epoch:  21 val_f1:  0.7307708780682615 val_auroc:  0.8411880216003929 val_auprc:  0.9347393649377951
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7791090204759269 val_auroc:  0.8107511045655376 val_auprc:  0.9129561781200648
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.7834737923946559 val_auroc:  0.8227785959744722 val_auprc:  0.920099161195209
EarlyStopping counter: 3 out of 50
epoch:  23
epoch:  24 val_f1:  0.7226117839905292 val_auroc:  0.8478154148257242 val_auprc:  0.9367796130918976
EarlyStopping counter: 4 out of 50
epoch:  24
epoch:  25 val_f1:  0.7765831291011147 val_auroc:  0.8244968090328916 val_auprc:  0.9207655855032042
EarlyStopping counter: 5 out of 50
epoch:  25
epoch:  26 val_f1:  0.7985611510791367 val_auroc:  0.8217967599410899 val_auprc:  0.9202921011405895
EarlyStopping counter: 6 out of 50
epoch:  26
epoch:  27 val_f1:  0.7985611510791367 val_auroc:  0.8274423171330388 val_auprc:  0.9241084074930365
EarlyStopping counter: 7 out of 50
epoch:  27
epoch:  28 val_f1:  0.7777125328082551 val_auroc:  0.82793323514973 val_auprc:  0.9264933060169831
EarlyStopping counter: 8 out of 50
epoch:  28
epoch:  29 val_f1:  0.8045102379634754 val_auroc:  0.8306332842415317 val_auprc:  0.9274672780282965
EarlyStopping counter: 9 out of 50
epoch:  29
epoch:  30 val_f1:  0.7845295119922345 val_auroc:  0.833578792341679 val_auprc:  0.9299105432602601
EarlyStopping counter: 10 out of 50
epoch:  30
epoch:  31 val_f1:  0.8010188978004199 val_auroc:  0.8222876779577811 val_auprc:  0.921598314862402
EarlyStopping counter: 11 out of 50
epoch:  31
epoch:  32 val_f1:  0.7697841726618705 val_auroc:  0.8274423171330388 val_auprc:  0.925186440724175
EarlyStopping counter: 12 out of 50
epoch:  32
epoch:  33 val_f1:  0.7445203699313053 val_auroc:  0.8259695630829652 val_auprc:  0.924296207272459
EarlyStopping counter: 13 out of 50
epoch:  33
epoch:  34 val_f1:  0.7954863587533922 val_auroc:  0.8279332351497299 val_auprc:  0.925509097969228
EarlyStopping counter: 14 out of 50
epoch:  34
epoch:  35 val_f1:  0.7727225509205256 val_auroc:  0.8348060873834069 val_auprc:  0.9291193742458805
EarlyStopping counter: 15 out of 50
epoch:  35
epoch:  36 val_f1:  0.7963871971298289 val_auroc:  0.8308787432498773 val_auprc:  0.9268803497596148
EarlyStopping counter: 16 out of 50
epoch:  36
epoch:  37 val_f1:  0.7762067639678805 val_auroc:  0.8230240549828179 val_auprc:  0.9213491488047622
EarlyStopping counter: 17 out of 50
epoch:  37
epoch:  38 val_f1:  0.751751326211758 val_auroc:  0.8240058910162004 val_auprc:  0.9222922072913452
EarlyStopping counter: 18 out of 50
epoch:  38
epoch:  39 val_f1:  0.8104294593967373 val_auroc:  0.8286696121747669 val_auprc:  0.9250446868450299
EarlyStopping counter: 19 out of 50
epoch:  39
epoch:  40 val_f1:  0.7772753225990636 val_auroc:  0.8316151202749141 val_auprc:  0.9286547708712014
EarlyStopping counter: 20 out of 50
epoch:  40
epoch:  41 val_f1:  0.7598715939807772 val_auroc:  0.8190967108492883 val_auprc:  0.9188143746180459
EarlyStopping counter: 21 out of 50
epoch:  41
epoch:  42 val_f1:  0.7580594896895918 val_auroc:  0.8274423171330387 val_auprc:  0.925448083623978
EarlyStopping counter: 22 out of 50
epoch:  42
epoch:  43 val_f1:  0.8010188978004199 val_auroc:  0.8208149239077075 val_auprc:  0.9198890745986682
EarlyStopping counter: 23 out of 50
epoch:  43
epoch:  44 val_f1:  0.8086423317204984 val_auroc:  0.8242513500245459 val_auprc:  0.9228999683279395
EarlyStopping counter: 24 out of 50
epoch:  44
epoch:  45 val_f1:  0.7933255489848959 val_auroc:  0.826705940108002 val_auprc:  0.9247824156761593
EarlyStopping counter: 25 out of 50
epoch:  45
epoch:  46 val_f1:  0.8020613296596766 val_auroc:  0.8301423662248404 val_auprc:  0.9265626971970297
EarlyStopping counter: 26 out of 50
epoch:  46
epoch:  47 val_f1:  0.8010188978004199 val_auroc:  0.8244968090328916 val_auprc:  0.9235351760189128
EarlyStopping counter: 27 out of 50
epoch:  47
epoch:  48 val_f1:  0.7944676896257205 val_auroc:  0.826705940108002 val_auprc:  0.9242791215011144
EarlyStopping counter: 28 out of 50
epoch:  48
epoch:  49 val_f1:  0.7897879661118469 val_auroc:  0.8352970054000982 val_auprc:  0.9297518701879008
EarlyStopping counter: 29 out of 50
epoch:  49
epoch:  50 val_f1:  0.7857445835239322 val_auroc:  0.8424153166421207 val_auprc:  0.9347467682406824
EarlyStopping counter: 30 out of 50
epoch:  50
epoch:  51 val_f1:  0.777854660092151 val_auroc:  0.8252331860579284 val_auprc:  0.9232902463008609
EarlyStopping counter: 31 out of 50
epoch:  51
epoch:  52 val_f1:  0.7826417810500232 val_auroc:  0.8193421698576338 val_auprc:  0.9195990339207349
EarlyStopping counter: 32 out of 50
epoch:  52
epoch:  53 val_f1:  0.7809570525397864 val_auroc:  0.8316151202749141 val_auprc:  0.9271327486529392
EarlyStopping counter: 33 out of 50
epoch:  53
epoch:  54 val_f1:  0.7841726618705036 val_auroc:  0.8325969563082966 val_auprc:  0.9284300991057334
EarlyStopping counter: 34 out of 50
epoch:  54
epoch:  55 val_f1:  0.7855581813618873 val_auroc:  0.8284241531664212 val_auprc:  0.9258833995781293
EarlyStopping counter: 35 out of 50
epoch:  55
epoch:  56 val_f1:  0.7643829551743221 val_auroc:  0.8237604320078546 val_auprc:  0.9228648527645618
EarlyStopping counter: 36 out of 50
epoch:  56
epoch:  57 val_f1:  0.7681512331200245 val_auroc:  0.8259695630829652 val_auprc:  0.9246948621271704
EarlyStopping counter: 37 out of 50
epoch:  57
epoch:  58 val_f1:  0.7745465218349855 val_auroc:  0.8274423171330388 val_auprc:  0.9253454519761898
EarlyStopping counter: 38 out of 50
epoch:  58
epoch:  59 val_f1:  0.766354189375772 val_auroc:  0.8217967599410898 val_auprc:  0.9218938447517804
EarlyStopping counter: 39 out of 50
epoch:  59
epoch:  60 val_f1:  0.7855581813618873 val_auroc:  0.8254786450662739 val_auprc:  0.924062111009483
EarlyStopping counter: 40 out of 50
epoch:  60
epoch:  61 val_f1:  0.7712620601193464 val_auroc:  0.8321060382916052 val_auprc:  0.9275994801509271
EarlyStopping counter: 41 out of 50
epoch:  61
epoch:  62 val_f1:  0.7841726618705036 val_auroc:  0.8286696121747668 val_auprc:  0.9258526122585131
EarlyStopping counter: 42 out of 50
epoch:  62
epoch:  63 val_f1:  0.7933255489848959 val_auroc:  0.8242513500245459 val_auprc:  0.9245039916648066
EarlyStopping counter: 43 out of 50
epoch:  63
epoch:  64 val_f1:  0.7841726618705036 val_auroc:  0.825478645066274 val_auprc:  0.9240677911704892
EarlyStopping counter: 44 out of 50
epoch:  64
epoch:  65 val_f1:  0.7697841726618705 val_auroc:  0.8308787432498773 val_auprc:  0.9278149587755462
EarlyStopping counter: 45 out of 50
epoch:  65
epoch:  66 val_f1:  0.7681512331200245 val_auroc:  0.8276877761413843 val_auprc:  0.9254926889609503
EarlyStopping counter: 46 out of 50
epoch:  66
epoch:  67 val_f1:  0.7777125328082551 val_auroc:  0.8254786450662739 val_auprc:  0.9241007755316131
EarlyStopping counter: 47 out of 50
epoch:  67
epoch:  68 val_f1:  0.7855581813618873 val_auroc:  0.8284241531664212 val_auprc:  0.9257721784106225
EarlyStopping counter: 48 out of 50
epoch:  68
epoch:  69 val_f1:  0.7855581813618873 val_auroc:  0.8291605301914581 val_auprc:  0.926249481529742
EarlyStopping counter: 49 out of 50
epoch:  69
epoch:  70 val_f1:  0.7681512331200245 val_auroc:  0.8259695630829652 val_auprc:  0.9245202647537798
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  224.2730107307434
{'time_elapsed': [224.2730107307434], 'epoch': [69], 'fold': [0], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7681512331200245], 'auroc_test': [0.8259695630829652], 'auprc_test': [0.9245202647537798]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1278]           768
│    └─BatchNorm1d: 2-2                  [64, 128, 1278]           256
│    └─Tanh: 2-3                         [64, 128, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1274]           --
│    └─Dropout: 2-5                      [64, 128, 1274]           --
│    └─Flatten: 2-6                      [64, 163072]              --
│    └─Linear: 2-7                       [64, 1]                   163,073
==========================================================================================
Total params: 164,097
Trainable params: 164,097
Non-trainable params: 0
Total mult-adds (M): 73.27
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.51
Params size (MB): 0.66
Estimated Total Size (MB): 168.49
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5109648663605497 val_auroc:  0.6389297987236132 val_auprc:  0.8395906187134556
epoch:  1
epoch:  2 val_f1:  0.5853772378229669 val_auroc:  0.662125675012273 val_auprc:  0.8560913177894282
Validation loss improved to 1.375917
epoch:  2
epoch:  3 val_f1:  0.6794627975876525 val_auroc:  0.6919489445262641 val_auprc:  0.8741041864723199
Validation loss improved to 1.342453
epoch:  3
epoch:  4 val_f1:  0.7011215811505187 val_auroc:  0.7403043691703486 val_auprc:  0.8958134355401866
Validation loss improved to 0.704208
epoch:  4
epoch:  5 val_f1:  0.7337314237416728 val_auroc:  0.8060873834069711 val_auprc:  0.9196388715946998
Validation loss improved to 0.415487
epoch:  5
epoch:  6 val_f1:  0.7685409504908388 val_auroc:  0.8271968581246932 val_auprc:  0.9239152817059004
Validation loss improved to 0.243959
epoch:  6
epoch:  7 val_f1:  0.7826417810500232 val_auroc:  0.826705940108002 val_auprc:  0.9234227948301502
Validation loss improved to 0.199072
epoch:  7
epoch:  8 val_f1:  0.7777125328082551 val_auroc:  0.8276877761413843 val_auprc:  0.9294471041321772
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7169642564307364 val_auroc:  0.8188512518409427 val_auprc:  0.9269026222621373
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.7648576099332736 val_auroc:  0.8188512518409425 val_auprc:  0.9249034887566718
EarlyStopping counter: 3 out of 50
epoch:  10
epoch:  11 val_f1:  0.8086423317204984 val_auroc:  0.8281786941580755 val_auprc:  0.9275451434242796
EarlyStopping counter: 4 out of 50
epoch:  11
epoch:  12 val_f1:  0.7166849710626011 val_auroc:  0.821060382916053 val_auprc:  0.9207620489995013
EarlyStopping counter: 5 out of 50
epoch:  12
epoch:  13 val_f1:  0.7473654218886486 val_auroc:  0.8357879234167894 val_auprc:  0.9286376127088227
EarlyStopping counter: 6 out of 50
epoch:  13
epoch:  14 val_f1:  0.7697841726618705 val_auroc:  0.8291605301914581 val_auprc:  0.9258553817104456
EarlyStopping counter: 7 out of 50
epoch:  14
epoch:  15 val_f1:  0.7897879661118469 val_auroc:  0.8316151202749141 val_auprc:  0.9278256830387244
EarlyStopping counter: 8 out of 50
epoch:  15
epoch:  16 val_f1:  0.7845295119922345 val_auroc:  0.8350515463917526 val_auprc:  0.9273874142479495
EarlyStopping counter: 9 out of 50
epoch:  16
epoch:  17 val_f1:  0.8020613296596766 val_auroc:  0.8316151202749141 val_auprc:  0.9254120784996116
EarlyStopping counter: 10 out of 50
epoch:  17
epoch:  18 val_f1:  0.7770871369605723 val_auroc:  0.8237604320078546 val_auprc:  0.9205568475001096
EarlyStopping counter: 11 out of 50
epoch:  18
epoch:  19 val_f1:  0.8045102379634754 val_auroc:  0.8375061364752087 val_auprc:  0.9290594337030351
EarlyStopping counter: 12 out of 50
epoch:  19
epoch:  20 val_f1:  0.758098723333472 val_auroc:  0.8352970054000982 val_auprc:  0.9276241824518696
EarlyStopping counter: 13 out of 50
epoch:  20
epoch:  21 val_f1:  0.7868059619290214 val_auroc:  0.8330878743249877 val_auprc:  0.9243550269727416
EarlyStopping counter: 14 out of 50
epoch:  21
epoch:  22 val_f1:  0.7685409504908388 val_auroc:  0.8294059891998037 val_auprc:  0.9224835950734095
EarlyStopping counter: 15 out of 50
epoch:  22
epoch:  23 val_f1:  0.757304835743056 val_auroc:  0.8377515954835544 val_auprc:  0.9242398039986028
EarlyStopping counter: 16 out of 50
epoch:  23
epoch:  24 val_f1:  0.7868059619290214 val_auroc:  0.8301423662248405 val_auprc:  0.922570663306288
EarlyStopping counter: 17 out of 50
epoch:  24
epoch:  25 val_f1:  0.7963871971298289 val_auroc:  0.8289150711831125 val_auprc:  0.9218717724776593
EarlyStopping counter: 18 out of 50
epoch:  25
epoch:  26 val_f1:  0.757304835743056 val_auroc:  0.8355424644084438 val_auprc:  0.9236970600964582
EarlyStopping counter: 19 out of 50
epoch:  26
epoch:  27 val_f1:  0.7685409504908388 val_auroc:  0.8338242513500246 val_auprc:  0.9225843422936089
EarlyStopping counter: 20 out of 50
epoch:  27
epoch:  28 val_f1:  0.7955599157038007 val_auroc:  0.8343151693667158 val_auprc:  0.923139129215772
EarlyStopping counter: 21 out of 50
epoch:  28
epoch:  29 val_f1:  0.7762067639678805 val_auroc:  0.8338242513500246 val_auprc:  0.9218741474606955
EarlyStopping counter: 22 out of 50
epoch:  29
epoch:  30 val_f1:  0.757304835743056 val_auroc:  0.8294059891998036 val_auprc:  0.9195687998188464
Validation loss improved to 0.197962
epoch:  30
epoch:  31 val_f1:  0.7873856121514594 val_auroc:  0.8316151202749141 val_auprc:  0.9217324757889066
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.7879228532067962 val_auroc:  0.836033382425135 val_auprc:  0.9231703177278093
EarlyStopping counter: 2 out of 50
epoch:  32
epoch:  33 val_f1:  0.7748796193569787 val_auroc:  0.82793323514973 val_auprc:  0.9181732022449143
Validation loss improved to 0.188168
epoch:  33
epoch:  34 val_f1:  0.7873856121514594 val_auroc:  0.8367697594501718 val_auprc:  0.9234171510137915
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.7890919075230509 val_auroc:  0.8311242022582229 val_auprc:  0.9201778704134923
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.7748796193569787 val_auroc:  0.8257241040746196 val_auprc:  0.9164321797008288
EarlyStopping counter: 3 out of 50
epoch:  36
epoch:  37 val_f1:  0.7712620601193464 val_auroc:  0.8262150220913108 val_auprc:  0.9173142769868596
EarlyStopping counter: 4 out of 50
epoch:  37
epoch:  38 val_f1:  0.7834737923946559 val_auroc:  0.8308787432498773 val_auprc:  0.9190566159591317
EarlyStopping counter: 5 out of 50
epoch:  38
epoch:  39 val_f1:  0.7971323289800215 val_auroc:  0.8296514482081493 val_auprc:  0.9190173322132228
EarlyStopping counter: 6 out of 50
epoch:  39
epoch:  40 val_f1:  0.7545102379634754 val_auroc:  0.8325969563082966 val_auprc:  0.9185196594943775
Validation loss improved to 0.173886
epoch:  40
epoch:  41 val_f1:  0.7955599157038007 val_auroc:  0.8262150220913107 val_auprc:  0.9170759741777337
EarlyStopping counter: 1 out of 50
epoch:  41
epoch:  42 val_f1:  0.7791090204759269 val_auroc:  0.8296514482081493 val_auprc:  0.9186732602594815
EarlyStopping counter: 2 out of 50
epoch:  42
epoch:  43 val_f1:  0.7790721385700611 val_auroc:  0.8294059891998037 val_auprc:  0.9182353978006272
EarlyStopping counter: 3 out of 50
epoch:  43
epoch:  44 val_f1:  0.7607703458551531 val_auroc:  0.8257241040746196 val_auprc:  0.9170415518829453
EarlyStopping counter: 4 out of 50
epoch:  44
epoch:  45 val_f1:  0.7622262794246104 val_auroc:  0.8306332842415317 val_auprc:  0.9187812612479864
EarlyStopping counter: 5 out of 50
epoch:  45
epoch:  46 val_f1:  0.7809570525397864 val_auroc:  0.8262150220913108 val_auprc:  0.917858258951901
EarlyStopping counter: 6 out of 50
epoch:  46
epoch:  47 val_f1:  0.7712620601193464 val_auroc:  0.8296514482081493 val_auprc:  0.9195444272072101
EarlyStopping counter: 7 out of 50
epoch:  47
epoch:  48 val_f1:  0.7873856121514594 val_auroc:  0.8303878252331861 val_auprc:  0.9191103209630911
EarlyStopping counter: 8 out of 50
epoch:  48
epoch:  49 val_f1:  0.7791090204759269 val_auroc:  0.8276877761413844 val_auprc:  0.915225421211527
EarlyStopping counter: 9 out of 50
epoch:  49
epoch:  50 val_f1:  0.742136387976997 val_auroc:  0.8222876779577811 val_auprc:  0.9101377373259716
EarlyStopping counter: 10 out of 50
epoch:  50
epoch:  51 val_f1:  0.7598715939807772 val_auroc:  0.8244968090328916 val_auprc:  0.912573140154128
Validation loss improved to 0.171664
epoch:  51
epoch:  52 val_f1:  0.7791090204759269 val_auroc:  0.8244968090328915 val_auprc:  0.9150041220359911
EarlyStopping counter: 1 out of 50
epoch:  52
epoch:  53 val_f1:  0.7791090204759269 val_auroc:  0.8222876779577811 val_auprc:  0.9122356232709796
EarlyStopping counter: 2 out of 50
epoch:  53
epoch:  54 val_f1:  0.7685409504908388 val_auroc:  0.824251350024546 val_auprc:  0.9120821158818299
EarlyStopping counter: 3 out of 50
epoch:  54
epoch:  55 val_f1:  0.7855581813618873 val_auroc:  0.8195876288659795 val_auprc:  0.9114536536181688
EarlyStopping counter: 4 out of 50
epoch:  55
epoch:  56 val_f1:  0.7809570525397864 val_auroc:  0.8220422189494354 val_auprc:  0.9122381090007414
EarlyStopping counter: 5 out of 50
epoch:  56
epoch:  57 val_f1:  0.7841726618705036 val_auroc:  0.8205694648993618 val_auprc:  0.9130070543434823
EarlyStopping counter: 6 out of 50
epoch:  57
epoch:  58 val_f1:  0.7873856121514594 val_auroc:  0.8217967599410898 val_auprc:  0.91282972343835
EarlyStopping counter: 7 out of 50
epoch:  58
epoch:  59 val_f1:  0.7873856121514594 val_auroc:  0.8203240058910162 val_auprc:  0.9112734045130411
EarlyStopping counter: 8 out of 50
epoch:  59
epoch:  60 val_f1:  0.7483101088021195 val_auroc:  0.821060382916053 val_auprc:  0.9080682773516379
Validation loss improved to 0.151271
epoch:  60
epoch:  61 val_f1:  0.7873856121514594 val_auroc:  0.8220422189494354 val_auprc:  0.910621981126079
EarlyStopping counter: 1 out of 50
epoch:  61
epoch:  62 val_f1:  0.7906450372602754 val_auroc:  0.8200785468826707 val_auprc:  0.911202809049523
EarlyStopping counter: 2 out of 50
epoch:  62
epoch:  63 val_f1:  0.7809570525397864 val_auroc:  0.8225331369661266 val_auprc:  0.9132240037062567
EarlyStopping counter: 3 out of 50
epoch:  63
epoch:  64 val_f1:  0.7873856121514594 val_auroc:  0.8225331369661267 val_auprc:  0.9133009019581667
EarlyStopping counter: 4 out of 50
epoch:  64
epoch:  65 val_f1:  0.7777125328082551 val_auroc:  0.8186057928325969 val_auprc:  0.9121407543145152
EarlyStopping counter: 5 out of 50
epoch:  65
epoch:  66 val_f1:  0.7510724063582411 val_auroc:  0.8186057928325969 val_auprc:  0.9073121551416233
EarlyStopping counter: 6 out of 50
epoch:  66
epoch:  67 val_f1:  0.757304835743056 val_auroc:  0.814923907707413 val_auprc:  0.9055800594659731
EarlyStopping counter: 7 out of 50
epoch:  67
epoch:  68 val_f1:  0.7598715939807772 val_auroc:  0.822287677957781 val_auprc:  0.9095376353399003
Validation loss improved to 0.145123
epoch:  68
epoch:  69 val_f1:  0.7791090204759269 val_auroc:  0.8173784977908689 val_auprc:  0.9084607218542435
EarlyStopping counter: 1 out of 50
epoch:  69
epoch:  70 val_f1:  0.7791090204759269 val_auroc:  0.8166421207658321 val_auprc:  0.9056592097521747
EarlyStopping counter: 2 out of 50
epoch:  70
epoch:  71 val_f1:  0.7622262794246104 val_auroc:  0.8171330387825233 val_auprc:  0.9062577707673618
EarlyStopping counter: 3 out of 50
epoch:  71
epoch:  72 val_f1:  0.7598715939807772 val_auroc:  0.8193421698576338 val_auprc:  0.9063687846499071
EarlyStopping counter: 4 out of 50
epoch:  72
epoch:  73 val_f1:  0.7791090204759269 val_auroc:  0.8203240058910162 val_auprc:  0.9071526717941991
EarlyStopping counter: 5 out of 50
epoch:  73
epoch:  74 val_f1:  0.7873856121514594 val_auroc:  0.8154148257241041 val_auprc:  0.9042163137096483
EarlyStopping counter: 6 out of 50
epoch:  74
epoch:  75 val_f1:  0.7873856121514594 val_auroc:  0.8203240058910163 val_auprc:  0.9100853085359318
EarlyStopping counter: 7 out of 50
epoch:  75
epoch:  76 val_f1:  0.7971323289800215 val_auroc:  0.8188512518409425 val_auprc:  0.9106729790829027
EarlyStopping counter: 8 out of 50
epoch:  76
epoch:  77 val_f1:  0.7906450372602754 val_auroc:  0.8171330387825233 val_auprc:  0.9084990797998088
EarlyStopping counter: 9 out of 50
epoch:  77
epoch:  78 val_f1:  0.7826417810500232 val_auroc:  0.8187285223367697 val_auprc:  0.9091652932807425
EarlyStopping counter: 10 out of 50
epoch:  78
epoch:  79 val_f1:  0.7890919075230509 val_auroc:  0.8173784977908689 val_auprc:  0.9067535872874717
EarlyStopping counter: 11 out of 50
epoch:  79
epoch:  80 val_f1:  0.7873856121514594 val_auroc:  0.8188512518409427 val_auprc:  0.9079099947045961
EarlyStopping counter: 12 out of 50
epoch:  80
epoch:  81 val_f1:  0.7791090204759269 val_auroc:  0.8166421207658322 val_auprc:  0.9059958962702781
EarlyStopping counter: 13 out of 50
epoch:  81
epoch:  82 val_f1:  0.7622262794246104 val_auroc:  0.8125920471281297 val_auprc:  0.8985392824505404
EarlyStopping counter: 14 out of 50
epoch:  82
epoch:  83 val_f1:  0.7707245329923307 val_auroc:  0.8166421207658321 val_auprc:  0.9034514177794726
EarlyStopping counter: 15 out of 50
epoch:  83
epoch:  84 val_f1:  0.7707245329923307 val_auroc:  0.8155375552282769 val_auprc:  0.9026098546288593
EarlyStopping counter: 16 out of 50
epoch:  84
epoch:  85 val_f1:  0.7707245329923307 val_auroc:  0.8160284732449681 val_auprc:  0.9027006855130558
EarlyStopping counter: 17 out of 50
epoch:  85
epoch:  86 val_f1:  0.7707245329923307 val_auroc:  0.8163966617574865 val_auprc:  0.9032265782891465
EarlyStopping counter: 18 out of 50
epoch:  86
epoch:  87 val_f1:  0.7791090204759269 val_auroc:  0.8166421207658322 val_auprc:  0.902245476509403
EarlyStopping counter: 19 out of 50
epoch:  87
epoch:  88 val_f1:  0.7791090204759269 val_auroc:  0.816151202749141 val_auprc:  0.9024917986273036
EarlyStopping counter: 20 out of 50
epoch:  88
epoch:  89 val_f1:  0.7873856121514594 val_auroc:  0.8161512027491409 val_auprc:  0.9020029804183503
EarlyStopping counter: 21 out of 50
epoch:  89
epoch:  90 val_f1:  0.7791090204759269 val_auroc:  0.8168875797741778 val_auprc:  0.9033187927723287
EarlyStopping counter: 22 out of 50
epoch:  90
epoch:  91 val_f1:  0.7791090204759269 val_auroc:  0.8156602847324497 val_auprc:  0.9020180593201403
EarlyStopping counter: 23 out of 50
epoch:  91
epoch:  92 val_f1:  0.7873856121514594 val_auroc:  0.8156602847324497 val_auprc:  0.9029257475124489
EarlyStopping counter: 24 out of 50
epoch:  92
epoch:  93 val_f1:  0.7955599157038007 val_auroc:  0.8166421207658321 val_auprc:  0.9042472566062288
EarlyStopping counter: 25 out of 50
epoch:  93
epoch:  94 val_f1:  0.7622262794246104 val_auroc:  0.8173784977908689 val_auprc:  0.9023415336993484
EarlyStopping counter: 26 out of 50
epoch:  94
epoch:  95 val_f1:  0.7536081085870222 val_auroc:  0.8156602847324498 val_auprc:  0.9003819855498805
EarlyStopping counter: 27 out of 50
epoch:  95
epoch:  96 val_f1:  0.7707245329923307 val_auroc:  0.8181148748159057 val_auprc:  0.9023136708640596
EarlyStopping counter: 28 out of 50
epoch:  96
epoch:  97 val_f1:  0.7707245329923307 val_auroc:  0.8178694158075601 val_auprc:  0.9024304517781774
EarlyStopping counter: 29 out of 50
epoch:  97
epoch:  98 val_f1:  0.7536081085870222 val_auroc:  0.8162739322533138 val_auprc:  0.9013047504155399
EarlyStopping counter: 30 out of 50
epoch:  98
epoch:  99 val_f1:  0.7791090204759269 val_auroc:  0.8166421207658321 val_auprc:  0.9025006148063905
EarlyStopping counter: 31 out of 50
epoch:  99
epoch:  100 val_f1:  0.7791090204759269 val_auroc:  0.8168875797741777 val_auprc:  0.9019103678096771
EarlyStopping counter: 32 out of 50
epoch:  100
epoch:  101 val_f1:  0.7791090204759269 val_auroc:  0.814923907707413 val_auprc:  0.9012248854804913
EarlyStopping counter: 33 out of 50
epoch:  101
epoch:  102 val_f1:  0.7791090204759269 val_auroc:  0.8159057437407953 val_auprc:  0.9015848975049865
EarlyStopping counter: 34 out of 50
epoch:  102
epoch:  103 val_f1:  0.7791090204759269 val_auroc:  0.8166421207658321 val_auprc:  0.902236718496361
EarlyStopping counter: 35 out of 50
epoch:  103
epoch:  104 val_f1:  0.7791090204759269 val_auroc:  0.8154148257241041 val_auprc:  0.9018009203732728
EarlyStopping counter: 36 out of 50
epoch:  104
epoch:  105 val_f1:  0.7791090204759269 val_auroc:  0.8163966617574865 val_auprc:  0.9019839185098806
EarlyStopping counter: 37 out of 50
epoch:  105
epoch:  106 val_f1:  0.742136387976997 val_auroc:  0.8184830633284242 val_auprc:  0.9021018109735472
EarlyStopping counter: 38 out of 50
epoch:  106
epoch:  107 val_f1:  0.7536081085870222 val_auroc:  0.8157830142366226 val_auprc:  0.9020139885991678
EarlyStopping counter: 39 out of 50
epoch:  107
epoch:  108 val_f1:  0.7791090204759269 val_auroc:  0.8146784486990672 val_auprc:  0.9012357928373917
EarlyStopping counter: 40 out of 50
epoch:  108
epoch:  109 val_f1:  0.7955599157038007 val_auroc:  0.8140648011782032 val_auprc:  0.9013755385136333
EarlyStopping counter: 41 out of 50
epoch:  109
epoch:  110 val_f1:  0.7791090204759269 val_auroc:  0.8124693176239568 val_auprc:  0.8999735254237604
EarlyStopping counter: 42 out of 50
epoch:  110
epoch:  111 val_f1:  0.7955599157038007 val_auroc:  0.8145557191948944 val_auprc:  0.9016618292866244
EarlyStopping counter: 43 out of 50
epoch:  111
epoch:  112 val_f1:  0.7791090204759269 val_auroc:  0.8160284732449681 val_auprc:  0.9023610035506131
EarlyStopping counter: 44 out of 50
epoch:  112
epoch:  113 val_f1:  0.7791090204759269 val_auroc:  0.8151693667157585 val_auprc:  0.9011761276227711
EarlyStopping counter: 45 out of 50
epoch:  113
epoch:  114 val_f1:  0.7920536597238516 val_auroc:  0.812960235640648 val_auprc:  0.9029893727049156
EarlyStopping counter: 46 out of 50
epoch:  114
epoch:  115 val_f1:  0.7791090204759269 val_auroc:  0.8151693667157585 val_auprc:  0.9007516945469612
EarlyStopping counter: 47 out of 50
epoch:  115
epoch:  116 val_f1:  0.7791090204759269 val_auroc:  0.8143102601865488 val_auprc:  0.9015072656700229
EarlyStopping counter: 48 out of 50
epoch:  116
epoch:  117 val_f1:  0.7890919075230509 val_auroc:  0.8146784486990674 val_auprc:  0.9031555051081274
EarlyStopping counter: 49 out of 50
epoch:  117
epoch:  118 val_f1:  0.7791090204759269 val_auroc:  0.815537555228277 val_auprc:  0.9030981718023865
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  368.02112007141113
{'time_elapsed': [368.02112007141113], 'epoch': [117], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7791090204759269], 'auroc_test': [0.815537555228277], 'auprc_test': [0.9030981718023865]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1278]           768
│    └─BatchNorm1d: 2-2                  [64, 128, 1278]           256
│    └─Tanh: 2-3                         [64, 128, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1274]           --
│    └─Dropout: 2-5                      [64, 128, 1274]           --
│    └─Flatten: 2-6                      [64, 163072]              --
│    └─Linear: 2-7                       [64, 1]                   163,073
==========================================================================================
Total params: 164,097
Trainable params: 164,097
Non-trainable params: 0
Total mult-adds (M): 73.27
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.51
Params size (MB): 0.66
Estimated Total Size (MB): 168.49
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.5616102110947472 val_auprc:  0.772269136135775
epoch:  1
epoch:  2 val_f1:  0.577053361198059 val_auroc:  0.5930289641629848 val_auprc:  0.8052455976734791
Validation loss improved to 1.456508
epoch:  2
epoch:  3 val_f1:  0.42800045677743515 val_auroc:  0.5942562592047128 val_auprc:  0.8028781757052427
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.6218150089871936 val_auroc:  0.6395434462444772 val_auprc:  0.8340902154316193
Validation loss improved to 0.836254
epoch:  4
epoch:  5 val_f1:  0.6022355762448864 val_auroc:  0.6804123711340205 val_auprc:  0.8485786221986457
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.6385973188662184 val_auroc:  0.7218949435444281 val_auprc:  0.8664909368413225
Validation loss improved to 0.670143
epoch:  6
epoch:  7 val_f1:  0.661834573381412 val_auroc:  0.7525773195876289 val_auprc:  0.8793222330025601
Validation loss improved to 0.516017
epoch:  7
epoch:  8 val_f1:  0.76000113614692 val_auroc:  0.7658321060382917 val_auprc:  0.8830761577125615
Validation loss improved to 0.459479
epoch:  8
epoch:  9 val_f1:  0.76000113614692 val_auroc:  0.7778595974472262 val_auprc:  0.891883891000107
Validation loss improved to 0.376339
epoch:  9
epoch:  10 val_f1:  0.7236892364125374 val_auroc:  0.781786941580756 val_auprc:  0.8942200196113097
Validation loss improved to 0.350350
epoch:  10
epoch:  11 val_f1:  0.7028070029525513 val_auroc:  0.7766323024054983 val_auprc:  0.8889576672543126
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.6605237452657186 val_auroc:  0.7785959744722631 val_auprc:  0.8909288035344204
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.6960581600537912 val_auroc:  0.781786941580756 val_auprc:  0.8918291499565806
Validation loss improved to 0.331939
epoch:  13
epoch:  14 val_f1:  0.710128282915836 val_auroc:  0.7785959744722631 val_auprc:  0.8911383967277156
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.7473302173830908 val_auroc:  0.7913598429062346 val_auprc:  0.8994590046988777
Validation loss improved to 0.306590
epoch:  15
epoch:  16 val_f1:  0.7185533480648861 val_auroc:  0.7852233676975945 val_auprc:  0.8938590794622729
EarlyStopping counter: 1 out of 50
epoch:  16
epoch:  17 val_f1:  0.6992598845858601 val_auroc:  0.76926853215513 val_auprc:  0.8855974502833779
EarlyStopping counter: 2 out of 50
epoch:  17
epoch:  18 val_f1:  0.726400389202679 val_auroc:  0.7903780068728523 val_auprc:  0.8988655641486551
EarlyStopping counter: 3 out of 50
epoch:  18
epoch:  19 val_f1:  0.6952451949622753 val_auroc:  0.7653411880216003 val_auprc:  0.882382022304115
EarlyStopping counter: 4 out of 50
epoch:  19
epoch:  20 val_f1:  0.707673860911271 val_auroc:  0.7677957781050565 val_auprc:  0.8839594151451395
EarlyStopping counter: 5 out of 50
epoch:  20
epoch:  21 val_f1:  0.7235944791518311 val_auroc:  0.7734413352970053 val_auprc:  0.887298860241397
EarlyStopping counter: 6 out of 50
epoch:  21
epoch:  22 val_f1:  0.6893376055458154 val_auroc:  0.7781050564555719 val_auprc:  0.8910814450521016
EarlyStopping counter: 7 out of 50
epoch:  22
epoch:  23 val_f1:  0.6904086828713746 val_auroc:  0.7623956799214531 val_auprc:  0.8811191262233158
EarlyStopping counter: 8 out of 50
epoch:  23
epoch:  24 val_f1:  0.6879576385879046 val_auroc:  0.773686794305351 val_auprc:  0.8896229946187669
EarlyStopping counter: 9 out of 50
epoch:  24
epoch:  25 val_f1:  0.7203480251458693 val_auroc:  0.758713794796269 val_auprc:  0.8755774114818942
EarlyStopping counter: 10 out of 50
epoch:  25
epoch:  26 val_f1:  0.7363119073255568 val_auroc:  0.7729504172803141 val_auprc:  0.886311604024083
EarlyStopping counter: 11 out of 50
epoch:  26
epoch:  27 val_f1:  0.7044810154681304 val_auroc:  0.7584683357879235 val_auprc:  0.8768004207274638
EarlyStopping counter: 12 out of 50
epoch:  27
epoch:  28 val_f1:  0.6967556353929608 val_auroc:  0.7589592538046146 val_auprc:  0.8782123476701524
EarlyStopping counter: 13 out of 50
epoch:  28
epoch:  29 val_f1:  0.7346891520614657 val_auroc:  0.7650957290132548 val_auprc:  0.8821786083006519
EarlyStopping counter: 14 out of 50
epoch:  29
epoch:  30 val_f1:  0.7121336235283787 val_auroc:  0.7577319587628866 val_auprc:  0.8762014138645419
EarlyStopping counter: 15 out of 50
epoch:  30
epoch:  31 val_f1:  0.6967647049253406 val_auroc:  0.7628865979381443 val_auprc:  0.8797105051534639
EarlyStopping counter: 16 out of 50
epoch:  31
epoch:  32 val_f1:  0.7094198370570532 val_auroc:  0.7557682866961218 val_auprc:  0.8723713974904007
EarlyStopping counter: 17 out of 50
epoch:  32
epoch:  33 val_f1:  0.684049098994562 val_auroc:  0.7538046146293569 val_auprc:  0.8718302329697464
EarlyStopping counter: 18 out of 50
epoch:  33
epoch:  34 val_f1:  0.6967556353929608 val_auroc:  0.7538046146293569 val_auprc:  0.869987578941765
EarlyStopping counter: 19 out of 50
epoch:  34
epoch:  35 val_f1:  0.7088095828755714 val_auroc:  0.7619047619047619 val_auprc:  0.8743655707341262
EarlyStopping counter: 20 out of 50
epoch:  35
epoch:  36 val_f1:  0.7009452472327455 val_auroc:  0.7660775650466373 val_auprc:  0.8738731431510669
EarlyStopping counter: 21 out of 50
epoch:  36
epoch:  37 val_f1:  0.6998394924759714 val_auroc:  0.7626411389297987 val_auprc:  0.8707195856311295
EarlyStopping counter: 22 out of 50
epoch:  37
epoch:  38 val_f1:  0.6951318622544138 val_auroc:  0.7646048109965635 val_auprc:  0.8729274365086006
EarlyStopping counter: 23 out of 50
epoch:  38
epoch:  39 val_f1:  0.7176437068167247 val_auroc:  0.7601865488463427 val_auprc:  0.869340052668004
EarlyStopping counter: 24 out of 50
epoch:  39
epoch:  40 val_f1:  0.7246795893300292 val_auroc:  0.7594501718213058 val_auprc:  0.8685265552101973
EarlyStopping counter: 25 out of 50
epoch:  40
epoch:  41 val_f1:  0.7309103647707891 val_auroc:  0.7601865488463426 val_auprc:  0.8679182909066736
EarlyStopping counter: 26 out of 50
epoch:  41
epoch:  42 val_f1:  0.6967647049253406 val_auroc:  0.7587137947962691 val_auprc:  0.8662668573208706
EarlyStopping counter: 27 out of 50
epoch:  42
epoch:  43 val_f1:  0.7238240177089098 val_auroc:  0.7533136966126657 val_auprc:  0.8630848101495774
EarlyStopping counter: 28 out of 50
epoch:  43
epoch:  44 val_f1:  0.722058496910722 val_auroc:  0.7508591065292096 val_auprc:  0.8622052798146371
EarlyStopping counter: 29 out of 50
epoch:  44
epoch:  45 val_f1:  0.7246795893300292 val_auroc:  0.7555228276877761 val_auprc:  0.8679734143513966
EarlyStopping counter: 30 out of 50
epoch:  45
epoch:  46 val_f1:  0.7115566705387387 val_auroc:  0.7562592047128129 val_auprc:  0.8658816105517648
EarlyStopping counter: 31 out of 50
epoch:  46
epoch:  47 val_f1:  0.7148475178521729 val_auroc:  0.7584683357879234 val_auprc:  0.8661690636466799
EarlyStopping counter: 32 out of 50
epoch:  47
epoch:  48 val_f1:  0.6928018025140328 val_auroc:  0.7479135984290624 val_auprc:  0.863362310961655
EarlyStopping counter: 33 out of 50
epoch:  48
epoch:  49 val_f1:  0.7121336235283787 val_auroc:  0.7542955326460482 val_auprc:  0.8692911249822876
EarlyStopping counter: 34 out of 50
epoch:  49
epoch:  50 val_f1:  0.7078050864958872 val_auroc:  0.7484045164457536 val_auprc:  0.8626410884183292
EarlyStopping counter: 35 out of 50
epoch:  50
epoch:  51 val_f1:  0.7088095828755714 val_auroc:  0.7550319096710849 val_auprc:  0.8650037023231879
EarlyStopping counter: 36 out of 50
epoch:  51
epoch:  52 val_f1:  0.7287333672277241 val_auroc:  0.7596956308296514 val_auprc:  0.8675513563273245
EarlyStopping counter: 37 out of 50
epoch:  52
epoch:  53 val_f1:  0.7108600244444511 val_auroc:  0.7484045164457536 val_auprc:  0.8615781720864835
EarlyStopping counter: 38 out of 50
epoch:  53
epoch:  54 val_f1:  0.7309103647707891 val_auroc:  0.7471772214040255 val_auprc:  0.8572039729954314
EarlyStopping counter: 39 out of 50
epoch:  54
epoch:  55 val_f1:  0.7148475178521729 val_auroc:  0.7572410407461954 val_auprc:  0.8660286709613083
EarlyStopping counter: 40 out of 50
epoch:  55
epoch:  56 val_f1:  0.7148475178521729 val_auroc:  0.751840942562592 val_auprc:  0.8610282107412157
EarlyStopping counter: 41 out of 50
epoch:  56
epoch:  57 val_f1:  0.7044810154681304 val_auroc:  0.7417771232204222 val_auprc:  0.8530423002278194
EarlyStopping counter: 42 out of 50
epoch:  57
epoch:  58 val_f1:  0.6928018025140328 val_auroc:  0.7430044182621502 val_auprc:  0.8563273853395876
EarlyStopping counter: 43 out of 50
epoch:  58
epoch:  59 val_f1:  0.722058496910722 val_auroc:  0.7437407952871871 val_auprc:  0.8548155365147234
EarlyStopping counter: 44 out of 50
epoch:  59
epoch:  60 val_f1:  0.7287333672277241 val_auroc:  0.7535591556210113 val_auprc:  0.8637185272227279
EarlyStopping counter: 45 out of 50
epoch:  60
epoch:  61 val_f1:  0.7328919440906961 val_auroc:  0.7496318114874816 val_auprc:  0.8624427944038313
EarlyStopping counter: 46 out of 50
epoch:  61
epoch:  62 val_f1:  0.7287333672277241 val_auroc:  0.7488954344624448 val_auprc:  0.8588274762799049
EarlyStopping counter: 47 out of 50
epoch:  62
epoch:  63 val_f1:  0.7346891520614657 val_auroc:  0.7523318605792833 val_auprc:  0.8603825121645052
EarlyStopping counter: 48 out of 50
epoch:  63
epoch:  64 val_f1:  0.7266187050359713 val_auroc:  0.751840942562592 val_auprc:  0.8628748249409599
EarlyStopping counter: 49 out of 50
epoch:  64
epoch:  65 val_f1:  0.7328919440906961 val_auroc:  0.7459499263622975 val_auprc:  0.8542489827874619
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  204.62558126449585
{'time_elapsed': [204.62558126449585], 'epoch': [64], 'fold': [2], 'f1_train': [0.9981996872393208], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7328919440906961], 'auroc_test': [0.7459499263622975], 'auprc_test': [0.8542489827874619]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1278]           768
│    └─BatchNorm1d: 2-2                  [64, 128, 1278]           256
│    └─Tanh: 2-3                         [64, 128, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1274]           --
│    └─Dropout: 2-5                      [64, 128, 1274]           --
│    └─Flatten: 2-6                      [64, 163072]              --
│    └─Linear: 2-7                       [64, 1]                   163,073
==========================================================================================
Total params: 164,097
Trainable params: 164,097
Non-trainable params: 0
Total mult-adds (M): 73.27
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.51
Params size (MB): 0.66
Estimated Total Size (MB): 168.49
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5442360930682603 val_auroc:  0.6698158914728682 val_auprc:  0.8489162191745661
epoch:  1
epoch:  2 val_f1:  0.7247733477430133 val_auroc:  0.7766472868217054 val_auprc:  0.906201747294507
Validation loss improved to 0.171677
epoch:  2
epoch:  3 val_f1:  0.7041308673690095 val_auroc:  0.7759205426356589 val_auprc:  0.8982878191583689
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.7298723628301476 val_auroc:  0.8296996124031008 val_auprc:  0.9229307543433117
EarlyStopping counter: 2 out of 50
epoch:  4
epoch:  5 val_f1:  0.7907929835906556 val_auroc:  0.8398740310077519 val_auprc:  0.9298413808064852
EarlyStopping counter: 3 out of 50
epoch:  5
epoch:  6 val_f1:  0.7735780520043992 val_auroc:  0.842781007751938 val_auprc:  0.9325035896981959
EarlyStopping counter: 4 out of 50
epoch:  6
epoch:  7 val_f1:  0.7892012988311853 val_auroc:  0.8372093023255814 val_auprc:  0.9306636200140397
EarlyStopping counter: 5 out of 50
epoch:  7
epoch:  8 val_f1:  0.7436964485493495 val_auroc:  0.8352713178294574 val_auprc:  0.9324337683195062
EarlyStopping counter: 6 out of 50
epoch:  8
epoch:  9 val_f1:  0.7427571456348435 val_auroc:  0.8410852713178293 val_auprc:  0.9284645145155263
EarlyStopping counter: 7 out of 50
epoch:  9
epoch:  10 val_f1:  0.7724509753899008 val_auroc:  0.8488372093023254 val_auprc:  0.9333142162838778
Validation loss improved to 0.152247
epoch:  10
epoch:  11 val_f1:  0.7646080538166868 val_auroc:  0.84375 val_auprc:  0.9350524204094417
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7539369712168144 val_auroc:  0.846172480620155 val_auprc:  0.9337877551841942
Validation loss improved to 0.147128
epoch:  12
epoch:  13 val_f1:  0.7854893118997625 val_auroc:  0.8481104651162791 val_auprc:  0.9347602761031361
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7507862900729332 val_auroc:  0.8517441860465116 val_auprc:  0.9387424914593104
EarlyStopping counter: 2 out of 50
epoch:  14
epoch:  15 val_f1:  0.7427571456348435 val_auroc:  0.8556201550387597 val_auprc:  0.937239122076238
EarlyStopping counter: 3 out of 50
epoch:  15
epoch:  16 val_f1:  0.7854893118997625 val_auroc:  0.8522286821705427 val_auprc:  0.9379284224190678
Validation loss improved to 0.143679
epoch:  16
epoch:  17 val_f1:  0.7840893588200424 val_auroc:  0.8531976744186045 val_auprc:  0.9398356899868835
Validation loss improved to 0.141845
epoch:  17
epoch:  18 val_f1:  0.8116870274031143 val_auroc:  0.8580426356589149 val_auprc:  0.9389903567960416
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7768458491633659 val_auroc:  0.8563468992248062 val_auprc:  0.9420904797945465
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7866727894280321 val_auroc:  0.8619186046511628 val_auprc:  0.9447724712914141
Validation loss improved to 0.134406
epoch:  20
epoch:  21 val_f1:  0.7615002914998069 val_auroc:  0.8624031007751939 val_auprc:  0.9422426471731641
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7877294237541244 val_auroc:  0.8636143410852712 val_auprc:  0.9445137472075934
Validation loss improved to 0.132274
epoch:  22
epoch:  23 val_f1:  0.7789671954250403 val_auroc:  0.8594961240310076 val_auprc:  0.942992400333059
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.792019787311512 val_auroc:  0.8650678294573644 val_auprc:  0.9448583972113436
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.8018807955038493 val_auroc:  0.8684593023255814 val_auprc:  0.9459982386665284
Validation loss improved to 0.128240
epoch:  25
epoch:  26 val_f1:  0.7827158008497472 val_auroc:  0.8713662790697675 val_auprc:  0.9474357410458893
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.8035187234827523 val_auroc:  0.8687015503875969 val_auprc:  0.946898265078979
EarlyStopping counter: 2 out of 50
epoch:  27
epoch:  28 val_f1:  0.8101799492243995 val_auroc:  0.8672480620155039 val_auprc:  0.9451573648956717
EarlyStopping counter: 3 out of 50
epoch:  28
epoch:  29 val_f1:  0.7730210108542735 val_auroc:  0.8694282945736435 val_auprc:  0.9438435648018283
EarlyStopping counter: 4 out of 50
epoch:  29
epoch:  30 val_f1:  0.8041795135320315 val_auroc:  0.8662790697674418 val_auprc:  0.9459618091417072
EarlyStopping counter: 5 out of 50
epoch:  30
epoch:  31 val_f1:  0.8093907785715628 val_auroc:  0.8706395348837209 val_auprc:  0.9472298880391267
Validation loss improved to 0.127589
epoch:  31
epoch:  32 val_f1:  0.7840893588200424 val_auroc:  0.8691860465116279 val_auprc:  0.9470885819184192
EarlyStopping counter: 1 out of 50
epoch:  32
epoch:  33 val_f1:  0.7875752415552048 val_auroc:  0.8718507751937984 val_auprc:  0.9461396293230899
EarlyStopping counter: 2 out of 50
epoch:  33
epoch:  34 val_f1:  0.7578890782445586 val_auroc:  0.875968992248062 val_auprc:  0.9487632106379082
EarlyStopping counter: 3 out of 50
epoch:  34
epoch:  35 val_f1:  0.7985611510791367 val_auroc:  0.8757267441860465 val_auprc:  0.9487835659950872
EarlyStopping counter: 4 out of 50
epoch:  35
epoch:  36 val_f1:  0.7892012988311853 val_auroc:  0.8786337209302326 val_auprc:  0.9504222878893291
EarlyStopping counter: 5 out of 50
epoch:  36
epoch:  37 val_f1:  0.7972014141264308 val_auroc:  0.8762112403100776 val_auprc:  0.9495342304936714
EarlyStopping counter: 6 out of 50
epoch:  37
epoch:  38 val_f1:  0.7932273763653603 val_auroc:  0.8781492248062015 val_auprc:  0.9503867828520363
EarlyStopping counter: 7 out of 50
epoch:  38
epoch:  39 val_f1:  0.8160321672535743 val_auroc:  0.8766957364341085 val_auprc:  0.9496908562073691
EarlyStopping counter: 8 out of 50
epoch:  39
epoch:  40 val_f1:  0.7997900244397783 val_auroc:  0.8766957364341086 val_auprc:  0.949513456323104
EarlyStopping counter: 9 out of 50
epoch:  40
epoch:  41 val_f1:  0.7952715769842713 val_auroc:  0.876453488372093 val_auprc:  0.9494833711374533
EarlyStopping counter: 10 out of 50
epoch:  41
epoch:  42 val_f1:  0.7997900244397783 val_auroc:  0.8752422480620156 val_auprc:  0.9488486361675743
EarlyStopping counter: 11 out of 50
epoch:  42
epoch:  43 val_f1:  0.7892012988311853 val_auroc:  0.8764534883720931 val_auprc:  0.9496515531815756
EarlyStopping counter: 12 out of 50
epoch:  43
epoch:  44 val_f1:  0.7793492478744277 val_auroc:  0.877422480620155 val_auprc:  0.9498574158536801
EarlyStopping counter: 13 out of 50
epoch:  44
epoch:  45 val_f1:  0.7892012988311853 val_auroc:  0.8786337209302325 val_auprc:  0.9501737941838518
EarlyStopping counter: 14 out of 50
epoch:  45
epoch:  46 val_f1:  0.7972014141264308 val_auroc:  0.8779069767441859 val_auprc:  0.9499338094038186
EarlyStopping counter: 15 out of 50
epoch:  46
epoch:  47 val_f1:  0.7906801532257888 val_auroc:  0.8771802325581395 val_auprc:  0.9501023975643144
EarlyStopping counter: 16 out of 50
epoch:  47
epoch:  48 val_f1:  0.7906801532257888 val_auroc:  0.8776647286821705 val_auprc:  0.9502264859016123
EarlyStopping counter: 17 out of 50
epoch:  48
epoch:  49 val_f1:  0.7906801532257888 val_auroc:  0.8781492248062015 val_auprc:  0.9503784799487566
EarlyStopping counter: 18 out of 50
epoch:  49
epoch:  50 val_f1:  0.783844953500274 val_auroc:  0.8791182170542636 val_auprc:  0.9494894934392004
EarlyStopping counter: 19 out of 50
epoch:  50
epoch:  51 val_f1:  0.7578890782445586 val_auroc:  0.8810562015503876 val_auprc:  0.9500935343206283
EarlyStopping counter: 20 out of 50
epoch:  51
epoch:  52 val_f1:  0.7489783115038208 val_auroc:  0.8783914728682171 val_auprc:  0.9495328202902427
EarlyStopping counter: 21 out of 50
epoch:  52
epoch:  53 val_f1:  0.783844953500274 val_auroc:  0.876937984496124 val_auprc:  0.9490947569160743
EarlyStopping counter: 22 out of 50
epoch:  53
epoch:  54 val_f1:  0.7841726618705036 val_auroc:  0.8740310077519379 val_auprc:  0.9481730426150371
EarlyStopping counter: 23 out of 50
epoch:  54
epoch:  55 val_f1:  0.7789671954250403 val_auroc:  0.8701550387596899 val_auprc:  0.9469030591048315
EarlyStopping counter: 24 out of 50
epoch:  55
epoch:  56 val_f1:  0.7827158008497472 val_auroc:  0.8696705426356588 val_auprc:  0.9470029865240194
EarlyStopping counter: 25 out of 50
epoch:  56
epoch:  57 val_f1:  0.7841726618705036 val_auroc:  0.8737887596899225 val_auprc:  0.9487982630965744
EarlyStopping counter: 26 out of 50
epoch:  57
epoch:  58 val_f1:  0.7857930944221151 val_auroc:  0.8757267441860466 val_auprc:  0.9483596482612586
EarlyStopping counter: 27 out of 50
epoch:  58
epoch:  59 val_f1:  0.783844953500274 val_auroc:  0.8757267441860466 val_auprc:  0.9483015729395552
EarlyStopping counter: 28 out of 50
epoch:  59
epoch:  60 val_f1:  0.7972014141264308 val_auroc:  0.8728197674418604 val_auprc:  0.9481043039239987
EarlyStopping counter: 29 out of 50
epoch:  60
epoch:  61 val_f1:  0.7827158008497472 val_auroc:  0.8723352713178294 val_auprc:  0.9477569985397953
EarlyStopping counter: 30 out of 50
epoch:  61
epoch:  62 val_f1:  0.7972014141264308 val_auroc:  0.8745155038759691 val_auprc:  0.9488761531272167
EarlyStopping counter: 31 out of 50
epoch:  62
epoch:  63 val_f1:  0.7724509753899008 val_auroc:  0.8725775193798448 val_auprc:  0.948200626122577
EarlyStopping counter: 32 out of 50
epoch:  63
epoch:  64 val_f1:  0.7647070144847204 val_auroc:  0.8737887596899223 val_auprc:  0.9484791689392472
EarlyStopping counter: 33 out of 50
epoch:  64
epoch:  65 val_f1:  0.7776763243674784 val_auroc:  0.8735465116279071 val_auprc:  0.9484798677852302
EarlyStopping counter: 34 out of 50
epoch:  65
epoch:  66 val_f1:  0.7841726618705036 val_auroc:  0.8764534883720931 val_auprc:  0.9494615495266008
EarlyStopping counter: 35 out of 50
epoch:  66
epoch:  67 val_f1:  0.7841726618705036 val_auroc:  0.8745155038759689 val_auprc:  0.9488634462572236
EarlyStopping counter: 36 out of 50
epoch:  67
epoch:  68 val_f1:  0.7906801532257888 val_auroc:  0.8752422480620154 val_auprc:  0.9490932605679318
EarlyStopping counter: 37 out of 50
epoch:  68
epoch:  69 val_f1:  0.7875752415552048 val_auroc:  0.874515503875969 val_auprc:  0.9484127763931154
EarlyStopping counter: 38 out of 50
epoch:  69
epoch:  70 val_f1:  0.7774211400110681 val_auroc:  0.8771802325581396 val_auprc:  0.9493916599376332
EarlyStopping counter: 39 out of 50
epoch:  70
epoch:  71 val_f1:  0.7906801532257888 val_auroc:  0.872577519379845 val_auprc:  0.9474836112172147
EarlyStopping counter: 40 out of 50
epoch:  71
epoch:  72 val_f1:  0.7724509753899008 val_auroc:  0.8757267441860466 val_auprc:  0.9490323390296784
EarlyStopping counter: 41 out of 50
epoch:  72
epoch:  73 val_f1:  0.7724509753899008 val_auroc:  0.8757267441860466 val_auprc:  0.9492280486455973
EarlyStopping counter: 42 out of 50
epoch:  73
epoch:  74 val_f1:  0.7711885993597467 val_auroc:  0.8757267441860466 val_auprc:  0.9492851715299917
EarlyStopping counter: 43 out of 50
epoch:  74
epoch:  75 val_f1:  0.7892012988311853 val_auroc:  0.8752422480620154 val_auprc:  0.9489002386766324
EarlyStopping counter: 44 out of 50
epoch:  75
epoch:  76 val_f1:  0.7972014141264308 val_auroc:  0.8752422480620154 val_auprc:  0.949058321900293
EarlyStopping counter: 45 out of 50
epoch:  76
epoch:  77 val_f1:  0.7793492478744277 val_auroc:  0.8745155038759691 val_auprc:  0.9486235024150118
EarlyStopping counter: 46 out of 50
epoch:  77
epoch:  78 val_f1:  0.7841726618705036 val_auroc:  0.875 val_auprc:  0.9490259381132122
EarlyStopping counter: 47 out of 50
epoch:  78
epoch:  79 val_f1:  0.7841726618705036 val_auroc:  0.875 val_auprc:  0.9488864742887817
EarlyStopping counter: 48 out of 50
epoch:  79
epoch:  80 val_f1:  0.783844953500274 val_auroc:  0.8762112403100775 val_auprc:  0.9487854533316884
EarlyStopping counter: 49 out of 50
epoch:  80
epoch:  81 val_f1:  0.7892012988311853 val_auroc:  0.8745155038759691 val_auprc:  0.9486418134994645
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  256.00408601760864
{'time_elapsed': [256.00408601760864], 'epoch': [80], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7892012988311853], 'auroc_test': [0.8745155038759691], 'auprc_test': [0.9486418134994645]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1278]           768
│    └─BatchNorm1d: 2-2                  [64, 128, 1278]           256
│    └─Tanh: 2-3                         [64, 128, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1274]           --
│    └─Dropout: 2-5                      [64, 128, 1274]           --
│    └─Flatten: 2-6                      [64, 163072]              --
│    └─Linear: 2-7                       [64, 1]                   163,073
==========================================================================================
Total params: 164,097
Trainable params: 164,097
Non-trainable params: 0
Total mult-adds (M): 73.27
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.51
Params size (MB): 0.66
Estimated Total Size (MB): 168.49
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.14202898550724638 val_auroc:  0.7405753968253967 val_auprc:  0.8729656435384897
epoch:  1
epoch:  2 val_f1:  0.7341501976284585 val_auroc:  0.7827380952380952 val_auprc:  0.8867026553752041
Validation loss improved to 0.469493
epoch:  2
epoch:  3 val_f1:  0.7311994981554226 val_auroc:  0.810515873015873 val_auprc:  0.9008985004751989
Validation loss improved to 0.362100
epoch:  3
epoch:  4 val_f1:  0.7605491990846683 val_auroc:  0.8439980158730159 val_auprc:  0.9183443398243959
Validation loss improved to 0.236869
epoch:  4
epoch:  5 val_f1:  0.7745910427020087 val_auroc:  0.8365575396825398 val_auprc:  0.9173538530902874
EarlyStopping counter: 1 out of 50
epoch:  5
epoch:  6 val_f1:  0.7495309300442878 val_auroc:  0.8603670634920635 val_auprc:  0.9274356674327445
EarlyStopping counter: 2 out of 50
epoch:  6
epoch:  7 val_f1:  0.7769308547872755 val_auroc:  0.8680555555555556 val_auprc:  0.9335902652557256
EarlyStopping counter: 3 out of 50
epoch:  7
epoch:  8 val_f1:  0.7282743721307049 val_auroc:  0.8747519841269842 val_auprc:  0.937446937453142
EarlyStopping counter: 4 out of 50
epoch:  8
epoch:  9 val_f1:  0.7686030845313764 val_auroc:  0.871031746031746 val_auprc:  0.9328978307497794
EarlyStopping counter: 5 out of 50
epoch:  9
epoch:  10 val_f1:  0.818640853509558 val_auroc:  0.8675595238095238 val_auprc:  0.9303667394835002
EarlyStopping counter: 6 out of 50
epoch:  10
epoch:  11 val_f1:  0.8030193236714975 val_auroc:  0.8725198412698413 val_auprc:  0.9323420188378341
EarlyStopping counter: 7 out of 50
epoch:  11
epoch:  12 val_f1:  0.807228002894545 val_auroc:  0.8710317460317462 val_auprc:  0.9344684828877253
EarlyStopping counter: 8 out of 50
epoch:  12
epoch:  13 val_f1:  0.81483559295621 val_auroc:  0.8727678571428571 val_auprc:  0.9357354280612625
EarlyStopping counter: 9 out of 50
epoch:  13
epoch:  14 val_f1:  0.8115942028985508 val_auroc:  0.8745039682539684 val_auprc:  0.9353389678042874
EarlyStopping counter: 10 out of 50
epoch:  14
epoch:  15 val_f1:  0.756376995929398 val_auroc:  0.8740079365079365 val_auprc:  0.9360560854528639
EarlyStopping counter: 11 out of 50
epoch:  15
epoch:  16 val_f1:  0.7858717303302986 val_auroc:  0.8645833333333334 val_auprc:  0.9284503112239328
EarlyStopping counter: 12 out of 50
epoch:  16
epoch:  17 val_f1:  0.8365904365904365 val_auroc:  0.8700396825396824 val_auprc:  0.9327333429962408
EarlyStopping counter: 13 out of 50
epoch:  17
epoch:  18 val_f1:  0.8103538508923273 val_auroc:  0.8700396825396826 val_auprc:  0.9338943093565591
EarlyStopping counter: 14 out of 50
epoch:  18
epoch:  19 val_f1:  0.8097298254042504 val_auroc:  0.8725198412698413 val_auprc:  0.9336255874265573
EarlyStopping counter: 15 out of 50
epoch:  19
epoch:  20 val_f1:  0.7839990466164816 val_auroc:  0.8544146825396826 val_auprc:  0.9181038399730577
EarlyStopping counter: 16 out of 50
epoch:  20
epoch:  21 val_f1:  0.8194319840387783 val_auroc:  0.8707837301587301 val_auprc:  0.9343293647868057
EarlyStopping counter: 17 out of 50
epoch:  21
epoch:  22 val_f1:  0.7940993788819876 val_auroc:  0.8722718253968255 val_auprc:  0.9329419524370165
EarlyStopping counter: 18 out of 50
epoch:  22
epoch:  23 val_f1:  0.800639197204071 val_auroc:  0.8640873015873016 val_auprc:  0.9295118217594693
EarlyStopping counter: 19 out of 50
epoch:  23
epoch:  24 val_f1:  0.8102677351291666 val_auroc:  0.8685515873015872 val_auprc:  0.9274288140862157
EarlyStopping counter: 20 out of 50
epoch:  24
epoch:  25 val_f1:  0.7949078298424175 val_auroc:  0.8625992063492064 val_auprc:  0.9239244309034295
EarlyStopping counter: 21 out of 50
epoch:  25
epoch:  26 val_f1:  0.8115942028985508 val_auroc:  0.8638392857142858 val_auprc:  0.927172253516303
EarlyStopping counter: 22 out of 50
epoch:  26
epoch:  27 val_f1:  0.7940993788819876 val_auroc:  0.8660714285714286 val_auprc:  0.9275880785414113
EarlyStopping counter: 23 out of 50
epoch:  27
epoch:  28 val_f1:  0.7991557619248628 val_auroc:  0.8531746031746033 val_auprc:  0.9142992625933062
EarlyStopping counter: 24 out of 50
epoch:  28
epoch:  29 val_f1:  0.7956729455237178 val_auroc:  0.8665674603174603 val_auprc:  0.9276336252909367
EarlyStopping counter: 25 out of 50
epoch:  29
epoch:  30 val_f1:  0.7995542847531747 val_auroc:  0.8700396825396826 val_auprc:  0.9288616666450278
EarlyStopping counter: 26 out of 50
epoch:  30
epoch:  31 val_f1:  0.8061683443992288 val_auroc:  0.8712797619047619 val_auprc:  0.9295072449316526
EarlyStopping counter: 27 out of 50
epoch:  31
epoch:  32 val_f1:  0.8127933585226971 val_auroc:  0.871031746031746 val_auprc:  0.929826364975495
EarlyStopping counter: 28 out of 50
epoch:  32
epoch:  33 val_f1:  0.7839990466164816 val_auroc:  0.8697916666666666 val_auprc:  0.9278010691969825
EarlyStopping counter: 29 out of 50
epoch:  33
epoch:  34 val_f1:  0.7839990466164816 val_auroc:  0.867311507936508 val_auprc:  0.9261387555467634
EarlyStopping counter: 30 out of 50
epoch:  34
epoch:  35 val_f1:  0.7858717303302986 val_auroc:  0.8638392857142857 val_auprc:  0.9248002800006714
EarlyStopping counter: 31 out of 50
epoch:  35
epoch:  36 val_f1:  0.7819511139952413 val_auroc:  0.8625992063492064 val_auprc:  0.9228113938790055
EarlyStopping counter: 32 out of 50
epoch:  36
epoch:  37 val_f1:  0.8049865427618805 val_auroc:  0.8678075396825397 val_auprc:  0.9262587858420641
EarlyStopping counter: 33 out of 50
epoch:  37
epoch:  38 val_f1:  0.7956729455237178 val_auroc:  0.8707837301587301 val_auprc:  0.9278072609179028
EarlyStopping counter: 34 out of 50
epoch:  38
epoch:  39 val_f1:  0.7949078298424175 val_auroc:  0.8650793650793651 val_auprc:  0.9216766852402787
EarlyStopping counter: 35 out of 50
epoch:  39
epoch:  40 val_f1:  0.792371879328401 val_auroc:  0.8670634920634922 val_auprc:  0.9247397299150407
EarlyStopping counter: 36 out of 50
epoch:  40
epoch:  41 val_f1:  0.7940993788819876 val_auroc:  0.8673115079365079 val_auprc:  0.9233786614762154
EarlyStopping counter: 37 out of 50
epoch:  41
epoch:  42 val_f1:  0.7926396128627546 val_auroc:  0.8623511904761906 val_auprc:  0.917746774122525
EarlyStopping counter: 38 out of 50
epoch:  42
epoch:  43 val_f1:  0.8036760694501368 val_auroc:  0.8745039682539683 val_auprc:  0.931819170395362
EarlyStopping counter: 39 out of 50
epoch:  43
epoch:  44 val_f1:  0.8088065661047027 val_auroc:  0.8764880952380952 val_auprc:  0.9319111938107882
EarlyStopping counter: 40 out of 50
epoch:  44
epoch:  45 val_f1:  0.8014350667803353 val_auroc:  0.8680555555555556 val_auprc:  0.9204578994969241
EarlyStopping counter: 41 out of 50
epoch:  45
epoch:  46 val_f1:  0.7858717303302986 val_auroc:  0.8687996031746031 val_auprc:  0.9242452937523368
EarlyStopping counter: 42 out of 50
epoch:  46
epoch:  47 val_f1:  0.7904805491990847 val_auroc:  0.8683035714285715 val_auprc:  0.9256933651108816
EarlyStopping counter: 43 out of 50
epoch:  47
epoch:  48 val_f1:  0.8036760694501368 val_auroc:  0.8727678571428571 val_auprc:  0.9286995014147251
EarlyStopping counter: 44 out of 50
epoch:  48
epoch:  49 val_f1:  0.7839990466164816 val_auroc:  0.8668154761904762 val_auprc:  0.9235470661915366
EarlyStopping counter: 45 out of 50
epoch:  49
epoch:  50 val_f1:  0.7861608411480533 val_auroc:  0.8685515873015873 val_auprc:  0.9247842463963606
EarlyStopping counter: 46 out of 50
epoch:  50
epoch:  51 val_f1:  0.7904805491990847 val_auroc:  0.871279761904762 val_auprc:  0.9260643983727415
EarlyStopping counter: 47 out of 50
epoch:  51
epoch:  52 val_f1:  0.7858717303302986 val_auroc:  0.8675595238095238 val_auprc:  0.9241263558890149
EarlyStopping counter: 48 out of 50
epoch:  52
epoch:  53 val_f1:  0.7904805491990847 val_auroc:  0.8692956349206349 val_auprc:  0.9251217929272386
EarlyStopping counter: 49 out of 50
epoch:  53
epoch:  54 val_f1:  0.7904805491990847 val_auroc:  0.8670634920634921 val_auprc:  0.9236587426746011
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  168.42020654678345
{'time_elapsed': [168.42020654678345], 'epoch': [53], 'fold': [4], 'f1_train': [0.9982029282297181], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7904805491990847], 'auroc_test': [0.8670634920634921], 'auprc_test': [0.9236587426746011]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 1278]           768
│    └─BatchNorm1d: 2-2                  [64, 128, 1278]           256
│    └─Tanh: 2-3                         [64, 128, 1278]           --
│    └─MaxPool1d: 2-4                    [64, 128, 1274]           --
│    └─Dropout: 2-5                      [64, 128, 1274]           --
│    └─Flatten: 2-6                      [64, 163072]              --
│    └─Linear: 2-7                       [64, 1]                   163,073
==========================================================================================
Total params: 164,097
Trainable params: 164,097
Non-trainable params: 0
Total mult-adds (M): 73.27
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 167.51
Params size (MB): 0.66
Estimated Total Size (MB): 168.49
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_84', 'config': {'hidden_channels': [128], 'epochs': 500, 'kernel_size': 5, 'pool_kernel_size': 5, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5247381042534395 val_auroc:  0.5532646048109966 val_auprc:  0.7373806236576829
epoch:  1
epoch:  2 val_f1:  0.591898769565332 val_auroc:  0.6499754540991655 val_auprc:  0.813740438777029
Validation loss improved to 1.269937
epoch:  2
epoch:  3 val_f1:  0.6407960073362986 val_auroc:  0.6752577319587629 val_auprc:  0.8300399342197557
Validation loss improved to 1.256111
epoch:  3
epoch:  4 val_f1:  0.6273614874334299 val_auroc:  0.6939126165930289 val_auprc:  0.841203015841051
Validation loss improved to 1.238179
epoch:  4
epoch:  5 val_f1:  0.6132839556339524 val_auroc:  0.7012763868433972 val_auprc:  0.8439859144606142
Validation loss improved to 1.223746
epoch:  5
epoch:  6 val_f1:  0.6674874004539683 val_auroc:  0.7123220422189495 val_auprc:  0.847315859157208
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.661834573381412 val_auroc:  0.7206676485027 val_auprc:  0.8495449344860788
Validation loss improved to 1.219786
epoch:  7
epoch:  8 val_f1:  0.6617377698806362 val_auroc:  0.7336769759450172 val_auprc:  0.858764346913135
Validation loss improved to 1.199505
epoch:  8
epoch:  9 val_f1:  0.7185533480648861 val_auroc:  0.7398134511536574 val_auprc:  0.8623946252034735
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.6749024096537389 val_auroc:  0.752577319587629 val_auprc:  0.8730395010698622
Validation loss improved to 1.168398
epoch:  10
epoch:  11 val_f1:  0.6749024096537389 val_auroc:  0.760677466863034 val_auprc:  0.8788854624427156
Validation loss improved to 1.155498
epoch:  11
epoch:  12 val_f1:  0.6891084624964738 val_auroc:  0.766813942071674 val_auprc:  0.8820735639598212
Validation loss improved to 1.149071
epoch:  12
epoch:  13 val_f1:  0.7402181480621955 val_auroc:  0.7690230731467845 val_auprc:  0.8822260273796532
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.7101700457815566 val_auroc:  0.7758959253804615 val_auprc:  0.887890280524193
Validation loss improved to 1.137124
epoch:  14
epoch:  15 val_f1:  0.7362024088594293 val_auroc:  0.7783505154639175 val_auprc:  0.8898555488875103
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.703263898025454 val_auroc:  0.7844869906725577 val_auprc:  0.8945307660614565
Validation loss improved to 1.120332
epoch:  16
epoch:  17 val_f1:  0.703263898025454 val_auroc:  0.788659793814433 val_auprc:  0.8971249792536243
Validation loss improved to 1.112232
epoch:  17
epoch:  18 val_f1:  0.7617596949267598 val_auroc:  0.7866961217476681 val_auprc:  0.8977109461535625
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.703263898025454 val_auroc:  0.7970054000981837 val_auprc:  0.9059521481022803
Validation loss improved to 1.093149
epoch:  19
epoch:  20 val_f1:  0.7098736982331642 val_auroc:  0.7979872361315661 val_auprc:  0.9076145307828014
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7672775806504117 val_auroc:  0.7893961708394698 val_auprc:  0.9006984304399113
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.6891084624964738 val_auroc:  0.8014236622484044 val_auprc:  0.9110492088765968
Validation loss improved to 1.085762
epoch:  22
epoch:  23 val_f1:  0.7362024088594293 val_auroc:  0.8006872852233676 val_auprc:  0.9094173070253607
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7229061670449737 val_auroc:  0.8026509572901326 val_auprc:  0.9100979509908926
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.7233618940391454 val_auroc:  0.8058419243986253 val_auprc:  0.9133654967167235
EarlyStopping counter: 3 out of 50
epoch:  25
epoch:  26 val_f1:  0.7617596949267598 val_auroc:  0.8051055473735885 val_auprc:  0.9115791333501251
EarlyStopping counter: 4 out of 50
epoch:  26
epoch:  27 val_f1:  0.7236892364125374 val_auroc:  0.8112420225822287 val_auprc:  0.9173166814327748
Validation loss improved to 1.083843
epoch:  27
epoch:  28 val_f1:  0.7617596949267598 val_auroc:  0.8065783014236623 val_auprc:  0.9129122407680799
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.6882360925909661 val_auroc:  0.8136966126656848 val_auprc:  0.9186059943358292
EarlyStopping counter: 2 out of 50
epoch:  29
epoch:  30 val_f1:  0.7725930260576229 val_auroc:  0.8041237113402061 val_auprc:  0.9106897953482853
EarlyStopping counter: 3 out of 50
epoch:  30
epoch:  31 val_f1:  0.7552115339652351 val_auroc:  0.8092783505154639 val_auprc:  0.914242642025687
EarlyStopping counter: 4 out of 50
epoch:  31
epoch:  32 val_f1:  0.7307106601978622 val_auroc:  0.8168875797741778 val_auprc:  0.9198882394019816
EarlyStopping counter: 5 out of 50
epoch:  32
epoch:  33 val_f1:  0.7442757932382417 val_auroc:  0.8163966617574865 val_auprc:  0.9194951440003832
EarlyStopping counter: 6 out of 50
epoch:  33
epoch:  34 val_f1:  0.7971323289800215 val_auroc:  0.8060873834069711 val_auprc:  0.9114544635601518
EarlyStopping counter: 7 out of 50
epoch:  34
epoch:  35 val_f1:  0.730071543320129 val_auroc:  0.816151202749141 val_auprc:  0.9186020457041904
EarlyStopping counter: 8 out of 50
epoch:  35
epoch:  36 val_f1:  0.7223183251151889 val_auroc:  0.8151693667157585 val_auprc:  0.9178805072693943
EarlyStopping counter: 9 out of 50
epoch:  36
epoch:  37 val_f1:  0.7552115339652351 val_auroc:  0.8168875797741778 val_auprc:  0.9199764765245737
EarlyStopping counter: 10 out of 50
epoch:  37
epoch:  38 val_f1:  0.7455074238481555 val_auroc:  0.8134511536573392 val_auprc:  0.9173313169545811
EarlyStopping counter: 11 out of 50
epoch:  38
epoch:  39 val_f1:  0.7420910227448273 val_auroc:  0.8156602847324498 val_auprc:  0.9190770090000513
EarlyStopping counter: 12 out of 50
epoch:  39
epoch:  40 val_f1:  0.7420910227448273 val_auroc:  0.8156602847324497 val_auprc:  0.9192538979271743
EarlyStopping counter: 13 out of 50
epoch:  40
epoch:  41 val_f1:  0.7583800901862243 val_auroc:  0.812960235640648 val_auprc:  0.9177156325360033
EarlyStopping counter: 14 out of 50
epoch:  41
epoch:  42 val_f1:  0.7445203699313053 val_auroc:  0.8195876288659794 val_auprc:  0.9226769311986158
EarlyStopping counter: 15 out of 50
epoch:  42
epoch:  43 val_f1:  0.7446689355102744 val_auroc:  0.824251350024546 val_auprc:  0.9257184915811475
EarlyStopping counter: 16 out of 50
epoch:  43
epoch:  44 val_f1:  0.7648187281552264 val_auroc:  0.81173294059892 val_auprc:  0.9163334046273616
EarlyStopping counter: 17 out of 50
epoch:  44
epoch:  45 val_f1:  0.7648187281552264 val_auroc:  0.8112420225822289 val_auprc:  0.9166294454234465
EarlyStopping counter: 18 out of 50
epoch:  45
epoch:  46 val_f1:  0.7307708780682615 val_auroc:  0.8259695630829651 val_auprc:  0.9264827661030767
EarlyStopping counter: 19 out of 50
epoch:  46
epoch:  47 val_f1:  0.7519437633413868 val_auroc:  0.8109965635738832 val_auprc:  0.9160588481306244
EarlyStopping counter: 20 out of 50
epoch:  47
epoch:  48 val_f1:  0.7466980132583976 val_auroc:  0.8136966126656848 val_auprc:  0.9187853621448848
EarlyStopping counter: 21 out of 50
epoch:  48
epoch:  49 val_f1:  0.7367608586927249 val_auroc:  0.8188512518409425 val_auprc:  0.9217702875460176
EarlyStopping counter: 22 out of 50
epoch:  49
epoch:  50 val_f1:  0.7375047745919104 val_auroc:  0.8222876779577811 val_auprc:  0.9248581739194363
EarlyStopping counter: 23 out of 50
epoch:  50
epoch:  51 val_f1:  0.7402181480621955 val_auroc:  0.8149239077074129 val_auprc:  0.9181503100872781
EarlyStopping counter: 24 out of 50
epoch:  51
epoch:  52 val_f1:  0.7661184054361647 val_auroc:  0.814187530682376 val_auprc:  0.9178256793394008
EarlyStopping counter: 25 out of 50
epoch:  52
epoch:  53 val_f1:  0.7531731915989216 val_auroc:  0.8163966617574865 val_auprc:  0.9189203844671603
EarlyStopping counter: 26 out of 50
epoch:  53
epoch:  54 val_f1:  0.7402181480621955 val_auroc:  0.8151693667157585 val_auprc:  0.9190313135672059
EarlyStopping counter: 27 out of 50
epoch:  54
epoch:  55 val_f1:  0.7402181480621955 val_auroc:  0.8132056946489936 val_auprc:  0.9170971885428214
EarlyStopping counter: 28 out of 50
epoch:  55
epoch:  56 val_f1:  0.7552115339652351 val_auroc:  0.8151693667157586 val_auprc:  0.9197025511144119
EarlyStopping counter: 29 out of 50
epoch:  56
epoch:  57 val_f1:  0.748656020238754 val_auroc:  0.8195876288659795 val_auprc:  0.9224644677410941
EarlyStopping counter: 30 out of 50
epoch:  57
epoch:  58 val_f1:  0.7596459003010357 val_auroc:  0.8134511536573391 val_auprc:  0.9178534745095834
EarlyStopping counter: 31 out of 50
epoch:  58
epoch:  59 val_f1:  0.7552115339652351 val_auroc:  0.8144329896907216 val_auprc:  0.9187777338117777
EarlyStopping counter: 32 out of 50
epoch:  59
epoch:  60 val_f1:  0.7552115339652351 val_auroc:  0.8139420716740304 val_auprc:  0.9184868749134948
EarlyStopping counter: 33 out of 50
epoch:  60
epoch:  61 val_f1:  0.7712620601193464 val_auroc:  0.8087874324987727 val_auprc:  0.9151454406593462
EarlyStopping counter: 34 out of 50
epoch:  61
epoch:  62 val_f1:  0.7402181480621955 val_auroc:  0.8102601865488464 val_auprc:  0.916126499407163
EarlyStopping counter: 35 out of 50
epoch:  62
epoch:  63 val_f1:  0.7552115339652351 val_auroc:  0.8122238586156112 val_auprc:  0.9173906571852988
EarlyStopping counter: 36 out of 50
epoch:  63
epoch:  64 val_f1:  0.748656020238754 val_auroc:  0.8178694158075601 val_auprc:  0.9210234167572453
EarlyStopping counter: 37 out of 50
epoch:  64
epoch:  65 val_f1:  0.7681512331200245 val_auroc:  0.8075601374570447 val_auprc:  0.9131307021140582
EarlyStopping counter: 38 out of 50
epoch:  65
epoch:  66 val_f1:  0.7583800901862243 val_auroc:  0.8100147275405007 val_auprc:  0.9155581708753681
EarlyStopping counter: 39 out of 50
epoch:  66
epoch:  67 val_f1:  0.76000113614692 val_auroc:  0.8075601374570447 val_auprc:  0.9130966934466842
EarlyStopping counter: 40 out of 50
epoch:  67
epoch:  68 val_f1:  0.748656020238754 val_auroc:  0.8161512027491409 val_auprc:  0.9189827886344675
EarlyStopping counter: 41 out of 50
epoch:  68
epoch:  69 val_f1:  0.748656020238754 val_auroc:  0.8161512027491409 val_auprc:  0.9186535682078776
EarlyStopping counter: 42 out of 50
epoch:  69
epoch:  70 val_f1:  0.7531731915989216 val_auroc:  0.8141875306823761 val_auprc:  0.9179242013621667
EarlyStopping counter: 43 out of 50
epoch:  70
epoch:  71 val_f1:  0.7542604103291037 val_auroc:  0.814187530682376 val_auprc:  0.9182696927357136
EarlyStopping counter: 44 out of 50
epoch:  71
epoch:  72 val_f1:  0.7505653177403916 val_auroc:  0.8102601865488464 val_auprc:  0.9156045810288089
EarlyStopping counter: 45 out of 50
epoch:  72
epoch:  73 val_f1:  0.7697841726618705 val_auroc:  0.8063328424153167 val_auprc:  0.912459322491688
EarlyStopping counter: 46 out of 50
epoch:  73
epoch:  74 val_f1:  0.7552115339652351 val_auroc:  0.8136966126656848 val_auprc:  0.9173647404252354
EarlyStopping counter: 47 out of 50
epoch:  74
epoch:  75 val_f1:  0.7583800901862243 val_auroc:  0.8085419734904271 val_auprc:  0.9149185589536368
EarlyStopping counter: 48 out of 50
epoch:  75
epoch:  76 val_f1:  0.7583800901862243 val_auroc:  0.8107511045655376 val_auprc:  0.915258212003945
EarlyStopping counter: 49 out of 50
epoch:  76
epoch:  77 val_f1:  0.7552115339652351 val_auroc:  0.8107511045655376 val_auprc:  0.9153222383958783
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  25.598451852798462
{'time_elapsed': [25.598451852798462], 'epoch': [76], 'fold': [0], 'f1_train': [0.9750434621476838], 'auroc_train': [0.9994328111107704], 'auprc_train': [0.9997594220007499], 'f1_test': [0.7552115339652351], 'auroc_test': [0.8107511045655376], 'auprc_test': [0.9153222383958783]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 256]            768
│    └─BatchNorm1d: 2-2                  [64, 128, 256]            256
│    └─Tanh: 2-3                         [64, 128, 256]            --
│    └─MaxPool1d: 2-4                    [64, 128, 51]             --
│    └─Dropout: 2-5                      [64, 128, 51]             --
│    └─Flatten: 2-6                      [64, 6528]                --
│    └─Linear: 2-7                       [64, 1]                   6,529
==========================================================================================
Total params: 7,553
Trainable params: 7,553
Non-trainable params: 0
Total mult-adds (M): 13.02
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 33.55
Params size (MB): 0.03
Estimated Total Size (MB): 33.91
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.536563009506394 val_auroc:  0.6219931271477663 val_auprc:  0.83458032357365
epoch:  1
epoch:  2 val_f1:  0.45877280866101766 val_auroc:  0.6431026018654884 val_auprc:  0.8438955138383939
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.5895214263371911 val_auroc:  0.6769759450171822 val_auprc:  0.8649701336927164
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.5470220838254769 val_auroc:  0.6946489936180656 val_auprc:  0.8735548695026027
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.626278646403147 val_auroc:  0.7074128620520374 val_auprc:  0.8806029923158813
Validation loss improved to 1.108740
epoch:  5
epoch:  6 val_f1:  0.6339490569706397 val_auroc:  0.7270495827196858 val_auprc:  0.8912651085517125
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.6641341472276725 val_auroc:  0.7513500245459008 val_auprc:  0.9000658461202935
Validation loss improved to 1.065146
epoch:  7
epoch:  8 val_f1:  0.702570289683208 val_auroc:  0.7663230240549829 val_auprc:  0.907769011204048
Validation loss improved to 1.062613
epoch:  8
epoch:  9 val_f1:  0.7215941532488295 val_auroc:  0.783014236622484 val_auprc:  0.9117664206196519
Validation loss improved to 1.028412
epoch:  9
epoch:  10 val_f1:  0.7153768694261835 val_auroc:  0.7889052528227787 val_auprc:  0.916685182860533
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.7299542184434271 val_auroc:  0.7920962199312716 val_auprc:  0.9130611619496841
Validation loss improved to 1.003138
epoch:  11
epoch:  12 val_f1:  0.7510257046352308 val_auroc:  0.8033873343151694 val_auprc:  0.9208938099694187
Validation loss improved to 0.997892
epoch:  12
epoch:  13 val_f1:  0.7367608586927249 val_auroc:  0.8075601374570447 val_auprc:  0.9214895056895005
Validation loss improved to 0.983315
epoch:  13
epoch:  14 val_f1:  0.743431836172277 val_auroc:  0.8122238586156112 val_auprc:  0.9229773772570417
Validation loss improved to 0.974010
epoch:  14
epoch:  15 val_f1:  0.7510257046352308 val_auroc:  0.812960235640648 val_auprc:  0.9235018815806781
Validation loss improved to 0.972558
epoch:  15
epoch:  16 val_f1:  0.7428255465713769 val_auroc:  0.8144329896907218 val_auprc:  0.9235138820857434
Validation loss improved to 0.959038
epoch:  16
epoch:  17 val_f1:  0.735514445586388 val_auroc:  0.8139420716740304 val_auprc:  0.9227366482354094
Validation loss improved to 0.952268
epoch:  17
epoch:  18 val_f1:  0.7573003855683703 val_auroc:  0.8176239567992145 val_auprc:  0.9246658058530519
Validation loss improved to 0.952165
epoch:  18
epoch:  19 val_f1:  0.7725930260576229 val_auroc:  0.8208149239077075 val_auprc:  0.9248869125064996
Validation loss improved to 0.942620
epoch:  19
epoch:  20 val_f1:  0.7500864926036699 val_auroc:  0.8178694158075602 val_auprc:  0.9239822542818039
EarlyStopping counter: 1 out of 50
epoch:  20
epoch:  21 val_f1:  0.7308672563486676 val_auroc:  0.8188512518409427 val_auprc:  0.9253618702692223
EarlyStopping counter: 2 out of 50
epoch:  21
epoch:  22 val_f1:  0.7762067639678805 val_auroc:  0.8166421207658321 val_auprc:  0.9217715919491725
EarlyStopping counter: 3 out of 50
epoch:  22
epoch:  23 val_f1:  0.7719216534287021 val_auroc:  0.8242513500245459 val_auprc:  0.9271984591305114
EarlyStopping counter: 4 out of 50
epoch:  23
epoch:  24 val_f1:  0.7596459003010357 val_auroc:  0.8220422189494355 val_auprc:  0.9247827805776673
Validation loss improved to 0.934200
epoch:  24
epoch:  25 val_f1:  0.7583300796647482 val_auroc:  0.822287677957781 val_auprc:  0.9261240510645818
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.7777125328082551 val_auroc:  0.8181148748159057 val_auprc:  0.9220786071224201
EarlyStopping counter: 2 out of 50
epoch:  26
epoch:  27 val_f1:  0.7531731915989216 val_auroc:  0.822287677957781 val_auprc:  0.9242021124366997
EarlyStopping counter: 3 out of 50
epoch:  27
epoch:  28 val_f1:  0.7661184054361647 val_auroc:  0.8215513009327443 val_auprc:  0.9237606898893838
EarlyStopping counter: 4 out of 50
epoch:  28
epoch:  29 val_f1:  0.7790721385700611 val_auroc:  0.8200785468826706 val_auprc:  0.9226468137094169
EarlyStopping counter: 5 out of 50
epoch:  29
epoch:  30 val_f1:  0.7412236216203913 val_auroc:  0.8247422680412371 val_auprc:  0.925651159598758
EarlyStopping counter: 6 out of 50
epoch:  30
epoch:  31 val_f1:  0.7855581813618873 val_auroc:  0.8215513009327443 val_auprc:  0.923261020227951
EarlyStopping counter: 7 out of 50
epoch:  31
epoch:  32 val_f1:  0.7725930260576229 val_auroc:  0.8220422189494355 val_auprc:  0.9233632533541587
EarlyStopping counter: 8 out of 50
epoch:  32
epoch:  33 val_f1:  0.7802930475309426 val_auroc:  0.8217967599410898 val_auprc:  0.9229294679143777
EarlyStopping counter: 9 out of 50
epoch:  33
epoch:  34 val_f1:  0.7725930260576229 val_auroc:  0.8220422189494355 val_auprc:  0.9231477155493301
EarlyStopping counter: 10 out of 50
epoch:  34
epoch:  35 val_f1:  0.7802930475309426 val_auroc:  0.8225331369661266 val_auprc:  0.9234647009622692
EarlyStopping counter: 11 out of 50
epoch:  35
epoch:  36 val_f1:  0.7683026725960121 val_auroc:  0.8240058910162004 val_auprc:  0.9243440652169668
EarlyStopping counter: 12 out of 50
epoch:  36
epoch:  37 val_f1:  0.7790721385700611 val_auroc:  0.8195876288659794 val_auprc:  0.921599218795988
EarlyStopping counter: 13 out of 50
epoch:  37
epoch:  38 val_f1:  0.7777125328082551 val_auroc:  0.8190967108492881 val_auprc:  0.9207883248853257
EarlyStopping counter: 14 out of 50
epoch:  38
epoch:  39 val_f1:  0.7777125328082551 val_auroc:  0.8217967599410899 val_auprc:  0.9224974952415756
EarlyStopping counter: 15 out of 50
epoch:  39
epoch:  40 val_f1:  0.7879228532067962 val_auroc:  0.825478645066274 val_auprc:  0.9242670115304341
EarlyStopping counter: 16 out of 50
epoch:  40
epoch:  41 val_f1:  0.7790721385700611 val_auroc:  0.8232695139911634 val_auprc:  0.9226264910089013
EarlyStopping counter: 17 out of 50
epoch:  41
epoch:  42 val_f1:  0.7633714058926586 val_auroc:  0.8235149729995092 val_auprc:  0.9226712071379233
EarlyStopping counter: 18 out of 50
epoch:  42
epoch:  43 val_f1:  0.7790721385700611 val_auroc:  0.8247422680412372 val_auprc:  0.9230580740425982
EarlyStopping counter: 19 out of 50
epoch:  43
epoch:  44 val_f1:  0.7745465218349855 val_auroc:  0.8190967108492881 val_auprc:  0.9194133518518142
EarlyStopping counter: 20 out of 50
epoch:  44
epoch:  45 val_f1:  0.7506155503404762 val_auroc:  0.8262150220913108 val_auprc:  0.9248421639131414
EarlyStopping counter: 21 out of 50
epoch:  45
epoch:  46 val_f1:  0.7712620601193464 val_auroc:  0.8244968090328916 val_auprc:  0.9225664768907293
EarlyStopping counter: 22 out of 50
epoch:  46
epoch:  47 val_f1:  0.7707245329923307 val_auroc:  0.8193421698576338 val_auprc:  0.9191852404383688
EarlyStopping counter: 23 out of 50
epoch:  47
epoch:  48 val_f1:  0.7802930475309426 val_auroc:  0.8230240549828178 val_auprc:  0.9222326812543871
EarlyStopping counter: 24 out of 50
epoch:  48
epoch:  49 val_f1:  0.7712620601193464 val_auroc:  0.8244968090328916 val_auprc:  0.9221631960853187
EarlyStopping counter: 25 out of 50
epoch:  49
epoch:  50 val_f1:  0.7707245329923307 val_auroc:  0.8168875797741777 val_auprc:  0.9175809682114879
EarlyStopping counter: 26 out of 50
epoch:  50
epoch:  51 val_f1:  0.7672775806504117 val_auroc:  0.8264604810996564 val_auprc:  0.924554708647004
EarlyStopping counter: 27 out of 50
epoch:  51
epoch:  52 val_f1:  0.7745465218349855 val_auroc:  0.8225331369661266 val_auprc:  0.9219930325464436
EarlyStopping counter: 28 out of 50
epoch:  52
epoch:  53 val_f1:  0.766354189375772 val_auroc:  0.8208149239077075 val_auprc:  0.9206268716343432
EarlyStopping counter: 29 out of 50
epoch:  53
epoch:  54 val_f1:  0.7697841726618705 val_auroc:  0.8200785468826707 val_auprc:  0.9203525246202553
EarlyStopping counter: 30 out of 50
epoch:  54
epoch:  55 val_f1:  0.7697841726618705 val_auroc:  0.821060382916053 val_auprc:  0.9203955315972668
EarlyStopping counter: 31 out of 50
epoch:  55
epoch:  56 val_f1:  0.766354189375772 val_auroc:  0.8193421698576338 val_auprc:  0.9190453943695065
EarlyStopping counter: 32 out of 50
epoch:  56
epoch:  57 val_f1:  0.7707245329923307 val_auroc:  0.8146784486990674 val_auprc:  0.9155999242555124
EarlyStopping counter: 33 out of 50
epoch:  57
epoch:  58 val_f1:  0.7697841726618705 val_auroc:  0.8188512518409425 val_auprc:  0.918862357988745
EarlyStopping counter: 34 out of 50
epoch:  58
epoch:  59 val_f1:  0.7617684906754855 val_auroc:  0.8190967108492883 val_auprc:  0.9194198197958692
EarlyStopping counter: 35 out of 50
epoch:  59
epoch:  60 val_f1:  0.7770871369605723 val_auroc:  0.8186057928325969 val_auprc:  0.9177627098238504
EarlyStopping counter: 36 out of 50
epoch:  60
epoch:  61 val_f1:  0.7712620601193464 val_auroc:  0.8205694648993618 val_auprc:  0.9201160826116614
EarlyStopping counter: 37 out of 50
epoch:  61
epoch:  62 val_f1:  0.7583800901862243 val_auroc:  0.8213058419243987 val_auprc:  0.9209232880111892
EarlyStopping counter: 38 out of 50
epoch:  62
epoch:  63 val_f1:  0.7770871369605723 val_auroc:  0.8168875797741778 val_auprc:  0.9161690274297436
EarlyStopping counter: 39 out of 50
epoch:  63
epoch:  64 val_f1:  0.7712620601193464 val_auroc:  0.8188512518409425 val_auprc:  0.9185087331274965
EarlyStopping counter: 40 out of 50
epoch:  64
epoch:  65 val_f1:  0.7791090204759269 val_auroc:  0.8163966617574866 val_auprc:  0.9167797302462116
EarlyStopping counter: 41 out of 50
epoch:  65
epoch:  66 val_f1:  0.7697841726618705 val_auroc:  0.8173784977908688 val_auprc:  0.9174231692082593
EarlyStopping counter: 42 out of 50
epoch:  66
epoch:  67 val_f1:  0.76000113614692 val_auroc:  0.8139420716740304 val_auprc:  0.9146888533457871
EarlyStopping counter: 43 out of 50
epoch:  67
epoch:  68 val_f1:  0.7770871369605723 val_auroc:  0.8127147766323025 val_auprc:  0.9137296733900817
EarlyStopping counter: 44 out of 50
epoch:  68
epoch:  69 val_f1:  0.7727225509205256 val_auroc:  0.817378497790869 val_auprc:  0.9170566373437978
EarlyStopping counter: 45 out of 50
epoch:  69
epoch:  70 val_f1:  0.7727225509205256 val_auroc:  0.8159057437407954 val_auprc:  0.9156146392308803
EarlyStopping counter: 46 out of 50
epoch:  70
epoch:  71 val_f1:  0.7770871369605723 val_auroc:  0.8124693176239568 val_auprc:  0.9125123005968939
EarlyStopping counter: 47 out of 50
epoch:  71
epoch:  72 val_f1:  0.7745465218349855 val_auroc:  0.8146784486990672 val_auprc:  0.914518824671483
EarlyStopping counter: 48 out of 50
epoch:  72
epoch:  73 val_f1:  0.7707245329923307 val_auroc:  0.8156602847324497 val_auprc:  0.9151881096663155
EarlyStopping counter: 49 out of 50
epoch:  73
epoch:  74 val_f1:  0.7770871369605723 val_auroc:  0.8176239567992145 val_auprc:  0.9156132338990018
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  22.543705701828003
{'time_elapsed': [22.543705701828003], 'epoch': [73], 'fold': [1], 'f1_train': [0.9749343266336276], 'auroc_train': [0.9988349633626636], 'auprc_train': [0.9994910181242946], 'f1_test': [0.7770871369605723], 'auroc_test': [0.8176239567992145], 'auprc_test': [0.9156132338990018]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 256]            768
│    └─BatchNorm1d: 2-2                  [64, 128, 256]            256
│    └─Tanh: 2-3                         [64, 128, 256]            --
│    └─MaxPool1d: 2-4                    [64, 128, 51]             --
│    └─Dropout: 2-5                      [64, 128, 51]             --
│    └─Flatten: 2-6                      [64, 6528]                --
│    └─Linear: 2-7                       [64, 1]                   6,529
==========================================================================================
Total params: 7,553
Trainable params: 7,553
Non-trainable params: 0
Total mult-adds (M): 13.02
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 33.55
Params size (MB): 0.03
Estimated Total Size (MB): 33.91
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5736495549323253 val_auroc:  0.5454099165439372 val_auprc:  0.7238477382326358
epoch:  1
epoch:  2 val_f1:  0.22633791995529787 val_auroc:  0.5864015709376534 val_auprc:  0.7895261473232562
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6756398022243748 val_auroc:  0.6381934216985764 val_auprc:  0.8141652588974061
Validation loss improved to 1.144547
epoch:  3
epoch:  4 val_f1:  0.3914126326057798 val_auroc:  0.659057437407953 val_auprc:  0.8362956171354874
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.6916657713146764 val_auroc:  0.6978399607265586 val_auprc:  0.8548366668788152
Validation loss improved to 1.109477
epoch:  5
epoch:  6 val_f1:  0.44352697228527166 val_auroc:  0.7091310751104566 val_auprc:  0.8646116469193185
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.7289242247644242 val_auroc:  0.7361315660284733 val_auprc:  0.8774074516740853
Validation loss improved to 1.085909
epoch:  7
epoch:  8 val_f1:  0.5979348628901833 val_auroc:  0.7430044182621501 val_auprc:  0.8832260167287335
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7249644134959412 val_auroc:  0.7545409916543937 val_auprc:  0.8873627234730759
Validation loss improved to 1.059433
epoch:  9
epoch:  10 val_f1:  0.49417614987605457 val_auroc:  0.7447226313205695 val_auprc:  0.8813961569042008
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.7223183251151889 val_auroc:  0.7535591556210114 val_auprc:  0.8857215707354122
Validation loss improved to 1.044901
epoch:  11
epoch:  12 val_f1:  0.6655263974827678 val_auroc:  0.7528227785959745 val_auprc:  0.8844592898361083
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7466980132583976 val_auroc:  0.7604320078546882 val_auprc:  0.8882167784534571
Validation loss improved to 1.029040
epoch:  13
epoch:  14 val_f1:  0.7029258641632973 val_auroc:  0.7567501227295043 val_auprc:  0.8849599286400203
EarlyStopping counter: 1 out of 50
epoch:  14
epoch:  15 val_f1:  0.7100860488080124 val_auroc:  0.7609229258713796 val_auprc:  0.8868567117633752
Validation loss improved to 1.026114
epoch:  15
epoch:  16 val_f1:  0.7239714721729109 val_auroc:  0.7631320569464899 val_auprc:  0.8882839639808273
Validation loss improved to 1.023769
epoch:  16
epoch:  17 val_f1:  0.7307106601978622 val_auroc:  0.7638684339715268 val_auprc:  0.8869713701292866
Validation loss improved to 1.019875
epoch:  17
epoch:  18 val_f1:  0.7428255465713769 val_auroc:  0.7717231222385862 val_auprc:  0.8903579843261755
Validation loss improved to 1.004154
epoch:  18
epoch:  19 val_f1:  0.7308479257525525 val_auroc:  0.7682866961217477 val_auprc:  0.8882180021218519
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7295632867761842 val_auroc:  0.7722140402552774 val_auprc:  0.8881574949397784
Validation loss improved to 1.004021
epoch:  20
epoch:  21 val_f1:  0.730071543320129 val_auroc:  0.7714776632302405 val_auprc:  0.8879594820888228
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7376969013024874 val_auroc:  0.7734413352970054 val_auprc:  0.8890716948002738
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.7402181480621955 val_auroc:  0.7783505154639175 val_auprc:  0.8911291865252774
Validation loss improved to 1.002832
epoch:  23
epoch:  24 val_f1:  0.7031576347932113 val_auroc:  0.7682866961217476 val_auprc:  0.8848865057326878
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7375047745919104 val_auroc:  0.76926853215513 val_auprc:  0.8853301798374063
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.7289242247644242 val_auroc:  0.7744231713303878 val_auprc:  0.8869298724897935
EarlyStopping counter: 3 out of 50
epoch:  26
epoch:  27 val_f1:  0.735514445586388 val_auroc:  0.7749140893470791 val_auprc:  0.8877059108655289
EarlyStopping counter: 4 out of 50
epoch:  27
epoch:  28 val_f1:  0.7281499969472504 val_auroc:  0.772459499263623 val_auprc:  0.8858040971701092
EarlyStopping counter: 5 out of 50
epoch:  28
epoch:  29 val_f1:  0.696151679426677 val_auroc:  0.7660775650466373 val_auprc:  0.8828704987797168
EarlyStopping counter: 6 out of 50
epoch:  29
epoch:  30 val_f1:  0.7328919440906961 val_auroc:  0.7795778105056456 val_auprc:  0.8905039887531886
EarlyStopping counter: 7 out of 50
epoch:  30
epoch:  31 val_f1:  0.7170452552783244 val_auroc:  0.7668139420716741 val_auprc:  0.8822828006421217
EarlyStopping counter: 8 out of 50
epoch:  31
epoch:  32 val_f1:  0.7028070029525513 val_auroc:  0.7663230240549828 val_auprc:  0.8815747864771504
EarlyStopping counter: 9 out of 50
epoch:  32
epoch:  33 val_f1:  0.7235944791518311 val_auroc:  0.7746686303387335 val_auprc:  0.8856916152696297
EarlyStopping counter: 10 out of 50
epoch:  33
epoch:  34 val_f1:  0.7249644134959412 val_auroc:  0.7746686303387335 val_auprc:  0.8857279196140887
EarlyStopping counter: 11 out of 50
epoch:  34
epoch:  35 val_f1:  0.7236892364125374 val_auroc:  0.7695139911634757 val_auprc:  0.8845419907183825
EarlyStopping counter: 12 out of 50
epoch:  35
epoch:  36 val_f1:  0.7281499969472504 val_auroc:  0.7763868433971527 val_auprc:  0.8893427046229146
EarlyStopping counter: 13 out of 50
epoch:  36
epoch:  37 val_f1:  0.7363119073255568 val_auroc:  0.7768777614138439 val_auprc:  0.8886194810334205
EarlyStopping counter: 14 out of 50
epoch:  37
epoch:  38 val_f1:  0.72389147505525 val_auroc:  0.7685321551300932 val_auprc:  0.8850725921252293
EarlyStopping counter: 15 out of 50
epoch:  38
epoch:  39 val_f1:  0.7313689473952751 val_auroc:  0.7758959253804615 val_auprc:  0.8886879971775089
EarlyStopping counter: 16 out of 50
epoch:  39
epoch:  40 val_f1:  0.7299542184434271 val_auroc:  0.7707412862052037 val_auprc:  0.8853620738622411
EarlyStopping counter: 17 out of 50
epoch:  40
epoch:  41 val_f1:  0.703263898025454 val_auroc:  0.761904761904762 val_auprc:  0.8805713608068528
EarlyStopping counter: 18 out of 50
epoch:  41
epoch:  42 val_f1:  0.7377691212466089 val_auroc:  0.770004909180167 val_auprc:  0.8850031903757365
EarlyStopping counter: 19 out of 50
epoch:  42
epoch:  43 val_f1:  0.7390688025474315 val_auroc:  0.7746686303387335 val_auprc:  0.8898365566839769
EarlyStopping counter: 20 out of 50
epoch:  43
epoch:  44 val_f1:  0.713247796930704 val_auroc:  0.7717231222385862 val_auprc:  0.887500198774963
EarlyStopping counter: 21 out of 50
epoch:  44
epoch:  45 val_f1:  0.6937535685737124 val_auroc:  0.7614138438880707 val_auprc:  0.880343859792879
EarlyStopping counter: 22 out of 50
epoch:  45
epoch:  46 val_f1:  0.7326256806616418 val_auroc:  0.7704958271968582 val_auprc:  0.8848167565485995
EarlyStopping counter: 23 out of 50
epoch:  46
epoch:  47 val_f1:  0.726175885795287 val_auroc:  0.7707412862052037 val_auprc:  0.8861311562273334
EarlyStopping counter: 24 out of 50
epoch:  47
epoch:  48 val_f1:  0.713247796930704 val_auroc:  0.7704958271968582 val_auprc:  0.8862030873183483
EarlyStopping counter: 25 out of 50
epoch:  48
epoch:  49 val_f1:  0.6872202593435662 val_auroc:  0.7589592538046146 val_auprc:  0.8799679290068836
EarlyStopping counter: 26 out of 50
epoch:  49
epoch:  50 val_f1:  0.7249644134959412 val_auroc:  0.7633775159548355 val_auprc:  0.8811109339651615
EarlyStopping counter: 27 out of 50
epoch:  50
epoch:  51 val_f1:  0.706765356945213 val_auroc:  0.7560137457044673 val_auprc:  0.8782742909689063
EarlyStopping counter: 28 out of 50
epoch:  51
epoch:  52 val_f1:  0.713247796930704 val_auroc:  0.7638684339715268 val_auprc:  0.8832803530857705
EarlyStopping counter: 29 out of 50
epoch:  52
epoch:  53 val_f1:  0.7313689473952751 val_auroc:  0.7604320078546882 val_auprc:  0.8811137239974012
EarlyStopping counter: 30 out of 50
epoch:  53
epoch:  54 val_f1:  0.717230470942395 val_auroc:  0.757486499754541 val_auprc:  0.8782983616723711
EarlyStopping counter: 31 out of 50
epoch:  54
epoch:  55 val_f1:  0.713247796930704 val_auroc:  0.756259204712813 val_auprc:  0.8800484299616598
EarlyStopping counter: 32 out of 50
epoch:  55
epoch:  56 val_f1:  0.7157412825720284 val_auroc:  0.7601865488463427 val_auprc:  0.8804027734350336
EarlyStopping counter: 33 out of 50
epoch:  56
epoch:  57 val_f1:  0.7121336235283787 val_auroc:  0.7533136966126657 val_auprc:  0.8768920527579872
EarlyStopping counter: 34 out of 50
epoch:  57
epoch:  58 val_f1:  0.7185533480648861 val_auroc:  0.7557682866961217 val_auprc:  0.8791426713886308
EarlyStopping counter: 35 out of 50
epoch:  58
epoch:  59 val_f1:  0.7121336235283787 val_auroc:  0.7560137457044673 val_auprc:  0.8795766031421569
EarlyStopping counter: 36 out of 50
epoch:  59
epoch:  60 val_f1:  0.6928018025140328 val_auroc:  0.7486499754540992 val_auprc:  0.8751215320244031
EarlyStopping counter: 37 out of 50
epoch:  60
epoch:  61 val_f1:  0.7057031525565856 val_auroc:  0.7496318114874816 val_auprc:  0.8757381165987195
EarlyStopping counter: 38 out of 50
epoch:  61
epoch:  62 val_f1:  0.7121336235283787 val_auroc:  0.7496318114874815 val_auprc:  0.87496725952645
EarlyStopping counter: 39 out of 50
epoch:  62
epoch:  63 val_f1:  0.722058496910722 val_auroc:  0.7515954835542464 val_auprc:  0.8769321605532692
EarlyStopping counter: 40 out of 50
epoch:  63
epoch:  64 val_f1:  0.7249644134959412 val_auroc:  0.7520864015709376 val_auprc:  0.8783776112129593
EarlyStopping counter: 41 out of 50
epoch:  64
epoch:  65 val_f1:  0.7057031525565856 val_auroc:  0.7484045164457536 val_auprc:  0.8750929188486922
EarlyStopping counter: 42 out of 50
epoch:  65
epoch:  66 val_f1:  0.6928018025140328 val_auroc:  0.7444771723122239 val_auprc:  0.8728941285527116
EarlyStopping counter: 43 out of 50
epoch:  66
epoch:  67 val_f1:  0.717230470942395 val_auroc:  0.7454590083456063 val_auprc:  0.8738460932439073
EarlyStopping counter: 44 out of 50
epoch:  67
epoch:  68 val_f1:  0.7057031525565856 val_auroc:  0.7432498772704959 val_auprc:  0.8727419257879913
EarlyStopping counter: 45 out of 50
epoch:  68
epoch:  69 val_f1:  0.7235944791518311 val_auroc:  0.7434953362788416 val_auprc:  0.872586347123792
EarlyStopping counter: 46 out of 50
epoch:  69
epoch:  70 val_f1:  0.6992598845858601 val_auroc:  0.7407952871870398 val_auprc:  0.870548714571172
EarlyStopping counter: 47 out of 50
epoch:  70
epoch:  71 val_f1:  0.7088095828755714 val_auroc:  0.7498772704958272 val_auprc:  0.876620718747108
EarlyStopping counter: 48 out of 50
epoch:  71
epoch:  72 val_f1:  0.6863269195545199 val_auroc:  0.7351497299950908 val_auprc:  0.8675173641097648
EarlyStopping counter: 49 out of 50
epoch:  72
epoch:  73 val_f1:  0.7040153975059064 val_auroc:  0.7444771723122238 val_auprc:  0.873088951637757
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  23.494165182113647
{'time_elapsed': [23.494165182113647], 'epoch': [72], 'fold': [2], 'f1_train': [0.987438205840143], 'auroc_train': [0.9997240702701046], 'auprc_train': [0.9998793405617286], 'f1_test': [0.7040153975059064], 'auroc_test': [0.7444771723122238], 'auprc_test': [0.873088951637757]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 256]            768
│    └─BatchNorm1d: 2-2                  [64, 128, 256]            256
│    └─Tanh: 2-3                         [64, 128, 256]            --
│    └─MaxPool1d: 2-4                    [64, 128, 51]             --
│    └─Dropout: 2-5                      [64, 128, 51]             --
│    └─Flatten: 2-6                      [64, 6528]                --
│    └─Linear: 2-7                       [64, 1]                   6,529
==========================================================================================
Total params: 7,553
Trainable params: 7,553
Non-trainable params: 0
Total mult-adds (M): 13.02
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 33.55
Params size (MB): 0.03
Estimated Total Size (MB): 33.91
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5642736874330323 val_auroc:  0.6431686046511628 val_auprc:  0.789183987462416
epoch:  1
epoch:  2 val_f1:  0.30997319791225836 val_auroc:  0.7257751937984496 val_auprc:  0.8754190362034956
Validation loss improved to 1.200090
epoch:  2
epoch:  3 val_f1:  0.7365583395352684 val_auroc:  0.7393410852713178 val_auprc:  0.872418200119409
Validation loss improved to 1.120431
epoch:  3
epoch:  4 val_f1:  0.6872509204841399 val_auroc:  0.7652616279069768 val_auprc:  0.8912795891588532
Validation loss improved to 1.084128
epoch:  4
epoch:  5 val_f1:  0.7090656886255701 val_auroc:  0.7923934108527133 val_auprc:  0.909246087552148
Validation loss improved to 1.062487
epoch:  5
epoch:  6 val_f1:  0.7695564219015847 val_auroc:  0.8117732558139535 val_auprc:  0.919766076869895
Validation loss improved to 1.040478
epoch:  6
epoch:  7 val_f1:  0.7679977157187104 val_auroc:  0.8212209302325582 val_auprc:  0.9246544386947428
Validation loss improved to 1.020710
epoch:  7
epoch:  8 val_f1:  0.7713093666729185 val_auroc:  0.8272771317829457 val_auprc:  0.9286373056996461
Validation loss improved to 0.997805
epoch:  8
epoch:  9 val_f1:  0.7866727894280321 val_auroc:  0.8306686046511628 val_auprc:  0.9296182777438734
Validation loss improved to 0.983516
epoch:  9
epoch:  10 val_f1:  0.7768458491633659 val_auroc:  0.8316375968992247 val_auprc:  0.9314032512086301
Validation loss improved to 0.959035
epoch:  10
epoch:  11 val_f1:  0.7783357627623393 val_auroc:  0.8374515503875969 val_auprc:  0.9332158951959586
Validation loss improved to 0.939824
epoch:  11
epoch:  12 val_f1:  0.7901923359271766 val_auroc:  0.8391472868217055 val_auprc:  0.932965189130515
Validation loss improved to 0.924880
epoch:  12
epoch:  13 val_f1:  0.7916865446634734 val_auroc:  0.842781007751938 val_auprc:  0.9350456884369137
Validation loss improved to 0.906147
epoch:  13
epoch:  14 val_f1:  0.7849097105470042 val_auroc:  0.8410852713178294 val_auprc:  0.9343698226074912
Validation loss improved to 0.892642
epoch:  14
epoch:  15 val_f1:  0.792019787311512 val_auroc:  0.8442344961240311 val_auprc:  0.933895214958965
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.757681867378181 val_auroc:  0.8468992248062015 val_auprc:  0.9380607070839831
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.7477439586792105 val_auroc:  0.8420542635658914 val_auprc:  0.9310249122722523
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.7916865446634734 val_auroc:  0.8481104651162792 val_auprc:  0.9370018332279199
Validation loss improved to 0.837638
epoch:  18
epoch:  19 val_f1:  0.7866727894280321 val_auroc:  0.849079457364341 val_auprc:  0.9363369588579662
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7912899626822607 val_auroc:  0.8507751937984496 val_auprc:  0.9382807496991563
Validation loss improved to 0.823563
epoch:  20
epoch:  21 val_f1:  0.8093907785715628 val_auroc:  0.8512596899224806 val_auprc:  0.9368619872542501
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.8074875573056803 val_auroc:  0.8536821705426356 val_auprc:  0.9383050789082963
EarlyStopping counter: 2 out of 50
epoch:  22
epoch:  23 val_f1:  0.8035187234827523 val_auroc:  0.8544089147286822 val_auprc:  0.9387289569218136
Validation loss improved to 0.802955
epoch:  23
epoch:  24 val_f1:  0.7849097105470042 val_auroc:  0.8544089147286822 val_auprc:  0.9396814711806637
Validation loss improved to 0.794388
epoch:  24
epoch:  25 val_f1:  0.8074875573056803 val_auroc:  0.8563468992248063 val_auprc:  0.9392545728421271
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.8168429178951009 val_auroc:  0.8585271317829457 val_auprc:  0.939776658663966
Validation loss improved to 0.794012
epoch:  26
epoch:  27 val_f1:  0.7901923359271766 val_auroc:  0.8575581395348836 val_auprc:  0.9401107056800855
Validation loss improved to 0.776791
epoch:  27
epoch:  28 val_f1:  0.7849097105470042 val_auroc:  0.8556201550387597 val_auprc:  0.9397128132541277
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.8226804934380051 val_auroc:  0.8614341085271318 val_auprc:  0.9414150400769279
EarlyStopping counter: 2 out of 50
epoch:  29
epoch:  30 val_f1:  0.8151164175042944 val_auroc:  0.8607073643410853 val_auprc:  0.9411250731018304
EarlyStopping counter: 3 out of 50
epoch:  30
epoch:  31 val_f1:  0.7968569383258559 val_auroc:  0.8570736434108527 val_auprc:  0.9399421229234504
Validation loss improved to 0.767184
epoch:  31
epoch:  32 val_f1:  0.8074875573056803 val_auroc:  0.8624031007751938 val_auprc:  0.9416201039527529
EarlyStopping counter: 1 out of 50
epoch:  32
epoch:  33 val_f1:  0.8093907785715628 val_auroc:  0.8614341085271319 val_auprc:  0.9416321733126327
Validation loss improved to 0.766741
epoch:  33
epoch:  34 val_f1:  0.8093907785715628 val_auroc:  0.8645833333333335 val_auprc:  0.9435429017378236
Validation loss improved to 0.765012
epoch:  34
epoch:  35 val_f1:  0.8160321672535743 val_auroc:  0.8643410852713178 val_auprc:  0.9432326207605247
EarlyStopping counter: 1 out of 50
epoch:  35
epoch:  36 val_f1:  0.7968569383258559 val_auroc:  0.8604651162790697 val_auprc:  0.9421748561204466
Validation loss improved to 0.753650
epoch:  36
epoch:  37 val_f1:  0.8093907785715628 val_auroc:  0.8599806201550387 val_auprc:  0.9423086596961381
Validation loss improved to 0.749842
epoch:  37
epoch:  38 val_f1:  0.7811109002295425 val_auroc:  0.8677325581395349 val_auprc:  0.9443045449701775
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.8027539115793398 val_auroc:  0.8614341085271318 val_auprc:  0.9424237455455189
Validation loss improved to 0.745878
epoch:  39
epoch:  40 val_f1:  0.8008946034661633 val_auroc:  0.8667635658914729 val_auprc:  0.9443432213086128
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.7968569383258559 val_auroc:  0.8626453488372093 val_auprc:  0.9438487767435686
Validation loss improved to 0.737723
epoch:  41
epoch:  42 val_f1:  0.8074875573056803 val_auroc:  0.8677325581395349 val_auprc:  0.9449127763203274
EarlyStopping counter: 1 out of 50
epoch:  42
epoch:  43 val_f1:  0.794309372388086 val_auroc:  0.8643410852713178 val_auprc:  0.9444044238616167
EarlyStopping counter: 2 out of 50
epoch:  43
epoch:  44 val_f1:  0.8027539115793398 val_auroc:  0.866279069767442 val_auprc:  0.9458091022848152
Validation loss improved to 0.733105
epoch:  44
epoch:  45 val_f1:  0.8084949329130455 val_auroc:  0.8660368217054263 val_auprc:  0.9448029013635286
EarlyStopping counter: 1 out of 50
epoch:  45
epoch:  46 val_f1:  0.8140907369797942 val_auroc:  0.8713662790697674 val_auprc:  0.9468173537190565
EarlyStopping counter: 2 out of 50
epoch:  46
epoch:  47 val_f1:  0.7961192047225032 val_auroc:  0.8687015503875969 val_auprc:  0.9468473505730328
Validation loss improved to 0.720496
epoch:  47
epoch:  48 val_f1:  0.792259730676997 val_auroc:  0.8752422480620156 val_auprc:  0.9476942683566287
EarlyStopping counter: 1 out of 50
epoch:  48
epoch:  49 val_f1:  0.8063632502555458 val_auroc:  0.8733042635658915 val_auprc:  0.9489575256068373
EarlyStopping counter: 2 out of 50
epoch:  49
epoch:  50 val_f1:  0.8101799492243995 val_auroc:  0.8679748062015503 val_auprc:  0.9476490574981768
EarlyStopping counter: 3 out of 50
epoch:  50
epoch:  51 val_f1:  0.7746634573712671 val_auroc:  0.8742732558139535 val_auprc:  0.9496986133002714
EarlyStopping counter: 4 out of 50
epoch:  51
epoch:  52 val_f1:  0.7952715769842713 val_auroc:  0.872577519379845 val_auprc:  0.9496033931077126
EarlyStopping counter: 5 out of 50
epoch:  52
epoch:  53 val_f1:  0.7952715769842713 val_auroc:  0.8757267441860465 val_auprc:  0.9505874984102749
EarlyStopping counter: 6 out of 50
epoch:  53
epoch:  54 val_f1:  0.8063632502555458 val_auroc:  0.8759689922480621 val_auprc:  0.9504862390148041
EarlyStopping counter: 7 out of 50
epoch:  54
epoch:  55 val_f1:  0.7997900244397783 val_auroc:  0.8733042635658915 val_auprc:  0.9496241224691397
EarlyStopping counter: 8 out of 50
epoch:  55
epoch:  56 val_f1:  0.7952715769842713 val_auroc:  0.8752422480620156 val_auprc:  0.9506324235112895
EarlyStopping counter: 9 out of 50
epoch:  56
epoch:  57 val_f1:  0.7952715769842713 val_auroc:  0.8740310077519379 val_auprc:  0.9504142315602059
EarlyStopping counter: 10 out of 50
epoch:  57
epoch:  58 val_f1:  0.7997900244397783 val_auroc:  0.8762112403100776 val_auprc:  0.9511376508944276
EarlyStopping counter: 11 out of 50
epoch:  58
epoch:  59 val_f1:  0.8018807955038493 val_auroc:  0.8730620155038761 val_auprc:  0.9500583686857107
EarlyStopping counter: 12 out of 50
epoch:  59
epoch:  60 val_f1:  0.7932273763653603 val_auroc:  0.874515503875969 val_auprc:  0.9502824607051592
EarlyStopping counter: 13 out of 50
epoch:  60
epoch:  61 val_f1:  0.8035187234827523 val_auroc:  0.8740310077519381 val_auprc:  0.9508741504705736
EarlyStopping counter: 14 out of 50
epoch:  61
epoch:  62 val_f1:  0.7857930944221151 val_auroc:  0.8800872093023256 val_auprc:  0.9531336767935586
EarlyStopping counter: 15 out of 50
epoch:  62
epoch:  63 val_f1:  0.8035187234827523 val_auroc:  0.8713662790697675 val_auprc:  0.9499826947532437
EarlyStopping counter: 16 out of 50
epoch:  63
epoch:  64 val_f1:  0.7866727894280321 val_auroc:  0.8747577519379846 val_auprc:  0.950742704325398
EarlyStopping counter: 17 out of 50
epoch:  64
epoch:  65 val_f1:  0.7997900244397783 val_auroc:  0.8747577519379846 val_auprc:  0.9509714225361059
EarlyStopping counter: 18 out of 50
epoch:  65
epoch:  66 val_f1:  0.8063632502555458 val_auroc:  0.8762112403100776 val_auprc:  0.9517328649812997
EarlyStopping counter: 19 out of 50
epoch:  66
epoch:  67 val_f1:  0.8063632502555458 val_auroc:  0.875 val_auprc:  0.9512127362738134
EarlyStopping counter: 20 out of 50
epoch:  67
epoch:  68 val_f1:  0.7866727894280321 val_auroc:  0.8737887596899225 val_auprc:  0.9507066128414496
EarlyStopping counter: 21 out of 50
epoch:  68
epoch:  69 val_f1:  0.7985611510791367 val_auroc:  0.8766957364341085 val_auprc:  0.9518101006831836
EarlyStopping counter: 22 out of 50
epoch:  69
epoch:  70 val_f1:  0.8063632502555458 val_auroc:  0.8757267441860466 val_auprc:  0.9516715362505337
EarlyStopping counter: 23 out of 50
epoch:  70
epoch:  71 val_f1:  0.8018807955038493 val_auroc:  0.8723352713178294 val_auprc:  0.9501862754264903
EarlyStopping counter: 24 out of 50
epoch:  71
epoch:  72 val_f1:  0.7997900244397783 val_auroc:  0.875484496124031 val_auprc:  0.9514483765441264
EarlyStopping counter: 25 out of 50
epoch:  72
epoch:  73 val_f1:  0.792019787311512 val_auroc:  0.876453488372093 val_auprc:  0.9517418571948641
EarlyStopping counter: 26 out of 50
epoch:  73
epoch:  74 val_f1:  0.8018807955038493 val_auroc:  0.8757267441860466 val_auprc:  0.9516600552653667
EarlyStopping counter: 27 out of 50
epoch:  74
epoch:  75 val_f1:  0.7892012988311853 val_auroc:  0.8781492248062015 val_auprc:  0.9526013967175535
EarlyStopping counter: 28 out of 50
epoch:  75
epoch:  76 val_f1:  0.7793492478744277 val_auroc:  0.8786337209302324 val_auprc:  0.9525765833235456
EarlyStopping counter: 29 out of 50
epoch:  76
epoch:  77 val_f1:  0.7906801532257888 val_auroc:  0.8771802325581395 val_auprc:  0.9523903597931157
EarlyStopping counter: 30 out of 50
epoch:  77
epoch:  78 val_f1:  0.8008946034661633 val_auroc:  0.8747577519379846 val_auprc:  0.9514113089573113
EarlyStopping counter: 31 out of 50
epoch:  78
epoch:  79 val_f1:  0.792019787311512 val_auroc:  0.8757267441860466 val_auprc:  0.9516594703366399
EarlyStopping counter: 32 out of 50
epoch:  79
epoch:  80 val_f1:  0.792019787311512 val_auroc:  0.876453488372093 val_auprc:  0.9521368963412207
EarlyStopping counter: 33 out of 50
epoch:  80
epoch:  81 val_f1:  0.8008946034661633 val_auroc:  0.8757267441860466 val_auprc:  0.9519982606879022
EarlyStopping counter: 34 out of 50
epoch:  81
epoch:  82 val_f1:  0.7827158008497472 val_auroc:  0.8757267441860465 val_auprc:  0.9518164199001917
EarlyStopping counter: 35 out of 50
epoch:  82
epoch:  83 val_f1:  0.792019787311512 val_auroc:  0.8737887596899225 val_auprc:  0.9508562915002079
EarlyStopping counter: 36 out of 50
epoch:  83
epoch:  84 val_f1:  0.7827158008497472 val_auroc:  0.8754844961240309 val_auprc:  0.9518064283992871
EarlyStopping counter: 37 out of 50
epoch:  84
epoch:  85 val_f1:  0.8181666911368864 val_auroc:  0.8718507751937985 val_auprc:  0.9502067260945917
EarlyStopping counter: 38 out of 50
epoch:  85
epoch:  86 val_f1:  0.7774211400110681 val_auroc:  0.8788759689922481 val_auprc:  0.9527262903974874
EarlyStopping counter: 39 out of 50
epoch:  86
epoch:  87 val_f1:  0.7827158008497472 val_auroc:  0.8774224806201549 val_auprc:  0.9522450667774094
EarlyStopping counter: 40 out of 50
epoch:  87
epoch:  88 val_f1:  0.8093907785715628 val_auroc:  0.873062015503876 val_auprc:  0.9501778273038427
EarlyStopping counter: 41 out of 50
epoch:  88
epoch:  89 val_f1:  0.7753157557330894 val_auroc:  0.8783914728682171 val_auprc:  0.9524083422830185
EarlyStopping counter: 42 out of 50
epoch:  89
epoch:  90 val_f1:  0.794309372388086 val_auroc:  0.8733042635658915 val_auprc:  0.9501822973674603
EarlyStopping counter: 43 out of 50
epoch:  90
epoch:  91 val_f1:  0.7774211400110681 val_auroc:  0.8783914728682172 val_auprc:  0.9526869010037604
EarlyStopping counter: 44 out of 50
epoch:  91
epoch:  92 val_f1:  0.7841726618705036 val_auroc:  0.8750000000000001 val_auprc:  0.9512984275141725
EarlyStopping counter: 45 out of 50
epoch:  92
epoch:  93 val_f1:  0.7892012988311853 val_auroc:  0.875968992248062 val_auprc:  0.9518004984971361
EarlyStopping counter: 46 out of 50
epoch:  93
epoch:  94 val_f1:  0.7892012988311853 val_auroc:  0.8766957364341085 val_auprc:  0.9521747860681422
EarlyStopping counter: 47 out of 50
epoch:  94
epoch:  95 val_f1:  0.7827158008497472 val_auroc:  0.8783914728682171 val_auprc:  0.9527789641512823
EarlyStopping counter: 48 out of 50
epoch:  95
epoch:  96 val_f1:  0.7827158008497472 val_auroc:  0.8779069767441862 val_auprc:  0.9525084947220951
EarlyStopping counter: 49 out of 50
epoch:  96
epoch:  97 val_f1:  0.7746634573712671 val_auroc:  0.8771802325581396 val_auprc:  0.9522862112221273
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  29.36439275741577
{'time_elapsed': [29.36439275741577], 'epoch': [96], 'fold': [3], 'f1_train': [0.9946079959646985], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7746634573712671], 'auroc_test': [0.8771802325581396], 'auprc_test': [0.9522862112221273]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 256]            768
│    └─BatchNorm1d: 2-2                  [64, 128, 256]            256
│    └─Tanh: 2-3                         [64, 128, 256]            --
│    └─MaxPool1d: 2-4                    [64, 128, 51]             --
│    └─Dropout: 2-5                      [64, 128, 51]             --
│    └─Flatten: 2-6                      [64, 6528]                --
│    └─Linear: 2-7                       [64, 1]                   6,529
==========================================================================================
Total params: 7,553
Trainable params: 7,553
Non-trainable params: 0
Total mult-adds (M): 13.02
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 33.55
Params size (MB): 0.03
Estimated Total Size (MB): 33.91
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.17201878308724566 val_auroc:  0.6907242063492063 val_auprc:  0.8326824634750797
epoch:  1
epoch:  2 val_f1:  0.6508959637323581 val_auroc:  0.7450396825396827 val_auprc:  0.8754111149860051
Validation loss improved to 1.173737
epoch:  2
epoch:  3 val_f1:  0.6733201581027669 val_auroc:  0.7844742063492064 val_auprc:  0.8981753568909177
Validation loss improved to 1.170131
epoch:  3
epoch:  4 val_f1:  0.7134735367423068 val_auroc:  0.7981150793650795 val_auprc:  0.9034636344269724
Validation loss improved to 1.116876
epoch:  4
epoch:  5 val_f1:  0.7493317920296212 val_auroc:  0.8239087301587302 val_auprc:  0.9121616165470929
Validation loss improved to 1.098188
epoch:  5
epoch:  6 val_f1:  0.7563598080432068 val_auroc:  0.8333333333333334 val_auprc:  0.9169666715815239
Validation loss improved to 1.060893
epoch:  6
epoch:  7 val_f1:  0.7748792270531402 val_auroc:  0.8497023809523809 val_auprc:  0.9227281831050244
Validation loss improved to 1.040704
epoch:  7
epoch:  8 val_f1:  0.784303671260193 val_auroc:  0.8591269841269842 val_auprc:  0.929305813269281
Validation loss improved to 1.019817
epoch:  8
epoch:  9 val_f1:  0.8015122873345937 val_auroc:  0.8683035714285714 val_auprc:  0.9334028221009834
Validation loss improved to 1.007953
epoch:  9
epoch:  10 val_f1:  0.784303671260193 val_auroc:  0.871031746031746 val_auprc:  0.9349360942283875
Validation loss improved to 0.986276
epoch:  10
epoch:  11 val_f1:  0.7948558771909655 val_auroc:  0.8707837301587301 val_auprc:  0.9338761212521363
Validation loss improved to 0.976262
epoch:  11
epoch:  12 val_f1:  0.8041106719367591 val_auroc:  0.8720238095238095 val_auprc:  0.9357031527289287
Validation loss improved to 0.953026
epoch:  12
epoch:  13 val_f1:  0.8097298254042504 val_auroc:  0.8737599206349206 val_auprc:  0.9361663368947157
Validation loss improved to 0.940773
epoch:  13
epoch:  14 val_f1:  0.804814497938866 val_auroc:  0.8764880952380952 val_auprc:  0.9378584889107631
Validation loss improved to 0.923999
epoch:  14
epoch:  15 val_f1:  0.7815416513900654 val_auroc:  0.873015873015873 val_auprc:  0.9372259980676801
Validation loss improved to 0.916361
epoch:  15
epoch:  16 val_f1:  0.7842196249660383 val_auroc:  0.8735119047619047 val_auprc:  0.9378530106670058
Validation loss improved to 0.899547
epoch:  16
epoch:  17 val_f1:  0.7895875497243353 val_auroc:  0.8715277777777778 val_auprc:  0.9368859811788234
Validation loss improved to 0.890693
epoch:  17
epoch:  18 val_f1:  0.7693794969559068 val_auroc:  0.8722718253968255 val_auprc:  0.9369653693642912
Validation loss improved to 0.878374
epoch:  18
epoch:  19 val_f1:  0.7822581250985979 val_auroc:  0.8722718253968255 val_auprc:  0.9370447403367851
Validation loss improved to 0.872648
epoch:  19
epoch:  20 val_f1:  0.7688528617047408 val_auroc:  0.873015873015873 val_auprc:  0.9374199240977242
Validation loss improved to 0.862214
epoch:  20
epoch:  21 val_f1:  0.7688528617047408 val_auroc:  0.8727678571428571 val_auprc:  0.9373114017793752
Validation loss improved to 0.853145
epoch:  21
epoch:  22 val_f1:  0.773156899810964 val_auroc:  0.8685515873015873 val_auprc:  0.9350796931568354
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7697938448700337 val_auroc:  0.871031746031746 val_auprc:  0.936289885150009
Validation loss improved to 0.839916
epoch:  23
epoch:  24 val_f1:  0.791810443984357 val_auroc:  0.8680555555555556 val_auprc:  0.9348118249907209
EarlyStopping counter: 1 out of 50
epoch:  24
epoch:  25 val_f1:  0.7740797592786492 val_auroc:  0.8692956349206349 val_auprc:  0.9353585346195237
EarlyStopping counter: 2 out of 50
epoch:  25
epoch:  26 val_f1:  0.7755600530392909 val_auroc:  0.871031746031746 val_auprc:  0.9368090029631604
Validation loss improved to 0.823621
epoch:  26
epoch:  27 val_f1:  0.7774525435694851 val_auroc:  0.8678075396825398 val_auprc:  0.9353072167798591
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7771751194325146 val_auroc:  0.8715277777777777 val_auprc:  0.9371007253713481
Validation loss improved to 0.816131
epoch:  28
epoch:  29 val_f1:  0.7988956640912072 val_auroc:  0.8653273809523809 val_auprc:  0.9339073471463086
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.7765822970867508 val_auroc:  0.8702876984126984 val_auprc:  0.9371217120594264
Validation loss improved to 0.808149
epoch:  30
epoch:  31 val_f1:  0.7761264822134387 val_auroc:  0.869295634920635 val_auprc:  0.9365955984996166
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.79396185483142 val_auroc:  0.8675595238095238 val_auprc:  0.9352673363694533
EarlyStopping counter: 2 out of 50
epoch:  32
epoch:  33 val_f1:  0.79396185483142 val_auroc:  0.869295634920635 val_auprc:  0.9361673716473167
EarlyStopping counter: 3 out of 50
epoch:  33
epoch:  34 val_f1:  0.773156899810964 val_auroc:  0.8665674603174603 val_auprc:  0.9354511044768734
EarlyStopping counter: 4 out of 50
epoch:  34
epoch:  35 val_f1:  0.7940993788819876 val_auroc:  0.8611111111111112 val_auprc:  0.9327636383006737
EarlyStopping counter: 5 out of 50
epoch:  35
epoch:  36 val_f1:  0.7833564971403972 val_auroc:  0.8695436507936508 val_auprc:  0.9368976412936327
Validation loss improved to 0.792399
epoch:  36
epoch:  37 val_f1:  0.7881997743237336 val_auroc:  0.869047619047619 val_auprc:  0.9360133214663782
EarlyStopping counter: 1 out of 50
epoch:  37
epoch:  38 val_f1:  0.7745910427020087 val_auroc:  0.8633432539682541 val_auprc:  0.9334029993956244
EarlyStopping counter: 2 out of 50
epoch:  38
epoch:  39 val_f1:  0.7755600530392909 val_auroc:  0.8715277777777778 val_auprc:  0.9372648268161283
Validation loss improved to 0.792211
epoch:  39
epoch:  40 val_f1:  0.7810781559182691 val_auroc:  0.8640873015873015 val_auprc:  0.9337809396116916
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.795635738397158 val_auroc:  0.8683035714285714 val_auprc:  0.9354948439811809
EarlyStopping counter: 2 out of 50
epoch:  41
epoch:  42 val_f1:  0.782608695652174 val_auroc:  0.8638392857142857 val_auprc:  0.9329467143381649
EarlyStopping counter: 3 out of 50
epoch:  42
epoch:  43 val_f1:  0.7643897813155551 val_auroc:  0.8655753968253969 val_auprc:  0.9342145551008108
EarlyStopping counter: 4 out of 50
epoch:  43
epoch:  44 val_f1:  0.7774525435694851 val_auroc:  0.865327380952381 val_auprc:  0.9343760229556096
EarlyStopping counter: 5 out of 50
epoch:  44
epoch:  45 val_f1:  0.7578619292504286 val_auroc:  0.8653273809523808 val_auprc:  0.9342712930596643
EarlyStopping counter: 6 out of 50
epoch:  45
epoch:  46 val_f1:  0.7760956602080848 val_auroc:  0.8635912698412699 val_auprc:  0.9339051053244325
EarlyStopping counter: 7 out of 50
epoch:  46
epoch:  47 val_f1:  0.7884143290944841 val_auroc:  0.8561507936507936 val_auprc:  0.9302712695452002
EarlyStopping counter: 8 out of 50
epoch:  47
epoch:  48 val_f1:  0.770099160945843 val_auroc:  0.8705357142857142 val_auprc:  0.9376827061587527
Validation loss improved to 0.779518
epoch:  48
epoch:  49 val_f1:  0.7904805491990847 val_auroc:  0.8566468253968255 val_auprc:  0.9303597143924345
EarlyStopping counter: 1 out of 50
epoch:  49
epoch:  50 val_f1:  0.7839923367569581 val_auroc:  0.863343253968254 val_auprc:  0.9347964256983281
EarlyStopping counter: 2 out of 50
epoch:  50
epoch:  51 val_f1:  0.7793921916592724 val_auroc:  0.861111111111111 val_auprc:  0.9340191319567227
EarlyStopping counter: 3 out of 50
epoch:  51
epoch:  52 val_f1:  0.7810781559182691 val_auroc:  0.8628472222222222 val_auprc:  0.934461957647099
EarlyStopping counter: 4 out of 50
epoch:  52
epoch:  53 val_f1:  0.7839923367569581 val_auroc:  0.8645833333333333 val_auprc:  0.9358035670475855
EarlyStopping counter: 5 out of 50
epoch:  53
epoch:  54 val_f1:  0.7729303439448368 val_auroc:  0.8653273809523809 val_auprc:  0.9362299966248002
EarlyStopping counter: 6 out of 50
epoch:  54
epoch:  55 val_f1:  0.7839923367569581 val_auroc:  0.8660714285714287 val_auprc:  0.936579241669206
EarlyStopping counter: 7 out of 50
epoch:  55
epoch:  56 val_f1:  0.7786691885085516 val_auroc:  0.8680555555555555 val_auprc:  0.9372791785709063
EarlyStopping counter: 8 out of 50
epoch:  56
epoch:  57 val_f1:  0.8035275913020209 val_auroc:  0.8586309523809523 val_auprc:  0.9329950906460835
EarlyStopping counter: 9 out of 50
epoch:  57
epoch:  58 val_f1:  0.7626186906546727 val_auroc:  0.8707837301587301 val_auprc:  0.9380023096569805
Validation loss improved to 0.761080
epoch:  58
epoch:  59 val_f1:  0.7969889682024659 val_auroc:  0.8603670634920636 val_auprc:  0.9341053971940477
EarlyStopping counter: 1 out of 50
epoch:  59
epoch:  60 val_f1:  0.7863487611033193 val_auroc:  0.8635912698412699 val_auprc:  0.9354273152706506
EarlyStopping counter: 2 out of 50
epoch:  60
epoch:  61 val_f1:  0.7775412992804297 val_auroc:  0.861359126984127 val_auprc:  0.9345914627925931
EarlyStopping counter: 3 out of 50
epoch:  61
epoch:  62 val_f1:  0.7852367336641158 val_auroc:  0.8658234126984127 val_auprc:  0.9367292952372854
EarlyStopping counter: 4 out of 50
epoch:  62
epoch:  63 val_f1:  0.782608695652174 val_auroc:  0.8650793650793652 val_auprc:  0.9369323312688158
EarlyStopping counter: 5 out of 50
epoch:  63
epoch:  64 val_f1:  0.7904805491990847 val_auroc:  0.8635912698412699 val_auprc:  0.9362288306045626
EarlyStopping counter: 6 out of 50
epoch:  64
epoch:  65 val_f1:  0.7969889682024659 val_auroc:  0.8618551587301587 val_auprc:  0.9352778887370846
EarlyStopping counter: 7 out of 50
epoch:  65
epoch:  66 val_f1:  0.782608695652174 val_auroc:  0.8621031746031746 val_auprc:  0.9353714966925046
EarlyStopping counter: 8 out of 50
epoch:  66
epoch:  67 val_f1:  0.7745910427020087 val_auroc:  0.8628472222222222 val_auprc:  0.9358783469926242
EarlyStopping counter: 9 out of 50
epoch:  67
epoch:  68 val_f1:  0.7969889682024659 val_auroc:  0.8635912698412699 val_auprc:  0.9360948871471854
EarlyStopping counter: 10 out of 50
epoch:  68
epoch:  69 val_f1:  0.782608695652174 val_auroc:  0.8663194444444444 val_auprc:  0.9372981068888524
EarlyStopping counter: 11 out of 50
epoch:  69
epoch:  70 val_f1:  0.7904805491990847 val_auroc:  0.8630952380952381 val_auprc:  0.9358081719830633
EarlyStopping counter: 12 out of 50
epoch:  70
epoch:  71 val_f1:  0.7904805491990847 val_auroc:  0.8630952380952382 val_auprc:  0.9359728877885184
EarlyStopping counter: 13 out of 50
epoch:  71
epoch:  72 val_f1:  0.7745910427020087 val_auroc:  0.8623511904761906 val_auprc:  0.935567344025303
EarlyStopping counter: 14 out of 50
epoch:  72
epoch:  73 val_f1:  0.792371879328401 val_auroc:  0.8635912698412699 val_auprc:  0.9360632882413056
EarlyStopping counter: 15 out of 50
epoch:  73
epoch:  74 val_f1:  0.7904805491990847 val_auroc:  0.8648313492063492 val_auprc:  0.93664885112802
EarlyStopping counter: 16 out of 50
epoch:  74
epoch:  75 val_f1:  0.7988956640912072 val_auroc:  0.8650793650793651 val_auprc:  0.9367222980623906
EarlyStopping counter: 17 out of 50
epoch:  75
epoch:  76 val_f1:  0.7940993788819876 val_auroc:  0.8680555555555555 val_auprc:  0.9379973520702778
EarlyStopping counter: 18 out of 50
epoch:  76
epoch:  77 val_f1:  0.7988956640912072 val_auroc:  0.8645833333333333 val_auprc:  0.9367012517250961
EarlyStopping counter: 19 out of 50
epoch:  77
epoch:  78 val_f1:  0.7875799991742021 val_auroc:  0.8678075396825397 val_auprc:  0.9379539696920915
EarlyStopping counter: 20 out of 50
epoch:  78
epoch:  79 val_f1:  0.7904805491990847 val_auroc:  0.8648313492063491 val_auprc:  0.9367183563336439
EarlyStopping counter: 21 out of 50
epoch:  79
epoch:  80 val_f1:  0.7940993788819876 val_auroc:  0.867311507936508 val_auprc:  0.9376334397530677
EarlyStopping counter: 22 out of 50
epoch:  80
epoch:  81 val_f1:  0.7988956640912072 val_auroc:  0.8663194444444445 val_auprc:  0.9372130663818048
EarlyStopping counter: 23 out of 50
epoch:  81
epoch:  82 val_f1:  0.7971014492753623 val_auroc:  0.8717757936507937 val_auprc:  0.9394870772285947
EarlyStopping counter: 24 out of 50
epoch:  82
epoch:  83 val_f1:  0.7969889682024659 val_auroc:  0.8658234126984127 val_auprc:  0.9372057031872533
EarlyStopping counter: 25 out of 50
epoch:  83
epoch:  84 val_f1:  0.800639197204071 val_auroc:  0.8685515873015873 val_auprc:  0.9381888237454132
EarlyStopping counter: 26 out of 50
epoch:  84
epoch:  85 val_f1:  0.7988956640912072 val_auroc:  0.8638392857142857 val_auprc:  0.9362079801587628
EarlyStopping counter: 27 out of 50
epoch:  85
epoch:  86 val_f1:  0.792371879328401 val_auroc:  0.8683035714285714 val_auprc:  0.9382047452428948
EarlyStopping counter: 28 out of 50
epoch:  86
epoch:  87 val_f1:  0.800639197204071 val_auroc:  0.8690476190476191 val_auprc:  0.9383878437694775
EarlyStopping counter: 29 out of 50
epoch:  87
epoch:  88 val_f1:  0.7904805491990847 val_auroc:  0.8640873015873015 val_auprc:  0.9363940475701834
EarlyStopping counter: 30 out of 50
epoch:  88
epoch:  89 val_f1:  0.792371879328401 val_auroc:  0.8687996031746031 val_auprc:  0.9382504663904272
EarlyStopping counter: 31 out of 50
epoch:  89
epoch:  90 val_f1:  0.7875799991742021 val_auroc:  0.8697916666666666 val_auprc:  0.938543866303944
EarlyStopping counter: 32 out of 50
epoch:  90
epoch:  91 val_f1:  0.7988956640912072 val_auroc:  0.8683035714285714 val_auprc:  0.9380469697557259
EarlyStopping counter: 33 out of 50
epoch:  91
epoch:  92 val_f1:  0.800639197204071 val_auroc:  0.8680555555555555 val_auprc:  0.9379201671619575
EarlyStopping counter: 34 out of 50
epoch:  92
epoch:  93 val_f1:  0.800639197204071 val_auroc:  0.8685515873015873 val_auprc:  0.9382649392156227
EarlyStopping counter: 35 out of 50
epoch:  93
epoch:  94 val_f1:  0.7988956640912072 val_auroc:  0.8683035714285714 val_auprc:  0.9385848797654006
EarlyStopping counter: 36 out of 50
epoch:  94
epoch:  95 val_f1:  0.792371879328401 val_auroc:  0.871279761904762 val_auprc:  0.9401660912056137
EarlyStopping counter: 37 out of 50
epoch:  95
epoch:  96 val_f1:  0.792371879328401 val_auroc:  0.8700396825396826 val_auprc:  0.9392603738065948
EarlyStopping counter: 38 out of 50
epoch:  96
epoch:  97 val_f1:  0.7988956640912072 val_auroc:  0.8680555555555555 val_auprc:  0.9383857692829353
EarlyStopping counter: 39 out of 50
epoch:  97
epoch:  98 val_f1:  0.8022296544035674 val_auroc:  0.871279761904762 val_auprc:  0.9398991717954926
EarlyStopping counter: 40 out of 50
epoch:  98
epoch:  99 val_f1:  0.7988956640912072 val_auroc:  0.8685515873015873 val_auprc:  0.9385020309844013
EarlyStopping counter: 41 out of 50
epoch:  99
epoch:  100 val_f1:  0.792371879328401 val_auroc:  0.8707837301587301 val_auprc:  0.9395462650219919
EarlyStopping counter: 42 out of 50
epoch:  100
epoch:  101 val_f1:  0.7988956640912072 val_auroc:  0.8695436507936508 val_auprc:  0.9388389557603704
EarlyStopping counter: 43 out of 50
epoch:  101
epoch:  102 val_f1:  0.792371879328401 val_auroc:  0.8690476190476191 val_auprc:  0.9387276884877005
EarlyStopping counter: 44 out of 50
epoch:  102
epoch:  103 val_f1:  0.800639197204071 val_auroc:  0.8735119047619048 val_auprc:  0.9408550697137703
EarlyStopping counter: 45 out of 50
epoch:  103
epoch:  104 val_f1:  0.7988956640912072 val_auroc:  0.8692956349206349 val_auprc:  0.9390754319219459
EarlyStopping counter: 46 out of 50
epoch:  104
epoch:  105 val_f1:  0.792371879328401 val_auroc:  0.8692956349206349 val_auprc:  0.9388495817351664
EarlyStopping counter: 47 out of 50
epoch:  105
epoch:  106 val_f1:  0.8022296544035674 val_auroc:  0.8725198412698413 val_auprc:  0.9403025527779845
EarlyStopping counter: 48 out of 50
epoch:  106
epoch:  107 val_f1:  0.7988956640912072 val_auroc:  0.8712797619047619 val_auprc:  0.9396704837306223
EarlyStopping counter: 49 out of 50
epoch:  107
epoch:  108 val_f1:  0.792371879328401 val_auroc:  0.8727678571428572 val_auprc:  0.9405457384649899
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  34.61503624916077
{'time_elapsed': [34.61503624916077], 'epoch': [107], 'fold': [4], 'f1_train': [0.9982029282297181], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.792371879328401], 'auroc_test': [0.8727678571428572], 'auprc_test': [0.9405457384649899]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 128, 256]            768
│    └─BatchNorm1d: 2-2                  [64, 128, 256]            256
│    └─Tanh: 2-3                         [64, 128, 256]            --
│    └─MaxPool1d: 2-4                    [64, 128, 51]             --
│    └─Dropout: 2-5                      [64, 128, 51]             --
│    └─Flatten: 2-6                      [64, 6528]                --
│    └─Linear: 2-7                       [64, 1]                   6,529
==========================================================================================
Total params: 7,553
Trainable params: 7,553
Non-trainable params: 0
Total mult-adds (M): 13.02
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 33.55
Params size (MB): 0.03
Estimated Total Size (MB): 33.91
==========================================================================================
