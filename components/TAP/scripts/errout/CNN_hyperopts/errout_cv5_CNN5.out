config:  {'project': 'MHCCBM', 'name': 'CNN_5', 'config': {'hidden_channels': [1024], 'epochs': 500, 'kernel_size': 3, 'pool_kernel_size': 3, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6806660738824671 val_auroc:  0.687039764359352 val_auprc:  0.8334760861948227
epoch:  1
epoch:  2 val_f1:  0.47315831545290077 val_auroc:  0.7660775650466372 val_auprc:  0.8893467784287696
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.730071543320129 val_auroc:  0.7507363770250368 val_auprc:  0.874601752397127
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6311848711432113 val_auroc:  0.7790868924889544 val_auprc:  0.8985872180294914
Validation loss improved to 4.258126
epoch:  4
epoch:  5 val_f1:  0.7531731915989216 val_auroc:  0.769882179675994 val_auprc:  0.8898710475451259
Validation loss improved to 3.127734
epoch:  5
epoch:  6 val_f1:  0.5718321780024199 val_auroc:  0.7675503190967109 val_auprc:  0.890560770381408
Validation loss improved to 2.947379
epoch:  6
epoch:  7 val_f1:  0.707673860911271 val_auroc:  0.7695139911634756 val_auprc:  0.8913877285903355
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.5703506192714826 val_auroc:  0.7827687776141384 val_auprc:  0.9068164300377961
Validation loss improved to 2.922839
epoch:  8
epoch:  9 val_f1:  0.6876087591262989 val_auroc:  0.7962690230731467 val_auprc:  0.9150104014243299
Validation loss improved to 1.864188
epoch:  9
epoch:  10 val_f1:  0.722058496910722 val_auroc:  0.8021600392734413 val_auprc:  0.9179638296484787
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.6755136431395424 val_auroc:  0.7972508591065292 val_auprc:  0.9110522917374735
EarlyStopping counter: 2 out of 50
epoch:  11
epoch:  12 val_f1:  0.5977829430608437 val_auroc:  0.7600638193421699 val_auprc:  0.8952187362096151
EarlyStopping counter: 3 out of 50
epoch:  12
epoch:  13 val_f1:  0.3038384015115686 val_auroc:  0.7933235149729996 val_auprc:  0.9042608582064526
EarlyStopping counter: 4 out of 50
epoch:  13
epoch:  14 val_f1:  0.5736495549323253 val_auroc:  0.6662984781541482 val_auprc:  0.8736680769655518
EarlyStopping counter: 5 out of 50
epoch:  14
epoch:  15 val_f1:  0.6289646282660997 val_auroc:  0.8055964653902798 val_auprc:  0.9129808189569928
EarlyStopping counter: 6 out of 50
epoch:  15
epoch:  16 val_f1:  0.7617684906754855 val_auroc:  0.8306332842415317 val_auprc:  0.9305506766029185
EarlyStopping counter: 7 out of 50
epoch:  16
epoch:  17 val_f1:  0.694872962389582 val_auroc:  0.8269513991163476 val_auprc:  0.9294766972723889
EarlyStopping counter: 8 out of 50
epoch:  17
epoch:  18 val_f1:  0.751751326211758 val_auroc:  0.8249877270495828 val_auprc:  0.9255624396791706
EarlyStopping counter: 9 out of 50
epoch:  18
epoch:  19 val_f1:  0.7454557504588546 val_auroc:  0.82793323514973 val_auprc:  0.9273051812752766
EarlyStopping counter: 10 out of 50
epoch:  19
epoch:  20 val_f1:  0.7376969013024874 val_auroc:  0.8244968090328916 val_auprc:  0.9257056002267388
EarlyStopping counter: 11 out of 50
epoch:  20
epoch:  21 val_f1:  0.7092686867455189 val_auroc:  0.8296514482081493 val_auprc:  0.9287802792626833
EarlyStopping counter: 12 out of 50
epoch:  21
epoch:  22 val_f1:  0.7699730743399811 val_auroc:  0.8252331860579283 val_auprc:  0.9247738767657082
EarlyStopping counter: 13 out of 50
epoch:  22
epoch:  23 val_f1:  0.6882360925909661 val_auroc:  0.8276877761413843 val_auprc:  0.9257713145088576
EarlyStopping counter: 14 out of 50
epoch:  23
epoch:  24 val_f1:  0.681579990245092 val_auroc:  0.8343151693667157 val_auprc:  0.9287128789125314
EarlyStopping counter: 15 out of 50
epoch:  24
epoch:  25 val_f1:  0.7483101088021195 val_auroc:  0.8313696612665685 val_auprc:  0.926963469832496
EarlyStopping counter: 16 out of 50
epoch:  25
epoch:  26 val_f1:  0.7633550302615051 val_auroc:  0.8313696612665684 val_auprc:  0.9259973879675061
Validation loss improved to 1.737642
epoch:  26
epoch:  27 val_f1:  0.806394786639448 val_auroc:  0.8257241040746195 val_auprc:  0.9221478887800937
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.7239714721729109 val_auroc:  0.836033382425135 val_auprc:  0.9299865675050656
Validation loss improved to 1.642323
epoch:  28
epoch:  29 val_f1:  0.7681512331200245 val_auroc:  0.824251350024546 val_auprc:  0.9222888634008536
Validation loss improved to 1.536590
epoch:  29
epoch:  30 val_f1:  0.5815243457407987 val_auroc:  0.814187530682376 val_auprc:  0.9143957338404068
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.7391671278361928 val_auroc:  0.8215513009327442 val_auprc:  0.9218159799422192
Validation loss improved to 1.412928
epoch:  31
epoch:  32 val_f1:  0.7944676896257205 val_auroc:  0.8284241531664212 val_auprc:  0.9273632081974206
Validation loss improved to 1.269160
epoch:  32
epoch:  33 val_f1:  0.7622262794246104 val_auroc:  0.8188512518409425 val_auprc:  0.9181672065876697
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.7711689349644636 val_auroc:  0.8178694158075601 val_auprc:  0.917392945245575
EarlyStopping counter: 2 out of 50
epoch:  34
epoch:  35 val_f1:  0.7324246948924567 val_auroc:  0.824251350024546 val_auprc:  0.9219390917261019
EarlyStopping counter: 3 out of 50
epoch:  35
epoch:  36 val_f1:  0.6752910608296504 val_auroc:  0.8159057437407953 val_auprc:  0.9137202851440912
EarlyStopping counter: 4 out of 50
epoch:  36
epoch:  37 val_f1:  0.7536081085870222 val_auroc:  0.8298969072164948 val_auprc:  0.9256698945154247
EarlyStopping counter: 5 out of 50
epoch:  37
epoch:  38 val_f1:  0.6416835003980583 val_auroc:  0.8208149239077075 val_auprc:  0.9161339656977558
EarlyStopping counter: 6 out of 50
epoch:  38
epoch:  39 val_f1:  0.5016852445934621 val_auroc:  0.8159057437407953 val_auprc:  0.9115723684356797
EarlyStopping counter: 7 out of 50
epoch:  39
epoch:  40 val_f1:  0.7092686867455189 val_auroc:  0.8269513991163475 val_auprc:  0.9223597127445529
EarlyStopping counter: 8 out of 50
epoch:  40
epoch:  41 val_f1:  0.7237742540242516 val_auroc:  0.834806087383407 val_auprc:  0.9267107111417155
EarlyStopping counter: 9 out of 50
epoch:  41
epoch:  42 val_f1:  0.6954243384953055 val_auroc:  0.8279332351497299 val_auprc:  0.9208455910383855
EarlyStopping counter: 10 out of 50
epoch:  42
epoch:  43 val_f1:  0.5439120683527897 val_auroc:  0.8389788905252823 val_auprc:  0.9303152057304367
EarlyStopping counter: 11 out of 50
epoch:  43
epoch:  44 val_f1:  0.5644561401417391 val_auroc:  0.8392243495336278 val_auprc:  0.929411414745662
EarlyStopping counter: 12 out of 50
epoch:  44
epoch:  45 val_f1:  0.5528223933686859 val_auroc:  0.8375061364752087 val_auprc:  0.9337327362156738
EarlyStopping counter: 13 out of 50
epoch:  45
epoch:  46 val_f1:  0.6515899973778831 val_auroc:  0.8230240549828179 val_auprc:  0.9176407146014218
EarlyStopping counter: 14 out of 50
epoch:  46
epoch:  47 val_f1:  0.6794627975876525 val_auroc:  0.8355424644084438 val_auprc:  0.9295819330223527
EarlyStopping counter: 15 out of 50
epoch:  47
epoch:  48 val_f1:  0.7453039856444363 val_auroc:  0.829774177712322 val_auprc:  0.9187572365485002
EarlyStopping counter: 16 out of 50
epoch:  48
epoch:  49 val_f1:  0.7841726618705036 val_auroc:  0.8409425625920472 val_auprc:  0.928650456080997
EarlyStopping counter: 17 out of 50
epoch:  49
epoch:  50 val_f1:  0.7014928142762413 val_auroc:  0.8338242513500246 val_auprc:  0.9246461707667714
EarlyStopping counter: 18 out of 50
epoch:  50
epoch:  51 val_f1:  0.8095907478048824 val_auroc:  0.826092292587138 val_auprc:  0.9192422285991692
EarlyStopping counter: 19 out of 50
epoch:  51
epoch:  52 val_f1:  0.702570289683208 val_auroc:  0.8296514482081493 val_auprc:  0.9237366985007103
EarlyStopping counter: 20 out of 50
epoch:  52
epoch:  53 val_f1:  0.41765629830050655 val_auroc:  0.8352970054000982 val_auprc:  0.9300963495463608
EarlyStopping counter: 21 out of 50
epoch:  53
epoch:  54 val_f1:  0.6920377676353541 val_auroc:  0.8187285223367697 val_auprc:  0.9187055063644293
EarlyStopping counter: 22 out of 50
epoch:  54
epoch:  55 val_f1:  0.7138887478252691 val_auroc:  0.8460972017673049 val_auprc:  0.9388607617680074
EarlyStopping counter: 23 out of 50
epoch:  55
epoch:  56 val_f1:  0.7898876447331801 val_auroc:  0.8144329896907216 val_auprc:  0.912182875806119
EarlyStopping counter: 24 out of 50
epoch:  56
epoch:  57 val_f1:  0.7879228532067962 val_auroc:  0.8298969072164949 val_auprc:  0.9211227794045314
EarlyStopping counter: 25 out of 50
epoch:  57
epoch:  58 val_f1:  0.7490302789770621 val_auroc:  0.8217967599410899 val_auprc:  0.9194255235602362
EarlyStopping counter: 26 out of 50
epoch:  58
epoch:  59 val_f1:  0.7633714058926586 val_auroc:  0.825478645066274 val_auprc:  0.9197531190186887
EarlyStopping counter: 27 out of 50
epoch:  59
epoch:  60 val_f1:  0.7473654218886486 val_auroc:  0.8159057437407953 val_auprc:  0.910772196279586
EarlyStopping counter: 28 out of 50
epoch:  60
epoch:  61 val_f1:  0.7473654218886486 val_auroc:  0.8171330387825233 val_auprc:  0.9114192532644054
EarlyStopping counter: 29 out of 50
epoch:  61
epoch:  62 val_f1:  0.8095907478048824 val_auroc:  0.8313696612665684 val_auprc:  0.9230122231217316
EarlyStopping counter: 30 out of 50
epoch:  62
epoch:  63 val_f1:  0.7377351131143277 val_auroc:  0.8306332842415317 val_auprc:  0.9210247402822724
EarlyStopping counter: 31 out of 50
epoch:  63
epoch:  64 val_f1:  0.6920377676353541 val_auroc:  0.8338242513500246 val_auprc:  0.927050601401055
EarlyStopping counter: 32 out of 50
epoch:  64
epoch:  65 val_f1:  0.7971323289800215 val_auroc:  0.8316151202749141 val_auprc:  0.92308036440182
EarlyStopping counter: 33 out of 50
epoch:  65
epoch:  66 val_f1:  0.7985611510791367 val_auroc:  0.8441335297005401 val_auprc:  0.9319342248166018
EarlyStopping counter: 34 out of 50
epoch:  66
epoch:  67 val_f1:  0.7681512331200245 val_auroc:  0.8405743740795287 val_auprc:  0.9306895675085918
EarlyStopping counter: 35 out of 50
epoch:  67
epoch:  68 val_f1:  0.7954863587533922 val_auroc:  0.8375061364752087 val_auprc:  0.9271961528014432
EarlyStopping counter: 36 out of 50
epoch:  68
epoch:  69 val_f1:  0.8038021017043906 val_auroc:  0.8357879234167894 val_auprc:  0.924277673183221
EarlyStopping counter: 37 out of 50
epoch:  69
epoch:  70 val_f1:  0.7906450372602754 val_auroc:  0.8246195385370643 val_auprc:  0.9140247844792644
EarlyStopping counter: 38 out of 50
epoch:  70
epoch:  71 val_f1:  0.7826417810500232 val_auroc:  0.8268286696121748 val_auprc:  0.9168234601455043
EarlyStopping counter: 39 out of 50
epoch:  71
epoch:  72 val_f1:  0.7580594896895918 val_auroc:  0.8247422680412372 val_auprc:  0.9150678891342114
EarlyStopping counter: 40 out of 50
epoch:  72
epoch:  73 val_f1:  0.7906450372602754 val_auroc:  0.8317378497790868 val_auprc:  0.9226977503394351
EarlyStopping counter: 41 out of 50
epoch:  73
epoch:  74 val_f1:  0.7580594896895918 val_auroc:  0.8290378006872852 val_auprc:  0.9191338650117671
EarlyStopping counter: 42 out of 50
epoch:  74
epoch:  75 val_f1:  0.7745465218349855 val_auroc:  0.8296514482081493 val_auprc:  0.9190874149470485
EarlyStopping counter: 43 out of 50
epoch:  75
epoch:  76 val_f1:  0.7826417810500232 val_auroc:  0.8333333333333334 val_auprc:  0.9243111241491384
EarlyStopping counter: 44 out of 50
epoch:  76
epoch:  77 val_f1:  0.7745465218349855 val_auroc:  0.8343151693667158 val_auprc:  0.9249697115388258
EarlyStopping counter: 45 out of 50
epoch:  77
epoch:  78 val_f1:  0.7745465218349855 val_auroc:  0.8356651939126166 val_auprc:  0.9254771826598922
EarlyStopping counter: 46 out of 50
epoch:  78
epoch:  79 val_f1:  0.7745465218349855 val_auroc:  0.8354197349042709 val_auprc:  0.9254393908814906
EarlyStopping counter: 47 out of 50
epoch:  79
epoch:  80 val_f1:  0.7826417810500232 val_auroc:  0.8344378988708885 val_auprc:  0.9246922341745198
EarlyStopping counter: 48 out of 50
epoch:  80
epoch:  81 val_f1:  0.7826417810500232 val_auroc:  0.8303878252331861 val_auprc:  0.9184181963771434
EarlyStopping counter: 49 out of 50
epoch:  81
epoch:  82 val_f1:  0.7580594896895918 val_auroc:  0.83100147275405 val_auprc:  0.9199875017843402
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  2318.7160501480103
{'time_elapsed': [2318.7160501480103], 'epoch': [81], 'fold': [0], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7580594896895918], 'auroc_test': [0.83100147275405], 'auprc_test': [0.9199875017843402]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1278]          --
│    └─Dropout: 2-5                      [64, 1024, 1278]          --
│    └─Flatten: 2-6                      [64, 1308672]             --
│    └─Linear: 2-7                       [64, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 419.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1342.18
Params size (MB): 5.26
Estimated Total Size (MB): 1347.76
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6755136431395424 val_auroc:  0.6610211094747178 val_auprc:  0.8297017134351768
epoch:  1
epoch:  2 val_f1:  0.6341245266055859 val_auroc:  0.6861806578301424 val_auprc:  0.8523249219229908
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.7225455998837295 val_auroc:  0.7650957290132548 val_auprc:  0.9066831860778847
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.7235944791518311 val_auroc:  0.7816642120765831 val_auprc:  0.9076110819798547
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.6994072447658564 val_auroc:  0.7954099165439372 val_auprc:  0.9120757689649179
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.6130488198195008 val_auroc:  0.7866961217476681 val_auprc:  0.9080460936216921
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.5824847418202775 val_auroc:  0.7603092783505155 val_auprc:  0.9004897074285152
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.4785239102835378 val_auroc:  0.8046146293568973 val_auprc:  0.9189154036834326
EarlyStopping counter: 7 out of 50
epoch:  8
epoch:  9 val_f1:  0.7170655771870609 val_auroc:  0.8114874815905744 val_auprc:  0.9191534503048645
EarlyStopping counter: 8 out of 50
epoch:  9
epoch:  10 val_f1:  0.7745465218349855 val_auroc:  0.8150466372115857 val_auprc:  0.9166089576919434
Validation loss improved to 0.632877
epoch:  10
epoch:  11 val_f1:  0.7473302173830908 val_auroc:  0.8071919489445263 val_auprc:  0.9115682275536773
Validation loss improved to 0.614332
epoch:  11
epoch:  12 val_f1:  0.6813982824467933 val_auroc:  0.7927098674521355 val_auprc:  0.9045026265167815
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.6262616863622784 val_auroc:  0.8014236622484046 val_auprc:  0.9087190069246591
EarlyStopping counter: 2 out of 50
epoch:  13
epoch:  14 val_f1:  0.5901444900487328 val_auroc:  0.7890279823269514 val_auprc:  0.9094928149500318
EarlyStopping counter: 3 out of 50
epoch:  14
epoch:  15 val_f1:  0.7099629667254643 val_auroc:  0.7943053510063819 val_auprc:  0.9059922181596847
EarlyStopping counter: 4 out of 50
epoch:  15
epoch:  16 val_f1:  0.7096759374109908 val_auroc:  0.8024054982817869 val_auprc:  0.9122902263629634
EarlyStopping counter: 5 out of 50
epoch:  16
epoch:  17 val_f1:  0.7446689355102744 val_auroc:  0.8186057928325969 val_auprc:  0.9203311761956128
EarlyStopping counter: 6 out of 50
epoch:  17
epoch:  18 val_f1:  0.7496568898727172 val_auroc:  0.8264604810996563 val_auprc:  0.922322768391203
Validation loss improved to 0.393688
epoch:  18
epoch:  19 val_f1:  0.7166849710626011 val_auroc:  0.8338242513500247 val_auprc:  0.9277980652646466
EarlyStopping counter: 1 out of 50
epoch:  19
epoch:  20 val_f1:  0.7034651178140057 val_auroc:  0.8275650466372116 val_auprc:  0.9225963696399442
EarlyStopping counter: 2 out of 50
epoch:  20
epoch:  21 val_f1:  0.726400389202679 val_auroc:  0.8247422680412372 val_auprc:  0.9186286692976906
Validation loss improved to 0.315499
epoch:  21
epoch:  22 val_f1:  0.6490442784409426 val_auroc:  0.824251350024546 val_auprc:  0.9202253671214331
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7024482739389885 val_auroc:  0.8264604810996563 val_auprc:  0.9229575637464018
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.742136387976997 val_auroc:  0.824251350024546 val_auprc:  0.9198054568876277
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.5901444900487328 val_auroc:  0.8003190967108493 val_auprc:  0.8997121804972539
EarlyStopping counter: 4 out of 50
epoch:  25
epoch:  26 val_f1:  0.6982612029498659 val_auroc:  0.8300196367206677 val_auprc:  0.9252422865440881
EarlyStopping counter: 5 out of 50
epoch:  26
epoch:  27 val_f1:  0.7963871971298289 val_auroc:  0.8338242513500246 val_auprc:  0.9252385933932714
EarlyStopping counter: 6 out of 50
epoch:  27
epoch:  28 val_f1:  0.7644702419882276 val_auroc:  0.8271968581246932 val_auprc:  0.9185996888004742
EarlyStopping counter: 7 out of 50
epoch:  28
epoch:  29 val_f1:  0.7226305629385982 val_auroc:  0.8339469808541974 val_auprc:  0.9220708512781279
EarlyStopping counter: 8 out of 50
epoch:  29
epoch:  30 val_f1:  0.7770871369605723 val_auroc:  0.829160530191458 val_auprc:  0.921329187798131
Validation loss improved to 0.271333
epoch:  30
epoch:  31 val_f1:  0.7813819697019021 val_auroc:  0.8203240058910162 val_auprc:  0.9153926421727909
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.7724732835091151 val_auroc:  0.8298969072164949 val_auprc:  0.9186290149398751
Validation loss improved to 0.240231
epoch:  32
epoch:  33 val_f1:  0.7199392779354498 val_auroc:  0.8205694648993618 val_auprc:  0.9125759073005997
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.6213039568345323 val_auroc:  0.8097692685321551 val_auprc:  0.9081909586392909
EarlyStopping counter: 2 out of 50
epoch:  34
epoch:  35 val_f1:  0.7712620601193464 val_auroc:  0.8274423171330388 val_auprc:  0.9154469727494112
EarlyStopping counter: 3 out of 50
epoch:  35
epoch:  36 val_f1:  0.7445706985813217 val_auroc:  0.8101374570446735 val_auprc:  0.8971292357787335
EarlyStopping counter: 4 out of 50
epoch:  36
epoch:  37 val_f1:  0.7823449348629204 val_auroc:  0.8384879725085911 val_auprc:  0.9128618968870914
EarlyStopping counter: 5 out of 50
epoch:  37
epoch:  38 val_f1:  0.7514700844366524 val_auroc:  0.8394698085419736 val_auprc:  0.9213282034193192
Validation loss improved to 0.218077
epoch:  38
epoch:  39 val_f1:  0.7661589271850144 val_auroc:  0.8138193421698575 val_auprc:  0.9062260899365899
Validation loss improved to 0.138132
epoch:  39
epoch:  40 val_f1:  0.8036372932111164 val_auroc:  0.8289150711831124 val_auprc:  0.9100474160199362
Validation loss improved to 0.123702
epoch:  40
epoch:  41 val_f1:  0.7748796193569787 val_auroc:  0.8145557191948944 val_auprc:  0.8967984025985912
Validation loss improved to 0.094404
epoch:  41
epoch:  42 val_f1:  0.8036372932111164 val_auroc:  0.820446735395189 val_auprc:  0.8982252958919181
EarlyStopping counter: 1 out of 50
epoch:  42
epoch:  43 val_f1:  0.7185321510233673 val_auroc:  0.8209376534118802 val_auprc:  0.9027333667030819
EarlyStopping counter: 2 out of 50
epoch:  43
epoch:  44 val_f1:  0.7823449348629204 val_auroc:  0.8227785959744723 val_auprc:  0.9061811435776795
EarlyStopping counter: 3 out of 50
epoch:  44
epoch:  45 val_f1:  0.7670032041593616 val_auroc:  0.8182376043200785 val_auprc:  0.9007247181807547
EarlyStopping counter: 4 out of 50
epoch:  45
epoch:  46 val_f1:  0.7598715939807772 val_auroc:  0.8127147766323024 val_auprc:  0.8965311905501184
EarlyStopping counter: 5 out of 50
epoch:  46
epoch:  47 val_f1:  0.7919479944965341 val_auroc:  0.8202012763868435 val_auprc:  0.8988642511183353
Validation loss improved to 0.076514
epoch:  47
epoch:  48 val_f1:  0.7661589271850144 val_auroc:  0.8200785468826706 val_auprc:  0.9004406260907694
EarlyStopping counter: 1 out of 50
epoch:  48
epoch:  49 val_f1:  0.7788179744018625 val_auroc:  0.8224104074619539 val_auprc:  0.9022582674318411
EarlyStopping counter: 2 out of 50
epoch:  49
epoch:  50 val_f1:  0.7873856121514594 val_auroc:  0.819219440353461 val_auprc:  0.896094830780747
EarlyStopping counter: 3 out of 50
epoch:  50
epoch:  51 val_f1:  0.7635640416019908 val_auroc:  0.8188512518409427 val_auprc:  0.8922746048202194
Validation loss improved to 0.071497
epoch:  51
epoch:  52 val_f1:  0.7661589271850144 val_auroc:  0.8177466863033873 val_auprc:  0.8925863987239135
EarlyStopping counter: 1 out of 50
epoch:  52
epoch:  53 val_f1:  0.7938350857775318 val_auroc:  0.8214285714285715 val_auprc:  0.899216487606061
EarlyStopping counter: 2 out of 50
epoch:  53
epoch:  54 val_f1:  0.7698533480907581 val_auroc:  0.822901325478645 val_auprc:  0.8982857635783307
EarlyStopping counter: 3 out of 50
epoch:  54
epoch:  55 val_f1:  0.7661589271850144 val_auroc:  0.821060382916053 val_auprc:  0.8961335449792427
EarlyStopping counter: 4 out of 50
epoch:  55
epoch:  56 val_f1:  0.757304835743056 val_auroc:  0.8198330878743251 val_auprc:  0.8951223846461935
EarlyStopping counter: 5 out of 50
epoch:  56
epoch:  57 val_f1:  0.757304835743056 val_auroc:  0.8189739813451153 val_auprc:  0.8944775924125906
EarlyStopping counter: 6 out of 50
epoch:  57
epoch:  58 val_f1:  0.7791090204759269 val_auroc:  0.819219440353461 val_auprc:  0.888591863272052
EarlyStopping counter: 7 out of 50
epoch:  58
epoch:  59 val_f1:  0.7791090204759269 val_auroc:  0.8187285223367697 val_auprc:  0.8880450910888271
EarlyStopping counter: 8 out of 50
epoch:  59
epoch:  60 val_f1:  0.7622262794246104 val_auroc:  0.8173784977908689 val_auprc:  0.8930559558183455
EarlyStopping counter: 9 out of 50
epoch:  60
epoch:  61 val_f1:  0.7510724063582411 val_auroc:  0.8193421698576338 val_auprc:  0.894947017826731
EarlyStopping counter: 10 out of 50
epoch:  61
epoch:  62 val_f1:  0.7685409504908388 val_auroc:  0.8210603829160531 val_auprc:  0.8959001814410155
EarlyStopping counter: 11 out of 50
epoch:  62
epoch:  63 val_f1:  0.7510724063582411 val_auroc:  0.8208149239077075 val_auprc:  0.8958407871959173
EarlyStopping counter: 12 out of 50
epoch:  63
epoch:  64 val_f1:  0.7748796193569787 val_auroc:  0.8200785468826706 val_auprc:  0.894041132628139
EarlyStopping counter: 13 out of 50
epoch:  64
epoch:  65 val_f1:  0.7661589271850144 val_auroc:  0.8213058419243986 val_auprc:  0.8949033566137816
EarlyStopping counter: 14 out of 50
epoch:  65
epoch:  66 val_f1:  0.757304835743056 val_auroc:  0.8190967108492881 val_auprc:  0.8978450145740059
EarlyStopping counter: 15 out of 50
epoch:  66
epoch:  67 val_f1:  0.7873856121514594 val_auroc:  0.822287677957781 val_auprc:  0.8957510709410696
EarlyStopping counter: 16 out of 50
epoch:  67
epoch:  68 val_f1:  0.7791090204759269 val_auroc:  0.8254786450662739 val_auprc:  0.8974353542539754
EarlyStopping counter: 17 out of 50
epoch:  68
epoch:  69 val_f1:  0.7698533480907581 val_auroc:  0.8209376534118802 val_auprc:  0.9000797768302441
EarlyStopping counter: 18 out of 50
epoch:  69
epoch:  70 val_f1:  0.7607401077265918 val_auroc:  0.8216740304369171 val_auprc:  0.8982223949497602
Validation loss improved to 0.070904
epoch:  70
epoch:  71 val_f1:  0.7598715939807772 val_auroc:  0.8237604320078546 val_auprc:  0.8978981266656304
EarlyStopping counter: 1 out of 50
epoch:  71
epoch:  72 val_f1:  0.7812454480117876 val_auroc:  0.8247422680412372 val_auprc:  0.8993741813811367
EarlyStopping counter: 2 out of 50
epoch:  72
epoch:  73 val_f1:  0.7510724063582411 val_auroc:  0.8215513009327443 val_auprc:  0.8981947832902796
EarlyStopping counter: 3 out of 50
epoch:  73
epoch:  74 val_f1:  0.7685409504908388 val_auroc:  0.8224104074619538 val_auprc:  0.8975302748020981
EarlyStopping counter: 4 out of 50
epoch:  74
epoch:  75 val_f1:  0.7698533480907581 val_auroc:  0.8233922434953364 val_auprc:  0.9004683821570172
EarlyStopping counter: 5 out of 50
epoch:  75
epoch:  76 val_f1:  0.7598715939807772 val_auroc:  0.8213058419243986 val_auprc:  0.8999456015876897
EarlyStopping counter: 6 out of 50
epoch:  76
epoch:  77 val_f1:  0.7707245329923307 val_auroc:  0.8226558664702995 val_auprc:  0.897123873191568
EarlyStopping counter: 7 out of 50
epoch:  77
epoch:  78 val_f1:  0.7724732835091151 val_auroc:  0.823514972999509 val_auprc:  0.9006642332863403
Validation loss improved to 0.070595
epoch:  78
epoch:  79 val_f1:  0.7661589271850144 val_auroc:  0.8230240549828178 val_auprc:  0.8994968761441627
EarlyStopping counter: 1 out of 50
epoch:  79
epoch:  80 val_f1:  0.7607401077265918 val_auroc:  0.822901325478645 val_auprc:  0.9035717905555372
Validation loss improved to 0.068257
epoch:  80
epoch:  81 val_f1:  0.7607401077265918 val_auroc:  0.8246195385370643 val_auprc:  0.9041985484891536
EarlyStopping counter: 1 out of 50
epoch:  81
epoch:  82 val_f1:  0.7661589271850144 val_auroc:  0.8235149729995092 val_auprc:  0.9006380610070366
EarlyStopping counter: 2 out of 50
epoch:  82
epoch:  83 val_f1:  0.7707245329923307 val_auroc:  0.8220422189494354 val_auprc:  0.8976615176873128
EarlyStopping counter: 3 out of 50
epoch:  83
epoch:  84 val_f1:  0.7635640416019908 val_auroc:  0.8225331369661266 val_auprc:  0.9011260190666435
EarlyStopping counter: 4 out of 50
epoch:  84
epoch:  85 val_f1:  0.7788179744018625 val_auroc:  0.8238831615120276 val_auprc:  0.9015250484278324
Validation loss improved to 0.062743
epoch:  85
epoch:  86 val_f1:  0.7635640416019908 val_auroc:  0.8216740304369171 val_auprc:  0.9007484637950849
EarlyStopping counter: 1 out of 50
epoch:  86
epoch:  87 val_f1:  0.7635640416019908 val_auroc:  0.8224104074619537 val_auprc:  0.9017767739792919
EarlyStopping counter: 2 out of 50
epoch:  87
epoch:  88 val_f1:  0.7724732835091151 val_auroc:  0.8244968090328915 val_auprc:  0.9020847276641644
EarlyStopping counter: 3 out of 50
epoch:  88
epoch:  89 val_f1:  0.7698533480907581 val_auroc:  0.8243740795287187 val_auprc:  0.9044250978533431
EarlyStopping counter: 4 out of 50
epoch:  89
epoch:  90 val_f1:  0.7635640416019908 val_auroc:  0.8224104074619538 val_auprc:  0.9025816361222212
EarlyStopping counter: 5 out of 50
epoch:  90
epoch:  91 val_f1:  0.7748796193569787 val_auroc:  0.8252331860579283 val_auprc:  0.9025310324112941
EarlyStopping counter: 6 out of 50
epoch:  91
epoch:  92 val_f1:  0.7788179744018625 val_auroc:  0.8233922434953364 val_auprc:  0.9027742335021769
Validation loss improved to 0.062162
epoch:  92
epoch:  93 val_f1:  0.7724732835091151 val_auroc:  0.823637702503682 val_auprc:  0.9028147351651095
EarlyStopping counter: 1 out of 50
epoch:  93
epoch:  94 val_f1:  0.7598715939807772 val_auroc:  0.8237604320078548 val_auprc:  0.9029392489562479
EarlyStopping counter: 2 out of 50
epoch:  94
epoch:  95 val_f1:  0.7598715939807772 val_auroc:  0.8240058910162004 val_auprc:  0.9023873167429385
EarlyStopping counter: 3 out of 50
epoch:  95
epoch:  96 val_f1:  0.7685409504908388 val_auroc:  0.8226558664702995 val_auprc:  0.9020473481916178
EarlyStopping counter: 4 out of 50
epoch:  96
epoch:  97 val_f1:  0.7685409504908388 val_auroc:  0.8226558664702994 val_auprc:  0.9021612569011848
EarlyStopping counter: 5 out of 50
epoch:  97
epoch:  98 val_f1:  0.7724732835091151 val_auroc:  0.8243740795287188 val_auprc:  0.903506675557938
EarlyStopping counter: 6 out of 50
epoch:  98
epoch:  99 val_f1:  0.7788179744018625 val_auroc:  0.8238831615120276 val_auprc:  0.9038885785084982
EarlyStopping counter: 7 out of 50
epoch:  99
epoch:  100 val_f1:  0.7724732835091151 val_auroc:  0.822901325478645 val_auprc:  0.9034912023070117
EarlyStopping counter: 8 out of 50
epoch:  100
epoch:  101 val_f1:  0.7598715939807772 val_auroc:  0.823514972999509 val_auprc:  0.9021372526210593
EarlyStopping counter: 9 out of 50
epoch:  101
epoch:  102 val_f1:  0.7873856121514594 val_auroc:  0.8219194894452627 val_auprc:  0.8971346031961542
EarlyStopping counter: 10 out of 50
epoch:  102
epoch:  103 val_f1:  0.7791090204759269 val_auroc:  0.822287677957781 val_auprc:  0.9011133248248913
EarlyStopping counter: 11 out of 50
epoch:  103
epoch:  104 val_f1:  0.7685409504908388 val_auroc:  0.8225331369661266 val_auprc:  0.9025038360534351
EarlyStopping counter: 12 out of 50
epoch:  104
epoch:  105 val_f1:  0.7724732835091151 val_auroc:  0.822287677957781 val_auprc:  0.9018565210517357
EarlyStopping counter: 13 out of 50
epoch:  105
epoch:  106 val_f1:  0.7598715939807772 val_auroc:  0.8233922434953364 val_auprc:  0.9037845694239943
EarlyStopping counter: 14 out of 50
epoch:  106
epoch:  107 val_f1:  0.7685409504908388 val_auroc:  0.8231467844869907 val_auprc:  0.9033995830376023
EarlyStopping counter: 15 out of 50
epoch:  107
epoch:  108 val_f1:  0.7707245329923307 val_auroc:  0.8231467844869906 val_auprc:  0.9027670859816397
EarlyStopping counter: 16 out of 50
epoch:  108
epoch:  109 val_f1:  0.7598715939807772 val_auroc:  0.823637702503682 val_auprc:  0.9037617228258968
EarlyStopping counter: 17 out of 50
epoch:  109
epoch:  110 val_f1:  0.7598715939807772 val_auroc:  0.8233922434953364 val_auprc:  0.9037447168790735
EarlyStopping counter: 18 out of 50
epoch:  110
epoch:  111 val_f1:  0.7788179744018625 val_auroc:  0.8246195385370644 val_auprc:  0.9048572362295549
Validation loss improved to 0.056087
epoch:  111
epoch:  112 val_f1:  0.7635640416019908 val_auroc:  0.8215513009327443 val_auprc:  0.9029570194980039
EarlyStopping counter: 1 out of 50
epoch:  112
epoch:  113 val_f1:  0.7685409504908388 val_auroc:  0.8221649484536083 val_auprc:  0.903085784151031
EarlyStopping counter: 2 out of 50
epoch:  113
epoch:  114 val_f1:  0.7791090204759269 val_auroc:  0.8226558664702994 val_auprc:  0.902438069925358
EarlyStopping counter: 3 out of 50
epoch:  114
epoch:  115 val_f1:  0.7598715939807772 val_auroc:  0.8226558664702995 val_auprc:  0.9030881573822884
EarlyStopping counter: 4 out of 50
epoch:  115
epoch:  116 val_f1:  0.7724732835091151 val_auroc:  0.8215513009327442 val_auprc:  0.9028602615935409
EarlyStopping counter: 5 out of 50
epoch:  116
epoch:  117 val_f1:  0.7598715939807772 val_auroc:  0.8226558664702994 val_auprc:  0.902612089464631
EarlyStopping counter: 6 out of 50
epoch:  117
epoch:  118 val_f1:  0.7685409504908388 val_auroc:  0.8251104565537556 val_auprc:  0.9041892198160408
EarlyStopping counter: 7 out of 50
epoch:  118
epoch:  119 val_f1:  0.7855164986057286 val_auroc:  0.8244968090328916 val_auprc:  0.9042188257275872
EarlyStopping counter: 8 out of 50
epoch:  119
epoch:  120 val_f1:  0.7685409504908388 val_auroc:  0.8246195385370643 val_auprc:  0.9038793499403189
EarlyStopping counter: 9 out of 50
epoch:  120
epoch:  121 val_f1:  0.7685409504908388 val_auroc:  0.823514972999509 val_auprc:  0.9037676372913951
EarlyStopping counter: 10 out of 50
epoch:  121
epoch:  122 val_f1:  0.7724732835091151 val_auroc:  0.8243740795287188 val_auprc:  0.9042915306627723
EarlyStopping counter: 11 out of 50
epoch:  122
epoch:  123 val_f1:  0.7685409504908388 val_auroc:  0.8241286205203732 val_auprc:  0.9037877994242473
EarlyStopping counter: 12 out of 50
epoch:  123
epoch:  124 val_f1:  0.7685409504908388 val_auroc:  0.822901325478645 val_auprc:  0.9027202016132282
EarlyStopping counter: 13 out of 50
epoch:  124
epoch:  125 val_f1:  0.7598715939807772 val_auroc:  0.8256013745704468 val_auprc:  0.9061878858479653
EarlyStopping counter: 14 out of 50
epoch:  125
epoch:  126 val_f1:  0.7685409504908388 val_auroc:  0.8247422680412372 val_auprc:  0.9041647453787485
EarlyStopping counter: 15 out of 50
epoch:  126
epoch:  127 val_f1:  0.7661589271850144 val_auroc:  0.8237604320078548 val_auprc:  0.904609161963416
EarlyStopping counter: 16 out of 50
epoch:  127
epoch:  128 val_f1:  0.7685409504908388 val_auroc:  0.8240058910162003 val_auprc:  0.904629221371868
EarlyStopping counter: 17 out of 50
epoch:  128
epoch:  129 val_f1:  0.7770871369605723 val_auroc:  0.8237604320078546 val_auprc:  0.9039862188657779
EarlyStopping counter: 18 out of 50
epoch:  129
epoch:  130 val_f1:  0.7661589271850144 val_auroc:  0.8252331860579284 val_auprc:  0.9059590539796598
EarlyStopping counter: 19 out of 50
epoch:  130
epoch:  131 val_f1:  0.7598715939807772 val_auroc:  0.8257241040746196 val_auprc:  0.9063124824963876
EarlyStopping counter: 20 out of 50
epoch:  131
epoch:  132 val_f1:  0.7685409504908388 val_auroc:  0.8242513500245459 val_auprc:  0.9058879126907653
EarlyStopping counter: 21 out of 50
epoch:  132
epoch:  133 val_f1:  0.7685409504908388 val_auroc:  0.8262150220913108 val_auprc:  0.9068326702891257
EarlyStopping counter: 22 out of 50
epoch:  133
epoch:  134 val_f1:  0.7855164986057286 val_auroc:  0.8254786450662739 val_auprc:  0.9049172695811816
EarlyStopping counter: 23 out of 50
epoch:  134
epoch:  135 val_f1:  0.7685409504908388 val_auroc:  0.8244968090328915 val_auprc:  0.905077205621104
EarlyStopping counter: 24 out of 50
epoch:  135
epoch:  136 val_f1:  0.7724732835091151 val_auroc:  0.8238831615120275 val_auprc:  0.9039209889531493
EarlyStopping counter: 25 out of 50
epoch:  136
epoch:  137 val_f1:  0.7598715939807772 val_auroc:  0.8232695139911634 val_auprc:  0.9046410937847581
EarlyStopping counter: 26 out of 50
epoch:  137
epoch:  138 val_f1:  0.7685409504908388 val_auroc:  0.8240058910162004 val_auprc:  0.904536903064433
EarlyStopping counter: 27 out of 50
epoch:  138
epoch:  139 val_f1:  0.7685409504908388 val_auroc:  0.8258468335787924 val_auprc:  0.9059828767964884
EarlyStopping counter: 28 out of 50
epoch:  139
epoch:  140 val_f1:  0.7788179744018625 val_auroc:  0.8241286205203731 val_auprc:  0.9061329026277212
EarlyStopping counter: 29 out of 50
epoch:  140
epoch:  141 val_f1:  0.7788179744018625 val_auroc:  0.8233922434953364 val_auprc:  0.9057472524316892
EarlyStopping counter: 30 out of 50
epoch:  141
epoch:  142 val_f1:  0.7685409504908388 val_auroc:  0.8229013254786451 val_auprc:  0.9041559261651497
EarlyStopping counter: 31 out of 50
epoch:  142
epoch:  143 val_f1:  0.7685409504908388 val_auroc:  0.825478645066274 val_auprc:  0.9057643405112389
EarlyStopping counter: 32 out of 50
epoch:  143
epoch:  144 val_f1:  0.7685409504908388 val_auroc:  0.824251350024546 val_auprc:  0.9052569206419756
EarlyStopping counter: 33 out of 50
epoch:  144
epoch:  145 val_f1:  0.7685409504908388 val_auroc:  0.8243740795287188 val_auprc:  0.9044631761786583
EarlyStopping counter: 34 out of 50
epoch:  145
epoch:  146 val_f1:  0.7685409504908388 val_auroc:  0.82486499754541 val_auprc:  0.9062625581355759
EarlyStopping counter: 35 out of 50
epoch:  146
epoch:  147 val_f1:  0.7685409504908388 val_auroc:  0.8240058910162003 val_auprc:  0.9057818464407054
EarlyStopping counter: 36 out of 50
epoch:  147
epoch:  148 val_f1:  0.7685409504908388 val_auroc:  0.8251104565537556 val_auprc:  0.9064592842086875
EarlyStopping counter: 37 out of 50
epoch:  148
epoch:  149 val_f1:  0.7788179744018625 val_auroc:  0.8253559155621012 val_auprc:  0.9078174496197708
EarlyStopping counter: 38 out of 50
epoch:  149
epoch:  150 val_f1:  0.7598715939807772 val_auroc:  0.8240058910162004 val_auprc:  0.9054359994795772
EarlyStopping counter: 39 out of 50
epoch:  150
epoch:  151 val_f1:  0.7685409504908388 val_auroc:  0.8252331860579284 val_auprc:  0.9056453115083144
EarlyStopping counter: 40 out of 50
epoch:  151
epoch:  152 val_f1:  0.7598715939807772 val_auroc:  0.8249877270495827 val_auprc:  0.9060293802331414
EarlyStopping counter: 41 out of 50
epoch:  152
epoch:  153 val_f1:  0.7788179744018625 val_auroc:  0.8254786450662739 val_auprc:  0.9077656576924881
EarlyStopping counter: 42 out of 50
epoch:  153
epoch:  154 val_f1:  0.7685409504908388 val_auroc:  0.8233922434953362 val_auprc:  0.904226318286965
EarlyStopping counter: 43 out of 50
epoch:  154
epoch:  155 val_f1:  0.7685409504908388 val_auroc:  0.8232695139911635 val_auprc:  0.9045611375938745
EarlyStopping counter: 44 out of 50
epoch:  155
epoch:  156 val_f1:  0.7685409504908388 val_auroc:  0.8240058910162003 val_auprc:  0.9057044667537766
EarlyStopping counter: 45 out of 50
epoch:  156
epoch:  157 val_f1:  0.7685409504908388 val_auroc:  0.8254786450662739 val_auprc:  0.9062696047979123
EarlyStopping counter: 46 out of 50
epoch:  157
epoch:  158 val_f1:  0.7685409504908388 val_auroc:  0.8257241040746196 val_auprc:  0.9070969991060659
EarlyStopping counter: 47 out of 50
epoch:  158
epoch:  159 val_f1:  0.7685409504908388 val_auroc:  0.8258468335787924 val_auprc:  0.9071318273264891
EarlyStopping counter: 48 out of 50
epoch:  159
epoch:  160 val_f1:  0.7685409504908388 val_auroc:  0.8252331860579283 val_auprc:  0.9061885610886891
EarlyStopping counter: 49 out of 50
epoch:  160
epoch:  161 val_f1:  0.7685409504908388 val_auroc:  0.8269513991163475 val_auprc:  0.9085484760323113
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  4492.997843503952
{'time_elapsed': [4492.997843503952], 'epoch': [160], 'fold': [1], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7685409504908388], 'auroc_test': [0.8269513991163475], 'auprc_test': [0.9085484760323113]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1278]          --
│    └─Dropout: 2-5                      [64, 1024, 1278]          --
│    └─Flatten: 2-6                      [64, 1308672]             --
│    └─Linear: 2-7                       [64, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 419.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1342.18
Params size (MB): 5.26
Estimated Total Size (MB): 1347.76
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.3398212583117671 val_auroc:  0.5758468335787924 val_auprc:  0.7962665908739217
epoch:  1
epoch:  2 val_f1:  0.5111647886772253 val_auroc:  0.5703240058910162 val_auprc:  0.7826157106586098
Validation loss improved to 6.300820
epoch:  2
epoch:  3 val_f1:  0.4910452708816757 val_auroc:  0.5784241531664212 val_auprc:  0.7871813236937835
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.5720941319233769 val_auroc:  0.5850515463917525 val_auprc:  0.79154831669603
Validation loss improved to 5.377937
epoch:  4
epoch:  5 val_f1:  0.615332410516798 val_auroc:  0.6012518409425626 val_auprc:  0.8033692630273767
Validation loss improved to 4.286755
epoch:  5
epoch:  6 val_f1:  0.5997586346507209 val_auroc:  0.6438389788905253 val_auprc:  0.8263250793291255
Validation loss improved to 3.787157
epoch:  6
epoch:  7 val_f1:  0.6523888080851465 val_auroc:  0.6731713303878253 val_auprc:  0.8508434243553855
Validation loss improved to 2.983704
epoch:  7
epoch:  8 val_f1:  0.6262025972442385 val_auroc:  0.6919489445262641 val_auprc:  0.8543877649833933
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.5234992716223703 val_auroc:  0.7027491408934708 val_auprc:  0.860247533626917
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.6405511606040838 val_auroc:  0.7131811487481591 val_auprc:  0.8612368243019013
Validation loss improved to 2.404697
epoch:  10
epoch:  11 val_f1:  0.6320725385265299 val_auroc:  0.7202994599901816 val_auprc:  0.8613959907667947
Validation loss improved to 2.394348
epoch:  11
epoch:  12 val_f1:  0.6967556353929608 val_auroc:  0.7279086892488954 val_auprc:  0.8681478162438919
Validation loss improved to 1.515348
epoch:  12
epoch:  13 val_f1:  0.6909311987030095 val_auroc:  0.7250859106529209 val_auprc:  0.8627699847545821
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.693339873555701 val_auroc:  0.7320814923907707 val_auprc:  0.866540406827574
Validation loss improved to 1.336002
epoch:  14
epoch:  15 val_f1:  0.6584354138310973 val_auroc:  0.7280314187530683 val_auprc:  0.8650603171043141
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.600961958701277 val_auroc:  0.748159057437408 val_auprc:  0.879772532328803
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.3398212583117671 val_auroc:  0.7550319096710849 val_auprc:  0.8853961889877844
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.4070174368979393 val_auroc:  0.7601865488463426 val_auprc:  0.885017709801997
EarlyStopping counter: 4 out of 50
epoch:  18
epoch:  19 val_f1:  0.41765629830050655 val_auroc:  0.758713794796269 val_auprc:  0.8826739966694206
EarlyStopping counter: 5 out of 50
epoch:  19
epoch:  20 val_f1:  0.47584004770011695 val_auroc:  0.7714776632302406 val_auprc:  0.8898058610824342
EarlyStopping counter: 6 out of 50
epoch:  20
epoch:  21 val_f1:  0.7411406017655346 val_auroc:  0.7614138438880708 val_auprc:  0.875494458863757
Validation loss improved to 1.293299
epoch:  21
epoch:  22 val_f1:  0.6406602727799046 val_auroc:  0.7514727540500737 val_auprc:  0.8910611910955963
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7162290583621869 val_auroc:  0.7881688757977419 val_auprc:  0.898911051574093
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.3628922279378038 val_auroc:  0.7812960235640648 val_auprc:  0.8928737006341424
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.65669788697344 val_auroc:  0.7324496809032891 val_auprc:  0.8833635562783513
EarlyStopping counter: 4 out of 50
epoch:  25
epoch:  26 val_f1:  0.5881399358125439 val_auroc:  0.7776141384388808 val_auprc:  0.8894472985668141
EarlyStopping counter: 5 out of 50
epoch:  26
epoch:  27 val_f1:  0.7101700457815566 val_auroc:  0.777491408934708 val_auprc:  0.8842299258187735
EarlyStopping counter: 6 out of 50
epoch:  27
epoch:  28 val_f1:  0.7126420359039872 val_auroc:  0.7774914089347079 val_auprc:  0.8957710548156146
EarlyStopping counter: 7 out of 50
epoch:  28
epoch:  29 val_f1:  0.7100860488080124 val_auroc:  0.7809278350515464 val_auprc:  0.883577504139877
EarlyStopping counter: 8 out of 50
epoch:  29
epoch:  30 val_f1:  0.7648187281552264 val_auroc:  0.7784732449680903 val_auprc:  0.8868984103170032
EarlyStopping counter: 9 out of 50
epoch:  30
epoch:  31 val_f1:  0.6353297362110312 val_auroc:  0.7907461953853706 val_auprc:  0.8957762824371959
EarlyStopping counter: 10 out of 50
epoch:  31
epoch:  32 val_f1:  0.7233618940391454 val_auroc:  0.7928325969563084 val_auprc:  0.8970932136653413
EarlyStopping counter: 11 out of 50
epoch:  32
epoch:  33 val_f1:  0.6670420077516633 val_auroc:  0.7503681885125185 val_auprc:  0.8803254496471471
EarlyStopping counter: 12 out of 50
epoch:  33
epoch:  34 val_f1:  0.6320725385265299 val_auroc:  0.7790868924889544 val_auprc:  0.8875417783858922
EarlyStopping counter: 13 out of 50
epoch:  34
epoch:  35 val_f1:  0.6135802455273177 val_auroc:  0.7906234658811979 val_auprc:  0.893554067437068
EarlyStopping counter: 14 out of 50
epoch:  35
epoch:  36 val_f1:  0.7583800901862243 val_auroc:  0.7902552773686794 val_auprc:  0.8958742776660621
EarlyStopping counter: 15 out of 50
epoch:  36
epoch:  37 val_f1:  0.6454957772912105 val_auroc:  0.6880216003927345 val_auprc:  0.8749734696081081
EarlyStopping counter: 16 out of 50
epoch:  37
epoch:  38 val_f1:  0.7166299330477814 val_auroc:  0.772459499263623 val_auprc:  0.8880733380444964
Validation loss improved to 1.291067
epoch:  38
epoch:  39 val_f1:  0.5053701858578568 val_auroc:  0.7758959253804616 val_auprc:  0.8891797202820642
EarlyStopping counter: 1 out of 50
epoch:  39
epoch:  40 val_f1:  0.6904086828713746 val_auroc:  0.7538046146293569 val_auprc:  0.8677142050338562
EarlyStopping counter: 2 out of 50
epoch:  40
epoch:  41 val_f1:  0.7330561760022478 val_auroc:  0.7601865488463426 val_auprc:  0.8791033919636787
EarlyStopping counter: 3 out of 50
epoch:  41
epoch:  42 val_f1:  0.7583800901862243 val_auroc:  0.7745459008345607 val_auprc:  0.8822030931414958
EarlyStopping counter: 4 out of 50
epoch:  42
epoch:  43 val_f1:  0.4077266270365294 val_auroc:  0.7643593519882179 val_auprc:  0.878102534878848
EarlyStopping counter: 5 out of 50
epoch:  43
epoch:  44 val_f1:  0.7238240177089098 val_auroc:  0.7551546391752577 val_auprc:  0.8737190561685242
EarlyStopping counter: 6 out of 50
epoch:  44
epoch:  45 val_f1:  0.7184536707983012 val_auroc:  0.7716003927344134 val_auprc:  0.8890118634424958
EarlyStopping counter: 7 out of 50
epoch:  45
epoch:  46 val_f1:  0.7117994924448791 val_auroc:  0.768654884634266 val_auprc:  0.8859508473375026
EarlyStopping counter: 8 out of 50
epoch:  46
epoch:  47 val_f1:  0.7163649790827238 val_auroc:  0.7627638684339715 val_auprc:  0.8776360721654257
EarlyStopping counter: 9 out of 50
epoch:  47
epoch:  48 val_f1:  0.6893510131556864 val_auroc:  0.7751595483554247 val_auprc:  0.8838056298428667
Validation loss improved to 1.104036
epoch:  48
epoch:  49 val_f1:  0.6982612029498659 val_auroc:  0.7459499263622975 val_auprc:  0.8765653067156922
EarlyStopping counter: 1 out of 50
epoch:  49
epoch:  50 val_f1:  0.7148475178521729 val_auroc:  0.746809032891507 val_auprc:  0.8666049095521295
EarlyStopping counter: 2 out of 50
epoch:  50
epoch:  51 val_f1:  0.6885440884463027 val_auroc:  0.7535591556210113 val_auprc:  0.8719433214780281
EarlyStopping counter: 3 out of 50
epoch:  51
epoch:  52 val_f1:  0.6904086828713746 val_auroc:  0.7378497790868925 val_auprc:  0.8625340237632066
EarlyStopping counter: 4 out of 50
epoch:  52
epoch:  53 val_f1:  0.7298678635622811 val_auroc:  0.7366224840451645 val_auprc:  0.855936781423657
EarlyStopping counter: 5 out of 50
epoch:  53
epoch:  54 val_f1:  0.6617377698806362 val_auroc:  0.7432498772704957 val_auprc:  0.863385222908561
Validation loss improved to 0.977809
epoch:  54
epoch:  55 val_f1:  0.3628922279378038 val_auroc:  0.7565046637211585 val_auprc:  0.8849389475535839
EarlyStopping counter: 1 out of 50
epoch:  55
epoch:  56 val_f1:  0.720403844991234 val_auroc:  0.7399361806578302 val_auprc:  0.8677421500485485
EarlyStopping counter: 2 out of 50
epoch:  56
epoch:  57 val_f1:  0.7094198370570532 val_auroc:  0.7433726067746687 val_auprc:  0.8611763997021388
EarlyStopping counter: 3 out of 50
epoch:  57
epoch:  58 val_f1:  0.7226305629385982 val_auroc:  0.7573637702503683 val_auprc:  0.8856653022383904
EarlyStopping counter: 4 out of 50
epoch:  58
epoch:  59 val_f1:  0.7266187050359713 val_auroc:  0.7540500736377025 val_auprc:  0.8690461912785825
EarlyStopping counter: 5 out of 50
epoch:  59
epoch:  60 val_f1:  0.7208993647046947 val_auroc:  0.7468090328915072 val_auprc:  0.8638068908372747
EarlyStopping counter: 6 out of 50
epoch:  60
epoch:  61 val_f1:  0.7244548447263693 val_auroc:  0.7633775159548355 val_auprc:  0.8880141626550351
EarlyStopping counter: 7 out of 50
epoch:  61
epoch:  62 val_f1:  0.6945501576267077 val_auroc:  0.7461953853706431 val_auprc:  0.8564923790648465
EarlyStopping counter: 8 out of 50
epoch:  62
epoch:  63 val_f1:  0.6937535685737124 val_auroc:  0.7403043691703486 val_auprc:  0.8518215570514931
EarlyStopping counter: 9 out of 50
epoch:  63
epoch:  64 val_f1:  0.6960581600537912 val_auroc:  0.743740795287187 val_auprc:  0.8605540663015372
EarlyStopping counter: 10 out of 50
epoch:  64
epoch:  65 val_f1:  0.696151679426677 val_auroc:  0.7577319587628866 val_auprc:  0.8758113815487327
EarlyStopping counter: 11 out of 50
epoch:  65
epoch:  66 val_f1:  0.7011215811505187 val_auroc:  0.7507363770250368 val_auprc:  0.8616859973124709
EarlyStopping counter: 12 out of 50
epoch:  66
epoch:  67 val_f1:  0.7126420359039872 val_auroc:  0.7632547864506627 val_auprc:  0.8861776033323194
EarlyStopping counter: 13 out of 50
epoch:  67
epoch:  68 val_f1:  0.7067808808208037 val_auroc:  0.7584683357879234 val_auprc:  0.8823483714672103
EarlyStopping counter: 14 out of 50
epoch:  68
epoch:  69 val_f1:  0.7122302158273381 val_auroc:  0.7515954835542464 val_auprc:  0.8707530068128797
EarlyStopping counter: 15 out of 50
epoch:  69
epoch:  70 val_f1:  0.7040153975059064 val_auroc:  0.7407952871870398 val_auprc:  0.8591821905901149
EarlyStopping counter: 16 out of 50
epoch:  70
epoch:  71 val_f1:  0.7117994924448791 val_auroc:  0.742513500245459 val_auprc:  0.8669324778510632
EarlyStopping counter: 17 out of 50
epoch:  71
epoch:  72 val_f1:  0.720403844991234 val_auroc:  0.7405498281786942 val_auprc:  0.867400111002208
EarlyStopping counter: 18 out of 50
epoch:  72
epoch:  73 val_f1:  0.6904086828713746 val_auroc:  0.741286205203731 val_auprc:  0.8532182883164846
EarlyStopping counter: 19 out of 50
epoch:  73
epoch:  74 val_f1:  0.7060068982302729 val_auroc:  0.7490181639666176 val_auprc:  0.8632294477578046
EarlyStopping counter: 20 out of 50
epoch:  74
epoch:  75 val_f1:  0.7040153975059064 val_auroc:  0.7405498281786941 val_auprc:  0.8540967322971178
EarlyStopping counter: 21 out of 50
epoch:  75
epoch:  76 val_f1:  0.7166849710626011 val_auroc:  0.7509818360333824 val_auprc:  0.8723406830451675
EarlyStopping counter: 22 out of 50
epoch:  76
epoch:  77 val_f1:  0.7148475178521729 val_auroc:  0.7301178203240059 val_auprc:  0.8539475128367259
EarlyStopping counter: 23 out of 50
epoch:  77
epoch:  78 val_f1:  0.7237424247793883 val_auroc:  0.7525773195876289 val_auprc:  0.872636071096643
EarlyStopping counter: 24 out of 50
epoch:  78
epoch:  79 val_f1:  0.6952451949622753 val_auroc:  0.7441089837997055 val_auprc:  0.8578567839494924
EarlyStopping counter: 25 out of 50
epoch:  79
epoch:  80 val_f1:  0.7044810154681304 val_auroc:  0.7357633775159549 val_auprc:  0.8522542381709544
EarlyStopping counter: 26 out of 50
epoch:  80
epoch:  81 val_f1:  0.7371484630477437 val_auroc:  0.7484045164457536 val_auprc:  0.8650231510337468
EarlyStopping counter: 27 out of 50
epoch:  81
epoch:  82 val_f1:  0.708480907581627 val_auroc:  0.7324496809032891 val_auprc:  0.8567376568185076
EarlyStopping counter: 28 out of 50
epoch:  82
epoch:  83 val_f1:  0.7079427367197151 val_auroc:  0.7341678939617083 val_auprc:  0.8537653403086529
EarlyStopping counter: 29 out of 50
epoch:  83
epoch:  84 val_f1:  0.7148475178521729 val_auroc:  0.7401816396661758 val_auprc:  0.8640579878914225
EarlyStopping counter: 30 out of 50
epoch:  84
epoch:  85 val_f1:  0.7349308245711123 val_auroc:  0.7422680412371134 val_auprc:  0.8623917099523656
EarlyStopping counter: 31 out of 50
epoch:  85
epoch:  86 val_f1:  0.7163649790827238 val_auroc:  0.7353951890034365 val_auprc:  0.851444285066064
EarlyStopping counter: 32 out of 50
epoch:  86
epoch:  87 val_f1:  0.7263486361521366 val_auroc:  0.738708885616102 val_auprc:  0.8583315800165586
EarlyStopping counter: 33 out of 50
epoch:  87
epoch:  88 val_f1:  0.7163649790827238 val_auroc:  0.7471772214040255 val_auprc:  0.8621157733908775
EarlyStopping counter: 34 out of 50
epoch:  88
epoch:  89 val_f1:  0.7263486361521366 val_auroc:  0.7445999018163966 val_auprc:  0.8622768876154233
EarlyStopping counter: 35 out of 50
epoch:  89
epoch:  90 val_f1:  0.7325045643526866 val_auroc:  0.7410407461953854 val_auprc:  0.8602793032661442
EarlyStopping counter: 36 out of 50
epoch:  90
epoch:  91 val_f1:  0.7263486361521366 val_auroc:  0.7396907216494846 val_auprc:  0.8582575389920615
EarlyStopping counter: 37 out of 50
epoch:  91
epoch:  92 val_f1:  0.7202047592695074 val_auroc:  0.7391998036327934 val_auprc:  0.855856821908775
EarlyStopping counter: 38 out of 50
epoch:  92
epoch:  93 val_f1:  0.7263486361521366 val_auroc:  0.7396907216494846 val_auprc:  0.8608846332866972
EarlyStopping counter: 39 out of 50
epoch:  93
epoch:  94 val_f1:  0.7176437068167247 val_auroc:  0.7417771232204222 val_auprc:  0.8631080687579722
EarlyStopping counter: 40 out of 50
epoch:  94
epoch:  95 val_f1:  0.7202047592695074 val_auroc:  0.740672557682867 val_auprc:  0.8583487657468922
EarlyStopping counter: 41 out of 50
epoch:  95
epoch:  96 val_f1:  0.7202047592695074 val_auroc:  0.740058910162003 val_auprc:  0.8578370269364608
EarlyStopping counter: 42 out of 50
epoch:  96
epoch:  97 val_f1:  0.7263486361521366 val_auroc:  0.7412862052037309 val_auprc:  0.8606058603079492
EarlyStopping counter: 43 out of 50
epoch:  97
epoch:  98 val_f1:  0.7202047592695074 val_auroc:  0.741286205203731 val_auprc:  0.8585637001749122
EarlyStopping counter: 44 out of 50
epoch:  98
epoch:  99 val_f1:  0.7058128438779214 val_auroc:  0.7430044182621501 val_auprc:  0.866340385732953
EarlyStopping counter: 45 out of 50
epoch:  99
epoch:  100 val_f1:  0.7148475178521729 val_auroc:  0.7452135493372607 val_auprc:  0.8673200596749826
EarlyStopping counter: 46 out of 50
epoch:  100
epoch:  101 val_f1:  0.69663104467882 val_auroc:  0.7479135984290624 val_auprc:  0.8715496411990487
EarlyStopping counter: 47 out of 50
epoch:  101
epoch:  102 val_f1:  0.7148475178521729 val_auroc:  0.7423907707412862 val_auprc:  0.8661637585443205
EarlyStopping counter: 48 out of 50
epoch:  102
epoch:  103 val_f1:  0.7148475178521729 val_auroc:  0.7434953362788415 val_auprc:  0.8666111008269999
EarlyStopping counter: 49 out of 50
epoch:  103
epoch:  104 val_f1:  0.69663104467882 val_auroc:  0.7460726558664703 val_auprc:  0.869890871650882
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  2825.0750818252563
{'time_elapsed': [2825.0750818252563], 'epoch': [103], 'fold': [2], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.69663104467882], 'auroc_test': [0.7460726558664703], 'auprc_test': [0.869890871650882]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1278]          --
│    └─Dropout: 2-5                      [64, 1024, 1278]          --
│    └─Flatten: 2-6                      [64, 1308672]             --
│    └─Linear: 2-7                       [64, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 419.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1342.18
Params size (MB): 5.26
Estimated Total Size (MB): 1347.76
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5133540140823671 val_auroc:  0.7890019379844961 val_auprc:  0.905636253242389
epoch:  1
epoch:  2 val_f1:  0.63054487959593 val_auroc:  0.7338905038759691 val_auprc:  0.8560689345931556
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6475200791747555 val_auroc:  0.7599321705426356 val_auprc:  0.8927925207732389
Validation loss improved to 1.320758
epoch:  3
epoch:  4 val_f1:  0.7230958778588147 val_auroc:  0.8204941860465116 val_auprc:  0.9102223207777299
Validation loss improved to 0.981495
epoch:  4
epoch:  5 val_f1:  0.7369148836774737 val_auroc:  0.8225532945736435 val_auprc:  0.9106594179827068
Validation loss improved to 0.837368
epoch:  5
epoch:  6 val_f1:  0.6265623417306581 val_auroc:  0.7943313953488371 val_auprc:  0.9056307886333227
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.749929147591018 val_auroc:  0.8109253875968991 val_auprc:  0.9086883627505542
Validation loss improved to 0.435844
epoch:  7
epoch:  8 val_f1:  0.7002533928797167 val_auroc:  0.8304263565891473 val_auprc:  0.9198569907101795
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.6540721621176341 val_auroc:  0.8296996124031008 val_auprc:  0.9166563844741591
EarlyStopping counter: 2 out of 50
epoch:  9
epoch:  10 val_f1:  0.6835634612100746 val_auroc:  0.8186773255813954 val_auprc:  0.9145909878889658
EarlyStopping counter: 3 out of 50
epoch:  10
epoch:  11 val_f1:  0.7369148836774737 val_auroc:  0.8284883720930233 val_auprc:  0.9182814144819583
EarlyStopping counter: 4 out of 50
epoch:  11
epoch:  12 val_f1:  0.7369148836774737 val_auroc:  0.8316375968992248 val_auprc:  0.9221072700891765
EarlyStopping counter: 5 out of 50
epoch:  12
epoch:  13 val_f1:  0.7776763243674784 val_auroc:  0.8410852713178295 val_auprc:  0.9250572654487909
Validation loss improved to 0.162317
epoch:  13
epoch:  14 val_f1:  0.7841726618705036 val_auroc:  0.8414486434108527 val_auprc:  0.9232449450164647
Validation loss improved to 0.160380
epoch:  14
epoch:  15 val_f1:  0.7713093666729185 val_auroc:  0.8485949612403101 val_auprc:  0.9262901443554533
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7429991933226874 val_auroc:  0.8511385658914727 val_auprc:  0.9281132104243959
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.7735780520043992 val_auroc:  0.8447189922480621 val_auprc:  0.9265611244547001
Validation loss improved to 0.147024
epoch:  17
epoch:  18 val_f1:  0.711847580392104 val_auroc:  0.8489583333333334 val_auprc:  0.9297621937653953
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.7801238118631262 val_auroc:  0.8490794573643412 val_auprc:  0.9295372709676962
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7854893118997625 val_auroc:  0.8621608527131783 val_auprc:  0.9355163393744507
EarlyStopping counter: 3 out of 50
epoch:  20
epoch:  21 val_f1:  0.7665182935781787 val_auroc:  0.8674903100775193 val_auprc:  0.9402608998964268
EarlyStopping counter: 4 out of 50
epoch:  21
epoch:  22 val_f1:  0.8008946034661633 val_auroc:  0.8653100775193799 val_auprc:  0.9403400455670297
Validation loss improved to 0.137297
epoch:  22
epoch:  23 val_f1:  0.7841726618705036 val_auroc:  0.8687015503875969 val_auprc:  0.9412452528823447
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.8093907785715628 val_auroc:  0.8694282945736433 val_auprc:  0.9438961554651947
EarlyStopping counter: 2 out of 50
epoch:  24
epoch:  25 val_f1:  0.7710202043822609 val_auroc:  0.8718507751937986 val_auprc:  0.9429956291548272
EarlyStopping counter: 3 out of 50
epoch:  25
epoch:  26 val_f1:  0.8160321672535743 val_auroc:  0.8653100775193799 val_auprc:  0.9439543553630553
EarlyStopping counter: 4 out of 50
epoch:  26
epoch:  27 val_f1:  0.8093907785715628 val_auroc:  0.8708817829457365 val_auprc:  0.9444629960811564
EarlyStopping counter: 5 out of 50
epoch:  27
epoch:  28 val_f1:  0.7601256159113488 val_auroc:  0.877422480620155 val_auprc:  0.9454959202578503
EarlyStopping counter: 6 out of 50
epoch:  28
epoch:  29 val_f1:  0.8035187234827523 val_auroc:  0.872577519379845 val_auprc:  0.9461298538760912
Validation loss improved to 0.117087
epoch:  29
epoch:  30 val_f1:  0.7912899626822607 val_auroc:  0.874515503875969 val_auprc:  0.9463466461224967
EarlyStopping counter: 1 out of 50
epoch:  30
epoch:  31 val_f1:  0.6893145339776472 val_auroc:  0.8713662790697675 val_auprc:  0.946661903184815
EarlyStopping counter: 2 out of 50
epoch:  31
epoch:  32 val_f1:  0.7643770041438114 val_auroc:  0.8660368217054263 val_auprc:  0.9420275364406707
EarlyStopping counter: 3 out of 50
epoch:  32
epoch:  33 val_f1:  0.7625825493451395 val_auroc:  0.8638565891472869 val_auprc:  0.9397949388027029
EarlyStopping counter: 4 out of 50
epoch:  33
epoch:  34 val_f1:  0.776244301724119 val_auroc:  0.8638565891472868 val_auprc:  0.941293421530984
EarlyStopping counter: 5 out of 50
epoch:  34
epoch:  35 val_f1:  0.8217477382460002 val_auroc:  0.8687015503875969 val_auprc:  0.945659547554139
EarlyStopping counter: 6 out of 50
epoch:  35
epoch:  36 val_f1:  0.8008946034661633 val_auroc:  0.8718507751937984 val_auprc:  0.9452024084837622
EarlyStopping counter: 7 out of 50
epoch:  36
epoch:  37 val_f1:  0.7907929835906556 val_auroc:  0.8720930232558141 val_auprc:  0.9468914023563542
Validation loss improved to 0.110398
epoch:  37
epoch:  38 val_f1:  0.7841726618705036 val_auroc:  0.8701550387596899 val_auprc:  0.9460646068678167
EarlyStopping counter: 1 out of 50
epoch:  38
epoch:  39 val_f1:  0.7427571456348435 val_auroc:  0.8701550387596899 val_auprc:  0.9452455333506778
EarlyStopping counter: 2 out of 50
epoch:  39
epoch:  40 val_f1:  0.7516121487046815 val_auroc:  0.8762112403100775 val_auprc:  0.9464287661275204
EarlyStopping counter: 3 out of 50
epoch:  40
epoch:  41 val_f1:  0.8035187234827523 val_auroc:  0.8718507751937986 val_auprc:  0.9464508727650289
EarlyStopping counter: 4 out of 50
epoch:  41
epoch:  42 val_f1:  0.8063632502555458 val_auroc:  0.8684593023255813 val_auprc:  0.9438270983970573
EarlyStopping counter: 5 out of 50
epoch:  42
epoch:  43 val_f1:  0.7665182935781787 val_auroc:  0.873062015503876 val_auprc:  0.9441658755080573
EarlyStopping counter: 6 out of 50
epoch:  43
epoch:  44 val_f1:  0.7665182935781787 val_auroc:  0.872093023255814 val_auprc:  0.9454049110341498
EarlyStopping counter: 7 out of 50
epoch:  44
epoch:  45 val_f1:  0.7854893118997625 val_auroc:  0.8694282945736435 val_auprc:  0.9453527997576991
EarlyStopping counter: 8 out of 50
epoch:  45
epoch:  46 val_f1:  0.7625825493451395 val_auroc:  0.8742732558139534 val_auprc:  0.9465379885311623
EarlyStopping counter: 9 out of 50
epoch:  46
epoch:  47 val_f1:  0.7774211400110681 val_auroc:  0.8766957364341085 val_auprc:  0.9455396422907411
EarlyStopping counter: 10 out of 50
epoch:  47
epoch:  48 val_f1:  0.7957035068809065 val_auroc:  0.8762112403100776 val_auprc:  0.9463021658994282
EarlyStopping counter: 11 out of 50
epoch:  48
epoch:  49 val_f1:  0.7875752415552048 val_auroc:  0.873062015503876 val_auprc:  0.9445584941007878
EarlyStopping counter: 12 out of 50
epoch:  49
epoch:  50 val_f1:  0.7746634573712671 val_auroc:  0.875484496124031 val_auprc:  0.9471094797327022
EarlyStopping counter: 13 out of 50
epoch:  50
epoch:  51 val_f1:  0.768937708914086 val_auroc:  0.8766957364341086 val_auprc:  0.9474126286967788
EarlyStopping counter: 14 out of 50
epoch:  51
epoch:  52 val_f1:  0.7729252582141845 val_auroc:  0.8750000000000001 val_auprc:  0.9468688557126269
EarlyStopping counter: 15 out of 50
epoch:  52
epoch:  53 val_f1:  0.7746634573712671 val_auroc:  0.873062015503876 val_auprc:  0.9445228760531857
EarlyStopping counter: 16 out of 50
epoch:  53
epoch:  54 val_f1:  0.7746634573712671 val_auroc:  0.8759689922480621 val_auprc:  0.9471586578016575
EarlyStopping counter: 17 out of 50
epoch:  54
epoch:  55 val_f1:  0.7665182935781787 val_auroc:  0.877422480620155 val_auprc:  0.9472511324423533
EarlyStopping counter: 18 out of 50
epoch:  55
epoch:  56 val_f1:  0.7729252582141845 val_auroc:  0.8759689922480619 val_auprc:  0.9471391703249784
EarlyStopping counter: 19 out of 50
epoch:  56
epoch:  57 val_f1:  0.7729252582141845 val_auroc:  0.8766957364341085 val_auprc:  0.9475395967732931
EarlyStopping counter: 20 out of 50
epoch:  57
epoch:  58 val_f1:  0.7793492478744277 val_auroc:  0.876937984496124 val_auprc:  0.9477014639127361
EarlyStopping counter: 21 out of 50
epoch:  58
epoch:  59 val_f1:  0.7603368061152953 val_auroc:  0.8762112403100775 val_auprc:  0.9466272696750732
EarlyStopping counter: 22 out of 50
epoch:  59
epoch:  60 val_f1:  0.7811109002295425 val_auroc:  0.874031007751938 val_auprc:  0.9466263708713428
EarlyStopping counter: 23 out of 50
epoch:  60
epoch:  61 val_f1:  0.792019787311512 val_auroc:  0.875484496124031 val_auprc:  0.9462529475395
EarlyStopping counter: 24 out of 50
epoch:  61
epoch:  62 val_f1:  0.7746634573712671 val_auroc:  0.8757267441860465 val_auprc:  0.9460802360095975
EarlyStopping counter: 25 out of 50
epoch:  62
epoch:  63 val_f1:  0.7746634573712671 val_auroc:  0.8757267441860465 val_auprc:  0.9461348414188212
EarlyStopping counter: 26 out of 50
epoch:  63
epoch:  64 val_f1:  0.7746634573712671 val_auroc:  0.875484496124031 val_auprc:  0.9463695645634218
EarlyStopping counter: 27 out of 50
epoch:  64
epoch:  65 val_f1:  0.7793492478744277 val_auroc:  0.874515503875969 val_auprc:  0.946068136106641
EarlyStopping counter: 28 out of 50
epoch:  65
epoch:  66 val_f1:  0.7729252582141845 val_auroc:  0.875968992248062 val_auprc:  0.9463320620805764
EarlyStopping counter: 29 out of 50
epoch:  66
epoch:  67 val_f1:  0.7729252582141845 val_auroc:  0.8747577519379847 val_auprc:  0.9459892739822147
EarlyStopping counter: 30 out of 50
epoch:  67
epoch:  68 val_f1:  0.7729252582141845 val_auroc:  0.874515503875969 val_auprc:  0.9454393767765128
EarlyStopping counter: 31 out of 50
epoch:  68
epoch:  69 val_f1:  0.7729252582141845 val_auroc:  0.876453488372093 val_auprc:  0.9463247932544813
EarlyStopping counter: 32 out of 50
epoch:  69
epoch:  70 val_f1:  0.7729252582141845 val_auroc:  0.873546511627907 val_auprc:  0.9449250576206393
EarlyStopping counter: 33 out of 50
epoch:  70
epoch:  71 val_f1:  0.7729252582141845 val_auroc:  0.8737887596899225 val_auprc:  0.9450824990849023
EarlyStopping counter: 34 out of 50
epoch:  71
epoch:  72 val_f1:  0.7729252582141845 val_auroc:  0.8752422480620156 val_auprc:  0.9455999278652575
EarlyStopping counter: 35 out of 50
epoch:  72
epoch:  73 val_f1:  0.7729252582141845 val_auroc:  0.8742732558139534 val_auprc:  0.945259212377956
EarlyStopping counter: 36 out of 50
epoch:  73
epoch:  74 val_f1:  0.8301835390032996 val_auroc:  0.875 val_auprc:  0.9463275771964246
EarlyStopping counter: 37 out of 50
epoch:  74
epoch:  75 val_f1:  0.7729252582141845 val_auroc:  0.8754844961240309 val_auprc:  0.9466459522761455
EarlyStopping counter: 38 out of 50
epoch:  75
epoch:  76 val_f1:  0.7793492478744277 val_auroc:  0.873546511627907 val_auprc:  0.9455187538584459
EarlyStopping counter: 39 out of 50
epoch:  76
epoch:  77 val_f1:  0.7682301875730638 val_auroc:  0.8737887596899225 val_auprc:  0.9453311269847386
EarlyStopping counter: 40 out of 50
epoch:  77
epoch:  78 val_f1:  0.7729252582141845 val_auroc:  0.8750000000000001 val_auprc:  0.9453125324510177
EarlyStopping counter: 41 out of 50
epoch:  78
epoch:  79 val_f1:  0.7746634573712671 val_auroc:  0.875484496124031 val_auprc:  0.9454982397911438
EarlyStopping counter: 42 out of 50
epoch:  79
epoch:  80 val_f1:  0.7729252582141845 val_auroc:  0.8733042635658915 val_auprc:  0.944768653792416
EarlyStopping counter: 43 out of 50
epoch:  80
epoch:  81 val_f1:  0.7729252582141845 val_auroc:  0.8750000000000001 val_auprc:  0.9455859842585486
EarlyStopping counter: 44 out of 50
epoch:  81
epoch:  82 val_f1:  0.7746634573712671 val_auroc:  0.874031007751938 val_auprc:  0.945306953995943
EarlyStopping counter: 45 out of 50
epoch:  82
epoch:  83 val_f1:  0.7729252582141845 val_auroc:  0.8737887596899225 val_auprc:  0.9450946252784007
EarlyStopping counter: 46 out of 50
epoch:  83
epoch:  84 val_f1:  0.7811109002295425 val_auroc:  0.874515503875969 val_auprc:  0.9457030723866398
EarlyStopping counter: 47 out of 50
epoch:  84
epoch:  85 val_f1:  0.7729252582141845 val_auroc:  0.873062015503876 val_auprc:  0.9439476862469227
EarlyStopping counter: 48 out of 50
epoch:  85
epoch:  86 val_f1:  0.7729252582141845 val_auroc:  0.873062015503876 val_auprc:  0.9437995084065566
EarlyStopping counter: 49 out of 50
epoch:  86
epoch:  87 val_f1:  0.7793492478744277 val_auroc:  0.8747577519379847 val_auprc:  0.9444727712209509
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  2093.132269382477
{'time_elapsed': [2093.132269382477], 'epoch': [86], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7793492478744277], 'auroc_test': [0.8747577519379847], 'auprc_test': [0.9444727712209509]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1278]          --
│    └─Dropout: 2-5                      [64, 1024, 1278]          --
│    └─Flatten: 2-6                      [64, 1308672]             --
│    └─Linear: 2-7                       [64, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 419.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1342.18
Params size (MB): 5.26
Estimated Total Size (MB): 1347.76
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.7581878046794104 val_auroc:  0.8139880952380951 val_auprc:  0.9091904709704813
epoch:  1
epoch:  2 val_f1:  0.5627053140096617 val_auroc:  0.6515376984126985 val_auprc:  0.7986422137048164
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.4811107051516258 val_auroc:  0.6336805555555556 val_auprc:  0.7752940123192904
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6781818181818181 val_auroc:  0.6457093253968255 val_auprc:  0.803053491543105
EarlyStopping counter: 3 out of 50
epoch:  4
epoch:  5 val_f1:  0.46061381074168806 val_auroc:  0.6717509920634921 val_auprc:  0.7904466592864976
EarlyStopping counter: 4 out of 50
epoch:  5
epoch:  6 val_f1:  0.7556123898834897 val_auroc:  0.7278025793650794 val_auprc:  0.8535097505024362
EarlyStopping counter: 5 out of 50
epoch:  6
epoch:  7 val_f1:  0.7388944960742422 val_auroc:  0.7610367063492063 val_auprc:  0.8787703048783582
EarlyStopping counter: 6 out of 50
epoch:  7
epoch:  8 val_f1:  0.6255419560736991 val_auroc:  0.7971230158730158 val_auprc:  0.8840831430573022
Validation loss improved to 1.581459
epoch:  8
epoch:  9 val_f1:  0.7489963938218684 val_auroc:  0.8137400793650794 val_auprc:  0.9094029691570894
Validation loss improved to 1.480977
epoch:  9
epoch:  10 val_f1:  0.7533534773758802 val_auroc:  0.8246527777777778 val_auprc:  0.9091506303078876
Validation loss improved to 0.861676
epoch:  10
epoch:  11 val_f1:  0.7645238046338866 val_auroc:  0.8382936507936508 val_auprc:  0.918878615695709
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.6225940464882064 val_auroc:  0.8382936507936508 val_auprc:  0.9136282083820314
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.6033801281177593 val_auroc:  0.7509920634920635 val_auprc:  0.8975891171414349
EarlyStopping counter: 3 out of 50
epoch:  13
epoch:  14 val_f1:  0.7425627404942808 val_auroc:  0.8552827380952381 val_auprc:  0.926458526219517
Validation loss improved to 0.769919
epoch:  14
epoch:  15 val_f1:  0.5363972412027331 val_auroc:  0.861111111111111 val_auprc:  0.9287230026369016
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.5873969891987832 val_auroc:  0.6309523809523809 val_auprc:  0.8779527559055118
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.3996626686656672 val_auroc:  0.8782242063492064 val_auprc:  0.9366631087096634
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.7715326840649617 val_auroc:  0.8582589285714286 val_auprc:  0.9336722593637936
EarlyStopping counter: 4 out of 50
epoch:  18
epoch:  19 val_f1:  0.8061683443992288 val_auroc:  0.873015873015873 val_auprc:  0.9353641947409485
Validation loss improved to 0.714164
epoch:  19
epoch:  20 val_f1:  0.7815416513900654 val_auroc:  0.8720238095238095 val_auprc:  0.9337677121155691
Validation loss improved to 0.708691
epoch:  20
epoch:  21 val_f1:  0.820411899313501 val_auroc:  0.8717757936507936 val_auprc:  0.9358027687727769
Validation loss improved to 0.354889
epoch:  21
epoch:  22 val_f1:  0.8108796141220607 val_auroc:  0.8695436507936508 val_auprc:  0.9296519585954903
EarlyStopping counter: 1 out of 50
epoch:  22
epoch:  23 val_f1:  0.7810348219555381 val_auroc:  0.873263888888889 val_auprc:  0.9383006648536144
EarlyStopping counter: 2 out of 50
epoch:  23
epoch:  24 val_f1:  0.7279190593382555 val_auroc:  0.870907738095238 val_auprc:  0.932887901750162
EarlyStopping counter: 3 out of 50
epoch:  24
epoch:  25 val_f1:  0.7995542847531747 val_auroc:  0.8707837301587302 val_auprc:  0.9317947268382478
Validation loss improved to 0.279532
epoch:  25
epoch:  26 val_f1:  0.7926396128627546 val_auroc:  0.8690476190476191 val_auprc:  0.9280060538613115
Validation loss improved to 0.263384
epoch:  26
epoch:  27 val_f1:  0.7450280959405923 val_auroc:  0.8660714285714285 val_auprc:  0.9338441619978626
EarlyStopping counter: 1 out of 50
epoch:  27
epoch:  28 val_f1:  0.8005921770297647 val_auroc:  0.8534226190476191 val_auprc:  0.9146961159050933
EarlyStopping counter: 2 out of 50
epoch:  28
epoch:  29 val_f1:  0.7971014492753623 val_auroc:  0.8546626984126984 val_auprc:  0.917516152545962
EarlyStopping counter: 3 out of 50
epoch:  29
epoch:  30 val_f1:  0.7749692370795734 val_auroc:  0.8619791666666666 val_auprc:  0.9312852180382704
EarlyStopping counter: 4 out of 50
epoch:  30
epoch:  31 val_f1:  0.7837062051498522 val_auroc:  0.8616071428571428 val_auprc:  0.9250490968363729
Validation loss improved to 0.249800
epoch:  31
epoch:  32 val_f1:  0.8115942028985508 val_auroc:  0.863219246031746 val_auprc:  0.9261760187511695
Validation loss improved to 0.234868
epoch:  32
epoch:  33 val_f1:  0.8164398044139025 val_auroc:  0.8665674603174603 val_auprc:  0.9267667063282008
Validation loss improved to 0.225893
epoch:  33
epoch:  34 val_f1:  0.7207167709858867 val_auroc:  0.8663194444444444 val_auprc:  0.9276125749049504
EarlyStopping counter: 1 out of 50
epoch:  34
epoch:  35 val_f1:  0.7450280959405923 val_auroc:  0.8596230158730159 val_auprc:  0.931269448651901
EarlyStopping counter: 2 out of 50
epoch:  35
epoch:  36 val_f1:  0.7895875497243353 val_auroc:  0.8644593253968254 val_auprc:  0.9264506392515596
EarlyStopping counter: 3 out of 50
epoch:  36
epoch:  37 val_f1:  0.7781291172595521 val_auroc:  0.8692956349206349 val_auprc:  0.935094374186822
EarlyStopping counter: 4 out of 50
epoch:  37
epoch:  38 val_f1:  0.6538029405209672 val_auroc:  0.8707837301587301 val_auprc:  0.9284931794964887
EarlyStopping counter: 5 out of 50
epoch:  38
epoch:  39 val_f1:  0.8231516182680737 val_auroc:  0.8715277777777777 val_auprc:  0.9258850739218323
Validation loss improved to 0.223311
epoch:  39
epoch:  40 val_f1:  0.8079996415395876 val_auroc:  0.8754960317460317 val_auprc:  0.9369189235788874
EarlyStopping counter: 1 out of 50
epoch:  40
epoch:  41 val_f1:  0.7468467601061853 val_auroc:  0.880828373015873 val_auprc:  0.9461607701129596
EarlyStopping counter: 2 out of 50
epoch:  41
epoch:  42 val_f1:  0.7966751918158568 val_auroc:  0.8830605158730158 val_auprc:  0.9436821929844961
EarlyStopping counter: 3 out of 50
epoch:  42
epoch:  43 val_f1:  0.8035275913020209 val_auroc:  0.8740079365079364 val_auprc:  0.9371877473843686
EarlyStopping counter: 4 out of 50
epoch:  43
epoch:  44 val_f1:  0.8057130854862423 val_auroc:  0.8715277777777777 val_auprc:  0.9393436232704204
EarlyStopping counter: 5 out of 50
epoch:  44
epoch:  45 val_f1:  0.7833564971403972 val_auroc:  0.8668154761904763 val_auprc:  0.9237911571486916
EarlyStopping counter: 6 out of 50
epoch:  45
epoch:  46 val_f1:  0.7563598080432068 val_auroc:  0.8663194444444444 val_auprc:  0.9273144665045888
EarlyStopping counter: 7 out of 50
epoch:  46
epoch:  47 val_f1:  0.7207167709858867 val_auroc:  0.8621031746031745 val_auprc:  0.9244636413793458
EarlyStopping counter: 8 out of 50
epoch:  47
epoch:  48 val_f1:  0.8103538508923273 val_auroc:  0.8705357142857143 val_auprc:  0.9322079235161634
EarlyStopping counter: 9 out of 50
epoch:  48
epoch:  49 val_f1:  0.7926396128627546 val_auroc:  0.8707837301587301 val_auprc:  0.9382086739083282
EarlyStopping counter: 10 out of 50
epoch:  49
epoch:  50 val_f1:  0.7614778962024896 val_auroc:  0.876860119047619 val_auprc:  0.9442073360045697
EarlyStopping counter: 11 out of 50
epoch:  50
epoch:  51 val_f1:  0.7839990466164816 val_auroc:  0.8722718253968252 val_auprc:  0.9360760187697671
EarlyStopping counter: 12 out of 50
epoch:  51
epoch:  52 val_f1:  0.7971014492753623 val_auroc:  0.8747519841269841 val_auprc:  0.9373097620328408
EarlyStopping counter: 13 out of 50
epoch:  52
epoch:  53 val_f1:  0.8433224248091008 val_auroc:  0.8774801587301587 val_auprc:  0.9366089357537952
EarlyStopping counter: 14 out of 50
epoch:  53
epoch:  54 val_f1:  0.8164398044139025 val_auroc:  0.8680555555555555 val_auprc:  0.9263553334602111
EarlyStopping counter: 15 out of 50
epoch:  54
epoch:  55 val_f1:  0.8156899810964081 val_auroc:  0.8747519841269841 val_auprc:  0.9351767475639364
EarlyStopping counter: 16 out of 50
epoch:  55
epoch:  56 val_f1:  0.7904805491990847 val_auroc:  0.8802083333333334 val_auprc:  0.9412693390260071
EarlyStopping counter: 17 out of 50
epoch:  56
epoch:  57 val_f1:  0.7940993788819876 val_auroc:  0.8802083333333333 val_auprc:  0.940359840561312
EarlyStopping counter: 18 out of 50
epoch:  57
epoch:  58 val_f1:  0.8022296544035674 val_auroc:  0.8804563492063492 val_auprc:  0.9402569596989823
EarlyStopping counter: 19 out of 50
epoch:  58
epoch:  59 val_f1:  0.7422090197137456 val_auroc:  0.8718998015873015 val_auprc:  0.9235793179409739
EarlyStopping counter: 20 out of 50
epoch:  59
epoch:  60 val_f1:  0.7061872909698997 val_auroc:  0.8652033730158729 val_auprc:  0.9182054177433934
EarlyStopping counter: 21 out of 50
epoch:  60
epoch:  61 val_f1:  0.807228002894545 val_auroc:  0.8556547619047619 val_auprc:  0.922847303433015
EarlyStopping counter: 22 out of 50
epoch:  61
epoch:  62 val_f1:  0.7966751918158568 val_auroc:  0.8648313492063492 val_auprc:  0.9329873677103511
EarlyStopping counter: 23 out of 50
epoch:  62
epoch:  63 val_f1:  0.8305598194589869 val_auroc:  0.8722718253968254 val_auprc:  0.9304152773591339
EarlyStopping counter: 24 out of 50
epoch:  63
epoch:  64 val_f1:  0.7884143290944841 val_auroc:  0.8723958333333333 val_auprc:  0.9375512879915684
EarlyStopping counter: 25 out of 50
epoch:  64
epoch:  65 val_f1:  0.817642543094424 val_auroc:  0.8725198412698413 val_auprc:  0.9278919690775838
EarlyStopping counter: 26 out of 50
epoch:  65
epoch:  66 val_f1:  0.7207167709858867 val_auroc:  0.8802083333333333 val_auprc:  0.9294786992976982
EarlyStopping counter: 27 out of 50
epoch:  66
epoch:  67 val_f1:  0.807228002894545 val_auroc:  0.8705357142857143 val_auprc:  0.9326001600793632
EarlyStopping counter: 28 out of 50
epoch:  67
epoch:  68 val_f1:  0.8036760694501368 val_auroc:  0.8774801587301587 val_auprc:  0.9401532755689688
EarlyStopping counter: 29 out of 50
epoch:  68
epoch:  69 val_f1:  0.7781291172595521 val_auroc:  0.8798363095238094 val_auprc:  0.9449739215716431
EarlyStopping counter: 30 out of 50
epoch:  69
epoch:  70 val_f1:  0.792371879328401 val_auroc:  0.8712797619047619 val_auprc:  0.9368193130596545
EarlyStopping counter: 31 out of 50
epoch:  70
epoch:  71 val_f1:  0.7901701323251418 val_auroc:  0.8661954365079365 val_auprc:  0.9348084833771337
EarlyStopping counter: 32 out of 50
epoch:  71
epoch:  72 val_f1:  0.8036760694501368 val_auroc:  0.8665674603174602 val_auprc:  0.9333410460099512
EarlyStopping counter: 33 out of 50
epoch:  72
epoch:  73 val_f1:  0.7901701323251418 val_auroc:  0.8664434523809523 val_auprc:  0.935500115787619
EarlyStopping counter: 34 out of 50
epoch:  73
epoch:  74 val_f1:  0.8205262448141007 val_auroc:  0.8697916666666667 val_auprc:  0.9350458320543407
EarlyStopping counter: 35 out of 50
epoch:  74
epoch:  75 val_f1:  0.8036760694501368 val_auroc:  0.8725198412698413 val_auprc:  0.9368285228212285
EarlyStopping counter: 36 out of 50
epoch:  75
epoch:  76 val_f1:  0.8088065661047027 val_auroc:  0.8695436507936508 val_auprc:  0.9360378257097737
EarlyStopping counter: 37 out of 50
epoch:  76
epoch:  77 val_f1:  0.7772795841859215 val_auroc:  0.875 val_auprc:  0.9410272637035872
EarlyStopping counter: 38 out of 50
epoch:  77
epoch:  78 val_f1:  0.7949078298424175 val_auroc:  0.8745039682539683 val_auprc:  0.9398104048850877
EarlyStopping counter: 39 out of 50
epoch:  78
epoch:  79 val_f1:  0.8127933585226971 val_auroc:  0.8752480158730158 val_auprc:  0.9378921818958456
EarlyStopping counter: 40 out of 50
epoch:  79
epoch:  80 val_f1:  0.7971014492753623 val_auroc:  0.8742559523809523 val_auprc:  0.9383071617377808
EarlyStopping counter: 41 out of 50
epoch:  80
epoch:  81 val_f1:  0.8290790088826556 val_auroc:  0.8735119047619047 val_auprc:  0.935458532917611
EarlyStopping counter: 42 out of 50
epoch:  81
epoch:  82 val_f1:  0.8022296544035674 val_auroc:  0.8757440476190477 val_auprc:  0.938904149071039
EarlyStopping counter: 43 out of 50
epoch:  82
epoch:  83 val_f1:  0.7940993788819876 val_auroc:  0.8743799603174602 val_auprc:  0.9386217674897215
EarlyStopping counter: 44 out of 50
epoch:  83
epoch:  84 val_f1:  0.8022296544035674 val_auroc:  0.8735119047619048 val_auprc:  0.9380822999474471
EarlyStopping counter: 45 out of 50
epoch:  84
epoch:  85 val_f1:  0.7839990466164816 val_auroc:  0.8722718253968254 val_auprc:  0.9376557230071108
EarlyStopping counter: 46 out of 50
epoch:  85
epoch:  86 val_f1:  0.7969889682024659 val_auroc:  0.873015873015873 val_auprc:  0.9383007211200969
EarlyStopping counter: 47 out of 50
epoch:  86
epoch:  87 val_f1:  0.8035275913020209 val_auroc:  0.8735119047619048 val_auprc:  0.9384380745107435
EarlyStopping counter: 48 out of 50
epoch:  87
epoch:  88 val_f1:  0.8138718358422335 val_auroc:  0.8707837301587301 val_auprc:  0.9351157225901968
EarlyStopping counter: 49 out of 50
epoch:  88
epoch:  89 val_f1:  0.800639197204071 val_auroc:  0.875 val_auprc:  0.9385249833132697
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  2141.784747362137
{'time_elapsed': [2141.784747362137], 'epoch': [88], 'fold': [4], 'f1_train': [0.9982029282297181], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.800639197204071], 'auroc_test': [0.875], 'auprc_test': [0.9385249833132697]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 1280]          4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 1280]          2,048
│    └─Tanh: 2-3                         [64, 1024, 1280]          --
│    └─MaxPool1d: 2-4                    [64, 1024, 1278]          --
│    └─Dropout: 2-5                      [64, 1024, 1278]          --
│    └─Flatten: 2-6                      [64, 1308672]             --
│    └─Linear: 2-7                       [64, 1]                   1,308,673
==========================================================================================
Total params: 1,314,817
Trainable params: 1,314,817
Non-trainable params: 0
Total mult-adds (M): 419.43
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 1342.18
Params size (MB): 5.26
Estimated Total Size (MB): 1347.76
==========================================================================================
config:  {'project': 'MHCCBM', 'name': 'CNN_5', 'config': {'hidden_channels': [1024], 'epochs': 500, 'kernel_size': 3, 'pool_kernel_size': 3, 'classes': 2, 'seed': 42, 'batch_size': 64, 'lr': 0.001, 'dataset': 'X.pkl, y.pkl (embedded peptide seq from classification', 'dropout_p': 0.1, 'architecture': 'CNN'}}
Seed:  42
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.6134480650773498 val_auroc:  0.6487481590574374 val_auprc:  0.7557849521508511
epoch:  1
epoch:  2 val_f1:  0.5296143889361256 val_auroc:  0.7174766813942072 val_auprc:  0.8610848764562946
Validation loss improved to 1.512159
epoch:  2
epoch:  3 val_f1:  0.6835594973158149 val_auroc:  0.7444771723122239 val_auprc:  0.881798773058325
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.7025483104025048 val_auroc:  0.7552773686794306 val_auprc:  0.8875768501402376
EarlyStopping counter: 2 out of 50
epoch:  4
epoch:  5 val_f1:  0.5234992716223703 val_auroc:  0.7582228767795778 val_auprc:  0.887867999366107
EarlyStopping counter: 3 out of 50
epoch:  5
epoch:  6 val_f1:  0.6960581600537912 val_auroc:  0.7584683357879235 val_auprc:  0.8838125652664868
Validation loss improved to 1.312538
epoch:  6
epoch:  7 val_f1:  0.7411406017655346 val_auroc:  0.7592047128129602 val_auprc:  0.879311829873977
EarlyStopping counter: 1 out of 50
epoch:  7
epoch:  8 val_f1:  0.6752910608296504 val_auroc:  0.7650957290132547 val_auprc:  0.883846019077684
Validation loss improved to 1.303954
epoch:  8
epoch:  9 val_f1:  0.6549643402161387 val_auroc:  0.7768777614138439 val_auprc:  0.8958219731020158
Validation loss improved to 1.229546
epoch:  9
epoch:  10 val_f1:  0.7402181480621955 val_auroc:  0.7879234167893961 val_auprc:  0.9049868824710678
Validation loss improved to 1.186727
epoch:  10
epoch:  11 val_f1:  0.7727225509205256 val_auroc:  0.8016691212567502 val_auprc:  0.9129447775924839
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.4070174368979393 val_auroc:  0.8095238095238095 val_auprc:  0.9164778658723054
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.7473654218886486 val_auroc:  0.8078055964653902 val_auprc:  0.9143737047807078
EarlyStopping counter: 3 out of 50
epoch:  13
epoch:  14 val_f1:  0.6891084624964738 val_auroc:  0.8163966617574865 val_auprc:  0.9202493081175867
Validation loss improved to 1.112121
epoch:  14
epoch:  15 val_f1:  0.7681512331200245 val_auroc:  0.8122238586156112 val_auprc:  0.9177152396582113
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.6590199752078746 val_auroc:  0.8114874815905744 val_auprc:  0.91684864057699
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.7737843767539161 val_auroc:  0.817378497790869 val_auprc:  0.9208478421776817
EarlyStopping counter: 3 out of 50
epoch:  17
epoch:  18 val_f1:  0.7536081085870222 val_auroc:  0.814187530682376 val_auprc:  0.9184214958975576
EarlyStopping counter: 4 out of 50
epoch:  18
epoch:  19 val_f1:  0.7029258641632973 val_auroc:  0.8225331369661266 val_auprc:  0.9233078756401905
EarlyStopping counter: 5 out of 50
epoch:  19
epoch:  20 val_f1:  0.7034651178140057 val_auroc:  0.8249877270495828 val_auprc:  0.9249215781438049
EarlyStopping counter: 6 out of 50
epoch:  20
epoch:  21 val_f1:  0.7031576347932113 val_auroc:  0.812960235640648 val_auprc:  0.916773074517956
EarlyStopping counter: 7 out of 50
epoch:  21
epoch:  22 val_f1:  0.730071543320129 val_auroc:  0.812960235640648 val_auprc:  0.9157476278070509
EarlyStopping counter: 8 out of 50
epoch:  22
epoch:  23 val_f1:  0.76000113614692 val_auroc:  0.8244968090328915 val_auprc:  0.9253755270398243
EarlyStopping counter: 9 out of 50
epoch:  23
epoch:  24 val_f1:  0.7552115339652351 val_auroc:  0.8232695139911634 val_auprc:  0.9232863829429856
EarlyStopping counter: 10 out of 50
epoch:  24
epoch:  25 val_f1:  0.7617596949267598 val_auroc:  0.8222876779577811 val_auprc:  0.9224159891889672
EarlyStopping counter: 11 out of 50
epoch:  25
epoch:  26 val_f1:  0.7307106601978622 val_auroc:  0.819833087874325 val_auprc:  0.9214597535104065
EarlyStopping counter: 12 out of 50
epoch:  26
epoch:  27 val_f1:  0.7661184054361647 val_auroc:  0.8208149239077074 val_auprc:  0.9230967534988269
EarlyStopping counter: 13 out of 50
epoch:  27
epoch:  28 val_f1:  0.748656020238754 val_auroc:  0.8195876288659795 val_auprc:  0.9210278904187079
EarlyStopping counter: 14 out of 50
epoch:  28
epoch:  29 val_f1:  0.7029258641632973 val_auroc:  0.8141875306823761 val_auprc:  0.9173664431164749
EarlyStopping counter: 15 out of 50
epoch:  29
epoch:  30 val_f1:  0.7536081085870222 val_auroc:  0.8193421698576336 val_auprc:  0.9216338371524266
EarlyStopping counter: 16 out of 50
epoch:  30
epoch:  31 val_f1:  0.7573003855683703 val_auroc:  0.8195876288659794 val_auprc:  0.9222465083556874
EarlyStopping counter: 17 out of 50
epoch:  31
epoch:  32 val_f1:  0.748656020238754 val_auroc:  0.814187530682376 val_auprc:  0.9167584637621937
EarlyStopping counter: 18 out of 50
epoch:  32
epoch:  33 val_f1:  0.7483101088021195 val_auroc:  0.810505645557192 val_auprc:  0.9159978965615719
EarlyStopping counter: 19 out of 50
epoch:  33
epoch:  34 val_f1:  0.7237742540242516 val_auroc:  0.8205694648993618 val_auprc:  0.9245512575891854
EarlyStopping counter: 20 out of 50
epoch:  34
epoch:  35 val_f1:  0.7490302789770621 val_auroc:  0.8134511536573393 val_auprc:  0.9168666089517303
EarlyStopping counter: 21 out of 50
epoch:  35
epoch:  36 val_f1:  0.7337314237416728 val_auroc:  0.8200785468826707 val_auprc:  0.9231435938185856
EarlyStopping counter: 22 out of 50
epoch:  36
epoch:  37 val_f1:  0.743431836172277 val_auroc:  0.8203240058910162 val_auprc:  0.9230573143776277
EarlyStopping counter: 23 out of 50
epoch:  37
epoch:  38 val_f1:  0.7567268683783295 val_auroc:  0.8156602847324497 val_auprc:  0.9180819668440876
EarlyStopping counter: 24 out of 50
epoch:  38
epoch:  39 val_f1:  0.7454557504588546 val_auroc:  0.8159057437407953 val_auprc:  0.9188137899113393
EarlyStopping counter: 25 out of 50
epoch:  39
epoch:  40 val_f1:  0.7411406017655346 val_auroc:  0.8132056946489936 val_auprc:  0.9172809605278114
EarlyStopping counter: 26 out of 50
epoch:  40
epoch:  41 val_f1:  0.7375047745919104 val_auroc:  0.8166421207658322 val_auprc:  0.9182136902723199
EarlyStopping counter: 27 out of 50
epoch:  41
epoch:  42 val_f1:  0.7390688025474315 val_auroc:  0.8163966617574865 val_auprc:  0.9192242155849037
EarlyStopping counter: 28 out of 50
epoch:  42
epoch:  43 val_f1:  0.7426698176342648 val_auroc:  0.810505645557192 val_auprc:  0.916219092766504
EarlyStopping counter: 29 out of 50
epoch:  43
epoch:  44 val_f1:  0.7426698176342648 val_auroc:  0.8171330387825233 val_auprc:  0.9200008900327686
EarlyStopping counter: 30 out of 50
epoch:  44
epoch:  45 val_f1:  0.7371937993371881 val_auroc:  0.8195876288659795 val_auprc:  0.9213129337248764
EarlyStopping counter: 31 out of 50
epoch:  45
epoch:  46 val_f1:  0.7466980132583976 val_auroc:  0.8149239077074129 val_auprc:  0.918330835050603
EarlyStopping counter: 32 out of 50
epoch:  46
epoch:  47 val_f1:  0.7519437633413868 val_auroc:  0.8208149239077075 val_auprc:  0.9216110271219086
EarlyStopping counter: 33 out of 50
epoch:  47
epoch:  48 val_f1:  0.7542604103291037 val_auroc:  0.8109965635738832 val_auprc:  0.9147982787291485
EarlyStopping counter: 34 out of 50
epoch:  48
epoch:  49 val_f1:  0.7363119073255568 val_auroc:  0.8200785468826706 val_auprc:  0.9200775584066962
EarlyStopping counter: 35 out of 50
epoch:  49
epoch:  50 val_f1:  0.7580594896895918 val_auroc:  0.8102601865488465 val_auprc:  0.9138625357982433
EarlyStopping counter: 36 out of 50
epoch:  50
epoch:  51 val_f1:  0.751751326211758 val_auroc:  0.8159057437407953 val_auprc:  0.9172834078413863
EarlyStopping counter: 37 out of 50
epoch:  51
epoch:  52 val_f1:  0.7477455593342162 val_auroc:  0.8237604320078548 val_auprc:  0.9234803575995856
EarlyStopping counter: 38 out of 50
epoch:  52
epoch:  53 val_f1:  0.751751326211758 val_auroc:  0.8157830142366225 val_auprc:  0.9149266282149161
EarlyStopping counter: 39 out of 50
epoch:  53
epoch:  54 val_f1:  0.7473302173830908 val_auroc:  0.812960235640648 val_auprc:  0.9153687623614029
EarlyStopping counter: 40 out of 50
epoch:  54
epoch:  55 val_f1:  0.7412236216203913 val_auroc:  0.8176239567992145 val_auprc:  0.920667477220198
EarlyStopping counter: 41 out of 50
epoch:  55
epoch:  56 val_f1:  0.743396428458658 val_auroc:  0.8073146784486992 val_auprc:  0.9138797742148722
EarlyStopping counter: 42 out of 50
epoch:  56
epoch:  57 val_f1:  0.7299542184434271 val_auroc:  0.8129602356406479 val_auprc:  0.9157660920046151
EarlyStopping counter: 43 out of 50
epoch:  57
epoch:  58 val_f1:  0.7410071942446043 val_auroc:  0.8134511536573392 val_auprc:  0.9167047598963476
EarlyStopping counter: 44 out of 50
epoch:  58
epoch:  59 val_f1:  0.7519437633413868 val_auroc:  0.8171330387825233 val_auprc:  0.9181853784413294
EarlyStopping counter: 45 out of 50
epoch:  59
epoch:  60 val_f1:  0.7583800901862243 val_auroc:  0.8132056946489936 val_auprc:  0.9157908317059047
EarlyStopping counter: 46 out of 50
epoch:  60
epoch:  61 val_f1:  0.7454557504588546 val_auroc:  0.8095238095238095 val_auprc:  0.9127185999905414
EarlyStopping counter: 47 out of 50
epoch:  61
epoch:  62 val_f1:  0.76000113614692 val_auroc:  0.8109965635738832 val_auprc:  0.9135046094010965
EarlyStopping counter: 48 out of 50
epoch:  62
epoch:  63 val_f1:  0.7536606851900262 val_auroc:  0.8119783996072656 val_auprc:  0.9147993631674255
EarlyStopping counter: 49 out of 50
epoch:  63
epoch:  64 val_f1:  0.7441671543148256 val_auroc:  0.8141875306823761 val_auprc:  0.9174955701683057
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  391.43311882019043
{'time_elapsed': [391.43311882019043], 'epoch': [63], 'fold': [0], 'f1_train': [0.9910272898858162], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7441671543148256], 'auroc_test': [0.8141875306823761], 'auprc_test': [0.9174955701683057]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 427]           2,048
│    └─Tanh: 2-3                         [64, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 142]           --
│    └─Dropout: 2-5                      [64, 1024, 142]           --
│    └─Flatten: 2-6                      [64, 145408]              --
│    └─Linear: 2-7                       [64, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 121.37
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 447.74
Params size (MB): 0.61
Estimated Total Size (MB): 448.68
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.612555769145391 val_auroc:  0.6745213549337261 val_auprc:  0.7743959487010413
epoch:  1
epoch:  2 val_f1:  0.6810705528674974 val_auroc:  0.6961217476681394 val_auprc:  0.8470053191751112
Validation loss improved to 1.275975
epoch:  2
epoch:  3 val_f1:  0.6823403921278894 val_auroc:  0.7439862542955327 val_auprc:  0.8960878593217
Validation loss improved to 1.226821
epoch:  3
epoch:  4 val_f1:  0.5703506192714826 val_auroc:  0.7736867943053511 val_auprc:  0.9105173936307464
EarlyStopping counter: 1 out of 50
epoch:  4
epoch:  5 val_f1:  0.7002679453520968 val_auroc:  0.7906234658811979 val_auprc:  0.91771177596025
Validation loss improved to 1.041345
epoch:  5
epoch:  6 val_f1:  0.6967647049253406 val_auroc:  0.7938144329896908 val_auprc:  0.9187563411029926
EarlyStopping counter: 1 out of 50
epoch:  6
epoch:  7 val_f1:  0.7443780691637675 val_auroc:  0.8001963672066765 val_auprc:  0.9203376761233277
EarlyStopping counter: 2 out of 50
epoch:  7
epoch:  8 val_f1:  0.6324215845256547 val_auroc:  0.8031418753068237 val_auprc:  0.9210707463284693
EarlyStopping counter: 3 out of 50
epoch:  8
epoch:  9 val_f1:  0.7157412825720284 val_auroc:  0.8004418262150221 val_auprc:  0.9179650135720157
Validation loss improved to 0.976681
epoch:  9
epoch:  10 val_f1:  0.7691994463100789 val_auroc:  0.8009327442317133 val_auprc:  0.917794027491171
Validation loss improved to 0.955360
epoch:  10
epoch:  11 val_f1:  0.7096759374109908 val_auroc:  0.8055964653902798 val_auprc:  0.9208126320877184
EarlyStopping counter: 1 out of 50
epoch:  11
epoch:  12 val_f1:  0.7542604103291037 val_auroc:  0.8001963672066765 val_auprc:  0.9168340077765265
EarlyStopping counter: 2 out of 50
epoch:  12
epoch:  13 val_f1:  0.7313689473952751 val_auroc:  0.8028964162984782 val_auprc:  0.9181355650373159
EarlyStopping counter: 3 out of 50
epoch:  13
epoch:  14 val_f1:  0.7500864926036699 val_auroc:  0.7970054000981837 val_auprc:  0.9149095881960477
EarlyStopping counter: 4 out of 50
epoch:  14
epoch:  15 val_f1:  0.7203480251458693 val_auroc:  0.7955326460481099 val_auprc:  0.9141305348905734
EarlyStopping counter: 5 out of 50
epoch:  15
epoch:  16 val_f1:  0.743431836172277 val_auroc:  0.7970054000981835 val_auprc:  0.9142004431567495
EarlyStopping counter: 6 out of 50
epoch:  16
epoch:  17 val_f1:  0.743431836172277 val_auroc:  0.7962690230731467 val_auprc:  0.9131203889111342
EarlyStopping counter: 7 out of 50
epoch:  17
epoch:  18 val_f1:  0.7233618940391454 val_auroc:  0.7947962690230732 val_auprc:  0.9123605608829377
EarlyStopping counter: 8 out of 50
epoch:  18
epoch:  19 val_f1:  0.7390688025474315 val_auroc:  0.7974963181148749 val_auprc:  0.9126991715014279
EarlyStopping counter: 9 out of 50
epoch:  19
epoch:  20 val_f1:  0.743431836172277 val_auroc:  0.7994599901816397 val_auprc:  0.9130871171311413
EarlyStopping counter: 10 out of 50
epoch:  20
epoch:  21 val_f1:  0.7208993647046947 val_auroc:  0.7989690721649485 val_auprc:  0.9128967828672929
EarlyStopping counter: 11 out of 50
epoch:  21
epoch:  22 val_f1:  0.7428255465713769 val_auroc:  0.802405498281787 val_auprc:  0.915300615987226
EarlyStopping counter: 12 out of 50
epoch:  22
epoch:  23 val_f1:  0.742136387976997 val_auroc:  0.8031418753068238 val_auprc:  0.9136795430055397
EarlyStopping counter: 13 out of 50
epoch:  23
epoch:  24 val_f1:  0.7420910227448273 val_auroc:  0.8038782523318606 val_auprc:  0.9146757916596248
EarlyStopping counter: 14 out of 50
epoch:  24
epoch:  25 val_f1:  0.7402181480621955 val_auroc:  0.7999509081983309 val_auprc:  0.913674996531473
EarlyStopping counter: 15 out of 50
epoch:  25
epoch:  26 val_f1:  0.6892815309975336 val_auroc:  0.7972508591065292 val_auprc:  0.9118709041740582
EarlyStopping counter: 16 out of 50
epoch:  26
epoch:  27 val_f1:  0.735514445586388 val_auroc:  0.8065783014236622 val_auprc:  0.9162905764568869
EarlyStopping counter: 17 out of 50
epoch:  27
epoch:  28 val_f1:  0.7330561760022478 val_auroc:  0.8102601865488465 val_auprc:  0.9190365987702105
EarlyStopping counter: 18 out of 50
epoch:  28
epoch:  29 val_f1:  0.6966777045653197 val_auroc:  0.8112420225822289 val_auprc:  0.9188246742104414
EarlyStopping counter: 19 out of 50
epoch:  29
epoch:  30 val_f1:  0.7162290583621869 val_auroc:  0.8090328915071183 val_auprc:  0.9172008752918028
EarlyStopping counter: 20 out of 50
epoch:  30
epoch:  31 val_f1:  0.7536606851900262 val_auroc:  0.8087874324987727 val_auprc:  0.9165538745104815
EarlyStopping counter: 21 out of 50
epoch:  31
epoch:  32 val_f1:  0.742136387976997 val_auroc:  0.8122238586156113 val_auprc:  0.9182304741073956
EarlyStopping counter: 22 out of 50
epoch:  32
epoch:  33 val_f1:  0.7237424247793883 val_auroc:  0.8087874324987728 val_auprc:  0.9166595814106868
EarlyStopping counter: 23 out of 50
epoch:  33
epoch:  34 val_f1:  0.7737843767539161 val_auroc:  0.8109965635738833 val_auprc:  0.915611073458105
EarlyStopping counter: 24 out of 50
epoch:  34
epoch:  35 val_f1:  0.7295632867761842 val_auroc:  0.8095238095238095 val_auprc:  0.9153481179455661
EarlyStopping counter: 25 out of 50
epoch:  35
epoch:  36 val_f1:  0.748656020238754 val_auroc:  0.8078055964653903 val_auprc:  0.9131268823958243
EarlyStopping counter: 26 out of 50
epoch:  36
epoch:  37 val_f1:  0.7633714058926586 val_auroc:  0.8004418262150221 val_auprc:  0.9100920280994717
EarlyStopping counter: 27 out of 50
epoch:  37
epoch:  38 val_f1:  0.7580594896895918 val_auroc:  0.8073146784486991 val_auprc:  0.914952627623234
EarlyStopping counter: 28 out of 50
epoch:  38
epoch:  39 val_f1:  0.7580594896895918 val_auroc:  0.8041237113402062 val_auprc:  0.9106991087082738
EarlyStopping counter: 29 out of 50
epoch:  39
epoch:  40 val_f1:  0.7448635686045757 val_auroc:  0.8031418753068238 val_auprc:  0.9097606960488511
EarlyStopping counter: 30 out of 50
epoch:  40
epoch:  41 val_f1:  0.7166849710626011 val_auroc:  0.8005645557191949 val_auprc:  0.9090769193530707
EarlyStopping counter: 31 out of 50
epoch:  41
epoch:  42 val_f1:  0.751751326211758 val_auroc:  0.8009327442317133 val_auprc:  0.9081390481546179
EarlyStopping counter: 32 out of 50
epoch:  42
epoch:  43 val_f1:  0.7519437633413868 val_auroc:  0.8009327442317133 val_auprc:  0.9094665459298896
EarlyStopping counter: 33 out of 50
epoch:  43
epoch:  44 val_f1:  0.7531731915989216 val_auroc:  0.8046146293568974 val_auprc:  0.9117675516099013
EarlyStopping counter: 34 out of 50
epoch:  44
epoch:  45 val_f1:  0.7617684906754855 val_auroc:  0.8014236622484044 val_auprc:  0.9088917676307517
EarlyStopping counter: 35 out of 50
epoch:  45
epoch:  46 val_f1:  0.7598715939807772 val_auroc:  0.7999509081983308 val_auprc:  0.9071496267060227
EarlyStopping counter: 36 out of 50
epoch:  46
epoch:  47 val_f1:  0.7359369647139431 val_auroc:  0.7974963181148749 val_auprc:  0.9067699471639422
EarlyStopping counter: 37 out of 50
epoch:  47
epoch:  48 val_f1:  0.7536081085870222 val_auroc:  0.7982326951399117 val_auprc:  0.9067387699975303
EarlyStopping counter: 38 out of 50
epoch:  48
epoch:  49 val_f1:  0.7283736963917239 val_auroc:  0.8014236622484046 val_auprc:  0.9086155480803464
EarlyStopping counter: 39 out of 50
epoch:  49
epoch:  50 val_f1:  0.76000113614692 val_auroc:  0.7965144820814924 val_auprc:  0.9050964349135753
EarlyStopping counter: 40 out of 50
epoch:  50
epoch:  51 val_f1:  0.7410071942446043 val_auroc:  0.7997054491899852 val_auprc:  0.9062265219224453
EarlyStopping counter: 41 out of 50
epoch:  51
epoch:  52 val_f1:  0.7363119073255568 val_auroc:  0.7957781050564556 val_auprc:  0.9050980185893276
EarlyStopping counter: 42 out of 50
epoch:  52
epoch:  53 val_f1:  0.7410071942446043 val_auroc:  0.7933235149729996 val_auprc:  0.9017258418722747
EarlyStopping counter: 43 out of 50
epoch:  53
epoch:  54 val_f1:  0.7707245329923307 val_auroc:  0.7933235149729995 val_auprc:  0.9009286270932262
EarlyStopping counter: 44 out of 50
epoch:  54
epoch:  55 val_f1:  0.7536606851900262 val_auroc:  0.7943053510063819 val_auprc:  0.9034138404846979
EarlyStopping counter: 45 out of 50
epoch:  55
epoch:  56 val_f1:  0.7283736963917239 val_auroc:  0.7945508100147276 val_auprc:  0.9024141573675285
EarlyStopping counter: 46 out of 50
epoch:  56
epoch:  57 val_f1:  0.7536606851900262 val_auroc:  0.7903780068728522 val_auprc:  0.8998423716241315
EarlyStopping counter: 47 out of 50
epoch:  57
epoch:  58 val_f1:  0.7580594896895918 val_auroc:  0.7869415807560138 val_auprc:  0.8970582897989379
EarlyStopping counter: 48 out of 50
epoch:  58
epoch:  59 val_f1:  0.76000113614692 val_auroc:  0.7871870397643594 val_auprc:  0.8977419157520294
EarlyStopping counter: 49 out of 50
epoch:  59
epoch:  60 val_f1:  0.7727225509205256 val_auroc:  0.7891507118311242 val_auprc:  0.8991930300119321
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  346.9940936565399
{'time_elapsed': [346.9940936565399], 'epoch': [59], 'fold': [1], 'f1_train': [0.9964023152258445], 'auroc_train': [0.9999846705705613], 'auprc_train': [0.9999932970817315], 'f1_test': [0.7727225509205256], 'auroc_test': [0.7891507118311242], 'auprc_test': [0.8991930300119321]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 427]           2,048
│    └─Tanh: 2-3                         [64, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 142]           --
│    └─Dropout: 2-5                      [64, 1024, 142]           --
│    └─Flatten: 2-6                      [64, 145408]              --
│    └─Linear: 2-7                       [64, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 121.37
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 447.74
Params size (MB): 0.61
Estimated Total Size (MB): 448.68
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.1402281489725347 val_auroc:  0.6575846833578792 val_auprc:  0.8221470947521818
epoch:  1
epoch:  2 val_f1:  0.649531284063658 val_auroc:  0.6232204221894944 val_auprc:  0.8078416566459016
Validation loss improved to 1.707009
epoch:  2
epoch:  3 val_f1:  0.6162507314722384 val_auroc:  0.627147766323024 val_auprc:  0.8133432356652662
EarlyStopping counter: 1 out of 50
epoch:  3
epoch:  4 val_f1:  0.39723613514251893 val_auroc:  0.6438389788905253 val_auprc:  0.8247061518565397
EarlyStopping counter: 2 out of 50
epoch:  4
epoch:  5 val_f1:  0.5678413349175468 val_auroc:  0.6713303878252332 val_auprc:  0.837138071206726
Validation loss improved to 1.535647
epoch:  5
epoch:  6 val_f1:  0.6751388509211166 val_auroc:  0.7044673539518901 val_auprc:  0.848530549689008
Validation loss improved to 1.339695
epoch:  6
epoch:  7 val_f1:  0.6097807970632291 val_auroc:  0.7167403043691704 val_auprc:  0.8503675048400214
Validation loss improved to 1.302039
epoch:  7
epoch:  8 val_f1:  0.7054786939679025 val_auroc:  0.7302405498281788 val_auprc:  0.8543150288446877
Validation loss improved to 1.249146
epoch:  8
epoch:  9 val_f1:  0.4795145890028967 val_auroc:  0.7368679430535101 val_auprc:  0.8590087770498186
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.6823403921278894 val_auroc:  0.7407952871870397 val_auprc:  0.8589921305692212
Validation loss improved to 1.205205
epoch:  10
epoch:  11 val_f1:  0.7505653177403916 val_auroc:  0.7496318114874816 val_auprc:  0.8659609068390928
Validation loss improved to 1.163707
epoch:  11
epoch:  12 val_f1:  0.7560320485424044 val_auroc:  0.7589592538046146 val_auprc:  0.870889305261376
Validation loss improved to 1.125297
epoch:  12
epoch:  13 val_f1:  0.6681233752336595 val_auroc:  0.7594501718213059 val_auprc:  0.8712736810156317
EarlyStopping counter: 1 out of 50
epoch:  13
epoch:  14 val_f1:  0.5492496824096865 val_auroc:  0.7569955817378498 val_auprc:  0.8692945124882986
EarlyStopping counter: 2 out of 50
epoch:  14
epoch:  15 val_f1:  0.7283736963917239 val_auroc:  0.7572410407461954 val_auprc:  0.8692730458174777
EarlyStopping counter: 3 out of 50
epoch:  15
epoch:  16 val_f1:  0.7494347379239465 val_auroc:  0.7717231222385862 val_auprc:  0.8800720787337721
Validation loss improved to 1.114420
epoch:  16
epoch:  17 val_f1:  0.540855266097681 val_auroc:  0.7739322533136966 val_auprc:  0.8806743650671707
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.7390688025474315 val_auroc:  0.7734413352970054 val_auprc:  0.8781740948172428
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7098736982331642 val_auroc:  0.7749140893470791 val_auprc:  0.8791261017108849
EarlyStopping counter: 3 out of 50
epoch:  19
epoch:  20 val_f1:  0.7390688025474315 val_auroc:  0.7722140402552774 val_auprc:  0.8783247249663861
EarlyStopping counter: 4 out of 50
epoch:  20
epoch:  21 val_f1:  0.667134140788635 val_auroc:  0.7776141384388807 val_auprc:  0.8823307494793299
EarlyStopping counter: 5 out of 50
epoch:  21
epoch:  22 val_f1:  0.7359858855314679 val_auroc:  0.780559646539028 val_auprc:  0.8846385897875305
EarlyStopping counter: 6 out of 50
epoch:  22
epoch:  23 val_f1:  0.7030912407309765 val_auroc:  0.776141384388807 val_auprc:  0.8820370075621167
EarlyStopping counter: 7 out of 50
epoch:  23
epoch:  24 val_f1:  0.7559325673789327 val_auroc:  0.7835051546391752 val_auprc:  0.8860013666887805
EarlyStopping counter: 8 out of 50
epoch:  24
epoch:  25 val_f1:  0.730071543320129 val_auroc:  0.7776141384388806 val_auprc:  0.8840613805441663
EarlyStopping counter: 9 out of 50
epoch:  25
epoch:  26 val_f1:  0.7298555432283743 val_auroc:  0.7746686303387333 val_auprc:  0.8816040890434016
EarlyStopping counter: 10 out of 50
epoch:  26
epoch:  27 val_f1:  0.7266187050359713 val_auroc:  0.7763868433971526 val_auprc:  0.8824690587670454
EarlyStopping counter: 11 out of 50
epoch:  27
epoch:  28 val_f1:  0.7166299330477814 val_auroc:  0.7827687776141384 val_auprc:  0.88825485059672
EarlyStopping counter: 12 out of 50
epoch:  28
epoch:  29 val_f1:  0.7034651178140057 val_auroc:  0.7798232695139911 val_auprc:  0.885248790738065
EarlyStopping counter: 13 out of 50
epoch:  29
epoch:  30 val_f1:  0.7466980132583976 val_auroc:  0.7859597447226313 val_auprc:  0.8885702038344039
EarlyStopping counter: 14 out of 50
epoch:  30
epoch:  31 val_f1:  0.7295632867761842 val_auroc:  0.7827687776141384 val_auprc:  0.8857497389624622
EarlyStopping counter: 15 out of 50
epoch:  31
epoch:  32 val_f1:  0.7287333672277241 val_auroc:  0.7776141384388807 val_auprc:  0.885010354658159
EarlyStopping counter: 16 out of 50
epoch:  32
epoch:  33 val_f1:  0.7246795893300292 val_auroc:  0.7808051055473736 val_auprc:  0.887014140045783
EarlyStopping counter: 17 out of 50
epoch:  33
epoch:  34 val_f1:  0.7313689473952751 val_auroc:  0.7771232204221895 val_auprc:  0.8851008755523708
EarlyStopping counter: 18 out of 50
epoch:  34
epoch:  35 val_f1:  0.7185533480648861 val_auroc:  0.7768777614138439 val_auprc:  0.8844299570759041
EarlyStopping counter: 19 out of 50
epoch:  35
epoch:  36 val_f1:  0.7238240177089098 val_auroc:  0.7854688267059401 val_auprc:  0.8908625743753396
EarlyStopping counter: 20 out of 50
epoch:  36
epoch:  37 val_f1:  0.7281499969472504 val_auroc:  0.783014236622484 val_auprc:  0.8862253311956397
EarlyStopping counter: 21 out of 50
epoch:  37
epoch:  38 val_f1:  0.7349308245711123 val_auroc:  0.7815414825724104 val_auprc:  0.8851848133759684
EarlyStopping counter: 22 out of 50
epoch:  38
epoch:  39 val_f1:  0.7363119073255568 val_auroc:  0.7776141384388808 val_auprc:  0.884794480658466
EarlyStopping counter: 23 out of 50
epoch:  39
epoch:  40 val_f1:  0.7371937993371881 val_auroc:  0.7690230731467845 val_auprc:  0.877980390146976
EarlyStopping counter: 24 out of 50
epoch:  40
epoch:  41 val_f1:  0.7244548447263693 val_auroc:  0.7749140893470791 val_auprc:  0.8810759798548794
EarlyStopping counter: 25 out of 50
epoch:  41
epoch:  42 val_f1:  0.6225861416130253 val_auroc:  0.7771232204221894 val_auprc:  0.8848002902928479
EarlyStopping counter: 26 out of 50
epoch:  42
epoch:  43 val_f1:  0.7349308245711123 val_auroc:  0.7776141384388807 val_auprc:  0.8808940009336015
EarlyStopping counter: 27 out of 50
epoch:  43
epoch:  44 val_f1:  0.7238240177089098 val_auroc:  0.7697594501718213 val_auprc:  0.8764336320668251
EarlyStopping counter: 28 out of 50
epoch:  44
epoch:  45 val_f1:  0.717230470942395 val_auroc:  0.7734413352970053 val_auprc:  0.8812303346842513
EarlyStopping counter: 29 out of 50
epoch:  45
epoch:  46 val_f1:  0.726175885795287 val_auroc:  0.7648502700049091 val_auprc:  0.8725070631667762
EarlyStopping counter: 30 out of 50
epoch:  46
epoch:  47 val_f1:  0.722058496910722 val_auroc:  0.7766323024054983 val_auprc:  0.8829082041251864
EarlyStopping counter: 31 out of 50
epoch:  47
epoch:  48 val_f1:  0.7246795893300292 val_auroc:  0.7758959253804615 val_auprc:  0.8832037711662672
EarlyStopping counter: 32 out of 50
epoch:  48
epoch:  49 val_f1:  0.7283736963917239 val_auroc:  0.7763868433971527 val_auprc:  0.8832291205941571
EarlyStopping counter: 33 out of 50
epoch:  49
epoch:  50 val_f1:  0.7299542184434271 val_auroc:  0.7754050073637703 val_auprc:  0.8808734720622478
EarlyStopping counter: 34 out of 50
epoch:  50
epoch:  51 val_f1:  0.7386752666832053 val_auroc:  0.7788414334806087 val_auprc:  0.8846091959279916
EarlyStopping counter: 35 out of 50
epoch:  51
epoch:  52 val_f1:  0.7202047592695074 val_auroc:  0.7768777614138439 val_auprc:  0.8826698411272094
EarlyStopping counter: 36 out of 50
epoch:  52
epoch:  53 val_f1:  0.7246795893300292 val_auroc:  0.771232204221895 val_auprc:  0.876859474095404
EarlyStopping counter: 37 out of 50
epoch:  53
epoch:  54 val_f1:  0.7287333672277241 val_auroc:  0.7744231713303878 val_auprc:  0.882787460433516
EarlyStopping counter: 38 out of 50
epoch:  54
epoch:  55 val_f1:  0.7283736963917239 val_auroc:  0.7675503190967109 val_auprc:  0.8752386760062866
EarlyStopping counter: 39 out of 50
epoch:  55
epoch:  56 val_f1:  0.7283736963917239 val_auroc:  0.7695139911634757 val_auprc:  0.8769944060720891
EarlyStopping counter: 40 out of 50
epoch:  56
epoch:  57 val_f1:  0.7266187050359713 val_auroc:  0.7749140893470791 val_auprc:  0.8814068306384975
EarlyStopping counter: 41 out of 50
epoch:  57
epoch:  58 val_f1:  0.7034651178140057 val_auroc:  0.7768777614138439 val_auprc:  0.8834837328813256
EarlyStopping counter: 42 out of 50
epoch:  58
epoch:  59 val_f1:  0.7082463061808618 val_auroc:  0.7719685812469317 val_auprc:  0.8770048541655238
EarlyStopping counter: 43 out of 50
epoch:  59
epoch:  60 val_f1:  0.7325045643526866 val_auroc:  0.7673048600883652 val_auprc:  0.8711435469366763
EarlyStopping counter: 44 out of 50
epoch:  60
epoch:  61 val_f1:  0.7349308245711123 val_auroc:  0.7744231713303878 val_auprc:  0.8796545425172448
EarlyStopping counter: 45 out of 50
epoch:  61
epoch:  62 val_f1:  0.7299542184434271 val_auroc:  0.7739322533136966 val_auprc:  0.8798278814580613
EarlyStopping counter: 46 out of 50
epoch:  62
epoch:  63 val_f1:  0.722058496910722 val_auroc:  0.7729504172803141 val_auprc:  0.8797653152147843
EarlyStopping counter: 47 out of 50
epoch:  63
epoch:  64 val_f1:  0.722058496910722 val_auroc:  0.7690230731467845 val_auprc:  0.8739041064772171
EarlyStopping counter: 48 out of 50
epoch:  64
epoch:  65 val_f1:  0.7283736963917239 val_auroc:  0.7663230240549829 val_auprc:  0.8717330578594313
EarlyStopping counter: 49 out of 50
epoch:  65
epoch:  66 val_f1:  0.7309103647707891 val_auroc:  0.7685321551300933 val_auprc:  0.8755250231813778
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  409.73356318473816
{'time_elapsed': [409.73356318473816], 'epoch': [65], 'fold': [2], 'f1_train': [0.9946078283340751], 'auroc_train': [0.9999693411411227], 'auprc_train': [0.9999865767758085], 'f1_test': [0.7309103647707891], 'auroc_test': [0.7685321551300933], 'auprc_test': [0.8755250231813778]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 427]           2,048
│    └─Tanh: 2-3                         [64, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 142]           --
│    └─Dropout: 2-5                      [64, 1024, 142]           --
│    └─Flatten: 2-6                      [64, 145408]              --
│    └─Linear: 2-7                       [64, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 121.37
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 447.74
Params size (MB): 0.61
Estimated Total Size (MB): 448.68
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5576221128360469 val_auroc:  0.685562015503876 val_auprc:  0.7892244854927082
epoch:  1
epoch:  2 val_f1:  0.694401485983146 val_auroc:  0.6935562015503876 val_auprc:  0.7866278573142689
Validation loss improved to 1.514179
epoch:  2
epoch:  3 val_f1:  0.697841726618705 val_auroc:  0.710513565891473 val_auprc:  0.8118366599016152
Validation loss improved to 1.224313
epoch:  3
epoch:  4 val_f1:  0.6591726145324726 val_auroc:  0.7483042635658915 val_auprc:  0.8507875487594074
Validation loss improved to 1.097726
epoch:  4
epoch:  5 val_f1:  0.6883895960154953 val_auroc:  0.7693798449612402 val_auprc:  0.8821532511660419
Validation loss improved to 1.007568
epoch:  5
epoch:  6 val_f1:  0.6854420580263252 val_auroc:  0.7880329457364341 val_auprc:  0.899594735014838
Validation loss improved to 0.971330
epoch:  6
epoch:  7 val_f1:  0.7762051583223217 val_auroc:  0.8020833333333334 val_auprc:  0.9114305866266558
Validation loss improved to 0.889743
epoch:  7
epoch:  8 val_f1:  0.6854420580263252 val_auroc:  0.8045058139534884 val_auprc:  0.9129665006926977
EarlyStopping counter: 1 out of 50
epoch:  8
epoch:  9 val_f1:  0.7714826564458221 val_auroc:  0.809593023255814 val_auprc:  0.914342225178265
Validation loss improved to 0.886639
epoch:  9
epoch:  10 val_f1:  0.7633328614234447 val_auroc:  0.8141957364341086 val_auprc:  0.9160063159287959
EarlyStopping counter: 1 out of 50
epoch:  10
epoch:  11 val_f1:  0.7647070144847204 val_auroc:  0.816375968992248 val_auprc:  0.9167828915742349
Validation loss improved to 0.884381
epoch:  11
epoch:  12 val_f1:  0.7453578564975014 val_auroc:  0.8231589147286822 val_auprc:  0.9179322339020435
EarlyStopping counter: 1 out of 50
epoch:  12
epoch:  13 val_f1:  0.7679977157187104 val_auroc:  0.8234011627906977 val_auprc:  0.9182894965854485
Validation loss improved to 0.834264
epoch:  13
epoch:  14 val_f1:  0.7851694050563778 val_auroc:  0.8226744186046512 val_auprc:  0.9180058324980254
Validation loss improved to 0.830823
epoch:  14
epoch:  15 val_f1:  0.7365583395352684 val_auroc:  0.8236434108527132 val_auprc:  0.9198205953078918
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.7436964485493495 val_auroc:  0.8241279069767441 val_auprc:  0.9212336543220264
EarlyStopping counter: 2 out of 50
epoch:  16
epoch:  17 val_f1:  0.7754499696945739 val_auroc:  0.8272771317829458 val_auprc:  0.9208494895865935
Validation loss improved to 0.826643
epoch:  17
epoch:  18 val_f1:  0.7633328614234447 val_auroc:  0.8301841085271319 val_auprc:  0.9242004865169748
EarlyStopping counter: 1 out of 50
epoch:  18
epoch:  19 val_f1:  0.757681867378181 val_auroc:  0.8318798449612403 val_auprc:  0.9256052304342679
EarlyStopping counter: 2 out of 50
epoch:  19
epoch:  20 val_f1:  0.7365583395352684 val_auroc:  0.8330910852713179 val_auprc:  0.9273313975443566
EarlyStopping counter: 3 out of 50
epoch:  20
epoch:  21 val_f1:  0.7729252582141845 val_auroc:  0.8345445736434108 val_auprc:  0.9282038424100456
EarlyStopping counter: 4 out of 50
epoch:  21
epoch:  22 val_f1:  0.7735780520043992 val_auroc:  0.8364825581395349 val_auprc:  0.9280308395081218
Validation loss improved to 0.790229
epoch:  22
epoch:  23 val_f1:  0.7827158008497472 val_auroc:  0.8379360465116279 val_auprc:  0.9293544984921345
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.7567507159321089 val_auroc:  0.8362403100775194 val_auprc:  0.9284020382589783
Validation loss improved to 0.789897
epoch:  24
epoch:  25 val_f1:  0.7625825493451395 val_auroc:  0.8425387596899224 val_auprc:  0.931984143069694
EarlyStopping counter: 1 out of 50
epoch:  25
epoch:  26 val_f1:  0.7540304643278981 val_auroc:  0.844718992248062 val_auprc:  0.9338064761526906
EarlyStopping counter: 2 out of 50
epoch:  26
epoch:  27 val_f1:  0.7644817479349855 val_auroc:  0.844718992248062 val_auprc:  0.9347094732286176
EarlyStopping counter: 3 out of 50
epoch:  27
epoch:  28 val_f1:  0.7715550815537892 val_auroc:  0.8452034883720931 val_auprc:  0.9358631865110706
Validation loss improved to 0.788236
epoch:  28
epoch:  29 val_f1:  0.6493541056652177 val_auroc:  0.8439922480620156 val_auprc:  0.9342127532616873
EarlyStopping counter: 1 out of 50
epoch:  29
epoch:  30 val_f1:  0.7762051583223217 val_auroc:  0.8483527131782945 val_auprc:  0.9358232812195724
Validation loss improved to 0.767063
epoch:  30
epoch:  31 val_f1:  0.7735780520043992 val_auroc:  0.8471414728682171 val_auprc:  0.9344805530557558
EarlyStopping counter: 1 out of 50
epoch:  31
epoch:  32 val_f1:  0.7894843465886632 val_auroc:  0.8507751937984496 val_auprc:  0.9373646800500219
Validation loss improved to 0.762315
epoch:  32
epoch:  33 val_f1:  0.7907929835906556 val_auroc:  0.8517441860465116 val_auprc:  0.9387224066991124
EarlyStopping counter: 1 out of 50
epoch:  33
epoch:  34 val_f1:  0.7974889768226049 val_auroc:  0.8534399224806202 val_auprc:  0.9394681569592468
Validation loss improved to 0.749350
epoch:  34
epoch:  35 val_f1:  0.7789671954250403 val_auroc:  0.8570736434108527 val_auprc:  0.9408233510948543
EarlyStopping counter: 1 out of 50
epoch:  35
epoch:  36 val_f1:  0.7854893118997625 val_auroc:  0.8558624031007752 val_auprc:  0.9414036304796859
EarlyStopping counter: 2 out of 50
epoch:  36
epoch:  37 val_f1:  0.792019787311512 val_auroc:  0.8626453488372093 val_auprc:  0.9429995735290972
EarlyStopping counter: 3 out of 50
epoch:  37
epoch:  38 val_f1:  0.7857930944221151 val_auroc:  0.8648255813953488 val_auprc:  0.9435592951538649
EarlyStopping counter: 4 out of 50
epoch:  38
epoch:  39 val_f1:  0.792019787311512 val_auroc:  0.8628875968992249 val_auprc:  0.9452687549923022
EarlyStopping counter: 5 out of 50
epoch:  39
epoch:  40 val_f1:  0.7854893118997625 val_auroc:  0.8631298449612403 val_auprc:  0.9444558984143767
Validation loss improved to 0.748717
epoch:  40
epoch:  41 val_f1:  0.792019787311512 val_auroc:  0.8718507751937984 val_auprc:  0.9471942660777647
EarlyStopping counter: 1 out of 50
epoch:  41
epoch:  42 val_f1:  0.7827158008497472 val_auroc:  0.8660368217054263 val_auprc:  0.9454612428999516
EarlyStopping counter: 2 out of 50
epoch:  42
epoch:  43 val_f1:  0.7997900244397783 val_auroc:  0.8706395348837209 val_auprc:  0.9472376108155791
EarlyStopping counter: 3 out of 50
epoch:  43
epoch:  44 val_f1:  0.792019787311512 val_auroc:  0.8713662790697675 val_auprc:  0.9466464583395529
EarlyStopping counter: 4 out of 50
epoch:  44
epoch:  45 val_f1:  0.794309372388086 val_auroc:  0.8691860465116278 val_auprc:  0.9456869423352869
Validation loss improved to 0.729945
epoch:  45
epoch:  46 val_f1:  0.7961192047225032 val_auroc:  0.8699127906976744 val_auprc:  0.9463898108816926
EarlyStopping counter: 1 out of 50
epoch:  46
epoch:  47 val_f1:  0.7901923359271766 val_auroc:  0.8696705426356589 val_auprc:  0.9474406471658757
Validation loss improved to 0.710948
epoch:  47
epoch:  48 val_f1:  0.7854893118997625 val_auroc:  0.8730620155038759 val_auprc:  0.9474383435690734
EarlyStopping counter: 1 out of 50
epoch:  48
epoch:  49 val_f1:  0.7997900244397783 val_auroc:  0.8737887596899224 val_auprc:  0.9482387715019315
EarlyStopping counter: 2 out of 50
epoch:  49
epoch:  50 val_f1:  0.7972014141264308 val_auroc:  0.8759689922480621 val_auprc:  0.9486363171419261
EarlyStopping counter: 3 out of 50
epoch:  50
epoch:  51 val_f1:  0.7793492478744277 val_auroc:  0.876453488372093 val_auprc:  0.9478540676431167
EarlyStopping counter: 4 out of 50
epoch:  51
epoch:  52 val_f1:  0.768937708914086 val_auroc:  0.8742732558139535 val_auprc:  0.9481436221142426
EarlyStopping counter: 5 out of 50
epoch:  52
epoch:  53 val_f1:  0.8051160047274586 val_auroc:  0.8747577519379846 val_auprc:  0.9487041307011883
EarlyStopping counter: 6 out of 50
epoch:  53
epoch:  54 val_f1:  0.7906801532257888 val_auroc:  0.873546511627907 val_auprc:  0.948972054366747
EarlyStopping counter: 7 out of 50
epoch:  54
epoch:  55 val_f1:  0.7877294237541244 val_auroc:  0.8786337209302325 val_auprc:  0.948763132099748
EarlyStopping counter: 8 out of 50
epoch:  55
epoch:  56 val_f1:  0.8101799492243995 val_auroc:  0.8742732558139534 val_auprc:  0.9496335282352748
EarlyStopping counter: 9 out of 50
epoch:  56
epoch:  57 val_f1:  0.8018807955038493 val_auroc:  0.8774224806201549 val_auprc:  0.9509034167643982
EarlyStopping counter: 10 out of 50
epoch:  57
epoch:  58 val_f1:  0.794309372388086 val_auroc:  0.8783914728682171 val_auprc:  0.9500278277013543
EarlyStopping counter: 11 out of 50
epoch:  58
epoch:  59 val_f1:  0.8101799492243995 val_auroc:  0.8805717054263567 val_auprc:  0.951069377641927
EarlyStopping counter: 12 out of 50
epoch:  59
epoch:  60 val_f1:  0.794309372388086 val_auroc:  0.8786337209302324 val_auprc:  0.9499483864915033
EarlyStopping counter: 13 out of 50
epoch:  60
epoch:  61 val_f1:  0.7906801532257888 val_auroc:  0.8791182170542635 val_auprc:  0.9503144422149912
EarlyStopping counter: 14 out of 50
epoch:  61
epoch:  62 val_f1:  0.7827158008497472 val_auroc:  0.8786337209302326 val_auprc:  0.9499218583186756
EarlyStopping counter: 15 out of 50
epoch:  62
epoch:  63 val_f1:  0.7827158008497472 val_auroc:  0.876937984496124 val_auprc:  0.948905317095146
EarlyStopping counter: 16 out of 50
epoch:  63
epoch:  64 val_f1:  0.8074875573056803 val_auroc:  0.8791182170542636 val_auprc:  0.9505664191761728
EarlyStopping counter: 17 out of 50
epoch:  64
epoch:  65 val_f1:  0.7997900244397783 val_auroc:  0.8817829457364341 val_auprc:  0.9513887696381402
EarlyStopping counter: 18 out of 50
epoch:  65
epoch:  66 val_f1:  0.8063632502555458 val_auroc:  0.8805717054263565 val_auprc:  0.9507672981187605
EarlyStopping counter: 19 out of 50
epoch:  66
epoch:  67 val_f1:  0.7827158008497472 val_auroc:  0.8800872093023258 val_auprc:  0.950341893841882
EarlyStopping counter: 20 out of 50
epoch:  67
epoch:  68 val_f1:  0.7827158008497472 val_auroc:  0.8798449612403101 val_auprc:  0.9505934440518324
EarlyStopping counter: 21 out of 50
epoch:  68
epoch:  69 val_f1:  0.7793492478744277 val_auroc:  0.8825096899224806 val_auprc:  0.9510441395713852
EarlyStopping counter: 22 out of 50
epoch:  69
epoch:  70 val_f1:  0.8151164175042944 val_auroc:  0.881298449612403 val_auprc:  0.9523004138629905
EarlyStopping counter: 23 out of 50
epoch:  70
epoch:  71 val_f1:  0.8063632502555458 val_auroc:  0.8810562015503877 val_auprc:  0.9512752648927723
EarlyStopping counter: 24 out of 50
epoch:  71
epoch:  72 val_f1:  0.7906801532257888 val_auroc:  0.8815406976744187 val_auprc:  0.9513072033986998
EarlyStopping counter: 25 out of 50
epoch:  72
epoch:  73 val_f1:  0.7827158008497472 val_auroc:  0.8834786821705426 val_auprc:  0.9518229203077773
EarlyStopping counter: 26 out of 50
epoch:  73
epoch:  74 val_f1:  0.7729252582141845 val_auroc:  0.8834786821705426 val_auprc:  0.952361237727983
EarlyStopping counter: 27 out of 50
epoch:  74
epoch:  75 val_f1:  0.7811109002295425 val_auroc:  0.8829941860465116 val_auprc:  0.9515034266400005
EarlyStopping counter: 28 out of 50
epoch:  75
epoch:  76 val_f1:  0.7746634573712671 val_auroc:  0.8827519379844961 val_auprc:  0.9517211703100257
EarlyStopping counter: 29 out of 50
epoch:  76
epoch:  77 val_f1:  0.7827158008497472 val_auroc:  0.8827519379844961 val_auprc:  0.9512816419194934
EarlyStopping counter: 30 out of 50
epoch:  77
epoch:  78 val_f1:  0.7827158008497472 val_auroc:  0.8815406976744186 val_auprc:  0.9512549762673936
EarlyStopping counter: 31 out of 50
epoch:  78
epoch:  79 val_f1:  0.7746634573712671 val_auroc:  0.8820251937984496 val_auprc:  0.951285917508956
EarlyStopping counter: 32 out of 50
epoch:  79
epoch:  80 val_f1:  0.7746634573712671 val_auroc:  0.8827519379844961 val_auprc:  0.9518383142796993
EarlyStopping counter: 33 out of 50
epoch:  80
epoch:  81 val_f1:  0.7811109002295425 val_auroc:  0.883236434108527 val_auprc:  0.9515983793982575
EarlyStopping counter: 34 out of 50
epoch:  81
epoch:  82 val_f1:  0.8063632502555458 val_auroc:  0.8827519379844961 val_auprc:  0.9523690939933753
EarlyStopping counter: 35 out of 50
epoch:  82
epoch:  83 val_f1:  0.7811109002295425 val_auroc:  0.884205426356589 val_auprc:  0.9516945253902387
EarlyStopping counter: 36 out of 50
epoch:  83
epoch:  84 val_f1:  0.7811109002295425 val_auroc:  0.8854166666666666 val_auprc:  0.9534040341381225
EarlyStopping counter: 37 out of 50
epoch:  84
epoch:  85 val_f1:  0.7811109002295425 val_auroc:  0.884205426356589 val_auprc:  0.9519166090373651
EarlyStopping counter: 38 out of 50
epoch:  85
epoch:  86 val_f1:  0.8063632502555458 val_auroc:  0.8846899224806202 val_auprc:  0.9521593230198795
EarlyStopping counter: 39 out of 50
epoch:  86
epoch:  87 val_f1:  0.8217477382460002 val_auroc:  0.8842054263565892 val_auprc:  0.9529416521668643
EarlyStopping counter: 40 out of 50
epoch:  87
epoch:  88 val_f1:  0.7811109002295425 val_auroc:  0.8846899224806201 val_auprc:  0.9523216965171062
EarlyStopping counter: 41 out of 50
epoch:  88
epoch:  89 val_f1:  0.7811109002295425 val_auroc:  0.8829941860465117 val_auprc:  0.9517858583622767
EarlyStopping counter: 42 out of 50
epoch:  89
epoch:  90 val_f1:  0.7827158008497472 val_auroc:  0.8839631782945737 val_auprc:  0.9524294657973953
EarlyStopping counter: 43 out of 50
epoch:  90
epoch:  91 val_f1:  0.8140907369797942 val_auroc:  0.8839631782945736 val_auprc:  0.9527947296044099
EarlyStopping counter: 44 out of 50
epoch:  91
epoch:  92 val_f1:  0.7811109002295425 val_auroc:  0.8851744186046512 val_auprc:  0.9520513587319345
EarlyStopping counter: 45 out of 50
epoch:  92
epoch:  93 val_f1:  0.7906801532257888 val_auroc:  0.8849321705426357 val_auprc:  0.9529542445640217
EarlyStopping counter: 46 out of 50
epoch:  93
epoch:  94 val_f1:  0.8063632502555458 val_auroc:  0.8849321705426356 val_auprc:  0.952820637460412
EarlyStopping counter: 47 out of 50
epoch:  94
epoch:  95 val_f1:  0.7875752415552048 val_auroc:  0.8851744186046512 val_auprc:  0.9522066283368472
EarlyStopping counter: 48 out of 50
epoch:  95
epoch:  96 val_f1:  0.8063632502555458 val_auroc:  0.883236434108527 val_auprc:  0.9529545991035158
EarlyStopping counter: 49 out of 50
epoch:  96
epoch:  97 val_f1:  0.7906801532257888 val_auroc:  0.8851744186046513 val_auprc:  0.9531006871663588
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  626.8303639888763
{'time_elapsed': [626.8303639888763], 'epoch': [96], 'fold': [3], 'f1_train': [1.0], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.7906801532257888], 'auroc_test': [0.8851744186046513], 'auprc_test': [0.9531006871663588]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 427]           2,048
│    └─Tanh: 2-3                         [64, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 142]           --
│    └─Dropout: 2-5                      [64, 1024, 142]           --
│    └─Flatten: 2-6                      [64, 145408]              --
│    └─Linear: 2-7                       [64, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 121.37
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 447.74
Params size (MB): 0.61
Estimated Total Size (MB): 448.68
==========================================================================================
tensor(0.4369)
epoch:  0
epoch:  1 val_f1:  0.5707915273132664 val_auroc:  0.6805555555555555 val_auprc:  0.7698666038838122
epoch:  1
epoch:  2 val_f1:  0.6408237986270023 val_auroc:  0.5987103174603173 val_auprc:  0.7113013090333706
EarlyStopping counter: 1 out of 50
epoch:  2
epoch:  3 val_f1:  0.6409358208245496 val_auroc:  0.5850694444444444 val_auprc:  0.7027972758154278
EarlyStopping counter: 2 out of 50
epoch:  3
epoch:  4 val_f1:  0.6292354988007163 val_auroc:  0.5890376984126984 val_auprc:  0.7058587949860486
Validation loss improved to 2.910831
epoch:  4
epoch:  5 val_f1:  0.6429877037997634 val_auroc:  0.5987103174603174 val_auprc:  0.7107589737619691
Validation loss improved to 2.471514
epoch:  5
epoch:  6 val_f1:  0.6648734456301262 val_auroc:  0.617063492063492 val_auprc:  0.7246192351693039
Validation loss improved to 1.828280
epoch:  6
epoch:  7 val_f1:  0.4146674754225941 val_auroc:  0.6453373015873015 val_auprc:  0.740239669582423
Validation loss improved to 1.596376
epoch:  7
epoch:  8 val_f1:  0.7306178489702517 val_auroc:  0.6847718253968255 val_auprc:  0.7626150125468713
Validation loss improved to 1.385165
epoch:  8
epoch:  9 val_f1:  0.6842929886408149 val_auroc:  0.7301587301587302 val_auprc:  0.8060006620643125
EarlyStopping counter: 1 out of 50
epoch:  9
epoch:  10 val_f1:  0.14202898550724638 val_auroc:  0.77703373015873 val_auprc:  0.8532406693520533
EarlyStopping counter: 2 out of 50
epoch:  10
epoch:  11 val_f1:  0.5873969891987832 val_auroc:  0.7978670634920635 val_auprc:  0.8663503716735754
EarlyStopping counter: 3 out of 50
epoch:  11
epoch:  12 val_f1:  0.20090909090909093 val_auroc:  0.8199404761904762 val_auprc:  0.8961616765332525
EarlyStopping counter: 4 out of 50
epoch:  12
epoch:  13 val_f1:  0.7651901748656188 val_auroc:  0.829861111111111 val_auprc:  0.9029625468771147
Validation loss improved to 1.087703
epoch:  13
epoch:  14 val_f1:  0.7873345935727789 val_auroc:  0.845734126984127 val_auprc:  0.9162673690130356
Validation loss improved to 0.891716
epoch:  14
epoch:  15 val_f1:  0.6765704584040747 val_auroc:  0.8526785714285714 val_auprc:  0.9216969355691211
EarlyStopping counter: 1 out of 50
epoch:  15
epoch:  16 val_f1:  0.8036760694501368 val_auroc:  0.8536706349206349 val_auprc:  0.9197623399271025
Validation loss improved to 0.886329
epoch:  16
epoch:  17 val_f1:  0.7819511139952413 val_auroc:  0.8571428571428571 val_auprc:  0.9216700228924306
EarlyStopping counter: 1 out of 50
epoch:  17
epoch:  18 val_f1:  0.6994966360955902 val_auroc:  0.8591269841269842 val_auprc:  0.9241335131662567
EarlyStopping counter: 2 out of 50
epoch:  18
epoch:  19 val_f1:  0.7145929179934707 val_auroc:  0.8655753968253967 val_auprc:  0.9260528518425148
Validation loss improved to 0.863673
epoch:  19
epoch:  20 val_f1:  0.7891335560760728 val_auroc:  0.8692956349206349 val_auprc:  0.9289304309449643
Validation loss improved to 0.852378
epoch:  20
epoch:  21 val_f1:  0.6906326123865063 val_auroc:  0.8700396825396826 val_auprc:  0.9312553393617573
EarlyStopping counter: 1 out of 50
epoch:  21
epoch:  22 val_f1:  0.7971014492753623 val_auroc:  0.8705357142857143 val_auprc:  0.9316719856512822
Validation loss improved to 0.837842
epoch:  22
epoch:  23 val_f1:  0.7145929179934707 val_auroc:  0.8695436507936507 val_auprc:  0.9323487088389852
EarlyStopping counter: 1 out of 50
epoch:  23
epoch:  24 val_f1:  0.8049865427618805 val_auroc:  0.8707837301587301 val_auprc:  0.9321568223438148
Validation loss improved to 0.828826
epoch:  24
epoch:  25 val_f1:  0.7356159817134149 val_auroc:  0.8740079365079365 val_auprc:  0.9341836598844467
Validation loss improved to 0.812303
epoch:  25
epoch:  26 val_f1:  0.7067526095351808 val_auroc:  0.8745039682539683 val_auprc:  0.9326663707790775
EarlyStopping counter: 1 out of 50
epoch:  26
epoch:  27 val_f1:  0.7973334973248877 val_auroc:  0.8742559523809524 val_auprc:  0.9320957388850528
Validation loss improved to 0.769255
epoch:  27
epoch:  28 val_f1:  0.756376995929398 val_auroc:  0.8779761904761905 val_auprc:  0.9351396857959189
EarlyStopping counter: 1 out of 50
epoch:  28
epoch:  29 val_f1:  0.8260869565217391 val_auroc:  0.8777281746031745 val_auprc:  0.9347720300733876
EarlyStopping counter: 2 out of 50
epoch:  29
epoch:  30 val_f1:  0.7214453202248777 val_auroc:  0.8777281746031746 val_auprc:  0.9336597083798367
EarlyStopping counter: 3 out of 50
epoch:  30
epoch:  31 val_f1:  0.7308783288322931 val_auroc:  0.8757440476190477 val_auprc:  0.9335064700811592
EarlyStopping counter: 4 out of 50
epoch:  31
epoch:  32 val_f1:  0.7075175862361216 val_auroc:  0.8752480158730159 val_auprc:  0.9332798432979693
EarlyStopping counter: 5 out of 50
epoch:  32
epoch:  33 val_f1:  0.7939770374552984 val_auroc:  0.8735119047619048 val_auprc:  0.9309307425253923
EarlyStopping counter: 6 out of 50
epoch:  33
epoch:  34 val_f1:  0.7216330858960764 val_auroc:  0.876984126984127 val_auprc:  0.9330200467964391
EarlyStopping counter: 7 out of 50
epoch:  34
epoch:  35 val_f1:  0.8337541157170946 val_auroc:  0.8757440476190477 val_auprc:  0.934142591492062
EarlyStopping counter: 8 out of 50
epoch:  35
epoch:  36 val_f1:  0.8030193236714975 val_auroc:  0.8779761904761905 val_auprc:  0.9337402003842231
Validation loss improved to 0.765547
epoch:  36
epoch:  37 val_f1:  0.8015122873345937 val_auroc:  0.876736111111111 val_auprc:  0.9331738239410825
EarlyStopping counter: 1 out of 50
epoch:  37
epoch:  38 val_f1:  0.7494824016563146 val_auroc:  0.8772321428571429 val_auprc:  0.9356484772855065
EarlyStopping counter: 2 out of 50
epoch:  38
epoch:  39 val_f1:  0.7895875497243353 val_auroc:  0.8712797619047619 val_auprc:  0.9307716066398168
EarlyStopping counter: 3 out of 50
epoch:  39
epoch:  40 val_f1:  0.8127933585226971 val_auroc:  0.8695436507936508 val_auprc:  0.9305927402522404
EarlyStopping counter: 4 out of 50
epoch:  40
epoch:  41 val_f1:  0.7356159817134149 val_auroc:  0.8692956349206349 val_auprc:  0.9296367470705051
EarlyStopping counter: 5 out of 50
epoch:  41
epoch:  42 val_f1:  0.7749692370795734 val_auroc:  0.8665674603174602 val_auprc:  0.929061693806369
EarlyStopping counter: 6 out of 50
epoch:  42
epoch:  43 val_f1:  0.7837457330597287 val_auroc:  0.8737599206349206 val_auprc:  0.9324925584010781
EarlyStopping counter: 7 out of 50
epoch:  43
epoch:  44 val_f1:  0.8248625247346153 val_auroc:  0.871031746031746 val_auprc:  0.9309210373853203
EarlyStopping counter: 8 out of 50
epoch:  44
epoch:  45 val_f1:  0.7494824016563146 val_auroc:  0.8754960317460317 val_auprc:  0.9339684611776448
EarlyStopping counter: 9 out of 50
epoch:  45
epoch:  46 val_f1:  0.8100998424466828 val_auroc:  0.8759920634920635 val_auprc:  0.9340545029316818
EarlyStopping counter: 10 out of 50
epoch:  46
epoch:  47 val_f1:  0.8348841452289729 val_auroc:  0.8705357142857142 val_auprc:  0.9301754415950894
EarlyStopping counter: 11 out of 50
epoch:  47
epoch:  48 val_f1:  0.7755600530392909 val_auroc:  0.8705357142857142 val_auprc:  0.9299131254473297
EarlyStopping counter: 12 out of 50
epoch:  48
epoch:  49 val_f1:  0.8154066640778435 val_auroc:  0.8692956349206349 val_auprc:  0.9299860917172469
EarlyStopping counter: 13 out of 50
epoch:  49
epoch:  50 val_f1:  0.8348841452289729 val_auroc:  0.8707837301587301 val_auprc:  0.9300761157498489
EarlyStopping counter: 14 out of 50
epoch:  50
epoch:  51 val_f1:  0.818640853509558 val_auroc:  0.8685515873015873 val_auprc:  0.9286222533895364
EarlyStopping counter: 15 out of 50
epoch:  51
epoch:  52 val_f1:  0.8260869565217391 val_auroc:  0.8687996031746031 val_auprc:  0.9299758156830356
EarlyStopping counter: 16 out of 50
epoch:  52
epoch:  53 val_f1:  0.81483559295621 val_auroc:  0.8685515873015873 val_auprc:  0.9280050030434975
EarlyStopping counter: 17 out of 50
epoch:  53
epoch:  54 val_f1:  0.8057130854862423 val_auroc:  0.8687996031746033 val_auprc:  0.9274195054600518
EarlyStopping counter: 18 out of 50
epoch:  54
epoch:  55 val_f1:  0.8215074100875418 val_auroc:  0.8737599206349207 val_auprc:  0.9321807614091172
EarlyStopping counter: 19 out of 50
epoch:  55
epoch:  56 val_f1:  0.8327610961982647 val_auroc:  0.8705357142857143 val_auprc:  0.9304115080489974
EarlyStopping counter: 20 out of 50
epoch:  56
epoch:  57 val_f1:  0.8081713820844254 val_auroc:  0.8700396825396826 val_auprc:  0.9281285250319911
EarlyStopping counter: 21 out of 50
epoch:  57
epoch:  58 val_f1:  0.8348841452289729 val_auroc:  0.8695436507936508 val_auprc:  0.9295859227383396
EarlyStopping counter: 22 out of 50
epoch:  58
epoch:  59 val_f1:  0.818640853509558 val_auroc:  0.8695436507936508 val_auprc:  0.9260382192063208
EarlyStopping counter: 23 out of 50
epoch:  59
epoch:  60 val_f1:  0.8248625247346153 val_auroc:  0.8715277777777779 val_auprc:  0.930166922860894
EarlyStopping counter: 24 out of 50
epoch:  60
epoch:  61 val_f1:  0.8252918550509482 val_auroc:  0.8707837301587301 val_auprc:  0.9280665413415774
EarlyStopping counter: 25 out of 50
epoch:  61
epoch:  62 val_f1:  0.8405797101449275 val_auroc:  0.8737599206349207 val_auprc:  0.9296920761039611
EarlyStopping counter: 26 out of 50
epoch:  62
epoch:  63 val_f1:  0.833877425315676 val_auroc:  0.8722718253968254 val_auprc:  0.9293643275997836
EarlyStopping counter: 27 out of 50
epoch:  63
epoch:  64 val_f1:  0.7634000460087416 val_auroc:  0.8737599206349207 val_auprc:  0.9303889055049189
EarlyStopping counter: 28 out of 50
epoch:  64
epoch:  65 val_f1:  0.6898325099232261 val_auroc:  0.867063492063492 val_auprc:  0.9249020277482005
EarlyStopping counter: 29 out of 50
epoch:  65
epoch:  66 val_f1:  0.8215074100875418 val_auroc:  0.871279761904762 val_auprc:  0.9295588763032465
EarlyStopping counter: 30 out of 50
epoch:  66
epoch:  67 val_f1:  0.8315289648622983 val_auroc:  0.8774801587301587 val_auprc:  0.9306735888122788
EarlyStopping counter: 31 out of 50
epoch:  67
epoch:  68 val_f1:  0.8260869565217391 val_auroc:  0.8745039682539684 val_auprc:  0.9306964316152739
EarlyStopping counter: 32 out of 50
epoch:  68
epoch:  69 val_f1:  0.7966751918158568 val_auroc:  0.8735119047619048 val_auprc:  0.9287084801129055
EarlyStopping counter: 33 out of 50
epoch:  69
epoch:  70 val_f1:  0.8233596702164204 val_auroc:  0.8717757936507937 val_auprc:  0.927295464644186
EarlyStopping counter: 34 out of 50
epoch:  70
epoch:  71 val_f1:  0.8231516182680737 val_auroc:  0.8757440476190476 val_auprc:  0.9319460369004571
EarlyStopping counter: 35 out of 50
epoch:  71
epoch:  72 val_f1:  0.8260869565217391 val_auroc:  0.8752480158730158 val_auprc:  0.9320873549799349
EarlyStopping counter: 36 out of 50
epoch:  72
epoch:  73 val_f1:  0.820411899313501 val_auroc:  0.8740079365079365 val_auprc:  0.9305905621958934
EarlyStopping counter: 37 out of 50
epoch:  73
epoch:  74 val_f1:  0.8182185828242006 val_auroc:  0.873015873015873 val_auprc:  0.9310211627851117
EarlyStopping counter: 38 out of 50
epoch:  74
epoch:  75 val_f1:  0.8168793096329329 val_auroc:  0.8754960317460317 val_auprc:  0.9314102343094366
EarlyStopping counter: 39 out of 50
epoch:  75
epoch:  76 val_f1:  0.8154066640778435 val_auroc:  0.8772321428571429 val_auprc:  0.9324241541216687
EarlyStopping counter: 40 out of 50
epoch:  76
epoch:  77 val_f1:  0.8260869565217391 val_auroc:  0.876984126984127 val_auprc:  0.9323356060482549
EarlyStopping counter: 41 out of 50
epoch:  77
epoch:  78 val_f1:  0.8088065661047027 val_auroc:  0.8737599206349207 val_auprc:  0.9323742932962291
EarlyStopping counter: 42 out of 50
epoch:  78
epoch:  79 val_f1:  0.8327610961982647 val_auroc:  0.878968253968254 val_auprc:  0.9328095667706564
EarlyStopping counter: 43 out of 50
epoch:  79
epoch:  80 val_f1:  0.8260869565217391 val_auroc:  0.8782242063492063 val_auprc:  0.9346013669422631
EarlyStopping counter: 44 out of 50
epoch:  80
epoch:  81 val_f1:  0.8100998424466828 val_auroc:  0.873015873015873 val_auprc:  0.9314565615951973
EarlyStopping counter: 45 out of 50
epoch:  81
epoch:  82 val_f1:  0.8137922815659323 val_auroc:  0.8752480158730159 val_auprc:  0.9322957771442397
EarlyStopping counter: 46 out of 50
epoch:  82
epoch:  83 val_f1:  0.8088065661047027 val_auroc:  0.876736111111111 val_auprc:  0.9322576087919774
EarlyStopping counter: 47 out of 50
epoch:  83
epoch:  84 val_f1:  0.8088065661047027 val_auroc:  0.8784722222222222 val_auprc:  0.9330132731917227
EarlyStopping counter: 48 out of 50
epoch:  84
epoch:  85 val_f1:  0.7874834274643012 val_auroc:  0.8737599206349207 val_auprc:  0.932538416767746
EarlyStopping counter: 49 out of 50
epoch:  85
epoch:  86 val_f1:  0.8120268224096906 val_auroc:  0.8767361111111112 val_auprc:  0.9331786484258711
EarlyStopping counter: 50 out of 50
Early stopping triggered
Early stopping triggered!
Time taken:  501.24404525756836
{'time_elapsed': [501.24404525756836], 'epoch': [85], 'fold': [4], 'f1_train': [0.9946175537860844], 'auroc_train': [1.0], 'auprc_train': [1.0], 'f1_test': [0.8120268224096906], 'auroc_test': [0.8767361111111112], 'auprc_test': [0.9331786484258711]}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
TAPPredictor                             [64, 1]                   --
├─Sequential: 1-1                        [64, 1]                   --
│    └─Conv1d: 2-1                       [64, 1024, 427]           4,096
│    └─BatchNorm1d: 2-2                  [64, 1024, 427]           2,048
│    └─Tanh: 2-3                         [64, 1024, 427]           --
│    └─MaxPool1d: 2-4                    [64, 1024, 142]           --
│    └─Dropout: 2-5                      [64, 1024, 142]           --
│    └─Flatten: 2-6                      [64, 145408]              --
│    └─Linear: 2-7                       [64, 1]                   145,409
==========================================================================================
Total params: 151,553
Trainable params: 151,553
Non-trainable params: 0
Total mult-adds (M): 121.37
==========================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 447.74
Params size (MB): 0.61
Estimated Total Size (MB): 448.68
==========================================================================================
